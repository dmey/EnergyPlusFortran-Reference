<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>PackagedThermalStorageCoil.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>PackagedThermalStorageCoil.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.9% of total for source files.">3408 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/PackagedThermalStorageCoil.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">PackagedThermalStorageCoil.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/packagedthermalstoragecoil.html">PackagedThermalStorageCoil</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html#src">PackagedThermalStorageCoil.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilepackagedthermalstoragecoilf90EfferentGraph" width="641pt" height="1393pt"
 viewBox="0.00 0.00 641.00 1393.09" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph" class="graph" transform="scale(.2137 .2137) rotate(0) translate(4 6514.0712)">
<title>sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-6514.0712 2995.1436,-6514.0712 2995.1436,4 -4,4"/>
<!-- sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~packagedthermalstoragecoil.f90</title>
<polygon fill="none" stroke="#000000" points="2990.9376,-959.1304 2821.7623,-959.1304 2821.7623,-937.1195 2990.9376,-937.1195 2990.9376,-959.1304"/>
<text text-anchor="middle" x="2906.35" y="-944.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PackagedThermalStorageCoil.f90</text>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-3913.1304 528.0262,-3913.1304 528.0262,-3891.1195 643.4123,-3891.1195 643.4123,-3913.1304"/>
<text text-anchor="middle" x="585.7192" y="-3898.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-6417.1249C2191.1014,-6426.8122 2212.1124,-6435.8589 2281.0071,-6417.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M590.1959,-3913.422C603.0682,-3946.5249 640.1718,-4046.4266 654.4731,-4133.1249 723.6028,-4552.2075 600.6646,-4672.9822 690.4731,-5088.1249 767.6751,-5444.993 897.2359,-5497.7295 1009.6252,-5845.1249 1032.7292,-5916.5391 1007.9537,-5945.2048 1045.6252,-6010.1249 1079.9241,-6069.2327 1111.4969,-6064.773 1159.79,-6113.1249 1176.692,-6130.0475 1176.3229,-6139.2296 1195.79,-6153.1249 1380.7685,-6285.1592 1439.7437,-6336.5519 1666.4052,-6353.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-6353.1249C1870.0857,-6358.6453 1918.4943,-6389.4787 2120.3654,-6417.1249"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1909.74,-4347.1304 1784.0928,-4347.1304 1784.0928,-4325.1195 1909.74,-4325.1195 1909.74,-4347.1304"/>
<text text-anchor="middle" x="1846.9164" y="-4332.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M755.1332,-3919.1249C785.4173,-3923.8697 791.3716,-3931.6424 819.7932,-3943.1249 1080.8791,-4048.6052 1141.4803,-4086.022 1400.2236,-4197.1249 1482.2805,-4232.3597 1500.4574,-4247.55 1585.3953,-4275.1249 1649.0287,-4295.7834 1723.4973,-4312.4489 1776.6589,-4323.1067"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1776.1734,-4326.5786 1786.6634,-4325.092 1777.536,-4319.7124 1776.1734,-4326.5786"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1329.0063,-5489.1304 1231.0073,-5489.1304 1231.0073,-5467.1195 1329.0063,-5467.1195 1329.0063,-5489.1304"/>
<text text-anchor="middle" x="1280.0068" y="-5474.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1102.7076,-5478.1249C1141.3539,-5485.4403 1185.5933,-5485.4528 1220.2138,-5483.6302"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1220.8574,-5487.0983 1230.6324,-5483.0117 1220.4426,-5480.1106 1220.8574,-5487.0983"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M590.1793,-3913.4248C603.0065,-3946.5352 640,-4046.4551 654.4731,-4133.1249 686.125,-4322.6669 619.4004,-4818.5845 690.4731,-4997.1249 731.8724,-5101.1231 775.321,-5109.3191 855.7932,-5187.1249 919.1267,-5248.3599 959.0975,-5239.9599 1009.6252,-5312.1249 1058.1395,-5381.4142 1019.5984,-5462.3931 1102.7076,-5478.1249"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-3483.1304 721.7644,-3483.1304 721.7644,-3461.1195 788.502,-3461.1195 788.502,-3483.1304"/>
<text text-anchor="middle" x="755.1332" y="-3468.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M589.2909,-3890.9503C599.9733,-3857.3239 632.3068,-3754.0365 654.4731,-3667.1249 673.0226,-3594.3946 643.534,-3560.6953 690.4731,-3502.1249 696.2701,-3494.8915 704.2106,-3489.3226 712.544,-3485.0635"/>
<polygon fill="#1200ff" stroke="#1200ff" points="713.9903,-3488.2507 721.6578,-3480.9391 711.1042,-3481.8733 713.9903,-3488.2507"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/plantwaterthermaltank.f90.html" xlink:title="PlantWaterThermalTank.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2785.4331,-959.1304 2643.9268,-959.1304 2643.9268,-937.1195 2785.4331,-937.1195 2785.4331,-959.1304"/>
<text text-anchor="middle" x="2714.6799" y="-944.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterThermalTank.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M755.1332,-3919.1249C937.0364,-3936.7024 994.8134,-3924.741 1159.79,-3846.1249 1178.8511,-3837.0418 1178.3224,-3826.9869 1195.79,-3815.1249 1280.6293,-3757.512 1300.6375,-3732.6109 1400.2236,-3708.1249 1464.6046,-3692.2951 1483.5381,-3700.4876 1549.3953,-3708.1249 1715.2964,-3727.3641 2123.4523,-3824.7189 2281.0071,-3880.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M643.5086,-3906.638C676.3299,-3909.5228 718.1302,-3913.7369 755.1332,-3919.1249"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1910.4191,-1981.1304 1783.4137,-1981.1304 1783.4137,-1959.1195 1910.4191,-1959.1195 1910.4191,-1981.1304"/>
<text text-anchor="middle" x="1846.9164" y="-1966.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-2509.1249C958.3086,-2484.0839 981.9373,-2507.8353 1009.6252,-2485.1249 1035.4598,-2463.9348 1028.2538,-2447.6675 1045.6252,-2419.1249 1092.7505,-2341.6948 1110.8005,-2326.3892 1159.79,-2250.1249 1176.3921,-2224.2797 1171.3409,-2209.7219 1195.79,-2191.1249 1226.767,-2167.5626 1247.7224,-2188.8613 1280.0068,-2167.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M589.3635,-3891.1072C601.3084,-3854.4238 639.3744,-3732.8706 654.4731,-3629.1249 681.7011,-3442.0376 618.5057,-2953.9497 690.4731,-2779.1249 722.9668,-2700.1907 777.2098,-2711.1054 819.7932,-2637.1249 846.2994,-2591.0757 815.9346,-2558.259 855.7932,-2523.1249 881.8589,-2500.1488 906.7385,-2532.2083 932.7092,-2509.1249"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2509.7606,-3135.1304 2379.1818,-3135.1304 2379.1818,-3113.1195 2509.7606,-3113.1195 2509.7606,-3135.1304"/>
<text text-anchor="middle" x="2444.4712" y="-3120.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M643.6567,-3894.4831C788.9675,-3875.2873 1157.5052,-3826.4075 1159.79,-3824.1249 1243.2551,-3740.7427 1115.6096,-3647.6703 1195.79,-3561.1249 1316.6493,-3430.6715 1832.187,-3331.887 1984.2305,-3424.1249"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~plantsolarcollectors.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/plantsolarcollectors.f90.html" xlink:title="PlantSolarCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2343.1468,-4388.1304 2218.8674,-4388.1304 2218.8674,-4366.1195 2343.1468,-4366.1195 2343.1468,-4388.1304"/>
<text text-anchor="middle" x="2281.0071" y="-4373.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSolarCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M595.6596,-3913.3839C649.7561,-3973.9454 916.5492,-4263.5941 1195.79,-4408.1249 1380.4461,-4503.7001 1896.8502,-4587.903 1984.2305,-4565.1249"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1984.2305,-4565.1249C2002.6654,-4557.6176 2008.8612,-4556.0395 2022.0432,-4541.1249 2046.795,-4513.1198 2028.8567,-4488.472 2058.0432,-4465.1249 2080.2121,-4447.3914 2093.5414,-4460.4206 2120.3654,-4451.1249"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2336.8136,-5109.1304 2225.2005,-5109.1304 2225.2005,-5087.1195 2336.8136,-5087.1195 2336.8136,-5109.1304"/>
<text text-anchor="middle" x="2281.0071" y="-5094.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M590.0847,-3913.4411C602.6556,-3946.5958 639.0236,-4046.6238 654.4731,-4133.1249 698.3239,-4378.6423 627.0232,-4451.9284 690.4731,-4693.1249 733.4241,-4856.3973 754.1927,-4900.2917 855.7932,-5035.1249 863.4175,-5045.243 1184.0326,-5334.4061 1195.79,-5339.1249 1262.97,-5366.0874 1787.9461,-5403.1086 1846.9164,-5361.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1846.9164,-5361.1249C1919.5695,-5307.3621 1901.3291,-5247.129 1984.2305,-5211.1249"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2607.8976,-1876.1304 2545.5216,-1876.1304 2545.5216,-1854.1195 2607.8976,-1854.1195 2607.8976,-1876.1304"/>
<text text-anchor="middle" x="2576.7096" y="-1861.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2281.0071,-2475.1249C2298.469,-2481.7387 2429.331,-2525.0536 2444.4712,-2514.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M755.1332,-3326.1249C798.1413,-3227.6368 793.0354,-3197.2097 819.7932,-3093.1249 837.0786,-3025.8868 821.7823,-3001.6478 855.7932,-2941.1249 902.88,-2857.3334 961.8808,-2872.5434 1009.6252,-2789.1249 1041.9669,-2732.618 1022.8098,-2708.1042 1045.6252,-2647.1249 1085.0597,-2541.7278 1120.9476,-2526.7417 1159.79,-2421.1249 1183.3054,-2357.1842 1142.2577,-2314.2636 1195.79,-2272.1249 1254.6119,-2225.8225 1289.5403,-2266.9937 1364.2236,-2272.1249 1730.5723,-2297.2952 1850.3301,-2228.9731 2182.6875,-2385.1249 2236.3054,-2410.3163 2225.6069,-2454.1417 2281.0071,-2475.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M588.7204,-3890.9875C598.6638,-3853.9313 631.2175,-3731.3517 654.4731,-3629.1249 672.2805,-3550.8476 663.8991,-3527.8763 690.4731,-3452.1249 711.3091,-3392.7303 731.174,-3384.3299 755.1332,-3326.1249"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1747.4249,-2523.1304 1585.3854,-2523.1304 1585.3854,-2501.1195 1747.4249,-2501.1195 1747.4249,-2523.1304"/>
<text text-anchor="middle" x="1666.4052" y="-2508.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-3326.1249C865.3249,-3090.441 1040.5217,-3134.3482 1159.79,-2903.1249 1198.7897,-2827.517 1143.0896,-2781.9096 1195.79,-2715.1249 1246.6652,-2650.6534 1296.6567,-2685.8108 1364.2236,-2639.1249 1382.8395,-2626.2622 1380.2107,-2613.6835 1400.2236,-2603.1249 1430.0547,-2587.3865 1445.3535,-2605.5547 1474.8094,-2589.1249"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2174.0962,-1398.1304 2066.6346,-1398.1304 2066.6346,-1376.1195 2174.0962,-1376.1195 2174.0962,-1398.1304"/>
<text text-anchor="middle" x="2120.3654" y="-1383.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-2509.1249C959.1992,-2485.028 978.534,-2502.8935 1009.6252,-2485.1249 1087.8022,-2440.4471 1111.7198,-2425.263 1159.79,-2349.1249 1189.5161,-2302.042 1156.1457,-2268.2244 1195.79,-2229.1249 1251.2106,-2174.466 1290.0235,-2204.6489 1364.2236,-2181.1249 1609.3663,-2103.4063 1717.1879,-2159.8227 1910.4177,-1990.1249 1993.3978,-1917.2504 1983.219,-1871.5129 2022.0432,-1768.1249 2072.0166,-1635.0471 2105.712,-1466.5786 2116.574,-1408.1811"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2120.0246,-1408.7683 2118.3878,-1398.3007 2113.1397,-1407.5043 2120.0246,-1408.7683"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2714.6799,-6132.1249C2814.3424,-6035.7303 2899.6694,-1325.2645 2905.9764,-969.3644"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2909.4766,-969.3826 2906.1539,-959.3223 2902.4777,-969.2589 2909.4766,-969.3826"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.9201,-4347.1488C1869.2222,-4418.4964 1976.4499,-4822.5608 2022.0432,-5159.1249 2031.0534,-5225.6367 2016.5076,-5709.4012 2058.0432,-5762.1249 2075.963,-5784.8716 2104.5319,-5756.8797 2120.3654,-5781.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-5781.1249C2202.4666,-5910.6851 2604.4291,-6238.7608 2714.6799,-6132.1249"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1881.2565,-4325.1125C1970.1845,-4297.3147 2206.2482,-4228.3038 2281.0071,-4254.1249"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1858.2093,-4325.0239C1870.9473,-4312.4786 1892.2561,-4291.4203 1910.4177,-4273.1249 1976.5393,-4206.5165 1988.5078,-4185.1613 2058.0432,-4122.1249 2110.6624,-4074.4237 2145.2132,-4082.4562 2182.6875,-4022.1249 2289.7889,-3849.6986 2095.0559,-3657.511 2281.0071,-3576.1249"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1855.3937,-4347.3841C1883.3132,-4384.9767 1973.3712,-4510.3873 2022.0432,-4627.1249 2047.0984,-4687.2186 2025.7977,-4712.5631 2058.0432,-4769.1249 2096.744,-4837.0098 2137.4375,-4829.4181 2182.6875,-4893.1249 2226.3538,-4954.602 2259.601,-5038.4862 2273.6625,-5077.0994"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2270.446,-5078.499 2277.1125,-5086.7336 2277.0362,-5076.139 2270.446,-5078.499"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-3818.1304 344.7839,-3818.1304 344.7839,-3796.1195 453.3838,-3796.1195 453.3838,-3818.1304"/>
<text text-anchor="middle" x="399.0839" y="-3803.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-6505.1249C1972.4968,-6482.1145 1992.8075,-6411.7468 2120.3654,-6417.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.5071,-3813.4507C464.1789,-3817.2425 474.1601,-3823.1087 480.9653,-3832.1249 545.6049,-3917.7651 486.5407,-5660.2324 516.9653,-5763.1249 558.3711,-5903.1543 587.7106,-5938.3824 690.4731,-6042.1249 751.7289,-6103.9648 781.0268,-6102.5557 855.7932,-6147.1249 938.7964,-6196.6042 956.8862,-6214.8744 1045.6252,-6253.1249 1131.3334,-6290.069 1753.9109,-6512.9183 1846.9164,-6505.1249"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.1994,-1569.1304 1425.4195,-1569.1304 1425.4195,-1547.1195 1524.1994,-1547.1195 1524.1994,-1569.1304"/>
<text text-anchor="middle" x="1474.8094" y="-1554.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M453.3102,-3803.5307C463.9921,-3800.2564 474.0273,-3794.8578 480.9653,-3786.1249 535.0982,-3717.9881 487.4118,-2301.9759 516.9653,-2220.1249 664.9389,-1810.2996 1242.7913,-1621.2884 1421.7076,-1571.7897"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1422.7003,-1575.1468 1431.4218,-1569.1313 1420.8526,-1568.395 1422.7003,-1575.1468"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1159.8726,-3815.1304 1045.5427,-3815.1304 1045.5427,-3793.1195 1159.8726,-3793.1195 1159.8726,-3815.1304"/>
<text text-anchor="middle" x="1102.7076" y="-3800.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M445.3848,-3796.0338C540.3589,-3773.4103 748.8799,-3724.444 755.1332,-3729.1249"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M453.3462,-3797.1718C462.8594,-3794.3287 472.4341,-3790.7113 480.9653,-3786.1249 572.5655,-3736.8805 599.6048,-3717.4712 654.4731,-3629.1249 685.426,-3579.2862 652.3958,-3546.7578 690.4731,-3502.1249 696.3671,-3495.2163 704.1951,-3489.8033 712.364,-3485.5962"/>
<polygon fill="#1200ff" stroke="#1200ff" points="714.0135,-3488.6904 721.6469,-3481.3432 711.0978,-3482.3265 714.0135,-3488.6904"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-2633.1304 536.1602,-2633.1304 536.1602,-2611.1195 635.2783,-2611.1195 635.2783,-2633.1304"/>
<text text-anchor="middle" x="585.7192" y="-2618.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M453.4738,-3803.1914C464.0127,-3799.9167 473.9468,-3794.6036 480.9653,-3786.1249 521.3605,-3737.3265 511.3276,-3280.2222 516.9653,-3217.1249 537.0761,-2992.0471 572.5873,-2720.3437 582.8611,-2643.3628"/>
<polygon fill="#ff006d" stroke="#ff006d" points="586.3306,-2643.8227 584.1889,-2633.4466 579.3926,-2642.8936 586.3306,-2643.8227"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M453.4932,-3813.4612C464.1657,-3817.2525 474.1507,-3823.1158 480.9653,-3832.1249 539.1934,-3909.1038 489.0816,-5476.7196 516.9653,-5569.1249 598.1653,-5838.218 613.3639,-5960.8839 855.7932,-6103.1249 1050.8277,-6217.5579 1140.06,-6151.8568 1364.2236,-6122.1249 1448.7295,-6110.9165 1469.298,-6101.3019 1549.3953,-6072.1249 1640.5776,-6038.91 1665.2714,-6031.7957 1747.415,-5980.1249 1826.7987,-5930.1902 1838.2882,-5906.063 1910.4177,-5846.1249 1976.3197,-5791.3618 1985.0257,-5766.9638 2058.0432,-5722.1249 2149.8329,-5665.7584 2194.6433,-5691.4976 2281.0071,-5627.1249"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1528.5351,-2561.1304 1421.0838,-2561.1304 1421.0838,-2539.1195 1528.5351,-2539.1195 1528.5351,-2561.1304"/>
<text text-anchor="middle" x="1474.8094" y="-2546.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.2748,-3803.0239C463.825,-3799.7588 473.814,-3794.4919 480.9653,-3786.1249 535.9328,-3721.8135 481.621,-3483.9895 516.9653,-3407.1249 597.9645,-3230.9733 687.3685,-3234.737 819.7932,-3093.1249 973.4521,-2928.8055 1045.9595,-2912.1727 1159.79,-2718.1249 1185.1775,-2674.8467 1159.4882,-2645.7618 1195.79,-2611.1249 1223.9487,-2584.2577 1244.5702,-2603.2185 1280.0068,-2587.1249"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M453.275,-3813.6291C463.9587,-3817.4117 474.0035,-3823.2291 480.9653,-3832.1249 526.9799,-3890.9228 501.504,-4430.0806 516.9653,-4503.1249 561.8695,-4715.2665 556.6102,-4788.5343 690.4731,-4959.1249 745.5705,-5029.3393 770.5771,-5046.592 855.7932,-5073.1249 1317.3396,-5216.8322 1520.8489,-5093.3293 1910.4177,-4807.1249 1914.8133,-4803.8956 2179.2673,-4528.3736 2182.6875,-4524.1249 2217.2829,-4481.1501 2251.752,-4426.0813 2269.2281,-4397.0685"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2272.3527,-4398.6627 2274.4789,-4388.2834 2266.3442,-4395.0714 2272.3527,-4398.6627"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-1121.1304 358.7923,-1121.1304 358.7923,-1099.1195 439.3754,-1099.1195 439.3754,-1121.1304"/>
<text text-anchor="middle" x="399.0839" y="-1106.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2444.4712,-568.1249C2471.8803,-582.2954 2482.6291,-577.1656 2509.6157,-592.1249 2542.6123,-610.4157 2544.6461,-624.2439 2576.7096,-644.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2576.7096,-644.1249C2591.78,-653.4694 2595.1253,-656.7274 2607.8035,-669.1249 2660.5485,-720.7025 2645.8182,-769.6609 2714.6799,-796.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-303.1249C2147.7237,-320.1296 2156.1029,-321.9344 2182.6875,-340.1249 2228.4941,-371.4681 2233.6169,-388.2319 2281.0071,-417.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2714.6799,-796.1249C2790.3298,-825.1977 2859.6998,-895.387 2890.117,-929.24"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2887.7458,-931.8422 2896.9911,-937.0167 2892.9906,-927.2061 2887.7458,-931.8422"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-115.1249C1662.6617,-107.8077 1795.313,-101.0871 2120.3654,-303.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-417.1249C2305.52,-432.0701 2319.5551,-418.0266 2343.3267,-434.1249 2405.1092,-475.9647 2378.1888,-533.857 2444.4712,-568.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.0467,-1098.9135C414.0835,-1053.8992 461.3406,-882.2265 516.9653,-747.1249 573.0665,-610.8662 734.8605,-261.3216 855.7932,-177.1249 1012.1683,-68.2523 1089.6991,-105.6706 1280.0068,-115.1249"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1474.8094,-4183.1249C1502.2797,-4202.6946 1516.9034,-4188.077 1549.3953,-4197.1249 1639.9048,-4222.3289 1663.5705,-4228.7301 1747.415,-4271.1249 1774.8803,-4285.0124 1804.1186,-4304.7826 1823.7402,-4318.8662"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1821.8905,-4321.8486 1832.0379,-4324.8953 1826.0053,-4316.1856 1821.8905,-4321.8486"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M426.0151,-1121.1991C445.0766,-1130.6174 469.2533,-1146.1384 480.9653,-1168.1249 519.4766,-1240.4207 465.4689,-2578.4232 516.9653,-2642.1249 556.4771,-2691.0015 614.5313,-2626.5992 654.4731,-2675.1249 714.9003,-2748.5385 637.507,-3451.1592 690.4731,-3530.1249 736.3765,-3598.561 1312.2488,-3776.1778 1364.2236,-3840.1249 1409.3762,-3895.6783 1378.8363,-3928.8057 1400.2236,-3997.1249 1426.8321,-4082.1228 1404.354,-4128.6393 1474.8094,-4183.1249"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2021.8569,-1759.1304 1946.6041,-1759.1304 1946.6041,-1737.1195 2021.8569,-1737.1195 2021.8569,-1759.1304"/>
<text text-anchor="middle" x="1984.2305" y="-1744.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M585.7192,-961.1249C659.0905,-944.213 679.8549,-959.5359 755.1332,-961.1249"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M406.6061,-1099.0969C423.5547,-1075.0396 467.1594,-1017.4207 516.9653,-985.1249 544.1214,-967.516 554.1807,-968.3945 585.7192,-961.1249"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M755.1332,-961.1249C801.1148,-962.0955 810.116,-942.495 855.7932,-937.1249 923.6954,-929.142 944.0271,-917.8555 1009.6252,-937.1249 1203.3135,-994.0208 1594.1874,-1335.6959 1747.415,-1467.1249 1822.602,-1531.6156 1856.3998,-1536.0937 1910.4177,-1619.1249 1937.0913,-1660.1251 1916.4309,-1684.4819 1946.4177,-1723.1249 1948.6069,-1725.9461 1951.208,-1728.5525 1954.0062,-1730.9318"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1952.1161,-1733.8873 1962.2357,-1737.0252 1956.2816,-1728.2616 1952.1161,-1733.8873"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M425.9665,-1121.2251C445.0032,-1130.6567 469.1702,-1146.1829 480.9653,-1168.1249 540.1811,-1278.2816 502.1177,-2168.9454 516.9653,-2293.1249 531.0646,-2411.0449 566.2013,-2549.4122 580.014,-2601.1841"/>
<polygon fill="#ff006d" stroke="#ff006d" points="576.6444,-2602.1317 582.6225,-2610.8788 583.4039,-2600.3128 576.6444,-2602.1317"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M585.7192,-799.1249C604.267,-772.6013 634.1977,-800.3526 654.4731,-775.1249 738.8757,-670.1073 605.2937,-578.5134 690.4731,-474.1249 728.7663,-427.1962 776.8274,-473.817 819.7932,-431.1249 855.0868,-396.0562 826.9655,-365.6764 855.7932,-325.1249 855.9143,-324.9546 1045.4276,-177.1929 1045.6252,-177.1249 1104.9484,-156.7323 1403.2652,-133.5153 1747.415,-213.1249 1876.1703,-242.9089 1902.2055,-271.412 2022.0432,-327.1249 2094.917,-361.0041 2116.2594,-364.8955 2182.6875,-410.1249 2278.6632,-475.4727 2279.489,-522.845 2379.3267,-582.1249 2405.8578,-597.8781 2416.582,-592.9245 2444.4712,-606.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2444.4712,-606.1249C2530.6401,-646.2037 2548.3484,-669.9866 2607.8035,-744.1249 2614.2097,-752.1133 2678.8193,-877.9831 2704.3649,-927.9292"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2701.3887,-929.7965 2709.0567,-937.1076 2707.6216,-926.6104 2701.3887,-929.7965"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M405.0085,-1099.044C427.0634,-1058.0737 507.1827,-911.7123 585.7192,-799.1249"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-961.1249C916.2849,-965.2061 1264.3766,-1228.5663 1364.2236,-1355.1249 1394,-1392.8672 1369.0218,-1420.5523 1400.2236,-1457.1249 1449.1883,-1514.5179 1493.3835,-1487.5861 1549.3953,-1538.1249 1617.7668,-1599.816 1605.3833,-1640.1554 1666.4052,-1709.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-1709.1249C1738.2921,-1792.8531 1808.1948,-1905.3424 1835.2091,-1950.327"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1832.3157,-1952.3085 1840.4467,-1959.101 1838.3262,-1948.7205 1832.3157,-1952.3085"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-2629.1249C2301.1128,-2649.963 2323.7565,-2626.7831 2343.3267,-2648.1249 2406.241,-2716.7348 2435.7889,-3019.9463 2442.795,-3103.0176"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2439.3107,-3103.3541 2443.6192,-3113.0333 2446.2871,-3102.7799 2439.3107,-3103.3541"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-961.1249C743.6231,-924.7284 1770.8145,-1488.8493 1910.4177,-1571.1249 1963.4514,-1602.3805 1993.1246,-1598.7816 2022.0432,-1653.1249 2068.067,-1739.6122 1996.7138,-2457.725 2058.0432,-2534.1249 2093.9167,-2578.8136 2130.1472,-2544.2446 2182.6875,-2567.1249 2230.0515,-2587.7511 2245.1368,-2591.9482 2281.0071,-2629.1249"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2164.15,-4013.1304 2076.5807,-4013.1304 2076.5807,-3991.1195 2164.15,-3991.1195 2164.15,-4013.1304"/>
<text text-anchor="middle" x="2120.3654" y="-3998.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M418.9168,-1121.1523C436.6013,-1131.6451 462.4769,-1148.6853 480.9653,-1168.1249 580.0422,-1272.2989 582.8074,-1316.4956 654.4731,-1441.1249 915.4099,-1894.9035 861.3369,-2084.4538 1195.79,-2487.1249 1394.4059,-2726.2522 1566.8293,-2664.1053 1747.415,-2917.1249 1815.0804,-3011.9313 2070.4488,-3839.2916 2114.0232,-3981.394"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2110.7148,-3982.5437 2116.9906,-3991.0798 2117.4078,-3980.4932 2110.7148,-3982.5437"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-799.1249C604.2516,-772.5905 624.743,-787.9174 654.4731,-775.1249 746.9821,-735.3196 763.5101,-711.451 855.7932,-671.1249 1003.0423,-606.7797 1037.5102,-575.8752 1195.79,-548.1249 1350.6023,-520.9826 1393.7769,-531.0691 1549.3953,-553.1249 1837.7125,-593.9881 1944.7816,-553.204 2182.6875,-721.1249 2205.3547,-737.1241 2196.2042,-755.8683 2218.6875,-772.1249 2265.6175,-806.0578 2290.104,-787.2949 2343.3267,-810.1249 2421.3486,-843.5926 2464.304,-832.3311 2509.6157,-904.1249 2561.4403,-986.238 2574.4526,-1710.207 2576.4221,-1843.9343"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2572.9246,-1844.1432 2576.5669,-1854.0923 2579.9239,-1844.0434 2572.9246,-1844.1432"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-3627.1304 350.2841,-3627.1304 350.2841,-3605.1195 447.8836,-3605.1195 447.8836,-3627.1304"/>
<text text-anchor="middle" x="399.0839" y="-3612.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-5859.1249C1008.0171,-5936.9918 981.3259,-5987.9462 1045.6252,-6075.1249 1101.4324,-6150.7897 1119.4949,-6169.1828 1195.79,-6224.1249 1278.3506,-6283.579 1302.5033,-6298.8093 1400.2236,-6327.1249 1514.3932,-6360.207 1548.1207,-6341.3818 1666.4052,-6353.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M585.7192,-4147.1249C593.4369,-4157.6905 807.0821,-4170.0231 819.7932,-4173.1249 1197.4794,-4265.2889 1302.9923,-4531.227 1666.4052,-4393.1249"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1666.4052,-4393.1249C1717.6733,-4372.9239 1730.642,-4367.9839 1783.415,-4352.1249 1785.9805,-4351.354 1788.6117,-4350.5894 1791.2748,-4349.8365"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1792.2779,-4353.1907 1800.9967,-4347.1713 1790.4272,-4346.4398 1792.2779,-4353.1907"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M408.7305,-3627.3655C426.514,-3648.8082 464.1794,-3697.7414 480.9653,-3746.1249 530.6269,-3889.2688 448.1575,-3950.1363 516.9653,-4085.1249 535.6516,-4121.7839 561.859,-4113.6026 585.7192,-4147.1249"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1540.3045,-617.1304 1409.3144,-617.1304 1409.3144,-595.1195 1540.3045,-595.1195 1540.3045,-617.1304"/>
<text text-anchor="middle" x="1474.8094" y="-602.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M401.6698,-3605.0299C413.5075,-3553.6603 462.7317,-3333.6305 480.9653,-3150.1249 489.158,-3067.6735 477.5921,-1732.0297 516.9653,-1659.1249 552.2632,-1593.7662 602.8852,-1617.5702 654.4731,-1564.1249 964.4833,-1242.9537 940.3901,-1084.2235 1195.79,-718.1249 1231.221,-667.3371 1221.8045,-585.9767 1280.0068,-607.1249"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="801.757,-505.1304 708.5093,-505.1304 708.5093,-483.1195 801.757,-483.1195 801.757,-505.1304"/>
<text text-anchor="middle" x="755.1332" y="-490.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M401.6716,-3605.0301C413.5175,-3553.6613 462.7725,-3333.6346 480.9653,-3150.1249 497.6207,-2982.1233 456.9005,-1788.9037 516.9653,-1631.1249 550.5655,-1542.8638 618.8887,-1556.6049 654.4731,-1469.1249 698.2848,-1361.4192 678.2499,-1062.7562 690.4731,-947.1249 708.1205,-780.1822 740.6904,-580.19 751.5234,-515.4555"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="755.0252,-515.7364 753.2317,-505.2945 748.1221,-514.5758 755.0252,-515.7364"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M409.0398,-3627.2641C427.3388,-3648.5376 465.829,-3697.2003 480.9653,-3746.1249 543.209,-3947.3129 474.9632,-4486.7595 516.9653,-4693.1249 560.2131,-4905.6104 568.8475,-4969.6043 690.4731,-5149.1249 746.4572,-5231.7579 769.617,-5250.7655 855.7932,-5301.1249 886.8279,-5319.2609 901.5395,-5308.2222 932.7092,-5326.1249"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M932.7092,-5326.1249C1020.7892,-5376.2669 1003.1237,-5459.2746 1102.7076,-5478.1249"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1909.6556,-5411.1304 1784.1771,-5411.1304 1784.1771,-5389.1195 1909.6556,-5389.1195 1909.6556,-5411.1304"/>
<text text-anchor="middle" x="1846.9164" y="-5396.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M585.7192,-5479.1249C659.1127,-5601.7956 1054.6968,-5660.16 1195.79,-5683.1249 1269.6771,-5695.1511 1293.6887,-5708.1999 1364.2236,-5683.1249 1423.9321,-5661.8987 1411.6848,-5598.6864 1474.8094,-5593.1249"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M409.1157,-3627.2409C427.5413,-3648.4759 466.2339,-3697.0768 480.9653,-3746.1249 534.5768,-3924.624 435.1654,-5255.6588 516.9653,-5423.1249 534.2626,-5458.5369 566.3856,-5444.7823 585.7192,-5479.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M401.6542,-3605.0283C413.4231,-3553.6518 462.3887,-3333.5961 480.9653,-3150.1249 495.4209,-3007.3547 469.2194,-1994.4491 516.9653,-1859.1249 559.3339,-1739.0416 590.603,-1710.1253 690.4731,-1631.1249 802.9106,-1542.1834 1147.9711,-1313.2737 1280.0068,-1369.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="987.8473,-4955.1304 877.5712,-4955.1304 877.5712,-4933.1195 987.8473,-4933.1195 987.8473,-4955.1304"/>
<text text-anchor="middle" x="932.7092" y="-4940.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M408.818,-3627.3356C426.7475,-3648.7284 464.6463,-3697.582 480.9653,-3746.1249 539.9597,-3921.6111 434.4809,-3995.3779 516.9653,-4161.1249 553.6297,-4234.7995 617.7544,-4211.4774 654.4731,-4285.1249 735.6971,-4448.0373 626.3829,-4522.7424 690.4731,-4693.1249 734.2883,-4809.6066 754.9965,-4846.1334 855.7932,-4919.1249 861.2182,-4923.0534 867.2922,-4926.3859 873.5849,-4929.2081"/>
<polygon fill="#00ffc8" stroke="#00ffc8" points="872.3283,-4932.4753 882.9107,-4932.9878 874.9576,-4925.9879 872.3283,-4932.4753"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1158.5244,-4653.1304 1046.8908,-4653.1304 1046.8908,-4631.1195 1158.5244,-4631.1195 1158.5244,-4653.1304"/>
<text text-anchor="middle" x="1102.7076" y="-4638.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M585.7192,-4147.1249C604.7955,-4171.794 631.2957,-4140.2618 654.4731,-4161.1249 693.9636,-4196.6723 668.6622,-4226.675 690.4731,-4275.1249 776.4144,-4466.0309 730.1624,-4732.0944 932.7092,-4679.1249"/>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M932.7092,-4679.1249C966.4052,-4668.6214 1004.7595,-4659.9976 1036.4988,-4653.726"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1037.4075,-4657.115 1046.557,-4651.773 1036.0732,-4650.2433 1037.4075,-4657.115"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.3583,-5221.1304 1425.2606,-5221.1304 1425.2606,-5199.1195 1524.3583,-5199.1195 1524.3583,-5221.1304"/>
<text text-anchor="middle" x="1474.8094" y="-5206.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M408.9961,-3627.2777C427.2224,-3648.5739 465.5962,-3697.2729 480.9653,-3746.1249 531.5067,-3906.7745 461.2792,-4344.1854 516.9653,-4503.1249 551.4325,-4601.5011 615.7605,-4596.3407 654.4731,-4693.1249 698.779,-4803.8926 635.2839,-4853.358 690.4731,-4959.1249 807.8838,-5184.1355 945.3021,-5184.2492 1195.79,-5225.1249 1270.6099,-5237.3344 1358.0572,-5229.0479 1414.8344,-5220.7389"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1415.7044,-5224.1472 1425.0691,-5219.1921 1414.6583,-5217.2258 1415.7044,-5224.1472"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1548.0641,-3173.1304 1401.5548,-3173.1304 1401.5548,-3151.1195 1548.0641,-3151.1195 1548.0641,-3173.1304"/>
<text text-anchor="middle" x="1474.8094" y="-3158.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M585.7192,-3421.1249C798.8631,-3278.2028 985.9846,-3547.9336 1159.79,-3359.1249 1225.7049,-3287.5202 1130.9482,-3215.7027 1195.79,-3143.1249 1221.7203,-3114.1011 1242.8105,-3130.5788 1280.0068,-3119.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M585.7192,-3615.1249C631.0958,-3615.4051 719.1401,-3701.4914 755.1332,-3729.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M585.7192,-3615.1249C618.0841,-3615.3248 631.0388,-3613.4488 654.4731,-3591.1249 685.3678,-3561.6943 661.0657,-3533.0417 690.4731,-3502.1249 696.608,-3495.6752 704.4,-3490.4815 712.4337,-3486.3472"/>
<polygon fill="#1200ff" stroke="#1200ff" points="713.9379,-3489.5077 721.5313,-3482.1191 710.9877,-3483.1598 713.9379,-3489.5077"/>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M448.2034,-3615.5528C485.8403,-3615.1893 539.0606,-3614.8368 585.7192,-3615.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1846.9164,-1748.1249C1876.4347,-1752.0601 1909.8408,-1752.1549 1936.3119,-1751.2202"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1936.6149,-1754.7107 1946.4616,-1750.8001 1936.3254,-1747.7167 1936.6149,-1754.7107"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M585.7192,-1873.1249C699.0573,-1685.149 829.9323,-1733.831 1045.6252,-1693.1249 1190.4599,-1665.7914 1199.359,-1557.2732 1747.415,-1695.1249 1796.0066,-1707.3471 1797.2507,-1741.5038 1846.9164,-1748.1249"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M401.6405,-3605.0269C413.349,-3553.6443 462.0878,-3333.5654 480.9653,-3150.1249 507.2524,-2894.6826 447.9328,-2242.4633 516.9653,-1995.1249 533.6971,-1935.1762 547.9046,-1922.5603 585.7192,-1873.1249"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1725.7407,-4481.1304 1607.0696,-4481.1304 1607.0696,-4459.1195 1725.7407,-4459.1195 1725.7407,-4481.1304"/>
<text text-anchor="middle" x="1666.4052" y="-4466.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M585.7192,-4147.1249C603.3386,-4172.8547 625.2472,-4150.2479 654.4731,-4161.1249 913.0722,-4257.3684 928.8439,-4395.2963 1195.79,-4465.1249 1268.2126,-4484.0694 1289.5574,-4470.4985 1364.2236,-4465.1249 1413.7565,-4461.5602 1425.2837,-4445.462 1474.8094,-4449.1249"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1524.9367,-3739.1304 1424.6822,-3739.1304 1424.6822,-3717.1195 1524.9367,-3717.1195 1524.9367,-3739.1304"/>
<text text-anchor="middle" x="1474.8094" y="-3724.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M1102.7076,-3957.1249C1250.8171,-3908.5055 1400.9242,-3790.3733 1454.3772,-3745.6633"/>
<polygon fill="#ff00a3" stroke="#ff00a3" points="1456.7237,-3748.2629 1462.111,-3739.14 1452.2104,-3742.9121 1456.7237,-3748.2629"/>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M414.2544,-3627.1753C502.9448,-3691.2105 955.4689,-4010.0085 1102.7076,-3957.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M401.4202,-3605.0013C412.1556,-3553.5055 457.2383,-3333.0014 480.9653,-3150.1249 505.4698,-2961.2569 453.292,-2902.6167 516.9653,-2723.1249 528.2703,-2691.2568 552.1555,-2659.9142 568.5701,-2640.7995"/>
<polygon fill="#ff006d" stroke="#ff006d" points="571.3197,-2642.973 575.3015,-2633.1549 566.0661,-2638.347 571.3197,-2642.973"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M932.7092,-5859.1249C1050.919,-5965.2666 1047.7775,-6043.4024 1195.79,-6101.1249 1265.5335,-6128.3238 1290.7791,-6115.6105 1364.2236,-6101.1249 1451.5028,-6083.9107 1468.4796,-6062.0929 1549.3953,-6025.1249 1639.0736,-5984.1536 1666.2729,-5981.1322 1747.415,-5925.1249 1824.3896,-5871.9943 1975.1172,-5684.3824 2058.0432,-5641.1249 2083.2135,-5627.9951 2093.5576,-5636.4672 2120.3654,-5627.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M409.1197,-3627.2397C427.5518,-3648.4727 466.255,-3697.0705 480.9653,-3746.1249 536.7337,-3932.0954 436.2399,-5316.5505 516.9653,-5493.1249 551.1817,-5567.9679 597.6978,-5557.5532 654.4731,-5617.1249 671.9051,-5635.4155 672.6306,-5643.2347 690.4731,-5661.1249 757.6596,-5728.4909 782.0174,-5737.0473 855.7932,-5797.1249 889.8404,-5824.8505 900.4355,-5829.3538 932.7092,-5859.1249"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1348.4046,-2025.1304 1211.6091,-2025.1304 1211.6091,-2003.1195 1348.4046,-2003.1195 1348.4046,-2025.1304"/>
<text text-anchor="middle" x="1280.0068" y="-2010.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.4972,-3605.0109C412.5724,-3553.5576 458.9319,-3333.2131 480.9653,-3150.1249 510.1284,-2907.7929 451.7362,-2837.328 516.9653,-2602.1249 561.9863,-2439.7884 559.0941,-2370.5744 690.4731,-2265.1249 804.8607,-2173.3133 902.05,-2280.8318 1009.6252,-2181.1249 1045.4991,-2147.875 1012.1763,-2112.8134 1045.6252,-2077.1249 1064.4454,-2057.0447 1077.0737,-2063.1406 1102.7076,-2053.1249"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-2251.1304 517.2105,-2251.1304 517.2105,-2229.1195 654.2279,-2229.1195 654.2279,-2251.1304"/>
<text text-anchor="middle" x="585.7192" y="-2236.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.601,-3605.0228C413.1347,-3553.6217 461.217,-3333.4737 480.9653,-3150.1249 491.5045,-3052.2762 458.8776,-2344.5684 516.9653,-2265.1249 519.2752,-2261.9658 522.0251,-2259.205 525.0756,-2256.7924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="527.2559,-2259.5508 533.7567,-2251.1848 523.4577,-2253.6708 527.2559,-2259.5508"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.6091,-3605.0236C413.179,-3553.6265 461.3971,-3333.493 480.9653,-3150.1249 491.9385,-3047.2981 481.0837,-2317.1109 516.9653,-2220.1249 560.0532,-2103.6609 584.9856,-2066.6446 690.4731,-2001.1249 1060.9396,-1771.0235 1253.1996,-1759.6502 1666.4052,-1899.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.9555,-3604.8637C413.5839,-3529.2387 486.7531,-3096.7901 516.9653,-3046.1249 634.877,-2848.39 703.1062,-2753.9982 932.7092,-2737.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3615.1249C776.1227,-3616.3005 831.3822,-3620.0897 1009.6252,-3553.1249 1084.0025,-3525.1819 1108.669,-3516.9478 1159.79,-3456.1249 1186.1869,-3424.7184 1163.8616,-3396.888 1195.79,-3371.1249 1332.9579,-3260.4438 1409.9596,-3314.0851 1585.3953,-3297.1249 1703.7608,-3285.682 2025.6867,-3238.1716 2120.3654,-3310.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M408.0339,-3627.1899C424.9825,-3648.7243 461.7787,-3698.3547 480.9653,-3746.1249 510.7229,-3820.2141 467.8816,-3859.1527 516.9653,-3922.1249 680.6817,-4132.1656 1402.9035,-4299.6868 1666.4052,-4261.1249"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1666.4052,-4261.1249C1839.9032,-4243.7759 1821.4148,-4093.5237 1984.2305,-4031.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M408.9719,-3627.2853C427.1578,-3648.5943 465.4669,-3697.3138 480.9653,-3746.1249 526.8271,-3890.5634 436.5504,-4298.6757 516.9653,-4427.1249 554.0185,-4486.311 615.4923,-4445.1903 654.4731,-4503.1249 729.9321,-4615.2746 630.25,-4684.1093 690.4731,-4805.1249 735.8918,-4896.3915 761.2343,-4926.0323 855.7932,-4964.1249 1143.4425,-5080.0031 1258.9079,-4996.6927 1549.3953,-4888.1249 1724.1166,-4822.824 1761.9875,-4787.0861 1910.4177,-4674.1249 1946.64,-4646.5584 1948.4363,-4631.2451 1984.2305,-4603.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-5479.1249C605.9045,-5514.9803 628.9804,-5508.8267 654.4731,-5541.1249 675.1745,-5567.3527 663.9631,-5586.7863 690.4731,-5607.1249 930.5022,-5791.2762 1064.1056,-5742.2674 1364.2236,-5704.1249 1538.7194,-5681.948 1588.9056,-5681.3833 1747.415,-5605.1249 1840.8049,-5560.1953 2061.1233,-5410.1586 2120.3654,-5325.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2120.3654,-5325.1249C2143.2091,-5293.4281 2160.5264,-5295.3028 2182.6875,-5263.1249 2205.0327,-5230.6797 2198.831,-5216.1502 2218.6875,-5182.1249 2232.4827,-5158.4861 2251.6369,-5133.564 2265.0573,-5117.0644"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2267.8344,-5119.198 2271.494,-5109.2552 2262.4327,-5114.7457 2267.8344,-5119.198"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-3421.1249C639.7179,-3381.1426 628.6564,-3338.4525 690.4731,-3312.1249 786.4435,-3271.2515 1080.198,-3388.5495 1159.79,-3321.1249 1234.0503,-3258.217 1129.3421,-3176.2352 1195.79,-3105.1249 1211.895,-3087.89 1999.8047,-2916.99 2022.0432,-2909.1249 2185.4383,-2851.3373 2233.9105,-2822.5327 2343.3267,-2688.1249 2399.7981,-2618.7549 2371.9428,-2566.4782 2444.4712,-2514.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M407.2079,-3604.9951C431.234,-3572.7331 505.3132,-3477.8629 585.7192,-3421.1249"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2327.6412,-2679.1304 2234.373,-2679.1304 2234.373,-2657.1195 2327.6412,-2657.1195 2327.6412,-2679.1304"/>
<text text-anchor="middle" x="2281.0071" y="-2664.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.3034,-3605.09C421.0212,-3540.9509 515.0716,-3218.9085 516.9653,-3217.1249 680.5702,-3063.034 795.7815,-3172.2727 1009.6252,-3103.1249 1040.5784,-3093.116 1520.8501,-2891.7278 1549.3953,-2876.1249 1600.192,-2848.3593 1928.9206,-2572.0351 1984.2305,-2589.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-2589.1249C1504.9076,-2572.8682 1519.3046,-2586.3956 1549.3953,-2570.1249 1568.4879,-2559.8011 1566.5661,-2547.9218 1585.3953,-2537.1249 1592.6454,-2532.9676 1600.6647,-2529.4246 1608.7553,-2526.4279"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1609.9305,-2529.725 1618.2439,-2523.157 1607.6491,-2523.1072 1609.9305,-2529.725"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.4204,-3604.8453C401.5128,-3551.8905 416.2503,-3324.4398 516.9653,-3179.1249 617.1004,-3034.6468 1048.1507,-2853.9101 1159.79,-2718.1249 1184.2947,-2688.3203 1165.3146,-2662.7901 1195.79,-2639.1249 1208.2283,-2629.4663 1460.9534,-2596.6089 1474.8094,-2589.1249"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1873.1249C599.3909,-1855.2518 1342.694,-1655.6698 1364.2236,-1649.1249 1608.1122,-1574.985 1667.7392,-1552.1346 1910.4177,-1474.1249 1960.0443,-1458.1723 1977.3771,-1464.9991 2022.0432,-1438.1249 2041.1644,-1426.6203 2038.5819,-1414.0443 2058.0432,-1403.1249 2058.4572,-1402.8926 2058.8747,-1402.6636 2059.2954,-1402.4379"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2060.9215,-1405.5419 2068.5218,-1398.1605 2057.9772,-1399.1912 2060.9215,-1405.5419"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-568.1249C2353.6574,-567.8988 2379.9352,-534.7599 2444.4712,-568.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1540.1782,-595.3923C1665.0166,-576.2334 1946.0127,-539.5459 2182.6875,-555.1249 2226.6702,-558.0201 2236.9294,-568.2621 2281.0071,-568.1249"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1846.9164,-683.1249C1925.9392,-676.271 1905.6325,-579.7998 1984.2305,-569.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1516.1055,-617.2134C1527.231,-620.9317 1539.0446,-625.5743 1549.3953,-631.1249 1567.2586,-640.7043 1567.3652,-649.8632 1585.3953,-659.1249 1618.7973,-676.2829 1630.9588,-670.7294 1666.4052,-683.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1666.4052,-683.1249C1742.1354,-709.6076 1766.9892,-690.0573 1846.9164,-683.1249"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-683.1249C1701.7564,-695.7892 1714.4414,-689.1573 1747.415,-707.1249 1761.4129,-714.7525 2175.1261,-1067.0912 2182.6875,-1081.1249 2233.5896,-1175.5977 2419.2594,-2889.717 2442.1513,-3102.5084"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2438.699,-3103.1409 2443.2477,-3112.7096 2445.6589,-3102.3928 2438.699,-3103.1409"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2444.4712,-1024.1249C2559.9064,-1148.2414 2574.6445,-1725.0421 2576.4618,-1843.7345"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2572.9661,-1844.0833 2576.6036,-1854.0342 2579.9655,-1843.9869 2572.9661,-1844.0833"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1846.9164,-683.1249C1876.8132,-679.0645 1883.2306,-694.0418 1910.4177,-707.1249 1925.9628,-714.6056 2432.7224,-1011.4926 2444.4712,-1024.1249"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M770.2202,-482.9219C784.7724,-471.3988 806.4948,-452.2002 819.7932,-431.1249 846.344,-389.0475 826.9655,-365.6764 855.7932,-325.1249 856.0353,-324.7843 1045.2509,-177.3106 1045.6252,-177.1249 1142.158,-129.2496 1172.3083,-111.7125 1280.0068,-115.1249"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M796.4993,-483.0243C804.8171,-479.5036 813.0604,-474.9551 819.7932,-469.1249 844.4646,-447.7612 831.2491,-426.6348 855.7932,-405.1249 972.3895,-302.9426 1040.7652,-328.9156 1195.79,-327.1249 1352.9399,-325.3097 1392.7601,-312.2872 1549.3953,-325.1249 1761.5908,-342.5164 1818.8175,-339.6529 2022.0432,-403.1249 2097.4361,-426.6718 2129.8639,-420.4035 2182.6875,-479.1249 2215.1191,-515.1776 2180.6842,-552.0026 2218.6875,-582.1249 2297.7716,-644.8088 2352.6269,-564.3135 2444.4712,-606.1249"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M791.1937,-483.1024C879.5693,-457.0789 1103.8176,-397.3395 1159.79,-443.1249 1222.2639,-494.2286 1139.8417,-562.9497 1195.79,-621.1249 1307.9038,-737.7012 1394.3856,-660.9564 1549.3953,-707.1249 1562.0348,-710.8895 2435.3495,-1014.6 2444.4712,-1024.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1330.1598,-4309.1304 1229.8539,-4309.1304 1229.8539,-4287.1195 1330.1598,-4287.1195 1330.1598,-4309.1304"/>
<text text-anchor="middle" x="1280.0068" y="-4294.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.9544,-4309.2274C1289.833,-4412.6827 1359.0291,-5206.4299 1400.2236,-5303.1249 1531.6861,-5611.7038 1671.663,-5659.4496 1984.2305,-5781.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1666.4052,-4337.1249C1701.5659,-4335.3188 1740.6292,-4334.9053 1773.3989,-4335.01"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1773.7873,-4338.5118 1783.8043,-4335.061 1773.8217,-4331.5119 1773.7873,-4338.5118"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1281.4048,-4309.4217C1290.4973,-4381.8242 1342.6643,-4781.0989 1400.2236,-4888.1249 1455.3254,-4990.5814 1497.8651,-4996.4959 1585.3953,-5073.1249 1653.6219,-5132.8546 1699.3594,-5120.2279 1747.415,-5197.1249 1790.1896,-5265.5713 1731.5638,-5313.2702 1783.415,-5375.1249 1786.198,-5378.4448 1789.4813,-5381.3263 1793.0653,-5383.8269"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1791.4833,-5386.9566 1801.8797,-5388.9976 1795.0252,-5380.9188 1791.4833,-5386.9566"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1281.7005,-4286.9023C1291.6211,-4220.6691 1342.5001,-3874.0155 1364.2236,-3589.1249 1400.0298,-3119.5496 1374.2021,-3000.344 1400.2236,-2530.1249 1421.3608,-2148.1677 1463.3161,-1682.9679 1472.8508,-1579.2703"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1476.3504,-1579.4349 1473.7836,-1569.1558 1469.38,-1578.792 1476.3504,-1579.4349"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M1285.7352,-4286.8371C1301.3613,-4255.4711 1344.8474,-4164.225 1364.2236,-4083.1249 1403.1313,-3920.2754 1380.889,-3874.4377 1400.2236,-3708.1249 1424.0289,-3503.357 1460.6006,-3256.4819 1471.5833,-3183.4483"/>
<polygon fill="#005bff" stroke="#005bff" points="1475.0905,-3183.6625 1473.1204,-3173.2525 1468.1687,-3182.619 1475.0905,-3183.6625"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1283.1906,-4286.8802C1296.056,-4240.8882 1344.458,-4062.4154 1364.2236,-3912.1249 1386.5597,-3742.2894 1350.5515,-3306.063 1400.2236,-3142.1249 1443.6169,-2998.9095 1685.0054,-2701.1347 1747.415,-2565.1249 1843.837,-2354.9921 1848.3731,-2293.8433 1910.4177,-2071.1249 1941.7691,-1958.5845 1969.8333,-1821.3143 1980.0934,-1769.3866"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1983.5663,-1769.8649 1982.0586,-1759.3779 1976.6974,-1768.5161 1983.5663,-1769.8649"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1474.8094,-4335.1249C1508.041,-4345.5322 1523.7461,-4335.5713 1549.3953,-4359.1249 1579.9151,-4387.1513 1554.7081,-4417.2819 1585.3953,-4445.1249 1589.483,-4448.8338 1594.1114,-4451.9925 1599.0344,-4454.6827"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1597.6282,-4457.8897 1608.1608,-4459.0366 1600.6423,-4451.5718 1597.6282,-4457.8897"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2120.3654,-5551.1249C2199.338,-5552.4257 2217.6798,-5674.3269 2281.0071,-5627.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1280.9462,-4309.4069C1289.3553,-4409.6032 1352.4934,-5145.364 1400.2236,-5230.1249 1441.8373,-5304.0237 1494.8636,-5284.1709 1549.3953,-5349.1249 1570.8795,-5374.7154 1559.0031,-5394.6335 1585.3953,-5415.1249 1682.2837,-5490.3513 1997.7183,-5549.1047 2120.3654,-5551.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-2551.1249C1682.3624,-2517.7634 1722.2006,-2559.1778 1747.415,-2532.1249 1781.6401,-2495.4044 1774.7933,-2358.5761 1783.415,-2309.1249 1804.4424,-2188.5198 1832.3872,-2044.3258 1842.7876,-1991.1509"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1846.2439,-1991.713 1844.7318,-1981.2267 1839.3745,-1990.3672 1846.2439,-1991.713"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1286.0222,-4286.9007C1302.3816,-4255.6969 1347.5683,-4164.8272 1364.2236,-4083.1249 1378.0674,-4015.215 1363.9328,-2895.1706 1400.2236,-2836.1249 1439.7271,-2771.8523 1495.4316,-2807.845 1549.3953,-2755.1249 1624.1601,-2682.083 1621.3046,-2645.4162 1666.4052,-2551.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.4552,-4287.0273C1335.9676,-4283.0965 1350.8695,-4278.3405 1364.2236,-4273.1249 1540.9252,-4204.1128 1584.4455,-4182.2178 1747.415,-4085.1249 1823.8034,-4039.6148 1843.3711,-4027.5295 1910.4177,-3969.1249 2091.4427,-3811.4335 2062.4241,-3675.413 2281.0071,-3576.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1330.4317,-4304.4284C1370.2307,-4310.182 1426.8467,-4320.1042 1474.8094,-4335.1249"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1474.8094,-4335.1249C1508.041,-4345.5322 1516.7747,-4323.313 1549.3953,-4311.1249 1602.3716,-4291.3312 1610.4478,-4269.314 1666.4052,-4261.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2120.3654,-4451.1249C2168.1,-4435.9483 2220.2267,-4410.0665 2251.7664,-4393.2846"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2253.7168,-4396.2098 2260.866,-4388.3905 2250.4011,-4390.0449 2253.7168,-4396.2098"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1474.8094,-4335.1249C1509.7535,-4346.0685 1519.5701,-4348.8809 1549.3953,-4370.1249 1568.0831,-4383.436 1564.577,-4397.4802 1585.3953,-4407.1249 1673.6461,-4448.0102 1925.3174,-4426.9295 2022.0432,-4437.1249 2065.9395,-4441.7518 2078.3007,-4464.4989 2120.3654,-4451.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1474.8094,-4335.1249C1555.6981,-4359.9917 1524.3842,-4431.4822 1585.3953,-4490.1249 1709.9127,-4609.8089 1775.6437,-4595.1211 1910.4177,-4703.1249 1916.7631,-4708.21 2115.3686,-4900.7098 2120.3654,-4907.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1474.8094,-4335.1249C1556.8217,-4358.0581 1581.359,-4341.4935 1666.4052,-4337.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1666.4052,-4337.1249C1722.3905,-4334.2491 1861.2384,-4300.0325 1910.4177,-4273.1249 2054.803,-4194.1272 2069.9976,-4142.0781 2182.6875,-4022.1249 2277.577,-3921.1195 2261.1834,-3852.5699 2379.3267,-3780.1249 2404.5725,-3764.6443 2427.6882,-3790.5243 2444.4712,-3766.1249"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1288.9246,-4286.9828C1307.9312,-4263.6107 1354.4416,-4208.3815 1400.2236,-4169.1249 1541.8637,-4047.6733 1627.3646,-4075.9546 1747.415,-3933.1249 1860.6846,-3798.3629 1854.8073,-3739.1527 1910.4177,-3572.1249 1933.7168,-3502.1453 1905.1246,-3471.2386 1946.4177,-3410.1249 2017.7,-3304.6276 2114.1049,-3355.3969 2182.6875,-3248.1249 2244.08,-3152.0993 2273.1568,-2782.6511 2279.6014,-2689.5311"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2283.1064,-2689.575 2280.2904,-2679.3612 2276.1224,-2689.1018 2283.1064,-2689.575"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2172.6481,-1112.1304 2068.0827,-1112.1304 2068.0827,-1090.1195 2172.6481,-1090.1195 2172.6481,-1112.1304"/>
<text text-anchor="middle" x="2120.3654" y="-1097.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2129.0752,-1089.9406C2182.8522,-1022.2839 2475.2661,-674.6262 2714.6799,-796.1249"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2170.2041,-1112.1461C2202.0617,-1119.4563 2244.1645,-1129.6104 2281.0071,-1140.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2444.4712,-1216.1249C2534.9007,-1309.0672 2568.6335,-1742.0071 2575.3798,-1843.7012"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2571.8886,-1843.9526 2576.0263,-1853.706 2578.874,-1843.5011 2571.8886,-1843.9526"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2281.0071,-1140.1249C2358.0501,-1162.1123 2388.6,-1158.7013 2444.4712,-1216.1249"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2123.8695,-1112.3813C2135.0094,-1148.7708 2169.643,-1266.7031 2182.6875,-1367.1249 2191.8227,-1437.4512 2178.1342,-2584.9471 2218.6875,-2643.1249 2220.8832,-2646.2749 2223.5455,-2649.0281 2226.518,-2651.4346"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2224.7282,-2654.4467 2235.0036,-2657.029 2228.5813,-2648.6026 2224.7282,-2654.4467"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1281.4733,-5489.3158C1292.5562,-5568.474 1370.9449,-6043.102 1666.4052,-6123.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-6123.1249C1804.2034,-6154.1864 1847.4628,-6087.8009 1984.2305,-6123.1249"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1318.2466,-5489.2004C1388.076,-5507.7905 1540.6273,-5540.8307 1666.4052,-5515.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1666.4052,-5515.1249C1744.1977,-5499.2261 1716.7264,-5423.2188 1783.415,-5380.1249 1808.1577,-5364.1363 1822.918,-5378.2105 1846.9164,-5361.1249"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2120.3654,-5513.1249C2258.8286,-5385.6591 2250.1889,-5316.6638 2343.3267,-5153.1249 2360.4445,-5123.0679 2353.355,-5106.9704 2379.3267,-5084.1249 2402.4946,-5063.7458 2429.746,-5087.2401 2444.4712,-5060.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1666.4052,-5515.1249C1765.2431,-5494.925 2042.7552,-5577.5737 2120.3654,-5513.1249"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1852.1068,-5411.4014C1877.8791,-5466.965 1993.4275,-5711.0001 2058.0432,-5762.1249 2080.7521,-5780.0925 2105.3703,-5756.3525 2120.3654,-5781.1249"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1984.2305,-5249.1249C2031.4388,-5227.9686 2011.2815,-5316.9991 2058.0432,-5339.1249 2108.1181,-5362.8184 2131.08,-5359.2629 2182.6875,-5339.1249 2330.013,-5281.6364 2304.6088,-5171.9371 2444.4712,-5098.1249"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1984.2305,-5249.1249C2003.0971,-5242.78 2005.7658,-5236.5816 2022.0432,-5225.1249 2038.6189,-5213.4583 2040.3958,-5207.0965 2058.0432,-5197.1249 2083.8849,-5182.5233 2091.904,-5181.548 2120.3654,-5173.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1889.9783,-5389.012C1897.5116,-5385.5361 1904.7413,-5381.0081 1910.4177,-5375.1249 1943.7979,-5340.5291 1916.479,-5310.7385 1946.4177,-5273.1249 1958.8138,-5257.5511 1965.3638,-5255.4699 1984.2305,-5249.1249"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2444.4712,-5060.1249C2525.4158,-4911.7944 2572.0166,-2154.9786 2576.3736,-1886.1644"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2579.8736,-1886.1912 2576.5352,-1876.1361 2572.8745,-1886.0784 2579.8736,-1886.1912"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1984.2305,-5249.1249C2071.8173,-5219.669 2100.0565,-5228.4917 2182.6875,-5187.1249 2200.336,-5178.2897 2201.1708,-5170.2187 2218.6875,-5161.1249 2270.6958,-5134.125 2293.2024,-5148.4798 2343.3267,-5118.1249 2362.1516,-5106.7247 2360.6211,-5095.7201 2379.3267,-5084.1249 2405.5522,-5067.8682 2429.6908,-5087.21 2444.4712,-5060.1249"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1849.0013,-5389.1095C1863.9626,-5310.4207 1957.2666,-4825.6336 2058.0432,-4437.1249 2106.398,-4250.7102 2147.8055,-4211.5237 2182.6875,-4022.1249 2189.0024,-3987.837 2267.6818,-2859.5823 2279.5199,-2689.5047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2283.0123,-2689.7347 2280.215,-2679.5158 2276.0292,-2689.2487 2283.0123,-2689.7347"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1476.5459,-1547.0313C1483.5031,-1505.5124 1512.5834,-1356.7879 1585.3953,-1261.1249 1816.4637,-957.5383 1953.8677,-954.4342 2281.0071,-758.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-758.1249C2391.1176,-670.2905 2457.1321,-569.6909 2576.7096,-644.1249"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1481.0617,-1546.8429C1496.5223,-1519.5095 1538.6955,-1448.3026 1585.3953,-1398.1249 1662.2908,-1315.5029 1690.2164,-1302.7908 1783.415,-1239.1249 2093.5152,-1027.2892 2201.3188,-937.2522 2576.7096,-948.1249"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1492.939,-1569.224C1529.1587,-1592.036 1611.6806,-1647.2728 1666.4052,-1709.1249"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1524.1072,-1555.7153C1635.586,-1553.3211 1906.3394,-1565.3403 2022.0432,-1728.1249 2076.1006,-1804.1787 2000.0104,-2494.0594 2058.0432,-2567.1249 2122.0137,-2647.6663 2205.1951,-2559.6147 2281.0071,-2629.1249"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1482.5583,-1569.4311C1497.9009,-1592.3882 1532.1498,-1646.5822 1549.3953,-1697.1249 1580.8237,-1789.2349 1561.8268,-1818.6976 1585.3953,-1913.1249 1732.9942,-2504.482 1892.0554,-2617.6488 2022.0432,-3213.1249 2054.3566,-3361.1529 2028.8383,-3403.4524 2058.0432,-3552.1249 2096.3971,-3747.3717 2146.2164,-3786.5177 2182.6875,-3982.1249 2216.6217,-4164.1256 2202.4904,-4212.6977 2218.6875,-4397.1249 2242.2676,-4665.6183 2271.4838,-4991.9029 2279.1139,-5077.0166"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2275.6295,-5077.3479 2280.0087,-5086.9954 2282.6015,-5076.7227 2275.6295,-5077.3479"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1488.314,-1547.0081C1508.3842,-1530.9574 1547.7714,-1501.2363 1585.3953,-1483.1249 1765.5248,-1396.414 2305.0611,-1072.841 2444.4712,-1216.1249"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1482.9551,-1569.3058C1499.0112,-1592.0375 1534.4797,-1645.8463 1549.3953,-1697.1249 1610.1365,-1905.9485 1551.1245,-1970.3639 1585.3953,-2185.1249 1604.1531,-2302.6724 1644.2875,-2439.9954 1659.9533,-2491.3549"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1656.6254,-2492.4407 1662.9083,-2500.9716 1663.3166,-2490.3846 1656.6254,-2492.4407"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1516.6688,-1547.0369C1630.2637,-1516.947 1944.1224,-1433.8096 2068.5637,-1400.8466"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2069.8306,-1404.1318 2078.601,-1398.1878 2068.0381,-1397.3651 2069.8306,-1404.1318"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1141.9456,-5947.1304 1063.4697,-5947.1304 1063.4697,-5925.1195 1141.9456,-5925.1195 1141.9456,-5947.1304"/>
<text text-anchor="middle" x="1102.7076" y="-5932.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-6087.1249C1446.8445,-6130.8659 1497.8411,-6086.5975 1666.4052,-6123.1249"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1107.0903,-5924.8035C1130.515,-5864.2929 1241.0287,-5578.8133 1271.9501,-5498.9371"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1275.2724,-5500.0498 1275.6186,-5489.4606 1268.7445,-5497.5227 1275.2724,-5500.0498"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1280.0068,-6087.1249C1317.6544,-6096.9952 1329.5121,-6080.728 1364.2236,-6063.1249 1382.3017,-6053.9571 1382.3026,-6044.596 1400.2236,-6035.1249 1461.7996,-6002.5827 1488.5171,-6020.9546 1549.3953,-5987.1249 1733.252,-5884.9568 1774.8713,-5841.9627 1910.4177,-5681.1249 2028.7905,-5540.6652 2017.1645,-5477.0809 2120.3654,-5325.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1137.7492,-5947.2269C1145.5913,-5950.8133 1153.4531,-5955.3896 1159.79,-5961.1249 1183.987,-5983.0246 1174.1655,-6000.6818 1195.79,-6025.1249 1226.5871,-6059.9363 1235.0474,-6075.3376 1280.0068,-6087.1249"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1142.3274,-5936.0438C1194.112,-5935.1011 1287.2711,-5930.5229 1364.2236,-5911.1249 1619.6316,-5846.7423 1690.9309,-5826.7405 1910.4177,-5681.1249 1986.7939,-5630.4542 1980.8917,-5586.6071 2058.0432,-5537.1249 2083.0277,-5521.1008 2098.1399,-5532.7979 2120.3654,-5513.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M934.6982,-4955.4287C944.3761,-5010.8114 986.9949,-5259.1226 1009.6252,-5464.1249 1021.6538,-5573.0886 991.7853,-5860.6313 1045.6252,-5956.1249 1076.18,-6010.3185 1118.1602,-5990.8919 1159.79,-6037.1249 1181.628,-6061.3776 1170.0622,-6081.0459 1195.79,-6101.1249 1345.8545,-6218.2413 1840.2303,-6270.7367 2022.0432,-6327.1249 2080.2327,-6345.1721 2222.2493,-6433.2259 2281.0071,-6417.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-6417.1249C2432.052,-6355.1169 2416.0931,-6228.4828 2576.7096,-6199.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M987.9639,-4953.5154C996.2462,-4957.1595 1003.9107,-4962.1896 1009.6252,-4969.1249 1093.3384,-5070.7216 990.3905,-5143.6306 1045.6252,-5263.1249 1061.341,-5297.1243 1078.7711,-5296.3154 1102.7076,-5325.1249"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1102.7076,-5325.1249C1126.8539,-5354.1868 1137.8062,-5357.3947 1159.79,-5388.1249 1179.0042,-5414.9835 1170.0451,-5432.4425 1195.79,-5453.1249 1203.2909,-5459.1508 1212.2092,-5463.725 1221.3908,-5467.197"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1220.4119,-5470.5604 1231.006,-5470.4309 1222.6434,-5463.9256 1220.4119,-5470.5604"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M987.8974,-4949.952C995.616,-4952.338 1003.1211,-4955.6219 1009.6252,-4960.1249 1112.1488,-5031.1056 1096.5306,-5089.6653 1159.79,-5197.1249 1176.7408,-5225.9193 1170.7076,-5241.0498 1195.79,-5263.1249 1335.3175,-5385.9235 1402.7314,-5380.7544 1585.3953,-5415.1249 1651.0003,-5427.4694 1727.3538,-5420.7255 1780.5597,-5412.7251"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1781.208,-5416.1664 1790.5493,-5411.1673 1780.1295,-5409.2499 1781.208,-5416.1664"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M988.2354,-4934.4659C996.3825,-4930.8472 1003.9318,-4925.8951 1009.6252,-4919.1249 1082.4424,-4832.5359 977.161,-4757.1952 1045.6252,-4667.1249 1048.0957,-4663.8748 1051.0781,-4661.0397 1054.3678,-4658.5678"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1056.4313,-4661.4057 1063.0617,-4653.1421 1052.7252,-4655.4673 1056.4313,-4661.4057"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1102.7076,-4945.1249C1172.8911,-4949.8264 1142.9826,-5026.6578 1195.79,-5073.1249 1265.8754,-5134.7956 1368.6514,-5175.6778 1427.933,-5195.706"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1427.1766,-5199.1427 1437.77,-5198.9725 1429.3826,-5192.4994 1427.1766,-5199.1427"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M932.8034,-4933.0592C933.7278,-4851.9485 943.5491,-4341.231 1045.6252,-3943.1249 1056.8862,-3899.2062 1079.1663,-3850.8551 1092.3137,-3824.3319"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1095.495,-3825.7962 1096.8634,-3815.2901 1089.242,-3822.6497 1095.495,-3825.7962"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1102.7076,-4945.1249C1160.0683,-4949.7326 1152.7982,-4893.3764 1195.79,-4855.1249 1362.5532,-4706.7496 1574.9131,-4540.814 1643.7654,-4487.5607"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1646.0231,-4490.2393 1651.7974,-4481.3563 1641.7439,-4484.6996 1646.0231,-4490.2393"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M988.0946,-4940.7985C1021.4558,-4939.7001 1064.7,-4939.8759 1102.7076,-4945.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M988.1866,-4947.7732C996.1397,-4950.4125 1003.6399,-4954.3459 1009.6252,-4960.1249 1058.0149,-5006.8463 1018.3545,-5045.6371 1045.6252,-5107.1249 1093.9194,-5216.0148 1114.0754,-5242.4529 1195.79,-5329.1249 1260.4738,-5397.7329 1312.7751,-5379.1054 1364.2236,-5458.1249 1401.396,-5515.2178 1346.6913,-5564.9862 1400.2236,-5607.1249 1652.4772,-5805.6896 1799.6376,-5537.2161 2120.3654,-5551.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.9828,-4932.9412C935.695,-4826.1607 959.5107,-3975.8022 1045.6252,-3293.1249 1080.5816,-3016.007 1124.7547,-2952.2329 1159.79,-2675.1249 1188.9598,-2444.4105 1125.559,-2374.8175 1195.79,-2153.1249 1210.5777,-2106.4461 1244.0168,-2059.1784 1264.0249,-2033.5706"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.9979,-2035.4557 1270.4892,-2025.4526 1261.5219,-2031.0951 1266.9979,-2035.4557"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M987.3648,-4933.1041C995.5149,-4929.644 1003.292,-4925.0978 1009.6252,-4919.1249 1092.255,-4841.1972 1058.1865,-4785.6155 1102.7076,-4681.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-4681.1249C1113.1886,-4656.5263 1143.7988,-4683.5544 1159.79,-4662.1249 1196.3911,-4613.0768 1182.4235,-3620.8467 1195.79,-3561.1249 1237.0276,-3376.8755 1320.4434,-3354.7868 1364.2236,-3171.1249 1379.607,-3106.5902 1359.8705,-2627.7843 1400.2236,-2575.1249 1403.4633,-2570.8973 1407.4469,-2567.3775 1411.8726,-2564.4481"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1413.7735,-2567.3971 1420.8491,-2559.5113 1410.4001,-2561.2635 1413.7735,-2567.3971"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-4945.1249C1686.8235,-5009.0745 2089.7773,-5018.2133 2343.3267,-4488.1249 2378.6556,-4414.2638 2373.1004,-3833.7634 2379.3267,-3752.1249 2397.5203,-3513.5706 2432.0455,-3225.2891 2441.8282,-3145.4867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2445.3395,-3145.6087 2443.0871,-3135.2561 2438.3919,-3144.7537 2445.3395,-3145.6087"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1102.7076,-4945.1249C1154.9789,-4950.3329 1937.6986,-4627.5009 1984.2305,-4603.1249"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1984.2305,-4603.1249C2052.5862,-4565.5737 2166.9049,-4483.5375 2182.6875,-4465.1249 2204.0612,-4440.1895 2193.0732,-4419.3009 2218.2829,-4394.8817"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2220.6826,-4397.4338 2225.9574,-4388.2453 2216.1039,-4392.1389 2220.6826,-4397.4338"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1102.7076,-4945.1249C1195.8572,-4957.9893 1128.6191,-5069.3191 1195.79,-5135.1249 1267.359,-5205.2393 1302.3937,-5208.5044 1400.2236,-5230.1249 1527.0122,-5258.1453 1863.8023,-5259.6796 1984.2305,-5211.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1984.2305,-5211.1249C2041.8485,-5186.1014 2060.1305,-5190.9514 2120.3654,-5173.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2444.4712,-3766.1249C2511.7343,-3693.303 2568.9795,-2089.9848 2575.9891,-1886.3325"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2579.4882,-1886.4166 2576.3326,-1876.3027 2572.4923,-1886.177 2579.4882,-1886.4166"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1102.7076,-4681.1249C1112.8589,-4656.3884 1143.1549,-4683.0585 1159.79,-4662.1249 1213.1124,-4595.0243 1146.8309,-4348.4725 1195.79,-4278.1249 1243.2402,-4209.9457 1293.6106,-4240.871 1364.2236,-4197.1249 1381.4547,-4186.45 1382.6393,-4179.2074 1400.2236,-4169.1249 1477.1086,-4125.0407 1503.0561,-4127.9119 1585.3953,-4095.1249 1938.08,-3954.6881 2016.0751,-3890.3852 2379.3267,-3780.1249 2407.6642,-3771.5235 2424.3776,-3787.8791 2444.4712,-3766.1249"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-4681.1249C1113.0348,-4656.4613 1143.3073,-4683.1787 1159.79,-4662.1249 1222.3141,-4582.2613 1178.3785,-4307.0464 1195.79,-4207.1249 1244.6607,-3926.6657 1320.3833,-3870.4143 1364.2236,-3589.1249 1378.5072,-3497.4784 1350.0645,-2833.1453 1400.2236,-2755.1249 1440.4617,-2692.5364 1502.9599,-2737.2643 1549.3953,-2679.1249 1590.0271,-2628.2519 1540.547,-2584.3228 1585.3953,-2537.1249 1588.6191,-2533.7322 1592.2918,-2530.7967 1596.2522,-2528.257"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1598.2199,-2531.1703 1605.3191,-2523.3058 1594.865,-2525.0267 1598.2199,-2531.1703"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1351.8444,-579.1304 1208.1693,-579.1304 1208.1693,-557.1195 1351.8444,-557.1195 1351.8444,-579.1304"/>
<text text-anchor="middle" x="1280.0068" y="-564.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1328.5936,-557.1138C1517.6995,-514.7537 2198.2196,-367.119 2281.0071,-417.1249"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1336.6135,-579.1671C1358.9245,-583.5193 1384.721,-588.5514 1407.9417,-593.0811"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1407.5765,-596.5757 1418.0616,-595.0552 1408.9167,-589.7052 1407.5765,-596.5757"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1351.8067,-559.3417C1389.0377,-556.8879 1434.9423,-557.1682 1474.8094,-567.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1474.8094,-567.1249C1558.8713,-588.1191 1579.7626,-530.6727 1666.4052,-531.1249"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1282.9613,-579.1547C1295.3325,-625.8418 1343.2958,-811.9745 1364.2236,-968.1249 1400.2996,-1237.301 1381.8336,-1307.1654 1400.2236,-1578.1249 1426.1272,-1959.7885 1464.4322,-2425.2132 1473.0468,-2528.9675"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1469.5716,-2529.4121 1473.8882,-2539.0877 1476.5475,-2528.832 1469.5716,-2529.4121"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-645.1249C1702.3118,-656.1162 1714.013,-651.9669 1747.415,-669.1249 1765.4451,-678.3867 1765.3975,-687.8388 1783.415,-697.1249 1835.7866,-724.1169 1858.7516,-706.8061 1910.4177,-735.1249 1945.4612,-754.3327 2162.6242,-935.5641 2182.6875,-970.1249 2224.523,-1042.1902 2176.2522,-1082.4112 2218.6875,-1154.1249 2255.4284,-1216.2154 2311.8232,-1193.22 2343.3267,-1258.1249 2374.1477,-1321.6241 2374.4881,-2457.7071 2379.3267,-2528.1249 2394.8327,-2753.7901 2430.9559,-3025.8042 2441.5199,-3102.8657"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2438.0553,-3103.3634 2442.8876,-3112.7921 2444.9898,-3102.4079 2438.0553,-3103.3634"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1666.4052,-645.1249C1770.8156,-676.3281 1805.0972,-641.1468 1910.4177,-669.1249 2038.5745,-703.1694 2064.9277,-730.1675 2182.6875,-791.1249 2219.5184,-810.1901 2308.8053,-863.1407 2343.3267,-886.1249 2420.0659,-937.2176 2465.0782,-929.4045 2509.6157,-1010.1249 2551.0747,-1085.2658 2572.2761,-1718.5306 2576.0815,-1843.6867"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2572.5892,-1843.9995 2576.3871,-1853.8902 2579.5861,-1843.7899 2572.5892,-1843.9995"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1474.8094,-567.1249C1507.998,-575.4137 1517.3589,-574.131 1549.3953,-586.1249 1603.9394,-606.5454 1611.0378,-627.055 1666.4052,-645.1249"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-567.1249C1507.7813,-576.2373 1525.3567,-561.7872 1549.3953,-586.1249 1597.27,-634.5955 1555.2131,-674.0478 1585.3953,-735.1249 1636.0754,-837.6823 1683.7592,-840.0753 1747.415,-935.1249 1766.0079,-962.8873 1758.2156,-979.1833 1783.415,-1001.1249 1828.9239,-1040.7503 1856.8818,-1021.2839 1910.4177,-1049.1249 1963.6662,-1076.8164 1984.9598,-1077.9334 2022.0432,-1125.1249 2082.0701,-1201.5139 2108.312,-1318.4259 2116.9236,-1365.944"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2113.5063,-1366.7227 2118.6631,-1375.9778 2120.4034,-1365.5269 2113.5063,-1366.7227"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1141.2638,-4653.2491C1148.2133,-4656.7392 1154.8181,-4661.2696 1159.79,-4667.1249 1201.653,-4716.4261 1179.6781,-4745.4869 1195.79,-4808.1249 1270.1332,-5097.1471 1304.8425,-5165.6619 1364.2236,-5458.1249 1385.9478,-5565.1205 1344.3742,-5607.3121 1400.2236,-5701.1249 1453.1691,-5790.0599 1823.143,-6080.8038 1984.2305,-6123.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-6123.1249C2044.2772,-6130.5528 2061.974,-6107.2746 2120.3654,-6123.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1158.6936,-4636.0835C1248.7373,-4623.9876 1427.9153,-4589.8739 1549.3953,-4501.1249 1571.7984,-4484.758 1565.7618,-4469.7287 1585.3953,-4450.1249 1616.5483,-4419.019 1625.5379,-4409.4946 1666.4052,-4393.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1143.2821,-4653.1931C1149.7174,-4656.6616 1155.6164,-4661.1984 1159.79,-4667.1249 1226.484,-4761.8298 1175.5755,-5073.0703 1195.79,-5187.1249 1214.179,-5290.8788 1255.366,-5410.4657 1272.4044,-5457.5569"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1269.1194,-5458.7651 1275.8355,-5466.9592 1275.6952,-5456.3653 1269.1194,-5458.7651"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1133.0032,-4653.1898C1141.9481,-4657.0316 1151.5444,-4661.7456 1159.79,-4667.1249 1281.3515,-4746.4304 1270.8766,-4822.2776 1400.2236,-4888.1249 1401.0476,-4888.5444 2443.7175,-5098.6606 2444.4712,-5098.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1103.6809,-4631.07C1109.9363,-4559.5419 1144.7006,-4154.766 1159.79,-3824.1249 1168.2565,-3638.6083 1143.9089,-2331.4405 1195.79,-2153.1249 1209.529,-2105.904 1243.5987,-2058.5497 1263.9461,-2033.133"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.6577,-2035.3459 1270.2712,-2025.3864 1261.2355,-2030.9187 1266.6577,-2035.3459"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1103.5818,-4631.0649C1109.2168,-4559.5048 1140.7818,-4154.5639 1159.79,-3824.1249 1169.9463,-3647.5691 1138.3893,-3196.3979 1195.79,-3029.1249 1237.8512,-2906.5536 1314.8945,-2910.9561 1364.2236,-2791.1249 1401.2714,-2701.1279 1337.0606,-2649.1683 1400.2236,-2575.1249 1403.6263,-2571.1361 1407.6858,-2567.7814 1412.1286,-2564.9604"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1413.9123,-2567.9754 1421.0728,-2560.1666 1410.6055,-2561.8057 1413.9123,-2567.9754"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1158.6187,-4642.1108C1299.1046,-4641.0295 1677.581,-4631.6327 1984.2305,-4565.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1142.3588,-4653.1381C1149.0483,-4656.6227 1155.2759,-4661.1794 1159.79,-4667.1249 1228.7368,-4757.9338 1120.3284,-4835.653 1195.79,-4921.1249 1436.1034,-5193.3167 1669.616,-4953.8611 1984.2305,-5135.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2120.3654,-2475.1249C2182.1569,-2439.3585 2214.2394,-2449.8362 2281.0071,-2475.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1104.3994,-4631.0647C1112.6146,-4577.9318 1149.8294,-4343.7137 1195.79,-4155.1249 1257.9344,-3900.1304 1315.9965,-3847.1138 1364.2236,-3589.1249 1382.5354,-3491.1668 1355.0176,-3230.9367 1400.2236,-3142.1249 1424.8271,-3093.7889 1537.0373,-3007.6854 1585.3953,-2983.1249 1651.3402,-2949.6322 1688.5753,-2989.9399 1747.415,-2945.1249 1773.9963,-2924.8794 1765.6812,-2907.4437 1783.415,-2879.1249 1894.9684,-2700.988 1887.4146,-2616.8554 2058.0432,-2494.1249 2081.5511,-2477.2161 2095.3036,-2489.6313 2120.3654,-2475.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1105.317,-4631.0506C1113.6011,-4595.7918 1139.9288,-4482.9549 1159.79,-4389.1249 1176.8654,-4308.4562 1139.9339,-4267.7805 1195.79,-4207.1249 1248.5191,-4149.8652 1306.3244,-4211.151 1364.2236,-4159.1249 1395.9619,-4130.6061 1379.0312,-4107.159 1400.2236,-4070.1249 1467.3124,-3952.8861 1482.2411,-3916.3318 1585.3953,-3829.1249 1647.6528,-3776.4922 1698.3927,-3808.2633 1747.415,-3743.1249 1794.1173,-3681.0693 1752.3128,-3643.2913 1783.415,-3572.1249 1833.5892,-3457.3194 1855.1669,-3427.9797 1946.4177,-3342.1249 2012.6936,-3279.7683 2047.7644,-3288.9879 2120.3654,-3234.1249"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1103.4518,-4630.9344C1110.6481,-4523.1434 1168.2086,-3670.6073 1195.79,-3561.1249 1241.9144,-3378.0377 1318.5564,-3354.3267 1364.2236,-3171.1249 1388.1666,-3075.0737 1354.5914,-2814.9703 1400.2236,-2727.1249 1439.9658,-2650.6182 1494.6294,-2669.7089 1549.3953,-2603.1249 1570.6206,-2577.3193 1559.5277,-2558.2747 1585.3953,-2537.1249 1590.0671,-2533.3051 1595.3205,-2530.0676 1600.8491,-2527.3238"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1602.6048,-2530.3759 1610.3594,-2523.1568 1599.7954,-2523.9643 1602.6048,-2530.3759"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-5401.1249C1800.9157,-5502.5186 1802.7813,-5561.5558 1910.4177,-5691.1249 1943.4746,-5730.9176 1936.9536,-5760.1224 1984.2305,-5781.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-5781.1249C2040.6135,-5803.0735 2086.7694,-5730.805 2120.3654,-5781.1249"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1666.4052,-5211.1249C1755.9321,-5212.5983 1712.8488,-5320.0101 1783.415,-5375.1249 1788.1407,-5378.8159 1793.4797,-5382.0245 1799.0049,-5384.7973"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1797.8508,-5388.1171 1808.4036,-5389.0605 1800.7425,-5381.7422 1797.8508,-5388.1171"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1477.6666,-5199.0899C1498.9089,-5117.0457 1632.2115,-4602.191 1660.9494,-4491.1965"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1664.4133,-4491.7817 1663.5316,-4481.2236 1657.6367,-4490.0271 1664.4133,-4491.7817"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2281.0071,-5627.1249C2483.9159,-5487.9007 2243.8941,-5240.6879 2444.4712,-5098.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1489.0207,-5221.2211C1504.3833,-5233.4213 1529.3578,-5253.8576 1549.3953,-5273.1249 1604.9539,-5326.5481 1604.314,-5355.4578 1666.4052,-5401.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1666.4052,-5401.1249C1678.3522,-5409.9118 2169.6684,-5530.0225 2182.6875,-5537.1249 2234.693,-5565.4958 2232.1592,-5660.6415 2281.0071,-5627.1249"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1524.435,-5210.0783C1563.1175,-5210.1159 1618.1795,-5210.3313 1666.4052,-5211.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-5211.1249C1710.7446,-5211.8546 2321.1575,-4826.5313 2343.3267,-4788.1249 2372.1172,-4738.2476 2375.3532,-3809.578 2379.3267,-3752.1249 2395.8334,-3513.448 2431.5482,-3225.2529 2441.7182,-3145.4787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2445.2292,-3145.6154 2443.028,-3135.2518 2438.2859,-3144.7261 2445.2292,-3145.6154"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1501.1736,-5199.0129C1572.3721,-5168.1892 1772.4502,-5076.1179 1910.4177,-4959.1249 1989.33,-4892.2093 1988.4739,-4855.7079 2058.0432,-4779.1249 2110.5856,-4721.2854 2140.9176,-4721.1658 2182.6875,-4655.1249 2237.6512,-4568.2237 2266.8906,-4446.5551 2276.9372,-4398.1697"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2280.3921,-4398.7425 2278.9386,-4388.2478 2273.5303,-4397.3582 2280.3921,-4398.7425"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1984.2305,-5173.1249C2042.8941,-5158.3141 2062.3484,-5190.295 2120.3654,-5173.1249"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1984.2305,-5173.1249C2441.8352,-5057.593 2363.6144,-4681.1109 2444.4712,-4216.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1666.4052,-5211.1249C1718.8242,-5213.8211 1731.3201,-5201.5391 1783.415,-5195.1249 1872.5274,-5184.153 1894.8428,-5181.5651 1984.2305,-5173.1249"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1478.3368,-5198.8732C1491.008,-5157.8194 1534.2727,-5012.0131 1549.3953,-4888.1249 1557.309,-4823.2929 1546.2132,-2589.3799 1585.3953,-2537.1249 1587.7407,-2533.9969 1590.4716,-2531.2489 1593.4827,-2528.8357"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1595.6119,-2531.6242 1602.0353,-2523.1986 1591.7596,-2525.7795 1595.6119,-2531.6242"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-2931.1249C1810.5721,-2663.1711 1902.4969,-2625.9321 2022.0432,-2346.1249 2263.5299,-1780.907 2060.2705,-1535.4728 2379.3267,-1010.1249 2425.2162,-934.5647 2634.072,-759.8266 2714.6799,-796.1249"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1476.3327,-3173.334C1489.0542,-3266.8734 1577.3636,-3914.7295 1585.3953,-3933.1249 1631.1692,-4037.9641 1685.8466,-4036.7101 1747.415,-4133.1249 1768.4823,-4166.1157 1817.1254,-4270.9336 1837.5834,-4315.6222"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1834.4864,-4317.2663 1841.8247,-4324.9083 1840.8537,-4314.358 1834.4864,-4317.2663"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1476.6825,-3173.2332C1486.1514,-3229.833 1529.0951,-3491.9003 1549.3953,-3708.1249 1556.6647,-3785.554 1549.4391,-4338.1665 1585.3953,-4407.1249 1595.9873,-4427.4389 1616.3772,-4443.2405 1634.0498,-4453.9376"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1632.5625,-4457.1194 1642.9775,-4459.063 1636.0477,-4451.0487 1632.5625,-4457.1194"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1518.0876,-3151.0927C1605.5349,-3129.8015 1809.8113,-3085.1249 1984.2305,-3085.1249 1984.2305,-3085.1249 1984.2305,-3085.1249 2281.0071,-3085.1249 2382.9612,-3085.1249 2437.6797,-3031.8764 2509.6157,-3104.1249 2643.6177,-3238.709 2415.8588,-4057.1023 2576.7096,-3956.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2576.7096,-3956.1249C2644.0249,-3913.8664 2707.9886,-1235.8885 2714.1889,-969.4229"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2717.6941,-969.2328 2714.4269,-959.1543 2710.696,-969.0705 2717.6941,-969.2328"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-2931.1249C1759.1243,-2758.7938 1831.2462,-2117.4233 1844.6685,-1991.6161"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1848.1808,-1991.6838 1845.7528,-1981.3709 1841.2197,-1990.947 1848.1808,-1991.6838"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.8837,-3151.0044C1498.5342,-3132.8042 1527.9238,-3095.2592 1549.3953,-3061.1249 1567.603,-3032.1791 1563.3073,-3019.2306 1585.3953,-2993.1249 1614.6805,-2958.5128 1644.9233,-2971.0518 1666.4052,-2931.1249"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1548.1917,-3161.3031C1649.9117,-3162.615 1837.7734,-3173.9957 1984.2305,-3234.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-3234.1249C2049.8552,-3256.3761 2065.1951,-3268.1969 2120.3654,-3310.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-3310.1249C2230.3234,-3393.6902 2155.2631,-3633.2422 2281.0071,-3576.1249"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1497.39,-3173.1768C1603.5392,-3226.6676 2053.1745,-3470.7895 2182.6875,-3828.1249 2249.5458,-4012.5916 2160.6085,-4080.7088 2218.6875,-4268.1249 2229.1419,-4301.8604 2251.3262,-4336.5551 2266.205,-4357.4815"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2263.5565,-4359.7905 2272.2687,-4365.8194 2269.2177,-4355.6734 2263.5565,-4359.7905"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1480.6716,-3173.264C1526.552,-3260.7327 1831.2628,-3846.9136 2022.0432,-4347.1249 2041.5827,-4398.356 2019.2681,-4426.3575 2058.0432,-4465.1249 2098.9992,-4506.0727 2144.529,-4459.5584 2182.6875,-4503.1249 2259.9143,-4591.2966 2277.2632,-4980.3717 2280.3998,-5076.5627"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2276.9089,-5076.914 2280.7149,-5086.8015 2283.9055,-5076.6985 2276.9089,-5076.914"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1487.9963,-3150.9731C1516.7619,-3126.655 1582.796,-3070.8789 1585.3953,-3069.1249 1652.973,-3023.524 1684.6447,-3035.145 1747.415,-2983.1249 1767.1356,-2966.7818 1763.2676,-2953.9389 1783.415,-2938.1249 1832.3739,-2899.6964 1864.8066,-2921.4727 1910.4177,-2879.1249 1985.0179,-2809.8622 1987.0775,-2774.7278 2022.0432,-2679.1249 2050.8152,-2600.4569 2001.9628,-2556.3462 2058.0432,-2494.1249 2077.4302,-2472.6151 2095.4326,-2489.852 2120.3654,-2475.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-6123.1249C2289.6517,-6168.186 2337.3228,-6153.4466 2509.6157,-6185.1249 2539.5753,-6190.6334 2546.3607,-6201.7452 2576.7096,-6199.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2576.7096,-6199.1249C2643.7666,-6186.8681 2671.9247,-6185.218 2714.6799,-6132.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1104.0344,-3815.2784C1111.4391,-3876.9434 1149.0099,-4182.2973 1195.79,-4429.1249 1257.7923,-4756.2699 1313.3221,-4830.07 1364.2236,-5159.1249 1379.4919,-5257.8274 1350.177,-5520.692 1400.2236,-5607.1249 1538.0123,-5845.0928 1689.0634,-5793.9787 1910.4177,-5957.1249 2006.173,-6027.7001 2008.7245,-6082.061 2120.3654,-6123.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1133.0739,-3815.2906C1188.5904,-3837.3724 1306.0866,-3892.1503 1364.2236,-3979.1249 1409.5616,-4046.9517 1345.9125,-4098.2455 1400.2236,-4159.1249 1423.4056,-4185.1105 1446.4062,-4162.9778 1474.8094,-4183.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M1103.486,-3815.191C1108.5208,-3886.7891 1136.9908,-4291.9259 1159.79,-4622.1249 1175.9616,-4856.3354 1158.526,-4917.3331 1195.79,-5149.1249 1214.8368,-5267.6005 1256.8276,-5405.64 1273.2424,-5457.2542"/>
<polygon fill="#12ff00" stroke="#12ff00" points="1269.9545,-5458.4634 1276.3395,-5466.9181 1276.6205,-5456.327 1269.9545,-5458.4634"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1105.5489,-3815.1537C1114.5213,-3850.2773 1142.668,-3962.7566 1159.79,-4057.1249 1170.2425,-4114.7335 1156.1822,-4275.0063 1195.79,-4318.1249 1221.7472,-4346.3829 1251.2572,-4311.7134 1280.0068,-4337.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1107.1241,-3793.0883C1121.1121,-3758.7502 1165.3103,-3655.0307 1195.79,-3637.1249 1260.3356,-3599.2066 1289.7473,-3629.5619 1364.2236,-3637.1249 1783.5963,-3679.712 1908.0177,-3683.7425 2281.0071,-3880.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2444.4712,-3956.1249C2502.6919,-3964.1607 2526.9326,-3987.3735 2576.7096,-3956.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2281.0071,-3880.1249C2356.5889,-3906.7042 2365.1045,-3945.1705 2444.4712,-3956.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1105.0797,-3793.0779C1114.1857,-3750.1129 1147.0289,-3589.9045 1159.79,-3456.1249 1173.5432,-3311.9464 1154.9058,-2292.0677 1195.79,-2153.1249 1209.6122,-2106.1511 1243.3948,-2058.9884 1263.7244,-2033.4788"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1266.7049,-2035.3611 1270.2993,-2025.3946 1261.2743,-2030.9443 1266.7049,-2035.3611"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1104.9392,-3793.0632C1113.5287,-3750.0446 1144.7249,-3589.6646 1159.79,-3456.1249 1174.2418,-3328.0224 1147.8515,-2996.7954 1195.79,-2877.1249 1239.0046,-2769.2469 1306.5196,-2777.9981 1364.2236,-2677.1249 1388.0944,-2635.3961 1365.9614,-2608.8475 1400.2236,-2575.1249 1403.901,-2571.5055 1408.1175,-2568.4099 1412.6338,-2565.7623"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1414.2895,-2568.8471 1421.6257,-2561.2032 1411.1239,-2562.6037 1414.2895,-2568.8471"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1108.4296,-3793.0619C1119.3607,-3771.6521 1143.5661,-3722.8905 1159.79,-3680.1249 1179.3894,-3628.4616 1151.8333,-3594.6069 1195.79,-3561.1249 1359.2868,-3436.5888 1924.9152,-3474.5667 2120.3654,-3538.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1104.3877,-3815.5093C1115.691,-3891.8862 1180.659,-4327.4271 1195.79,-4351.1249 1231.5055,-4407.0617 2094.6966,-4975.7274 2255.3848,-5081.3061"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2253.8596,-5084.4917 2264.1393,-5087.0565 2257.7027,-5078.641 2253.8596,-5084.4917"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1104.428,-3792.8565C1114.976,-3724.1514 1171.2578,-3363.1438 1195.79,-3320.1249 1245.3014,-3233.3037 1308.1159,-3253.8367 1364.2236,-3171.1249 1390.7413,-3132.0337 1375.7403,-3111.5214 1400.2236,-3071.1249 1450.9533,-2987.4231 1484.3075,-2982.2212 1549.3953,-2909.1249 1639.0976,-2808.3855 1680.1538,-2796.0474 1747.415,-2679.1249 1771.8052,-2636.7267 1751.1254,-2611.8655 1783.415,-2575.1249 1849.2347,-2500.2325 1889.6919,-2506.8041 1984.2305,-2475.1249"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1106.9605,-3793.0736C1117.2179,-3766.0951 1143.6602,-3694.5781 1159.79,-3633.1249 1181.1665,-3551.6828 1150.0351,-3517.8092 1195.79,-3447.1249 1210.318,-3424.6815 1957.5686,-2897.1042 1984.2305,-2895.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.5347,-3461.0923C776.7714,-3439.1749 807.6355,-3388.1146 819.7932,-3340.1249 868.022,-3149.7539 838.5245,-2652.7494 855.7932,-2457.1249 910.7753,-1834.2732 915.5677,-1674.7231 1045.6252,-1063.1249 1095.2169,-829.919 1033.7425,-723.0105 1195.79,-548.1249 1405.9426,-321.3233 1539.3813,-271.1057 1846.9164,-303.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1666.4052,-4147.1249C1703.8891,-4172.6314 1717.3372,-4175.1993 1747.415,-4209.1249 1768.2991,-4232.6806 1764.3728,-4245.0569 1783.415,-4270.1249 1796.4778,-4287.3213 1813.5529,-4304.8474 1826.7066,-4317.5134"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1824.6524,-4320.3885 1834.319,-4324.7253 1829.4667,-4315.3069 1824.6524,-4320.3885"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M932.7092,-3463.1249C1042.8208,-3469.1727 1069.1516,-3500.3094 1159.79,-3563.1249 1210.5177,-3598.2809 1322.8595,-3705.3183 1364.2236,-3751.1249 1474.2865,-3873.0086 1484.5399,-3917.5192 1585.3953,-4047.1249 1620.5226,-4092.2658 1619.1167,-4114.9469 1666.4052,-4147.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M762.4607,-3461.0733C776.5678,-3439.1223 807.2152,-3388.0062 819.7932,-3340.1249 854.6884,-3207.2875 807.8006,-2851.8112 855.7932,-2723.1249 894.9791,-2618.0529 969.602,-2627.8809 1009.6252,-2523.1249 1048.1179,-2422.3752 1034.1314,-2146.3634 1045.6252,-2039.1249 1096.8487,-1561.2061 1009.5073,-1411.2152 1195.79,-968.1249 1259.4261,-816.7608 1402.4913,-673.5742 1454.999,-624.2433"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1457.6889,-626.521 1462.6225,-617.145 1452.9188,-621.3979 1457.6889,-626.521"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M788.6452,-3479.7838C800.5086,-3484.2604 812.6668,-3491.2596 819.7932,-3502.1249 864.3527,-3570.0624 828.2186,-4887.7005 855.7932,-4964.1249 893.2582,-5067.9609 956.6457,-5062.2812 1009.6252,-5159.1249 1033.1005,-5202.0365 1020.5324,-5221.1387 1045.6252,-5263.1249 1064.8404,-5295.2765 1078.7711,-5296.3154 1102.7076,-5325.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M932.7092,-2775.1249C951.6608,-2722.3542 979.9731,-2722.7134 1009.6252,-2675.1249 1089.3187,-2547.2258 1113.642,-2514.5808 1159.79,-2371.1249 1189.8625,-2277.6417 1143.653,-2236.3426 1195.79,-2153.1249 1244.4532,-2075.4521 1313.077,-2110.1853 1364.2236,-2034.1249 1416.2213,-1956.799 1460.4069,-1661.6987 1471.9015,-1579.4937"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1475.401,-1579.7371 1473.3038,-1569.352 1468.467,-1578.7783 1475.401,-1579.7371"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M788.6407,-3479.7867C800.5036,-3484.2637 812.6625,-3491.2624 819.7932,-3502.1249 906.2223,-3633.7865 761.6154,-4792.8898 855.7932,-4919.1249 859.2042,-4923.6969 863.4695,-4927.4475 868.2322,-4930.5221"/>
<polygon fill="#00ffc8" stroke="#00ffc8" points="866.7969,-4933.7237 877.265,-4935.3578 870.1008,-4927.5524 866.7969,-4933.7237"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M788.7746,-3480.0526C800.5044,-3484.5516 812.5365,-3491.4957 819.7932,-3502.1249 892.9812,-3609.3264 825.0061,-3959.0266 855.7932,-4085.1249 910.0663,-4307.4174 1048.9272,-4551.7576 1090.6649,-4622.154"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1087.7612,-4624.1182 1095.8908,-4630.9124 1093.7724,-4620.5314 1087.7612,-4624.1182"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M788.8257,-3480.3847C800.4148,-3484.9104 812.3381,-3491.7861 819.7932,-3502.1249 861.2598,-3559.631 833.357,-3751.8714 855.7932,-3819.1249 898.5258,-3947.2173 956.429,-3957.0125 1009.6252,-4081.1249 1024.4233,-4115.6503 1181.0518,-4696.5741 1195.79,-4731.1249 1276.4092,-4920.1199 1416.6245,-5127.036 1460.9584,-5190.5297"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1458.1776,-5192.6603 1466.7852,-5198.8377 1463.9086,-5188.6409 1458.1776,-5192.6603"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M788.5207,-3468.3321C824.2152,-3464.7687 882.4689,-3460.3655 932.7092,-3463.1249"/>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M1280.0068,-3157.1249C1325.6198,-3135.3951 1384.3102,-3140.7202 1425.2967,-3148.929"/>
<polygon fill="#005bff" stroke="#005bff" points="1424.807,-3152.4032 1435.3168,-3151.0635 1426.2655,-3145.5568 1424.807,-3152.4032"/>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M1102.7076,-3442.1249C1133.2243,-3431.5246 1143.3423,-3424.9297 1159.79,-3397.1249 1209.3412,-3313.3593 1130.9482,-3253.7027 1195.79,-3181.1249 1221.7203,-3152.1011 1244.8704,-3173.8638 1280.0068,-3157.1249"/>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M932.7092,-3463.1249C1008.7238,-3467.3 1030.7936,-3467.1052 1102.7076,-3442.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M932.7092,-3539.1249C967.5525,-3565.8431 986.4196,-3563.8501 1009.6252,-3601.1249 1048.1474,-3663.0025 1006.0927,-3699.8879 1045.6252,-3761.1249 1052.3914,-3771.6058 1062.6481,-3780.487 1072.6099,-3787.4082"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1070.8989,-3790.4703 1081.193,-3792.977 1074.7089,-3784.598 1070.8989,-3790.4703"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M760.7286,-3460.9032C775.1893,-3432.2043 815.4969,-3354.1018 855.7932,-3293.1249 917.6205,-3199.5672 956.4091,-3191.8351 1009.6252,-3093.1249 1032.8368,-3050.0701 1027.6805,-3034.6275 1045.6252,-2989.1249 1091.4784,-2872.8548 1128.2438,-2853.0633 1159.79,-2732.1249 1181.7019,-2648.1219 1143.7892,-2412.6415 1195.79,-2343.1249 1244.0476,-2278.6125 1290.9527,-2309.6213 1364.2236,-2276.1249 1613.4353,-2162.1961 1736.3568,-2201.7591 1910.4177,-1990.1249 1965.7197,-1922.8853 1979.6345,-1814.7007 1983.0987,-1769.2786"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1986.6012,-1769.3564 1983.7731,-1759.146 1979.6167,-1768.8914 1986.6012,-1769.3564"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M779.2641,-3483.2499C799.4841,-3492.3734 829.2249,-3505.3337 855.7932,-3515.1249 889.3945,-3527.508 904.2918,-3517.3342 932.7092,-3539.1249"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M932.7092,-3539.1249C1050.5258,-3629.4679 1105.8325,-3645.8094 1159.79,-3784.1249 1203.0149,-3894.9283 1118.4343,-4227.7819 1195.79,-4318.1249 1220.7461,-4347.2709 1251.2572,-4311.7134 1280.0068,-4337.1249"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1280.0068,-4337.1249C1309.0309,-4363.0549 1327.2831,-4348.8712 1364.2236,-4361.1249 1464.0253,-4394.2307 1485.9588,-4410.9377 1585.3953,-4445.1249 1596.2684,-4448.8632 1608.0489,-4452.6479 1619.1706,-4456.1026"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1618.1481,-4459.4499 1628.7352,-4459.0441 1620.2058,-4452.7591 1618.1481,-4459.4499"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M1280.0068,-3575.1249C1299.0414,-3585.0282 1406.7942,-3672.4805 1453.3666,-3710.548"/>
<polygon fill="#ff00a3" stroke="#ff00a3" points="1451.3595,-3713.4281 1461.3155,-3717.0516 1455.7922,-3708.0104 1451.3595,-3713.4281"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1102.7076,-3442.1249C1373.7126,-3347.9877 1472.3451,-3392.6261 1747.415,-3474.1249 1798.5082,-3489.263 2531.5773,-3984.4577 2576.7096,-3956.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-2775.1249C951.6608,-2722.3542 987.2927,-2726.5562 1009.6252,-2675.1249 1048.7381,-2585.0492 1012.7676,-2549.6659 1045.6252,-2457.1249 1079.8714,-2360.673 1123.9219,-2352.9855 1159.79,-2257.1249 1188.3806,-2180.7143 1152.2489,-2146.1189 1195.79,-2077.1249 1208.4036,-2057.1379 1229.7917,-2041.2566 1247.8566,-2030.4388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1249.9918,-2033.2499 1256.9364,-2025.2485 1246.5178,-2027.1727 1249.9918,-2033.2499"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.2247,-3461.0077C775.9182,-3438.9419 805.8742,-3387.6336 819.7932,-3340.1249 859.1636,-3205.7453 827.2364,-3164.2103 855.7932,-3027.1249 879.6743,-2912.4851 893.1298,-2885.3342 932.7092,-2775.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.3315,-3461.1146C773.6986,-3438.8218 801.7937,-3386.5164 819.7932,-3340.1249 840.3968,-3287.0218 833.7902,-3269.6636 855.7932,-3217.1249 910.041,-3087.5922 961.0837,-3072.9022 1009.6252,-2941.1249 1037.8253,-2864.5693 1002.1995,-2830.1916 1045.6252,-2761.1249 1079.4386,-2707.3463 1128.718,-2730.5325 1159.79,-2675.1249 1240.6043,-2531.0172 1102.7922,-2441.6876 1195.79,-2305.1249 1243.1008,-2235.6515 1289.4441,-2257.5032 1364.2236,-2219.1249 1535.1798,-2131.387 1739.8292,-2025.5504 1816.2008,-1986.026"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1818.0112,-1989.0301 1825.2834,-1981.3252 1814.7936,-1982.8134 1818.0112,-1989.0301"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-3383.1249C967.5905,-3356.4563 982.1672,-3355.3882 1009.6252,-3321.1249 1103.8634,-3203.5307 1117.8334,-3161.8622 1159.79,-3017.1249 1180.9438,-2944.1512 1151.261,-2738.6864 1195.79,-2677.1249 1243.923,-2610.5811 1293.1437,-2642.265 1364.2236,-2601.1249 1381.3053,-2591.2383 1382.6671,-2584.1416 1400.2236,-2575.1249 1407.9911,-2571.1358 1416.5311,-2567.5798 1424.9733,-2564.4894"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1426.1246,-2567.7947 1434.4168,-2561.1999 1423.8219,-2561.1843 1426.1246,-2567.7947"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M782.9467,-3461.111C819.0946,-3446.1579 883.4153,-3417.3372 932.7092,-3383.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-3157.1249C1329.2745,-3133.654 1346.2388,-3174.1359 1400.2236,-3182.1249 1464.6682,-3191.6619 1922.5341,-3213.2057 1984.2305,-3234.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1280.0068,-3575.1249C1398.4591,-3636.7531 1430.1752,-3647.9957 1549.3953,-3708.1249 1776.4451,-3822.6387 1831.9025,-3853.8262 2058.0432,-3970.1249 2068.2891,-3975.3941 2079.4855,-3981.1452 2089.5263,-3986.3002"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2088.2354,-3989.5717 2098.7301,-3991.0247 2091.4321,-3983.3442 2088.2354,-3989.5717"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1280.0068,-3575.1249C1385.7357,-3632.309 1435.1591,-3561.7254 1549.3953,-3599.1249 1705.6986,-3650.2967 2093.1008,-3844.1992 2182.6875,-3982.1249 2252.4726,-4089.5645 2178.1077,-4146.6074 2218.6875,-4268.1249 2229.9346,-4301.8047 2252.1008,-4336.7558 2266.7366,-4357.7237"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2264.0261,-4359.9513 2272.6795,-4366.0643 2269.727,-4355.8892 2264.0261,-4359.9513"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1102.7076,-3442.1249C1195.7599,-3409.8019 1195.3545,-3524.7515 1280.0068,-3575.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M788.6268,-3483.2035C799.3988,-3487.874 810.8483,-3494.1198 819.7932,-3502.1249 834.9477,-3515.6873 1001.9688,-3796.2841 1009.6252,-3815.1249 1036.4136,-3881.0453 1021.585,-3904.1535 1045.6252,-3971.1249 1084.0477,-4078.1622 1125.1838,-4091.7937 1159.79,-4200.1249 1191.1413,-4298.2667 1146.3134,-4338.7547 1195.79,-4429.1249 1399.5474,-4801.2928 1600.6556,-4772.1707 1910.4177,-5062.1249 1944.1025,-5093.6557 1945.2889,-5110.378 1984.2305,-5135.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1984.2305,-5135.1249C2041.4616,-5161.0212 2060.1305,-5190.9514 2120.3654,-5173.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2120.3654,-5173.1249C2169.2328,-5158.6627 2171.6667,-5133.7777 2218.6875,-5114.1249 2219.9049,-5113.6161 2221.1427,-5113.1201 2222.3963,-5112.637"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2223.9668,-5115.7952 2232.2438,-5109.1815 2221.649,-5109.1901 2223.9668,-5115.7952"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1984.2305,-2475.1249C2025.2057,-2462.6129 2019.6499,-2432.1375 2058.0432,-2413.1249 2083.4837,-2400.5267 2092.0912,-2396.5742 2120.3654,-2399.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1102.7076,-3307.1249C1174.2992,-3238.9621 1133.3266,-3181.7398 1195.79,-3105.1249 1225.1598,-3069.1012 1245.71,-3074.4939 1280.0068,-3043.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1280.0068,-3043.1249C1331.2899,-2996.2198 1341.2669,-2979.9236 1400.2236,-2943.1249 1461.8783,-2904.6423 1504.5653,-2933.3306 1549.3953,-2876.1249 1604.2958,-2806.0685 1537.4253,-2754.0973 1585.3953,-2679.1249 1632.849,-2604.9594 1689.9795,-2631.8597 1747.415,-2565.1249 1770.7533,-2538.008 1753.8521,-2513.2751 1783.415,-2493.1249 1857.46,-2442.6557 1898.5278,-2501.2947 1984.2305,-2475.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-2895.1249C2091.6273,-2892.3893 2110.4232,-2836.6198 2182.6875,-2757.1249 2204.64,-2732.9759 2194.1509,-2714.6433 2218.6875,-2693.1249 2222.8506,-2689.4739 2227.6144,-2686.3171 2232.6125,-2683.5967"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2234.3063,-2686.6654 2241.7832,-2679.159 2231.2571,-2680.3644 2234.3063,-2686.6654"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-3043.1249C1308.571,-3016.6892 1327.3316,-3031.524 1364.2236,-3019.1249 1447.9237,-2990.9942 1473.3334,-2991.9762 1549.3953,-2947.1249 1567.3358,-2936.5459 1566.0147,-2924.7519 1585.3953,-2917.1249 1750.593,-2852.1137 1813.7549,-2944.6712 1984.2305,-2895.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-3383.1249C1000.6998,-3335.9364 1043.6571,-3365.1121 1102.7076,-3307.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-3307.1249C1195.6751,-3215.8315 1147.0659,-3149.9695 1195.79,-3029.1249 1255.0102,-2882.2486 1302.3089,-2860.8858 1364.2236,-2715.1249 1384.6654,-2667.0005 1361.0069,-2637.7064 1400.2236,-2603.1249 1425.5212,-2580.8174 1444.8262,-2604.5714 1474.8094,-2589.1249"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M765.8765,-3461.1102C813.7563,-3411.9997 1005.5315,-3215.0615 1009.6252,-3207.1249 1049.0248,-3130.7408 1009.7578,-3095.2299 1045.6252,-3017.1249 1079.5641,-2943.2196 1130.1579,-2949.8599 1159.79,-2874.1249 1200.2183,-2770.797 1116.6914,-2453.9357 1195.79,-2376.1249 1258.3393,-2314.5941 1944.5398,-2410.3752 1984.2305,-2332.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-2332.1249C2055.3772,-2155.0035 2108.693,-1531.7237 2118.6771,-1408.4134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2122.1731,-1408.6034 2119.4847,-1398.3553 2115.1955,-1408.0431 2122.1731,-1408.6034"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.7162,-1737.0231C1988.1801,-1660.36 2010.3819,-1208.8325 2058.0432,-1081.1249 2119.0349,-917.699 2134.292,-852.4791 2281.0071,-758.1249"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1986.2456,-1736.8723C1994.5165,-1690.881 2026.8938,-1512.7307 2058.0432,-1367.1249 2077.6598,-1275.4288 2104.1463,-1166.72 2115.1929,-1121.9617"/>
<polygon fill="#48ff00" stroke="#48ff00" points="2118.5939,-1122.788 2117.5979,-1112.2401 2111.7988,-1121.1069 2118.5939,-1122.788"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1993.0968,-1736.8794C2025.0302,-1695.704 2134.7995,-1548.2008 2182.6875,-1407.1249 2223.1592,-1287.8971 2145.6921,-1228.7159 2218.6875,-1126.1249 2244.443,-1089.9271 2532.3347,-950.2453 2576.7096,-948.1249"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1984.6878,-1759.488C1990.7885,-1911.0543 2055.9127,-3528.319 2058.0432,-3552.1249 2072.8992,-3718.1251 2105.6929,-3916.6867 2116.6893,-3980.9505"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2113.2798,-3981.7762 2118.4256,-3991.0374 2120.1784,-3980.5886 2113.2798,-3981.7762"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1984.7303,-1759.341C1989.2197,-1858.9619 2023.2462,-2590.7078 2058.0432,-2681.1249 2090.6721,-2765.9084 2152.3461,-2757.4962 2182.6875,-2843.1249 2235.586,-2992.4139 2176.0877,-4115.5776 2218.6875,-4268.1249 2228.2295,-4302.2942 2250.8266,-4337.0721 2266.0228,-4357.8746"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2263.2289,-4359.9827 2272.0228,-4365.8919 2268.8332,-4355.7885 2263.2289,-4359.9827"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1984.817,-1759.294C1989.1628,-1841.2013 2017.322,-2357.6119 2058.0432,-2776.1249 2102.0154,-3228.0494 2141.5272,-3337.9356 2182.6875,-3790.1249 2207.1857,-4059.2641 2198.7197,-4127.6118 2218.6875,-4397.1249 2238.6017,-4665.9151 2270.4699,-4991.985 2278.9036,-5077.0336"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2275.4226,-5077.3998 2279.8946,-5087.0046 2282.3883,-5076.7074 2275.4226,-5077.3998"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1987.5925,-1737.0347C1994.6251,-1713.5838 2011.1389,-1657.1706 2022.0432,-1609.1249 2041.7427,-1522.3269 2001.73,-1481.051 2058.0432,-1412.1249 2060.7815,-1408.7733 2064.0363,-1405.868 2067.6001,-1403.3501"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2069.5588,-1406.2579 2076.3791,-1398.1502 2065.9914,-1400.2351 2069.5588,-1406.2579"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-4120.1304 -.2403,-4120.1304 -.2403,-4098.1195 130.719,-4098.1195 130.719,-4120.1304"/>
<text text-anchor="middle" x="65.2394" y="-4105.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6316.1249C651.7316,-6352.3426 686.1722,-6285.8969 755.1332,-6316.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4451.1249C331.7012,-4491.8195 257.5944,-4307.8004 317.2024,-4209.1249 391.6148,-4085.942 517.1194,-3964.8502 565.6882,-3920.1715"/>
<polygon fill="#ff0000" stroke="#ff0000" points="568.2981,-3922.5279 573.3203,-3913.199 563.5767,-3917.3599 568.2981,-3922.5279"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M399.0839,-5935.1249C464.5814,-5942.5388 458.9289,-5993.8732 516.9653,-6025.1249 545.4619,-6040.4699 553.8252,-6043.6209 585.7192,-6049.1249"/>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M585.7192,-6049.1249C791.0988,-6084.5677 1273.2922,-5713.6574 1364.2236,-5526.1249 1429.7506,-5390.9855 1356.6543,-5333.8544 1400.2236,-5190.1249 1414.2982,-5143.6949 1769.6289,-4480.2202 1836.2181,-4356.0621"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1839.3374,-4357.6513 1840.9803,-4347.1846 1833.1688,-4354.3423 1839.3374,-4357.6513"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M223.8406,-4451.1249C353.9964,-4500.2312 226.3054,-3937.4326 317.2024,-3832.1249 322.1433,-3826.4007 328.3542,-3821.9642 335.1352,-3818.5298"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="336.8587,-3821.5991 344.6696,-3814.4408 334.0996,-3815.1657 336.8587,-3821.5991"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M223.8406,-1188.1249C256.0382,-1150.8261 309.5575,-1130.5866 348.9962,-1120.1465"/>
<polygon fill="#ffa300" stroke="#ffa300" points="349.858,-1123.5389 358.698,-1117.699 348.1457,-1116.7515 349.858,-1123.5389"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M223.8406,-4451.1249C371.7013,-4506.911 263.4772,-3894.7469 317.2024,-3746.1249 332.7083,-3703.2303 364.0334,-3659.6365 383.1257,-3635.4164"/>
<polygon fill="#ffda00" stroke="#ffda00" points="386.0244,-3637.3965 389.5543,-3627.407 380.5653,-3633.0149 386.0244,-3637.3965"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M932.7092,-191.1249C1007.8078,-199.4161 1036.8026,-154.1783 1102.7076,-191.1249"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1102.7076,-191.1249C1135.3797,-209.441 1144.3261,-219.0103 1159.79,-253.1249 1190.7019,-321.319 1145.9724,-532.2306 1195.79,-588.1249 1221.3202,-616.7693 1242.4464,-599.2824 1280.0068,-607.1249"/>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1280.0068,-607.1249C1318.7413,-615.2126 1362.7599,-615.6987 1399.1419,-613.8423"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1399.4092,-617.3328 1409.1903,-613.2609 1399.0048,-610.3445 1399.4092,-617.3328"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M223.8406,-1188.1249C380.6067,-1015.0817 161.1154,-844.7811 317.2024,-671.1249 342.5531,-642.9207 371.4236,-673.0681 399.0839,-647.1249"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-647.1249C455.4933,-594.2172 452.3249,-561.585 516.9653,-519.1249 544.0168,-501.3557 555.5887,-506.9435 585.7192,-495.1249"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M585.7192,-495.1249C621.3281,-481.1575 664.4775,-481.1228 698.3172,-484.4697"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="698.1753,-487.9755 708.5016,-485.6053 698.9511,-481.0186 698.1753,-487.9755"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-4451.1249C278.2415,-4470.1592 263.7549,-4519.5581 317.2024,-4541.1249 490.2156,-4610.9384 842.162,-4490.3349 1009.6252,-4427.1249 1012.3962,-4426.079 1193.061,-4324.2756 1195.79,-4323.1249 1205.4815,-4319.0387 1216.0627,-4315.3399 1226.3512,-4312.1162"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1227.5272,-4315.4173 1236.0871,-4309.174 1225.5021,-4308.7166 1227.5272,-4315.4173"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M1102.7076,-1.1249C1172.8479,-6.4312 1154.3937,-72.2552 1195.79,-129.1249 1340.1973,-327.5096 1438.2569,-334.3598 1549.3953,-553.1249 1579.2748,-611.94 1538.4083,-650.8192 1585.3953,-697.1249 1638.0754,-749.0413 1682.6829,-699.3444 1747.415,-735.1249 1832.3553,-782.0754 1988.2853,-974.6487 2058.0432,-1042.1249 2072.2746,-1055.8908 2088.5247,-1071.2635 2100.8628,-1082.8653"/>
<polygon fill="#48ff00" stroke="#48ff00" points="2098.6591,-1085.5972 2108.3452,-1089.8901 2103.4503,-1080.4938 2098.6591,-1085.5972"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M399.0839,-5935.1249C531.747,-5949.7992 542.8948,-5850.372 654.4731,-5777.1249 729.2957,-5728.0067 746.4627,-5713.444 819.7932,-5662.1249 920.3628,-5591.7429 938.6824,-5563.3836 1045.6252,-5503.1249 1069.7548,-5489.5287 1075.4945,-5472.9737 1102.7076,-5478.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M755.1332,-6278.1249C799.6882,-6268.361 810.605,-6264.3302 855.7932,-6258.1249 964.8341,-6243.1515 995.9556,-6265.9225 1102.7076,-6239.1249"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1102.7076,-6239.1249C1183.6911,-6214.7055 1134.8254,-6131.759 1195.79,-6073.1249 1256.371,-6014.8599 1296.2059,-6036.5056 1364.2236,-5987.1249 1558.8239,-5845.8458 1607.8039,-5800.9253 1747.415,-5605.1249 1791.2921,-5543.5887 1825.0936,-5459.7337 1839.4229,-5421.1391"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1842.7967,-5422.1036 1842.9403,-5411.5097 1836.2216,-5419.7018 1842.7967,-5422.1036"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M399.0839,-647.1249C422.7327,-624.9441 551.3364,-690.8245 654.4731,-747.1249 820.8198,-837.9305 864.4211,-861.3357 1009.6252,-983.1249 1097.1279,-1056.5173 1296.9273,-1262.8516 1364.2236,-1355.1249 1370.2789,-1363.4277 1437.4489,-1488.4187 1464.0521,-1538.0408"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1460.9931,-1539.7427 1468.8017,-1546.9035 1467.1629,-1536.4361 1460.9931,-1539.7427"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M585.7192,-6049.1249C773.5764,-6080.1823 829.0785,-6047.6041 1009.6252,-5987.1249 1034.1755,-5978.9011 1059.8172,-5964.3412 1077.9566,-5952.8778"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1080.2163,-5955.5846 1086.7129,-5947.2154 1076.4151,-5949.7066 1080.2163,-5955.5846"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M399.0839,-5935.1249C476.0287,-5942.9186 458.0686,-5857.249 516.9653,-5807.1249 518.8846,-5805.4915 818.4668,-5609.2678 819.7932,-5607.1249 854.5528,-5550.9707 845.0278,-5377.2835 855.7932,-5312.1249 877.787,-5179.0053 914.414,-5020.9188 927.7007,-4964.9871"/>
<polygon fill="#00ffc8" stroke="#00ffc8" points="931.1193,-4965.7397 930.0356,-4955.2005 924.3104,-4964.1152 931.1193,-4965.7397"/>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M223.8406,-5935.1249C296.8165,-5962.3413 321.6701,-5926.562 399.0839,-5935.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M932.7092,-77.1249C1034.4816,-34.6571 1086.4853,-94.7384 1159.79,-177.1249 1210.8669,-234.5297 1261.4899,-474.2569 1275.932,-547.0641"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1272.5041,-547.7716 1277.8653,-556.9098 1279.3729,-546.4228 1272.5041,-547.7716"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M223.8406,-4451.1249C303.7553,-4479.0277 248.7894,-4567.2793 317.2024,-4617.1249 428.3104,-4698.0781 801.4662,-4720.0353 932.7092,-4679.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M585.7192,-6316.1249C619.5455,-6334.6837 717.4446,-6286.3841 755.1332,-6278.1249"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-5935.1249C586.2906,-5957.6632 420.4071,-6225.4265 585.7192,-6316.1249"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M755.1332,-6278.1249C867.7211,-6253.4522 844.9753,-6163.8748 932.7092,-6089.1249"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M932.7092,-6089.1249C975.9276,-6052.3026 979.5771,-6035.2999 1009.6252,-5987.1249 1028.3493,-5957.1055 1019.249,-5939.7056 1045.6252,-5916.1249 1158.3121,-5815.3814 1269.6201,-5915.0137 1364.2236,-5797.1249 1400.317,-5752.1477 1389.858,-5596.8544 1400.2236,-5540.1249 1421.7602,-5422.2591 1456.3327,-5282.6998 1469.4915,-5230.8581"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1472.8833,-5231.7211 1471.962,-5221.1664 1466.1003,-5229.992 1472.8833,-5231.7211"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M399.0839,-4261.1249C430.2486,-4239.5171 453.5125,-4263.2875 480.9653,-4237.1249 516.3743,-4203.3803 485.5994,-4170.6572 516.9653,-4133.1249 597.3617,-4036.9232 955.8123,-3870.2766 1068.6092,-3819.3464"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1070.1519,-3822.4903 1077.8328,-3815.1927 1067.2776,-3816.1076 1070.1519,-3822.4903"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M223.8406,-4451.1249C332.2981,-4488.9937 306.7726,-4329.5041 399.0839,-4261.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M223.8406,-4451.1249C313.908,-4483.0696 255.5052,-3669.1049 317.2024,-3596.1249 417.5546,-3477.4209 622.2587,-3467.927 711.6934,-3469.8964"/>
<polygon fill="#1200ff" stroke="#1200ff" points="711.6668,-3473.397 721.7608,-3470.1782 711.8627,-3466.3997 711.6668,-3473.397"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M399.0839,-417.1249C501.6245,-296.5985 596.9647,-412.2307 755.1332,-417.1249"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M755.1332,-417.1249C867.315,-432.1106 904.3679,-384.5292 1009.6252,-426.1249 1091.9934,-458.6753 1113.3033,-481.7391 1159.79,-557.1249 1193.5116,-611.81 1163.885,-641.3605 1195.79,-697.1249 1305.9124,-889.5997 1400.6624,-884.65 1549.3953,-1049.1249 1719.9826,-1237.7675 1792.47,-1267.7932 1910.4177,-1493.1249 1952.682,-1573.8682 1973.6941,-1682.0198 1981.0688,-1727.0623"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1977.6367,-1727.7677 1982.6545,-1737.099 1984.551,-1726.6752 1977.6367,-1727.7677"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1352.5923,-999.1304 1207.4214,-999.1304 1207.4214,-977.1195 1352.5923,-977.1195 1352.5923,-999.1304"/>
<text text-anchor="middle" x="1280.0068" y="-984.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M755.1332,-417.1249C876.7763,-424.2927 917.5751,-439.2801 1009.6252,-519.1249 1162.9211,-652.0946 1249.9696,-894.3933 1273.471,-967.0106"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1270.2227,-968.3455 1276.5883,-976.8148 1276.8936,-966.2244 1270.2227,-968.3455"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-3777.1304 180.0456,-3777.1304 180.0456,-3755.1195 267.6355,-3755.1195 267.6355,-3777.1304"/>
<text text-anchor="middle" x="223.8406" y="-3762.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ec00ff" stroke-dasharray="5,2" d="M70.3367,-4098.1012C92.9847,-4049.1213 184.6842,-3850.8067 214.4561,-3786.4203"/>
<polygon fill="#ec00ff" stroke="#ec00ff" points="217.6623,-3787.8256 218.6825,-3777.28 211.3087,-3784.8877 217.6623,-3787.8256"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M399.0839,-5935.1249C675.012,-5968.3446 1228.6538,-5704.7758 1364.2236,-5498.1249 1443.5771,-5377.1654 1352.7401,-4984.776 1400.2236,-4848.1249 1402.0392,-4842.8999 1598.266,-4566.1548 1652.5996,-4489.5776"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1655.567,-4491.4438 1658.4996,-4481.2629 1649.8582,-4487.3929 1655.567,-4491.4438"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M399.0839,-4261.1249C422.3902,-4243.8609 626.4388,-4214.5618 654.4731,-4207.1249 729.0527,-4187.3406 751.0725,-4189.2105 819.7932,-4154.1249 875.2657,-4125.8033 879.0728,-4102.7863 932.7092,-4071.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M66.2559,-4098.0101C78.3237,-3967.2325 195.942,-2724.567 317.2024,-2622.1249 381.3664,-2567.9185 488.2274,-2590.0168 545.8964,-2607.8609"/>
<polygon fill="#ff006d" stroke="#ff006d" points="545.141,-2611.2941 555.7321,-2611.0117 547.2765,-2604.6278 545.141,-2611.2941"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1474.8094,-6467.1249C1921.3084,-6446.7369 2142.7743,-6359.5692 2343.3267,-5960.1249 2515.6571,-5616.8909 2456.1347,-5492.45 2509.6157,-5112.1249 2580.5532,-4607.66 2576.9715,-4478.6192 2607.8035,-3970.1249 2683.7758,-2717.1536 2711.0669,-1168.4204 2714.3377,-969.4946"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2717.8379,-969.5033 2714.5012,-959.4476 2710.8388,-969.3893 2717.8379,-969.5033"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1188.1249C262.3942,-1145.5683 472.3047,-1167.0201 480.9653,-1168.1249 559.9908,-1178.206 579.4299,-1186.3822 654.4731,-1213.1249 918.6671,-1307.2742 1017.6596,-1349.3368 1159.79,-1591.1249 1241.5448,-1730.2036 1270.2421,-1927.8914 1277.7697,-1992.6705"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1274.319,-1993.3084 1278.9036,-2002.8599 1281.2761,-1992.5341 1274.319,-1993.3084"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-5414.1304 539.0902,-5414.1304 539.0902,-5392.1195 632.3482,-5392.1195 632.3482,-5414.1304"/>
<text text-anchor="middle" x="585.7192" y="-5399.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-4451.1249C418.5104,-4521.6239 170.2507,-5232.2769 317.2024,-5378.1249 372.8402,-5433.3449 470.5576,-5427.0285 531.5141,-5416.0478"/>
<polygon fill="#7fff00" stroke="#7fff00" points="532.1685,-5419.4862 541.3391,-5414.1804 530.8614,-5412.6093 532.1685,-5419.4862"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="445.0438,-1391.1304 353.1239,-1391.1304 353.1239,-1369.1195 445.0438,-1369.1195 445.0438,-1391.1304"/>
<text text-anchor="middle" x="399.0839" y="-1376.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1188.1249C254.7845,-1152.2784 352.7606,-1304.2294 387.0732,-1360.1683"/>
<polygon fill="#00ffff" stroke="#00ffff" points="384.1738,-1362.1365 392.3637,-1368.8577 390.1527,-1358.4961 384.1738,-1362.1365"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-1618.1304 334.3841,-1618.1304 334.3841,-1596.1195 463.7837,-1596.1195 463.7837,-1618.1304"/>
<text text-anchor="middle" x="399.0839" y="-1603.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-1188.1249C341.4348,-1051.8999 194.0657,-1450.8885 317.2024,-1582.1249 320.5236,-1585.6646 324.3299,-1588.708 328.4434,-1591.3242"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="326.804,-1594.4166 337.2617,-1596.1162 330.1464,-1588.2661 326.804,-1594.4166"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-5548.1304 168.8556,-5548.1304 168.8556,-5526.1195 278.8255,-5526.1195 278.8255,-5548.1304"/>
<text text-anchor="middle" x="223.8406" y="-5533.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.47,-4120.2052C80.1115,-4243.0289 202.9238,-5348.796 221.493,-5515.988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="218.0227,-5516.4504 222.6053,-5526.0029 224.98,-5515.6776 218.0227,-5516.4504"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-5528.1304 340.6161,-5528.1304 340.6161,-5506.1195 457.5516,-5506.1195 457.5516,-5528.1304"/>
<text text-anchor="middle" x="399.0839" y="-5513.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4451.1249C441.1502,-4533.1133 170.8048,-5311.8105 317.2024,-5492.1249 321.1035,-5496.9299 325.902,-5500.8331 331.2026,-5504.0009"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.0183,-5507.322 340.5274,-5508.667 333.1508,-5501.062 330.0183,-5507.322"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1549.4812,-4879.1304 1400.1377,-4879.1304 1400.1377,-4857.1195 1549.4812,-4857.1195 1549.4812,-4879.1304"/>
<text text-anchor="middle" x="1474.8094" y="-4864.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4451.1249C411.4859,-4516.3006 169.5882,-5207.2013 317.2024,-5340.1249 371.289,-5388.8289 414.4692,-5369.7172 480.9653,-5340.1249 708.3367,-5238.9397 633.2161,-5035.4606 855.7932,-4924.1249 1029.6835,-4837.143 1265.4499,-4844.8625 1389.8449,-4857.0637"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1389.7658,-4860.5736 1400.0681,-4858.1014 1390.4727,-4853.6094 1389.7658,-4860.5736"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-5606.1304 323.0941,-5606.1304 323.0941,-5584.1195 475.0737,-5584.1195 475.0737,-5606.1304"/>
<text text-anchor="middle" x="399.0839" y="-5591.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.6528,-4120.5618C71.2346,-4273.1208 132.9056,-5901.2107 223.8406,-5935.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-5935.1249C360.8168,-5986.2102 391.8023,-5698.0037 397.7948,-5616.2712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="401.2954,-5616.3802 398.483,-5606.1655 394.3116,-5615.9046 401.2954,-5616.3802"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-4842.1304 317.3208,-4842.1304 317.3208,-4820.1195 480.847,-4820.1195 480.847,-4842.1304"/>
<text text-anchor="middle" x="399.0839" y="-4827.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4451.1249C376.4809,-4508.7143 204.1238,-4688.5289 317.2024,-4806.1249 320.5667,-4809.6236 324.4051,-4812.6365 328.5419,-4815.2307"/>
<polygon fill="#00ffff" stroke="#00ffff" points="326.9305,-4818.338 337.3959,-4819.9887 330.2441,-4812.172 326.9305,-4818.338"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1188.1249C354.1864,-1037.128 229.4845,-1447.9723 317.2024,-1627.1249 366.8209,-1728.4645 429.5589,-1720.6804 480.9653,-1821.1249 552.9907,-1961.8574 577.4321,-2154.9889 583.8139,-2218.7476"/>
<polygon fill="#ff0000" stroke="#ff0000" points="580.3385,-2219.1721 584.7745,-2228.7935 587.3067,-2218.5058 580.3385,-2219.1721"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-647.1249C497.4772,-553.5561 900.5882,-590.2095 1009.6252,-671.1249 1048.9043,-700.2736 1024.2236,-731.1424 1045.6252,-775.1249 1099.5302,-885.905 1116.2997,-914.0013 1195.79,-1008.1249 1261.2363,-1085.6192 1306.8199,-1078.4985 1364.2236,-1162.1249 1389.0724,-1198.3249 1377.3899,-1216.6213 1400.2236,-1254.1249 1493.4405,-1407.2305 1584.6313,-1397.614 1666.4052,-1557.1249"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1532.2126,-2867.1304 1417.4063,-2867.1304 1417.4063,-2845.1195 1532.2126,-2845.1195 1532.2126,-2867.1304"/>
<text text-anchor="middle" x="1474.8094" y="-2852.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M68.1811,-4120.363C83.2299,-4176.7243 153.629,-4426.8655 223.8406,-4451.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4451.1249C324.8209,-4486.0156 288.6251,-3597.0702 317.2024,-3494.1249 362.495,-3330.9654 414.516,-3305.8713 480.9653,-3150.1249 498.6842,-3108.5947 482.2007,-3083.937 516.9653,-3055.1249 628.6679,-2962.5484 1018.1932,-2972.7193 1159.79,-2941.1249 1255.8921,-2919.6818 1366.7237,-2888.1702 1427.9756,-2870.1491"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1429.1333,-2873.4567 1437.7333,-2867.2689 1427.1515,-2866.7431 1429.1333,-2873.4567"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1227.1249C542.7449,-1221.5602 887.8919,-1364.6366 1009.6252,-1441.1249 1230.5901,-1579.9632 1269.5894,-1665.9256 1364.2236,-1909.1249 1453.9863,-2139.8048 1471.1076,-2445.3798 1474.1754,-2528.4862"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1470.6849,-2528.8295 1474.5211,-2538.7054 1477.6809,-2528.5927 1470.6849,-2528.8295"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4451.1249C403.8559,-4516.9981 470.248,-4480.0954 654.4731,-4427.1249 827.7403,-4377.3052 852.2575,-4319.0959 1009.6252,-4231.1249 1266.3097,-4087.6343 1314.7245,-4020.0762 1585.3953,-3905.1249 1654.5221,-3875.7674 1677.8489,-3885.4256 1747.415,-3857.1249 1995.6837,-3756.1251 2058.0021,-3724.8094 2281.0071,-3576.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M932.7092,-6089.1249C1105.3061,-5951.8359 1240.6604,-6026.7997 1364.2236,-5844.1249 1430.8178,-5745.6728 1365.8718,-5692.9122 1400.2236,-5579.1249 1454.7525,-5398.5034 1498.1875,-5364.434 1585.3953,-5197.1249 1737.4205,-4905.4629 1756.5302,-4819.6787 1946.4177,-4551.1249 1975.8031,-4509.5658 2002.1835,-4511.9891 2022.0432,-4465.1249 2060.9269,-4373.3689 1993.8492,-4094.3499 2058.0432,-4018.1249 2060.6798,-4014.9942 2063.8383,-4012.4319 2067.3154,-4010.3395"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2068.9197,-4013.4532 2076.4988,-4006.0498 2065.9572,-4007.111 2068.9197,-4013.4532"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1102.7076,-6239.1249C1669.6278,-6055.5129 1765.1491,-5800.8212 2022.0432,-5263.1249 2111.969,-5074.9044 2124.3604,-5022.4036 2182.6875,-4822.1249 2229.4362,-4661.6029 2265.9985,-4462.8824 2277.3387,-4398.3962"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2280.8346,-4398.7225 2279.1053,-4388.2698 2273.9387,-4397.5195 2280.8346,-4398.7225"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-6278.1249C785.1454,-6271.8875 791.4823,-6290.372 819.7932,-6302.1249 870.8216,-6323.3088 878.8964,-6341.6019 932.7092,-6354.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M932.7092,-6354.1249C1399.1582,-6462.6742 1605.6808,-6270.5745 1910.4177,-5901.1249 2054.8294,-5726.0466 2092.074,-5677.2026 2182.6875,-5469.1249 2237.9327,-5342.2642 2268.2447,-5177.1024 2277.723,-5119.2472"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2281.2146,-5119.5781 2279.3421,-5109.15 2274.3029,-5118.4697 2281.2146,-5119.5781"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2182.5101,-5753.1304 2058.2206,-5753.1304 2058.2206,-5731.1195 2182.5101,-5731.1195 2182.5101,-5753.1304"/>
<text text-anchor="middle" x="2120.3654" y="-5738.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1474.8094,-6467.1249C1700.7996,-6444.9303 1764.3363,-6373.9765 1910.4177,-6200.1249 1938.3981,-6166.8255 1920.7794,-6144.2594 1946.4177,-6109.1249 1972.0376,-6074.0158 2000.9784,-6085.1421 2022.0432,-6047.1249 2082.853,-5937.3771 1981.2562,-5866.3528 2058.0432,-5767.1249 2060.5403,-5763.898 2063.5196,-5761.0862 2066.8024,-5758.6362"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2068.8254,-5761.5004 2075.4865,-5753.2614 2065.1413,-5755.5482 2068.8254,-5761.5004"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M932.7092,-6354.1249C1053.7013,-6378.5577 1074.9656,-6417.8758 1195.79,-6443.1249 1317.6247,-6468.5851 1350.682,-6476.3064 1474.8094,-6467.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M932.7092,-77.1249C1011.1773,-50.8146 1020.4038,7.5669 1102.7076,-1.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-417.1249C497.8743,-291.4006 544.958,-272.3933 690.4731,-206.1249 717.3211,-193.8982 727.5618,-201.619 755.1332,-191.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1102.7076,-1.1249C1434.4093,-36.1547 1474.9483,-190.234 1783.415,-317.1249 1887.6728,-360.0124 1917.9421,-359.8585 2022.0432,-403.1249 2094.979,-433.4384 2129.8639,-420.4035 2182.6875,-479.1249 2215.1191,-515.1776 2190.8799,-542.3966 2218.6875,-582.1249 2314.4827,-718.9864 2433.2702,-671.5343 2509.6157,-820.1249 2558.0009,-914.2966 2573.8846,-1702.3812 2576.3526,-1843.5275"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2572.8588,-1843.929 2576.5293,-1853.8677 2579.8578,-1843.8093 2572.8588,-1843.929"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M755.1332,-191.1249C810.6554,-170.7814 804.6298,-133.771 855.7932,-104.1249 887.1408,-85.9609 898.3588,-88.6426 932.7092,-77.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-1188.1249C432.7457,-959.8163 179.0833,-775.0533 317.2024,-498.1249 340.0493,-452.3169 367.6718,-457.5433 399.0839,-417.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M65.442,-4097.8329C68.9519,-3904.923 118.203,-1303.5743 223.8406,-1188.1249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-533.1249C1093.6081,-583.1722 1067.4925,-696.887 1195.79,-806.1249 1340.9807,-929.7464 1400.6453,-929.81 1549.3953,-1049.1249 1660.2775,-1138.0655 1677.024,-1172.8582 1783.415,-1267.1249 1838.658,-1316.0724 1866.9694,-1314.4601 1910.4177,-1374.1249 1929.7089,-1400.6163 2015.0723,-1615.1039 2022.0432,-1647.1249 2043.0247,-1743.5042 2010.0979,-2447.9249 2058.0432,-2534.1249 2094.2088,-2599.1463 2176.1653,-2635.9752 2229.9985,-2653.9694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2229.1138,-2657.3618 2239.7057,-2657.1127 2231.2703,-2650.7022 2229.1138,-2657.3618"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2164.2495,-2525.1304 2076.4812,-2525.1304 2076.4812,-2503.1195 2164.2495,-2503.1195 2164.2495,-2525.1304"/>
<text text-anchor="middle" x="2120.3654" y="-2510.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-647.1249C484.2987,-560.8565 814.1191,-507.823 932.7092,-533.1249"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M932.7092,-533.1249C1032.0215,-554.0216 1082.9721,-490.803 1159.79,-557.1249 1208.4197,-599.1101 1157.5739,-645.4807 1195.79,-697.1249 1305.3348,-845.1606 1414.343,-787.9232 1549.3953,-913.1249 1569.4764,-931.7414 1566.2408,-943.5563 1585.3953,-963.1249 1648.4489,-1027.542 1687.2998,-1017.9574 1747.415,-1085.1249 1805.2891,-1149.7883 1769.6107,-1213.6965 1846.9164,-1253.1249"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1846.9164,-1253.1249C1873.7819,-1266.8562 1888.7031,-1256.1778 1910.4177,-1277.1249 2002.6918,-1366.1377 1994.3542,-1417.9407 2022.0432,-1543.1249 2044.7601,-1645.8298 1997.4688,-2403.1303 2058.0432,-2489.1249 2060.6824,-2492.8717 2063.9808,-2496.0573 2067.6735,-2498.7657"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2065.9153,-2501.7926 2076.285,-2503.9652 2069.5335,-2495.8002 2065.9153,-2501.7926"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="459.7908,-3777.1304 338.377,-3777.1304 338.377,-3755.1195 459.7908,-3755.1195 459.7908,-3777.1304"/>
<text text-anchor="middle" x="399.0839" y="-3762.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-4451.1249C363.255,-4503.7244 217.8659,-3898.1895 317.2024,-3787.1249 320.5716,-3783.3579 324.5161,-3780.2244 328.8201,-3777.6221"/>
<polygon fill="#0000ff" stroke="#0000ff" points="330.707,-3780.592 338.0905,-3772.9937 327.5801,-3774.3292 330.707,-3780.592"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1227.1249C671.8254,-1228.895 760.2687,-1178.6152 1009.6252,-1289.1249 1160.3553,-1355.9254 1484.9143,-1646.3881 1549.3953,-1798.1249 1622.4957,-1970.1454 1552.5115,-2033.1321 1585.3953,-2217.1249 1604.1595,-2322.1154 1643.3326,-2443.9114 1659.3501,-2491.5448"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1656.0436,-2492.693 1662.5681,-2501.0405 1662.6732,-2490.4461 1656.0436,-2492.693"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1188.1249C225.5238,-1186.2853 396.6187,-1226.75 399.0839,-1227.1249"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.3078,-1199.1304 341.8599,-1199.1304 341.8599,-1177.1195 456.3078,-1177.1195 456.3078,-1199.1304"/>
<text text-anchor="middle" x="399.0839" y="-1184.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1188.1249C256.8079,-1149.9345 320.5967,-1161.2207 361.4439,-1173.9099"/>
<polygon fill="#00ffff" stroke="#00ffff" points="360.4572,-1177.2695 371.0498,-1177.0503 362.6325,-1170.6161 360.4572,-1177.2695"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1009.5414,-6289.1304 855.8771,-6289.1304 855.8771,-6267.1195 1009.5414,-6267.1195 1009.5414,-6289.1304"/>
<text text-anchor="middle" x="932.7092" y="-6274.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6278.1249C784.092,-6271.7788 816.351,-6270.2003 845.3449,-6270.7032"/>
<polygon fill="#ff0000" stroke="#ff0000" points="845.3666,-6274.2048 855.4534,-6270.9634 845.5468,-6267.2071 845.3666,-6274.2048"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-191.1249C1110.0344,-210.7022 1078.1941,-363.4756 1159.79,-522.1249 1181.2035,-563.7598 1163.9502,-586.7996 1195.79,-621.1249 1251.6418,-681.3366 1292.5747,-656.984 1364.2236,-697.1249 1468.2803,-755.4221 1488.2732,-779.8887 1585.3953,-849.1249 1657.0902,-900.2347 1690.6925,-895.783 1747.415,-963.1249 1771.4934,-991.7111 1757.9735,-1011.7449 1783.415,-1039.1249 1827.5824,-1086.6576 1858.2824,-1072.4983 1910.4177,-1111.1249 1965.3899,-1151.8534 1979.6759,-1163.4057 2022.0432,-1217.1249 2061.2681,-1266.8598 2095.3429,-1333.9395 2111.0847,-1366.9966"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2107.9453,-1368.5454 2115.3669,-1376.1065 2114.2803,-1365.5675 2107.9453,-1368.5454"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-191.1249C828.8937,-163.0505 856.3793,-171.0618 932.7092,-191.1249"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1303.6697,-977.0118C1444.7272,-910.9243 2172.2522,-572.3498 2281.0071,-568.1249"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1282.9481,-999.2001C1295.4775,-1046.0288 1346.2324,-1232.2138 1400.2236,-1381.1249 1421.1466,-1438.8317 1450.5439,-1505.0659 1465.4105,-1537.7274"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1462.3547,-1539.4612 1469.6976,-1547.0988 1468.7203,-1536.5491 1462.3547,-1539.4612"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1352.6551,-984.211C1528.6998,-974.9462 1992.1375,-951.8704 2379.3267,-944.1249 2437.2213,-942.9668 2451.7351,-942.4011 2509.6157,-944.1249 2539.4749,-945.0142 2546.8466,-947.3727 2576.7096,-948.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2576.7096,-948.1249C2595.0621,-946.9273 2614.8171,-946.448 2633.4823,-946.364"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2633.7267,-949.8639 2643.7239,-946.3559 2633.7211,-942.8639 2633.7267,-949.8639"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-1557.1249C1698.8502,-1620.4133 1717.1866,-1630.7484 1747.415,-1695.1249 1790.468,-1786.8135 1826.848,-1902.6109 1840.808,-1949.2541"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1837.5263,-1950.4985 1843.7251,-1959.0907 1844.2374,-1948.5083 1837.5263,-1950.4985"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-1063.1249C1663.796,-1203.6235 1558.9746,-1347.5672 1666.4052,-1557.1249"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1287.5445,-999.4877C1324.1207,-1055.2843 1484.0103,-1306.8982 1549.3953,-1538.1249 1594.9545,-1699.2402 1554.7155,-1748.5268 1585.3953,-1913.1249 1634.3594,-2175.8191 1678.1908,-2234.0286 1747.415,-2492.1249 1874.603,-2966.334 1926.6816,-3080.5056 2022.0432,-3562.1249 2044.3599,-3674.8341 2031.4976,-3706.3362 2058.0432,-3818.1249 2072.387,-3878.5294 2098.3259,-3947.201 2111.7685,-3981.0191"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2108.6894,-3982.7439 2115.6634,-3990.7197 2115.1854,-3980.1357 2108.6894,-3982.7439"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1324.4245,-999.1527C1337.4768,-1002.9666 1351.6257,-1007.6746 1364.2236,-1013.1249 1381.2241,-1020.4799 1383.54,-1026.0771 1400.2236,-1034.1249 1432.2581,-1049.5776 1446.2663,-1041.905 1474.8094,-1063.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.8094,-1063.1249C1543.1472,-1113.9294 1587.8739,-1030.2009 1666.4052,-1063.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6316.1249C800.8944,-6337.137 809.1107,-6349.248 855.7932,-6368.1249 937.4602,-6401.1484 961.2485,-6399.8146 1045.6252,-6425.1249 1112.3597,-6445.1431 1127.1513,-6458.1691 1195.79,-6470.1249 1291.022,-6486.7129 1712.0723,-6522.8638 1846.9164,-6505.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.988,-3777.1771C231.5696,-3840.9795 264.8042,-4168.7141 281.2024,-4437.1249 284.5213,-4491.4493 287.6445,-5370.425 317.2024,-5416.1249 361.3011,-5484.3066 435.9582,-5429.5394 480.9653,-5497.1249 550.8217,-5602.0256 473.0448,-5944.9935 516.9653,-6063.1249 561.4646,-6182.8128 587.9681,-6215.9797 690.4731,-6292.1249 715.0802,-6310.4042 726.7448,-6304.5605 755.1332,-6316.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3846.1249C447.0321,-3860.291 501.8222,-3876.7649 539.5735,-3888.1605"/>
<polygon fill="#ff0000" stroke="#ff0000" points="538.6839,-3891.548 549.2688,-3891.0886 540.7077,-3884.8469 538.6839,-3891.548"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M585.7192,-4413.1249C1009.2786,-4477.9697 1129.5154,-4527.6134 1549.3953,-4442.1249 1604.642,-4430.8766 1613.9501,-4413.7937 1666.4052,-4393.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff6d00" stroke-dasharray="5,2" d="M267.6098,-3776.3652C290.1527,-3781.6393 317.9132,-3788.1342 342.1073,-3793.7947"/>
<polygon fill="#ff6d00" stroke="#ff6d00" points="341.347,-3797.2112 351.8814,-3796.0814 342.9417,-3790.3953 341.347,-3797.2112"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#ffa300" stroke-dasharray="5,2" d="M224.173,-3754.9623C229.6317,-3571.9154 300.7059,-1198.6686 317.2024,-1168.1249 327.1909,-1149.631 345.9528,-1135.686 362.9993,-1126.1102"/>
<polygon fill="#ffa300" stroke="#ffa300" points="365.0174,-1129.0027 372.2265,-1121.2387 361.7491,-1122.8124 365.0174,-1129.0027"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M224.1741,-3755.092C227.6412,-3640.3916 257.4491,-2653.8698 281.2024,-1855.1249 283.2213,-1787.2366 286.1466,-693.5272 317.2024,-633.1249 362.9948,-544.0605 1011.3545,-150.0882 1102.7076,-191.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M224.1803,-3754.844C229.6864,-3572.2368 300.4901,-1232.0909 317.2024,-1090.1249 338.6725,-907.7424 270.8262,-816.5568 399.0839,-685.1249"/>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M399.0839,-685.1249C425.5696,-657.9837 453.5125,-687.2875 480.9653,-661.1249 516.3743,-627.3803 489.9504,-597.901 516.9653,-557.1249 539.6908,-522.8232 547.4139,-510.1501 585.7192,-495.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-4413.1249C709.2005,-4399.4463 1074.6489,-4334.9254 1219.6943,-4308.9739"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1220.5238,-4312.3812 1229.7503,-4307.1733 1219.2899,-4305.4908 1220.5238,-4312.3812"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M224.5678,-3777.3559C229.1021,-3844.4133 255.3381,-4191.8148 317.2024,-4275.1249 397.1972,-4382.8507 451.6312,-4418.065 585.7192,-4413.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M932.7092,-685.1249C1059.4989,-658.0736 1073.3226,-768.5909 1195.79,-811.1249 1268.2832,-836.3025 1290.5757,-827.5578 1364.2236,-849.1249 1554.4135,-904.8202 1595.1851,-939.1277 1783.415,-1001.1249 1884.7117,-1034.4889 2004.7501,-1068.9075 2070.7235,-1087.3892"/>
<polygon fill="#48ff00" stroke="#48ff00" points="2069.8733,-1090.7856 2080.4464,-1090.1071 2071.7579,-1084.0441 2069.8733,-1090.7856"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M224.8059,-3777.4209C234.5837,-3891.8276 315.3847,-4837.0323 317.2024,-4851.1249 344.6058,-5063.5898 327.2049,-5124.3189 399.0839,-5326.1249"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M399.0839,-5326.1249C409.031,-5354.0522 906.9456,-5311.4583 932.7092,-5326.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M399.0839,-5326.1249C412.3896,-5360.5638 454.9333,-5313.9446 480.9653,-5340.1249 550.2065,-5409.7605 456.6942,-5480.5953 516.9653,-5558.1249 568.6358,-5624.5911 609.4543,-5611.2438 690.4731,-5634.1249 980.1971,-5715.9481 1068.6584,-5761.3628 1364.2236,-5704.1249 1468.2496,-5683.9797 1485.3372,-5649.9908 1585.3953,-5615.1249 1620.8553,-5602.7686 1634.5136,-5610.9498 1666.4052,-5591.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M224.1378,-3754.6484C228.5091,-3586.7242 280.1706,-1631.7382 317.2024,-1587.1249 341.0633,-1558.379 375.6097,-1597.1875 399.0839,-1568.1249"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M585.7192,-1455.1249C808.164,-1321.2591 901.234,-1323.6615 1159.79,-1347.1249 1213.8848,-1352.0339 1232.8213,-1342.2203 1280.0068,-1369.1249"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M399.0839,-1568.1249C442.0735,-1514.901 455.351,-1498.8666 516.9653,-1469.1249 545.049,-1455.5687 557.2708,-1467.8981 585.7192,-1455.1249"/>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M1280.0068,-1369.1249C1322.5213,-1387.2499 1336.6199,-1393.057 1364.2236,-1430.1249 1393.1871,-1469.0187 1365.7144,-1499.0556 1400.2236,-1533.1249 1404.8157,-1537.6585 1410.2535,-1541.3702 1416.0684,-1544.4089"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1414.8954,-1547.7197 1425.4492,-1548.6516 1417.7801,-1541.3417 1414.8954,-1547.7197"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M224.9752,-3777.1779C231.4854,-3840.9847 264.3895,-4168.7397 281.2024,-4437.1249 287.4804,-4537.3415 270.72,-5251.1184 317.2024,-5340.1249 359.4636,-5421.0487 436.7764,-5384.2374 480.9653,-5464.1249 525.1281,-5543.965 453.224,-5807.8422 516.9653,-5873.1249 660.7118,-6020.3474 940.2646,-5975.0861 1053.4037,-5948.9494"/>
<polygon fill="#00ff91" stroke="#00ff91" points="1054.2559,-5952.3445 1063.1846,-5946.641 1052.648,-5945.5317 1054.2559,-5952.3445"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffc8" stroke-dasharray="5,2" d="M224.7726,-3777.2987C232.9514,-3874.9245 292.7779,-4580.2099 317.2024,-4617.1249 447.6748,-4814.3204 737.5905,-4900.998 867.5177,-4930.9816"/>
<polygon fill="#00ffc8" stroke="#00ffc8" points="866.8144,-4934.4109 877.341,-4933.2105 868.3634,-4927.5844 866.8144,-4934.4109"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-685.1249C411.8076,-671.9609 1027.4045,-558.9112 1045.6252,-557.1249 1096.2255,-552.1642 1153.198,-554.6553 1198.3018,-558.5112"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1198.052,-562.0027 1208.3239,-559.4068 1198.6752,-555.0305 1198.052,-562.0027"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M755.1332,-4679.1249C833.0784,-4691.5079 857.3623,-4702.6117 932.7092,-4679.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.0839,-5326.1249C411.4334,-5360.9181 454.0656,-5314.837 480.9653,-5340.1249 531.863,-5387.9729 476.9298,-5435.8785 516.9653,-5493.1249 569.846,-5568.7385 602.0731,-5580.6825 690.4731,-5607.1249 885.9894,-5665.6081 1204.031,-5658.588 1364.2236,-5526.1249 1411.7542,-5486.822 1456.4777,-5295.5175 1470.3837,-5231.2387"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1473.8165,-5231.9228 1472.4823,-5221.4123 1466.9709,-5230.4607 1473.8165,-5231.9228"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M399.0839,-3136.1249C494.6832,-3028.8039 901.9121,-3151.2359 1045.6252,-3153.1249 1096.3608,-3153.7918 1109.5312,-3160.0954 1159.79,-3153.1249 1161.5088,-3152.8866 1278.3515,-3119.6453 1280.0068,-3119.1249"/>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M1280.0068,-3119.1249C1308.3478,-3111.9195 1384.0613,-3132.9299 1432.3187,-3148.0672"/>
<polygon fill="#005bff" stroke="#005bff" points="1431.2868,-3151.4117 1441.8771,-3151.101 1433.4045,-3144.7397 1431.2868,-3151.4117"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M237.5065,-3777.2956C254.9569,-3791.0101 286.5731,-3814.053 317.2024,-3827.1249 351.5627,-3841.7891 363.2562,-3835.5398 399.0839,-3846.1249"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M399.0839,-3846.1249C456.1134,-3862.9741 873.5547,-3799.0423 932.7092,-3805.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M225.8363,-3754.9527C242.0076,-3667.309 356.8732,-3097.1111 585.7192,-3231.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M224.1693,-3754.9724C229.3631,-3579.1455 294.6732,-1382.9948 317.2024,-1360.1249 401.318,-1274.7374 735.9763,-1334.3483 855.7932,-1331.1249 990.8657,-1327.4911 1024.9289,-1326.7425 1159.79,-1335.1249 1250.9073,-1340.7884 1292.3561,-1298.8267 1364.2236,-1355.1249 1402.0683,-1384.771 1364.6305,-1424.8102 1400.2236,-1457.1249 1517.9225,-1563.983 1607.0796,-1468.4414 1747.415,-1543.1249 1773.7347,-1557.1317 1922.8596,-1704.8512 1946.4177,-1723.1249 1950.0127,-1725.9135 1953.9124,-1728.7176 1957.7958,-1731.3879"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1955.8862,-1734.3214 1966.1467,-1736.9622 1959.7726,-1728.4993 1955.8862,-1734.3214"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#b600ff" stroke-dasharray="5,2" d="M399.0839,-685.1249C453.098,-629.774 447.7858,-778.5498 516.9653,-813.1249 612.1301,-860.6872 648.7447,-837.1249 755.1332,-837.1249 755.1332,-837.1249 755.1332,-837.1249 932.7092,-837.1249 1037.3282,-837.1249 1077.3006,-834.7773 1159.79,-899.1249 1185.5224,-919.198 1170.2803,-942.7696 1195.79,-963.1249 1200.5251,-966.9032 1205.8181,-970.1109 1211.3819,-972.8341"/>
<polygon fill="#b600ff" stroke="#b600ff" points="1210.3829,-976.2154 1220.9505,-976.9748 1213.163,-969.7911 1210.3829,-976.2154"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M224.12,-3777.2372C226.1648,-3850.1604 240.9695,-4260.1696 317.2024,-4353.1249 650.9765,-4760.1155 1432.7655,-4544.7616 1623.7527,-4484.2921"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1624.971,-4487.5772 1633.4311,-4481.1994 1622.8402,-4480.9094 1624.971,-4487.5772"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M932.7092,-4071.1249C1014.5974,-4031.5019 1017.44,-3988.8279 1102.7076,-3957.1249"/>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M399.0839,-4223.1249C448.0489,-4260.5838 877.2142,-4097.9772 932.7092,-4071.1249"/>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M224.2105,-3777.4284C226.78,-3835.7016 246.7968,-4104.0481 399.0839,-4223.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M224.0388,-3754.8009C226.0482,-3645.7617 244.1928,-2784.1997 317.2024,-2700.1249 366.1925,-2643.71 409.5058,-2683.9471 480.9653,-2662.1249 504.4856,-2654.9423 530.3017,-2645.108 550.4202,-2636.9882"/>
<polygon fill="#ff006d" stroke="#ff006d" points="551.8675,-2640.1778 559.8039,-2633.1589 549.2227,-2633.6967 551.8675,-2640.1778"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M399.0839,-685.1249C424.8418,-657.2921 448.2112,-680.2378 480.9653,-661.1249 500.2393,-649.8781 497.8092,-637.5712 516.9653,-626.1249 652.5289,-545.1221 700.6704,-548.7197 855.7932,-519.1249 1245.7102,-444.7354 1352.9444,-422.8306 1747.415,-467.1249 1944.5711,-489.2632 2013.4169,-462.6451 2182.6875,-566.1249 2203.9531,-579.1252 2199.5001,-593.2166 2218.6875,-609.1249 2332.7848,-703.7234 2382.8114,-695.3935 2509.6157,-772.1249 2554.1823,-799.0929 2567.7358,-802.8378 2607.8035,-836.1249 2643.1551,-865.4941 2678.9656,-905.6003 2698.8486,-928.9955"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2696.3062,-931.4102 2705.4229,-936.8079 2701.6621,-926.903 2696.3062,-931.4102"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2259.1249C600.8674,-2003.2721 799.2035,-2171.7103 1102.7076,-2053.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.3619,-3754.9863C230.5934,-3623.9141 292.488,-2378.0201 399.0839,-2259.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-5326.1249C408.42,-5352.3369 477.9615,-5375.6529 529.4404,-5389.583"/>
<polygon fill="#7fff00" stroke="#7fff00" points="528.5846,-5392.9769 539.1477,-5392.1576 530.3792,-5386.2109 528.5846,-5392.9769"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.0404,-3755.0082C226.9322,-3596.0559 261.0673,-1782.5136 317.2024,-1554.1249 331.7901,-1494.7741 367.385,-1431.3304 386.4836,-1399.9964"/>
<polygon fill="#00ffff" stroke="#00ffff" points="389.5527,-1401.6881 391.8397,-1391.343 383.6006,-1398.004 389.5527,-1401.6881"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.999,-3777.1764C231.6418,-3840.9752 265.1593,-4168.6926 281.2024,-4437.1249 284.7011,-4495.6657 281.5112,-5445.591 317.2024,-5492.1249 321.1203,-5497.2331 326.0564,-5501.3284 331.5539,-5504.6074"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.0788,-5507.7828 340.5894,-5509.1163 333.2044,-5501.5194 330.0788,-5507.7828"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.4597,-3777.2772C229.5729,-3867.7231 265.9232,-4479.3353 317.2024,-4541.1249 349.7835,-4580.384 704.7473,-4671.1202 755.1332,-4679.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-4679.1249C845.7335,-4685.3145 1086.1931,-4568.9251 1159.79,-4622.1249 1201.1371,-4652.0128 1162.2768,-4692.6577 1195.79,-4731.1249 1204.6532,-4741.2982 1369.9995,-4819.2087 1441.8895,-4852.7962"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1440.443,-4855.9834 1450.9848,-4857.042 1443.404,-4849.6405 1440.443,-4855.9834"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.0048,-3777.1761C231.6798,-3840.9729 265.3465,-4168.6815 281.2024,-4437.1249 284.8076,-4498.1624 288.2322,-5483.2798 317.2024,-5537.1249 327.1613,-5555.6349 345.9215,-5569.5808 362.9744,-5579.1531"/>
<polygon fill="#ff0000" stroke="#ff0000" points="361.728,-5582.4526 372.2059,-5584.0222 364.9938,-5576.2611 361.728,-5582.4526"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.8085,-3777.3902C234.4472,-3889.5071 312.9128,-4800.842 317.2024,-4806.1249 319.8155,-4809.3431 322.8311,-4812.1568 326.1305,-4814.616"/>
<polygon fill="#00ffff" stroke="#00ffff" points="324.5066,-4817.7274 334.8489,-4820.0269 328.1979,-4811.7798 324.5066,-4817.7274"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1364.441,-2407.1304 1195.5727,-2407.1304 1195.5727,-2385.1195 1364.441,-2385.1195 1364.441,-2407.1304"/>
<text text-anchor="middle" x="1280.0068" y="-2392.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2259.1249C424.9142,-2226.3731 544.5745,-2272.2693 585.7192,-2279.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2279.1249C659.9904,-2291.5002 679.9685,-2274.6959 755.1332,-2279.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2279.1249C935.0395,-2289.7258 990.8751,-2242.3047 1159.79,-2305.1249 1201.5254,-2320.6465 1240.8766,-2355.721 1262.5841,-2377.5094"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1260.2714,-2380.1513 1269.755,-2384.8748 1265.2869,-2375.2682 1260.2714,-2380.1513"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2259.1249C429.3026,-2220.8089 488.0794,-2220.835 531.6347,-2227.4471"/>
<polygon fill="#ff0000" stroke="#ff0000" points="531.0751,-2230.902 541.5151,-2229.0971 532.2282,-2223.9976 531.0751,-2230.902"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-1899.1249C1700.4887,-1912.2908 1713.0383,-1900.7447 1747.415,-1913.1249 1774.9036,-1923.0245 1803.5756,-1940.3064 1823.0402,-1953.2529"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1821.3143,-1956.3115 1831.5541,-1959.0313 1825.2453,-1950.5195 1821.3143,-1956.3115"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1455.1249C818.5461,-1350.5873 923.1422,-1373.5516 1159.79,-1469.1249 1256.8599,-1508.3279 1281.6113,-1521.8239 1364.2236,-1586.1249 1516.8129,-1704.8923 1486.0318,-1829.4499 1666.4052,-1899.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-2473.1249C1334.728,-2494.7421 1398.0889,-2519.7902 1437.3129,-2535.2985"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1436.1587,-2538.6057 1446.7452,-2539.0279 1438.7326,-2532.0961 1436.1587,-2538.6057"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2279.1249C943.6996,-2298.8182 984.3717,-2342.1978 1159.79,-2414.1249 1214.8581,-2436.7046 1224.6521,-2451.2575 1280.0068,-2473.1249"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-2731.1304 334.8633,-2731.1304 334.8633,-2709.1195 463.3044,-2709.1195 463.3044,-2731.1304"/>
<text text-anchor="middle" x="399.0839" y="-2716.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.2045,-3755.0625C232.9578,-3692.5796 272.7108,-3377.5552 317.2024,-3122.1249 342.6926,-2975.7831 380.9953,-2801.0753 394.3162,-2741.348"/>
<polygon fill="#ff0000" stroke="#ff0000" points="397.8029,-2741.794 396.5704,-2731.2711 390.9717,-2740.2658 397.8029,-2741.794"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-2653.1304 354.6193,-2653.1304 354.6193,-2631.1195 443.5485,-2631.1195 443.5485,-2653.1304"/>
<text text-anchor="middle" x="399.0839" y="-2638.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.0429,-3754.8299C226.1201,-3644.2135 244.9945,-2756.4898 317.2024,-2667.1249 324.2114,-2658.4506 334.1456,-2652.7134 344.6883,-2648.9368"/>
<polygon fill="#00ff00" stroke="#00ff00" points="345.9078,-2652.225 354.475,-2645.9917 343.8906,-2645.5219 345.9078,-2652.225"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-2367.1304 690.3127,-2367.1304 690.3127,-2345.1195 819.9536,-2345.1195 819.9536,-2367.1304"/>
<text text-anchor="middle" x="755.1332" y="-2352.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-2279.1249C640.2487,-2288.2108 697.5699,-2319.5507 729.5896,-2339.3366"/>
<polygon fill="#0000ff" stroke="#0000ff" points="727.9782,-2342.458 738.3051,-2344.8256 731.7087,-2336.5348 727.9782,-2342.458"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3136.1249C449.8924,-3073.4738 447.0692,-3038.3891 516.9653,-2998.1249 919.4352,-2766.2793 1086.4969,-2797.9213 1549.3953,-2836.1249 1711.4994,-2849.5036 1773.3837,-2808.4983 1910.4177,-2896.1249 2091.5964,-3011.9799 2085.7407,-3104.163 2182.6875,-3296.1249 2242.1455,-3413.8562 2160.5098,-3629.7561 2281.0071,-3576.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.7446,-3755.0329C231.3157,-3675.6258 272.7421,-3195.4346 317.2024,-3150.1249 343.0605,-3123.7728 376.5132,-3165.3421 399.0839,-3136.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-3576.1249C2357.3421,-3525.23 2423.1449,-3228.2804 2440.1886,-3145.5267"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2443.6609,-3146.0148 2442.2261,-3135.5176 2436.8016,-3144.6185 2443.6609,-3146.0148"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-4299.1249C743.3918,-4312.2464 1830.8454,-4069.9298 1984.2305,-4031.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-4299.1249C634.0627,-4302.0006 643.4424,-4280.6778 690.4731,-4269.1249 763.3208,-4251.2302 782.2783,-4250.0436 855.7932,-4235.1249 1246.6865,-4155.7994 1359.2505,-4041.3733 1747.415,-4133.1249 1954.6585,-4182.1117 2179.2662,-4313.8117 2254.6684,-4360.463"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2253.1724,-4363.6545 2263.5114,-4365.9689 2256.8723,-4357.7122 2253.1724,-4363.6545"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-4223.1249C428.9582,-4246.4844 445.6494,-4233.3075 480.9653,-4247.1249 529.3703,-4266.0635 534.0237,-4293.7139 585.7192,-4299.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-5326.1249C413.7225,-5360.0187 455.3108,-5313.5745 480.9653,-5340.1249 563.5573,-5425.6011 458.0811,-5501.8764 516.9653,-5605.1249 640.4516,-5821.6476 764.1375,-5916.3302 1009.6252,-5873.1249 1353.2143,-5812.654 1451.2404,-5789.4908 1747.415,-5605.1249 1775.8776,-5587.4073 2159.0611,-5210.912 2182.6875,-5187.1249 2199.0821,-5170.6188 2201.6513,-5164.968 2218.6875,-5149.1249 2231.2095,-5137.4799 2245.992,-5125.3203 2258.0165,-5115.7962"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2260.5014,-5118.2955 2266.2129,-5109.372 2256.1833,-5112.7861 2260.5014,-5118.2955"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-761.1249C742.8039,-776.8876 775.2237,-696.1868 932.7092,-685.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M932.7092,-685.1249C1243.2252,-621.4932 1777.1741,-932.7031 1946.4177,-970.1249 2000.7685,-982.1426 2406.8383,-983.1102 2444.4712,-1024.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-685.1249C429.5003,-652.2584 541.5816,-753.5593 585.7192,-761.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1455.1249C874.9216,-1332.1612 1712.0348,-1706.399 1910.4177,-1950.1249 2003.9239,-2065.0032 1988.8188,-2469.1731 2058.0432,-2600.1249 2077.0495,-2636.079 2088.5343,-2641.8124 2120.3654,-2667.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.1655,-3755.0233C229.3662,-3577.7163 295.5419,-1335.7186 317.2024,-1311.1249 382.6085,-1236.8617 1097.1657,-1173.2636 1195.79,-1165.1249 1270.3958,-1158.9683 1289.6683,-1158.3844 1364.2236,-1165.1249 1581.404,-1184.7602 1647.8035,-1164.2041 1846.9164,-1253.1249"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M267.6098,-3766.1249C285.909,-3766.1249 307.6464,-3766.1249 328.1233,-3766.1249"/>
<polygon fill="#0000ff" stroke="#0000ff" points="328.3714,-3769.625 338.3714,-3766.1249 328.3714,-3762.625 328.3714,-3769.625"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1568.1249C506.7278,-1434.855 998.6445,-1634.9853 1159.79,-1693.1249 1250.6839,-1725.9185 1291.0025,-1704.0712 1364.2236,-1767.1249 1495.2018,-1879.9157 1483.7739,-1949.216 1549.3953,-2109.1249 1579.321,-2182.0492 1642.2588,-2419.6333 1661.0179,-2491.4057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.6367,-2492.3104 1663.5472,-2501.1034 1664.4102,-2490.5438 1657.6367,-2492.3104"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.1617,-3754.8663C229.3683,-3572.679 296.4187,-1240.1541 317.2024,-1213.1249 321.4026,-1207.6625 326.7668,-1203.3587 332.7357,-1199.9729"/>
<polygon fill="#00ffff" stroke="#00ffff" points="334.3194,-1203.0954 341.8483,-1195.6412 331.3141,-1196.7733 334.3194,-1203.0954"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1666.4052,-1063.1249C1700.8121,-1077.55 1714.3219,-1067.8981 1747.415,-1085.1249 1765.8892,-1094.7418 1766.7971,-1102.5702 1783.415,-1115.1249 1885.8946,-1192.5473 1925.3192,-1193.622 2022.0432,-1278.1249 2054.5477,-1306.5225 2087.0777,-1345.0531 2105.3728,-1367.8802"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2102.7021,-1370.1453 2111.6579,-1375.8061 2108.1869,-1365.7959 2102.7021,-1370.1453"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-761.1249C842.3191,-782.4791 912.8474,-766.1946 1159.79,-839.1249 1360.2335,-898.3225 1390.0614,-964.7837 1585.3953,-1039.1249 1620.4907,-1052.4817 1631.1721,-1050.1355 1666.4052,-1063.1249"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1670.405,-4481.367C1700.8579,-4567.2196 1898.2464,-5128.354 2022.0432,-5595.1249 2041.5076,-5668.5148 2006.6449,-5706.2397 2058.0432,-5762.1249 2077.6457,-5783.4386 2104.7176,-5756.7595 2120.3654,-5781.1249"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M1683.2007,-4458.9035C1700.2968,-4447.0737 1727.1008,-4427.377 1747.415,-4407.1249 1765.8003,-4388.7958 1762.6058,-4376.6475 1783.415,-4361.1249 1788.4633,-4357.3592 1794.1529,-4354.0795 1799.9999,-4351.2462"/>
<polygon fill="#ff3600" stroke="#ff3600" points="1801.5185,-4354.4017 1809.2481,-4347.1558 1798.687,-4347.9999 1801.5185,-4354.4017"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1667.933,-4481.4031C1676.1984,-4542.4756 1716.3392,-4839.8091 1747.415,-5083.1249 1755.698,-5147.9783 1743.3705,-5323.4432 1783.415,-5375.1249 1785.9152,-5378.3517 1788.8927,-5381.1628 1792.1735,-5383.6116"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1790.5095,-5386.6977 1800.855,-5388.9828 1794.1926,-5380.745 1790.5095,-5386.6977"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1984.2305,-4451.1249C2005.6382,-4449.7408 2007.8788,-4465.0135 2022.0432,-4481.1249 2225.2058,-4712.2127 2142.1667,-4878.0847 2379.3267,-5074.1249 2403.1089,-5093.7837 2417.6598,-5113.3962 2444.4712,-5098.1249"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1677.4917,-4458.8712C1696.1355,-4439.0816 1733.1272,-4395.8858 1747.415,-4351.1249 1807.4339,-4163.0979 1771.1024,-2772.1144 1783.415,-2575.1249 1797.7636,-2345.5622 1833.6579,-2068.7228 1844.0535,-1991.1943"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1847.5291,-1991.6092 1845.3967,-1981.2312 1840.5919,-1990.6739 1847.5291,-1991.6092"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1698.6895,-4459.1172C1747.2516,-4441.6898 1840.8148,-4404.6821 1910.4177,-4356.1249 2050.187,-4258.6176 2093.4081,-4231.288 2182.6875,-4086.1249 2388.5045,-3751.4784 2435.1464,-3253.9977 2443.0763,-3145.5081"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2446.5891,-3145.4446 2443.7947,-3135.2249 2439.6062,-3144.9566 2446.5891,-3145.4446"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1984.2305,-4451.1249C2044.6438,-4447.8067 2062.7051,-4469.4573 2120.3654,-4451.1249"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1701.7736,-4481.2729C1752.156,-4498.4224 1845.6492,-4535.0614 1910.4177,-4589.1249 1974.7627,-4642.8349 1983.0912,-4666.9105 2022.0432,-4741.1249 2044.7749,-4784.435 2032.0357,-4803.6991 2058.0432,-4845.1249 2078.8175,-4878.2151 2097.0856,-4875.7469 2120.3654,-4907.1249"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2120.3654,-4907.1249C2144.3742,-4937.9487 2156.9361,-4939.7414 2182.6875,-4969.1249 2215.2276,-5006.2547 2249.3131,-5053.034 2267.5641,-5078.8294"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2264.715,-5080.8624 2273.3309,-5087.0283 2270.4406,-5076.8353 2264.715,-5080.8624"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1725.8507,-4466.3989C1789.6956,-4462.4375 1894.1274,-4456.074 1984.2305,-4451.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1984.2305,-4451.1249C2110.5467,-4440.955 2274.039,-4114.2307 2343.3267,-4008.1249 2361.5956,-3980.1483 2360.783,-3969.9202 2379.3267,-3942.1249 2430.6049,-3865.2635 2477.3977,-3866.7225 2509.6157,-3780.1249 2544.3573,-3686.7443 2572.8395,-2090.6773 2576.3465,-1886.5489"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2579.8509,-1886.3141 2576.5224,-1876.2558 2572.8519,-1886.1945 2579.8509,-1886.3141"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.068,-3716.9606C1512.2235,-3661.1456 1652.8553,-3406.3895 1747.415,-3188.1249 1888.8615,-2861.6356 1902.4521,-2771.2374 2022.0432,-2436.1249 2081.446,-2269.6692 2444.2502,-1078.9049 2545.6157,-934.1249 2573.4304,-894.3973 2669.8135,-777.7146 2714.6799,-796.1249"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1475.5061,-3739.14C1480.5992,-3817.1588 1513.9224,-4286.6999 1585.3953,-4407.1249 1597.1654,-4426.9565 1617.7431,-4442.8395 1635.2129,-4453.697"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1633.6159,-4456.8191 1644.0021,-4458.911 1637.1873,-4450.7987 1633.6159,-4456.8191"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1485.3341,-3739.3345C1503.8251,-3758.3989 1544.1143,-3797.1971 1585.3953,-3819.1249 1618.5582,-3836.7406 1632.2645,-3827.4882 1666.4052,-3843.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1666.4052,-3843.1249C1825.2543,-3915.8791 2270.8918,-3936.2147 2444.4712,-3956.1249"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1984.2305,-4031.1249C2010.3567,-4020.336 2041.0297,-4013.3519 2066.6398,-4008.9481"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2067.2443,-4012.3958 2076.5485,-4007.3279 2066.1147,-4005.4876 2067.2443,-4012.3958"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1666.4052,-3843.1249C1703.0816,-3861.5168 1946.3073,-4046.7855 1984.2305,-4031.1249"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1666.4052,-3919.1249C1708.8133,-3964.4601 1857.5955,-4022.5128 1910.4177,-4055.1249 1961.4871,-4086.6549 1975.3271,-4093.4444 2022.0432,-4131.1249 2118.8533,-4209.2105 2222.9304,-4315.9461 2263.4599,-4358.5045"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2261.0632,-4361.0635 2270.4853,-4365.9085 2266.1411,-4356.2452 2261.0632,-4361.0635"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1482.9967,-3739.1586C1500.4503,-3762.3255 1543.1804,-3817.1881 1585.3953,-3857.1249 1618.3311,-3888.2835 1635.2725,-3886.1646 1666.4052,-3919.1249"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1666.4052,-3919.1249C1691.4946,-3945.6872 1722.0427,-3906.8328 1747.415,-3933.1249 1829.6464,-4018.3371 1729.076,-4091.909 1783.415,-4197.1249 1818.9096,-4265.8525 1855.9341,-4261.217 1910.4177,-4316.1249 1961.9532,-4368.0617 1980.8578,-4376.651 2022.0432,-4437.1249 2045.1111,-4470.9962 2167.8482,-4730.9256 2182.6875,-4769.1249 2226.7222,-4882.4791 2263.0079,-5024.0819 2275.9342,-5076.9401"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2272.5743,-5077.9368 2278.3323,-5086.8304 2279.3772,-5076.2872 2272.5743,-5077.9368"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1478.6598,-3716.8682C1518.5028,-3600.4963 1856.7203,-2615.3009 1984.2305,-2332.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-303.1249C1967.71,-316.5094 2015.7711,-241.2357 2120.3654,-303.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.7415,-2610.8696C599.7981,-2569.1582 638.2455,-2419.2929 654.4731,-2293.1249 695.4593,-1974.4624 640.6168,-1888.5206 690.4731,-1571.1249 734.5271,-1290.6686 744.6371,-1215.3543 855.7932,-954.1249 907.6169,-832.3334 953.6611,-819.0703 1009.6252,-699.1249 1030.4844,-654.4184 1016.7183,-634.102 1045.6252,-594.1249 1161.5357,-433.8258 1219.2222,-404.9344 1400.2236,-325.1249 1542.0902,-262.5713 1592.6487,-281.8261 1747.415,-291.1249 1791.8781,-293.7964 1802.4428,-300.634 1846.9164,-303.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ff3600" stroke-dasharray="5,2" d="M932.7092,-3501.1249C1074.3746,-3518.1527 1080.6275,-3600.8835 1195.79,-3685.1249 1266.7993,-3737.0682 1310.5808,-3719.3906 1364.2236,-3789.1249 1397.9143,-3832.9219 1370.5706,-3861.4995 1400.2236,-3908.1249 1485.5469,-4042.2841 1544.5724,-4044.9706 1666.4052,-4147.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#b6ff00" stroke-dasharray="5,2" d="M588.8379,-2610.8814C600.2306,-2569.2114 639.7026,-2419.4718 654.4731,-2293.1249 723.96,-1698.7367 640.1088,-1543.438 690.4731,-947.1249 704.6013,-779.8476 739.4617,-580.0732 751.2017,-515.4249"/>
<polygon fill="#b6ff00" stroke="#b6ff00" points="754.7013,-515.7443 753.0568,-505.2779 747.8154,-514.4853 754.7013,-515.7443"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M586.9364,-2633.1747C594.576,-2703.0012 636.1781,-3090.2617 654.4731,-3407.1249 662.7128,-3549.8321 656.6156,-4554.2476 690.4731,-4693.1249 695.4716,-4713.6278 843.792,-5017.7662 855.7932,-5035.1249 912.2578,-5116.7961 951.1739,-5116.8637 1009.6252,-5197.1249 1029.2955,-5224.1347 1026.1638,-5235.9644 1045.6252,-5263.1249 1067.4413,-5293.5716 1078.1782,-5296.8186 1102.7076,-5325.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1474.8094,-5593.1249C1559.0424,-5580.6055 1594.0818,-5636.0835 1666.4052,-5591.1249"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M586.9485,-2633.174C594.6623,-2702.9962 636.6383,-3090.2355 654.4731,-3407.1249 663.4355,-3566.3675 634.2572,-4692.8658 690.4731,-4842.1249 722.0951,-4926.0843 778.3772,-4917.5395 819.7932,-4997.1249 848.0627,-5051.4477 826.3879,-5076.4085 855.7932,-5130.1249 962.7175,-5325.4497 1008.4474,-5377.7618 1195.79,-5498.1249 1306.0031,-5568.9341 1345.2334,-5612.3836 1474.8094,-5593.1249"/>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1666.4052,-5591.1249C1704.9107,-5567.1886 1717.9149,-5563.5541 1747.415,-5529.1249 1769.1556,-5503.7518 1763.3443,-5489.8384 1783.415,-5463.1249 1795.9296,-5446.4684 1812.7669,-5429.9681 1825.9594,-5418.0345"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1828.4698,-5420.4864 1833.6313,-5411.2338 1823.8264,-5415.2481 1828.4698,-5420.4864"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M592.53,-2610.7961C606.0756,-2587.8361 636.6256,-2533.8524 654.4731,-2485.1249 677.9043,-2421.1533 644.3633,-2386.2773 690.4731,-2336.1249 731.4676,-2291.5364 769.2128,-2326.4462 819.7932,-2293.1249 945.937,-2210.0242 945.1556,-2151.925 1045.6252,-2039.1249 1205.9125,-1859.1659 1400.2069,-1641.6326 1457.8928,-1577.0597"/>
<polygon fill="#00ff5b" stroke="#00ff5b" points="1460.769,-1579.0937 1464.8212,-1569.3044 1455.5487,-1574.4301 1460.769,-1579.0937"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M586.673,-2633.2946C596.517,-2748.4539 679.4702,-3715.8491 690.4731,-3743.1249 724.9384,-3828.5626 785.2943,-3819.7009 819.7932,-3905.1249 883.6516,-4063.2471 797.1839,-4126.983 855.7932,-4287.1249 908.9533,-4432.3775 1036.4758,-4573.7677 1084.2337,-4623.4306"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1081.9652,-4626.1187 1091.4415,-4630.8568 1086.9883,-4621.2433 1081.9652,-4626.1187"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M755.1332,-3079.1249C792.473,-3121.9328 956.8209,-3082.185 1009.6252,-3103.1249 1028.4676,-3110.597 1026.4526,-3124.5466 1045.6252,-3131.1249 1093.6188,-3147.5919 1118.3691,-3160.4309 1159.79,-3131.1249 1199.0348,-3103.3587 1156.5453,-3056.8912 1195.79,-3029.1249 1256.9007,-2985.8882 1296.4492,-2997.3357 1364.2236,-3029.1249 1414.2694,-3052.5986 1449.5211,-3111.0809 1465.3786,-3142.0887"/>
<polygon fill="#005bff" stroke="#005bff" points="1462.2702,-3143.6988 1469.8399,-3151.1116 1468.5451,-3140.5962 1462.2702,-3143.6988"/>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M635.3268,-2633.2857C642.5215,-2636.729 649.2483,-2641.2333 654.4731,-2647.1249 785.2773,-2794.6232 628.7489,-2927.8223 755.1332,-3079.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M755.1332,-3516.1249C854.3525,-3619.9096 908.0768,-3613.618 1009.6252,-3715.1249 1027.9862,-3733.4784 1027.0996,-3742.9377 1045.6252,-3761.1249 1055.2399,-3770.5639 1066.9691,-3779.7325 1077.2887,-3787.1615"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1075.3529,-3790.0789 1085.5484,-3792.9605 1079.3752,-3784.3499 1075.3529,-3790.0789"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M635.5719,-2632.1915C642.9241,-2635.7605 649.6385,-2640.5903 654.4731,-2647.1249 700.3318,-2709.1087 671.1213,-3265.4891 690.4731,-3340.1249 701.4908,-3382.6175 726.898,-3427.606 742.3812,-3452.5491"/>
<polygon fill="#1200ff" stroke="#1200ff" points="739.4744,-3454.5009 747.7788,-3461.0803 745.3899,-3450.7583 739.4744,-3454.5009"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M635.4144,-2623.7898C669.193,-2624.5847 714.8816,-2625.0032 755.1332,-2623.1249"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M932.7092,-2471.1249C971.7362,-2435.3302 986.6122,-2427.8194 1009.6252,-2380.1249 1045.0791,-2306.6469 996.6467,-2265.3714 1045.6252,-2200.1249 1141.4802,-2072.4325 1254.8819,-2150.4775 1364.2236,-2034.1249 1391.2021,-2005.4167 1372.5349,-1981.1488 1400.2236,-1953.1249 1553.7512,-1797.7392 1631.0692,-1714.5774 1846.9164,-1748.1249"/>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M755.1332,-2623.1249C827.4273,-2619.7514 796.2018,-2536.1941 855.7932,-2495.1249 885.2793,-2474.8037 905.4177,-2494.3102 932.7092,-2471.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M611.3033,-2633.1387C626.7139,-2641.2416 645.1128,-2653.8576 654.4731,-2671.1249 699.9987,-2755.1074 661.2652,-3439.1714 690.4731,-3530.1249 705.0293,-3575.4529 1138.808,-4204.3902 1159.79,-4247.1249 1181.3474,-4291.0314 1161.2816,-4316.4599 1195.79,-4351.1249 1288.5182,-4444.2738 1344.0062,-4436.2507 1474.8094,-4449.1249"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1474.8094,-4449.1249C1515.3789,-4452.1255 1560.6245,-4457.012 1596.9559,-4461.3166"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1596.6105,-4464.8002 1606.9556,-4462.5132 1597.4423,-4457.8497 1596.6105,-4464.8002"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M932.7092,-3501.1249C1037.0877,-3508.215 1065.4054,-3517.9956 1159.79,-3563.1249 1177.5959,-3571.6387 1178.9009,-3578.9128 1195.79,-3589.1249 1280.1517,-3640.1346 1385.7315,-3688.9306 1439.6179,-3712.8354"/>
<polygon fill="#ff00a3" stroke="#ff00a3" points="1438.4996,-3716.1675 1449.0614,-3717.0042 1441.3266,-3709.7637 1438.4996,-3716.1675"/>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M635.2785,-2631.987C642.76,-2635.5759 649.594,-2640.4654 654.4731,-2647.1249 710.0128,-2722.9304 635.1862,-3416.135 690.4731,-3492.1249 708.5073,-3516.9122 735.2144,-3492.8251 755.1332,-3516.1249"/>
<path fill="none" stroke="#ff00a3" stroke-dasharray="5,2" d="M755.1332,-3516.1249C806.6001,-3576.3278 854.0715,-3491.6729 932.7092,-3501.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1984.2305,-569.1249C2077.5095,-556.4561 2108.6411,-584.9992 2182.6875,-643.1249 2205.0863,-660.7078 2197.0559,-677.6063 2218.6875,-696.1249 2278.6865,-747.4896 2306.5007,-741.5538 2379.3267,-772.1249 2436.2275,-796.0109 2454.1968,-792.9775 2509.6157,-820.1249 2578.7009,-853.9668 2653.9888,-904.971 2691.1764,-931.209"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2689.1824,-934.0858 2699.3628,-937.0203 2693.2344,-928.3778 2689.1824,-934.0858"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M588.2515,-2611.0908C597.7357,-2569.5541 631.771,-2418.5865 654.4731,-2293.1249 673.2872,-2189.1505 665.6164,-2160.8225 690.4731,-2058.1249 732.0935,-1886.167 1054.0908,-654.0642 1195.79,-548.1249 1363.4191,-422.7996 1457.1093,-530.0326 1666.4052,-531.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M1666.4052,-531.1249C1808.6548,-529.2691 1841.9688,-568.9666 1984.2305,-569.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.3642,-2611.0394C676.7827,-2564.5572 956.6963,-2383.6845 1009.6252,-2295.1249 1060.0045,-2210.8315 984.7804,-2154.2052 1045.6252,-2077.1249 1062.6772,-2055.523 1076.373,-2061.1185 1102.7076,-2053.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-2167.1249C1319.0964,-2143.4482 1333.6538,-2142.0966 1364.2236,-2108.1249 1386.3135,-2083.5769 1376.7571,-2066.3604 1400.2236,-2043.1249 1412.171,-2031.2952 1650.5852,-1893.4321 1666.4052,-1899.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-2471.1249C970.5635,-2434.0923 984.0015,-2426.4691 1009.6252,-2380.1249 1035.1296,-2333.9968 1011.454,-2307.2572 1045.6252,-2267.1249 1094.1183,-2210.1725 1126.1347,-2218.3881 1195.79,-2191.1249 1232.0327,-2176.9395 1246.0374,-2186.1206 1280.0068,-2167.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-2661.1249C1129.8239,-2656.4216 1135.7946,-2650.602 1159.79,-2637.1249 1176.9981,-2627.4599 1178.0317,-2619.7372 1195.79,-2611.1249 1230.809,-2594.1417 1244.8763,-2603.8763 1280.0068,-2587.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1280.0068,-2587.1249C1321.0257,-2567.5658 1371.5399,-2558.3399 1410.8497,-2553.9913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1411.2576,-2557.4679 1420.8469,-2552.9629 1410.5413,-2550.5046 1411.2576,-2557.4679"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M591.9383,-2610.9954C604.668,-2587.9592 634.2004,-2533.1833 654.4731,-2485.1249 673.4842,-2440.0575 656.509,-2416.3234 690.4731,-2381.1249 693.8474,-2377.6281 697.7656,-2374.6124 701.9723,-2372.0131"/>
<polygon fill="#0000ff" stroke="#0000ff" points="703.7498,-2375.0319 710.9305,-2367.2416 700.459,-2368.8536 703.7498,-2375.0319"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2623.1249C802.7457,-2620.9032 809.2319,-2649.9303 855.7932,-2660.1249 938.4675,-2678.2265 961.0582,-2671.789 1045.6252,-2675.1249 1322.1359,-2686.0325 1389.6794,-2627.1249 1666.4052,-2627.1249 1666.4052,-2627.1249 1666.4052,-2627.1249 1846.9164,-2627.1249 1931.3685,-2627.1249 2117.3143,-2751.66 2182.6875,-2805.1249 2297.7844,-2899.256 2398.3163,-3050.4206 2432.2534,-3104.2785"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2429.3685,-3106.2666 2437.6348,-3112.8938 2435.3055,-3102.5582 2429.3685,-3106.2666"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.1332,-3079.1249C885.5595,-3235.2666 980.2737,-3197.3903 1159.79,-3293.1249 1421.4425,-3432.6622 1486.3633,-3468.4669 1747.415,-3609.1249 1819.8926,-3648.1768 1838.9134,-3656.3184 1910.4177,-3697.1249 2033.1097,-3767.1435 2107.8362,-3741.3201 2182.6875,-3861.1249 2230.7978,-3938.1288 2191.5254,-4181.4853 2218.6875,-4268.1249 2229.3097,-4302.007 2251.6463,-4336.9029 2266.4886,-4357.804"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2263.8155,-4360.0795 2272.5232,-4366.115 2269.4798,-4355.9666 2263.8155,-4360.0795"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M586.768,-2633.1862C593.3782,-2703.0824 629.7898,-3090.6952 654.4731,-3407.1249 672.6965,-3640.7399 662.0498,-3700.5305 690.4731,-3933.1249 730.5469,-4261.0568 771.2911,-4338.3333 819.7932,-4665.1249 829.6184,-4731.3241 816.4135,-4910.013 855.7932,-4964.1249 900.1017,-5025.0096 946.0883,-4994.7116 1009.6252,-5035.1249 1100.9516,-5093.2139 1100.4463,-5140.8961 1195.79,-5192.1249 1279.2036,-5236.9436 1306.8923,-5236.1314 1400.2236,-5252.1249 1623.7188,-5290.4237 1692.7574,-5315.6929 1910.4177,-5252.1249 1946.4397,-5241.6047 1949.8097,-5226.0739 1984.2305,-5211.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M587.6746,-2610.8537C595.7911,-2565.6499 629.298,-2393.7436 690.4731,-2265.1249 797.9805,-2039.0942 889.8543,-2020.9035 1009.6252,-1801.1249 1112.4099,-1612.5162 1029.5118,-1491.101 1195.79,-1355.1249 1386.1039,-1199.4934 2044.5995,-1072.6565 2281.0071,-1140.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-2589.1249C2002.3774,-2597.304 2008.5325,-2598.5075 2022.0432,-2613.1249 2045.2543,-2638.2373 2028.7471,-2663.4863 2058.0432,-2681.1249 2115.2615,-2715.575 2196.4218,-2697.7807 2243.4018,-2682.4504"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2244.5394,-2685.7605 2252.8871,-2679.2362 2242.2928,-2679.1308 2244.5394,-2685.7605"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-2471.1249C1021.9118,-2395.344 1078.7741,-2461.7923 1195.79,-2459.1249 1441.3312,-2453.5279 1508.8803,-2433.6187 1747.415,-2492.1249 1857.8792,-2519.2188 1876.3203,-2553.1834 1984.2305,-2589.1249"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-2661.1249C1158.8012,-2651.3954 1145.3537,-2599.532 1195.79,-2573.1249 1278.0453,-2530.0584 1308.2514,-2542.8437 1400.2236,-2530.1249 1458.0767,-2522.1245 1523.5163,-2517.6384 1575.0333,-2515.1456"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1575.319,-2518.6361 1585.1447,-2514.6731 1574.9922,-2511.6438 1575.319,-2518.6361"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-2623.1249C910.1731,-2612.5813 948.542,-2680.6568 1102.7076,-2661.1249"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2785.5062,-948.1249C2793.9374,-948.1249 2802.6463,-948.1249 2811.3461,-948.1249"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2811.5375,-951.625 2821.5374,-948.1249 2811.5374,-944.625 2811.5375,-951.625"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#ecff00" stroke-dasharray="5,2" d="M1281.2498,-2002.6301C1289.9452,-1922.5773 1342.9957,-1440.0196 1400.2236,-1049.1249 1424.044,-886.42 1459.2201,-691.2295 1470.8891,-627.4281"/>
<polygon fill="#ecff00" stroke="#ecff00" points="1474.3683,-627.8596 1472.7292,-617.3924 1467.4831,-626.5971 1474.3683,-627.8596"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1292.574,-2025.1584C1311.3363,-2042.3846 1346.3703,-2077.6041 1364.2236,-2115.1249 1400.0269,-2190.3694 1380.3331,-2218.2054 1400.2236,-2299.1249 1421.431,-2385.4018 1453.7281,-2486.2347 1467.8223,-2529.1146"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1464.5362,-2530.3254 1470.9956,-2538.7235 1471.1831,-2528.1303 1464.5362,-2530.3254"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-1846.1304 166.6166,-1846.1304 166.6166,-1824.1195 281.0645,-1824.1195 281.0645,-1846.1304"/>
<text text-anchor="middle" x="223.8406" y="-1831.9749" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M224.028,-1846.147C226.5752,-1993.2027 255.1982,-3563.4993 317.2024,-3636.1249 446.3983,-3787.4524 593.8993,-3612.5264 755.1332,-3729.1249"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M585.7192,-3231.1249C633.8885,-3253.428 715.3293,-3398.0177 744.4136,-3451.9153"/>
<polygon fill="#1200ff" stroke="#1200ff" points="741.4062,-3453.7134 749.2151,-3460.8738 747.5759,-3450.4065 741.4062,-3453.7134"/>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M223.8748,-1846.2644C224.3434,-1967.6439 230.9229,-3042.1889 317.2024,-3150.1249 395.034,-3247.4926 472.6035,-3178.7506 585.7192,-3231.1249"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M399.0839,-1835.1249C416.2018,-1845.9517 554.1359,-2476.8581 581.1421,-2601.0384"/>
<polygon fill="#ff006d" stroke="#ff006d" points="577.734,-2601.8377 583.2778,-2610.8663 584.5744,-2600.3511 577.734,-2601.8377"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2084,-1823.7565C226.6114,-1757.4673 242.3987,-1421.6571 317.2024,-1360.1249 373.4123,-1313.8877 408.4842,-1353.497 480.9653,-1360.1249 825.9339,-1391.6702 970.5469,-1452.9776 1159.79,-1743.1249 1216.0058,-1829.3149 1257.7374,-1946.1665 1273.3218,-1993.2208"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1270.0507,-1994.4792 1276.4821,-2002.8987 1276.7049,-1992.3062 1270.0507,-1994.4792"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M232.5309,-1823.8184C260.6248,-1787.2669 349.2104,-1672.0127 384.433,-1626.1864"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="387.2287,-1628.2924 390.5477,-1618.2309 381.6786,-1624.0266 387.2287,-1628.2924"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1835.1249C495.4357,-1896.0657 548.8511,-1816.2127 654.4731,-1859.1249 673.5078,-1866.8583 674.148,-1875.6504 690.4731,-1888.1249 984.2603,-2112.6176 1110.832,-2106.8656 1364.2236,-2376.1249 1410.2151,-2424.9964 1448.157,-2495.6149 1465.1705,-2529.9112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1462.0513,-2531.5002 1469.5846,-2538.95 1468.3413,-2528.4284 1462.0513,-2531.5002"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M261.9804,-1824.0721C299.8592,-1815.4755 358.0568,-1808.9257 399.0839,-1835.1249"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M932.7092,-5478.1249C1002.4543,-5507.1793 1028.4711,-5464.0726 1102.7076,-5478.1249"/>
<path fill="none" stroke="#12ff00" stroke-dasharray="5,2" d="M632.709,-5403.531C680.5523,-5404.9639 756.4855,-5410.0663 819.7932,-5427.1249 872.9631,-5441.4519 881.8772,-5456.9494 932.7092,-5478.1249"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M594.873,-5391.8333C629.5721,-5348.4784 754.3418,-5187.4838 819.7932,-5035.1249 885.3109,-4882.6119 774.5983,-4729.6592 932.7092,-4679.1249"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M586.6325,-5392.0451C593.1305,-5312.8791 632.7295,-4824.8629 654.4731,-4427.1249 657.2804,-4375.7738 661.9615,-3544.9256 690.4731,-3502.1249 695.7635,-3494.1833 703.7332,-3488.3041 712.2882,-3483.9653"/>
<polygon fill="#1200ff" stroke="#1200ff" points="713.9494,-3487.0586 721.702,-3479.8372 711.1382,-3480.6479 713.9494,-3487.0586"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2120.3654,-5627.1249C2186.384,-5599.9408 2223.7629,-5669.7928 2281.0071,-5627.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M599.1448,-5414.2879C618.3363,-5429.778 655.2034,-5457.8321 690.4731,-5475.1249 987.8391,-5620.924 1072.9969,-5651.0702 1400.2236,-5702.1249 1465.7296,-5712.3453 1483.238,-5706.4496 1549.3953,-5702.1249 1645.8481,-5695.8199 2077.8379,-5644.6362 2120.3654,-5627.1249"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.685,-5392.0479C593.5473,-5312.9006 635.2106,-4824.9908 654.4731,-4427.1249 661.7939,-4275.9159 654.731,-3212.2313 690.4731,-3065.1249 730.3331,-2901.0705 767.1234,-2866.7923 855.7932,-2723.1249 914.691,-2627.6958 966.4635,-2626.6272 1009.6252,-2523.1249 1055.5424,-2413.0154 1003.6575,-2368.7995 1045.6252,-2257.1249 1056.2637,-2228.8164 1170.6117,-2046.8761 1195.79,-2030.1249 1197.7532,-2028.8188 1199.7959,-2027.6131 1201.9009,-2026.5004"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1203.7907,-2029.4882 1211.4747,-2022.1939 1200.9191,-2023.1043 1203.7907,-2029.4882"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-5478.1249C1024.9839,-5504.5905 1293.9069,-5563.4748 1364.2236,-5498.1249 1404.2931,-5460.8858 1384.9573,-5059.6535 1400.2236,-5007.1249 1413.4976,-4961.4519 1443.0882,-4913.776 1460.7478,-4887.835"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1463.8403,-4889.5174 1466.6618,-4879.3052 1458.0877,-4885.5289 1463.8403,-4889.5174"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M614.9041,-5414.199C664.0217,-5432.5054 766.5914,-5469.3167 855.7932,-5492.1249 1075.208,-5548.2276 1150.3668,-5600.6609 1364.2236,-5526.1249 1466.4744,-5490.4872 1668.7171,-5299.5017 1747.415,-5225.1249 1800.5834,-5174.876 2147.8332,-4795.4445 2182.6875,-4731.1249 2245.6505,-4614.934 2271.0985,-4454.9427 2278.5139,-4398.1546"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2281.9885,-4398.5749 2279.7623,-4388.2166 2275.0431,-4397.7024 2281.9885,-4398.5749"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.2448,-5392.1064C598.6871,-5347.1035 640.3055,-5173.0904 690.4731,-5035.1249 752.0237,-4865.8554 769.9166,-4823.4469 855.7932,-4665.1249 915.8453,-4554.4131 945.332,-4535.4289 1009.6252,-4427.1249 1195.2643,-4114.41 1174.4985,-3993.2576 1400.2236,-3708.1249 1602.2784,-3452.8924 1642.2852,-3336.1991 1946.4177,-3220.1249 1977.8197,-3208.1401 1988.5159,-3217.7499 2022.0432,-3220.1249 2066.0724,-3223.2438 2087.34,-3263.41 2120.3654,-3234.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-3234.1249C2202.8714,-3155.304 2263.72,-2782.9666 2277.8724,-2689.4659"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2281.3475,-2689.8919 2279.3651,-2679.4842 2274.4245,-2688.8565 2281.3475,-2689.8919"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M445.366,-1384.1187C498.51,-1390.2568 587.031,-1405.3229 654.4731,-1441.1249 943.1859,-1594.3898 1201.4662,-1912.5958 1265.0716,-1994.5408"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1262.6701,-1997.1583 1271.5487,-2002.9395 1268.2132,-1992.8834 1262.6701,-1997.1583"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#00ff5b" stroke-dasharray="5,2" d="M439.9261,-1596.0602C453.1737,-1592.0998 467.8348,-1587.3182 480.9653,-1582.1249 577.4518,-1543.9636 594.7608,-1519.1883 690.4731,-1479.1249 844.6971,-1414.5697 880.7882,-1383.0738 1045.6252,-1355.1249 1095.6512,-1346.6428 1109.1354,-1352.1853 1159.79,-1355.1249 1213.4905,-1358.2413 1231.7148,-1345.4327 1280.0068,-1369.1249"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M404.8742,-1618.3279C420.6314,-1649.4655 464.2204,-1740.0956 480.9653,-1821.1249 557.8465,-2193.1568 473.7857,-2297.6942 516.9653,-2675.1249 554.5904,-3004.0035 597.4177,-3081.0552 654.4731,-3407.1249 680.317,-3554.8218 636.2011,-3637.8155 755.1332,-3729.1249"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M755.1332,-3729.1249C778.9595,-3746.3553 794.1719,-3728.6984 819.7932,-3743.1249 840.065,-3754.5394 836.0507,-3768.8177 855.7932,-3781.1249 886.1824,-3800.0691 897.0867,-3801.462 932.7092,-3805.1249"/>
<path fill="none" stroke="#0024ff" stroke-dasharray="5,2" d="M932.7092,-3805.1249C966.3406,-3808.5831 1003.912,-3808.7462 1035.1637,-3807.8707"/>
<polygon fill="#0024ff" stroke="#0024ff" points="1035.623,-3811.3578 1045.505,-3807.5373 1035.3974,-3804.3615 1035.623,-3811.3578"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M404.7292,-1618.3591C420.1159,-1649.5766 462.8457,-1740.3919 480.9653,-1821.1249 527.0383,-2026.4052 487.3846,-2084.8278 516.9653,-2293.1249 533.6631,-2410.7051 567.2666,-2549.2729 580.3415,-2601.1413"/>
<polygon fill="#ff006d" stroke="#ff006d" points="576.9542,-2602.0229 582.8065,-2610.8548 583.7392,-2600.3011 576.9542,-2602.0229"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1102.7076,-2053.1249C1135.1943,-2042.2165 1172.0694,-2033.5389 1203.7444,-2027.1649"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1204.6991,-2030.5441 1213.8336,-2025.1765 1203.3455,-2023.6763 1204.6991,-2030.5441"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.1458,-1613.877C470.1786,-1616.2181 475.9131,-1619.2402 480.9653,-1623.1249 509.9595,-1645.4189 492.3381,-1670.0846 516.9653,-1697.1249 568.2477,-1753.4321 1030.509,-2077.3679 1102.7076,-2053.1249"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M462.4358,-1618.1577C468.7396,-1619.6571 475.0067,-1621.3122 480.9653,-1623.1249 531.8842,-1638.615 1330.7692,-1952.7308 1364.2236,-1994.1249 1418.522,-2061.3098 1383.5758,-2100.3607 1400.2236,-2185.1249 1425.9367,-2316.0459 1458.641,-2472.9783 1470.373,-2528.99"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1467.0125,-2530.0189 1472.49,-2539.088 1473.8636,-2528.5826 1467.0125,-2530.0189"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M464.0965,-1605.1703C641.0088,-1603.7507 1133.2588,-1626.5366 1364.2236,-1909.1249 1421.3799,-1979.0563 1346.3703,-2036.6194 1400.2236,-2109.1249 1444.5902,-2168.858 1500.2422,-2129.2644 1549.3953,-2185.1249 1631.7487,-2278.7163 1657.4018,-2434.4278 1664.2237,-2490.87"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1660.7756,-2491.5262 1665.378,-2501.0692 1667.7312,-2490.739 1660.7756,-2491.5262"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M233.4961,-5548.2396C249.1894,-5565.5274 282.0342,-5598.587 317.2024,-5615.1249 453.6644,-5679.2965 518.5589,-5717.4487 654.4731,-5652.1249 677.5578,-5641.0299 668.7002,-5620.6134 690.4731,-5607.1249 715.4689,-5591.6398 735.3024,-5614.8348 755.1332,-5593.1249"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M259.8575,-5548.1784C312.7111,-5562.1111 412.4244,-5579.4855 480.9653,-5537.1249 511.3991,-5518.3158 495.3042,-5493.5994 516.9653,-5465.1249 529.8996,-5448.1222 547.9366,-5432.062 562.2911,-5420.5489"/>
<polygon fill="#7fff00" stroke="#7fff00" points="564.5306,-5423.2408 570.2509,-5414.3229 560.2179,-5417.7271 564.5306,-5423.2408"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-5530.8517C295.254,-5528.9747 313.4912,-5526.8934 330.689,-5524.9306"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.1347,-5528.4026 340.6733,-5523.7912 330.3409,-5521.4477 331.1347,-5528.4026"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M457.4624,-5526.7933C513.0303,-5532.7412 596.541,-5532.8643 654.4731,-5493.1249 790.4033,-5399.8817 770.0772,-5318.2861 819.7932,-5161.1249 851.9268,-5059.5447 783.9784,-5002.8252 855.7932,-4924.1249 879.5283,-4898.1142 917.9537,-4937.0966 932.7092,-4905.1249"/>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M932.7092,-4905.1249C982.9585,-4799.3777 961.5978,-4748.6532 1045.6252,-4667.1249 1049.1752,-4663.6806 1053.2777,-4660.6691 1057.6223,-4658.0458"/>
<polygon fill="#00c8ff" stroke="#00c8ff" points="1059.5839,-4660.9674 1066.7806,-4653.1918 1056.3058,-4654.7824 1059.5839,-4660.9674"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M417.3191,-5505.9866C450.4362,-5485.7581 520.5889,-5442.9076 559.0747,-5419.3999"/>
<polygon fill="#7fff00" stroke="#7fff00" points="560.9753,-5422.3403 567.6848,-5414.1407 557.3264,-5416.3665 560.9753,-5422.3403"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ff24" stroke-dasharray="5,2" d="M1490.4384,-4879.2989C1538.1151,-4914.3321 1682.3984,-5027.5535 1747.415,-5159.1249 1790.5313,-5246.3774 1722.1847,-5299.4755 1783.415,-5375.1249 1786.0985,-5378.4403 1789.283,-5381.3177 1792.7746,-5383.8146"/>
<polygon fill="#00ff24" stroke="#00ff24" points="1791.011,-5386.838 1801.3876,-5388.9774 1794.6099,-5380.834 1791.011,-5386.838"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1492.8772,-4856.9825C1509.6746,-4845.7758 1534.3095,-4827.0474 1549.3953,-4805.1249 1550.5787,-4803.4052 1633.7283,-4564.1892 1659.1215,-4491.095"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1662.5814,-4491.8009 1662.5567,-4481.2061 1655.969,-4489.5039 1662.5814,-4491.8009"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1521.99,-4857.0371C1641.3813,-4827.3405 1961.6898,-4737.3352 2182.6875,-4579.1249 2270.4147,-4516.3218 2302.3633,-4496.9362 2343.3267,-4397.1249 2397.8316,-4264.3181 2367.9174,-3895.2272 2379.3267,-3752.1249 2398.3411,-3513.6346 2432.2874,-3225.3079 2441.8817,-3145.4909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2445.3931,-3145.6055 2443.1158,-3135.2583 2438.4435,-3144.7672 2445.3931,-3145.6055"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1549.441,-4861.6007C1604.7247,-4855.7037 1681.5641,-4845.2609 1747.415,-4828.1249 1822.4261,-4808.6053 1839.3908,-4797.1548 1910.4177,-4766.1249 2222.6444,-4629.7211 2394.9697,-4553.2318 2444.4712,-4216.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2444.4712,-4216.1249C2470.9052,-4064.1098 2492.5138,-4028.4706 2509.6157,-3875.1249 2555.7417,-3461.5336 2574.1411,-2075.3557 2576.4554,-1886.5016"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2579.9557,-1886.4868 2576.5772,-1876.4451 2572.9562,-1886.402 2579.9557,-1886.4868"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M755.1332,-5593.1249C842.5262,-5508.4797 799.9564,-5447.1618 819.7932,-5327.1249 834.4529,-5238.4159 797.2634,-4992.3778 855.7932,-4924.1249 878.7153,-4897.395 917.5964,-4936.9293 932.7092,-4905.1249"/>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M427.4542,-5606.3099C494.7695,-5630.7763 665.2184,-5680.2126 755.1332,-5593.1249"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00c8ff" stroke-dasharray="5,2" d="M462.5605,-4820.1069C545.9025,-4804.7237 696.1389,-4773.8205 819.7932,-4731.1249 872.0185,-4713.0925 879.8749,-4695.2861 932.7092,-4679.1249"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005bff" stroke-dasharray="5,2" d="M1282.7626,-2407.2978C1295.7658,-2459.9819 1352.3548,-2688.855 1400.2236,-2876.1249 1425.6301,-2975.5186 1456.8437,-3094.0992 1469.2986,-3141.2775"/>
<polygon fill="#005bff" stroke="#005bff" points="1465.9183,-3142.1853 1471.8561,-3150.9598 1472.6862,-3140.3976 1465.9183,-3142.1853"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2120.3654,-2399.1249C2199.0646,-2405.8183 2207.1443,-2447.1489 2281.0071,-2475.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1364.4274,-2397.1574C1442.7063,-2398.0252 1562.4233,-2399.1249 1666.4052,-2399.1249 1666.4052,-2399.1249 1666.4052,-2399.1249 1846.9164,-2399.1249 1968.4493,-2399.1249 1999.2697,-2388.8257 2120.3654,-2399.1249"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#1200ff" stroke-dasharray="5,2" d="M637.7201,-2251.1569C644.2512,-2254.619 650.1465,-2259.1628 654.4731,-2265.1249 724.6661,-2361.8509 661.5446,-3224.1675 690.4731,-3340.1249 701.0989,-3382.7172 726.6409,-3427.6714 742.2547,-3452.5813"/>
<polygon fill="#1200ff" stroke="#1200ff" points="739.3656,-3454.56 747.701,-3461.1001 745.2633,-3450.7895 739.3656,-3454.56"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M592.8934,-2228.9383C608.3264,-2205.5881 646.8365,-2151.0238 690.4731,-2117.1249 932.661,-1928.9826 1078.5893,-1856.476 1364.2236,-1968.1249 1470.7869,-2009.7785 2031.1721,-2595.4637 2120.3654,-2667.1249"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.7027,-2229.036C714.921,-2169.1198 1239.2854,-1890.5354 1364.2236,-1994.1249 1430.7227,-2049.2611 1363.8394,-2106.7775 1400.2236,-2185.1249 1463.1629,-2320.6542 1594.9789,-2447.9646 1645.806,-2493.9867"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1643.7353,-2496.8311 1653.5158,-2500.9045 1648.4102,-2491.6209 1643.7353,-2496.8311"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M1853.7258,-1959.1159C1875.5513,-1923.83 1943.9705,-1813.2145 1972.0351,-1767.8416"/>
<polygon fill="#4800ff" stroke="#4800ff" points="1975.0961,-1769.5462 1977.3799,-1759.2004 1969.1429,-1765.8639 1975.0961,-1769.5462"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1478.7364,-2867.3786C1491.7936,-2905.4148 1533.806,-3032.9079 1549.3953,-3142.1249 1569.2645,-3281.3265 1521.8227,-4281.7041 1585.3953,-4407.1249 1595.6844,-4427.4241 1615.8742,-4443.1509 1633.523,-4453.8145"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1632.0371,-4456.9968 1642.4547,-4458.9267 1635.5144,-4450.9215 1632.0371,-4456.9968"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1530.2457,-2845.0579C1537.4654,-2841.6006 1544.158,-2837.0675 1549.3953,-2831.1249 1603.337,-2769.918 1550.7094,-2724.9686 1585.3953,-2651.1249 1609.7133,-2599.3537 1641.7246,-2602.7243 1666.4052,-2551.1249"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M1478.7597,-2561.3753C1491.8906,-2599.4011 1534.1085,-2726.8652 1549.3953,-2836.1249 1561.4918,-2922.5835 1546.1414,-4329.1471 1585.3953,-4407.1249 1595.6281,-4427.4525 1615.8179,-4443.1794 1633.4807,-4453.8359"/>
<polygon fill="#ff00da" stroke="#ff00da" points="1632.0017,-4457.0219 1642.4207,-4458.9439 1635.4744,-4450.944 1632.0017,-4457.0219"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1528.7481,-2557.9175C1546.7432,-2560.3901 1566.9145,-2563.0246 1585.3953,-2565.1249 1701.3687,-2578.3055 1730.84,-2576.884 1846.9164,-2589.1249"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1528.6894,-2539.4387C1551.061,-2535.0016 1577.2318,-2529.8111 1600.7155,-2525.1534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1601.4685,-2528.5723 1610.5965,-2523.1937 1600.1067,-2521.7061 1601.4685,-2528.5723"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M444.2433,-2709.0865C456.4564,-2705.3684 469.4692,-2700.7134 480.9653,-2695.1249 512.1902,-2679.9461 544.4187,-2656.0153 564.7347,-2639.7234"/>
<polygon fill="#ff006d" stroke="#ff006d" points="567.1312,-2642.2856 572.6746,-2633.2567 562.7106,-2636.858 567.1312,-2642.2856"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M463.3155,-2718.2685C545.9,-2716.4128 693.7,-2714.8865 819.7932,-2723.1249 870.2548,-2726.4219 882.4207,-2731.8045 932.7092,-2737.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M932.7092,-2737.1249C1037.3017,-2739.4797 1077.3006,-2739.4726 1159.79,-2675.1249 1185.5224,-2655.0518 1170.1693,-2631.3404 1195.79,-2611.1249 1226.3443,-2587.0169 1244.8763,-2603.8763 1280.0068,-2587.1249"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff006d" stroke-dasharray="5,2" d="M443.7877,-2637.3344C468.4588,-2634.6907 499.4194,-2631.3729 526.1233,-2628.5113"/>
<polygon fill="#ff006d" stroke="#ff006d" points="526.5574,-2631.9849 536.1275,-2627.4392 525.8114,-2625.0247 526.5574,-2631.9849"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.7067,-2630.927C480.4673,-2596.4108 677.3595,-2491.8921 855.7932,-2457.1249 934.1464,-2441.8581 1273.6297,-2471.6164 1280.0068,-2473.1249"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M812.6352,-2367.1644C909.6494,-2386.1854 1111.7284,-2427.5127 1280.0068,-2473.1249"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2445.164,-3135.2592C2451.6211,-3237.1269 2502.6963,-4002.5883 2576.7096,-3956.1249"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2445.7472,-3112.7653C2452.5084,-3052.5088 2484.7752,-2764.1431 2509.6157,-2528.1249 2536.1586,-2275.932 2566.4353,-1969.5553 2574.5934,-1886.6631"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2578.0993,-1886.7734 2575.595,-1876.4788 2571.1329,-1886.0882 2578.0993,-1886.7734"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2281.0071,-4254.1249C2377.5717,-4287.4776 2432.6499,-4297.3066 2509.6157,-4230.1249 2604.0697,-4147.6782 2470.5238,-4022.7853 2576.7096,-3956.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2122.5377,-4013.1641C2131.8389,-4056.8112 2172.8729,-4216.7762 2281.0071,-4254.1249"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2123.7576,-4013.285C2135.177,-4050.3504 2174.0188,-4172.4291 2218.6875,-4268.1249 2233.7866,-4300.4725 2255.0706,-4336.0398 2268.4474,-4357.47"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2265.5289,-4359.4037 2273.8208,-4365.9988 2271.4515,-4355.6723 2265.5289,-4359.4037"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2122.0076,-4013.3294C2137.4418,-4118.6315 2256.9268,-4933.8341 2277.8768,-5076.7684"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2274.4448,-5077.4877 2279.3581,-5086.8744 2281.3708,-5076.4725 2274.4448,-5077.4877"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2444.4712,-5098.1249C2471.7596,-5083.7235 2491.2168,-5098.8947 2509.6157,-5074.1249 2583.822,-4974.2242 2471.3113,-4022.2909 2576.7096,-3956.1249"/>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2283.368,-4388.3909C2292.3309,-4431.4929 2324.6849,-4590.1402 2343.3267,-4722.1249 2354.3234,-4799.9824 2331.1254,-5012.0012 2379.3267,-5074.1249 2398.2414,-5098.5031 2417.1827,-5112.5264 2444.4712,-5098.1249"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2327.0996,-5109.1371C2361.4538,-5114.8307 2408.455,-5117.1324 2444.4712,-5098.1249"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2154.4374,-5731.0123C2163.9249,-5727.247 2174.003,-5722.5862 2182.6875,-5717.1249 2232.8365,-5685.5883 2232.1592,-5660.6415 2281.0071,-5627.1249"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2135.8958,-5731.0059C2150.4558,-5719.6836 2171.5961,-5700.7553 2182.6875,-5679.1249 2234.7788,-5577.5373 2270.7727,-5211.4654 2279.1431,-5119.3021"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2282.6383,-5119.5112 2280.0455,-5109.2385 2275.6663,-5118.8859 2282.6383,-5119.5112"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0036" stroke-dasharray="5,2" d="M2578.4043,-1853.8615C2592.6503,-1759.1773 2692.3751,-1096.3705 2711.5093,-969.1978"/>
<polygon fill="#ff0036" stroke="#ff0036" points="2714.9901,-969.5867 2713.017,-959.1772 2708.0681,-968.5452 2714.9901,-969.5867"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2289.6312,-2679.4019C2302.8585,-2697.1726 2328.2074,-2733.1731 2343.3267,-2767.1249 2397.4989,-2888.7736 2430.1346,-3046.7421 2440.6922,-3103.0535"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2437.2558,-3103.7188 2442.5092,-3112.9194 2444.14,-3102.4509 2437.2558,-3103.7188"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2292.9061,-2656.9209C2319.878,-2631.5229 2387.7338,-2567.6194 2444.4712,-2514.1249"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.0071,-2514.1249C2386.9872,-2577.5665 2433.0397,-3001.8696 2442.5567,-3102.6702"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2439.0914,-3103.208 2443.4956,-3112.844 2446.0617,-3102.5646 2439.0914,-3103.208"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2281.0071,-2514.1249C2343.3425,-2551.4401 2385.5638,-2556.6461 2444.4712,-2514.1249"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2161.7205,-2503.0733C2196.1304,-2496.3312 2245.113,-2492.6381 2281.0071,-2514.1249"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2133.385,-2525.2813C2146.8047,-2537.2118 2167.8098,-2557.1288 2182.6875,-2577.1249 2202.6328,-2603.9322 2193.7105,-2620.9305 2218.6875,-2643.1249 2222.7723,-2646.7546 2227.4506,-2649.8933 2232.3681,-2652.599"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2230.8803,-2655.7675 2241.4015,-2657.0144 2233.9543,-2649.4785 2230.8803,-2655.7675"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M450.5128,-3755.0421C557.0692,-3731.2728 808.7791,-3670.9236 1009.6252,-3590.1249 1079.5883,-3561.9794 1102.3942,-3560.0404 1159.79,-3511.1249 1180.0859,-3493.8278 1173.6048,-3477.921 1195.79,-3463.1249 1273.7873,-3411.1059 1308.235,-3429.2256 1400.2236,-3411.1249 1654.9618,-3360.9999 1768.9165,-3279.0596 1984.2305,-3424.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-3538.1249C2154.6866,-3551.0756 2247.4934,-3591.0413 2281.0071,-3576.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1984.2305,-3424.1249C2001.5687,-3433.9021 2006.2381,-3436.025 2022.0432,-3448.1249 2069.0827,-3484.137 2064.9383,-3517.2102 2120.3654,-3538.1249"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1682.8909,-2523.1764C1713.5699,-2542.7968 1782.1999,-2582.3002 1846.9164,-2589.1249"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1846.9164,-2589.1249C1907.6083,-2595.5252 1928.5922,-2564.0479 1984.2305,-2589.1249"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2120.3654,-2667.1249C2136.0459,-2679.5587 2184.6273,-2678.3666 2224.2951,-2674.918"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2224.7921,-2678.3869 2234.4239,-2673.9736 2224.1422,-2671.4171 2224.7921,-2678.3869"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M452.8328,-1177.0586C563.2728,-1154.9502 823.9824,-1105.9959 1045.6252,-1089.1249 1096.2188,-1085.2739 1109.8515,-1080.1427 1159.79,-1089.1249 1346.2298,-1122.6591 1802.8318,-1337.2095 1910.4177,-1493.1249 1950.3381,-1550.9782 1913.3146,-1585.1183 1946.4177,-1647.1249 1969.6129,-1690.5727 2003.0425,-1682.686 2022.0432,-1728.1249 2097.2923,-1908.0784 1979.4877,-2426.59 2058.0432,-2605.1249 2073.7786,-2640.887 2089.7511,-2642.8495 2120.3654,-2667.1249"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1009.6448,-6287.1274C1115.7789,-6298.4085 1301.1543,-6313.6953 1364.2236,-6291.1249 1372.6079,-6288.1245 1896.191,-5850.5916 1910.4177,-5833.1249 1931.5192,-5807.2179 1930.3436,-5796.4177 1946.4177,-5767.1249 2050.9454,-5576.6379 2088.9847,-5535.1635 2182.6875,-5339.1249 2220.7732,-5259.4446 2258.0104,-5160.9645 2273.4974,-5118.8287"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2276.8067,-5119.9697 2276.9534,-5109.3758 2270.2324,-5117.566 2276.8067,-5119.9697"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2444.4712,-2514.1249C2538.9283,-2425.0667 2569.6355,-1988.2124 2575.5663,-1886.3743"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2579.0752,-1886.3131 2576.1438,-1876.1318 2572.0863,-1885.9189 2579.0752,-1886.3131"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2122.5062,-1398.3737C2145.9095,-1520.7294 2355.0372,-2598.4472 2444.4712,-2514.1249"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilepackagedthermalstoragecoilf90EfferentGraph = svgPanZoom('#sourcefilepackagedthermalstoragecoilf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilepackagedthermalstoragecoilf90AfferentGraph" width="641pt" height="148pt"
 viewBox="0.00 0.00 641.00 147.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph" class="graph" transform="scale(.2616 .2616) rotate(0) translate(4 561.0048)">
<title>sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-561.0048 2446.0425,-561.0048 2446.0425,4 -4,4"/>
<!-- sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~packagedthermalstoragecoil.f90</title>
<polygon fill="none" stroke="#000000" points="169.3812,-275.5771 .2059,-275.5771 .2059,-253.5662 169.3812,-253.5662 169.3812,-275.5771"/>
<text text-anchor="middle" x="84.7936" y="-261.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">PackagedThermalStorageCoil.f90</text>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="312.8456,-275.5771 205.8336,-275.5771 205.8336,-253.5662 312.8456,-253.5662 312.8456,-275.5771"/>
<text text-anchor="middle" x="259.3396" y="-261.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M169.5101,-264.5716C178.2788,-264.5716 187.0819,-264.5716 195.565,-264.5716"/>
<polygon fill="#ff0000" stroke="#ff0000" points="195.73,-268.0717 205.7299,-264.5716 195.7299,-261.0717 195.73,-268.0717"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.358,-275.5771 349.0033,-275.5771 349.0033,-253.5662 475.358,-253.5662 475.358,-275.5771"/>
<text text-anchor="middle" x="412.1807" y="-261.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M313.2256,-264.5716C321.5032,-264.5716 330.1682,-264.5716 338.7819,-264.5716"/>
<polygon fill="#ff0000" stroke="#ff0000" points="338.8438,-268.0717 348.8438,-264.5716 338.8437,-261.0717 338.8438,-268.0717"/>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1196.4546,-197.5771 1071.0275,-197.5771 1071.0275,-175.5662 1196.4546,-175.5662 1196.4546,-197.5771"/>
<text text-anchor="middle" x="1133.7411" y="-183.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.1807,-31.5716C591.7817,5.9421 655.6758,21.1206 824.5664,-50.5716 844.8246,-59.171 841.4627,-73.6448 860.5664,-84.5716 893.8067,-103.5843 907.0807,-96.1888 943.3169,-108.5716"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M261.4187,-253.5243C270.2035,-210.663 308.7133,-56.5138 412.1807,-31.5716"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M943.3169,-108.5716C978.956,-120.9725 990.7978,-114.1557 1026.0674,-127.5716 1055.5707,-138.7942 1086.9704,-156.7755 1108.2002,-169.941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1106.5911,-173.0638 1116.9179,-175.4319 1110.3218,-167.1408 1106.5911,-173.0638"/>
</g>
<!-- sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~outdoorairunit.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/outdoorairunit.f90.html" xlink:title="OutdoorAirUnit.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="610.2067,-433.5771 511.2902,-433.5771 511.2902,-411.5662 610.2067,-411.5662 610.2067,-433.5771"/>
<text text-anchor="middle" x="560.7484" y="-419.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutdoorAirUnit.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.176,-275.7332C323.2205,-298.7555 425.1419,-353.0832 511.2693,-397.5716 517.1053,-400.5862 523.3464,-403.7703 529.3617,-406.8192"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.0339,-410.0698 538.5378,-411.4555 531.1907,-403.8219 528.0339,-410.0698"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="595.5295,-236.5771 525.9673,-236.5771 525.9673,-214.5662 595.5295,-214.5662 595.5295,-236.5771"/>
<text text-anchor="middle" x="560.7484" y="-222.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.1807,-31.5716C497.8443,-13.6789 541.9204,-150.5934 555.8081,-204.4422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="552.4509,-205.4458 558.2523,-214.3111 559.2456,-203.763 552.4509,-205.4458"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M427.9788,-253.4251C446.9863,-240.4342 480.2263,-219.0337 511.2693,-205.5716 568.5507,-180.731 584.4084,-175.3247 646.2275,-166.5716 724.7065,-155.4596 745.5804,-159.9667 824.5664,-166.5716 877.9016,-171.0316 889.7981,-186.0569 943.3169,-186.5716"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M943.3169,-186.5716C982.1323,-186.4783 1025.3983,-186.4706 1060.8679,-186.4896"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1061.1299,-189.9896 1071.1321,-186.4959 1061.1343,-182.9896 1061.1299,-189.9896"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~outdoorairunit.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.2077,-275.9315C431.8639,-300.7827 467.4129,-360.6943 511.2693,-397.5716 515.2195,-400.8932 519.6858,-403.9202 524.2787,-406.6302"/>
<polygon fill="#ff0000" stroke="#ff0000" points="522.7051,-409.7583 533.1648,-411.4453 526.0401,-403.6038 522.7051,-409.7583"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M454.3568,-253.5001C473.4968,-248.4757 496.1583,-242.527 515.6378,-237.4135"/>
<polygon fill="#ff0000" stroke="#ff0000" points="516.7151,-240.7493 525.4987,-234.8249 514.9377,-233.9787 516.7151,-240.7493"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~zoneequipmentmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/zoneequipmentmanager.f90.html" xlink:title="Zoneequipmentmanager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1205.5889,-352.5771 1061.8933,-352.5771 1061.8933,-330.5662 1205.5889,-330.5662 1205.5889,-352.5771"/>
<text text-anchor="middle" x="1133.7411" y="-338.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Zoneequipmentmanager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M431.738,-275.6648C470.9562,-297.2796 562.6233,-344.6584 646.2275,-364.5716 774.9364,-395.228 812.2683,-401.7942 943.3169,-383.5716"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2154.007,-314.5771 2055.0494,-314.5771 2055.0494,-292.5662 2154.007,-292.5662 2154.007,-314.5771"/>
<text text-anchor="middle" x="2104.5282" y="-300.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1769.1892,-303.5716C1864.6786,-319.2586 1977.5378,-314.5749 2044.9552,-309.3601"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2045.2824,-312.8452 2054.97,-308.5555 2044.7218,-305.8677 2045.2824,-312.8452"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1196.7091,-180.8978C1317.7834,-171.2585 1577.4826,-157.1209 1649.844,-205.5716 1681.9056,-227.0389 1655.9309,-260.1996 1685.844,-284.5716 1715.298,-308.5696 1731.8602,-296.5015 1769.1892,-303.5716"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1470.3965,-276.5771 1371.8384,-276.5771 1371.8384,-254.5662 1470.3965,-254.5662 1470.3965,-276.5771"/>
<text text-anchor="middle" x="1421.1174" y="-262.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1288.5714,-264.5716C1312.3922,-263.4494 1338.6471,-263.3996 1361.4621,-263.7379"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1361.6213,-267.2411 1371.6815,-263.9182 1361.7448,-260.2422 1361.6213,-267.2411"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1168.9847,-197.6932C1180.7869,-201.8524 1193.8725,-206.9474 1205.4148,-212.5716 1244.6,-231.6655 1245.0301,-266.6229 1288.5714,-264.5716"/>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M596.0956,-433.6324C631.0655,-443.7217 686.3204,-457.3837 735.397,-459.5716"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M735.397,-459.5716C796.4638,-462.294 802.6684,-422.1775 860.5664,-402.5716 896.3078,-390.4686 905.9415,-388.7688 943.3169,-383.5716"/>
</g>
<!-- sourcefile~generalroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~generalroutines.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node16"><a xlink:href="../sourcefile/generalroutines.f90.html" xlink:title="GeneralRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1188.0513,-473.5771 1079.4308,-473.5771 1079.4308,-451.5662 1188.0513,-451.5662 1188.0513,-473.5771"/>
<text text-anchor="middle" x="1133.7411" y="-459.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GeneralRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~outdoorairunit.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M735.397,-459.5716C791.9224,-463.2389 804.1761,-478.2143 860.5664,-483.5716 933.7927,-490.5285 952.8523,-490.6447 1026.0674,-483.5716 1042.9438,-481.9412 1061.1036,-478.9053 1077.6133,-475.6385"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1078.5576,-479.0179 1087.6535,-473.5851 1077.155,-472.1598 1078.5576,-479.0179"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M595.8427,-224.1057C646.489,-221.7496 742.9539,-216.3606 824.5664,-206.5716 877.7068,-200.1977 889.7956,-186.5716 943.3169,-186.5716"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2309.6251,-333.5771 2189.8146,-333.5771 2189.8146,-311.5662 2309.6251,-311.5662 2309.6251,-333.5771"/>
<text text-anchor="middle" x="2249.7198" y="-319.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1953.7866,-225.5716C2020.6901,-222.0477 2039.2988,-210.287 2104.5282,-225.5716"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1769.1892,-225.5716C1850.8272,-233.717 1871.8569,-229.887 1953.7866,-225.5716"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M562.2025,-214.2942C567.0632,-181.8475 585.9997,-88.1818 646.2275,-50.5716 758.4774,19.5245 813.4241,-45.2466 943.3169,-70.5716"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2104.5282,-225.5716C2156.7287,-237.8033 2206.1006,-279.4308 2231.6378,-303.9995"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2229.4854,-306.7923 2239.0649,-311.3181 2234.3986,-301.8062 2229.4854,-306.7923"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M943.3169,-70.5716C1257.1606,-115.7567 1345.9112,-79.2145 1649.844,-169.5716 1706.006,-186.2682 1710.8874,-219.7546 1769.1892,-225.5716"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~hvacstandaloneerv.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node17"><a xlink:href="../sourcefile/hvacstandaloneerv.f90.html" xlink:title="HVACStandAloneERV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1009.4648,-314.5771 877.169,-314.5771 877.169,-292.5662 1009.4648,-292.5662 1009.4648,-314.5771"/>
<text text-anchor="middle" x="943.3169" y="-300.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACStandAloneERV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacstandaloneerv.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M573.4402,-236.6285C589.3728,-249.9403 618.0442,-272.0629 646.2275,-284.5716 683.4419,-301.0886 696.9559,-292.1552 735.397,-305.5716"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M735.397,-305.5716C779.6356,-321.0114 832.4647,-320.2804 873.8006,-315.8074"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="874.2579,-319.2778 883.7796,-314.6316 873.4387,-312.3259 874.2579,-319.2778"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node18"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="789.5764,-81.5771 681.2175,-81.5771 681.2175,-59.5662 789.5764,-59.5662 789.5764,-81.5771"/>
<text text-anchor="middle" x="735.397" y="-67.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M573.3087,-214.4244C603.2669,-187.8366 679.1164,-120.5204 715.4273,-88.2946"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="717.7944,-90.8734 722.9505,-81.6178 713.148,-85.6379 717.7944,-90.8734"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~packagedterminalheatpump.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node19"><a xlink:href="../sourcefile/packagedterminalheatpump.f90.html" xlink:title="PackagedTerminalHeatPump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1025.8186,-355.5771 860.8152,-355.5771 860.8152,-333.5662 1025.8186,-333.5662 1025.8186,-355.5771"/>
<text text-anchor="middle" x="943.3169" y="-341.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedTerminalHeatPump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~packagedterminalheatpump.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M735.397,-305.5716C748.128,-310.0149 814.678,-322.195 869.1086,-331.7729"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="868.6608,-335.2477 879.1152,-333.5286 869.8706,-328.353 868.6608,-335.2477"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~airflownetworkbalancemanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node20"><a xlink:href="../sourcefile/airflownetworkbalancemanager.f90.html" xlink:title="AirflowNetworkBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="824.7362,-275.5771 646.0578,-275.5771 646.0578,-253.5662 824.7362,-253.5662 824.7362,-275.5771"/>
<text text-anchor="middle" x="735.397" y="-261.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">AirflowNetworkBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~airflownetworkbalancemanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M595.6714,-233.3701C618.6211,-238.4949 649.2334,-245.3308 675.9544,-251.2978"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="675.4584,-254.7731 685.9808,-253.5367 676.984,-247.9414 675.4584,-254.7731"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~hvacvariablerefrigerantflow.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node21"><a xlink:href="../sourcefile/hvacvariablerefrigerantflow.f90.html" xlink:title="HVACVariableRefrigerantFlow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="820.0946,-355.5771 650.6993,-355.5771 650.6993,-333.5662 820.0946,-333.5662 820.0946,-355.5771"/>
<text text-anchor="middle" x="735.397" y="-341.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACVariableRefrigerantFlow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacvariablerefrigerantflow.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M567.7526,-236.7037C580.7541,-256.4403 610.566,-297.5553 646.2275,-319.5716 653.0358,-323.7748 660.5667,-327.2886 668.2822,-330.2221"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="667.1537,-333.5353 677.7486,-333.52 669.4567,-326.9249 667.1537,-333.5353"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~hvacunitarybypassvav.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node22"><a xlink:href="../sourcefile/hvacunitarybypassvav.f90.html" xlink:title="HVACUnitaryBypassVAV.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="807.4981,-197.5771 663.2959,-197.5771 663.2959,-175.5662 807.4981,-175.5662 807.4981,-197.5771"/>
<text text-anchor="middle" x="735.397" y="-183.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitaryBypassVAV.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvacunitarybypassvav.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M595.6714,-217.7731C618.6211,-212.6483 649.2334,-205.8124 675.9544,-199.8455"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="676.984,-203.2018 685.9808,-197.6065 675.4584,-196.3701 676.984,-203.2018"/>
</g>
<!-- sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~fancoilunits.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node23"><a xlink:href="../sourcefile/fancoilunits.f90.html" xlink:title="FanCoilUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="987.9347,-474.5771 898.6991,-474.5771 898.6991,-452.5662 987.9347,-452.5662 987.9347,-474.5771"/>
<text text-anchor="middle" x="943.3169" y="-460.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FanCoilUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~fancoilunits.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M564.6346,-236.6884C574.2985,-262.7677 601.8826,-328.4002 646.2275,-364.5716 717.5087,-422.7145 824.3434,-447.2467 888.5971,-457.1983"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="888.1262,-460.6667 898.5318,-458.6732 889.1542,-453.7426 888.1262,-460.6667"/>
</g>
<!-- sourcefile~windowac.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~windowac.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node24"><a xlink:href="../sourcefile/windowac.f90.html" xlink:title="WindowAC.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="984.2627,-433.5771 902.3711,-433.5771 902.3711,-411.5662 984.2627,-411.5662 984.2627,-433.5771"/>
<text text-anchor="middle" x="943.3169" y="-419.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowAC.f90</text>
</a>
</g>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~windowac.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M735.397,-305.5716C773.6544,-318.9239 792.5876,-299.6865 824.5664,-324.5716 853.1159,-346.7881 832.9686,-374.1835 860.5664,-397.5716 869.5988,-405.2263 880.9228,-410.5373 892.2682,-414.2221"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="891.6098,-417.6741 902.1868,-417.0598 893.5353,-410.9441 891.6098,-417.6741"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1189.3336,-330.5361C1300.2386,-310.2163 1556.6006,-271.7474 1769.1892,-303.5716"/>
</g>
<!-- sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~zoneequipmentmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1146.7412,-330.3724C1172.0839,-309.6784 1230.6953,-267.2982 1288.5714,-264.5716"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2154.0888,-310.0572C2162.3552,-311.139 2171.0661,-312.2789 2179.7275,-313.4123"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2179.4733,-316.9088 2189.843,-314.736 2180.3817,-309.968 2179.4733,-316.9088"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1769.1892,-379.5716C1917.9804,-379.5716 2090.894,-352.2891 2183.3349,-335.4743"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2184.1825,-338.8773 2193.3863,-333.6294 2182.9187,-331.9923 2184.1825,-338.8773"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1439.6632,-276.7575C1490.5426,-306.2976 1637.3143,-383.8535 1769.1892,-379.5716"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node13"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1650.013,-236.5771 1506.3379,-236.5771 1506.3379,-214.5662 1650.013,-214.5662 1650.013,-236.5771"/>
<text text-anchor="middle" x="1578.1754" y="-222.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1464.45,-254.5356C1483.1695,-249.768 1505.2533,-244.1436 1524.9568,-239.1255"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1525.8851,-242.5009 1534.7119,-236.641 1524.1574,-235.7174 1525.8851,-242.5009"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node11"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2435.4408,-333.5771 2352.0238,-333.5771 2352.0238,-311.5662 2435.4408,-311.5662 2435.4408,-333.5771"/>
<text text-anchor="middle" x="2393.7323" y="-319.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2309.543,-322.5716C2320.2076,-322.5716 2331.2394,-322.5716 2341.6658,-322.5716"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2341.8543,-326.0717 2351.8542,-322.5716 2341.8542,-319.0717 2341.8543,-326.0717"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node12"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2441.8534,-410.5771 2345.6112,-410.5771 2345.6112,-388.5662 2441.8534,-388.5662 2441.8534,-410.5771"/>
<text text-anchor="middle" x="2393.7323" y="-396.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2270.3533,-333.6038C2294.9496,-346.7549 2336.2328,-368.828 2364.2046,-383.7839"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2362.6682,-386.9312 2373.1371,-388.5599 2365.9688,-380.7582 2362.6682,-386.9312"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1650.0006,-222.2054C1685.886,-221.3782 1729.9213,-221.6537 1769.1892,-225.5716"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node14"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1852.3799,-275.5771 1685.9985,-275.5771 1685.9985,-253.5662 1852.3799,-253.5662 1852.3799,-275.5771"/>
<text text-anchor="middle" x="1769.1892" y="-261.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1632.1464,-236.5911C1654.8314,-241.2228 1681.3991,-246.6472 1705.072,-251.4806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1704.5225,-254.9405 1715.0206,-253.5118 1705.9229,-248.082 1704.5225,-254.9405"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1805.1722,-253.4932C1842.057,-242.9645 1901.2867,-228.3369 1953.7866,-225.5716"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node15"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2018.792,-275.5771 1888.7813,-275.5771 1888.7813,-253.5662 2018.792,-253.5662 2018.792,-275.5771"/>
<text text-anchor="middle" x="1953.7866" y="-261.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1852.5769,-264.5716C1861.2985,-264.5716 1870.1272,-264.5716 1878.7476,-264.5716"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1878.7527,-268.0717 1888.7527,-264.5716 1878.7526,-261.0717 1878.7527,-268.0717"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1996.5799,-275.6431C2013.8388,-280.1084 2033.9198,-285.3037 2052.0486,-289.9941"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2051.3311,-293.4236 2061.889,-292.54 2053.0845,-286.6467 2051.3311,-293.4236"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1983.229,-253.4793C2020.2205,-240.1514 2081.6305,-220.2062 2104.5282,-225.5716"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M998.6513,-314.6138C1020.4608,-318.966 1045.6775,-323.9981 1068.3763,-328.5278"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1067.7771,-331.9771 1078.2687,-330.5019 1069.147,-325.1125 1067.7771,-331.9771"/>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M980.4629,-292.492C1018.5334,-281.9623 1079.6493,-267.334 1133.7411,-264.5716"/>
</g>
<!-- sourcefile~systemreports.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~systemreports.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node25"><a xlink:href="../sourcefile/systemreports.f90.html" xlink:title="SystemReports.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1184.5274,-393.5771 1082.9548,-393.5771 1082.9548,-371.5662 1184.5274,-371.5662 1184.5274,-393.5771"/>
<text text-anchor="middle" x="1133.7411" y="-379.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemReports.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~hvacstandaloneerv.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1003.6294,-314.6849C1011.4481,-317.3194 1019.1368,-320.5683 1026.0674,-324.5716 1045.9349,-336.0478 1042.4126,-349.7349 1062.0674,-361.5716 1065.9204,-363.892 1070.0451,-365.9691 1074.2973,-367.8263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1073.1663,-371.1425 1083.7534,-371.5497 1075.731,-364.6292 1073.1663,-371.1425"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M789.9306,-76.0493C832.5366,-81.3918 892.794,-91.3066 943.3169,-108.5716"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M789.7927,-64.9224C832.0623,-61.8857 891.9433,-60.5554 943.3169,-70.5716"/>
</g>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node26"><a xlink:href="../sourcefile/hvacfurnace.f90.html" xlink:title="HVACFurnace.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="991.7485,-158.5771 894.8853,-158.5771 894.8853,-136.5662 991.7485,-136.5662 991.7485,-158.5771"/>
<text text-anchor="middle" x="943.3169" y="-144.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFurnace.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M760.0459,-81.6743C785.0846,-92.7473 825.1164,-109.8891 860.5664,-122.5716 871.3863,-126.4425 883.1367,-130.2344 894.2931,-133.6482"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="893.3214,-137.0108 903.9059,-136.5434 895.3401,-130.3082 893.3214,-137.0108"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1026.0089,-343.2689C1034.5005,-343.1351 1043.1273,-342.9992 1051.6127,-342.8655"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1051.9308,-346.361 1061.8744,-342.7038 1051.8205,-339.3619 1051.9308,-346.361"/>
</g>
<!-- sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~packagedterminalheatpump.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M998.6513,-355.6138C1021.9037,-360.254 1049.0292,-365.667 1072.847,-370.4199"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1072.3395,-373.8876 1082.8311,-372.4123 1073.7094,-367.0229 1072.3395,-373.8876"/>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1133.7411,-264.5716C1202.465,-261.062 1219.8342,-267.8098 1288.5714,-264.5716"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M824.8502,-267.1755C905.6268,-268.9071 1027.7233,-269.9857 1133.7411,-264.5716"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~systemavailabilitymanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node27"><a xlink:href="../sourcefile/systemavailabilitymanager.f90.html" xlink:title="SystemAvailabilityManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1020.6232,-236.5771 866.0106,-236.5771 866.0106,-214.5662 1020.6232,-214.5662 1020.6232,-236.5771"/>
<text text-anchor="middle" x="943.3169" y="-222.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SystemAvailabilityManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~airflownetworkbalancemanager.f90&#45;&gt;sourcefile~systemavailabilitymanager.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M794.1448,-253.5522C819.058,-248.8791 848.2735,-243.3991 874.2143,-238.5333"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="875.1706,-241.9151 884.3539,-236.6314 873.88,-235.0351 875.1706,-241.9151"/>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M943.3169,-383.5716C991.0275,-376.9373 1044.5278,-364.7033 1082.6434,-355.1437"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1083.6445,-358.5007 1092.478,-352.6508 1081.9245,-351.7153 1083.6445,-358.5007"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M776.8701,-355.5919C827.9603,-368.5983 911.851,-387.947 943.3169,-383.5716"/>
</g>
<!-- sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~plantloopequipment.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node29"><a xlink:href="../sourcefile/plantloopequipment.f90.html" xlink:title="PlantLoopEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1006.8196,-552.5771 879.8142,-552.5771 879.8142,-530.5662 1006.8196,-530.5662 1006.8196,-552.5771"/>
<text text-anchor="middle" x="943.3169" y="-538.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~hvacvariablerefrigerantflow.f90&#45;&gt;sourcefile~plantloopequipment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M745.2201,-355.7698C772.4732,-386.7961 847.8606,-472.3258 860.5664,-483.5716 877.9691,-498.9746 899.5188,-513.967 916.2641,-524.8494"/>
<polygon fill="#00ffff" stroke="#00ffff" points="914.7061,-528.0076 925.0158,-530.4488 918.4787,-522.1112 914.7061,-528.0076"/>
</g>
<!-- sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~hvacunitarybypassvav.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M807.5651,-186.5716C847.5659,-186.5716 898.1954,-186.5716 943.3169,-186.5716"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M987.969,-459.7466C1001.4037,-456.7389 1015.3954,-451.5284 1026.0674,-442.5716 1055.9326,-417.5064 1032.6644,-388.1775 1062.0674,-362.5716 1064.078,-360.8206 1066.2281,-359.2154 1068.4822,-357.7439"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1070.5516,-360.5997 1077.6175,-352.7052 1067.1707,-354.4702 1070.5516,-360.5997"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~generalroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M987.9629,-463.3372C1012.2345,-463.2097 1042.6821,-463.0498 1069.4654,-462.9092"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1069.549,-466.4089 1079.5304,-462.8563 1069.5122,-459.409 1069.549,-466.4089"/>
</g>
<!-- sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~fancoilunits.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M988.2257,-454.4285C1000.6896,-451.2876 1014.0849,-447.3361 1026.0674,-442.5716 1055.5149,-430.8626 1086.9234,-412.623 1108.1705,-399.3262"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1110.3308,-402.1005 1116.8962,-393.7851 1106.5782,-396.1913 1110.3308,-402.1005"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M984.0681,-414.4053C997.99,-410.5602 1013.2658,-405.1128 1026.0674,-397.5716 1045.2946,-386.2452 1042.7929,-373.8174 1062.0674,-362.5716 1066.017,-360.2672 1070.2385,-358.1992 1074.5822,-356.3461"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1076.1583,-359.4896 1084.2281,-352.6246 1073.6385,-352.9588 1076.1583,-359.4896"/>
</g>
<!-- sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~windowac.f90&#45;&gt;sourcefile~systemreports.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M984.1677,-413.9906C1009.9755,-408.5695 1043.797,-401.465 1072.7491,-395.3834"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="1073.6988,-398.7604 1082.7656,-393.2794 1072.2597,-391.9099 1073.6988,-398.7604"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1184.7079,-371.6405C1191.964,-368.962 1199.0977,-365.6524 1205.4148,-361.5716 1253.1127,-330.7591 1231.8497,-267.2438 1288.5714,-264.5716"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1578.1754,-417.5716C1664.6277,-413.2825 1682.6669,-382.0786 1769.1892,-379.5716"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1184.6696,-390.8426C1267.207,-403.2869 1435.3589,-424.6571 1578.1754,-417.5716"/>
</g>
<!-- sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~systemreports.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1578.1754,-417.5716C1663.0025,-414.1749 1684.4225,-412.9057 1769.1892,-417.5716"/>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M991.8617,-157.5139C1015.5976,-162.3751 1044.4742,-168.2892 1069.9647,-173.5098"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1069.4179,-176.9704 1079.9169,-175.5481 1070.8225,-170.1128 1069.4179,-176.9704"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M997.1213,-214.5522C1019.7362,-209.9205 1046.222,-204.4961 1069.8218,-199.6627"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1070.6453,-203.0668 1079.7396,-197.6314 1069.2407,-196.2091 1070.6453,-203.0668"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~zoneequipmentmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M960.5876,-236.7192C977.6641,-247.961 1004.3184,-266.1046 1026.0674,-283.5716 1042.9904,-297.1628 1043.4371,-305.435 1062.0674,-316.5716 1068.5221,-320.4301 1075.6604,-323.8105 1082.8568,-326.7344"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1082.0559,-330.1735 1092.6474,-330.4404 1084.5341,-323.6268 1082.0559,-330.1735"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1133.7411,-226.5716C1204.4532,-231.0805 1217.7942,-267.9059 1288.5714,-264.5716"/>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1020.7506,-223.931C1055.3545,-223.7251 1096.6237,-224.2049 1133.7411,-226.5716"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1133.7411,-226.5716C1260.1584,-234.6325 1407.2135,-231.9432 1496.4452,-228.9768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1496.6254,-232.4728 1506.5,-228.6332 1496.3862,-225.4769 1496.6254,-232.4728"/>
</g>
<!-- sourcefile~plantmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~plantmanager.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node28"><a xlink:href="../sourcefile/plantmanager.f90.html" xlink:title="PlantManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1335.8852,-389.5771 1241.2577,-389.5771 1241.2577,-367.5662 1335.8852,-367.5662 1335.8852,-389.5771"/>
<text text-anchor="middle" x="1288.5714" y="-375.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~systemavailabilitymanager.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M965.7233,-236.6109C989.3349,-247.9964 1027.7816,-265.838 1062.0674,-278.5716 1124.4205,-301.7293 1145.4113,-292.8701 1205.4148,-321.5716 1227.7965,-332.2775 1250.8877,-348.6034 1267.0405,-361.0432"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1265.2261,-364.0687 1275.2519,-367.4941 1269.5504,-358.5641 1265.2261,-364.0687"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1301.765,-367.3236C1324.7896,-347.6944 1372.4816,-307.0353 1400.1,-283.4897"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1402.638,-285.9253 1407.9772,-276.7741 1398.0966,-280.5984 1402.638,-285.9253"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1578.1754,-379.5716C1662.9661,-383.7783 1684.3298,-382.0305 1769.1892,-379.5716"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1335.7588,-377.4004C1393.1089,-376.285 1492.8065,-375.3363 1578.1754,-379.5716"/>
</g>
<!-- sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~plantmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1769.1892,-417.5716C1977.2601,-427.8945 2224.6414,-412.5979 2335.2441,-404.312"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2335.8081,-407.7794 2345.5147,-403.5332 2335.2787,-400.7994 2335.8081,-407.7794"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1578.1754,-379.5716C1664.5828,-384.6861 1682.7614,-412.8143 1769.1892,-417.5716"/>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1003.0904,-552.5913C1059.6215,-559.7238 1144.6224,-561.6288 1205.4148,-523.5716 1250.718,-495.211 1273.877,-432.605 1283.3058,-399.7092"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1286.7577,-400.3515 1285.9891,-389.7846 1280.0004,-398.5244 1286.7577,-400.3515"/>
</g>
<!-- sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~plantloopsolver.f90</title>
<g id="a_sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_node30"><a xlink:href="../sourcefile/plantloopsolver.f90.html" xlink:title="PlantLoopSolver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1186.7335,-514.5771 1080.7487,-514.5771 1080.7487,-492.5662 1186.7335,-492.5662 1186.7335,-514.5771"/>
<text text-anchor="middle" x="1133.7411" y="-500.4216" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantLoopSolver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~plantloopequipment.f90&#45;&gt;sourcefile~plantloopsolver.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M998.6513,-530.5294C1021.1303,-526.0436 1047.2291,-520.8355 1070.4597,-516.1997"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1071.4417,-519.5728 1080.5634,-514.1835 1070.0717,-512.7082 1071.4417,-519.5728"/>
</g>
<!-- sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90 -->
<g id="sourcefile~~packagedthermalstoragecoil.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~plantloopsolver.f90&#45;&gt;sourcefile~plantmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1185.5832,-492.5512C1192.5617,-489.895 1199.3838,-486.6155 1205.4148,-482.5716 1237.9851,-460.7327 1263.9028,-422.1735 1277.6839,-398.6406"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1280.7799,-400.2765 1282.6746,-389.8525 1274.6929,-396.8198 1280.7799,-400.2765"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilepackagedthermalstoragecoilf90AfferentGraph = svgPanZoom('#sourcefilepackagedthermalstoragecoilf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/packagedthermalstoragecoil.html">PackagedThermalStorageCoil</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html#src">PackagedThermalStorageCoil.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">PackagedThermalStorageCoil</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! Module containing the routines dealing with the packaged thermal storage cooling</span>
<a name="ln-4"></a>
<a name="ln-5"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-7"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-8"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10"></a>
<a name="ln-11"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-12"></a>          <span class="c">! encapsulate the data and algorithms for modeling packaged thermals storage cooling coils</span>
<a name="ln-13"></a>
<a name="ln-14"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-16"></a>
<a name="ln-17"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-18"></a>          <span class="c">! na</span>
<a name="ln-19"></a>
<a name="ln-20"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-21"></a>          <span class="c">! na</span>
<a name="ln-22"></a>
<a name="ln-23"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-24"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-25"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-26"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-27"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-28"></a><span class="k">USE </span><span class="n">Psychrometrics</span>
<a name="ln-29"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-30"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">EnvironmentName</span><span class="p">,</span> <span class="n">CurMnDy</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">OutHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-31"></a><span class="k">USE </span><span class="n">CurveManager</span>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-34"></a>
<a name="ln-35"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-36"></a>
<a name="ln-37"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-38"></a><span class="c">! control types</span>
<a name="ln-39"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ScheduledOpModes</span>   <span class="o">=</span> <span class="mi">1</span> <span class="c">! control over TES modes is via local schedule</span>
<a name="ln-40"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EMSActuatedOpModes</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! control over TES modes is via EMS</span>
<a name="ln-41"></a>
<a name="ln-42"></a><span class="c">! Control Modes</span>
<a name="ln-43"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">OffMode</span>                 <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-44"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingOnlyMode</span>         <span class="o">=</span> <span class="mi">1</span>
<a name="ln-45"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingAndChargeMode</span>    <span class="o">=</span> <span class="mi">2</span>
<a name="ln-46"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeMode</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-47"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ChargeOnlyMode</span>          <span class="o">=</span> <span class="mi">4</span>
<a name="ln-48"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DischargeOnlyMode</span>       <span class="o">=</span> <span class="mi">5</span>
<a name="ln-49"></a>
<a name="ln-50"></a><span class="c">! storage media</span>
<a name="ln-51"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FluidBased</span> <span class="o">=</span> <span class="mi">101</span>
<a name="ln-52"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">IceBased</span>   <span class="o">=</span> <span class="mi">102</span>
<a name="ln-53"></a><span class="c">!INTEGER, PARAMETER :: UserDefinedFluid = 103</span>
<a name="ln-54"></a>
<a name="ln-55"></a>
<a name="ln-56"></a>
<a name="ln-57"></a><span class="c">!Water Systems</span>
<a name="ln-58"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateDiscarded</span> <span class="o">=</span> <span class="mi">1001</span> <span class="c">! default mode where water is &quot;lost&quot;</span>
<a name="ln-59"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CondensateToTank</span>    <span class="o">=</span> <span class="mi">1002</span> <span class="c">! collect coil condensate from air and store in water storage tank</span>
<a name="ln-60"></a>
<a name="ln-61"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterSupplyFromMains</span> <span class="o">=</span> <span class="mi">101</span>
<a name="ln-62"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WaterSupplyFromTank</span>  <span class="o">=</span> <span class="mi">102</span>
<a name="ln-63"></a>
<a name="ln-64"></a>
<a name="ln-65"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-66"></a><span class="k">TYPE</span>  <span class="kd">::</span> <span class="n">PackagedTESCoolingCoilStruct</span>
<a name="ln-67"></a>
<a name="ln-68"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>           <span class="o">=</span><span class="s1">&#39; &#39;</span>    <span class="c">! Name of TES cooling package</span>
<a name="ln-69"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">AvailSchedNum</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">! pointer to availability schedule</span>
<a name="ln-70"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ModeControlType</span>     <span class="o">=</span> <span class="mi">0</span> <span class="c">! how are operation modes controlled</span>
<a name="ln-71"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ControlModeSchedNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! pointer to control schedule if used</span>
<a name="ln-72"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">EMSControlModeOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, then EMS actuator has been used</span>
<a name="ln-73"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EMSControlModeValue</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! value to use from EMS actuator for control mode</span>
<a name="ln-74"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CurControlMode</span>      <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-75"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ControlModeErrorIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-76"></a>
<a name="ln-77"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedEvapAirVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! [m3/s]</span>
<a name="ln-78"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedEvapAirMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! [kg/s]</span>
<a name="ln-79"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EvapAirInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! evaporator inlet node pointer</span>
<a name="ln-80"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EvapAirOutletNodeNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! evaporator outlet node pointer</span>
<a name="ln-81"></a>  <span class="c">! Cooling Only Mode</span>
<a name="ln-82"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoolingOnlyModeIsAvailable</span> <span class="o">=</span>  <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-83"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! gross total cooling capacity at rating conditions [W]</span>
<a name="ln-84"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingOnlyRatedSHR</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Sensible heat ratio (sens cap/total cap) at rating conditions [W/W]</span>
<a name="ln-85"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingOnlyRatedCOP</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Coefficient of performance at rating conditions [W/W]</span>
<a name="ln-86"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyCapFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-87"></a>                                            <span class="c">! (function of entering wetbulb, outside drybulb)</span>
<a name="ln-88"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of object used for curve input</span>
<a name="ln-89"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyCapFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-90"></a>                                            <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-91"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyCapFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of object used for curve input</span>
<a name="ln-92"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyEIRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for energy input ratio modifier curve</span>
<a name="ln-93"></a>                                            <span class="c">! (function of entering wetbulb, outside drybulb)</span>
<a name="ln-94"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of object used for curve input</span>
<a name="ln-95"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyEIRFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for energy input ratio modifier curve</span>
<a name="ln-96"></a>                                            <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-97"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyEIRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of object used for curve input</span>
<a name="ln-98"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyPLFFPLRCurve</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for part-load fact vs part load ratio,EIR modifier</span>
<a name="ln-99"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlyPLFFPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of object used for curve input</span>
<a name="ln-100"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlySHRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for sensible heat ratio modifier curve</span>
<a name="ln-101"></a>                                            <span class="c">! (function of entering wetbulb and drybulb)</span>
<a name="ln-102"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlySHRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! type of object used for curve input</span>
<a name="ln-103"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlySHRFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for sensible heat ratio modifer curve</span>
<a name="ln-104"></a>                                            <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-105"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingOnlySHRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-106"></a>
<a name="ln-107"></a>  <span class="c">! cooling and charge mode</span>
<a name="ln-108"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeModeAvailable</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-109"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeRatedTotCap</span>      <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! gross total evaporator cooling capacity at rating conditions [W]</span>
<a name="ln-110"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeRatedTotCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!sizing factor for gross total evaporator [ ]</span>
<a name="ln-111"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeRatedChargeCap</span>   <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">!net storage charging capacity at rating conditions [W]</span>
<a name="ln-112"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeRatedChargeCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!sizing factor for charging capacity [ ]</span>
<a name="ln-113"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeRatedSHR</span>         <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Sensible heat ratio (sens cap/total cap) at rating conditions [W/W]</span>
<a name="ln-114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingRatedCOP</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Coefficient of performance at rating conditions, for cooling [W/W]</span>
<a name="ln-115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndChargeChargingRatedCOP</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Coefficient of performance at rating conditions, for charging [W/W]</span>
<a name="ln-116"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingCapFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-117"></a>                                                        <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-118"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-119"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingCapFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-120"></a>                                                        <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-121"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingCapFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-122"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingEIRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for cooling energy input ratio modifier curve</span>
<a name="ln-123"></a>                                                        <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-124"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-125"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingEIRFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for cooling energy input ratio modifier curve</span>
<a name="ln-126"></a>                                                        <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-127"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingEIRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-128"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingPLFFPLRCurve</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for cooling part-load fact vs part load ratio, EIR modifier</span>
<a name="ln-129"></a>                                                        <span class="c">! (function of evaporator part load)</span>
<a name="ln-130"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeCoolingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">!</span>
<a name="ln-131"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingCapFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for charging capacity modifier curve</span>
<a name="ln-132"></a>                                                         <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-133"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-134"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for charging capacity modifier curve</span>
<a name="ln-135"></a>                                                         <span class="c">! function of evaporator part load ratio</span>
<a name="ln-136"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingCapFEvapPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-137"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingEIRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for charging energy input ratio modifier curve</span>
<a name="ln-138"></a>                                                         <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-139"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-140"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingEIRFFLowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for charging energy input ratio modifier curve</span>
<a name="ln-141"></a>                                                        <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-142"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingEIRFFLowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-143"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingPLFFPLRCurve</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for chargine part-load fact vs part load ratio, EIR modif</span>
<a name="ln-144"></a>                                                        <span class="c">! (function of evaporator part load)</span>
<a name="ln-145"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeChargingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-146"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeSHRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! curve index for sensible heat ratio modifier curve</span>
<a name="ln-147"></a>                                                       <span class="c">! (function of entering wetbulb and drybulb)</span>
<a name="ln-148"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeSHRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-149"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeSHRFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! curve index for sensible heat ratio modifer curve</span>
<a name="ln-150"></a>                                                       <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-151"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndChargeSHRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-152"></a>
<a name="ln-153"></a>  <span class="c">!cooling and discharge mode</span>
<a name="ln-154"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeRatedTotCap</span>      <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! gross total evaporator cooling capacity at rating conditions [W]</span>
<a name="ln-156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeRatedTotCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!sizing factor gross total cooling capacity []</span>
<a name="ln-157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeRatedDischargeCap</span>   <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">!net storage discharging capacity at rating conditions [W]</span>
<a name="ln-158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeRatedDischargeCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!sizing factor discharging capacity []</span>
<a name="ln-159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeRatedSHR</span>         <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Sensible heat ratio (sens cap/total cap) at rating conditions [W/W]</span>
<a name="ln-160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingRatedCOP</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Coefficient of performance at rating conditions, for cooling [W/W]</span>
<a name="ln-161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingRatedCOP</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Coefficient of performance at rating conditions, for charging [W/W]</span>
<a name="ln-162"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingCapFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-163"></a>                                                        <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-164"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-165"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-166"></a>                                                        <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-167"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingCapFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-168"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingEIRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for cooling energy input ratio modifier curve</span>
<a name="ln-169"></a>                                                        <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-170"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-171"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingEIRFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for cooling energy input ratio modifier curve</span>
<a name="ln-172"></a>                                                        <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-173"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingEIRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-174"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingPLFFPLRCurve</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for cooling part-load fact vs part load ratio,</span>
<a name="ln-175"></a>                                                        <span class="c">! EIR modifier (function of evaporator part load)</span>
<a name="ln-176"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeCoolingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingCapFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for discharging capacity modifier curve</span>
<a name="ln-178"></a>                                                         <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-179"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-180"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingCapFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for discharging capacity modifier curve</span>
<a name="ln-181"></a>                                                         <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-182"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingCapFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-183"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingCapFEvapPLRCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for discharging capacity modifier curve</span>
<a name="ln-184"></a>                                                         <span class="c">! function of evaporator part load ratio</span>
<a name="ln-185"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingCapFEvapPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-186"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingEIRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for discharging energy input ratio modifier curve</span>
<a name="ln-187"></a>                                                         <span class="c">! (function of entering wetbulb, outside drybulb, state of TES)</span>
<a name="ln-188"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-189"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingEIRFFLowCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for discharging energy input ratio modifier curve</span>
<a name="ln-190"></a>                                                        <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-191"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingEIRFFLowObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-192"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingPLFFPLRCurve</span>  <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for discharging part-load fact vs part load ratio</span>
<a name="ln-193"></a>                                                        <span class="c">!  EIR modifier (function of evaporator part load)</span>
<a name="ln-194"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeDischargingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-195"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeSHRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! curve index for sensible heat ratio modifier curve</span>
<a name="ln-196"></a>                                                       <span class="c">! (function of entering wetbulb and drybulb)</span>
<a name="ln-197"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeSHRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-198"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeSHRFFlowCurve</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! curve index for sensible heat ratio modifer curve</span>
<a name="ln-199"></a>                                                       <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-200"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CoolingAndDischargeSHRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-201"></a>  <span class="c">! Charge Only Mode</span>
<a name="ln-202"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">ChargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-203"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeOnlyRatedCapacity</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! net storage charging capacity at rating conditions [W]</span>
<a name="ln-204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeOnlyRatedCapacitySizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!sizing factor for charging capacity []</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeOnlyRatedCOP</span>      <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! coefficient of performance at rating conditions [W/W]</span>
<a name="ln-206"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ChargeOnlyChargingCapFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for charging capacity modifier curve</span>
<a name="ln-207"></a>                                                   <span class="c">! function of outside drybulb and state of TES</span>
<a name="ln-208"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ChargeOnlyChargingCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!</span>
<a name="ln-209"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ChargeOnlyChargingEIRFTempCurve</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! curve index for charging energy input ratio modifier curve</span>
<a name="ln-210"></a>                                                   <span class="c">! function of outside drybulb and state of TES</span>
<a name="ln-211"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ChargeOnlyChargingEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-212"></a>  <span class="c">! Discharge Only mode</span>
<a name="ln-213"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">DischargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! gross total evaporator cooling capacity at rating conditions [W]</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeOnlyRatedDischargeCapSizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! sizing factor for cooling capacity []</span>
<a name="ln-216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeOnlyRatedSHR</span>          <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! sensible heat ratio (sens cap/total cap) at rating conditions</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeOnlyRatedCOP</span>          <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! coefficient of performance at rating conditions for discharging [W/W]</span>
<a name="ln-218"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyCapFTempCurve</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for total cooling capacity modifier curve</span>
<a name="ln-219"></a>                                                     <span class="c">! function of entering wetbulb and state of TES</span>
<a name="ln-220"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyCapFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-221"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyCapFFlowCurve</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for tot cooling capacity modifier curve</span>
<a name="ln-222"></a>                                                     <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-223"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyCapFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-224"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyEIRFTempCurve</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for energy input ratio modifier curve</span>
<a name="ln-225"></a>                                                     <span class="c">! function of entering wetbulb and state of TES</span>
<a name="ln-226"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyEIRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-227"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyEIRFFlowCurve</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for energy input ratio modifier curve</span>
<a name="ln-228"></a>                                                     <span class="c">! (function of actual supply air flow vs rated air flow)</span>
<a name="ln-229"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyEIRFFlowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-230"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyPLFFPLRCurve</span>      <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for part-load fact vs evaporator part load ratio</span>
<a name="ln-231"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlyPLFFPLRObjectNum</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-232"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlySHRFTempCurve</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for sensible heat ratio modifier curve</span>
<a name="ln-233"></a>                                                     <span class="c">! (function of entering wetbulb and drybulb)</span>
<a name="ln-234"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlySHRFTempObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-235"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlySHRFFLowCurve</span>     <span class="o">=</span> <span class="mi">0</span>    <span class="c">! curve index for</span>
<a name="ln-236"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DischargeOnlySHRFFLowObjectNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-237"></a>  <span class="c">! other inputs</span>
<a name="ln-238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AncillaryControlsPower</span>         <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! standby and controls electric power, draws when available [W]</span>
<a name="ln-239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ColdWeatherMinimumTempLimit</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! temperature limit for cold weather operation mode [C]</span>
<a name="ln-240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ColdWeatherAncillaryPower</span>      <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! electrical power draw during cold weather [W]</span>
<a name="ln-241"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondAirInletNodeNum</span>            <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Condenser air inlet node num pointer</span>
<a name="ln-242"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondAirOutletNodeNum</span>           <span class="o">=</span> <span class="mi">0</span>    <span class="c">! condenser air outlet node num pointer</span>
<a name="ln-243"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondenserType</span>                  <span class="o">=</span> <span class="n">AirCooled</span> <span class="c">! Type of condenser for DX cooling coil: AIR COOLED or EVAP COOLED</span>
<a name="ln-244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondenserAirVolumeFlow</span>         <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! design air flow rate thru condenser [m3/s]</span>
<a name="ln-245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondenserAirFlowSizingFactor</span>   <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! scale condenser air flow relative to evap air flow when autosizing</span>
<a name="ln-246"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondenserAirMassFlow</span>           <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! design air flow rate thru condenser [kg/s]</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondEffect</span>                 <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! effectiveness of the evaporatively cooled condenser</span>
<a name="ln-248"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>                  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! air temperature drybulb entering condenser section after evap cooling [C]</span>
<a name="ln-249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecNomPower</span>       <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Nominal power input to the evap condenser water circulation pump [W]</span>
<a name="ln-250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecEnergy</span>         <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Electric energy used by condenser water circulation pump [J]</span>
<a name="ln-251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterPowerFTempDiff</span>      <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! Basin heater power for evaporatively cooled condensers [W/K]</span>
<a name="ln-252"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">BasinHeaterAvailSchedNum</span>       <span class="o">=</span> <span class="mi">0</span>     <span class="c">! basin heater availability schedule pointer num</span>
<a name="ln-253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BasinHeaterSetpointTemp</span>        <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evap water basin temperature setpoint [C]</span>
<a name="ln-254"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EvapWaterSupplyMode</span>            <span class="o">=</span> <span class="n">WaterSupplyFromMains</span> <span class="c">!  where does evap water come from</span>
<a name="ln-255"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EvapWaterSupTankID</span>             <span class="o">=</span> <span class="mi">0</span> <span class="c">! supply tank index, if any</span>
<a name="ln-257"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EvapWaterTankDemandARRID</span>       <span class="o">=</span> <span class="mi">0</span> <span class="c">! evap water demand array index</span>
<a name="ln-258"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondensateCollectMode</span>          <span class="o">=</span> <span class="n">CondensateDiscarded</span> <span class="c">!  where does condensate  water go to</span>
<a name="ln-259"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! name of water source e.g. water storage tank</span>
<a name="ln-260"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondensateTankID</span>               <span class="o">=</span> <span class="mi">0</span>
<a name="ln-261"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CondensateTankSupplyARRID</span>      <span class="o">=</span> <span class="mi">0</span>
<a name="ln-262"></a>
<a name="ln-263"></a>  <span class="c">! TES tank</span>
<a name="ln-264"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">StorageMedia</span>         <span class="o">=</span> <span class="mi">0</span> <span class="c">! water/fluid or ice based TES</span>
<a name="ln-265"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StorageFluidName</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="c">! if user defined, name of fluid type</span>
<a name="ln-266"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">StorageFluidIndex</span>     <span class="o">=</span> <span class="mi">0</span> <span class="c">! if user defined, index of fluid type</span>
<a name="ln-267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidStorageVolume</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! volume of water in storage tank for water systems [m3/s]</span>
<a name="ln-268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceStorageCapacity</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! capacity of storage in J</span>
<a name="ln-269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StorageCapacitySizingFactor</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! storage time used to autocalculate capacity [hr]</span>
<a name="ln-270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinimumFluidTankTempLimit</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! optional inputs [C]</span>
<a name="ln-271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MaximumFluidTankTempLimit</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.d0</span>  <span class="c">! optional inputs [C]</span>
<a name="ln-272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RatedFluidTankTemp</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! rating point condition for fluid storage tanks [C]</span>
<a name="ln-273"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">StorageAmbientNodeNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! node &quot;pointer&quot; for ambient conditions exposed to TES</span>
<a name="ln-274"></a>
<a name="ln-275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StorageUA</span>           <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! overall heat transfer coefficient for TES to ambient [W/k]</span>
<a name="ln-276"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TESPlantConnectionAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-277"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TESPlantInletNodeNum</span>         <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop inlet node index</span>
<a name="ln-278"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TESPlantOutletNodeNum</span>        <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop outlet node index</span>
<a name="ln-279"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TESPlantLoopNum</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop connection index</span>
<a name="ln-280"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TESPlantLoopSideNum</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop side connection index</span>
<a name="ln-281"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TESPlantBranchNum</span>            <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop branch connection index</span>
<a name="ln-282"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TESPlantCompNum</span>              <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop component connection index</span>
<a name="ln-283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESPlantDesignVolumeFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! plant connection design mass flow rate [m3/s]</span>
<a name="ln-284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESPlantDesignMassFlowRate</span>   <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! [kg/s]</span>
<a name="ln-285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESPlantEffectiveness</span>       <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">!</span>
<a name="ln-286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TimeElapsed</span>  <span class="o">=</span><span class="mf">0.d0</span> <span class="c">!</span>
<a name="ln-287"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! state of storage for current time step [0..1.0]</span>
<a name="ln-288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IceFracRemainLastTimestep</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! state of storage for previous time step [0..1.0]</span>
<a name="ln-289"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidTankTempFinal</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-290"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FluidTankTempFinalLastTimestep</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-291"></a>
<a name="ln-292"></a>  <span class="c">! dynamic calculated data</span>
<a name="ln-293"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotPlant</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! heat exchange rate for plant connection to TES tank [W]</span>
<a name="ln-294"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Q_Plant</span>    <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">!  heat exchange energy for plant connection to TES tank [J]</span>
<a name="ln-295"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotAmbient</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! heat exchange rate for skin losses/gains for TES tank to surroundings [W]</span>
<a name="ln-296"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Q_Ambient</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! heat exchange enegy for skin losses/gains for TES tank to surroundings [J]</span>
<a name="ln-297"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotTES</span>  <span class="o">=</span> <span class="mf">0.d0</span>    <span class="c">! heat exchange rate by mechanical systems to charge or discharge TES [W]</span>
<a name="ln-298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Q_TES</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! heat exchange energy by mechanical systems to charge or discharge TES [J]</span>
<a name="ln-299"></a>
<a name="ln-300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingPower</span>       <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric power for cooling [W]</span>
<a name="ln-301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingEnergy</span>      <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric energy for cooling [J], metered</span>
<a name="ln-302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCoolingRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evaporator coil total cooling rate [W]</span>
<a name="ln-303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCoolingEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evaporatory coil total cooling energy [J], metered</span>
<a name="ln-304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapSensCoolingRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapSensCoolingEnergy</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapLatCoolingRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapLatCoolingEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFraction</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondenserRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!</span>
<a name="ln-310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectColdWeatherPower</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric power for cold weather protection [W]</span>
<a name="ln-311"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectColdWeatherEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric energy for cold weather protection [J], metered</span>
<a name="ln-312"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectEvapCondBasinHeaterPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-313"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElectEvapCondBasinHeaterEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-314"></a>
<a name="ln-315"></a>
<a name="ln-316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterConsumpRate</span>   <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Evap Water Consumption rate in m3/sec</span>
<a name="ln-317"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterConsump</span>       <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Evap Water Consumption in m3</span>
<a name="ln-318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterStarvMakupRate</span><span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Evap water consumed but not really available from tank m3/s</span>
<a name="ln-319"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapWaterStarvMakup</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! Evap water consumed but not really available from tank m3</span>
<a name="ln-320"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecPower</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-321"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-322"></a>
<a name="ln-323"></a><span class="n">ENDTYPE</span>
<a name="ln-324"></a>
<a name="ln-325"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-326"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">PackagedTESCoolingCoilStruct</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">TESCoil</span>
<a name="ln-327"></a>
<a name="ln-328"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumTESCoils</span>
<a name="ln-329"></a><span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-330"></a><span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">GetTESInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-331"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE &lt;module_name&gt;:</span>
<a name="ln-332"></a>
<a name="ln-333"></a><span class="k">PUBLIC </span><span class="n">SimTESCoil</span>
<a name="ln-334"></a>
<a name="ln-335"></a><span class="k">PRIVATE </span><span class="n">GetTESCoilInput</span>
<a name="ln-336"></a><span class="k">PRIVATE </span><span class="n">InitTESCoil</span>
<a name="ln-337"></a><span class="k">PRIVATE </span><span class="n">SizeTESCoil</span>
<a name="ln-338"></a><span class="k">PRIVATE </span><span class="n">CalcTESCoilOffMode</span>
<a name="ln-339"></a><span class="k">PUBLIC  </span><span class="n">CalcTESCoilCoolingOnlyMode</span>
<a name="ln-340"></a><span class="k">PUBLIC  </span><span class="n">CalcTESCoilCoolingAndChargeMode</span>
<a name="ln-341"></a><span class="k">PUBLIC  </span><span class="n">CalcTESCoilCoolingAndDischargeMode</span>
<a name="ln-342"></a><span class="k">PUBLIC  </span><span class="n">CalcTESCoilDischargeOnlyMode</span>
<a name="ln-343"></a><span class="k">PRIVATE </span><span class="n">CalcTESCoilChargeOnlyMode</span>
<a name="ln-344"></a><span class="k">PRIVATE </span><span class="n">UpdateTEStorage</span>
<a name="ln-345"></a><span class="k">PRIVATE </span><span class="n">UpdateColdWeatherProtection</span>
<a name="ln-346"></a><span class="k">PRIVATE </span><span class="n">CalcTESWaterStorageTank</span>
<a name="ln-347"></a><span class="k">PRIVATE </span><span class="n">CalcTESIceStorageTank</span>
<a name="ln-348"></a><span class="k">PRIVATE </span><span class="n">UpdateEvaporativeCondenserWaterUse</span>
<a name="ln-349"></a><span class="k">PUBLIC  </span><span class="n">GetTESCoilIndex</span>
<a name="ln-350"></a>
<a name="ln-351"></a><span class="k">CONTAINS</span>
<a name="ln-352"></a>
<a name="ln-353"></a><span class="k">SUBROUTINE </span><span class="n">SimTESCoil</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span>  <span class="n">CompIndex</span><span class="p">,</span>  <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">TESOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-354"></a>
<a name="ln-355"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-356"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-357"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-358"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-359"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-360"></a>
<a name="ln-361"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-362"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-363"></a>
<a name="ln-364"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-365"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-366"></a>
<a name="ln-367"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-368"></a>          <span class="c">! na</span>
<a name="ln-369"></a>
<a name="ln-370"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-371"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-372"></a>  <span class="k">USE </span><span class="n">General</span> <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-373"></a>
<a name="ln-374"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-375"></a>
<a name="ln-376"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-377"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CompName</span>            <span class="c">! name of the fan coil unit</span>
<a name="ln-378"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompIndex</span>
<a name="ln-379"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FanOpMode</span>  <span class="c">! allows parent object to control fan mode</span>
<a name="ln-380"></a>  <span class="kt">INTEGER</span>         <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">TESOpMode</span>
<a name="ln-381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>       <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>       <span class="c">! part load ratio (for single speed cycling unit)</span>
<a name="ln-382"></a>
<a name="ln-383"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-384"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-385"></a>
<a name="ln-386"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-387"></a>          <span class="c">! na</span>
<a name="ln-388"></a>
<a name="ln-389"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-390"></a>          <span class="c">! na</span>
<a name="ln-391"></a>
<a name="ln-392"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-393"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-394"></a>
<a name="ln-395"></a>
<a name="ln-396"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetTESInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-397"></a><span class="k">    CALL </span><span class="n">GetTESCoilInput</span>
<a name="ln-398"></a>    <span class="n">GetTESInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-399"></a>  <span class="n">ENDIF</span>
<a name="ln-400"></a>
<a name="ln-401"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-402"></a><span class="k">    </span><span class="n">TESCoilNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">CompName</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumTESCoils</span><span class="p">)</span>
<a name="ln-403"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoilNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-404"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Thermal Energy Storage Cooling Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-405"></a>    <span class="n">ENDIF</span>
<a name="ln-406"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">TESCoilNum</span>
<a name="ln-407"></a>  <span class="k">ELSE</span>
<a name="ln-408"></a><span class="k">    </span><span class="n">TESCoilNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-409"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoilNum</span> <span class="o">&gt;</span> <span class="n">NumTESCoils</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">TESCoilNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-410"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimTESCoil: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-411"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-412"></a>                          <span class="s1">&#39;, Number of Thermal Energy Storage Cooling Coil Coils=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-413"></a>                          <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">))</span>
<a name="ln-414"></a>    <span class="n">ENDIF</span>
<a name="ln-415"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-416"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CompName</span> <span class="o">/=</span> <span class="n">Blank</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompName</span> <span class="o">/=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-417"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimTESCoil: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-418"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-419"></a>                            <span class="s1">&#39;, Coil name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CompName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Coil Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-420"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-421"></a>      <span class="n">ENDIF</span>
<a name="ln-422"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-423"></a>    <span class="n">ENDIF</span>
<a name="ln-424"></a>  <span class="n">ENDIF</span>
<a name="ln-425"></a>
<a name="ln-426"></a>  <span class="n">TESOpMode</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-427"></a>
<a name="ln-428"></a>  <span class="k">CALL </span><span class="n">InitTESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-429"></a>
<a name="ln-430"></a>  <span class="n">TESOpMode</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span>
<a name="ln-431"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TESOpMode</span><span class="p">)</span>
<a name="ln-432"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">OffMode</span><span class="p">)</span>
<a name="ln-433"></a>    <span class="k">CALL </span><span class="n">CalcTESCoilOffMode</span><span class="p">(</span> <span class="n">TESCoilNum</span> <span class="p">)</span>
<a name="ln-434"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingOnlyMode</span><span class="p">)</span>
<a name="ln-435"></a>    <span class="k">CALL </span><span class="n">CalcTESCoilCoolingOnlyMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-436"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingAndChargeMode</span><span class="p">)</span>
<a name="ln-437"></a>    <span class="k">CALL </span><span class="n">CalcTESCoilCoolingAndChargeMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-438"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">CoolingAndDischargeMode</span><span class="p">)</span>
<a name="ln-439"></a>    <span class="k">CALL </span><span class="n">CalcTESCoilCoolingAndDischargeMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-440"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">ChargeOnlyMode</span><span class="p">)</span>
<a name="ln-441"></a>    <span class="k">CALL </span><span class="n">CalcTESCoilChargeOnlyMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-442"></a>  <span class="k">CASE</span> <span class="p">(</span><span class="n">DischargeOnlyMode</span><span class="p">)</span>
<a name="ln-443"></a>    <span class="k">CALL </span><span class="n">CalcTESCoilDischargeOnlyMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-444"></a>  <span class="k">END SELECT</span>
<a name="ln-445"></a>
<a name="ln-446"></a><span class="k">  RETURN</span>
<a name="ln-447"></a>
<a name="ln-448"></a><span class="k">END SUBROUTINE </span><span class="n">SimTESCoil</span>
<a name="ln-449"></a>
<a name="ln-450"></a>
<a name="ln-451"></a>
<a name="ln-452"></a><span class="k">SUBROUTINE </span><span class="n">GetTESCoilInput</span>
<a name="ln-453"></a>
<a name="ln-454"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-455"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-456"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-457"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-458"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-459"></a>
<a name="ln-460"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-461"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-462"></a>
<a name="ln-463"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-464"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-465"></a>
<a name="ln-466"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-467"></a>          <span class="c">! na</span>
<a name="ln-468"></a>
<a name="ln-469"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-470"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-471"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">GetObjectItemNum</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span><span class="n">GetObjectDefMaxArgs</span>
<a name="ln-472"></a>  <span class="k">USE </span><span class="n">WaterManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetupTankDemandComponent</span><span class="p">,</span> <span class="n">SetupTankSupplyComponent</span>
<a name="ln-473"></a>  <span class="k">USE </span><span class="n">GlobalNames</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">VerifyUniqueCoilName</span>
<a name="ln-474"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-475"></a>  <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-476"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetScheduleIndex</span>
<a name="ln-477"></a>  <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-478"></a>  <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TestCompSet</span>
<a name="ln-479"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckFluidPropertyName</span><span class="p">,</span> <span class="n">FindGlycol</span><span class="p">,</span> <span class="n">GetFluidDensityTemperatureLimits</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-480"></a>                                   <span class="n">GetFluidSpecificHeatTemperatureLimits</span>
<a name="ln-481"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindControlledZoneIndexFromSystemNodeNumberForZone</span>
<a name="ln-482"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">IntGainTypeOf_PackagedTESCoilTank</span>
<a name="ln-483"></a>
<a name="ln-484"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-485"></a>
<a name="ln-486"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-487"></a>          <span class="c">! na</span>
<a name="ln-488"></a>
<a name="ln-489"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-490"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;GetTESCoilInput: &#39;</span> <span class="c">! include trailing blank space</span>
<a name="ln-491"></a>
<a name="ln-492"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-493"></a>          <span class="c">! na</span>
<a name="ln-494"></a>
<a name="ln-495"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-496"></a>          <span class="c">! na</span>
<a name="ln-497"></a>
<a name="ln-498"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-499"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">item</span>  <span class="c">! do loop counter</span>
<a name="ln-500"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>            <span class="c">! Number of alphas in input</span>
<a name="ln-501"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>           <span class="c">! Number of numeric items in input</span>
<a name="ln-502"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>             <span class="c">! Input status returned from GetObjectItem</span>
<a name="ln-503"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>              <span class="c">! Flag to verify name</span>
<a name="ln-504"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>              <span class="c">! Flag for blank name</span>
<a name="ln-505"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! Set to true if errors in input, fatal at end of routine</span>
<a name="ln-506"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-507"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TminRho</span>
<a name="ln-508"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TmaxRho</span>
<a name="ln-509"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TminCp</span>
<a name="ln-510"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TmaxCp</span>
<a name="ln-511"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ZoneIndexTrial</span>
<a name="ln-512"></a>
<a name="ln-513"></a>
<a name="ln-514"></a>  <span class="n">cCurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span>
<a name="ln-515"></a>  <span class="n">NumTESCoils</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-516"></a>
<a name="ln-517"></a>  <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">TESCoil</span> <span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span>
<a name="ln-518"></a>  <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span>
<a name="ln-519"></a>  <span class="n">CheckEquipName</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-520"></a>
<a name="ln-521"></a>
<a name="ln-522"></a>  <span class="k">DO </span><span class="n">item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTESCoils</span>
<a name="ln-523"></a>    <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">,</span> <span class="n">NumAlphas</span><span class="p">,</span> <span class="n">rNumericArgs</span><span class="p">,</span> <span class="n">NumNumbers</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-524"></a>                       <span class="n">IOStatus</span><span class="p">,</span> <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span> <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-525"></a>                       <span class="n">AlphaFieldNames</span><span class="o">=</span> <span class="n">cAlphaFieldNames</span>  <span class="p">,</span> <span class="n">NumericFieldNames</span><span class="o">=</span> <span class="n">cNumericFieldNames</span> <span class="p">)</span>
<a name="ln-526"></a>    <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-527"></a>    <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-528"></a>    <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">TESCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span> <span class="n">item</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IsNotOK</span><span class="p">,</span> <span class="n">IsBlank</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-529"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-530"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-531"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-532"></a>    <span class="n">ENDIF</span>
<a name="ln-533"></a>    <span class="k">CALL </span><span class="n">VerifyUniqueCoilName</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">errflag</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-534"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">errflag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-535"></a><span class="k">      </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-536"></a>    <span class="n">ENDIF</span>
<a name="ln-537"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-538"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-539"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-540"></a>    <span class="k">ELSE</span>
<a name="ln-541"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-542"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">AvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-543"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-544"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-545"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-546"></a>      <span class="n">ENDIF</span>
<a name="ln-547"></a>    <span class="n">ENDIF</span>
<a name="ln-548"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-549"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;SCHEDULEDMODES&#39;</span><span class="p">)</span>
<a name="ln-550"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ModeControlType</span> <span class="o">=</span> <span class="n">ScheduledOpModes</span>
<a name="ln-551"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;EMSCONTROLLED&#39;</span><span class="p">)</span>
<a name="ln-552"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ModeControlType</span> <span class="o">=</span> <span class="n">EMSActuatedOpModes</span>
<a name="ln-553"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-554"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-555"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-556"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are ScheduledModes or EMSControlled&#39;</span><span class="p">)</span>
<a name="ln-557"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-558"></a>    <span class="k">END SELECT</span>
<a name="ln-559"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-560"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ModeControlType</span> <span class="o">==</span> <span class="n">ScheduledOpModes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-561"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-562"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is blank but a schedule is needed&#39;</span><span class="p">)</span>
<a name="ln-563"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-564"></a>      <span class="n">ENDIF</span>
<a name="ln-565"></a>    <span class="k">ELSE</span>
<a name="ln-566"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ControlModeSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-567"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ControlModeSchedNum</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ModeControlType</span> <span class="o">==</span> <span class="n">ScheduledOpModes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-568"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-569"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-570"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-571"></a>      <span class="n">ENDIF</span>
<a name="ln-572"></a>    <span class="n">ENDIF</span>
<a name="ln-573"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-574"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;ICE&#39;</span><span class="p">)</span>
<a name="ln-575"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">=</span> <span class="n">IceBased</span>
<a name="ln-576"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span>
<a name="ln-577"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">=</span> <span class="n">FluidBased</span>
<a name="ln-578"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidName</span> <span class="o">=</span> <span class="s1">&#39;WATER&#39;</span>
<a name="ln-579"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span> <span class="o">=</span> <span class="n">FindGlycol</span><span class="p">(</span><span class="s1">&#39;WATER&#39;</span><span class="p">)</span>
<a name="ln-580"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;USERDEFINEDFLUIDTYPE&#39;</span> <span class="p">)</span>
<a name="ln-581"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">=</span> <span class="n">FluidBased</span>
<a name="ln-582"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-583"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-584"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-585"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are Ice, Water, or UserDefindedFluidType&#39;</span><span class="p">)</span>
<a name="ln-586"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-587"></a>    <span class="k">END SELECT</span>
<a name="ln-588"></a>
<a name="ln-589"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;USERDEFINEDFLUIDTYPE&#39;</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-590"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-591"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-592"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CheckFluidPropertyName</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-593"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, missing fluid data&#39;</span><span class="p">)</span>
<a name="ln-594"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check that fluid property data have been input for fluid name = &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-595"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-596"></a>        <span class="k">ELSE</span>
<a name="ln-597"></a><span class="k">          </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span> <span class="o">=</span> <span class="n">FindGlycol</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-598"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-599"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid fluid data&#39;</span><span class="p">)</span>
<a name="ln-600"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check that correct fluid property data have been input for fluid name = &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-601"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-602"></a>          <span class="n">ENDIF</span>
<a name="ln-603"></a>        <span class="n">ENDIF</span>
<a name="ln-604"></a>
<a name="ln-605"></a>      <span class="k">ELSE</span>
<a name="ln-606"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-607"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Storage Type is set to UserDefinedFluidType but no name of fluid was entered.&#39;</span> <span class="p">)</span>
<a name="ln-608"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-609"></a>      <span class="n">ENDIF</span>
<a name="ln-610"></a>
<a name="ln-611"></a>
<a name="ln-612"></a>    <span class="n">ENDIF</span>
<a name="ln-613"></a>
<a name="ln-614"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-615"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">FluidStorageVolume</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-616"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-617"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-618"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank for Water storage type&#39;</span><span class="p">)</span>
<a name="ln-619"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Enter fluid storage tank volume in m3/s.&#39;</span><span class="p">)</span>
<a name="ln-620"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-621"></a>    <span class="n">ENDIF</span>
<a name="ln-622"></a>
<a name="ln-623"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-624"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-625"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-626"></a>      <span class="k">ELSE</span>
<a name="ln-627"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.d+09</span> <span class="c">! input in giga joules, used as joules internally</span>
<a name="ln-628"></a>      <span class="n">ENDIF</span>
<a name="ln-629"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-630"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-631"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank for Ice storage type&#39;</span><span class="p">)</span>
<a name="ln-632"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Enter ice storage tank capacity in GJ.&#39;</span><span class="p">)</span>
<a name="ln-633"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-634"></a>    <span class="n">ENDIF</span>
<a name="ln-635"></a>
<a name="ln-636"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageCapacitySizingFactor</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-637"></a>
<a name="ln-638"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageAmbientNodeNum</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-639"></a>                                           <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">NodeType_Air</span><span class="p">,</span> <span class="n">NodeConnectionType_Sensor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-640"></a>                                          <span class="mi">1</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-641"></a>
<a name="ln-642"></a>    <span class="n">ZoneIndexTrial</span> <span class="o">=</span> <span class="n">FindControlledZoneIndexFromSystemNodeNumberForZone</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageAmbientNodeNum</span><span class="p">)</span>
<a name="ln-643"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneIndexTrial</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! tank is inside a zone so setup internal gains</span>
<a name="ln-644"></a>      <span class="k">CALL </span><span class="n">SetupZoneInternalGain</span><span class="p">(</span><span class="n">ZoneIndexTrial</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-645"></a>            <span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-646"></a>            <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>                           <span class="p">&amp;</span>
<a name="ln-647"></a>            <span class="n">IntGainTypeOf_PackagedTESCoilTank</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-648"></a>            <span class="n">ConvectionGainRate</span>    <span class="o">=</span>   <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="p">)</span>
<a name="ln-649"></a>    <span class="n">ENDIF</span>
<a name="ln-650"></a>
<a name="ln-651"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageUA</span>               <span class="o">=</span>  <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-652"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">RatedFluidTankTemp</span>      <span class="o">=</span>  <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-653"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">=</span>  <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-654"></a>
<a name="ln-655"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-656"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-657"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-658"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-659"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-660"></a>               <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-661"></a>    <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-662"></a>
<a name="ln-663"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-664"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-665"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyModeIsAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-666"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-667"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyModeIsAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-668"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-669"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyModeIsAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-670"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-671"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-672"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-673"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-674"></a>    <span class="k">END SELECT</span>
<a name="ln-675"></a>
<a name="ln-676"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-677"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyModeIsAvailable</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! get input data for this mode</span>
<a name="ln-678"></a>
<a name="ln-679"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyRatedSHR</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-680"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyRatedCOP</span>    <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-681"></a>
<a name="ln-682"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-683"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-684"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-685"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-686"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-687"></a>        <span class="k">ELSE</span>
<a name="ln-688"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-689"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-690"></a>        <span class="n">ENDIF</span>
<a name="ln-691"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-692"></a>      <span class="k">ELSE</span>
<a name="ln-693"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-694"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-695"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-696"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span><span class="p">)</span>
<a name="ln-697"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-698"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-699"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-700"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-701"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-702"></a>        <span class="k">END SELECT</span>
<a name="ln-703"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-704"></a>
<a name="ln-705"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-706"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-707"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-708"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-709"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-710"></a>        <span class="k">ELSE</span>
<a name="ln-711"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-712"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-713"></a>        <span class="n">ENDIF</span>
<a name="ln-714"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-715"></a>      <span class="k">ELSE</span>
<a name="ln-716"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-717"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-718"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-719"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-720"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-721"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-722"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowCurve</span><span class="p">)</span>
<a name="ln-723"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-724"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-725"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-726"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-727"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-728"></a>        <span class="k">END SELECT</span>
<a name="ln-729"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-730"></a>
<a name="ln-731"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-732"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-733"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-734"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-735"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-736"></a>        <span class="k">ELSE</span>
<a name="ln-737"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-738"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-739"></a>        <span class="n">ENDIF</span>
<a name="ln-740"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-741"></a>      <span class="k">ELSE</span>
<a name="ln-742"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-743"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-744"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-745"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFTempObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFTempCurve</span><span class="p">)</span>
<a name="ln-746"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-747"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-748"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-749"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-750"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-751"></a>        <span class="k">END SELECT</span>
<a name="ln-752"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-753"></a>
<a name="ln-754"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-755"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-756"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-757"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-758"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-759"></a>        <span class="k">ELSE</span>
<a name="ln-760"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-761"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-762"></a>        <span class="n">ENDIF</span>
<a name="ln-763"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-764"></a>      <span class="k">ELSE</span>
<a name="ln-765"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-766"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-767"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-768"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-769"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-770"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-771"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFFlowObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFFlowCurve</span><span class="p">)</span>
<a name="ln-772"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-773"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-774"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-775"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-776"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-777"></a>        <span class="k">END SELECT</span>
<a name="ln-778"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-779"></a>
<a name="ln-780"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyPLFFPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-781"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyPLFFPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-782"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-783"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-784"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-785"></a>        <span class="k">ELSE</span>
<a name="ln-786"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-787"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-788"></a>        <span class="n">ENDIF</span>
<a name="ln-789"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-790"></a>      <span class="k">ELSE</span>
<a name="ln-791"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-792"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyPLFFPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-793"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-794"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-795"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-796"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-797"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyPLFFPLRObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlyPLFFPLRCurve</span><span class="p">)</span>
<a name="ln-798"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-799"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-800"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-801"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-802"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-803"></a>        <span class="k">END SELECT</span>
<a name="ln-804"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-805"></a>
<a name="ln-806"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-807"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-808"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-809"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-810"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-811"></a>        <span class="k">ELSE</span>
<a name="ln-812"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-813"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-814"></a>        <span class="n">ENDIF</span>
<a name="ln-815"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-816"></a>      <span class="k">ELSE</span>
<a name="ln-817"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-818"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-819"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-820"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFTempObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFTempCurve</span><span class="p">)</span>
<a name="ln-821"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-822"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-823"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-824"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-825"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-826"></a>        <span class="k">END SELECT</span>
<a name="ln-827"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-828"></a>
<a name="ln-829"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-830"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-831"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-832"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-833"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-834"></a>        <span class="k">ELSE</span>
<a name="ln-835"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-836"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-837"></a>        <span class="n">ENDIF</span>
<a name="ln-838"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-839"></a>      <span class="k">ELSE</span>
<a name="ln-840"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-841"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-842"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-843"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-844"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-845"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-846"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFFlowObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingOnlySHRFFlowCurve</span><span class="p">)</span>
<a name="ln-847"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-848"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-849"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-850"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-851"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-852"></a>        <span class="k">END SELECT</span>
<a name="ln-853"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-854"></a>
<a name="ln-855"></a>    <span class="n">ENDIF</span>
<a name="ln-856"></a>
<a name="ln-857"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span>
<a name="ln-858"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-859"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-860"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-861"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-862"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-863"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-864"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-865"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-866"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-867"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-868"></a>    <span class="k">END SELECT</span>
<a name="ln-869"></a>
<a name="ln-870"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-871"></a>
<a name="ln-872"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCap</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c">! gross total evaporator cooling capacity [W]</span>
<a name="ln-873"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCapSizingFactor</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c">!sizing factor for gross total evaporator [ ]</span>
<a name="ln-874"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCap</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c">!net storage charging capacity at rating conditions [W]</span>
<a name="ln-875"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCapSizingFactor</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="c">!sizing factor for charging capacity [ ]</span>
<a name="ln-876"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedSHR</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="c">! Sensible heat ratio (sens cap/total cap)  [W/W]</span>
<a name="ln-877"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingRatedCOP</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="c">! Coefficient of performance , for cooling [W/W]</span>
<a name="ln-878"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingRatedCOP</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="c">! Coefficient of performance , for charging [W/W]</span>
<a name="ln-879"></a>
<a name="ln-880"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-881"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-882"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-883"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-884"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-885"></a>        <span class="k">ELSE</span>
<a name="ln-886"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-887"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-888"></a>        <span class="n">ENDIF</span>
<a name="ln-889"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-890"></a>      <span class="k">ELSE</span>
<a name="ln-891"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-892"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-893"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-894"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-895"></a>                                   <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempCurve</span><span class="p">)</span>
<a name="ln-896"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-897"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-898"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-899"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-900"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-901"></a>        <span class="k">END SELECT</span>
<a name="ln-902"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-903"></a>
<a name="ln-904"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-905"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-906"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-907"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-908"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-909"></a>        <span class="k">ELSE</span>
<a name="ln-910"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-911"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-912"></a>        <span class="n">ENDIF</span>
<a name="ln-913"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-914"></a>      <span class="k">ELSE</span>
<a name="ln-915"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-916"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-917"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-918"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-919"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-920"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-921"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-922"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowCurve</span><span class="p">)</span>
<a name="ln-923"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-924"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-925"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-926"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-927"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-928"></a>        <span class="k">END SELECT</span>
<a name="ln-929"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-930"></a>
<a name="ln-931"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-932"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-933"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-934"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-935"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-936"></a>        <span class="k">ELSE</span>
<a name="ln-937"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-938"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-939"></a>        <span class="n">ENDIF</span>
<a name="ln-940"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-941"></a>      <span class="k">ELSE</span>
<a name="ln-942"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-943"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-944"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-945"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-946"></a>                         <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempCurve</span><span class="p">)</span>
<a name="ln-947"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-948"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-949"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-950"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-951"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-952"></a>        <span class="k">END SELECT</span>
<a name="ln-953"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-954"></a>
<a name="ln-955"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-956"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-957"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-958"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-959"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-960"></a>        <span class="k">ELSE</span>
<a name="ln-961"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-962"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-963"></a>        <span class="n">ENDIF</span>
<a name="ln-964"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-965"></a>      <span class="k">ELSE</span>
<a name="ln-966"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-967"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-968"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-969"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-970"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-971"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-972"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-973"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFFlowCurve</span><span class="p">)</span>
<a name="ln-974"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-975"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-976"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-977"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-978"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-979"></a>        <span class="k">END SELECT</span>
<a name="ln-980"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-981"></a>
<a name="ln-982"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingPLFFPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-983"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingPLFFPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-984"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-985"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-986"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-987"></a>        <span class="k">ELSE</span>
<a name="ln-988"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-989"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-990"></a>        <span class="n">ENDIF</span>
<a name="ln-991"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-992"></a>      <span class="k">ELSE</span>
<a name="ln-993"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-994"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingPLFFPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-995"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-996"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-997"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-998"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-999"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1000"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingPLFFPLRCurve</span><span class="p">)</span>
<a name="ln-1001"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1002"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1003"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1004"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1005"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1006"></a>        <span class="k">END SELECT</span>
<a name="ln-1007"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1008"></a>
<a name="ln-1009"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1010"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1011"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1012"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1013"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1014"></a>        <span class="k">ELSE</span>
<a name="ln-1015"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1016"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1017"></a>        <span class="n">ENDIF</span>
<a name="ln-1018"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1019"></a>      <span class="k">ELSE</span>
<a name="ln-1020"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1021"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1022"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1023"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1024"></a>                                  <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFTempCurve</span><span class="p">)</span>
<a name="ln-1025"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1026"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1027"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1028"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-1029"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1030"></a>        <span class="k">END SELECT</span>
<a name="ln-1031"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1032"></a>
<a name="ln-1033"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1034"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1035"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1036"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1037"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1038"></a>        <span class="k">ELSE</span>
<a name="ln-1039"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1040"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1041"></a>        <span class="n">ENDIF</span>
<a name="ln-1042"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1043"></a>      <span class="k">ELSE</span>
<a name="ln-1044"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1045"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1046"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1047"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1048"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1049"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1050"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1051"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span><span class="p">)</span>
<a name="ln-1052"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1053"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1054"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1055"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1056"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1057"></a>        <span class="k">END SELECT</span>
<a name="ln-1058"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1061"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1062"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1063"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1064"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1065"></a>        <span class="k">ELSE</span>
<a name="ln-1066"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1067"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1068"></a>        <span class="n">ENDIF</span>
<a name="ln-1069"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1070"></a>      <span class="k">ELSE</span>
<a name="ln-1071"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1072"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1073"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1074"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1075"></a>                                  <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempCurve</span><span class="p">)</span>
<a name="ln-1076"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1077"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1078"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1079"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-1080"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1081"></a>        <span class="k">END SELECT</span>
<a name="ln-1082"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1083"></a>
<a name="ln-1084"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1085"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1086"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1087"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1088"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1089"></a>        <span class="k">ELSE</span>
<a name="ln-1090"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1091"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1092"></a>        <span class="n">ENDIF</span>
<a name="ln-1093"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1094"></a>      <span class="k">ELSE</span>
<a name="ln-1095"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1096"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1097"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1098"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1099"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1100"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1101"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1102"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowCurve</span><span class="p">)</span>
<a name="ln-1103"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1104"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1105"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1106"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1107"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1108"></a>        <span class="k">END SELECT</span>
<a name="ln-1109"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1110"></a>
<a name="ln-1111"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingPLFFPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1112"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingPLFFPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1113"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1114"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1115"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1116"></a>        <span class="k">ELSE</span>
<a name="ln-1117"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1118"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1119"></a>        <span class="n">ENDIF</span>
<a name="ln-1120"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1121"></a>      <span class="k">ELSE</span>
<a name="ln-1122"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1123"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingPLFFPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1124"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1125"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1126"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1127"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1128"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1129"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingPLFFPLRCurve</span><span class="p">)</span>
<a name="ln-1130"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1131"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1132"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1133"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1134"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1135"></a>        <span class="k">END SELECT</span>
<a name="ln-1136"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1137"></a>
<a name="ln-1138"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1139"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1140"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1141"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1142"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1143"></a>        <span class="k">ELSE</span>
<a name="ln-1144"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1145"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1146"></a>        <span class="n">ENDIF</span>
<a name="ln-1147"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1148"></a>      <span class="k">ELSE</span>
<a name="ln-1149"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1150"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1151"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1152"></a>                 <span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1153"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempObjectNum</span> <span class="o">=</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempCurve</span><span class="p">)</span>
<a name="ln-1154"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1155"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1156"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1157"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two or three independent variables.&#39;</span><span class="p">)</span>
<a name="ln-1158"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1159"></a>        <span class="k">END SELECT</span>
<a name="ln-1160"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1161"></a>
<a name="ln-1162"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1163"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1164"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1165"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1166"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1167"></a>        <span class="k">ELSE</span>
<a name="ln-1168"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1169"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1170"></a>        <span class="n">ENDIF</span>
<a name="ln-1171"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1172"></a>      <span class="k">ELSE</span>
<a name="ln-1173"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1174"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1175"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1176"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1177"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1178"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1179"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1180"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFFlowCurve</span><span class="p">)</span>
<a name="ln-1181"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1182"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1183"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1184"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1185"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1186"></a>        <span class="k">END SELECT</span>
<a name="ln-1187"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1188"></a>
<a name="ln-1189"></a>
<a name="ln-1190"></a>    <span class="n">ENDIF</span> <span class="c">! Cooling and Charge Mode available</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<a name="ln-1193"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-1194"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1195"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-1196"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1197"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1198"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1199"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1200"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1201"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-1202"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1203"></a>    <span class="k">END SELECT</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCap</span>         <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="c">! gross total evaporator cooling capacity  [W]</span>
<a name="ln-1208"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCapSizingFactor</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="c">!sizing factor gross total cooling capacity []</span>
<a name="ln-1209"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCap</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>  <span class="c">!net storage discharging capacity  [W]</span>
<a name="ln-1210"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCapSizingFactor</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="c">!sizing factor discharging capacity []</span>
<a name="ln-1211"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedSHR</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>  <span class="c">! Sensible heat ratio (sens cap/total cap) [W/W]</span>
<a name="ln-1212"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingRatedCOP</span>     <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>  <span class="c">! Coefficient of performance , for cooling [W/W]</span>
<a name="ln-1213"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingRatedCOP</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>  <span class="c">! Coefficient of performance , for charging [W/W]</span>
<a name="ln-1214"></a>
<a name="ln-1215"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1216"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1217"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1218"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1219"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1220"></a>        <span class="k">ELSE</span>
<a name="ln-1221"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1222"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1223"></a>        <span class="n">ENDIF</span>
<a name="ln-1224"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1225"></a>      <span class="k">ELSE</span>
<a name="ln-1226"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1227"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1228"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1229"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                                   <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempCurve</span><span class="p">)</span>
<a name="ln-1231"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1232"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1233"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1234"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-1235"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1236"></a>        <span class="k">END SELECT</span>
<a name="ln-1237"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1240"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1241"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1242"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1243"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1244"></a>        <span class="k">ELSE</span>
<a name="ln-1245"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1246"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1247"></a>        <span class="n">ENDIF</span>
<a name="ln-1248"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1249"></a>      <span class="k">ELSE</span>
<a name="ln-1250"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1251"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1252"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1253"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1254"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1255"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1256"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1257"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span><span class="p">)</span>
<a name="ln-1258"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1259"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1260"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1261"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1262"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1263"></a>        <span class="k">END SELECT</span>
<a name="ln-1264"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1265"></a>
<a name="ln-1266"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1267"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1268"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1269"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1270"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1271"></a>        <span class="k">ELSE</span>
<a name="ln-1272"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1273"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1274"></a>        <span class="n">ENDIF</span>
<a name="ln-1275"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1276"></a>      <span class="k">ELSE</span>
<a name="ln-1277"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1278"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1279"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1280"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1281"></a>                                   <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFTempCurve</span><span class="p">)</span>
<a name="ln-1282"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1283"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1284"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1285"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-1286"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1287"></a>        <span class="k">END SELECT</span>
<a name="ln-1288"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1289"></a>
<a name="ln-1290"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1291"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1292"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1293"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1294"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1295"></a>        <span class="k">ELSE</span>
<a name="ln-1296"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1297"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1298"></a>        <span class="n">ENDIF</span>
<a name="ln-1299"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1300"></a>      <span class="k">ELSE</span>
<a name="ln-1301"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1302"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1303"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1304"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1305"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1306"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1307"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1308"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFFlowCurve</span><span class="p">)</span>
<a name="ln-1309"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1310"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1311"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1312"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1313"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1314"></a>        <span class="k">END SELECT</span>
<a name="ln-1315"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1316"></a>
<a name="ln-1317"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingPLFFPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1318"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingPLFFPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1319"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1320"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1321"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1322"></a>        <span class="k">ELSE</span>
<a name="ln-1323"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1324"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1325"></a>        <span class="n">ENDIF</span>
<a name="ln-1326"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1327"></a>      <span class="k">ELSE</span>
<a name="ln-1328"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1329"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingPLFFPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1330"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1331"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1332"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1333"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1334"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1335"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingPLFFPLRCurve</span><span class="p">)</span>
<a name="ln-1336"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1337"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1338"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1339"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1340"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1341"></a>        <span class="k">END SELECT</span>
<a name="ln-1342"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1343"></a>
<a name="ln-1344"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1345"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1346"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1347"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1348"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1349"></a>        <span class="k">ELSE</span>
<a name="ln-1350"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1351"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1352"></a>        <span class="n">ENDIF</span>
<a name="ln-1353"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1354"></a>      <span class="k">ELSE</span>
<a name="ln-1355"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1356"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1357"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1358"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1359"></a>                                   <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFTempCurve</span><span class="p">)</span>
<a name="ln-1360"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1361"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1362"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1363"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-1364"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1365"></a>        <span class="k">END SELECT</span>
<a name="ln-1366"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1367"></a>
<a name="ln-1368"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1369"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1370"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1371"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1372"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1373"></a>        <span class="k">ELSE</span>
<a name="ln-1374"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1375"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1376"></a>        <span class="n">ENDIF</span>
<a name="ln-1377"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1378"></a>      <span class="k">ELSE</span>
<a name="ln-1379"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1380"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1381"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1382"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1383"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1384"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1385"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1386"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFFlowCurve</span><span class="p">)</span>
<a name="ln-1387"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1388"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1389"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1390"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1391"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1392"></a>        <span class="k">END SELECT</span>
<a name="ln-1393"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1394"></a>
<a name="ln-1395"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFEvapPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1396"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFEvapPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1397"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1398"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1399"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1400"></a>        <span class="k">ELSE</span>
<a name="ln-1401"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1402"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1403"></a>        <span class="n">ENDIF</span>
<a name="ln-1404"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1405"></a>      <span class="k">ELSE</span>
<a name="ln-1406"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1407"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFEvapPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1408"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1409"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1410"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1411"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1412"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFEvapPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1413"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFEvapPLRCurve</span><span class="p">)</span>
<a name="ln-1414"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1415"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1416"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1417"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1418"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1419"></a>        <span class="k">END SELECT</span>
<a name="ln-1420"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1423"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1424"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1425"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1426"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1427"></a>        <span class="k">ELSE</span>
<a name="ln-1428"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1429"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1430"></a>        <span class="n">ENDIF</span>
<a name="ln-1431"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1432"></a>      <span class="k">ELSE</span>
<a name="ln-1433"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1434"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1435"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1436"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1437"></a>                                   <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFTempCurve</span><span class="p">)</span>
<a name="ln-1438"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1439"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1440"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1441"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with three independent variables -- x, y, and z.&#39;</span><span class="p">)</span>
<a name="ln-1442"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1443"></a>        <span class="k">END SELECT</span>
<a name="ln-1444"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFFLowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1447"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFFLowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1448"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1449"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1450"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1451"></a>        <span class="k">ELSE</span>
<a name="ln-1452"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1453"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1454"></a>        <span class="n">ENDIF</span>
<a name="ln-1455"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1456"></a>      <span class="k">ELSE</span>
<a name="ln-1457"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1458"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFFLowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1459"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1460"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1461"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1462"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1463"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFFLowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1464"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFFLowCurve</span><span class="p">)</span>
<a name="ln-1465"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1466"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1467"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1468"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1469"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1470"></a>        <span class="k">END SELECT</span>
<a name="ln-1471"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1472"></a>
<a name="ln-1473"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingPLFFPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1474"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingPLFFPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1475"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1476"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1477"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1478"></a>        <span class="k">ELSE</span>
<a name="ln-1479"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1480"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1481"></a>        <span class="n">ENDIF</span>
<a name="ln-1482"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1483"></a>      <span class="k">ELSE</span>
<a name="ln-1484"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1485"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingPLFFPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1486"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1487"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1488"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1489"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1490"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingPLFFPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1491"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingPLFFPLRCurve</span><span class="p">)</span>
<a name="ln-1492"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1493"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1494"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1495"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1496"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1497"></a>        <span class="k">END SELECT</span>
<a name="ln-1498"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1499"></a>
<a name="ln-1500"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1501"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1502"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1503"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1504"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1505"></a>        <span class="k">ELSE</span>
<a name="ln-1506"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1507"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1508"></a>        <span class="n">ENDIF</span>
<a name="ln-1509"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1510"></a>      <span class="k">ELSE</span>
<a name="ln-1511"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1512"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1513"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1514"></a>                 <span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1515"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1516"></a>                     <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempCurve</span><span class="p">)</span>
<a name="ln-1517"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1518"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1519"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1520"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two or three independent variables.&#39;</span><span class="p">)</span>
<a name="ln-1521"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1522"></a>        <span class="k">END SELECT</span>
<a name="ln-1523"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1524"></a>
<a name="ln-1525"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">44</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1526"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1527"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1528"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1529"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1530"></a>        <span class="k">ELSE</span>
<a name="ln-1531"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1532"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1533"></a>        <span class="n">ENDIF</span>
<a name="ln-1534"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1535"></a>      <span class="k">ELSE</span>
<a name="ln-1536"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1537"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1538"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1539"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1540"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1541"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1542"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1543"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFFlowCurve</span><span class="p">)</span>
<a name="ln-1544"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1545"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1546"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">44</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1547"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1548"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1549"></a>        <span class="k">END SELECT</span>
<a name="ln-1550"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>    <span class="n">ENDIF</span> <span class="c">! cooling and discharge mode available</span>
<a name="ln-1553"></a>
<a name="ln-1554"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span>
<a name="ln-1555"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-1556"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1557"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-1558"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1559"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1560"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1561"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1562"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">45</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1563"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-1564"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1565"></a>    <span class="k">END SELECT</span>
<a name="ln-1566"></a>
<a name="ln-1567"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyModeAvailable</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacity</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="c">! net storage charging capacity at rating conditions [W]</span>
<a name="ln-1570"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacitySizingFactor</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="c">!sizing factor for charging capacity []</span>
<a name="ln-1571"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCOP</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>  <span class="c">! coefficient of performance at rating conditions [W/W]</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">46</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1574"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1575"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1576"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1577"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1578"></a>        <span class="k">ELSE</span>
<a name="ln-1579"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1580"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1581"></a>        <span class="n">ENDIF</span>
<a name="ln-1582"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1583"></a>      <span class="k">ELSE</span>
<a name="ln-1584"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1585"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1586"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-1587"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingCapFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1588"></a>                     <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingCapFTempCurve</span><span class="p">)</span>
<a name="ln-1589"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1590"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1591"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">46</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1592"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-1593"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1594"></a>        <span class="k">END SELECT</span>
<a name="ln-1595"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1596"></a>
<a name="ln-1597"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1598"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1599"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1600"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1601"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1602"></a>        <span class="k">ELSE</span>
<a name="ln-1603"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1604"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1605"></a>        <span class="n">ENDIF</span>
<a name="ln-1606"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1607"></a>      <span class="k">ELSE</span>
<a name="ln-1608"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1609"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1610"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-1611"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1612"></a>                     <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ChargeOnlyChargingEIRFTempCurve</span><span class="p">)</span>
<a name="ln-1613"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1614"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1615"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">47</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1616"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-1617"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1618"></a>        <span class="k">END SELECT</span>
<a name="ln-1619"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>
<a name="ln-1622"></a>    <span class="n">ENDIF</span> <span class="c">! Charge only mode available</span>
<a name="ln-1623"></a>
<a name="ln-1624"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">48</span><span class="p">))</span>
<a name="ln-1625"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;YES&#39;</span><span class="p">)</span>
<a name="ln-1626"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1627"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;NO&#39;</span><span class="p">)</span>
<a name="ln-1628"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1629"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1630"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1631"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1632"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">48</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">48</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1633"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are Yes or No.&#39;</span><span class="p">)</span>
<a name="ln-1634"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1635"></a>    <span class="k">END SELECT</span>
<a name="ln-1636"></a>
<a name="ln-1637"></a><span class="k">    IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1638"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="c">! gross total evaporator cooling capacity  [W]</span>
<a name="ln-1639"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCapSizingFactor</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="c">! sizing factor for cooling capacity []</span>
<a name="ln-1640"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyRatedSHR</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span><span class="c">! sensible heat ratio (sens cap/total cap)</span>
<a name="ln-1641"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyRatedCOP</span>          <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="c">! coefficient of performance  for discharging [W/W]</span>
<a name="ln-1642"></a>
<a name="ln-1643"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">49</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1644"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1645"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1646"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1647"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1648"></a>        <span class="k">ELSE</span>
<a name="ln-1649"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1650"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1651"></a>        <span class="n">ENDIF</span>
<a name="ln-1652"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1653"></a>      <span class="k">ELSE</span>
<a name="ln-1654"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1655"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1656"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-1657"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1658"></a>                     <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempCurve</span><span class="p">)</span>
<a name="ln-1659"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1660"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1661"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">49</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1662"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-1663"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1664"></a>        <span class="k">END SELECT</span>
<a name="ln-1665"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1666"></a>
<a name="ln-1667"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1668"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1669"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1670"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1671"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1672"></a>        <span class="k">ELSE</span>
<a name="ln-1673"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1674"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1675"></a>        <span class="n">ENDIF</span>
<a name="ln-1676"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1677"></a>      <span class="k">ELSE</span>
<a name="ln-1678"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1679"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1680"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1681"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1683"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1684"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1685"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowCurve</span><span class="p">)</span>
<a name="ln-1686"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1687"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1688"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1689"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1690"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1691"></a>        <span class="k">END SELECT</span>
<a name="ln-1692"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1693"></a>
<a name="ln-1694"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1695"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1696"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1697"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1698"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1699"></a>        <span class="k">ELSE</span>
<a name="ln-1700"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1701"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1702"></a>        <span class="n">ENDIF</span>
<a name="ln-1703"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1704"></a>      <span class="k">ELSE</span>
<a name="ln-1705"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1706"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1707"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">)</span>
<a name="ln-1708"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1709"></a>                     <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFTempCurve</span><span class="p">)</span>
<a name="ln-1710"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1711"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1712"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">51</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1713"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two independent variables, x and y.&#39;</span><span class="p">)</span>
<a name="ln-1714"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1715"></a>        <span class="k">END SELECT</span>
<a name="ln-1716"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1717"></a>
<a name="ln-1718"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFFlowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1719"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFFlowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1720"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1721"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1722"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1723"></a>        <span class="k">ELSE</span>
<a name="ln-1724"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1725"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1726"></a>        <span class="n">ENDIF</span>
<a name="ln-1727"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1728"></a>      <span class="k">ELSE</span>
<a name="ln-1729"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1730"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFFlowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1731"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1732"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1733"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1734"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1735"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFFlowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1736"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFFlowCurve</span><span class="p">)</span>
<a name="ln-1737"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1738"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1739"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">52</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1740"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1741"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1742"></a>        <span class="k">END SELECT</span>
<a name="ln-1743"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyPLFFPLRCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1746"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyPLFFPLRCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1747"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1748"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1749"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1750"></a>        <span class="k">ELSE</span>
<a name="ln-1751"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1752"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1753"></a>        <span class="n">ENDIF</span>
<a name="ln-1754"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1755"></a>      <span class="k">ELSE</span>
<a name="ln-1756"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1757"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyPLFFPLRCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1758"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1759"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1760"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1761"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1762"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyPLFFPLRObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1763"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlyPLFFPLRCurve</span><span class="p">)</span>
<a name="ln-1764"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1765"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1766"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">53</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1767"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1768"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1769"></a>        <span class="k">END SELECT</span>
<a name="ln-1770"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1771"></a>
<a name="ln-1772"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1773"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1774"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1775"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1776"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1777"></a>        <span class="k">ELSE</span>
<a name="ln-1778"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1779"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1780"></a>        <span class="n">ENDIF</span>
<a name="ln-1781"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1782"></a>      <span class="k">ELSE</span>
<a name="ln-1783"></a>        <span class="c">! Verify Curve Object</span>
<a name="ln-1784"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1785"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1786"></a>                 <span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-1787"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1788"></a>                     <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempCurve</span><span class="p">)</span>
<a name="ln-1789"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1790"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1791"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">54</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1792"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with two or three independent variables&#39;</span><span class="p">)</span>
<a name="ln-1793"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1794"></a>        <span class="k">END SELECT</span>
<a name="ln-1795"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1796"></a>
<a name="ln-1797"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFFLowCurve</span> <span class="o">=</span> <span class="n">GetCurveIndex</span><span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1798"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFFLowCurve</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1799"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1800"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1801"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Required &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;is blank.&#39;</span><span class="p">)</span>
<a name="ln-1802"></a>        <span class="k">ELSE</span>
<a name="ln-1803"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1804"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Not found &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1805"></a>        <span class="n">ENDIF</span>
<a name="ln-1806"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1807"></a>      <span class="k">ELSE</span>
<a name="ln-1808"></a>        <span class="c">! Verify Curve Object, any curve with just x as single independent variable</span>
<a name="ln-1809"></a>        <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFFLowCurve</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1810"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_Linear</span><span class="p">,</span> <span class="n">CurveType_Quadratic</span><span class="p">,</span> <span class="n">CurveType_Cubic</span><span class="p">,</span> <span class="n">CurveType_Quartic</span><span class="p">,&amp;</span>
<a name="ln-1811"></a>              <span class="n">CurveType_Exponent</span><span class="p">,</span> <span class="n">CurveType_TableOneIV</span><span class="p">,</span> <span class="n">CurveType_ExponentialSkewNormal</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1812"></a>              <span class="n">CurveType_Sigmoid</span><span class="p">,</span><span class="n">CurveType_RectangularHyperbola1</span><span class="p">,</span> <span class="n">CurveType_RectangularHyperbola2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1813"></a>              <span class="n">CurveType_ExponentialDecay</span><span class="p">,</span> <span class="n">CurveType_DoubleExponentialDecay</span><span class="p">)</span>
<a name="ln-1814"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFFLowObjectNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1815"></a>                        <span class="n">GetCurveObjectTypeNum</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">DischargeOnlySHRFFLowCurve</span><span class="p">)</span>
<a name="ln-1816"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1817"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1818"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1819"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose a curve or table with one independent variable, x.&#39;</span><span class="p">)</span>
<a name="ln-1820"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1821"></a>        <span class="k">END SELECT</span>
<a name="ln-1822"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-1823"></a>
<a name="ln-1824"></a>    <span class="n">ENDIF</span> <span class="c">! Discharge Only mode available</span>
<a name="ln-1825"></a>
<a name="ln-1826"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>      <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<a name="ln-1827"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ColdWeatherMinimumTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a name="ln-1828"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ColdWeatherAncillaryPower</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<a name="ln-1829"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">56</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1830"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1831"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1832"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="o">=</span> <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">57</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1833"></a>                         <span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1834"></a>                         <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_ReliefAir</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1835"></a>
<a name="ln-1836"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondenserAirVolumeFlow</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">34</span><span class="p">)</span>
<a name="ln-1837"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondenserAirFlowSizingFactor</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">35</span><span class="p">)</span>
<a name="ln-1838"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">58</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1839"></a>
<a name="ln-1840"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;AIRCOOLED&#39;</span><span class="p">)</span>
<a name="ln-1841"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">=</span> <span class="n">AirCooled</span>
<a name="ln-1842"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="s1">&#39;EVAPORATIVELYCOOLED&#39;</span><span class="p">)</span>
<a name="ln-1843"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">=</span> <span class="n">EvapCooled</span>
<a name="ln-1844"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-1845"></a>      <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1846"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">58</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">58</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1847"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Available choices are AirCooled or EvaporativelyCooled.&#39;</span><span class="p">)</span>
<a name="ln-1848"></a>      <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1849"></a>    <span class="k">END SELECT</span>
<a name="ln-1850"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapCondEffect</span>            <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span>
<a name="ln-1851"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span>  <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<a name="ln-1852"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">38</span><span class="p">)</span>
<a name="ln-1853"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">BasinHeaterSetpointTemp</span>   <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">39</span><span class="p">)</span>
<a name="ln-1854"></a>
<a name="ln-1855"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">59</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1856"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">BasinHeaterAvailSchedNum</span> <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1857"></a>    <span class="k">ELSE</span>
<a name="ln-1858"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">BasinHeaterAvailSchedNum</span> <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">59</span><span class="p">))</span>
<a name="ln-1859"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">BasinHeaterAvailSchedNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1860"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1861"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">59</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">59</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1862"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1863"></a>      <span class="n">ENDIF</span>
<a name="ln-1864"></a>    <span class="n">ENDIF</span>
<a name="ln-1865"></a>
<a name="ln-1866"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1867"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromMains</span>
<a name="ln-1868"></a>    <span class="k">ELSE</span>
<a name="ln-1869"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
<a name="ln-1870"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">=</span> <span class="n">WaterSupplyFromTank</span>
<a name="ln-1871"></a>      <span class="k">CALL </span><span class="n">SetupTankDemandComponent</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1872"></a>                 <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupplyName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1873"></a>                 <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span> <span class="p">)</span>
<a name="ln-1874"></a>    <span class="n">ENDIF</span>
<a name="ln-1875"></a>
<a name="ln-1876"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">61</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1877"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondensateCollectMode</span>  <span class="o">=</span> <span class="n">CondensateDiscarded</span>
<a name="ln-1878"></a>    <span class="k">ELSE</span>
<a name="ln-1879"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondensateCollectName</span> <span class="o">=</span> <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span>
<a name="ln-1880"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondensateCollectMode</span> <span class="o">=</span> <span class="n">CondensateToTank</span>
<a name="ln-1881"></a>      <span class="k">CALL </span><span class="n">SetupTankSupplyComponent</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1882"></a>                 <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondensateCollectName</span><span class="p">,</span> <span class="n">ErrorsFound</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondensateTankID</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1883"></a>                 <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondensateTankSupplyARRID</span> <span class="p">)</span>
<a name="ln-1884"></a>    <span class="n">ENDIF</span>
<a name="ln-1885"></a>
<a name="ln-1886"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">62</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1887"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1888"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">62</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1889"></a>               <span class="n">NodeConnectionType_Inlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1890"></a>
<a name="ln-1891"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1892"></a>    <span class="k">ELSE</span>
<a name="ln-1893"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1894"></a>    <span class="n">ENDIF</span>
<a name="ln-1895"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">63</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1896"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantOutletNodeNum</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1897"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">63</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">NodeType_Water</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1898"></a>               <span class="n">NodeConnectionType_Outlet</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-1899"></a>    <span class="k">ELSE</span>
<a name="ln-1900"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1901"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, invalid&#39;</span><span class="p">)</span>
<a name="ln-1902"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">63</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; cannot be blank.&#39;</span><span class="p">)</span>
<a name="ln-1903"></a>        <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1904"></a>      <span class="n">ENDIF</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a>    <span class="n">ENDIF</span>
<a name="ln-1907"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1908"></a><span class="k">      CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">62</span><span class="p">),</span>  <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">63</span><span class="p">),</span><span class="s1">&#39;Water Nodes&#39;</span><span class="p">)</span>
<a name="ln-1909"></a>    <span class="n">ENDIF</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1912"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantDesignVolumeFlowRate</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<a name="ln-1913"></a>    <span class="n">ENDIF</span>
<a name="ln-1914"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1915"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantEffectiveness</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<a name="ln-1916"></a>    <span class="n">ENDIF</span>
<a name="ln-1917"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-1918"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1919"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a name="ln-1920"></a>      <span class="k">ELSE</span>
<a name="ln-1921"></a>
<a name="ln-1922"></a><span class="k">        Call </span><span class="n">GetFluidDensityTemperatureLimits</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="n">TminRho</span><span class="p">,</span> <span class="n">TmaxRho</span><span class="p">)</span>
<a name="ln-1923"></a>        <span class="k">CALL </span><span class="n">GetFluidSpecificHeatTemperatureLimits</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="n">TminCp</span><span class="p">,</span> <span class="n">TmaxCp</span><span class="p">)</span>
<a name="ln-1924"></a>        <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">TminRho</span><span class="p">,</span> <span class="n">TminCp</span><span class="p">)</span>
<a name="ln-1925"></a>
<a name="ln-1926"></a>      <span class="n">ENDIF</span>
<a name="ln-1927"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lNumericFieldBlanks</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1928"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span> <span class="o">=</span> <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<a name="ln-1929"></a>      <span class="k">ELSE</span>
<a name="ln-1930"></a><span class="k">        Call </span><span class="n">GetFluidDensityTemperatureLimits</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="n">TminRho</span><span class="p">,</span> <span class="n">TmaxRho</span><span class="p">)</span>
<a name="ln-1931"></a>        <span class="k">CALL </span><span class="n">GetFluidSpecificHeatTemperatureLimits</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="n">TminCp</span><span class="p">,</span> <span class="n">TmaxCp</span><span class="p">)</span>
<a name="ln-1932"></a>        <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">TmaxRho</span><span class="p">,</span> <span class="n">TmaxCp</span><span class="p">)</span>
<a name="ln-1933"></a>
<a name="ln-1934"></a>      <span class="n">ENDIF</span>
<a name="ln-1935"></a>    <span class="n">ENDIF</span>
<a name="ln-1936"></a>
<a name="ln-1937"></a>  <span class="n">ENDDO</span>
<a name="ln-1938"></a>
<a name="ln-1939"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1940"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="n">RoutineName</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; input. &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1941"></a>                        <span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-1942"></a>  <span class="k">END IF</span>
<a name="ln-1943"></a>
<a name="ln-1944"></a>  <span class="c">! setup reporting</span>
<a name="ln-1945"></a>  <span class="k">DO </span><span class="n">item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTESCoils</span>
<a name="ln-1946"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Operating Mode Index []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1947"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CurControlMode</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1948"></a>
<a name="ln-1949"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1950"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1951"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Total Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1952"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1953"></a>                                    <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;ENERGYTRANSFER&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLINGCOILS&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1954"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1955"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1956"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Sensible Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1957"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1958"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1959"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1960"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Latent Cooling Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1961"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1962"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1963"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ElecCoolingPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1964"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1965"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1966"></a>                                    <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1967"></a>
<a name="ln-1968"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Runtime Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1969"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">RuntimeFraction</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1970"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Cold Weather Protection Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1971"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ElectColdWeatherEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1972"></a>                                    <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Thermal Protection&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1973"></a>                                    <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-1974"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Cold Weather Protection Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1975"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ElectColdWeatherPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Thermal Storage Mechanical Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1978"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">QdotTES</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1979"></a>
<a name="ln-1980"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Thermal Storage Mechanical Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1981"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Q_TES</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1982"></a>
<a name="ln-1983"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Thermal Storage Ambient Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1984"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">QdotAmbient</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1985"></a>
<a name="ln-1986"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Thermal Storage Ambient Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1987"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Q_Ambient</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1988"></a>
<a name="ln-1989"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1990"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Thermal Storage Plant Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1991"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">QdotPlant</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1992"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Thermal Storage Plant Heat Transfer Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1993"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Q_Plant</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1994"></a>
<a name="ln-1995"></a>    <span class="n">ENDIF</span>
<a name="ln-1996"></a>
<a name="ln-1997"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1998"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Condenser Inlet Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1999"></a>                               <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2000"></a>
<a name="ln-2001"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromMains</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2002"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Water Volume [m3]&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2003"></a>                                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2004"></a>                                  <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2005"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Mains Supply Water Volume [m3]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2006"></a>                                  <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2007"></a>                                 <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2008"></a>                                  <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2009"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2010"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Storage Tank Water Volume [m3]&#39;</span><span class="p">,&amp;</span>
<a name="ln-2011"></a>                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterConsump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2012"></a>                            <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2013"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span> <span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2014"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Starved Water Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2015"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterStarvMakup</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2016"></a>                            <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2017"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Water&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2018"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Starved Mains Water Volume [m3]&#39;</span><span class="p">,&amp;</span>
<a name="ln-2019"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapWaterStarvMakup</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2020"></a>                            <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2021"></a>                             <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;MainsWater&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;Cooling&#39;</span><span class="p">,</span> <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>      <span class="n">ENDIf</span>
<a name="ln-2024"></a>
<a name="ln-2025"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Power [W]&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2026"></a>                               <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2027"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Evaporative Condenser Pump Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2028"></a>                                <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span><span class="p">,</span><span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2029"></a>                                <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2030"></a>
<a name="ln-2031"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Power [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2032"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterPower</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2033"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Basin Heater Electric Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2034"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterEnergy</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2035"></a>                                    <span class="n">ResourceTypeKey</span><span class="o">=</span><span class="s1">&#39;Electric&#39;</span><span class="p">,</span><span class="n">EndUseKey</span><span class="o">=</span><span class="s1">&#39;COOLING&#39;</span><span class="p">,</span><span class="n">EndUseSubKey</span><span class="o">=</span><span class="s1">&#39;Thermal Protection&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2036"></a>                                    <span class="n">GroupKey</span><span class="o">=</span><span class="s1">&#39;System&#39;</span><span class="p">)</span>
<a name="ln-2037"></a>
<a name="ln-2038"></a>    <span class="n">ENDIF</span>
<a name="ln-2039"></a>
<a name="ln-2040"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2041"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Fluid Thermal Storage End Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2042"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">FluidTankTempFinal</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2043"></a>
<a name="ln-2044"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2045"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Cooling Coil Ice Thermal Storage End Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2046"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">IceFracRemain</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2047"></a>    <span class="n">ENDIF</span>
<a name="ln-2048"></a>
<a name="ln-2049"></a>  <span class="n">ENDDO</span>
<a name="ln-2050"></a>
<a name="ln-2051"></a>
<a name="ln-2052"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2053"></a><span class="k">    DO </span><span class="n">item</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTESCoils</span>
<a name="ln-2054"></a>    <span class="c">! setup EMS actuator for control mode</span>
<a name="ln-2055"></a>      <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2056"></a>                            <span class="s1">&#39;Operating Mode&#39;</span> <span class="p">,</span> <span class="s1">&#39;[ ]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2057"></a>                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EMSControlModeOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2058"></a>                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">item</span><span class="p">)%</span><span class="n">EMSControlModeValue</span> <span class="p">)</span>
<a name="ln-2059"></a>    <span class="n">ENDDO</span>
<a name="ln-2060"></a>  <span class="n">ENDIF</span>
<a name="ln-2061"></a>
<a name="ln-2062"></a>
<a name="ln-2063"></a>
<a name="ln-2064"></a>  <span class="k">RETURN</span>
<a name="ln-2065"></a>
<a name="ln-2066"></a><span class="k">END SUBROUTINE </span><span class="n">GetTESCoilInput</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a><span class="k">SUBROUTINE </span><span class="n">InitTESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2069"></a>
<a name="ln-2070"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2071"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2072"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-2073"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2074"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2075"></a>
<a name="ln-2076"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2077"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2078"></a>
<a name="ln-2079"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2080"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2081"></a>
<a name="ln-2082"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2083"></a>          <span class="c">! na</span>
<a name="ln-2084"></a>
<a name="ln-2085"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2086"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_PackagedTESCoolingCoil</span><span class="p">,</span> <span class="n">PlantLoop</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span>
<a name="ln-2087"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-2088"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-2089"></a>
<a name="ln-2090"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2091"></a>
<a name="ln-2092"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2093"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-2094"></a>
<a name="ln-2095"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2096"></a>          <span class="c">! na</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2099"></a>          <span class="c">! na</span>
<a name="ln-2100"></a>
<a name="ln-2101"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2102"></a>          <span class="c">! na</span>
<a name="ln-2103"></a>
<a name="ln-2104"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2105"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyFlag</span>  <span class="c">! One time environment flag</span>
<a name="ln-2106"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>   <span class="c">! One time sizing flag</span>
<a name="ln-2107"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span> <span class="c">! flag for init once at start of environment</span>
<a name="ln-2108"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyWarmupFlag</span> <span class="c">! flag for init after warmup complete</span>
<a name="ln-2109"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>                  <span class="c">! One time flag used to allocate MyEnvrnFlag and MySizeFlag</span>
<a name="ln-2110"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">errFlag</span>
<a name="ln-2111"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">plloopnum</span>
<a name="ln-2112"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">lsnum</span>
<a name="ln-2113"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">brnum</span>
<a name="ln-2114"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">cpnum</span>
<a name="ln-2115"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">tmpSchedValue</span>
<a name="ln-2116"></a>
<a name="ln-2117"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2118"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-2119"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyFlag</span><span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span>
<a name="ln-2120"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span>
<a name="ln-2121"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span>
<a name="ln-2122"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">NumTESCoils</span><span class="p">))</span>
<a name="ln-2123"></a>    <span class="n">MyFlag</span>        <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2124"></a>    <span class="n">MySizeFlag</span>    <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2125"></a>    <span class="n">MyEnvrnFlag</span>   <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2126"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2127"></a>    <span class="n">MyWarmupFlag</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2128"></a>
<a name="ln-2129"></a>  <span class="k">END IF</span>
<a name="ln-2130"></a>
<a name="ln-2131"></a>
<a name="ln-2132"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">MyFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2133"></a>
<a name="ln-2134"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2135"></a><span class="k">      </span><span class="n">errFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2136"></a>      <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2137"></a>                                   <span class="n">TypeOf_PackagedTESCoolingCoil</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2138"></a>                                   <span class="n">plloopnum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2139"></a>                                   <span class="n">lsnum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2140"></a>                                   <span class="n">brnum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2141"></a>                                   <span class="n">cpnum</span><span class="p">)</span>
<a name="ln-2142"></a>
<a name="ln-2143"></a>
<a name="ln-2144"></a>      <span class="c">! double check node names match</span>
<a name="ln-2145"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2146"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-2147"></a>      <span class="n">ENDIF</span>
<a name="ln-2148"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopNum</span> <span class="o">=</span> <span class="n">plloopnum</span>
<a name="ln-2149"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopSideNum</span> <span class="o">=</span> <span class="n">lsnum</span>
<a name="ln-2150"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantBranchNum</span> <span class="o">=</span> <span class="n">brnum</span>
<a name="ln-2151"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantCompNum</span>   <span class="o">=</span> <span class="n">cpnum</span>
<a name="ln-2152"></a>
<a name="ln-2153"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">plloopnum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">lsnum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">brnum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">cpnum</span><span class="p">)%</span><span class="n">NodeNumIn</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-2154"></a>             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span> <span class="p">)</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2155"></a>          <span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">plloopnum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">lsnum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">brnum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">cpnum</span><span class="p">)%</span><span class="n">NodeNumOut</span> <span class="o">/=</span> <span class="p">&amp;</span>
<a name="ln-2156"></a>             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantOutletNodeNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2157"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Coil:Cooling:DX:SingleSpeed:ThermalStorage =&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2158"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, non-matching plant nodes.&#39;</span><span class="p">)</span>
<a name="ln-2159"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...in Branch=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-2160"></a>                           <span class="n">LoopSide</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopSideNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-2161"></a>                             <span class="n">Branch</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantBranchNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2162"></a>                             <span class="s1">&#39;&quot;, Component referenced with:&#39;</span><span class="p">)</span>
<a name="ln-2163"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Inlet Node=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2164"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">plloopnum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">lsnum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">brnum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">cpnum</span><span class="p">)%</span><span class="n">NodeNumIn</span><span class="p">)))</span>
<a name="ln-2165"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Outlet Node=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2166"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">plloopnum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">lsnum</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">brnum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">cpnum</span><span class="p">)%</span><span class="n">NodeNumOut</span><span class="p">)))</span>
<a name="ln-2167"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...TES Inlet Node=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)))</span>
<a name="ln-2168"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...TES Outlet Node=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2169"></a>        <span class="n">errflag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2170"></a>      <span class="n">ENDIF</span>
<a name="ln-2171"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2172"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Program terminated due to previous condition(s).&#39;</span><span class="p">)</span>
<a name="ln-2173"></a>      <span class="n">ENDIF</span>
<a name="ln-2174"></a>
<a name="ln-2175"></a>    <span class="n">ENDIF</span> <span class="c">! any plant connection to TES</span>
<a name="ln-2176"></a>    <span class="n">MyFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2177"></a>  <span class="n">ENDIF</span>
<a name="ln-2178"></a>
<a name="ln-2179"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2180"></a>
<a name="ln-2181"></a><span class="k">    CALL </span><span class="n">SizeTESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2182"></a>
<a name="ln-2183"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2184"></a>  <span class="n">ENDIF</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2187"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span>      <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2188"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2189"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Plant</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2190"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2191"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Ambient</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2192"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2193"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2194"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2195"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2196"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2197"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinal</span>            <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedFluidTankTemp</span>
<a name="ln-2198"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedFluidTankTemp</span>
<a name="ln-2199"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>       <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric power for cooling [W]</span>
<a name="ln-2200"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>      <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric energy for cooling [J], metered</span>
<a name="ln-2201"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evaporator coil total cooling rate [W]</span>
<a name="ln-2202"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evaporatory coil total cooling energy [J], metered</span>
<a name="ln-2203"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2204"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2205"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2206"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2207"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2208"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherPower</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric power for cold weather protection [W]</span>
<a name="ln-2209"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric energy for cold weather protection [J], metered</span>
<a name="ln-2210"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2211"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2212"></a>
<a name="ln-2213"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2214"></a>  <span class="n">ENDIF</span>
<a name="ln-2215"></a>
<a name="ln-2216"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span>  <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2217"></a>
<a name="ln-2218"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2219"></a>    <span class="c">!reset to initial condition once warm up is over.</span>
<a name="ln-2220"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2221"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2222"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinal</span>            <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedFluidTankTemp</span>
<a name="ln-2223"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedFluidTankTemp</span>
<a name="ln-2224"></a>    <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2225"></a>  <span class="n">ENDIF</span>
<a name="ln-2226"></a>
<a name="ln-2227"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">WarmUpFlag</span> <span class="p">)</span> <span class="n">MyWarmupFlag</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2228"></a>
<a name="ln-2229"></a>  <span class="c">! determine control mode</span>
<a name="ln-2230"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AvailSchedNum</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2231"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ModeControlType</span> <span class="o">==</span> <span class="n">ScheduledOpModes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2232"></a><span class="k">      </span><span class="n">tmpSchedValue</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ControlModeSchedNum</span><span class="p">)</span>
<a name="ln-2233"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">tmpSchedValue</span><span class="p">)</span>
<a name="ln-2234"></a>      <span class="c">! check if value is valid</span>
<a name="ln-2235"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span><span class="p">)</span>
<a name="ln-2236"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">OffMode</span><span class="p">,</span> <span class="n">CoolingOnlyMode</span><span class="p">,</span> <span class="n">CoolingAndChargeMode</span><span class="p">,</span> <span class="n">CoolingAndDischargeMode</span><span class="p">,</span> <span class="n">ChargeOnlyMode</span><span class="p">,</span> <span class="n">DischargeOnlyMode</span><span class="p">)</span>
<a name="ln-2237"></a>        <span class="c">! do nothing, these are okay</span>
<a name="ln-2238"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2239"></a>        <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2240"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ControlModeErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2241"></a><span class="k">          CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control schedule value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2242"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2243"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2244"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from schedule =&#39;</span> <span class="p">&amp;</span>
<a name="ln-2245"></a>              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">tmpSchedValue</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2246"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2247"></a>        <span class="n">ENDIF</span>
<a name="ln-2248"></a>        <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control schedule value for TES operating mode, set to Off&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2249"></a>                                  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ControlModeErrorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2250"></a>                                  <span class="n">ReportMaxOf</span> <span class="o">=</span> <span class="n">tmpSchedValue</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2251"></a>                                  <span class="n">ReportMinOf</span> <span class="o">=</span> <span class="n">tmpSchedValue</span><span class="p">)</span>
<a name="ln-2252"></a>      <span class="k">END SELECT</span>
<a name="ln-2253"></a>
<a name="ln-2254"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ModeControlType</span> <span class="o">==</span> <span class="n">EMSActuatedOpModes</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2255"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EMSControlModeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2256"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EMSControlModeValue</span><span class="p">)</span>
<a name="ln-2257"></a>      <span class="c">! check if value is valid</span>
<a name="ln-2258"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span><span class="p">)</span>
<a name="ln-2259"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">OffMode</span> <span class="p">)</span>
<a name="ln-2260"></a>
<a name="ln-2261"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">CoolingOnlyMode</span> <span class="p">)</span>
<a name="ln-2262"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyModeIsAvailable</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2263"></a><span class="k">            CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2264"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2265"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2266"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from EMS indicates Cooling Only Mode but that mode is not available.&#39;</span><span class="p">)</span>
<a name="ln-2267"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2268"></a>            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2269"></a>          <span class="n">ENDIF</span>
<a name="ln-2270"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">CoolingAndChargeMode</span> <span class="p">)</span>
<a name="ln-2271"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2272"></a><span class="k">            CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2273"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2274"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2275"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from EMS indicates Cooling And Charge Mode but that mode is not available.&#39;</span><span class="p">)</span>
<a name="ln-2276"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2277"></a>            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2278"></a>          <span class="n">ENDIF</span>
<a name="ln-2279"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">CoolingAndDischargeMode</span> <span class="p">)</span>
<a name="ln-2280"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2281"></a><span class="k">            CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2282"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2283"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2284"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from EMS indicates Cooling And Discharge Mode but that mode is not available.&#39;</span><span class="p">)</span>
<a name="ln-2285"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2286"></a>            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2287"></a>          <span class="n">ENDIF</span>
<a name="ln-2288"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">ChargeOnlyMode</span> <span class="p">)</span>
<a name="ln-2289"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyModeAvailable</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2290"></a><span class="k">            CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2291"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2292"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2293"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from EMS indicates Charge Only Mode but that mode is not available.&#39;</span><span class="p">)</span>
<a name="ln-2294"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2295"></a>            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2296"></a>          <span class="n">ENDIF</span>
<a name="ln-2297"></a>        <span class="k">CASE</span> <span class="p">(</span> <span class="n">DischargeOnlyMode</span><span class="p">)</span>
<a name="ln-2298"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2299"></a><span class="k">            CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2300"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2301"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2302"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from EMS indicates Discharge Only Mode but that mode is not available.&#39;</span> <span class="p">)</span>
<a name="ln-2303"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2304"></a>            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2305"></a>          <span class="n">ENDIF</span>
<a name="ln-2306"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2307"></a>          <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2308"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ControlModeErrorIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2309"></a><span class="k">            CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control value for operating mode&#39;</span><span class="p">)</span>
<a name="ln-2310"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs for Coil:Cooling:DX:SingleSpeed:ThermalStorage name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2311"></a>                              <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2312"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value returned from EMS =&#39;</span> <span class="p">&amp;</span>
<a name="ln-2313"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EMSControlModeValue</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span> <span class="p">)</span>
<a name="ln-2314"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Operating mode will be set to Off, and the simulation continues&#39;</span><span class="p">)</span>
<a name="ln-2315"></a>          <span class="n">ENDIF</span>
<a name="ln-2316"></a>          <span class="k">CALL </span><span class="n">ShowRecurringSevereErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;InitTESCoil: Invalid control schedule value for TES operating mode, set to Off&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2317"></a>                                    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ControlModeErrorIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2318"></a>                                    <span class="n">ReportMaxOf</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EMSControlModeValue</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2319"></a>                                    <span class="n">ReportMinOf</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EMSControlModeValue</span><span class="p">)</span>
<a name="ln-2320"></a>        <span class="k">END SELECT</span>
<a name="ln-2321"></a><span class="k">      ELSE</span>
<a name="ln-2322"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2323"></a>      <span class="n">ENDIF</span>
<a name="ln-2324"></a>    <span class="n">ENDIF</span>
<a name="ln-2325"></a>  <span class="k">ELSE</span>
<a name="ln-2326"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CurControlMode</span> <span class="o">=</span> <span class="n">OffMode</span>
<a name="ln-2327"></a>  <span class="n">ENDIF</span>
<a name="ln-2328"></a>
<a name="ln-2329"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! heat exchange rate for plant connection to TES tank [W]</span>
<a name="ln-2330"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Plant</span>    <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">!  heat exchange energy for plant connection to TES tank [J]</span>
<a name="ln-2331"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! heat exchange rate for skin losses/gains for TES tank to surroundings [W]</span>
<a name="ln-2332"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Ambient</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! heat exchange enegy for skin losses/gains for TES tank to surroundings [J]</span>
<a name="ln-2333"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>  <span class="o">=</span> <span class="mf">0.d0</span>    <span class="c">! heat exchange rate by mechanical systems to charge or discharge TES [W]</span>
<a name="ln-2334"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>    <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! heat exchange energy by mechanical systems to charge or discharge TES [J]</span>
<a name="ln-2335"></a>
<a name="ln-2336"></a>  <span class="c">! dynamic calculated data</span>
<a name="ln-2337"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>       <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric power for cooling [W]</span>
<a name="ln-2338"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>      <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric energy for cooling [J], metered</span>
<a name="ln-2339"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evaporator coil total cooling rate [W]</span>
<a name="ln-2340"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! evaporatory coil total cooling energy [J], metered</span>
<a name="ln-2341"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2342"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2343"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>     <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2344"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2345"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>        <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2346"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">!</span>
<a name="ln-2347"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherPower</span>  <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric power for cold weather protection [W]</span>
<a name="ln-2348"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>  <span class="c">! electric energy for cold weather protection [J], metered</span>
<a name="ln-2349"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2350"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2351"></a>
<a name="ln-2352"></a>  <span class="k">RETURN</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a><span class="k">END SUBROUTINE </span><span class="n">InitTESCoil</span>
<a name="ln-2355"></a>
<a name="ln-2356"></a><span class="k">SUBROUTINE </span><span class="n">SizeTESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2357"></a>
<a name="ln-2358"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2359"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-2360"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-2361"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2362"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2363"></a>
<a name="ln-2364"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2365"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2366"></a>
<a name="ln-2367"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2368"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2369"></a>
<a name="ln-2370"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2371"></a>          <span class="c">! na</span>
<a name="ln-2372"></a>
<a name="ln-2373"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2374"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-2375"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-2376"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdRhoAir</span>
<a name="ln-2377"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-2378"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-2379"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-2380"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SecInHour</span><span class="p">,</span> <span class="n">InitConvTemp</span>
<a name="ln-2381"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-2382"></a>
<a name="ln-2383"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2384"></a>
<a name="ln-2385"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2386"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-2387"></a>
<a name="ln-2388"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2389"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">RoutineName</span><span class="o">=</span><span class="s1">&#39;SizeTESCoil &#39;</span>
<a name="ln-2390"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>        <span class="kd">::</span> <span class="n">FluidTankSizingDeltaT</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.d0</span>
<a name="ln-2391"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2392"></a>          <span class="c">! na</span>
<a name="ln-2393"></a>
<a name="ln-2394"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2395"></a>          <span class="c">! na</span>
<a name="ln-2396"></a>
<a name="ln-2397"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2398"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixTemp</span>
<a name="ln-2399"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixHumRat</span>
<a name="ln-2400"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixEnth</span>
<a name="ln-2401"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MixWetBulb</span>
<a name="ln-2402"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupTemp</span>
<a name="ln-2403"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHumRat</span>
<a name="ln-2404"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupEnth</span>
<a name="ln-2405"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutTemp</span>
<a name="ln-2406"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutAirFrac</span>
<a name="ln-2407"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VolFlowRate</span>
<a name="ln-2408"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2409"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2410"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">TimeStepNumAtMax</span>
<a name="ln-2411"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">DDNum</span>
<a name="ln-2412"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rhoair</span>
<a name="ln-2413"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-2414"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">deltaT</span>
<a name="ln-2415"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Cp</span>
<a name="ln-2416"></a>
<a name="ln-2417"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2418"></a>
<a name="ln-2419"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2420"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2421"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2422"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span>
<a name="ln-2423"></a>      <span class="k">ELSE</span>
<a name="ln-2424"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-2425"></a>      <span class="n">ENDIF</span>
<a name="ln-2426"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2427"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2428"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2429"></a>               <span class="nb">MAX</span><span class="p">(</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolVolFlow</span><span class="p">,</span><span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesHeatVolFlow</span><span class="p">)</span>
<a name="ln-2430"></a>    <span class="n">ENDIF</span>
<a name="ln-2431"></a>
<a name="ln-2432"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">&lt;</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2433"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2434"></a>    <span class="n">ENDIF</span>
<a name="ln-2435"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2436"></a>                                  <span class="s1">&#39;Rated Evaporator Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="p">)</span>
<a name="ln-2437"></a>  <span class="n">ENDIF</span>
<a name="ln-2438"></a>
<a name="ln-2439"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirMassFlowRate</span> <span class="o">=</span> <span class="n">StdRhoAir</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span>
<a name="ln-2440"></a>
<a name="ln-2441"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirVolumeFlow</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2442"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirVolumeFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span> <span class="p">&amp;</span>
<a name="ln-2443"></a>                                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirFlowSizingFactor</span>
<a name="ln-2444"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2445"></a>                                  <span class="s1">&#39;Condenser Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirVolumeFlow</span> <span class="p">)</span>
<a name="ln-2446"></a>  <span class="n">ENDIF</span>
<a name="ln-2447"></a>
<a name="ln-2448"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span> <span class="o">=</span> <span class="n">StdRhoAir</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirVolumeFlow</span>
<a name="ln-2449"></a>
<a name="ln-2450"></a>
<a name="ln-2451"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2452"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2453"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">)</span>
<a name="ln-2454"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span>
<a name="ln-2455"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2456"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurOASysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is in the OA stream</span>
<a name="ln-2457"></a>          <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2458"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutHumRat</span>
<a name="ln-2459"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span>
<a name="ln-2460"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span>
<a name="ln-2461"></a>        <span class="k">ELSE</span> <span class="c">! coil is on the main air loop</span>
<a name="ln-2462"></a>      <span class="c">!     MixTemp = FinalSysSizing(CurSysNum)%CoolMixTemp</span>
<a name="ln-2463"></a>      <span class="c">!     MixHumRat = FinalSysSizing(CurSysNum)%CoolMixHumRat</span>
<a name="ln-2464"></a>          <span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupTemp</span>
<a name="ln-2465"></a>          <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolSupHumRat</span>
<a name="ln-2466"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">NumOACoolCoils</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! there is no precooling of the OA stream</span>
<a name="ln-2467"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixTemp</span>
<a name="ln-2468"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolMixHumRat</span>
<a name="ln-2469"></a>          <span class="k">ELSE</span> <span class="c">! there is precooling of OA stream</span>
<a name="ln-2470"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2471"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesOutAirVolFlow</span> <span class="o">/</span> <span class="n">VolFlowRate</span>
<a name="ln-2472"></a>            <span class="k">ELSE</span>
<a name="ln-2473"></a><span class="k">              </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2474"></a>            <span class="k">END IF</span>
<a name="ln-2475"></a><span class="k">            </span><span class="n">OutAirFrac</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OutAirFrac</span><span class="p">))</span>
<a name="ln-2476"></a>            <span class="n">MixTemp</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolTemp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2477"></a>                        <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetTemp</span>
<a name="ln-2478"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">OutAirFrac</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">PrecoolHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2479"></a>                          <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">OutAirFrac</span><span class="p">)</span><span class="o">*</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolRetHumRat</span>
<a name="ln-2480"></a>          <span class="k">END IF</span>
<a name="ln-2481"></a><span class="k">        END IF</span>
<a name="ln-2482"></a><span class="k">        </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">CoolOutTemp</span>
<a name="ln-2483"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2484"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2485"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2486"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2487"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2488"></a>        <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2489"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2490"></a><span class="k">          </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2491"></a>        <span class="k">ELSE</span>
<a name="ln-2492"></a><span class="k">          </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2493"></a>        <span class="k">END IF</span>
<a name="ln-2494"></a>
<a name="ln-2495"></a><span class="k">      ELSE</span>
<a name="ln-2496"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2497"></a>      <span class="k">END IF</span>
<a name="ln-2498"></a><span class="k">    ELSE IF</span> <span class="p">(</span><span class="n">CurZoneEqNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2499"></a><span class="k">      CALL </span><span class="n">CheckZoneSizing</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2500"></a>      <span class="n">VolFlowRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirVolFlowRate</span>
<a name="ln-2501"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">VolFlowRate</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2502"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ZoneEqDXCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2503"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ZoneEqSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">OAVolFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2504"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-2505"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-2506"></a>          <span class="k">ELSE</span>
<a name="ln-2507"></a><span class="k">            </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneRetTempAtCoolPeak</span>
<a name="ln-2508"></a>            <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">ZoneHumRatAtCoolPeak</span>
<a name="ln-2509"></a>          <span class="k">END IF</span>
<a name="ln-2510"></a><span class="k">        ELSE</span>
<a name="ln-2511"></a><span class="k">          </span><span class="n">MixTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInTemp</span>
<a name="ln-2512"></a>          <span class="n">MixHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">DesCoolCoilInHumRat</span>
<a name="ln-2513"></a>        <span class="k">END IF</span>
<a name="ln-2514"></a><span class="k">        </span><span class="n">SupTemp</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesTemp</span>
<a name="ln-2515"></a>        <span class="n">SupHumRat</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDesHumRat</span>
<a name="ln-2516"></a>        <span class="n">TimeStepNumAtMax</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">TimeStepNumAtCoolMax</span>
<a name="ln-2517"></a>        <span class="n">DDNum</span> <span class="o">=</span> <span class="n">FinalZoneSizing</span><span class="p">(</span><span class="n">CurZoneEqNum</span><span class="p">)%</span><span class="n">CoolDDNum</span>
<a name="ln-2518"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DDNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">TimeStepNumAtMax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2519"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="n">DesDayWeath</span><span class="p">(</span><span class="n">DDNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">(</span><span class="n">TimeStepNumAtMax</span><span class="p">)</span>
<a name="ln-2520"></a>        <span class="k">ELSE</span>
<a name="ln-2521"></a><span class="k">          </span><span class="n">OutTemp</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2522"></a>        <span class="n">ENDIF</span>
<a name="ln-2523"></a>        <span class="n">rhoair</span> <span class="o">=</span> <span class="n">PsyRhoAirFnPbTdbW</span><span class="p">(</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2524"></a>        <span class="n">MixEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2525"></a>        <span class="n">MixWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">MixTemp</span><span class="p">,</span><span class="n">MixHumRat</span><span class="p">,</span><span class="n">StdBaroPress</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2526"></a>        <span class="n">SupEnth</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">SupTemp</span><span class="p">,</span><span class="n">SupHumRat</span><span class="p">,</span><span class="n">RoutineName</span><span class="p">)</span>
<a name="ln-2527"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span><span class="p">,</span><span class="n">MixWetBulb</span><span class="p">,</span><span class="n">OutTemp</span><span class="p">)</span>
<a name="ln-2528"></a>        <span class="n">CoolCapAtPeak</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="p">(</span><span class="n">rhoair</span> <span class="o">*</span> <span class="n">VolFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">MixEnth</span><span class="o">-</span><span class="n">SupEnth</span><span class="p">)))</span>
<a name="ln-2529"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">TotCapTempModFac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2530"></a><span class="k">          </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span> <span class="o">/</span> <span class="n">TotCapTempModFac</span>
<a name="ln-2531"></a>        <span class="k">ELSE</span>
<a name="ln-2532"></a><span class="k">          </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">=</span> <span class="n">CoolCapAtPeak</span>
<a name="ln-2533"></a>        <span class="k">END IF</span>
<a name="ln-2534"></a>
<a name="ln-2535"></a><span class="k">      ELSE</span>
<a name="ln-2536"></a><span class="k">        </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span><span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2537"></a>      <span class="k">END IF</span>
<a name="ln-2538"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2541"></a>                            <span class="s1">&#39;Cooling Only Mode Rated Total Evaporator Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2542"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">)</span>
<a name="ln-2543"></a>
<a name="ln-2544"></a>  <span class="n">ENDIF</span>
<a name="ln-2545"></a>
<a name="ln-2546"></a>
<a name="ln-2547"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span>  <span class="p">&amp;</span>
<a name="ln-2548"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCap</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2549"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2550"></a>                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCapSizingFactor</span>
<a name="ln-2551"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2552"></a>                            <span class="s1">&#39;Cooling And Charge Mode Rated Total Evaporator Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2553"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCap</span> <span class="p">)</span>
<a name="ln-2554"></a>  <span class="n">ENDIF</span>
<a name="ln-2555"></a>
<a name="ln-2556"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeModeAvailable</span>  <span class="p">&amp;</span>
<a name="ln-2557"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCap</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2558"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2559"></a>                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCapSizingFactor</span>
<a name="ln-2560"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2561"></a>                            <span class="s1">&#39;Cooling And Charge Mode Rated Storage Charging Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2562"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCap</span> <span class="p">)</span>
<a name="ln-2563"></a>  <span class="n">ENDIF</span>
<a name="ln-2564"></a>
<a name="ln-2565"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span>  <span class="p">&amp;</span>
<a name="ln-2566"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCap</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2567"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2568"></a>                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCapSizingFactor</span>
<a name="ln-2569"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2570"></a>                            <span class="s1">&#39;Cooling And Discharge Mode Rated Total Evaporator Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2571"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCap</span> <span class="p">)</span>
<a name="ln-2572"></a>  <span class="n">ENDIF</span>
<a name="ln-2573"></a>
<a name="ln-2574"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeModeAvailable</span>  <span class="p">&amp;</span>
<a name="ln-2575"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCap</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2576"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2577"></a>                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCapSizingFactor</span>
<a name="ln-2578"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2579"></a>                            <span class="s1">&#39;Cooling And Discharge Mode Rated Storage Discharging Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2580"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCap</span> <span class="p">)</span>
<a name="ln-2581"></a>  <span class="n">ENDIF</span>
<a name="ln-2582"></a>
<a name="ln-2583"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyModeAvailable</span>  <span class="p">&amp;</span>
<a name="ln-2584"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacity</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2585"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacity</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2586"></a>                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacitySizingFactor</span>
<a name="ln-2587"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2588"></a>                            <span class="s1">&#39;Charge Only Mode Rated Storage Charging Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2589"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacity</span> <span class="p">)</span>
<a name="ln-2590"></a>  <span class="n">ENDIF</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span>  <span class="p">&amp;</span>
<a name="ln-2593"></a>        <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2594"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2595"></a>                   <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCapSizingFactor</span>
<a name="ln-2596"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2597"></a>                            <span class="s1">&#39;Discharge Only Mode Rated Storage Discharging Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2598"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="p">)</span>
<a name="ln-2599"></a>  <span class="n">ENDIF</span>
<a name="ln-2600"></a>
<a name="ln-2601"></a>  <span class="k">IF</span> <span class="p">((</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2602"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2603"></a>    <span class="c">! for fluid tanks, assume a 10C deltaT or diff between max and min, whichever is smaller</span>
<a name="ln-2604"></a>    <span class="n">deltaT</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">FluidTankSizingDeltaT</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2605"></a>                 <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2606"></a>
<a name="ln-2607"></a>    <span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2608"></a>                           <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESWaterStorageTank&#39;</span><span class="p">)</span>
<a name="ln-2609"></a>    <span class="n">Cp</span>  <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2610"></a>                                              <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESWaterStorageTank&#39;</span><span class="p">)</span>
<a name="ln-2611"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2612"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2613"></a>                                               <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageCapacitySizingFactor</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2614"></a>                                               <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">deltaT</span><span class="p">)</span>
<a name="ln-2615"></a>    <span class="k">ELSE</span>
<a name="ln-2616"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-2617"></a>                                               <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageCapacitySizingFactor</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2618"></a>                                               <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="n">deltaT</span><span class="p">)</span>
<a name="ln-2619"></a>    <span class="n">ENDIF</span>
<a name="ln-2620"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2621"></a>                            <span class="s1">&#39;Fluid Storage Volume [m3]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2622"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span> <span class="p">)</span>
<a name="ln-2623"></a>  <span class="n">ENDIF</span>
<a name="ln-2624"></a>  <span class="k">IF</span> <span class="p">((</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2625"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">==</span> <span class="n">AutoCalculate</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyModeAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2628"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span> <span class="p">&amp;</span>
<a name="ln-2629"></a>                              <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageCapacitySizingFactor</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-2630"></a>    <span class="k">ELSE</span>
<a name="ln-2631"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2632"></a>                              <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageCapacitySizingFactor</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-2633"></a>    <span class="n">ENDIF</span>
<a name="ln-2634"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2635"></a>                            <span class="s1">&#39;Ice Storage Capacity [GJ]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2636"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">/</span> <span class="mf">1.d+09</span> <span class="p">)</span>
<a name="ln-2637"></a>  <span class="n">ENDIF</span>
<a name="ln-2638"></a>
<a name="ln-2639"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2640"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">*</span> <span class="mf">0.004266d0</span> <span class="c">! w/w (15 w/ton)</span>
<a name="ln-2641"></a>    <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2642"></a>                            <span class="s1">&#39;Evaporative Condenser Pump Rated Power Consumption [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2643"></a>                             <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="p">)</span>
<a name="ln-2644"></a>
<a name="ln-2645"></a>  <span class="n">ENDIF</span>
<a name="ln-2646"></a>
<a name="ln-2647"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilType</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed:ThermalStorage&#39;</span><span class="p">)</span>
<a name="ln-2648"></a>
<a name="ln-2649"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilTotCap</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span><span class="p">)</span>
<a name="ln-2650"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSensCap</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2651"></a>                          <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedSHR</span><span class="p">)</span>
<a name="ln-2652"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilLatCap</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="p">&amp;</span>
<a name="ln-2653"></a>                    <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedSHR</span><span class="p">)</span>
<a name="ln-2654"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilSHR</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedSHR</span><span class="p">)</span>
<a name="ln-2655"></a>  <span class="k">CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">pdchCoolCoilNomEff</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedCOP</span><span class="p">)</span>
<a name="ln-2656"></a>
<a name="ln-2657"></a>
<a name="ln-2658"></a>  <span class="k">RETURN</span>
<a name="ln-2659"></a>
<a name="ln-2660"></a><span class="k">END SUBROUTINE </span><span class="n">SizeTESCoil</span>
<a name="ln-2661"></a>
<a name="ln-2662"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESCoilOffMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2663"></a>
<a name="ln-2664"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2665"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-2666"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-2667"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2668"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2669"></a>
<a name="ln-2670"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2671"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2672"></a>
<a name="ln-2673"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2674"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2675"></a>
<a name="ln-2676"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2677"></a>          <span class="c">! na</span>
<a name="ln-2678"></a>
<a name="ln-2679"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2680"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-2681"></a>
<a name="ln-2682"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2683"></a>
<a name="ln-2684"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2685"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-2686"></a>
<a name="ln-2687"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2688"></a>          <span class="c">! na</span>
<a name="ln-2689"></a>
<a name="ln-2690"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2691"></a>          <span class="c">! na</span>
<a name="ln-2692"></a>
<a name="ln-2693"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2694"></a>          <span class="c">! na</span>
<a name="ln-2695"></a>
<a name="ln-2696"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2697"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">StandbyAncillaryPower</span>
<a name="ln-2698"></a>
<a name="ln-2699"></a><span class="c">!coil is off; just pass through conditions</span>
<a name="ln-2700"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AvailSchedNum</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2701"></a><span class="k">    </span><span class="n">StandbyAncillaryPower</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-2702"></a>  <span class="k">ELSE</span>
<a name="ln-2703"></a><span class="k">    </span><span class="n">StandbyAncillaryPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2704"></a>  <span class="n">ENDIF</span>
<a name="ln-2705"></a>
<a name="ln-2706"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>   <span class="o">=</span> <span class="n">StandbyAncillaryPower</span>
<a name="ln-2707"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>  <span class="o">=</span> <span class="n">StandbyAncillaryPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-2708"></a>
<a name="ln-2709"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2710"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2711"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2712"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2713"></a>                                                          <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2714"></a>                                                                      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2715"></a>                                                                      <span class="s1">&#39;CalcTESCoilOffMode&#39;</span><span class="p">)</span>
<a name="ln-2716"></a>
<a name="ln-2717"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2718"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2719"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-2720"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2721"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2722"></a>                                                          <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2723"></a>                                                                      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2724"></a>                                                                      <span class="s1">&#39;CalcTESCoilOffMode&#39;</span><span class="p">)</span>
<a name="ln-2725"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>      <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2726"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2727"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2728"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2729"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2730"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2731"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2732"></a>
<a name="ln-2733"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>              <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2734"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>                <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-2735"></a>
<a name="ln-2736"></a>  <span class="k">CALL </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2737"></a>
<a name="ln-2738"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2739"></a>
<a name="ln-2740"></a>  <span class="k">CALL </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2741"></a>
<a name="ln-2742"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2743"></a><span class="k">    CALL </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-2744"></a>  <span class="n">ENDIF</span>
<a name="ln-2745"></a>
<a name="ln-2746"></a>  <span class="k">RETURN</span>
<a name="ln-2747"></a>
<a name="ln-2748"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESCoilOffMode</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESCoilCoolingOnlyMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-2751"></a>
<a name="ln-2752"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2753"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-2754"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-2755"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2756"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2757"></a>
<a name="ln-2758"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2759"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2760"></a>
<a name="ln-2761"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2762"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-2763"></a>
<a name="ln-2764"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2765"></a>          <span class="c">! na</span>
<a name="ln-2766"></a>
<a name="ln-2767"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2768"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-2769"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-2770"></a>
<a name="ln-2771"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2772"></a>
<a name="ln-2773"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2774"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-2775"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-2776"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-2777"></a>
<a name="ln-2778"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2779"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">30</span>
<a name="ln-2780"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RelaxationFactor</span> <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-2781"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">0.1d0</span>
<a name="ln-2782"></a>
<a name="ln-2783"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-2784"></a>          <span class="c">! na</span>
<a name="ln-2785"></a>
<a name="ln-2786"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-2787"></a>          <span class="c">! na</span>
<a name="ln-2788"></a>
<a name="ln-2789"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2790"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-2791"></a>                                   <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-2792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>      <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-2793"></a>                                    <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-2794"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>      <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-2795"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletEnthalpy</span>    <span class="c">! condenser inlet enthalpy [J/kg]</span>
<a name="ln-2796"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirSidePressure</span>  <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-2797"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotCond</span>  <span class="c">! condenser total heat rejection rate [W]</span>
<a name="ln-2798"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondOutletEnthalpy</span>   <span class="c">!condesner outlet enthalpy [J/kg]</span>
<a name="ln-2799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>  <span class="c">! outdoor air dry bulb local variable [C]</span>
<a name="ln-2800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>   <span class="c">! outdoor air humidity ratio local [kg/kg]</span>
<a name="ln-2801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>  <span class="c">! outdoor air wetbulb local [C]</span>
<a name="ln-2802"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapAirMassFlow</span>   <span class="c">! local for evaporator air mass flow [kg/s]</span>
<a name="ln-2803"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletDryBulb</span> <span class="c">! evaporator inlet air drybulb [C]</span>
<a name="ln-2804"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletHumRat</span> <span class="c">! evaporator inlet air humidity ratio [kg/kg]</span>
<a name="ln-2805"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletWetBulb</span> <span class="c">! evaporator inlet air wetbulb [C]</span>
<a name="ln-2806"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletEnthalpy</span> <span class="c">! evaporator inlet air enthalpy [J/kg]</span>
<a name="ln-2807"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span> <span class="c">! evaporator inlet air mass flow divided by design mass flow [ ]</span>
<a name="ln-2808"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span> <span class="c">! total coolin capacity modification factor due to temps []</span>
<a name="ln-2809"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span> <span class="c">!Total cooling capacity modification factor due to flow []</span>
<a name="ln-2810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span> <span class="c">! total cooling capacity</span>
<a name="ln-2811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRTempFac</span> <span class="c">! sensible heat ratio modification factor due to temps []</span>
<a name="ln-2812"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRFlowFac</span> <span class="c">! sensible heat ratio modification factor due to flow []</span>
<a name="ln-2813"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span> <span class="c">! sensible heat ratio</span>
<a name="ln-2814"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>   <span class="c">! part load factor</span>
<a name="ln-2815"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFraction</span> <span class="c">! compressor running time divided by full time of timestep.</span>
<a name="ln-2816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span> <span class="c">! evaporator outlet full load enthalpy [J/kg]</span>
<a name="ln-2817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>   <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-2818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span> <span class="c">! evaporator outlet humidity ratio at full load</span>
<a name="ln-2819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>  <span class="c">!evaporator outlet air temperature at full load [C]</span>
<a name="ln-2820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirEnthalpy</span> <span class="c">! evaporator outlet air enthalpy [J/kg]</span>
<a name="ln-2821"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirHumRat</span> <span class="c">!evaporator outlet air humidity ratio [kg/kg]</span>
<a name="ln-2822"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirTemp</span> <span class="c">!evaporator outlet dryblub [C]</span>
<a name="ln-2823"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="c">! energy input ratio modification factor due to temperatures []</span>
<a name="ln-2824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span> <span class="c">!energy input ratio modification factor due to flow []</span>
<a name="ln-2825"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">! energy input ratio</span>
<a name="ln-2826"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingPower</span> <span class="c">! compressor electric power</span>
<a name="ln-2827"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="c">! minimum air humidity ratio</span>
<a name="ln-2828"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadOutAirEnth</span> <span class="c">! local leaving enthalpy at part load</span>
<a name="ln-2829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="c">! local leaving drybulb if coil were dry</span>
<a name="ln-2830"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoilMightBeDry</span>
<a name="ln-2831"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Counter</span>
<a name="ln-2832"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Converged</span>
<a name="ln-2833"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-2834"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletWetBulb</span>
<a name="ln-2835"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>
<a name="ln-2836"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>
<a name="ln-2837"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>
<a name="ln-2838"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>
<a name="ln-2839"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRadp</span>
<a name="ln-2840"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>
<a name="ln-2841"></a>
<a name="ln-2842"></a>  <span class="c">! first deal with condenser</span>
<a name="ln-2843"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2844"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-2845"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2846"></a><span class="k">      </span><span class="n">CondInletTemp</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-2847"></a>      <span class="n">CondInletHumrat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-2848"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-2849"></a>    <span class="k">ELSE</span>
<a name="ln-2850"></a><span class="k">     </span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2851"></a>     <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2852"></a>
<a name="ln-2853"></a>    <span class="n">ENDIF</span>
<a name="ln-2854"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-2855"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2856"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-2857"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2858"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-2859"></a>      <span class="n">OutdoorHumRat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-2860"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-2861"></a>      <span class="n">OutdoorWetBulb</span>   <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-2862"></a>    <span class="k">ELSE</span>
<a name="ln-2863"></a><span class="k">     </span><span class="n">OutdoorDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2864"></a>     <span class="n">OutdoorHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2865"></a>     <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span> <span class="n">OutdoorHumRat</span><span class="p">,</span> <span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2866"></a>    <span class="n">ENDIF</span>
<a name="ln-2867"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-2868"></a>    <span class="c">! direct evap cool model</span>
<a name="ln-2869"></a>    <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">)</span>
<a name="ln-2870"></a>    <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2871"></a>  <span class="n">ENDIF</span>
<a name="ln-2872"></a>
<a name="ln-2873"></a>  <span class="n">EvapAirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-2874"></a>  <span class="n">EvapInletDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-2875"></a>  <span class="n">EvapInletHumRat</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-2876"></a>  <span class="n">EvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2877"></a>  <span class="n">EvapInletEnthalpy</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-2878"></a>  <span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">EvapAirMassFlow</span> <span class="o">&gt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is running</span>
<a name="ln-2881"></a>
<a name="ln-2882"></a>    <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirMassFlowRate</span>
<a name="ln-2883"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-2884"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">)</span> <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-2885"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-2886"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span>  <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-2887"></a>    <span class="n">TotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-2888"></a>    <span class="c">! now see if coil might be running dry</span>
<a name="ln-2889"></a>    <span class="n">PartLoadOutAirEnth</span> <span class="o">=</span>  <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-2890"></a>    <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span><span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2891"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">&gt;</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2892"></a><span class="k">      </span><span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2893"></a>      <span class="c">! find wADP, humidity ratio at apparatus dewpoint and inlet hum rat that would have dry coil</span>
<a name="ln-2894"></a>      <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">EvapInletHumRat</span>
<a name="ln-2895"></a>      <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">EvapInletWetBulb</span>
<a name="ln-2896"></a>      <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2897"></a>      <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2898"></a>      <span class="k">DO While</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Converged</span><span class="p">)</span>
<a name="ln-2899"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyCapFTempCurve</span><span class="p">,</span> <span class="n">DryCoilTestEvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-2900"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">)</span> <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-2901"></a>        <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-2902"></a>        <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span>  <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-2903"></a>        <span class="n">TotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedTotCap</span> <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-2904"></a>
<a name="ln-2905"></a>        <span class="c">! coil bypass factor = 0.0</span>
<a name="ln-2906"></a>        <span class="n">hADP</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-2907"></a>        <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2908"></a>        <span class="n">wADP</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">PsyWfnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span> <span class="n">hADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-2909"></a>        <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">wADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2910"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2911"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">EvapInletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-2912"></a>        <span class="k">ELSE</span>
<a name="ln-2913"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-2914"></a>        <span class="n">ENDIF</span>
<a name="ln-2915"></a>
<a name="ln-2916"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">wADP</span> <span class="o">&gt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2917"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="mf">0.00001d0</span>
<a name="ln-2918"></a>          <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">-</span>  <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-2919"></a>
<a name="ln-2920"></a>          <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">RelaxationFactor</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RelaxationFactor</span><span class="p">)</span><span class="o">*</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-2921"></a>          <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2922"></a>                                                    <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2923"></a>
<a name="ln-2924"></a>          <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2925"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2926"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2927"></a>          <span class="k">ELSE</span>
<a name="ln-2928"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2929"></a>          <span class="n">ENDIF</span>
<a name="ln-2930"></a>        <span class="k">ELSE</span>
<a name="ln-2931"></a><span class="k">          </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2932"></a>        <span class="n">ENDIF</span>
<a name="ln-2933"></a>
<a name="ln-2934"></a>      <span class="n">ENDDO</span>
<a name="ln-2935"></a>    <span class="n">ENDIF</span>
<a name="ln-2936"></a>
<a name="ln-2937"></a>    <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlySHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">)</span>
<a name="ln-2938"></a>    <span class="n">SHRFlowFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlySHRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-2939"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedSHR</span> <span class="o">*</span> <span class="n">SHRTempFac</span> <span class="o">*</span> <span class="n">SHRFlowFac</span>
<a name="ln-2940"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-2941"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-2942"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">CoilMightBeDry</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2943"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">EvapInletHumRat</span> <span class="o">&lt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is dry for sure</span>
<a name="ln-2944"></a>        <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2945"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2946"></a><span class="k">        </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRadp</span>
<a name="ln-2947"></a>      <span class="n">ENDIF</span>
<a name="ln-2948"></a>    <span class="n">ENDIF</span>
<a name="ln-2949"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyPLFFPLRCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-2950"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&gt;=</span> <span class="n">PartLoadRatio</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PLF</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2951"></a><span class="k">      </span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-2952"></a>    <span class="k">ELSE</span>
<a name="ln-2953"></a><span class="k">      </span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! warn maybe</span>
<a name="ln-2954"></a>    <span class="n">ENDIF</span>
<a name="ln-2955"></a>    <span class="c">!  Calculate full load output conditions</span>
<a name="ln-2956"></a>    <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-2957"></a>
<a name="ln-2958"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-2959"></a>    <span class="c">!The following will often throw psych warnings for neg w, suppress warnings because error condition is handled in next IF</span>
<a name="ln-2960"></a>    <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">,</span> <span class="n">SuppressWarnings</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-2961"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2962"></a>    <span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-2963"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2964"></a><span class="k">      </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2965"></a>      <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2966"></a>    <span class="n">ENDIF</span>
<a name="ln-2967"></a>
<a name="ln-2968"></a>    <span class="c">! Continuous fan, cycling compressor</span>
<a name="ln-2969"></a>    <span class="n">EvapOutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2970"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletEnthalpy</span><span class="p">)</span>
<a name="ln-2971"></a>    <span class="n">EvapOutletAirHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-2972"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletHumRat</span><span class="p">)</span>
<a name="ln-2973"></a>    <span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">EvapOutletAirHumRat</span><span class="p">)</span>
<a name="ln-2974"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2975"></a><span class="k">      </span><span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2976"></a>      <span class="n">EvapOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2977"></a>    <span class="n">ENDIF</span>
<a name="ln-2978"></a>    <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-2979"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">)</span>
<a name="ln-2980"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRTempModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-2981"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyEIRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-2982"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRFlowModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-2983"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingOnlyRatedCOP</span>
<a name="ln-2984"></a>
<a name="ln-2985"></a>    <span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">RuntimeFraction</span>
<a name="ln-2986"></a>
<a name="ln-2987"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">EvapOutletAirTemp</span>
<a name="ln-2988"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">EvapOutletAirHumRat</span>
<a name="ln-2989"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">EvapOutletAirEnthalpy</span>
<a name="ln-2990"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-2991"></a>
<a name="ln-2992"></a>    <span class="c">! determine condenser leaving conditions</span>
<a name="ln-2993"></a>    <span class="n">QdotCond</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span> <span class="n">RuntimeFraction</span> <span class="o">+</span> <span class="n">ElecCoolingPower</span>
<a name="ln-2994"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-2995"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-2996"></a>    <span class="n">CondInletEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">CondInletHumRat</span> <span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-2997"></a>    <span class="n">CondOutletEnthalpy</span> <span class="o">=</span> <span class="n">CondInletEnthalpy</span> <span class="o">+</span> <span class="n">QdotCond</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-2998"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span> <span class="n">CondOutletEnthalpy</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2999"></a>                                                                        <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-3000"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">HumRat</span>   <span class="o">=</span> <span class="n">CondInletHumrat</span>
<a name="ln-3001"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">CondOutletEnthalpy</span>
<a name="ln-3002"></a>
<a name="ln-3003"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">ElecCoolingPower</span> <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-3004"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3005"></a>
<a name="ln-3006"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">RuntimeFraction</span>
<a name="ln-3007"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span>    <span class="o">=</span> <span class="n">RuntimeFraction</span>
<a name="ln-3008"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span> <span class="n">RuntimeFraction</span> <span class="c">! double check this</span>
<a name="ln-3009"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span> <span class="n">RuntimeFraction</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3010"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3011"></a>                        <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span> <span class="p">)</span>
<a name="ln-3012"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">*</span><span class="p">&amp;</span>
<a name="ln-3013"></a>                      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-3014"></a>                        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3015"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">&gt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3016"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>
<a name="ln-3017"></a>    <span class="n">ENDIF</span>
<a name="ln-3018"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3019"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="p">&amp;</span>
<a name="ln-3020"></a>                                              <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>
<a name="ln-3021"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3022"></a>
<a name="ln-3023"></a>  <span class="k">ELSE</span> <span class="c">!coil is off; just pass through conditions</span>
<a name="ln-3024"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-3025"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3026"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3027"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3028"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3029"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3030"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3031"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3032"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3033"></a>                                                                       <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3034"></a>                                                                       <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-3035"></a>
<a name="ln-3036"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3037"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3038"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3039"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3040"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3041"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3042"></a>                                                                       <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3043"></a>                                                                       <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-3044"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3045"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3046"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3047"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3048"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3049"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3050"></a>
<a name="ln-3051"></a>
<a name="ln-3052"></a>
<a name="ln-3053"></a>  <span class="n">ENDIF</span>
<a name="ln-3054"></a>
<a name="ln-3055"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>              <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3056"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>                <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3057"></a>
<a name="ln-3058"></a>  <span class="k">CALL </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3059"></a>
<a name="ln-3060"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-3061"></a>
<a name="ln-3062"></a>  <span class="k">CALL </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3063"></a>
<a name="ln-3064"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3065"></a><span class="k">    CALL </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3066"></a>    <span class="k">CALL </span><span class="n">UpdateEvaporativeCondenserWaterUse</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span> <span class="p">)</span>
<a name="ln-3067"></a>  <span class="n">ENDIF</span>
<a name="ln-3068"></a>
<a name="ln-3069"></a>  <span class="k">RETURN</span>
<a name="ln-3070"></a>
<a name="ln-3071"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESCoilCoolingOnlyMode</span>
<a name="ln-3072"></a>
<a name="ln-3073"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESCoilCoolingAndChargeMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3074"></a>
<a name="ln-3075"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3076"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-3077"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-3078"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3079"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3080"></a>
<a name="ln-3081"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3082"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3083"></a>
<a name="ln-3084"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3085"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3086"></a>
<a name="ln-3087"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3088"></a>          <span class="c">! na</span>
<a name="ln-3089"></a>
<a name="ln-3090"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3091"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-3092"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3093"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-3094"></a>
<a name="ln-3095"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3096"></a>
<a name="ln-3097"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3098"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-3099"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-3100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-3101"></a>
<a name="ln-3102"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3103"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">30</span>
<a name="ln-3104"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RelaxationFactor</span> <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-3105"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">0.1d0</span>
<a name="ln-3106"></a>
<a name="ln-3107"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3108"></a>          <span class="c">! na</span>
<a name="ln-3109"></a>
<a name="ln-3110"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3111"></a>          <span class="c">! na</span>
<a name="ln-3112"></a>
<a name="ln-3113"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3114"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-3115"></a>                                   <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-3116"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>      <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-3117"></a>                                    <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-3118"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>      <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-3119"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletEnthalpy</span>    <span class="c">! condenser inlet enthalpy [J/kg]</span>
<a name="ln-3120"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirSidePressure</span>  <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-3121"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotCond</span>  <span class="c">! condenser total heat rejection rate [W]</span>
<a name="ln-3122"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondOutletEnthalpy</span>   <span class="c">!condesner outlet enthalpy [J/kg]</span>
<a name="ln-3123"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>  <span class="c">! outdoor air dry bulb local variable [C]</span>
<a name="ln-3124"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>   <span class="c">! outdoor air humidity ratio local [kg/kg]</span>
<a name="ln-3125"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>  <span class="c">! outdoor air wetbulb local [C]</span>
<a name="ln-3126"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapAirMassFlow</span>   <span class="c">! local for evaporator air mass flow [kg/s]</span>
<a name="ln-3127"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletDryBulb</span> <span class="c">! evaporator inlet air drybulb [C]</span>
<a name="ln-3128"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletHumRat</span> <span class="c">! evaporator inlet air humidity ratio [kg/kg]</span>
<a name="ln-3129"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletWetBulb</span> <span class="c">! evaporator inlet air wetbulb [C]</span>
<a name="ln-3130"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletEnthalpy</span> <span class="c">! evaporator inlet air enthalpy [J/kg]</span>
<a name="ln-3131"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span> <span class="c">! evaporator inlet air mass flow divided by design mass flow [ ]</span>
<a name="ln-3132"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCapTempModFac</span> <span class="c">! total coolin capacity modification factor due to temps []</span>
<a name="ln-3133"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCapFlowModFac</span> <span class="c">!Total cooling capacity modification factor due to flow []</span>
<a name="ln-3134"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCap</span> <span class="c">! total cooling capacity</span>
<a name="ln-3135"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRTempFac</span> <span class="c">! sensible heat ratio modification factor due to temps []</span>
<a name="ln-3136"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRFlowFac</span> <span class="c">! sensible heat ratio modification factor due to flow []</span>
<a name="ln-3137"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span> <span class="c">! sensible heat ratio</span>
<a name="ln-3138"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>   <span class="c">! part load factor</span>
<a name="ln-3139"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapRuntimeFraction</span> <span class="c">! compressor running time divided by full time of timestep.</span>
<a name="ln-3140"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span> <span class="c">! evaporator outlet full load enthalpy [J/kg]</span>
<a name="ln-3141"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>   <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-3142"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span> <span class="c">! evaporator outlet humidity ratio at full load</span>
<a name="ln-3143"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>  <span class="c">!evaporator outlet air temperature at full load [C]</span>
<a name="ln-3144"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirEnthalpy</span> <span class="c">! evaporator outlet air enthalpy [J/kg]</span>
<a name="ln-3145"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirHumRat</span> <span class="c">!evaporator outlet air humidity ratio [kg/kg]</span>
<a name="ln-3146"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirTemp</span> <span class="c">!evaporator outlet dryblub [C]</span>
<a name="ln-3147"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="c">! energy input ratio modification factor due to temperatures []</span>
<a name="ln-3148"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span> <span class="c">!energy input ratio modification factor due to flow []</span>
<a name="ln-3149"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">! energy input ratio</span>
<a name="ln-3150"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapElecCoolingPower</span> <span class="c">! compressor electric power</span>
<a name="ln-3151"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="c">! minimum air humidity ratio</span>
<a name="ln-3152"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sTES</span> <span class="c">! stat of Thermal energy storage [C or fraction of ice]</span>
<a name="ln-3153"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TESCanBeCharged</span>
<a name="ln-3154"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-3155"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankMass</span>            <span class="c">! Mass of fluid in tank (kg)</span>
<a name="ln-3156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpTank</span>              <span class="c">! Specific heat of water in tank (J/kg K)</span>
<a name="ln-3157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotChargeLimit</span> <span class="c">! limit for charge cooling power to hit limit of storage.</span>
<a name="ln-3158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeCapModFac</span>
<a name="ln-3159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeCapPLRModFac</span>
<a name="ln-3160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotChargeCap</span>
<a name="ln-3161"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeEIRTempModFac</span>
<a name="ln-3162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeEIRFlowModFac</span>
<a name="ln-3163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeEIR</span>
<a name="ln-3164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeElectricCoolingPower</span>
<a name="ln-3165"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ChargeRuntimeFraction</span>
<a name="ln-3166"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadOutAirEnth</span> <span class="c">! local leaving enthalpy at part load</span>
<a name="ln-3167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="c">! local leaving drybulb if coil were dry</span>
<a name="ln-3168"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoilMightBeDry</span>
<a name="ln-3169"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Counter</span>
<a name="ln-3170"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Converged</span>
<a name="ln-3171"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-3172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletWetBulb</span>
<a name="ln-3173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>
<a name="ln-3174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>
<a name="ln-3175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>
<a name="ln-3176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>
<a name="ln-3177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRadp</span>
<a name="ln-3178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>
<a name="ln-3179"></a>
<a name="ln-3180"></a>  <span class="c">! first deal with condenser</span>
<a name="ln-3181"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3182"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-3183"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3184"></a><span class="k">      </span><span class="n">CondInletTemp</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-3185"></a>      <span class="n">CondInletHumrat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-3186"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-3187"></a>    <span class="k">ELSE</span>
<a name="ln-3188"></a><span class="k">     </span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3189"></a>     <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3190"></a>
<a name="ln-3191"></a>    <span class="n">ENDIF</span>
<a name="ln-3192"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3193"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3194"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-3195"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3196"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-3197"></a>      <span class="n">OutdoorHumRat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-3198"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-3199"></a>      <span class="n">OutdoorWetBulb</span>   <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-3200"></a>    <span class="k">ELSE</span>
<a name="ln-3201"></a><span class="k">     </span><span class="n">OutdoorDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3202"></a>     <span class="n">OutdoorHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3203"></a>     <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span> <span class="n">OutdoorHumRat</span><span class="p">,</span> <span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3204"></a>    <span class="n">ENDIF</span>
<a name="ln-3205"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3206"></a>    <span class="c">! direct evap cool model</span>
<a name="ln-3207"></a>    <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">)</span>
<a name="ln-3208"></a>    <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3209"></a>  <span class="n">ENDIF</span>
<a name="ln-3210"></a>
<a name="ln-3211"></a>  <span class="n">EvapAirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3212"></a>  <span class="n">EvapInletDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3213"></a>  <span class="n">EvapInletHumRat</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3214"></a>  <span class="n">EvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3215"></a>  <span class="n">EvapInletEnthalpy</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-3216"></a>  <span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3217"></a>
<a name="ln-3218"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3219"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span>
<a name="ln-3220"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">sTES</span> <span class="o">&gt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&lt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3221"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3222"></a>      <span class="c">!find charge limit to reach limits</span>
<a name="ln-3223"></a>      <span class="n">rho</span>             <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3224"></a>                                         <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3225"></a>      <span class="n">TankMass</span>        <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span>
<a name="ln-3226"></a>      <span class="n">CpTank</span>          <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3227"></a>                                              <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3228"></a>      <span class="c">!simple linear approximation of DT/Dt term in McpDT/Dt</span>
<a name="ln-3229"></a>      <span class="n">QdotChargeLimit</span> <span class="o">=</span> <span class="n">TankMass</span> <span class="o">*</span> <span class="n">CpTank</span> <span class="o">*</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3230"></a>                                                  <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3231"></a>    <span class="k">ELSE</span>
<a name="ln-3232"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3233"></a>    <span class="n">ENDIF</span>
<a name="ln-3234"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3235"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span>
<a name="ln-3236"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&lt;</span> <span class="mf">1.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3237"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3238"></a>      <span class="c">!find charge limit to reach limit</span>
<a name="ln-3239"></a>      <span class="n">QdotChargeLimit</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">sTES</span><span class="p">)</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3240"></a>    <span class="k">ELSE</span>
<a name="ln-3241"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3242"></a>    <span class="n">ENDIF</span>
<a name="ln-3243"></a>  <span class="n">ENDIF</span>
<a name="ln-3244"></a>
<a name="ln-3245"></a>
<a name="ln-3246"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">EvapAirMassFlow</span> <span class="o">&gt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is running</span>
<a name="ln-3247"></a>
<a name="ln-3248"></a>    <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirMassFlowRate</span>
<a name="ln-3249"></a>    <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3250"></a>                                           <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3251"></a>    <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapTempModFac</span><span class="p">)</span> <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3252"></a>    <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3253"></a>    <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapFlowModFac</span><span class="p">)</span>  <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3254"></a>    <span class="n">EvapTotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCap</span> <span class="o">*</span> <span class="n">EvapTotCapTempModFac</span> <span class="o">*</span> <span class="n">EvapTotCapFlowModFac</span>
<a name="ln-3255"></a>    <span class="c">! now see if coil is running dry</span>
<a name="ln-3256"></a>    <span class="n">PartLoadOutAirEnth</span> <span class="o">=</span>  <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">EvapTotCap</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-3257"></a>    <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span><span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3258"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">&gt;</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3259"></a><span class="k">      </span><span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3260"></a>      <span class="c">! find wADP, humidity ratio at apparatus dewpoint and inlet hum rat that would have dry coil</span>
<a name="ln-3261"></a>      <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">EvapInletHumRat</span>
<a name="ln-3262"></a>      <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">EvapInletWetBulb</span>
<a name="ln-3263"></a>      <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3264"></a>      <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3265"></a>      <span class="k">DO While</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Converged</span><span class="p">)</span>
<a name="ln-3266"></a>        <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3267"></a>                                               <span class="n">DryCoilTestEvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3268"></a>        <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapTempModFac</span><span class="p">)</span> <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3269"></a>        <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3270"></a>        <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapFlowModFac</span><span class="p">)</span>  <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3271"></a>        <span class="n">EvapTotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedTotCap</span> <span class="o">*</span> <span class="n">EvapTotCapTempModFac</span> <span class="o">*</span> <span class="n">EvapTotCapFlowModFac</span>
<a name="ln-3272"></a>        <span class="c">! coil bypass factor = 0.0</span>
<a name="ln-3273"></a>        <span class="n">hADP</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">EvapTotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-3274"></a>        <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3275"></a>        <span class="n">wADP</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">PsyWfnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span> <span class="n">hADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3276"></a>        <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">wADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3277"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3278"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">EvapInletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-3279"></a>        <span class="k">ELSE</span>
<a name="ln-3280"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3281"></a>        <span class="n">ENDIF</span>
<a name="ln-3282"></a>
<a name="ln-3283"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">wADP</span> <span class="o">&gt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3284"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="mf">0.00001d0</span>
<a name="ln-3285"></a>          <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">-</span>  <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-3286"></a>
<a name="ln-3287"></a>          <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">RelaxationFactor</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RelaxationFactor</span><span class="p">)</span><span class="o">*</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-3288"></a>          <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3289"></a>                                                    <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3290"></a>
<a name="ln-3291"></a>          <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3292"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3293"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3294"></a>          <span class="k">ELSE</span>
<a name="ln-3295"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3296"></a>          <span class="n">ENDIF</span>
<a name="ln-3297"></a>        <span class="k">ELSE</span>
<a name="ln-3298"></a><span class="k">          </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3299"></a>        <span class="n">ENDIF</span>
<a name="ln-3300"></a>
<a name="ln-3301"></a>      <span class="n">ENDDO</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a>    <span class="n">ENDIF</span>
<a name="ln-3304"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempObjectNum</span><span class="p">)</span>
<a name="ln-3305"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span> <span class="p">)</span>
<a name="ln-3306"></a>      <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">)</span>
<a name="ln-3307"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span> <span class="p">)</span>
<a name="ln-3308"></a>      <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3309"></a>    <span class="k">END SELECT</span>
<a name="ln-3310"></a><span class="k">    </span><span class="n">SHRFlowFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeSHRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3311"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedSHR</span> <span class="o">*</span> <span class="n">SHRTempFac</span> <span class="o">*</span> <span class="n">SHRFlowFac</span>
<a name="ln-3312"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-3313"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-3314"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">CoilMightBeDry</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3315"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">EvapInletHumRat</span> <span class="o">&lt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is dry for sure</span>
<a name="ln-3316"></a>        <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3317"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3318"></a><span class="k">        </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRadp</span>
<a name="ln-3319"></a>      <span class="n">ENDIF</span>
<a name="ln-3320"></a>    <span class="n">ENDIF</span>
<a name="ln-3321"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingPLFFPLRCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3322"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&gt;=</span> <span class="n">PartLoadRatio</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PLF</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3323"></a><span class="k">      </span><span class="n">EvapRuntimeFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-3324"></a>    <span class="k">ELSE</span>
<a name="ln-3325"></a><span class="k">      </span><span class="n">EvapRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! warn maybe</span>
<a name="ln-3326"></a>    <span class="n">ENDIF</span>
<a name="ln-3327"></a>
<a name="ln-3328"></a>    <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-3329"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3330"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRTempModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-3331"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingEIRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3332"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRFlowModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-3333"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeCoolingRatedCOP</span>
<a name="ln-3334"></a>
<a name="ln-3335"></a>    <span class="n">EvapElecCoolingPower</span> <span class="o">=</span> <span class="n">EvapTotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">EvapRuntimeFraction</span>
<a name="ln-3336"></a>
<a name="ln-3337"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCanBeCharged</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3338"></a><span class="k">      </span><span class="n">ChargeCapModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3339"></a>                                        <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3340"></a>      <span class="n">ChargeCapModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">ChargeCapModFac</span><span class="p">)</span>
<a name="ln-3341"></a>
<a name="ln-3342"></a>      <span class="n">ChargeCapPLRModFac</span><span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3343"></a>      <span class="n">ChargeCapPLRModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">ChargeCapPLRModFac</span><span class="p">)</span>
<a name="ln-3344"></a>
<a name="ln-3345"></a>      <span class="n">TotChargeCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCap</span> <span class="o">*</span> <span class="n">ChargeCapModFac</span> <span class="o">*</span> <span class="n">ChargeCapPLRModFac</span>
<a name="ln-3346"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotChargeCap</span> <span class="o">&gt;</span> <span class="n">QdotChargeLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3347"></a><span class="k">        </span><span class="n">ChargeRuntimeFraction</span> <span class="o">=</span> <span class="n">QdotChargeLimit</span> <span class="o">/</span> <span class="n">TotChargeCap</span>
<a name="ln-3348"></a>        <span class="n">TotChargeCap</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">TotChargeCap</span><span class="p">,</span> <span class="n">QdotChargeLimit</span><span class="p">)</span>
<a name="ln-3349"></a>      <span class="k">ELSE</span>
<a name="ln-3350"></a><span class="k">        </span><span class="n">ChargeRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3351"></a>      <span class="n">ENDIF</span>
<a name="ln-3352"></a>      <span class="n">ChargeEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempCurve</span><span class="p">,&amp;</span>
<a name="ln-3353"></a>                                        <span class="n">EvapInletWetBulb</span><span class="p">,</span><span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3354"></a>      <span class="n">ChargeEIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">ChargeEIRTempModFac</span> <span class="p">)</span>
<a name="ln-3355"></a>      <span class="n">ChargeEIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3356"></a>      <span class="n">ChargeEIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span> <span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">ChargeEIRFlowModFac</span><span class="p">)</span>
<a name="ln-3357"></a>      <span class="n">ChargeEIR</span> <span class="o">=</span> <span class="p">(</span><span class="n">ChargeEIRTempModFac</span> <span class="o">*</span> <span class="n">ChargeEIRFlowModFac</span><span class="p">)</span> <span class="o">/</span>   <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingRatedCOP</span>
<a name="ln-3358"></a>      <span class="n">ChargeElectricCoolingPower</span> <span class="o">=</span> <span class="n">TotChargeCap</span> <span class="o">*</span> <span class="n">ChargeEIR</span>
<a name="ln-3359"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="o">-</span> <span class="n">TotChargeCap</span>
<a name="ln-3360"></a>    <span class="k">ELSE</span>
<a name="ln-3361"></a><span class="k">      </span><span class="n">TotChargeCap</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3362"></a>      <span class="n">ChargeElectricCoolingPower</span> <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-3363"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3364"></a>      <span class="n">ChargeRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3365"></a>    <span class="n">ENDIF</span>
<a name="ln-3366"></a>
<a name="ln-3367"></a>    <span class="c">!  Calculate full load output conditions</span>
<a name="ln-3368"></a>    <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">EvapTotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-3369"></a>
<a name="ln-3370"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">EvapTotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-3371"></a>    <span class="c">!The following will often throw psych warnings for neg w, suppress warnings because error condition is handled in next IF</span>
<a name="ln-3372"></a>    <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">,</span> <span class="n">SuppressWarnings</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-3373"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3374"></a>    <span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-3375"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3376"></a><span class="k">      </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3377"></a>      <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3378"></a>    <span class="n">ENDIF</span>
<a name="ln-3379"></a>
<a name="ln-3380"></a>    <span class="c">! Continuous fan, cycling compressor</span>
<a name="ln-3381"></a>    <span class="n">EvapOutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3382"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletEnthalpy</span><span class="p">)</span>
<a name="ln-3383"></a>    <span class="n">EvapOutletAirHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3384"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletHumRat</span><span class="p">)</span>
<a name="ln-3385"></a>    <span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">EvapOutletAirHumRat</span><span class="p">)</span>
<a name="ln-3386"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3387"></a><span class="k">      </span><span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3388"></a>      <span class="n">EvapOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3389"></a>    <span class="n">ENDIF</span>
<a name="ln-3390"></a>
<a name="ln-3391"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">EvapOutletAirTemp</span>
<a name="ln-3392"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">EvapOutletAirHumRat</span>
<a name="ln-3393"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">EvapOutletAirEnthalpy</span>
<a name="ln-3394"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-3395"></a>
<a name="ln-3396"></a>    <span class="c">! determine condenser leaving conditions</span>
<a name="ln-3397"></a>    <span class="n">QdotCond</span> <span class="o">=</span> <span class="n">EvapTotCap</span><span class="o">*</span> <span class="n">EvapRuntimeFraction</span> <span class="o">+</span> <span class="n">EvapElecCoolingPower</span> <span class="o">+</span> <span class="n">TotChargeCap</span> <span class="o">+</span> <span class="n">ChargeElectricCoolingPower</span>
<a name="ln-3398"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3399"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3400"></a>    <span class="n">CondInletEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">CondInletHumRat</span> <span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3401"></a>    <span class="n">CondOutletEnthalpy</span> <span class="o">=</span> <span class="n">CondInletEnthalpy</span> <span class="o">+</span> <span class="n">QdotCond</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3402"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span> <span class="n">CondOutletEnthalpy</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3403"></a>                                                                        <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3404"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">HumRat</span>   <span class="o">=</span> <span class="n">CondInletHumrat</span>
<a name="ln-3405"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">CondOutletEnthalpy</span>
<a name="ln-3406"></a>
<a name="ln-3407"></a>
<a name="ln-3408"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">EvapElecCoolingPower</span> <span class="o">+</span> <span class="n">ChargeElectricCoolingPower</span> <span class="p">&amp;</span>
<a name="ln-3409"></a>                                           <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-3410"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3411"></a>
<a name="ln-3412"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">EvapRuntimeFraction</span>
<a name="ln-3413"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ChargeRuntimeFraction</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3414"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ChargeRuntimeFraction</span><span class="p">,</span> <span class="n">EvapRuntimeFraction</span><span class="p">)</span>
<a name="ln-3415"></a>    <span class="k">ELSE</span>
<a name="ln-3416"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span> <span class="o">=</span> <span class="n">EvapRuntimeFraction</span>
<a name="ln-3417"></a>    <span class="n">ENDIF</span>
<a name="ln-3418"></a>
<a name="ln-3419"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="o">=</span> <span class="n">EvapTotCap</span><span class="o">*</span> <span class="n">EvapRuntimeFraction</span> <span class="c">! double check this</span>
<a name="ln-3420"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span> <span class="n">EvapTotCap</span><span class="o">*</span> <span class="n">EvapRuntimeFraction</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3421"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3422"></a>                        <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span> <span class="p">)</span>
<a name="ln-3423"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">*</span><span class="p">&amp;</span>
<a name="ln-3424"></a>                      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-3425"></a>                        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3426"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">&gt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3427"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>
<a name="ln-3428"></a>    <span class="n">ENDIF</span>
<a name="ln-3429"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3430"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="p">&amp;</span>
<a name="ln-3431"></a>                                              <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>
<a name="ln-3432"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3433"></a>
<a name="ln-3434"></a>  <span class="k">ELSE</span> <span class="c">! Evap off, but may still charge</span>
<a name="ln-3435"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCanBeCharged</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is running to charge but not to cool at evaporator</span>
<a name="ln-3436"></a>      <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirMassFlowRate</span>
<a name="ln-3437"></a>      <span class="n">ChargeCapModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3438"></a>                                        <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3439"></a>      <span class="n">ChargeCapModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">ChargeCapModFac</span><span class="p">)</span>
<a name="ln-3440"></a>
<a name="ln-3441"></a>      <span class="n">ChargeCapPLRModFac</span><span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingCapFEvapPLRCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3442"></a>      <span class="n">ChargeCapPLRModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">ChargeCapPLRModFac</span><span class="p">)</span>
<a name="ln-3443"></a>
<a name="ln-3444"></a>      <span class="n">TotChargeCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeRatedChargeCap</span> <span class="o">*</span> <span class="n">ChargeCapModFac</span> <span class="o">*</span> <span class="n">ChargeCapPLRModFac</span>
<a name="ln-3445"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotChargeCap</span> <span class="o">&gt;</span> <span class="n">QdotChargeLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3446"></a><span class="k">        </span><span class="n">ChargeRuntimeFraction</span> <span class="o">=</span> <span class="n">QdotChargeLimit</span> <span class="o">/</span> <span class="n">TotChargeCap</span>
<a name="ln-3447"></a>        <span class="n">TotChargeCap</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">TotChargeCap</span><span class="p">,</span> <span class="n">QdotChargeLimit</span><span class="p">)</span>
<a name="ln-3448"></a>      <span class="k">ELSE</span>
<a name="ln-3449"></a><span class="k">        </span><span class="n">ChargeRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3450"></a>      <span class="n">ENDIF</span>
<a name="ln-3451"></a>      <span class="n">ChargeEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3452"></a>                                         <span class="n">EvapInletWetBulb</span><span class="p">,</span><span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3453"></a>      <span class="n">ChargeEIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">ChargeEIRTempModFac</span> <span class="p">)</span>
<a name="ln-3454"></a>      <span class="n">ChargeEIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingEIRFFLowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3455"></a>      <span class="n">ChargeEIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span> <span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">ChargeEIRFlowModFac</span><span class="p">)</span>
<a name="ln-3456"></a>      <span class="n">ChargeEIR</span> <span class="o">=</span> <span class="p">(</span><span class="n">ChargeEIRTempModFac</span> <span class="o">*</span> <span class="n">ChargeEIRFlowModFac</span><span class="p">)</span> <span class="o">/</span>   <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndChargeChargingRatedCOP</span>
<a name="ln-3457"></a>      <span class="n">ChargeElectricCoolingPower</span> <span class="o">=</span> <span class="n">TotChargeCap</span> <span class="o">*</span> <span class="n">ChargeEIR</span>
<a name="ln-3458"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="o">-</span> <span class="n">TotChargeCap</span>
<a name="ln-3459"></a>    <span class="k">ELSE</span>
<a name="ln-3460"></a><span class="k">      </span><span class="n">TotChargeCap</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3461"></a>      <span class="n">ChargeElectricCoolingPower</span> <span class="o">=</span><span class="mf">0.d0</span>
<a name="ln-3462"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3463"></a>      <span class="n">ChargeRuntimeFraction</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3464"></a>    <span class="n">ENDIF</span>
<a name="ln-3465"></a>
<a name="ln-3466"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>   <span class="o">=</span>  <span class="n">ChargeElectricCoolingPower</span> <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-3467"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3468"></a>
<a name="ln-3469"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3470"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3471"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3472"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3473"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3474"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3475"></a>                                                                       <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3476"></a>                                                                       <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3479"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3480"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3481"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3482"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3483"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3484"></a>
<a name="ln-3485"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotChargeCap</span> <span class="o">==</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3486"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3487"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3488"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3489"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3490"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3491"></a>                                                              <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3492"></a>                                                                         <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3493"></a>                                                                         <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-3494"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3495"></a>    <span class="k">ELSE</span>
<a name="ln-3496"></a>
<a name="ln-3497"></a>      <span class="c">! determine condenser leaving conditions</span>
<a name="ln-3498"></a>      <span class="n">QdotCond</span> <span class="o">=</span> <span class="n">TotChargeCap</span> <span class="o">+</span> <span class="n">ChargeElectricCoolingPower</span>
<a name="ln-3499"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3500"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3501"></a>      <span class="n">CondInletEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">CondInletHumRat</span> <span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3502"></a>      <span class="n">CondOutletEnthalpy</span> <span class="o">=</span> <span class="n">CondInletEnthalpy</span> <span class="o">+</span> <span class="n">QdotCond</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3503"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span> <span class="n">CondOutletEnthalpy</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3504"></a>                                                                          <span class="s1">&#39;CalcTESCoilCoolingAndChargeMode&#39;</span><span class="p">)</span>
<a name="ln-3505"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">HumRat</span>   <span class="o">=</span> <span class="n">CondInletHumrat</span>
<a name="ln-3506"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">CondOutletEnthalpy</span>
<a name="ln-3507"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span>    <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3508"></a>    <span class="n">ENDIF</span>
<a name="ln-3509"></a>
<a name="ln-3510"></a>
<a name="ln-3511"></a>  <span class="n">ENDIF</span>
<a name="ln-3512"></a>
<a name="ln-3513"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="o">-</span> <span class="n">TotChargeCap</span>
<a name="ln-3514"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3515"></a>
<a name="ln-3516"></a>  <span class="k">CALL </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3517"></a>
<a name="ln-3518"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">CondInletTemp</span>
<a name="ln-3519"></a>
<a name="ln-3520"></a>  <span class="k">CALL </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3521"></a>
<a name="ln-3522"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3523"></a><span class="k">    CALL </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3524"></a>    <span class="k">CALL </span><span class="n">UpdateEvaporativeCondenserWaterUse</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)</span>
<a name="ln-3525"></a>  <span class="n">ENDIF</span>
<a name="ln-3526"></a>
<a name="ln-3527"></a>  <span class="k">RETURN</span>
<a name="ln-3528"></a>
<a name="ln-3529"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESCoilCoolingAndChargeMode</span>
<a name="ln-3530"></a>
<a name="ln-3531"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESCoilCoolingAndDischargeMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3532"></a>
<a name="ln-3533"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3534"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-3535"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-3536"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3537"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3538"></a>
<a name="ln-3539"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3540"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3541"></a>
<a name="ln-3542"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3543"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3544"></a>
<a name="ln-3545"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3546"></a>          <span class="c">! na</span>
<a name="ln-3547"></a>
<a name="ln-3548"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3549"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-3550"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3551"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-3552"></a>
<a name="ln-3553"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3554"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-3555"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FanOpMode</span>
<a name="ln-3556"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-3557"></a>
<a name="ln-3558"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3559"></a>          <span class="c">! na</span>
<a name="ln-3560"></a>
<a name="ln-3561"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3562"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">30</span>
<a name="ln-3563"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RelaxationFactor</span> <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-3564"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">0.1d0</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a>
<a name="ln-3567"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3568"></a>          <span class="c">! na</span>
<a name="ln-3569"></a>
<a name="ln-3570"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3571"></a>          <span class="c">! na</span>
<a name="ln-3572"></a>
<a name="ln-3573"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3574"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-3575"></a>                                   <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-3576"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>      <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-3577"></a>                                    <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-3578"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>      <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-3579"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletEnthalpy</span>    <span class="c">! condenser inlet enthalpy [J/kg]</span>
<a name="ln-3580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirSidePressure</span>  <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-3581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondOutletEnthalpy</span>   <span class="c">!condesner outlet enthalpy [J/kg]</span>
<a name="ln-3582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>  <span class="c">! outdoor air dry bulb local variable [C]</span>
<a name="ln-3583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>   <span class="c">! outdoor air humidity ratio local [kg/kg]</span>
<a name="ln-3584"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>  <span class="c">! outdoor air wetbulb local [C]</span>
<a name="ln-3585"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapAirMassFlow</span>   <span class="c">! local for evaporator air mass flow [kg/s]</span>
<a name="ln-3586"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletDryBulb</span> <span class="c">! evaporator inlet air drybulb [C]</span>
<a name="ln-3587"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletHumRat</span> <span class="c">! evaporator inlet air humidity ratio [kg/kg]</span>
<a name="ln-3588"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletWetBulb</span> <span class="c">! evaporator inlet air wetbulb [C]</span>
<a name="ln-3589"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletEnthalpy</span> <span class="c">! evaporator inlet air enthalpy [J/kg]</span>
<a name="ln-3590"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sTES</span> <span class="c">! stat of Thermal energy storage [C or fraction of ice]</span>
<a name="ln-3591"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TESHasSomeCharge</span> <span class="c">! some charge available for discharge</span>
<a name="ln-3592"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>
<a name="ln-3593"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankMass</span>            <span class="c">! Mass of fluid in tank (kg)</span>
<a name="ln-3594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpTank</span>              <span class="c">! Specific heat of water in tank (J/kg K)</span>
<a name="ln-3595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotDischargeLimit</span> <span class="c">! limit for charge cooling power to hit limit of storage.</span>
<a name="ln-3596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span> <span class="c">! evaporator inlet air mass flow divided by design mass flow [ ]</span>
<a name="ln-3597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCapTempModFac</span> <span class="c">! total coolin capacity modification factor due to temps []</span>
<a name="ln-3598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCapFlowModFac</span> <span class="c">!Total cooling capacity modification factor due to flow []</span>
<a name="ln-3599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapTotCap</span> <span class="c">! total cooling capacity</span>
<a name="ln-3600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRTempFac</span> <span class="c">! sensible heat ratio modification factor due to temps []</span>
<a name="ln-3601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRFlowFac</span> <span class="c">! sensible heat ratio modification factor due to flow []</span>
<a name="ln-3602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span> <span class="c">! sensible heat ratio</span>
<a name="ln-3603"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>   <span class="c">! part load factor</span>
<a name="ln-3604"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapRuntimeFraction</span> <span class="c">! compressor running time divided by full time of timestep.</span>
<a name="ln-3605"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="c">! energy input ratio modification factor due to temperatures []</span>
<a name="ln-3606"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span> <span class="c">!energy input ratio modification factor due to flow []</span>
<a name="ln-3607"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">! energy input ratio</span>
<a name="ln-3608"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargePLF</span>
<a name="ln-3609"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeRuntimeFraction</span>
<a name="ln-3610"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotDischargeCap</span>
<a name="ln-3611"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeCapTempModFac</span>
<a name="ln-3612"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeCapFlowModFac</span>
<a name="ln-3613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeEIRTempModFac</span>
<a name="ln-3614"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeEIRFlowModFac</span>
<a name="ln-3615"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeEIR</span>
<a name="ln-3616"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapElecCoolingPower</span> <span class="c">! compressor electric power</span>
<a name="ln-3617"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DischargeElectricCoolingPower</span>
<a name="ln-3618"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span>
<a name="ln-3619"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span> <span class="c">! evaporator outlet full load enthalpy [J/kg]</span>
<a name="ln-3620"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>   <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-3621"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span> <span class="c">! evaporator outlet humidity ratio at full load</span>
<a name="ln-3622"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>  <span class="c">!evaporator outlet air temperature at full load [C]</span>
<a name="ln-3623"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirEnthalpy</span> <span class="c">! evaporator outlet air enthalpy [J/kg]</span>
<a name="ln-3624"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirHumRat</span> <span class="c">!evaporator outlet air humidity ratio [kg/kg]</span>
<a name="ln-3625"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirTemp</span> <span class="c">!evaporator outlet dryblub [C]</span>
<a name="ln-3626"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotCond</span> <span class="c">! heat rejection rate at condenser [W]</span>
<a name="ln-3627"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="c">! minimum air humidity ratio</span>
<a name="ln-3628"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadOutAirEnth</span> <span class="c">! local leaving enthalpy at part load</span>
<a name="ln-3629"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="c">! local leaving drybulb if coil were dry</span>
<a name="ln-3630"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoilMightBeDry</span>
<a name="ln-3631"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Counter</span>
<a name="ln-3632"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Converged</span>
<a name="ln-3633"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-3634"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletWetBulb</span>
<a name="ln-3635"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>
<a name="ln-3636"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>
<a name="ln-3637"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>
<a name="ln-3638"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>
<a name="ln-3639"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRadp</span>
<a name="ln-3640"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>
<a name="ln-3641"></a>
<a name="ln-3642"></a>  <span class="c">! first deal with condenser</span>
<a name="ln-3643"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3644"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-3645"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3646"></a><span class="k">      </span><span class="n">CondInletTemp</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-3647"></a>      <span class="n">CondInletHumrat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-3648"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-3649"></a>    <span class="k">ELSE</span>
<a name="ln-3650"></a><span class="k">     </span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3651"></a>     <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3652"></a>
<a name="ln-3653"></a>    <span class="n">ENDIF</span>
<a name="ln-3654"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3655"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3656"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-3657"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3658"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-3659"></a>      <span class="n">OutdoorHumRat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-3660"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-3661"></a>      <span class="n">OutdoorWetBulb</span>   <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-3662"></a>    <span class="k">ELSE</span>
<a name="ln-3663"></a><span class="k">     </span><span class="n">OutdoorDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3664"></a>     <span class="n">OutdoorHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3665"></a>     <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span> <span class="n">OutdoorHumRat</span><span class="p">,</span> <span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3666"></a>    <span class="n">ENDIF</span>
<a name="ln-3667"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3668"></a>    <span class="c">! direct evap cool model</span>
<a name="ln-3669"></a>    <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">)</span>
<a name="ln-3670"></a>    <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3671"></a>
<a name="ln-3672"></a>  <span class="n">ENDIF</span>
<a name="ln-3673"></a>  <span class="n">EvapAirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3674"></a>  <span class="n">EvapInletDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3675"></a>  <span class="n">EvapInletHumRat</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3676"></a>  <span class="n">EvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3677"></a>  <span class="n">EvapInletEnthalpy</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-3678"></a>  <span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3679"></a>
<a name="ln-3680"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-3681"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span>
<a name="ln-3682"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">sTES</span> <span class="o">&gt;=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&lt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3683"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3684"></a>      <span class="n">rho</span>             <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3685"></a>                                         <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3686"></a>      <span class="n">TankMass</span>        <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span>
<a name="ln-3687"></a>      <span class="n">CpTank</span>          <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3688"></a>                                              <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3689"></a>      <span class="c">!simple linear approximation of DT/Dt term in McpDT/Dt</span>
<a name="ln-3690"></a>      <span class="n">QdotDischargelimit</span> <span class="o">=</span> <span class="n">TankMass</span> <span class="o">*</span> <span class="n">CpTank</span> <span class="o">*</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span> <span class="o">-</span> <span class="n">sTES</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3691"></a>    <span class="k">ELSE</span>
<a name="ln-3692"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3693"></a>    <span class="n">ENDIF</span>
<a name="ln-3694"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3695"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span>
<a name="ln-3696"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3697"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3698"></a>      <span class="c">! discharge limit</span>
<a name="ln-3699"></a>      <span class="n">QdotDischargelimit</span> <span class="o">=</span> <span class="p">(</span><span class="n">sTES</span><span class="p">)</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-3700"></a>    <span class="k">ELSE</span>
<a name="ln-3701"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3702"></a>    <span class="n">ENDIF</span>
<a name="ln-3703"></a>  <span class="n">ENDIF</span>
<a name="ln-3704"></a>
<a name="ln-3705"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">EvapAirMassFlow</span> <span class="o">&gt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is running</span>
<a name="ln-3706"></a>
<a name="ln-3707"></a>    <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirMassFlowRate</span>
<a name="ln-3708"></a>    <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3709"></a>                                           <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3710"></a>    <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapTempModFac</span><span class="p">)</span> <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3711"></a>    <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3712"></a>    <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapFlowModFac</span><span class="p">)</span>  <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3713"></a>    <span class="n">EvapTotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCap</span> <span class="o">*</span> <span class="n">EvapTotCapTempModFac</span> <span class="o">*</span> <span class="n">EvapTotCapFlowModFac</span>
<a name="ln-3714"></a>    <span class="c">! now see if coil is running dry</span>
<a name="ln-3715"></a>    <span class="n">PartLoadOutAirEnth</span> <span class="o">=</span>  <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">EvapTotCap</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-3716"></a>    <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span><span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3717"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">&gt;</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3718"></a><span class="k">      </span><span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3719"></a>      <span class="c">! find wADP, humidity ratio at apparatus dewpoint and inlet hum rat that would have dry coil</span>
<a name="ln-3720"></a>      <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">EvapInletHumRat</span>
<a name="ln-3721"></a>      <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">EvapInletWetBulb</span>
<a name="ln-3722"></a>      <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3723"></a>      <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3724"></a>      <span class="k">DO While</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Converged</span><span class="p">)</span>
<a name="ln-3725"></a>        <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3726"></a>                                               <span class="n">DryCoilTestEvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3727"></a>        <span class="n">EvapTotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapTempModFac</span><span class="p">)</span> <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3728"></a>        <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3729"></a>        <span class="n">EvapTotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EvapTotCapFlowModFac</span><span class="p">)</span>  <span class="c">! could warn if negative, DXcoil does</span>
<a name="ln-3730"></a>        <span class="n">EvapTotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedTotCap</span> <span class="o">*</span> <span class="n">EvapTotCapTempModFac</span> <span class="o">*</span> <span class="n">EvapTotCapFlowModFac</span>
<a name="ln-3731"></a>        <span class="c">! coil bypass factor = 0.0</span>
<a name="ln-3732"></a>        <span class="n">hADP</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">EvapTotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-3733"></a>        <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3734"></a>        <span class="n">wADP</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">PsyWfnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span> <span class="n">hADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3735"></a>        <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">wADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3736"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3737"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">EvapInletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-3738"></a>        <span class="k">ELSE</span>
<a name="ln-3739"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3740"></a>        <span class="n">ENDIF</span>
<a name="ln-3741"></a>
<a name="ln-3742"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">wADP</span> <span class="o">&gt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3743"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="mf">0.00001d0</span>
<a name="ln-3744"></a>          <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">-</span>  <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-3745"></a>
<a name="ln-3746"></a>          <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">RelaxationFactor</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RelaxationFactor</span><span class="p">)</span><span class="o">*</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-3747"></a>          <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3748"></a>                                                    <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3749"></a>
<a name="ln-3750"></a>          <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3751"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3752"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3753"></a>          <span class="k">ELSE</span>
<a name="ln-3754"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3755"></a>          <span class="n">ENDIF</span>
<a name="ln-3756"></a>        <span class="k">ELSE</span>
<a name="ln-3757"></a><span class="k">          </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3758"></a>        <span class="n">ENDIF</span>
<a name="ln-3759"></a>
<a name="ln-3760"></a>      <span class="n">ENDDO</span>
<a name="ln-3761"></a>    <span class="n">ENDIF</span>
<a name="ln-3762"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempObjectNum</span> <span class="p">)</span>
<a name="ln-3763"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span> <span class="p">)</span>
<a name="ln-3764"></a>      <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">)</span>
<a name="ln-3765"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span><span class="p">)</span>
<a name="ln-3766"></a>      <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3767"></a>    <span class="k">END SELECT</span>
<a name="ln-3768"></a><span class="k">    </span><span class="n">SHRFlowFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeSHRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3769"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedSHR</span> <span class="o">*</span> <span class="n">SHRTempFac</span> <span class="o">*</span> <span class="n">SHRFlowFac</span>
<a name="ln-3770"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-3771"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-3772"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">CoilMightBeDry</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3773"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">EvapInletHumRat</span> <span class="o">&lt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is dry for sure</span>
<a name="ln-3774"></a>        <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-3775"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3776"></a><span class="k">        </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRadp</span>
<a name="ln-3777"></a>      <span class="n">ENDIF</span>
<a name="ln-3778"></a>    <span class="n">ENDIF</span>
<a name="ln-3779"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingPLFFPLRCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3780"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&gt;=</span> <span class="n">PartLoadRatio</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PLF</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3781"></a><span class="k">      </span><span class="n">EvapRuntimeFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-3782"></a>    <span class="k">ELSE</span>
<a name="ln-3783"></a><span class="k">      </span><span class="n">EvapRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! warn maybe</span>
<a name="ln-3784"></a>    <span class="n">ENDIF</span>
<a name="ln-3785"></a>    <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-3786"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3787"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRTempModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-3788"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingEIRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3789"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRFlowModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-3790"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeCoolingRatedCOP</span>
<a name="ln-3791"></a>
<a name="ln-3792"></a>    <span class="n">EvapElecCoolingPower</span> <span class="o">=</span> <span class="n">EvapTotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">EvapRuntimeFraction</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESHasSomeCharge</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3795"></a><span class="k">      </span><span class="n">DischargeCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFTempCurve</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3796"></a>                                        <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3797"></a>      <span class="n">DischargeCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">DischargeCapTempModFac</span><span class="p">)</span>
<a name="ln-3798"></a>      <span class="n">DischargeCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3799"></a>      <span class="n">DischargeCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">DischargeCapFlowModFac</span><span class="p">)</span>
<a name="ln-3800"></a>
<a name="ln-3801"></a>      <span class="n">DischargePLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingCapFEvapPLRCurve</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-3802"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DischargePLF</span> <span class="o">&gt;=</span> <span class="n">PartLoadRatio</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DischargePLF</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3803"></a><span class="k">        </span><span class="n">DischargeRuntimeFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span> <span class="o">/</span> <span class="n">DischargePLF</span>
<a name="ln-3804"></a>      <span class="k">ELSE</span>
<a name="ln-3805"></a><span class="k">        </span><span class="n">DischargeRuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! warn maybe</span>
<a name="ln-3806"></a>      <span class="n">ENDIF</span>
<a name="ln-3807"></a>
<a name="ln-3808"></a>      <span class="n">TotDischargeCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeRatedDischargeCap</span> <span class="o">*</span> <span class="n">DischargeCapTempModFac</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-3809"></a>                                   <span class="n">DischargeCapFlowModFac</span> <span class="o">*</span> <span class="n">DischargeRuntimeFraction</span>
<a name="ln-3810"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">TotDischargeCap</span> <span class="o">&gt;</span> <span class="n">QdotDischargelimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3811"></a><span class="k">        </span><span class="n">TotDischargeCap</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">TotDischargeCap</span><span class="p">,</span> <span class="n">QdotDischargelimit</span><span class="p">)</span>
<a name="ln-3812"></a>      <span class="n">ENDIF</span>
<a name="ln-3813"></a>      <span class="n">DischargeEIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFTempCurve</span><span class="p">,</span><span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3814"></a>                                           <span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-3815"></a>      <span class="n">DischargeEIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">DischargeEIRTempModFac</span> <span class="p">)</span>
<a name="ln-3816"></a>      <span class="n">DischargeEIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingEIRFFLowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-3817"></a>      <span class="n">DischargeEIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">DischargeEIRFlowModFac</span><span class="p">)</span>
<a name="ln-3818"></a>
<a name="ln-3819"></a>      <span class="n">DischargeEIR</span> <span class="o">=</span> <span class="p">(</span><span class="n">DischargeEIRTempModFac</span> <span class="o">*</span> <span class="n">DischargeEIRFlowModFac</span> <span class="p">)</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CoolingAndDischargeDischargingRatedCOP</span>
<a name="ln-3820"></a>      <span class="n">DischargeElectricCoolingPower</span> <span class="o">=</span> <span class="n">TotDischargeCap</span> <span class="o">*</span> <span class="n">DischargeEIR</span> <span class="o">*</span> <span class="n">DischargeRuntimeFraction</span>
<a name="ln-3821"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="n">TotDischargeCap</span>
<a name="ln-3822"></a>    <span class="k">ELSE</span>
<a name="ln-3823"></a><span class="k">      </span><span class="n">TotDischargeCap</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3824"></a>      <span class="n">DischargeElectricCoolingPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3825"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3826"></a>    <span class="n">ENDIF</span>
<a name="ln-3827"></a>
<a name="ln-3828"></a>    <span class="n">TotCap</span> <span class="o">=</span> <span class="n">EvapTotCap</span> <span class="o">+</span> <span class="n">TotDischargeCap</span>
<a name="ln-3829"></a>    <span class="c">!  Calculate full load output conditions</span>
<a name="ln-3830"></a>    <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-3831"></a>
<a name="ln-3832"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-3833"></a>    <span class="c">!The following will often throw psych warnings for neg w, suppress warnings because error condition is handled in next IF</span>
<a name="ln-3834"></a>    <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">,</span> <span class="n">SuppressWarnings</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-3835"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3836"></a>    <span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-3837"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3838"></a><span class="k">      </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3839"></a>      <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3840"></a>    <span class="n">ENDIF</span>
<a name="ln-3841"></a>    <span class="c">! Continuous fan, cycling compressor</span>
<a name="ln-3842"></a>    <span class="n">EvapOutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3843"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletEnthalpy</span><span class="p">)</span>
<a name="ln-3844"></a>    <span class="n">EvapOutletAirHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="n">PartLoadRatio</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-3845"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PartLoadRatio</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletHumRat</span><span class="p">)</span>
<a name="ln-3846"></a>    <span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">EvapOutletAirHumRat</span><span class="p">)</span>
<a name="ln-3847"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3848"></a><span class="k">      </span><span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3849"></a>      <span class="n">EvapOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3850"></a>    <span class="n">ENDIF</span>
<a name="ln-3851"></a>
<a name="ln-3852"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">EvapOutletAirTemp</span>
<a name="ln-3853"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">EvapOutletAirHumRat</span>
<a name="ln-3854"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">EvapOutletAirEnthalpy</span>
<a name="ln-3855"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-3856"></a>
<a name="ln-3857"></a>    <span class="c">! determine condenser leaving conditions</span>
<a name="ln-3858"></a>    <span class="n">QdotCond</span> <span class="o">=</span> <span class="n">EvapTotCap</span><span class="o">*</span> <span class="n">EvapRuntimeFraction</span> <span class="o">+</span> <span class="n">EvapElecCoolingPower</span>
<a name="ln-3859"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3860"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3861"></a>    <span class="n">CondInletEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">CondInletHumRat</span> <span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3862"></a>    <span class="n">CondOutletEnthalpy</span> <span class="o">=</span> <span class="n">CondInletEnthalpy</span> <span class="o">+</span> <span class="n">QdotCond</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-3863"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span> <span class="n">CondOutletEnthalpy</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3864"></a>                                                                        <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3865"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">HumRat</span>   <span class="o">=</span> <span class="n">CondInletHumrat</span>
<a name="ln-3866"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">CondOutletEnthalpy</span>
<a name="ln-3867"></a>
<a name="ln-3868"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">EvapElecCoolingPower</span> <span class="o">+</span> <span class="n">DischargeElectricCoolingPower</span> <span class="p">&amp;</span>
<a name="ln-3869"></a>                                           <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-3870"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3871"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">EvapTotCap</span><span class="o">*</span> <span class="n">EvapRuntimeFraction</span> <span class="o">+</span> <span class="n">TotDischargeCap</span> <span class="o">*</span> <span class="n">DischargeRuntimeFraction</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3872"></a>                                          <span class="o">/</span> <span class="p">(</span><span class="n">EvapTotCap</span> <span class="o">+</span> <span class="n">TotDischargeCap</span><span class="p">)</span>
<a name="ln-3873"></a>
<a name="ln-3874"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="o">=</span> <span class="n">EvapTotCap</span><span class="o">*</span> <span class="n">EvapRuntimeFraction</span> <span class="o">+</span> <span class="n">TotDischargeCap</span> <span class="o">*</span> <span class="n">DischargeRuntimeFraction</span>
<a name="ln-3875"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3876"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3877"></a>                        <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span> <span class="p">)</span>
<a name="ln-3878"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">*</span><span class="p">&amp;</span>
<a name="ln-3879"></a>                      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-3880"></a>                        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-3881"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">&gt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3882"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>
<a name="ln-3883"></a>    <span class="n">ENDIF</span>
<a name="ln-3884"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3885"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="p">&amp;</span>
<a name="ln-3886"></a>                                              <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>
<a name="ln-3887"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3888"></a>
<a name="ln-3889"></a>  <span class="k">ELSE</span> <span class="c">!coil is off; just pass through conditions</span>
<a name="ln-3890"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3891"></a>
<a name="ln-3892"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-3893"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-3894"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3895"></a>
<a name="ln-3896"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>      <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3897"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3898"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3899"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3900"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3901"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3902"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-3903"></a>
<a name="ln-3904"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3905"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3906"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3907"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3908"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3909"></a>                                                                       <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3910"></a>                                                                       <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3911"></a>    <span class="c">!nothing happens at condenser</span>
<a name="ln-3912"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3913"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-3914"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3915"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-3916"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3917"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3918"></a>                                                                        <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3919"></a>                                                                        <span class="s1">&#39;CalcTESCoilCoolingAndDischargeMode&#39;</span><span class="p">)</span>
<a name="ln-3920"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3921"></a>  <span class="n">ENDIF</span>
<a name="ln-3922"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-3923"></a>  <span class="k">CALL </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3924"></a>
<a name="ln-3925"></a>  <span class="k">CALL </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3926"></a>
<a name="ln-3927"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3928"></a><span class="k">    CALL </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3929"></a>    <span class="k">CALL </span><span class="n">UpdateEvaporativeCondenserWaterUse</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)</span>
<a name="ln-3930"></a>  <span class="n">ENDIF</span>
<a name="ln-3931"></a>
<a name="ln-3932"></a>  <span class="k">RETURN</span>
<a name="ln-3933"></a>
<a name="ln-3934"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESCoilCoolingAndDischargeMode</span>
<a name="ln-3935"></a>
<a name="ln-3936"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESCoilChargeOnlyMode</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-3937"></a>
<a name="ln-3938"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3939"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-3940"></a>          <span class="c">!       DATE WRITTEN   May 2013</span>
<a name="ln-3941"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3942"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3943"></a>
<a name="ln-3944"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3945"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3946"></a>
<a name="ln-3947"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3948"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-3949"></a>
<a name="ln-3950"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3951"></a>          <span class="c">! na</span>
<a name="ln-3952"></a>
<a name="ln-3953"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3954"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-3955"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-3956"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-3957"></a>
<a name="ln-3958"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3959"></a>
<a name="ln-3960"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3961"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-3962"></a>
<a name="ln-3963"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3964"></a>          <span class="c">! na</span>
<a name="ln-3965"></a>
<a name="ln-3966"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3967"></a>          <span class="c">! na</span>
<a name="ln-3968"></a>
<a name="ln-3969"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3970"></a>          <span class="c">! na</span>
<a name="ln-3971"></a>
<a name="ln-3972"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sTES</span> <span class="c">! local state of Thermal Energy Storage (C or ice fraction)</span>
<a name="ln-3974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletTemp</span>         <span class="c">! Condenser inlet temperature (C). Outdoor dry-bulb temp for air-cooled condenser.</span>
<a name="ln-3975"></a>                                   <span class="c">! Outdoor Wetbulb +(1 - effectiveness)*(outdoor drybulb - outdoor wetbulb) for evap condenser.</span>
<a name="ln-3976"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletHumrat</span>      <span class="c">! Condenser inlet humidity ratio (kg/kg). Zero for air-cooled condenser.</span>
<a name="ln-3977"></a>                                    <span class="c">! For evap condenser, its the humidity ratio of the air leaving the evap cooling pads.</span>
<a name="ln-3978"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirMassFlow</span>      <span class="c">! Condenser air mass flow rate [kg/s]</span>
<a name="ln-3979"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondInletEnthalpy</span>    <span class="c">! condenser inlet enthalpy [J/kg]</span>
<a name="ln-3980"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondAirSidePressure</span>  <span class="c">! Outdoor barometric pressure at condenser (Pa)</span>
<a name="ln-3981"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotCond</span>  <span class="c">! condenser total heat rejection rate [W]</span>
<a name="ln-3982"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CondOutletEnthalpy</span>   <span class="c">!condesner outlet enthalpy [J/kg]</span>
<a name="ln-3983"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorDryBulb</span>  <span class="c">! outdoor air dry bulb local variable [C]</span>
<a name="ln-3984"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorHumRat</span>   <span class="c">! outdoor air humidity ratio local [kg/kg]</span>
<a name="ln-3985"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OutdoorWetBulb</span>  <span class="c">! outdoor air wetbulb local [C]</span>
<a name="ln-3986"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CapModFac</span>  <span class="c">! local capacity modifying factor</span>
<a name="ln-3987"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span> <span class="c">! total cooling (charging) capacity</span>
<a name="ln-3988"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRModFac</span> <span class="c">! local energy input ratio modifying factor</span>
<a name="ln-3989"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">! energy input ratio</span>
<a name="ln-3990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingPower</span> <span class="c">! compressor electric power</span>
<a name="ln-3991"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TESCanBeCharged</span> <span class="c">! true if room for tank to be charged.</span>
<a name="ln-3992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotChargeLimit</span> <span class="c">! limit for charge cooling power to hit limit of storage.</span>
<a name="ln-3993"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>                 <span class="c">! density of fluid in tank (kg/m3)</span>
<a name="ln-3994"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankMass</span>            <span class="c">! Mass of fluid in tank (kg)</span>
<a name="ln-3995"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpTank</span>              <span class="c">! Specific heat of water in tank (J/kg K)</span>
<a name="ln-3996"></a>
<a name="ln-3997"></a> <span class="c">! nothing happens at Evaporator</span>
<a name="ln-3998"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-3999"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4000"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4001"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4002"></a>                                                          <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4003"></a>                                                                      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4004"></a>                                                                      <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4005"></a>
<a name="ln-4006"></a>
<a name="ln-4007"></a>  <span class="c">! first deal with condenser</span>
<a name="ln-4008"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">AirCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4009"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-4010"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4011"></a><span class="k">      </span><span class="n">CondInletTemp</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-4012"></a>      <span class="n">CondInletHumrat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-4013"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-4014"></a>    <span class="k">ELSE</span>
<a name="ln-4015"></a><span class="k">     </span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4016"></a>     <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4017"></a>
<a name="ln-4018"></a>    <span class="n">ENDIF</span>
<a name="ln-4019"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-4020"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4021"></a><span class="k">    </span><span class="n">CondAirSidePressure</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Press</span>
<a name="ln-4022"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CondAirSidePressure</span> <span class="o">==</span> <span class="n">DefaultNodeValues</span><span class="p">%</span><span class="n">Press</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4023"></a><span class="k">      </span><span class="n">OutdoorDryBulb</span>    <span class="o">=</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-4024"></a>      <span class="n">OutdoorHumRat</span>  <span class="o">=</span> <span class="n">OutHumRat</span>
<a name="ln-4025"></a>      <span class="n">CondAirSidePressure</span>     <span class="o">=</span> <span class="n">OutBaroPress</span>
<a name="ln-4026"></a>      <span class="n">OutdoorWetBulb</span>   <span class="o">=</span> <span class="n">OutWetBulbTemp</span>
<a name="ln-4027"></a>    <span class="k">ELSE</span>
<a name="ln-4028"></a><span class="k">     </span><span class="n">OutdoorDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4029"></a>     <span class="n">OutdoorHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4030"></a>     <span class="n">OutdoorWetBulb</span>  <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="p">,</span> <span class="n">OutdoorHumRat</span><span class="p">,</span> <span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4031"></a>    <span class="n">ENDIF</span>
<a name="ln-4032"></a>    <span class="n">CondAirMassFlow</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-4033"></a>    <span class="c">! direct evap cool model</span>
<a name="ln-4034"></a>    <span class="n">CondInletTemp</span>   <span class="o">=</span> <span class="n">OutdoorWetBulb</span> <span class="o">+</span> <span class="p">(</span><span class="n">OutdoorDryBulb</span><span class="o">-</span><span class="n">OutdoorWetBulb</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondEffect</span><span class="p">)</span>
<a name="ln-4035"></a>    <span class="n">CondInletHumrat</span> <span class="o">=</span> <span class="n">PsyWFnTdbTwbPb</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span><span class="n">OutdoorWetBulb</span><span class="p">,</span><span class="n">CondAirSidePressure</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4036"></a>  <span class="n">ENDIF</span>
<a name="ln-4037"></a>
<a name="ln-4038"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4039"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span>
<a name="ln-4040"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">sTES</span> <span class="o">&gt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&lt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4041"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4042"></a>      <span class="c">!find charge limit to reach limits</span>
<a name="ln-4043"></a>      <span class="n">rho</span>             <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4044"></a>                                         <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4045"></a>      <span class="n">TankMass</span>        <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span>
<a name="ln-4046"></a>      <span class="n">CpTank</span>          <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4047"></a>                                              <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4048"></a>      <span class="c">!simple linear approximation of DT/Dt term in McpDT/Dt</span>
<a name="ln-4049"></a>      <span class="n">QdotChargeLimit</span> <span class="o">=</span> <span class="n">TankMass</span> <span class="o">*</span> <span class="n">CpTank</span> <span class="o">*</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4050"></a>                                                  <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-4051"></a>    <span class="k">ELSE</span>
<a name="ln-4052"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4053"></a>    <span class="n">ENDIF</span>
<a name="ln-4054"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4055"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span>
<a name="ln-4056"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&lt;</span> <span class="mf">1.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4057"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4058"></a>      <span class="c">!find charge limit to reach limit</span>
<a name="ln-4059"></a>      <span class="n">QdotChargeLimit</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">sTES</span><span class="p">)</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-4060"></a>    <span class="k">ELSE</span>
<a name="ln-4061"></a><span class="k">      </span><span class="n">TESCanBeCharged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4062"></a>    <span class="n">ENDIF</span>
<a name="ln-4063"></a>  <span class="n">ENDIF</span>
<a name="ln-4064"></a>
<a name="ln-4065"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCanBeCharged</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is running</span>
<a name="ln-4066"></a>    <span class="n">CapModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyChargingCapFTempCurve</span><span class="p">,</span><span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-4067"></a>    <span class="n">CapModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">CapModFac</span><span class="p">)</span>
<a name="ln-4068"></a>    <span class="n">TotCap</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCapacity</span> <span class="o">*</span> <span class="n">CapModFac</span>
<a name="ln-4069"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">&gt;</span> <span class="n">QdotChargeLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4070"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>  <span class="o">=</span> <span class="n">QdotChargeLimit</span> <span class="o">/</span> <span class="n">TotCap</span>
<a name="ln-4071"></a>      <span class="n">TotCap</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">TotCap</span><span class="p">,</span> <span class="n">QdotChargeLimit</span><span class="p">)</span>
<a name="ln-4072"></a>    <span class="k">ELSE</span>
<a name="ln-4073"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>  <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4074"></a>    <span class="n">ENDIF</span>
<a name="ln-4075"></a>    <span class="n">EIRModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyChargingEIRFTempCurve</span><span class="p">,</span><span class="n">CondInletTemp</span> <span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-4076"></a>    <span class="n">EIRModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">EIRModFac</span> <span class="p">)</span>
<a name="ln-4077"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRModFac</span> <span class="o">/</span>   <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ChargeOnlyRatedCOP</span>
<a name="ln-4078"></a>    <span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span>
<a name="ln-4079"></a>    <span class="n">QdotCond</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">+</span> <span class="n">ElecCoolingPower</span>
<a name="ln-4080"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-4081"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-4082"></a>    <span class="n">CondInletEnthalpy</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">CondInletTemp</span><span class="p">,</span> <span class="n">CondInletHumRat</span> <span class="p">,</span> <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4083"></a>    <span class="n">CondOutletEnthalpy</span> <span class="o">=</span> <span class="n">CondInletEnthalpy</span> <span class="o">+</span> <span class="n">QdotCond</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserAirMassFlow</span>
<a name="ln-4084"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span> <span class="n">CondOutletEnthalpy</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4085"></a>                                                                        <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4086"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">HumRat</span>   <span class="o">=</span> <span class="n">CondInletHumrat</span>
<a name="ln-4087"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span>  <span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">=</span> <span class="n">CondOutletEnthalpy</span>
<a name="ln-4088"></a>
<a name="ln-4089"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>  <span class="o">=</span> <span class="n">ElecCoolingPower</span> <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-4090"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4091"></a>
<a name="ln-4092"></a>
<a name="ln-4093"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">=</span> <span class="o">-</span> <span class="n">TotCap</span> <span class="c">! negative for cooling</span>
<a name="ln-4094"></a>
<a name="ln-4095"></a>  <span class="k">ELSE</span> <span class="c">!not running</span>
<a name="ln-4096"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-4097"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4098"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4099"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>            <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4100"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4101"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4102"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4103"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4104"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4105"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4106"></a>                                                                       <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4107"></a>                                                                       <span class="s1">&#39;CalcTESCoilChargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4108"></a>  <span class="n">ENDIF</span>
<a name="ln-4109"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4110"></a>
<a name="ln-4111"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4112"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4113"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4114"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4115"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4116"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4117"></a>
<a name="ln-4118"></a>
<a name="ln-4119"></a>  <span class="k">CALL </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4120"></a>
<a name="ln-4121"></a>  <span class="k">CALL </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4122"></a>
<a name="ln-4123"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4124"></a><span class="k">    CALL </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4125"></a>    <span class="k">CALL </span><span class="n">UpdateEvaporativeCondenserWaterUse</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">CondInletHumrat</span><span class="p">,</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)</span>
<a name="ln-4126"></a>  <span class="n">ENDIF</span>
<a name="ln-4127"></a>
<a name="ln-4128"></a>  <span class="k">RETURN</span>
<a name="ln-4129"></a>
<a name="ln-4130"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESCoilChargeOnlyMode</span>
<a name="ln-4131"></a>
<a name="ln-4132"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESCoilDischargeOnlyMode</span><span class="p">(</span> <span class="n">TESCoilNum</span> <span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-4133"></a>
<a name="ln-4134"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4135"></a>          <span class="c">!       AUTHOR         Brent Griffith</span>
<a name="ln-4136"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-4137"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4138"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4139"></a>
<a name="ln-4140"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4141"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4142"></a>
<a name="ln-4143"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4144"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4145"></a>
<a name="ln-4146"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4147"></a>          <span class="c">! na</span>
<a name="ln-4148"></a>
<a name="ln-4149"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4150"></a>  <span class="k">USE </span><span class="n">CurveManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurveValue</span>
<a name="ln-4151"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-4152"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-4153"></a>
<a name="ln-4154"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4155"></a>
<a name="ln-4156"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4157"></a>  <span class="kt">INTEGER</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadRatio</span>
<a name="ln-4159"></a>
<a name="ln-4160"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4161"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">30</span>
<a name="ln-4162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RelaxationFactor</span> <span class="o">=</span> <span class="mf">0.4d0</span>
<a name="ln-4163"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Tolerance</span> <span class="o">=</span> <span class="mf">0.1d0</span>
<a name="ln-4164"></a>
<a name="ln-4165"></a>
<a name="ln-4166"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4167"></a>          <span class="c">! na</span>
<a name="ln-4168"></a>
<a name="ln-4169"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4170"></a>          <span class="c">! na</span>
<a name="ln-4171"></a>
<a name="ln-4172"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirMassFlowRatio</span> <span class="c">! evaporator inlet air mass flow divided by design mass flow [ ]</span>
<a name="ln-4174"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapAirMassFlow</span>   <span class="c">! local for evaporator air mass flow [kg/s]</span>
<a name="ln-4175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletDryBulb</span> <span class="c">! evaporator inlet air drybulb [C]</span>
<a name="ln-4176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletHumRat</span> <span class="c">! evaporator inlet air humidity ratio [kg/kg]</span>
<a name="ln-4177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletWetBulb</span> <span class="c">! evaporator inlet air wetbulb [C]</span>
<a name="ln-4178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapInletEnthalpy</span> <span class="c">! evaporator inlet air enthalpy [J/kg]</span>
<a name="ln-4179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sTES</span> <span class="c">! state of charge of Thermal Energy Storage</span>
<a name="ln-4180"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapTempModFac</span> <span class="c">! total coolin capacity modification factor due to temps []</span>
<a name="ln-4181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCapFlowModFac</span> <span class="c">!Total cooling capacity modification factor due to flow []</span>
<a name="ln-4182"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotCap</span> <span class="c">! total cooling capacity</span>
<a name="ln-4183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRTempFac</span> <span class="c">! sensible heat ratio modification factor due to temps []</span>
<a name="ln-4184"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRFlowFac</span> <span class="c">! sensible heat ratio modification factor due to flow []</span>
<a name="ln-4185"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHR</span> <span class="c">! sensible heat ratio</span>
<a name="ln-4186"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF</span>   <span class="c">! part load factor</span>
<a name="ln-4187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLR</span>   <span class="c">! part load ratio</span>
<a name="ln-4188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFraction</span> <span class="c">! compressor running time divided by full time of timestep.</span>
<a name="ln-4189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirEnth</span> <span class="c">! evaporator outlet full load enthalpy [J/kg]</span>
<a name="ln-4190"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirHumRat</span> <span class="c">! evaporator outlet humidity ratio at full load</span>
<a name="ln-4191"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FullLoadOutAirTemp</span>  <span class="c">!evaporator outlet air temperature at full load [C]</span>
<a name="ln-4192"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwout</span>   <span class="c">! Enthalpy at inlet dry-bulb and outlet humidity ratio [J/kg]</span>
<a name="ln-4193"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirEnthalpy</span> <span class="c">! evaporator outlet air enthalpy [J/kg]</span>
<a name="ln-4194"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirHumRat</span> <span class="c">!evaporator outlet air humidity ratio [kg/kg]</span>
<a name="ln-4195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EvapOutletAirTemp</span> <span class="c">!evaporator outlet dryblub [C]</span>
<a name="ln-4196"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRTempModFac</span> <span class="c">! energy input ratio modification factor due to temperatures []</span>
<a name="ln-4197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIRFlowModFac</span> <span class="c">!energy input ratio modification factor due to flow []</span>
<a name="ln-4198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EIR</span> <span class="c">! energy input ratio</span>
<a name="ln-4199"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ElecCoolingPower</span> <span class="c">! compressor electric power</span>
<a name="ln-4200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MinAirHumRat</span> <span class="c">! minimum air humidity ratio</span>
<a name="ln-4201"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">TESHasSomeCharge</span> <span class="c">! true when there is something avaiable in storage</span>
<a name="ln-4202"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotDischargelimit</span> <span class="c">! limit for how much storage can be discharged without overshooting</span>
<a name="ln-4203"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>                 <span class="c">! density of water in tank (kg/m3)</span>
<a name="ln-4204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TankMass</span>            <span class="c">! Mass of water in tank (kg)</span>
<a name="ln-4205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CpTank</span>              <span class="c">! Specific heat of water in tank (J/kg K)</span>
<a name="ln-4206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">QdotTEStest</span>
<a name="ln-4207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RuntimeFractionLimit</span>
<a name="ln-4208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadOutAirEnth</span> <span class="c">! local leaving enthalpy at part load</span>
<a name="ln-4209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="c">! local leaving drybulb if coil were dry</span>
<a name="ln-4210"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CoilMightBeDry</span>
<a name="ln-4211"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Counter</span>
<a name="ln-4212"></a>  <span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">Converged</span>
<a name="ln-4213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-4214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DryCoilTestEvapInletWetBulb</span>
<a name="ln-4215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hADP</span>
<a name="ln-4216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tADP</span>
<a name="ln-4217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">wADP</span>
<a name="ln-4218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hTinwADP</span>
<a name="ln-4219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SHRadp</span>
<a name="ln-4220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">werror</span>
<a name="ln-4221"></a>
<a name="ln-4222"></a>  <span class="n">PLR</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-4223"></a>
<a name="ln-4224"></a>  <span class="n">EvapAirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4225"></a>  <span class="n">EvapInletDryBulb</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4226"></a>  <span class="n">EvapInletHumRat</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4227"></a>  <span class="n">EvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4228"></a>  <span class="n">EvapInletEnthalpy</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>
<a name="ln-4229"></a>  <span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4230"></a>
<a name="ln-4231"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-4232"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span>
<a name="ln-4233"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">sTES</span> <span class="o">&gt;=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MinimumFluidTankTempLimit</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&lt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4234"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4235"></a>      <span class="n">rho</span>             <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4236"></a>                                         <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESWaterStorageTank&#39;</span><span class="p">)</span>
<a name="ln-4237"></a>      <span class="n">TankMass</span>        <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span>
<a name="ln-4238"></a>      <span class="n">CpTank</span>          <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">sTES</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4239"></a>                                              <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESWaterStorageTank&#39;</span><span class="p">)</span>
<a name="ln-4240"></a>      <span class="c">!simple linear approximation of DT/Dt term in McpDT/Dt</span>
<a name="ln-4241"></a>      <span class="n">QdotDischargelimit</span> <span class="o">=</span> <span class="n">TankMass</span> <span class="o">*</span> <span class="n">CpTank</span> <span class="o">*</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">MaximumFluidTankTempLimit</span> <span class="o">-</span> <span class="n">sTES</span><span class="p">)</span><span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-4242"></a>    <span class="k">ELSE</span>
<a name="ln-4243"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4244"></a>    <span class="n">ENDIF</span>
<a name="ln-4245"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4246"></a><span class="k">    </span><span class="n">sTES</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span>
<a name="ln-4247"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">sTES</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4248"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4249"></a>      <span class="c">! discharge limit</span>
<a name="ln-4250"></a>      <span class="n">QdotDischargelimit</span> <span class="o">=</span> <span class="p">(</span><span class="n">sTES</span><span class="p">)</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span> <span class="o">/</span> <span class="p">(</span><span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span><span class="p">)</span>
<a name="ln-4251"></a>    <span class="k">ELSE</span>
<a name="ln-4252"></a><span class="k">      </span><span class="n">TESHasSomeCharge</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4253"></a>    <span class="n">ENDIF</span>
<a name="ln-4254"></a>  <span class="n">ENDIF</span>
<a name="ln-4255"></a>
<a name="ln-4256"></a>
<a name="ln-4257"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">EvapAirMassFlow</span> <span class="o">&gt;</span> <span class="n">SmallMassFlow</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">PLR</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TESHasSomeCharge</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">! coil is running</span>
<a name="ln-4258"></a>    <span class="n">AirMassFlowRatio</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RatedEvapAirMassFlowRate</span>
<a name="ln-4259"></a>
<a name="ln-4260"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-4261"></a>    <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">)</span>
<a name="ln-4262"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4263"></a>    <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span>
<a name="ln-4264"></a>    <span class="n">TotCap</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span>  <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-4265"></a>
<a name="ln-4266"></a>    <span class="n">PLF</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyPLFFPLRCurve</span><span class="p">,</span> <span class="n">PLR</span><span class="p">)</span>
<a name="ln-4267"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLF</span> <span class="o">&gt;=</span> <span class="n">PLR</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">PLF</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4268"></a><span class="k">      </span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF</span>
<a name="ln-4269"></a>    <span class="k">ELSE</span>
<a name="ln-4270"></a><span class="k">      </span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="c">! warn maybe</span>
<a name="ln-4271"></a>    <span class="n">ENDIF</span>
<a name="ln-4272"></a>    <span class="c">! Calculate electricity consumed. First, get EIR modifying factors for off-rated conditions</span>
<a name="ln-4273"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-4274"></a>    <span class="n">EIRTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRTempModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-4275"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyEIRFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4276"></a>    <span class="n">EIRFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">EIRFlowModFac</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-4277"></a>    <span class="n">EIR</span> <span class="o">=</span> <span class="n">EIRTempModFac</span> <span class="o">*</span> <span class="n">EIRFlowModFac</span> <span class="o">/</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedCOP</span>
<a name="ln-4278"></a>
<a name="ln-4279"></a>    <span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">RuntimeFraction</span>
<a name="ln-4280"></a>    <span class="n">QdotTEStest</span>      <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span><span class="n">RuntimeFraction</span> <span class="o">+</span> <span class="n">ElecCoolingPower</span>
<a name="ln-4281"></a>
<a name="ln-4282"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QdotTEStest</span> <span class="o">&gt;</span> <span class="n">QdotDischargelimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4283"></a><span class="k">      </span><span class="n">RuntimeFractionLimit</span> <span class="o">=</span> <span class="n">QdotDischargelimit</span> <span class="o">/</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">+</span>  <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span><span class="p">)</span>
<a name="ln-4284"></a>      <span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">RuntimeFraction</span><span class="p">,</span> <span class="n">RuntimeFractionLimit</span><span class="p">)</span>
<a name="ln-4285"></a>      <span class="n">PLR</span> <span class="o">=</span> <span class="n">RuntimeFraction</span> <span class="o">*</span> <span class="n">PLF</span>
<a name="ln-4286"></a>      <span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">TotCap</span> <span class="o">*</span> <span class="n">EIR</span> <span class="o">*</span> <span class="n">RuntimeFraction</span>
<a name="ln-4287"></a>    <span class="n">ENDIF</span>
<a name="ln-4288"></a>    <span class="c">! now see if coil is running dry</span>
<a name="ln-4289"></a>    <span class="n">PartLoadOutAirEnth</span> <span class="o">=</span>  <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">*</span> <span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-4290"></a>    <span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span> <span class="n">EvapInletHumRat</span><span class="p">,</span><span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4291"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PartLoadDryCoilOutAirTemp</span> <span class="o">&gt;</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">PartLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4292"></a><span class="k">      </span><span class="n">CoilMightBeDry</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4293"></a>      <span class="c">! find wADP, humidity ratio at apparatus dewpoint and inlet hum rat that would have dry coil</span>
<a name="ln-4294"></a>      <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">EvapInletHumRat</span>
<a name="ln-4295"></a>      <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">EvapInletWetBulb</span>
<a name="ln-4296"></a>      <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4297"></a>      <span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4298"></a>      <span class="k">DO While</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Converged</span><span class="p">)</span>
<a name="ln-4299"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyCapFTempCurve</span><span class="p">,</span> <span class="n">DryCoilTestEvapInletWetBulb</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-4300"></a>        <span class="n">TotCapTempModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapTempModFac</span><span class="p">)</span>
<a name="ln-4301"></a>        <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyCapFFlowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4302"></a>        <span class="n">TotCapFlowModFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">TotCapFlowModFac</span><span class="p">)</span>
<a name="ln-4303"></a>        <span class="n">TotCap</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedDischargeCap</span>  <span class="o">*</span> <span class="n">TotCapTempModFac</span> <span class="o">*</span> <span class="n">TotCapFlowModFac</span>
<a name="ln-4304"></a>        <span class="c">! coil bypass factor = 0.0</span>
<a name="ln-4305"></a>        <span class="n">hADP</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-4306"></a>        <span class="n">tADP</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">hADP</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4307"></a>        <span class="n">wADP</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">EvapInletHumRat</span><span class="p">,</span> <span class="n">PsyWfnTdbH</span><span class="p">(</span><span class="n">tADP</span><span class="p">,</span> <span class="n">hADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-4308"></a>        <span class="n">hTinwADP</span> <span class="o">=</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">wADP</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4309"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">hADP</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4310"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">hTinwADP</span><span class="o">-</span><span class="n">hADP</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">EvapInletEnthalpy</span><span class="o">-</span><span class="n">hADP</span><span class="p">),</span><span class="mf">1.d0</span><span class="p">)</span>
<a name="ln-4311"></a>        <span class="k">ELSE</span>
<a name="ln-4312"></a><span class="k">          </span><span class="n">SHRadp</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4313"></a>        <span class="n">ENDIF</span>
<a name="ln-4314"></a>
<a name="ln-4315"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">wADP</span> <span class="o">&gt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">Counter</span> <span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Counter</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4316"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="mf">0.00001d0</span>
<a name="ln-4317"></a>          <span class="n">werror</span> <span class="o">=</span> <span class="p">(</span><span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">-</span>  <span class="n">wADP</span><span class="p">)</span><span class="o">/</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-4318"></a>
<a name="ln-4319"></a>          <span class="n">DryCoilTestEvapInletHumRat</span> <span class="o">=</span> <span class="n">RelaxationFactor</span><span class="o">*</span><span class="n">wADP</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RelaxationFactor</span><span class="p">)</span><span class="o">*</span><span class="n">DryCoilTestEvapInletHumRat</span>
<a name="ln-4320"></a>          <span class="n">DryCoilTestEvapInletWetBulb</span> <span class="o">=</span> <span class="n">PsyTwbFnTdbWPb</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">,</span> <span class="n">OutBaroPress</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4321"></a>                                                    <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4322"></a>
<a name="ln-4323"></a>          <span class="n">Counter</span> <span class="o">=</span> <span class="n">Counter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4324"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">werror</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">Tolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4325"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4326"></a>          <span class="k">ELSE</span>
<a name="ln-4327"></a><span class="k">            </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4328"></a>          <span class="n">ENDIF</span>
<a name="ln-4329"></a>        <span class="k">ELSE</span>
<a name="ln-4330"></a><span class="k">          </span><span class="n">Converged</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4331"></a>        <span class="n">ENDIF</span>
<a name="ln-4332"></a>
<a name="ln-4333"></a>      <span class="n">ENDDO</span>
<a name="ln-4334"></a>    <span class="n">ENDIF</span> <span class="c">! coil will be wet so use SHR curves</span>
<a name="ln-4335"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempObjectNum</span> <span class="p">)</span>
<a name="ln-4336"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">CurveType_BiCubic</span><span class="p">,</span> <span class="n">CurveType_BiQuadratic</span><span class="p">,</span> <span class="n">CurveType_QuadraticLinear</span><span class="p">,</span> <span class="n">CurveType_TableTwoIV</span> <span class="p">)</span>
<a name="ln-4337"></a>      <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">)</span>
<a name="ln-4338"></a>    <span class="k">CASE</span> <span class="p">(</span> <span class="n">CurveType_TriQuadratic</span><span class="p">,</span> <span class="n">CurveType_TableMultiIV</span> <span class="p">)</span>
<a name="ln-4339"></a>      <span class="n">SHRTempFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlySHRFTempCurve</span><span class="p">,</span> <span class="n">EvapInletWetBulb</span><span class="p">,</span> <span class="n">EvapInletDryBulb</span><span class="p">,</span> <span class="n">sTES</span><span class="p">)</span>
<a name="ln-4340"></a>    <span class="k">END SELECT</span>
<a name="ln-4341"></a>
<a name="ln-4342"></a><span class="k">    </span><span class="n">SHRFlowFac</span> <span class="o">=</span> <span class="n">CurveValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlySHRFFLowCurve</span><span class="p">,</span> <span class="n">AirMassFlowRatio</span><span class="p">)</span>
<a name="ln-4343"></a>    <span class="n">SHR</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">DischargeOnlyRatedSHR</span> <span class="o">*</span> <span class="n">SHRTempFac</span> <span class="o">*</span> <span class="n">SHRFlowFac</span>
<a name="ln-4344"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-4345"></a>    <span class="n">SHR</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SHR</span><span class="p">,</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="c">! warn maybe</span>
<a name="ln-4346"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">CoilMightBeDry</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4347"></a><span class="k">      IF</span> <span class="p">((</span><span class="n">EvapInletHumRat</span> <span class="o">&lt;</span> <span class="n">DryCoilTestEvapInletHumRat</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">! coil is dry for sure</span>
<a name="ln-4348"></a>        <span class="n">SHR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4349"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SHRadp</span> <span class="o">&gt;</span> <span class="n">SHR</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4350"></a><span class="k">        </span><span class="n">SHR</span> <span class="o">=</span> <span class="n">SHRadp</span>
<a name="ln-4351"></a>      <span class="n">ENDIF</span>
<a name="ln-4352"></a>    <span class="n">ENDIF</span>
<a name="ln-4353"></a>    <span class="c">!  Calculate full load output conditions</span>
<a name="ln-4354"></a>    <span class="n">FullLoadOutAirEnth</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-4355"></a>
<a name="ln-4356"></a>    <span class="n">hTinwout</span> <span class="o">=</span> <span class="n">EvapInletEnthalpy</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SHR</span><span class="p">)</span><span class="o">*</span> <span class="p">(</span><span class="n">TotCap</span> <span class="o">/</span> <span class="n">EvapAirMassFlow</span><span class="p">)</span>
<a name="ln-4357"></a>    <span class="c">!The following will often throw psych warnings for neg w, suppress warnings because error condition is handled in next IF</span>
<a name="ln-4358"></a>    <span class="n">FullLoadOutAirHumRat</span> <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapInletDryBulb</span><span class="p">,</span><span class="n">hTinwout</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">,</span> <span class="n">SuppressWarnings</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.)</span>
<a name="ln-4359"></a>    <span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">FullLoadOutAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4360"></a>    <span class="c">! Check for saturation error and modify temperature at constant enthalpy</span>
<a name="ln-4361"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4362"></a><span class="k">      </span><span class="n">FullLoadOutAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4363"></a>      <span class="n">FullLoadOutAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">FullLoadOutAirTemp</span><span class="p">,</span><span class="n">FullLoadOutAirEnth</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4364"></a>    <span class="n">ENDIF</span>
<a name="ln-4365"></a>
<a name="ln-4366"></a>    <span class="c">! Continuous fan, cycling compressor</span>
<a name="ln-4367"></a>    <span class="n">EvapOutletAirEnthalpy</span> <span class="o">=</span> <span class="p">((</span><span class="n">PLR</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirEnth</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4368"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PLR</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletEnthalpy</span><span class="p">)</span>
<a name="ln-4369"></a>    <span class="n">EvapOutletAirHumRat</span> <span class="o">=</span> <span class="p">((</span><span class="n">PLR</span><span class="p">)</span><span class="o">*</span><span class="n">FullLoadOutAirHumRat</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4370"></a>                                            <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">PLR</span> <span class="p">))</span><span class="o">*</span><span class="n">EvapInletHumRat</span><span class="p">)</span>
<a name="ln-4371"></a>    <span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTdbFnHW</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">EvapOutletAirHumRat</span><span class="p">)</span>
<a name="ln-4372"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4373"></a><span class="k">      </span><span class="n">EvapOutletAirTemp</span> <span class="o">=</span> <span class="n">PsyTsatFnHPb</span><span class="p">(</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span><span class="n">OutBaroPress</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4374"></a>      <span class="n">EvapOutletAirHumRat</span>  <span class="o">=</span> <span class="n">PsyWFnTdbH</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span><span class="n">EvapOutletAirEnthalpy</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4375"></a>    <span class="n">ENDIF</span>
<a name="ln-4376"></a>
<a name="ln-4377"></a>
<a name="ln-4378"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">EvapOutletAirTemp</span>
<a name="ln-4379"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">EvapOutletAirHumRat</span>
<a name="ln-4380"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>     <span class="o">=</span> <span class="n">EvapOutletAirEnthalpy</span>
<a name="ln-4381"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">EvapAirMassFlow</span>
<a name="ln-4382"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">=</span> <span class="n">ElecCoolingPower</span> <span class="o">+</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-4383"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4384"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span> <span class="o">=</span> <span class="n">RuntimeFraction</span>
<a name="ln-4385"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span> <span class="n">RuntimeFraction</span> <span class="c">! double check this</span>
<a name="ln-4386"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span> <span class="n">RuntimeFraction</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4387"></a>    <span class="n">MinAirHumRat</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4388"></a>                        <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span> <span class="p">)</span>
<a name="ln-4389"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span> <span class="n">EvapAirMassFlow</span> <span class="o">*</span><span class="p">&amp;</span>
<a name="ln-4390"></a>                      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapInletDryBulb</span> <span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4391"></a>                        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">EvapOutletAirTemp</span><span class="p">,</span> <span class="n">MinAirHumRat</span><span class="p">,</span> <span class="s1">&#39;CalcTESCoilDischargeOnlyMode&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-4392"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">&gt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4393"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>
<a name="ln-4394"></a>    <span class="n">ENDIF</span>
<a name="ln-4395"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4396"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span> <span class="p">&amp;</span>
<a name="ln-4397"></a>                                              <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>
<a name="ln-4398"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4399"></a>
<a name="ln-4400"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>  <span class="o">=</span> <span class="n">TotCap</span><span class="o">*</span><span class="n">RuntimeFraction</span> <span class="o">+</span> <span class="n">ElecCoolingPower</span> <span class="c">! all heat rejection into storage</span>
<a name="ln-4401"></a>
<a name="ln-4402"></a>  <span class="k">ELSE</span> <span class="c">!coil is off; just pass through conditions</span>
<a name="ln-4403"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4404"></a>
<a name="ln-4405"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AncillaryControlsPower</span>
<a name="ln-4406"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingEnergy</span>  <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElecCoolingPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4407"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4408"></a>
<a name="ln-4409"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">RuntimeFraction</span>      <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4410"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4411"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapTotCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4412"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingRate</span>  <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4413"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapSensCoolingEnergy</span><span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4414"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingRate</span>   <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4415"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapLatCoolingEnergy</span> <span class="o">=</span>  <span class="mf">0.d0</span>
<a name="ln-4416"></a>
<a name="ln-4417"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4418"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4419"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4420"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span><span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4421"></a>                                                            <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4422"></a>                                                                       <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4423"></a>                                                                       <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4424"></a>  <span class="n">ENDIF</span>
<a name="ln-4425"></a>
<a name="ln-4426"></a>  <span class="c">!nothing happens at condenser</span>
<a name="ln-4427"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>         <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4428"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span>       <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-4429"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span>  <span class="p">)%</span><span class="n">MassFlowRate</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4430"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-4431"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Enthalpy</span>      <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4432"></a>                                                          <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4433"></a>                                                                      <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirOutletNodeNum</span> <span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4434"></a>                                                                      <span class="s1">&#39;CalcTESCoilCoolingOnlyMode&#39;</span><span class="p">)</span>
<a name="ln-4435"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondInletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4436"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_TES</span>   <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4437"></a>  <span class="k">CALL </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4438"></a>
<a name="ln-4439"></a>  <span class="k">CALL </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4440"></a>
<a name="ln-4441"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserType</span> <span class="o">==</span> <span class="n">EvapCooled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4442"></a><span class="k">    CALL </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4443"></a>    <span class="k">CALL </span><span class="n">UpdateEvaporativeCondenserWaterUse</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4444"></a>                                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondAirInletNodeNum</span> <span class="p">)</span>
<a name="ln-4445"></a>  <span class="n">ENDIF</span>
<a name="ln-4446"></a>
<a name="ln-4447"></a>  <span class="k">RETURN</span>
<a name="ln-4448"></a>
<a name="ln-4449"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESCoilDischargeOnlyMode</span>
<a name="ln-4450"></a>
<a name="ln-4451"></a>
<a name="ln-4452"></a><span class="k">SUBROUTINE </span><span class="n">UpdateTEStorage</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4453"></a>
<a name="ln-4454"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4455"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-4456"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-4457"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4458"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4459"></a>
<a name="ln-4460"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4461"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4462"></a>
<a name="ln-4463"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4464"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4465"></a>
<a name="ln-4466"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4467"></a>          <span class="c">! na</span>
<a name="ln-4468"></a>
<a name="ln-4469"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4470"></a>          <span class="c">! na</span>
<a name="ln-4471"></a>
<a name="ln-4472"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4473"></a>
<a name="ln-4474"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4475"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4476"></a>
<a name="ln-4477"></a>
<a name="ln-4478"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4479"></a>          <span class="c">! na</span>
<a name="ln-4480"></a>
<a name="ln-4481"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4482"></a>          <span class="c">! na</span>
<a name="ln-4483"></a>
<a name="ln-4484"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4485"></a>          <span class="c">! na</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4488"></a>          <span class="c">! na</span>
<a name="ln-4489"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">FluidBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4490"></a><span class="k">    CALL </span><span class="n">CalcTESWaterStorageTank</span><span class="p">(</span> <span class="n">TESCoilNum</span> <span class="p">)</span>
<a name="ln-4491"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageMedia</span> <span class="o">==</span> <span class="n">IceBased</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4492"></a><span class="k">    CALL </span><span class="n">CalcTESIceStorageTank</span><span class="p">(</span> <span class="n">TESCoilNum</span> <span class="p">)</span>
<a name="ln-4493"></a>  <span class="n">ENDIF</span>
<a name="ln-4494"></a>
<a name="ln-4495"></a>  <span class="k">RETURN</span>
<a name="ln-4496"></a>
<a name="ln-4497"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateTEStorage</span>
<a name="ln-4498"></a>
<a name="ln-4499"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESWaterStorageTank</span><span class="p">(</span> <span class="n">TESCoilNum</span> <span class="p">)</span>
<a name="ln-4500"></a>
<a name="ln-4501"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4502"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-4503"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-4504"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4505"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4506"></a>
<a name="ln-4507"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4508"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4509"></a>
<a name="ln-4510"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4511"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4512"></a>
<a name="ln-4513"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4514"></a>          <span class="c">! na</span>
<a name="ln-4515"></a>
<a name="ln-4516"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4517"></a>  <span class="k">USE </span><span class="n">WaterThermalTanks</span> <span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcTankTemp</span><span class="p">,</span> <span class="n">CalcTempIntegral</span>
<a name="ln-4518"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-4519"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">HourOfDay</span>
<a name="ln-4520"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">,</span> <span class="n">GetDensityGlycol</span>
<a name="ln-4521"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-4522"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-4523"></a>
<a name="ln-4524"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4525"></a>
<a name="ln-4526"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4527"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4528"></a>
<a name="ln-4529"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4530"></a>          <span class="c">! na</span>
<a name="ln-4531"></a>
<a name="ln-4532"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4533"></a>          <span class="c">! na</span>
<a name="ln-4534"></a>
<a name="ln-4535"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4536"></a>          <span class="c">! na</span>
<a name="ln-4537"></a>
<a name="ln-4538"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4539"></a>
<a name="ln-4540"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-4541"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AmbientTemp</span>         <span class="c">! Current ambient air temperature around tank (C)</span>
<a name="ln-4542"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankMass</span>            <span class="c">! Mass of water in tank (kg)</span>
<a name="ln-4543"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">LossCoeff</span>           <span class="c">! Loss coefficient to ambient environment (W/K)</span>
<a name="ln-4544"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TankTemp</span>            <span class="c">! Instantaneous tank temperature (C)</span>
<a name="ln-4545"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NewTankTemp</span>         <span class="c">! Predicted new tank temperature (C)</span>
<a name="ln-4546"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpTank</span>              <span class="c">! Specific heat of water in tank (J/kg K)</span>
<a name="ln-4547"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UseInletTemp</span>        <span class="c">! Use side inlet temperature (C)</span>
<a name="ln-4548"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">UseMassFlowRate</span>     <span class="c">! Use side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-4549"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SourceInletTemp</span>     <span class="c">! Source side inlet temperature (C)</span>
<a name="ln-4550"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SourceMassFlowRate</span>  <span class="c">! Source side flow rate, including effectiveness factor (kg/s)</span>
<a name="ln-4551"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">TimeRemaining</span>       <span class="c">! Time remaining in the current timestep (s)</span>
<a name="ln-4552"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CpPlantConnection</span>   <span class="c">! Specific heat of fluid in plant connection (J/kg K)</span>
<a name="ln-4553"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">deltaTsum</span>           <span class="c">! Change in integrated tank temperature, dividing by time gives the average (C s)</span>
<a name="ln-4554"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SecInTimeStep</span>       <span class="c">! Seconds in one timestep (s)</span>
<a name="ln-4555"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span>                 <span class="c">! density of water in tank (kg/m3)</span>
<a name="ln-4556"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QdotTES</span>             <span class="c">! heat exchange directly into tank from charging system [W]</span>
<a name="ln-4557"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NewOutletTemp</span>       <span class="c">! calculated new tankoutlet temp (C)</span>
<a name="ln-4558"></a>
<a name="ln-4559"></a>  <span class="n">SecInTimeStep</span> <span class="o">=</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4560"></a>  <span class="n">TimeRemaining</span> <span class="o">=</span> <span class="n">SecInTimeStep</span>
<a name="ln-4561"></a>
<a name="ln-4562"></a>  <span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4563"></a>
<a name="ln-4564"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4565"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinal</span>
<a name="ln-4566"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-4567"></a>  <span class="n">ENDIF</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a>  <span class="n">TankTemp</span>        <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span>
<a name="ln-4570"></a>  <span class="n">AmbientTemp</span>     <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageAmbientNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4571"></a>  <span class="n">UseInletTemp</span>    <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span> <span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4572"></a>  <span class="n">SourceInletTemp</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinalLastTimestep</span>
<a name="ln-4573"></a>  <span class="n">rho</span>             <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">TankTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4574"></a>                                     <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESWaterStorageTank&#39;</span><span class="p">)</span>
<a name="ln-4575"></a>  <span class="n">TankMass</span>        <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidStorageVolume</span>
<a name="ln-4576"></a>  <span class="n">CpTank</span>          <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidName</span><span class="p">,</span> <span class="n">TankTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4577"></a>                                           <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageFluidIndex</span><span class="p">,</span> <span class="s1">&#39;CalcTESWaterStorageTank&#39;</span><span class="p">)</span>
<a name="ln-4578"></a>
<a name="ln-4579"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4580"></a><span class="k">    </span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4581"></a>                        <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantEffectiveness</span>
<a name="ln-4582"></a>  <span class="k">ELSE</span>
<a name="ln-4583"></a><span class="k">    </span><span class="n">UseMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4584"></a>  <span class="n">ENDIF</span>
<a name="ln-4585"></a>  <span class="n">SourceMassFlowRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4586"></a>  <span class="n">LossCoeff</span>      <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageUA</span>
<a name="ln-4587"></a>  <span class="n">QdotTES</span>        <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>
<a name="ln-4588"></a>
<a name="ln-4589"></a>
<a name="ln-4590"></a>  <span class="n">NewTankTemp</span> <span class="o">=</span> <span class="n">CalcTankTemp</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4591"></a>                                     <span class="n">CpTank</span><span class="p">,</span> <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">QdotTES</span><span class="p">,</span> <span class="n">TimeRemaining</span><span class="p">)</span>
<a name="ln-4592"></a>
<a name="ln-4593"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">FluidTankTempFinal</span> <span class="o">=</span> <span class="n">NewTankTemp</span>
<a name="ln-4594"></a>
<a name="ln-4595"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4596"></a><span class="k">    </span><span class="n">CpPlantConnection</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-4597"></a>              <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4598"></a>              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4599"></a>              <span class="s1">&#39;CalcTESIceStorageTank&#39;</span><span class="p">)</span>
<a name="ln-4600"></a>
<a name="ln-4601"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpPlantConnection</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4602"></a>                                      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantEffectiveness</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4603"></a>                                     <span class="p">(</span><span class="n">UseInletTemp</span>    <span class="o">-</span> <span class="n">NewTankTemp</span> <span class="p">)</span>
<a name="ln-4604"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Plant</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4605"></a>    <span class="c">! now get correct outlet temp with actual massflow (not modified by effectiveness)</span>
<a name="ln-4606"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="n">MassFlowTolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4607"></a><span class="k">      </span><span class="n">NewOutletTemp</span> <span class="o">=</span> <span class="n">UseInletTemp</span> <span class="o">-</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4608"></a>                                  <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpPlantConnection</span><span class="p">)</span>
<a name="ln-4609"></a>    <span class="k">ELSE</span>
<a name="ln-4610"></a><span class="k">      </span><span class="n">NewOutletTemp</span> <span class="o">=</span> <span class="n">UseInletTemp</span>
<a name="ln-4611"></a>    <span class="n">ENDIF</span>
<a name="ln-4612"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">NewOutletTemp</span>
<a name="ln-4613"></a>  <span class="n">ENDIF</span>
<a name="ln-4614"></a>
<a name="ln-4615"></a>  <span class="n">deltaTsum</span> <span class="o">=</span> <span class="n">CalcTempIntegral</span><span class="p">(</span><span class="n">TankTemp</span><span class="p">,</span> <span class="n">NewTankTemp</span><span class="p">,</span> <span class="n">AmbientTemp</span><span class="p">,</span> <span class="n">UseInletTemp</span><span class="p">,</span> <span class="n">SourceInletTemp</span><span class="p">,</span> <span class="n">TankMass</span><span class="p">,</span> <span class="n">CpTank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4616"></a>                                 <span class="n">UseMassFlowRate</span><span class="p">,</span> <span class="n">SourceMassFlowRate</span><span class="p">,</span> <span class="n">LossCoeff</span><span class="p">,</span> <span class="n">QdotTES</span><span class="p">,</span> <span class="n">TimeRemaining</span><span class="p">)</span>
<a name="ln-4617"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">=</span> <span class="p">(</span><span class="n">LossCoeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AmbientTemp</span> <span class="o">*</span> <span class="n">TimeRemaining</span> <span class="o">-</span> <span class="n">deltaTsum</span><span class="p">))</span><span class="o">/</span><span class="n">SecInTimeStep</span>
<a name="ln-4618"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Ambient</span> <span class="o">=</span>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4619"></a>
<a name="ln-4620"></a>
<a name="ln-4621"></a>  <span class="k">RETURN</span>
<a name="ln-4622"></a>
<a name="ln-4623"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESWaterStorageTank</span>
<a name="ln-4624"></a>
<a name="ln-4625"></a><span class="k">SUBROUTINE </span><span class="n">CalcTESIceStorageTank</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4626"></a>
<a name="ln-4627"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4628"></a>          <span class="c">!       AUTHOR         &lt;author&gt;</span>
<a name="ln-4629"></a>          <span class="c">!       DATE WRITTEN   &lt;date_written&gt;</span>
<a name="ln-4630"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4631"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4632"></a>
<a name="ln-4633"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4634"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4635"></a>
<a name="ln-4636"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4637"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4638"></a>
<a name="ln-4639"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4640"></a>          <span class="c">! na</span>
<a name="ln-4641"></a>
<a name="ln-4642"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4643"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">PlantLoop</span>
<a name="ln-4644"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span>  <span class="n">GetSpecificHeatGlycol</span>
<a name="ln-4645"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SysTimeElapsed</span><span class="p">,</span> <span class="n">TimeStepSys</span>
<a name="ln-4646"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">HourOfDay</span>
<a name="ln-4647"></a>  <span class="k">USE </span><span class="n">DataBranchAirLoopPlant</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MassFlowTolerance</span>
<a name="ln-4648"></a>
<a name="ln-4649"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4650"></a>
<a name="ln-4651"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4652"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4653"></a>
<a name="ln-4654"></a>
<a name="ln-4655"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FreezingTemp</span> <span class="o">=</span> <span class="mf">0.d0</span> <span class="c">! zero degrees C</span>
<a name="ln-4657"></a>
<a name="ln-4658"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4659"></a>          <span class="c">! na</span>
<a name="ln-4660"></a>
<a name="ln-4661"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4662"></a>          <span class="c">! na</span>
<a name="ln-4663"></a>
<a name="ln-4664"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4665"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Cp</span> <span class="c">! local specific heat</span>
<a name="ln-4666"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QdotIce</span> <span class="c">! local rate of heat transfer to ice (negative cooling) [W]</span>
<a name="ln-4667"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">TimeElapsed</span>         <span class="c">! Fraction of the current hour that has elapsed (h)</span>
<a name="ln-4668"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">NewOutletTemp</span>       <span class="c">! calculated new tankoutlet temp (C)</span>
<a name="ln-4669"></a>
<a name="ln-4670"></a>  <span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">HourOfDay</span> <span class="o">+</span> <span class="n">TimeStep</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">+</span> <span class="n">SysTimeElapsed</span>
<a name="ln-4671"></a>
<a name="ln-4672"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">/=</span> <span class="n">TimeElapsed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4673"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span>
<a name="ln-4674"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TimeElapsed</span> <span class="o">=</span> <span class="n">TimeElapsed</span>
<a name="ln-4675"></a>  <span class="n">ENDIF</span>
<a name="ln-4676"></a>
<a name="ln-4677"></a>  <span class="c">!update plant connection (if any)</span>
<a name="ln-4678"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantConnectionAvailable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4679"></a><span class="k">    </span><span class="n">Cp</span> <span class="o">=</span> <span class="n">GetSpecificHeatGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span>            <span class="p">&amp;</span>
<a name="ln-4680"></a>              <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4681"></a>              <span class="n">PlantLoop</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantLoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4682"></a>              <span class="s1">&#39;CalcTESIceStorageTank&#39;</span><span class="p">)</span>
<a name="ln-4683"></a>
<a name="ln-4684"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4685"></a>                                      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantEffectiveness</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4686"></a>                                     <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>  <span class="p">&amp;</span>
<a name="ln-4687"></a>                                       <span class="o">-</span> <span class="n">FreezingTemp</span> <span class="p">)</span>
<a name="ln-4688"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Plant</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4689"></a>    <span class="c">! now get correct outlet temp with actual massflow (not modified by effectiveness)</span>
<a name="ln-4690"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">&gt;</span> <span class="n">MassFlowTolerance</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4691"></a><span class="k">      </span><span class="n">NewOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-4692"></a>                                  <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">Cp</span><span class="p">)</span>
<a name="ln-4693"></a>    <span class="k">ELSE</span>
<a name="ln-4694"></a><span class="k">      </span><span class="n">NewOutletTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantInletNodeNum</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-4695"></a>    <span class="n">ENDIF</span>
<a name="ln-4696"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">TESPlantOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">NewOutletTemp</span>
<a name="ln-4697"></a>  <span class="k">ELSE</span>
<a name="ln-4698"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4699"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Plant</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4700"></a>  <span class="n">ENDIF</span>
<a name="ln-4701"></a>
<a name="ln-4702"></a>  <span class="c">! update ambient heat transfer</span>
<a name="ln-4703"></a>
<a name="ln-4704"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageUA</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageAmbientNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">&amp;</span>
<a name="ln-4705"></a>                                            <span class="o">-</span> <span class="n">FreezingTemp</span><span class="p">)</span>
<a name="ln-4706"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">Q_Ambient</span> <span class="o">=</span>   <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4707"></a>
<a name="ln-4708"></a>  <span class="n">QdotIce</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotPlant</span> <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotAmbient</span> <span class="o">+</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">QdotTES</span>
<a name="ln-4709"></a>
<a name="ln-4710"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">QdotIce</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! charging ice level</span>
<a name="ln-4711"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-4712"></a>                                          <span class="nb">ABS</span><span class="p">(</span><span class="n">QdotIce</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>  <span class="p">)</span>
<a name="ln-4713"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">&gt;</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-4714"></a>  <span class="k">ELSE</span> <span class="c">! not charging,but discharging</span>
<a name="ln-4715"></a>    <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemainLastTimestep</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-4716"></a>                                          <span class="n">QdotIce</span><span class="o">/</span><span class="p">(</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceStorageCapacity</span><span class="o">/</span><span class="p">(</span><span class="n">TimeStepSys</span><span class="o">*</span><span class="n">SecInHour</span><span class="p">)</span>  <span class="p">)</span>
<a name="ln-4717"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">&lt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">IceFracRemain</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4718"></a>  <span class="n">ENDIF</span>
<a name="ln-4719"></a>
<a name="ln-4720"></a>  <span class="k">RETURN</span>
<a name="ln-4721"></a>
<a name="ln-4722"></a><span class="k">END SUBROUTINE </span><span class="n">CalcTESIceStorageTank</span>
<a name="ln-4723"></a>
<a name="ln-4724"></a>
<a name="ln-4725"></a><span class="k">SUBROUTINE </span><span class="n">UpdateColdWeatherProtection</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4726"></a>
<a name="ln-4727"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4728"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-4729"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-4730"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4731"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4732"></a>
<a name="ln-4733"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4734"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4735"></a>
<a name="ln-4736"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4737"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4738"></a>
<a name="ln-4739"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4740"></a>          <span class="c">! na</span>
<a name="ln-4741"></a>
<a name="ln-4742"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4743"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-4744"></a>
<a name="ln-4745"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4746"></a>
<a name="ln-4747"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4748"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4749"></a>
<a name="ln-4750"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4751"></a>          <span class="c">! na</span>
<a name="ln-4752"></a>
<a name="ln-4753"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4754"></a>          <span class="c">! na</span>
<a name="ln-4755"></a>
<a name="ln-4756"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4757"></a>          <span class="c">! na</span>
<a name="ln-4758"></a>
<a name="ln-4759"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4760"></a>          <span class="c">! na</span>
<a name="ln-4761"></a>
<a name="ln-4762"></a>
<a name="ln-4763"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">Node</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">StorageAmbientNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">&lt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ColdWeatherMinimumTempLimit</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4764"></a>      <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">AvailSchedNum</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4765"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherPower</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ColdWeatherAncillaryPower</span>
<a name="ln-4766"></a>
<a name="ln-4767"></a>  <span class="k">ELSE</span>
<a name="ln-4768"></a><span class="k">    </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherPower</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4769"></a>  <span class="n">ENDIF</span>
<a name="ln-4770"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectColdWeatherPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4771"></a>
<a name="ln-4772"></a>  <span class="k">RETURN</span>
<a name="ln-4773"></a>
<a name="ln-4774"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateColdWeatherProtection</span>
<a name="ln-4775"></a>
<a name="ln-4776"></a><span class="k">SUBROUTINE </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)</span>
<a name="ln-4777"></a>
<a name="ln-4778"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4779"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-4780"></a>          <span class="c">!       DATE WRITTEN   April 2013</span>
<a name="ln-4781"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4782"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4783"></a>
<a name="ln-4784"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4785"></a>          <span class="c">! determine basin heater electrical power and energy</span>
<a name="ln-4786"></a>
<a name="ln-4787"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4788"></a>          <span class="c">! call general worker routine</span>
<a name="ln-4789"></a>
<a name="ln-4790"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4791"></a>          <span class="c">! na</span>
<a name="ln-4792"></a>
<a name="ln-4793"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4794"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span> <span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">TimeStepSys</span>
<a name="ln-4795"></a>
<a name="ln-4796"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4797"></a>
<a name="ln-4798"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4799"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4800"></a>
<a name="ln-4801"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4802"></a>          <span class="c">! na</span>
<a name="ln-4803"></a>
<a name="ln-4804"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4805"></a>          <span class="c">! na</span>
<a name="ln-4806"></a>
<a name="ln-4807"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4808"></a>          <span class="c">! na</span>
<a name="ln-4809"></a>
<a name="ln-4810"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4811"></a>          <span class="c">! na</span>
<a name="ln-4812"></a>  <span class="k">CALL </span><span class="n">CalcBasinHeaterPower</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterPowerFTempDiff</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4813"></a>                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterAvailSchedNum</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-4814"></a>                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">BasinHeaterSetpointTemp</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-4815"></a>                            <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterPower</span><span class="p">)</span>
<a name="ln-4816"></a>
<a name="ln-4817"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterEnergy</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">ElectEvapCondBasinHeaterPower</span> <span class="p">&amp;</span>
<a name="ln-4818"></a>                                                        <span class="o">*</span> <span class="n">TimeStepSys</span>  <span class="o">*</span><span class="n">SecInHour</span>
<a name="ln-4819"></a>
<a name="ln-4820"></a>  <span class="k">RETURN</span>
<a name="ln-4821"></a>
<a name="ln-4822"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateEvaporativeCondenserBasinHeater</span>
<a name="ln-4823"></a>
<a name="ln-4824"></a><span class="k">SUBROUTINE </span><span class="n">UpdateEvaporativeCondenserWaterUse</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">,</span> <span class="n">HumRatAfterEvap</span><span class="p">,</span> <span class="n">InletNodeNum</span><span class="p">)</span>
<a name="ln-4825"></a>
<a name="ln-4826"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4827"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-4828"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-4829"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4830"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4831"></a>
<a name="ln-4832"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4833"></a>          <span class="c">! update and calculate water consumption for evaporatively cooled condensers</span>
<a name="ln-4834"></a>
<a name="ln-4835"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4836"></a>          <span class="c">! &lt;description&gt;</span>
<a name="ln-4837"></a>
<a name="ln-4838"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4839"></a>          <span class="c">! na</span>
<a name="ln-4840"></a>
<a name="ln-4841"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4842"></a>  <span class="k">USE </span><span class="n">DataWater</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">WaterStorage</span>
<a name="ln-4843"></a>
<a name="ln-4844"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4845"></a>
<a name="ln-4846"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4847"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TESCoilNum</span>
<a name="ln-4848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HumRatAfterEvap</span>
<a name="ln-4849"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">InletNodeNum</span>
<a name="ln-4850"></a>
<a name="ln-4851"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4852"></a>          <span class="c">! na</span>
<a name="ln-4853"></a>
<a name="ln-4854"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4855"></a>          <span class="c">! na</span>
<a name="ln-4856"></a>
<a name="ln-4857"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4858"></a>          <span class="c">! na</span>
<a name="ln-4859"></a>
<a name="ln-4860"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4861"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvailWaterRate</span>
<a name="ln-4862"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">RhoWater</span>
<a name="ln-4863"></a>
<a name="ln-4864"></a>
<a name="ln-4865"></a>  <span class="n">RhoWater</span> <span class="o">=</span> <span class="n">RhoH2O</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-4866"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4867"></a>             <span class="p">(</span><span class="n">HumRatAfterEvap</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-4868"></a>              <span class="n">Node</span><span class="p">(</span><span class="n">InletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">/</span><span class="n">RhoWater</span> <span class="o">*</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span>
<a name="ln-4869"></a>
<a name="ln-4870"></a>  <span class="c">! Set the demand request for supply water from water storage tank (if needed)</span>
<a name="ln-4871"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4872"></a><span class="k">    </span><span class="n">WaterStorage</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotRequestDemand</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4873"></a>      <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span>
<a name="ln-4874"></a>  <span class="n">ENDIF</span>
<a name="ln-4875"></a>
<a name="ln-4876"></a>  <span class="c">!check if should be starved by restricted flow from tank</span>
<a name="ln-4877"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupplyMode</span> <span class="o">==</span> <span class="n">WaterSupplyFromTank</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4878"></a><span class="k">    </span><span class="n">AvailWaterRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4879"></a>      <span class="n">WaterStorage</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterSupTankID</span><span class="p">)%</span><span class="n">VdotAvailDemand</span><span class="p">(</span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterTankDemandARRID</span><span class="p">)</span>
<a name="ln-4880"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AvailWaterRate</span> <span class="o">&lt;</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4881"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterStarvMakupRate</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">-</span> <span class="n">AvailWaterRate</span>
<a name="ln-4882"></a>      <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">=</span> <span class="n">AvailWaterRate</span>
<a name="ln-4883"></a>    <span class="k">ELSE</span>
<a name="ln-4884"></a><span class="k">      </span><span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterStarvMakupRate</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-4885"></a>    <span class="n">ENDIF</span>
<a name="ln-4886"></a>  <span class="n">ENDIF</span>
<a name="ln-4887"></a>
<a name="ln-4888"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsump</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterConsumpRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4889"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterStarvMakup</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapWaterStarvMakupRate</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4890"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecNomPower</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-4891"></a>                                                   <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">CondenserRuntimeFraction</span>
<a name="ln-4892"></a>  <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecConsumption</span> <span class="o">=</span> <span class="n">TESCoil</span><span class="p">(</span><span class="n">TESCoilNum</span><span class="p">)%</span><span class="n">EvapCondPumpElecPower</span> <span class="o">*</span> <span class="n">TimeStepSys</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-4893"></a>
<a name="ln-4894"></a>  <span class="k">RETURN</span>
<a name="ln-4895"></a>
<a name="ln-4896"></a><span class="k">END SUBROUTINE </span><span class="n">UpdateEvaporativeCondenserWaterUse</span>
<a name="ln-4897"></a>
<a name="ln-4898"></a><span class="k">SUBROUTINE </span><span class="n">GetTESCoilIndex</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">CoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-4899"></a>
<a name="ln-4900"></a>
<a name="ln-4901"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4902"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-4903"></a>          <span class="c">!       DATE WRITTEN   August 2013</span>
<a name="ln-4904"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4905"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4906"></a>
<a name="ln-4907"></a>
<a name="ln-4908"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4909"></a>          <span class="c">! This subroutine sets an index for a given TES Cooling Coil -- issues error message if that</span>
<a name="ln-4910"></a>          <span class="c">! coil is not a legal TES Cooling Coil.</span>
<a name="ln-4911"></a>
<a name="ln-4912"></a>
<a name="ln-4913"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4914"></a>          <span class="c">! na</span>
<a name="ln-4915"></a>
<a name="ln-4916"></a>
<a name="ln-4917"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4918"></a>          <span class="c">! na</span>
<a name="ln-4919"></a>
<a name="ln-4920"></a>
<a name="ln-4921"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4922"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItem</span>
<a name="ln-4923"></a>  <span class="k">USE </span><span class="n">DataInterfaces</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShowSevereError</span>
<a name="ln-4924"></a>
<a name="ln-4925"></a>
<a name="ln-4926"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4927"></a>
<a name="ln-4928"></a>
<a name="ln-4929"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4930"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CoilName</span>
<a name="ln-4931"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">CoilIndex</span>
<a name="ln-4932"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">ErrorsFound</span>
<a name="ln-4933"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>
<a name="ln-4934"></a>
<a name="ln-4935"></a>
<a name="ln-4936"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4937"></a>          <span class="c">! na</span>
<a name="ln-4938"></a>
<a name="ln-4939"></a>
<a name="ln-4940"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4941"></a>          <span class="c">! na</span>
<a name="ln-4942"></a>
<a name="ln-4943"></a>
<a name="ln-4944"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4945"></a>          <span class="c">! na</span>
<a name="ln-4946"></a>
<a name="ln-4947"></a>
<a name="ln-4948"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4949"></a>          <span class="c">! na</span>
<a name="ln-4950"></a>
<a name="ln-4951"></a>  <span class="c">! Obtains and allocates TESCoil related parameters from input file</span>
<a name="ln-4952"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetTESInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! First time subroutine has been called, get input data</span>
<a name="ln-4953"></a>    <span class="k">CALL </span><span class="n">GetTESCoilInput</span>
<a name="ln-4954"></a>    <span class="n">GetTESInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set logic flag to disallow getting the input data on future calls to this subroutine</span>
<a name="ln-4955"></a>  <span class="k">End If</span>
<a name="ln-4956"></a>
<a name="ln-4957"></a><span class="k">  IF</span><span class="p">(</span><span class="n">NumTESCoils</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4958"></a><span class="k">    </span><span class="n">CoilIndex</span> <span class="o">=</span> <span class="n">FindItem</span><span class="p">(</span><span class="n">CoilName</span><span class="p">,</span><span class="n">TESCoil</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumTESCoils</span><span class="p">)</span>
<a name="ln-4959"></a>  <span class="k">ELSE</span>
<a name="ln-4960"></a><span class="k">    </span><span class="n">CoilIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4961"></a>  <span class="k">END IF</span>
<a name="ln-4962"></a>
<a name="ln-4963"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">CoilIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4964"></a><span class="k">    IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4965"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, GetTESCoilIndex: TES Cooling Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">))</span>
<a name="ln-4966"></a>    <span class="k">ELSE</span>
<a name="ln-4967"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;GetTESCoilIndex: TES Cooling Coil not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CoilName</span><span class="p">))</span>
<a name="ln-4968"></a>    <span class="n">ENDIF</span>
<a name="ln-4969"></a>    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4970"></a>  <span class="n">ENDIF</span>
<a name="ln-4971"></a>
<a name="ln-4972"></a>
<a name="ln-4973"></a>  <span class="k">RETURN</span>
<a name="ln-4974"></a>
<a name="ln-4975"></a>
<a name="ln-4976"></a><span class="k">END SUBROUTINE </span><span class="n">GetTESCoilIndex</span>
<a name="ln-4977"></a>
<a name="ln-4978"></a><span class="c">!     NOTICE</span>
<a name="ln-4979"></a><span class="c">!</span>
<a name="ln-4980"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-4981"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-4982"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-4983"></a><span class="c">!</span>
<a name="ln-4984"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-4985"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-4986"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-4987"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-4988"></a><span class="c">!</span>
<a name="ln-4989"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-4990"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-4991"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-4992"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-4993"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-4994"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-4995"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-4996"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-4997"></a><span class="c">!     permit others to do so.</span>
<a name="ln-4998"></a><span class="c">!</span>
<a name="ln-4999"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-5000"></a><span class="c">!</span>
<a name="ln-5001"></a>
<a name="ln-5002"></a>
<a name="ln-5003"></a><span class="k">END MODULE </span><span class="n">PackagedThermalStorageCoil</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
