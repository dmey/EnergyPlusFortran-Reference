<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>ConductionTransferFunctionCalc.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>ConductionTransferFunctionCalc.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.3% of total for source files.">1077 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/ConductionTransferFunctionCalc.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">ConductionTransferFunctionCalc.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/conductiontransferfunctioncalc.html">ConductionTransferFunctionCalc</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html#src">ConductionTransferFunctionCalc.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileconductiontransferfunctioncalcf90EfferentGraph" width="641pt" height="384pt"
 viewBox="0.00 0.00 641.00 383.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph" class="graph" transform="scale(.485 .485) rotate(0) translate(4 787.6142)">
<title>sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-787.6142 1317.6001,-787.6142 1317.6001,4 -4,4"/>
<!-- sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~conductiontransferfunctioncalc.f90</title>
<polygon fill="none" stroke="#000000" points="1313.4104,-509.7326 1131.1699,-509.7326 1131.1699,-487.7217 1313.4104,-487.7217 1313.4104,-509.7326"/>
<text text-anchor="middle" x="1222.2902" y="-495.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">ConductionTransferFunctionCalc.f90</text>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="778.8684,-528.7326 712.1309,-528.7326 712.1309,-506.7217 778.8684,-506.7217 778.8684,-528.7326"/>
<text text-anchor="middle" x="745.4996" y="-514.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M778.8961,-527.6993C833.3036,-542.7233 944.5044,-568.3376 1039.0719,-557.7272"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1094.8887,-509.7326 983.2551,-509.7326 983.2551,-487.7217 1094.8887,-487.7217 1094.8887,-509.7326"/>
<text text-anchor="middle" x="1039.0719" y="-495.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M778.9586,-509.0223C796.0507,-505.016 817.256,-500.7168 836.5261,-498.7272 881.896,-494.0426 933.2879,-494.1051 972.952,-495.3069"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="972.9203,-498.8077 983.0318,-495.6443 973.1545,-491.8116 972.9203,-498.8077"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="946.9829,-529.7326 836.7068,-529.7326 836.7068,-507.7217 946.9829,-507.7217 946.9829,-529.7326"/>
<text text-anchor="middle" x="891.8448" y="-515.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M779.0742,-517.9566C793.1905,-518.053 810.1206,-518.1687 826.5188,-518.2808"/>
<polygon fill="#00ff00" stroke="#00ff00" points="826.6067,-521.7814 836.6304,-518.3499 826.6546,-514.7815 826.6067,-521.7814"/>
</g>
<!-- sourcefile~dataconversions.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataconversions.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataconversions.f90.html" xlink:title="DataConversions.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="800.5526,-56.7326 690.4466,-56.7326 690.4466,-34.7217 800.5526,-34.7217 800.5526,-56.7326"/>
<text text-anchor="middle" x="745.4996" y="-42.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataConversions.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataconversions.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~dataconversions.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M800.8038,-44.0026C828.2167,-43.5866 861.8034,-43.7345 891.8448,-45.7272"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-290.7326 -.2403,-290.7326 -.2403,-268.7217 130.719,-268.7217 130.719,-290.7326"/>
<text text-anchor="middle" x="65.2394" y="-276.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M66.9287,-268.6596C73.0121,-232.8164 97.2326,-119.0424 166.4788,-63.7272 312.1952,52.6741 400.6231,-22.8809 585.7192,-45.7272"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M891.8448,-45.7272C1107.4853,-60.0306 1197.6266,-390.2034 1217.7643,-477.6407"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1214.3678,-478.4904 1219.9684,-487.4839 1221.1987,-476.9608 1214.3678,-478.4904"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-45.7272C632.8579,-50.6812 643.2856,-30.1914 690.4731,-25.7272 780.0122,-17.2561 806.3342,-17.8536 891.8448,-45.7272"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-710.7272C266.5231,-734.967 271.7356,-670.2242 317.2024,-651.7272 430.2086,-605.7533 467.7702,-625.9045 585.7192,-594.7272"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataconversions.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataconversions.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-45.7272C616.6262,-49.542 651.1531,-50.011 680.1813,-49.335"/>
<polygon fill="#ffff00" stroke="#ffff00" points="680.3075,-52.8329 690.2046,-49.0518 680.1097,-45.8357 680.3075,-52.8329"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-428.7326 180.0456,-428.7326 180.0456,-406.7217 267.6355,-406.7217 267.6355,-428.7326"/>
<text text-anchor="middle" x="223.8406" y="-414.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M76.8165,-290.9123C95.3508,-308.6923 133.0076,-344.2989 166.4788,-372.7272 177.5928,-382.1667 190.3203,-392.2234 200.9584,-400.4302"/>
<polygon fill="#00ffff" stroke="#00ffff" points="198.9043,-403.2656 208.9713,-406.5682 203.1611,-397.7086 198.9043,-403.2656"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-760.7326 350.2841,-760.7326 350.2841,-738.7217 447.8836,-738.7217 447.8836,-760.7326"/>
<text text-anchor="middle" x="399.0839" y="-746.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-710.7272C259.325,-730.9655 304.4084,-740.7034 339.9613,-745.388"/>
<polygon fill="#0000ff" stroke="#0000ff" points="339.8434,-748.8994 350.1929,-746.6328 340.6888,-741.9506 339.8434,-748.8994"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-45.7272C617.841,-49.6919 624.033,-58.7307 654.4731,-69.7272 695.0904,-84.4 703.5214,-113.87 745.4996,-103.7272"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M745.4996,-103.7272C929.88,-59.1769 1015.2489,-388.9538 1034.6703,-477.3239"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1031.2878,-478.2435 1036.803,-487.2896 1038.1328,-476.7786 1031.2878,-478.2435"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.7769,-682.7326 341.3908,-682.7326 341.3908,-660.7217 456.7769,-660.7217 456.7769,-682.7326"/>
<text text-anchor="middle" x="399.0839" y="-668.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-710.7272C234.9623,-717.0703 304.0014,-699.2042 352.0281,-685.5928"/>
<polygon fill="#ff0000" stroke="#ff0000" points="353.2759,-688.8764 361.9291,-682.7631 351.3523,-682.1459 353.2759,-688.8764"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-133.7326 539.0902,-133.7326 539.0902,-111.7217 632.3482,-111.7217 632.3482,-133.7326"/>
<text text-anchor="middle" x="585.7192" y="-119.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-200.7272C270.9385,-186.9013 270.5645,-157.0331 317.2024,-141.7272 387.2843,-118.7272 473.0141,-116.8652 528.4598,-118.8195"/>
<polygon fill="#ffff00" stroke="#ffff00" points="528.6563,-122.3303 538.7904,-119.2402 528.9412,-115.3361 528.6563,-122.3303"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-566.7326 344.7839,-566.7326 344.7839,-544.7217 453.3838,-544.7217 453.3838,-566.7326"/>
<text text-anchor="middle" x="399.0839" y="-552.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-710.7272C285.631,-745.969 259.3972,-622.1832 317.2024,-580.7272 322.7207,-576.7696 328.8773,-573.4284 335.2685,-570.6096"/>
<polygon fill="#00ff00" stroke="#00ff00" points="336.7516,-573.7866 344.7535,-566.8425 334.1677,-567.2809 336.7516,-573.7866"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M67.3503,-290.7556C79.6408,-353.601 144.1928,-665.3005 223.8406,-710.7272"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-644.7326 517.2105,-644.7326 517.2105,-622.7217 654.2279,-622.7217 654.2279,-644.7326"/>
<text text-anchor="middle" x="585.7192" y="-630.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-710.7272C273.6095,-739.1126 428.3703,-714.4525 480.9653,-691.7272 500.89,-683.118 498.4087,-669.986 516.9653,-658.7272 523.3109,-654.8771 530.342,-651.4821 537.4151,-648.535"/>
<polygon fill="#00ffff" stroke="#00ffff" points="538.9771,-651.6829 547.0258,-644.7931 536.4373,-645.1598 538.9771,-651.6829"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-447.7326 536.1602,-447.7326 536.1602,-425.7217 635.2783,-425.7217 635.2783,-447.7326"/>
<text text-anchor="middle" x="585.7192" y="-433.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-200.7272C278.8757,-184.7959 433.5943,-187.4989 480.9653,-219.7272 516.0889,-243.623 561.4145,-366.1841 578.6476,-415.8181"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="575.4137,-417.1773 581.9722,-425.4981 582.0341,-414.9035 575.4137,-417.1773"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-94.7326 168.8556,-94.7326 168.8556,-72.7217 278.8255,-72.7217 278.8255,-94.7326"/>
<text text-anchor="middle" x="223.8406" y="-80.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M74.2209,-268.6278C100.1603,-236.5717 175.4232,-143.5615 208.2376,-103.0094"/>
<polygon fill="#ff0000" stroke="#ff0000" points="210.9929,-105.1684 214.5625,-95.193 205.5513,-100.7651 210.9929,-105.1684"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-94.7326 340.6161,-94.7326 340.6161,-72.7217 457.5516,-72.7217 457.5516,-94.7326"/>
<text text-anchor="middle" x="399.0839" y="-80.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M82.4705,-268.5668C110.7253,-250.8749 169.2356,-216.7568 223.8406,-200.7272"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-200.7272C279.7371,-184.3184 267.1525,-138.5377 317.2024,-108.7272 324.1021,-104.6176 331.7368,-101.1291 339.4889,-98.1825"/>
<polygon fill="#00ffff" stroke="#00ffff" points="340.6886,-101.4708 348.9615,-94.8519 338.3667,-94.8671 340.6886,-101.4708"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-369.7326 358.7923,-369.7326 358.7923,-347.7217 439.3754,-347.7217 439.3754,-369.7326"/>
<text text-anchor="middle" x="399.0839" y="-355.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M88.4478,-290.8598C108.6393,-300.1213 138.908,-312.9968 166.4788,-320.7272 227.9605,-337.9656 300.9177,-348.3079 348.5151,-353.7559"/>
<polygon fill="#00ffff" stroke="#00ffff" points="348.242,-357.2471 358.5683,-354.8769 349.0178,-350.2902 348.242,-357.2471"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-291.7326 334.3841,-291.7326 334.3841,-269.7217 463.7837,-269.7217 463.7837,-291.7326"/>
<text text-anchor="middle" x="399.0839" y="-277.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-200.7272C270.9385,-186.9013 272.1329,-240.282 317.2024,-259.7272 323.2682,-262.3442 329.7326,-264.6903 336.2678,-266.7796"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="335.271,-270.1347 345.8552,-269.6589 337.2845,-263.4305 335.271,-270.1347"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-250.7326 323.0941,-250.7326 323.0941,-228.7217 475.0737,-228.7217 475.0737,-250.7326"/>
<text text-anchor="middle" x="399.0839" y="-236.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-200.7272C235.8464,-197.2028 301.7407,-213.4444 349.1958,-226.042"/>
<polygon fill="#ff0000" stroke="#ff0000" points="348.4516,-229.4659 359.0163,-228.6665 350.259,-222.7032 348.4516,-229.4659"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-710.7272C266.0908,-735.7129 270.053,-756.0777 317.2024,-769.7272 387.1153,-789.9665 409.9856,-785.8304 480.9653,-769.7272 635.6701,-734.6291 672.7616,-704.7574 800.5261,-610.7272 830.1833,-588.9005 859.2352,-557.3909 876.3398,-537.4931"/>
<polygon fill="#00ff00" stroke="#00ff00" points="879.1149,-539.6319 882.9058,-529.7384 873.7727,-535.1085 879.1149,-539.6319"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-172.7326 317.3208,-172.7326 317.3208,-150.7217 480.847,-150.7217 480.847,-172.7326"/>
<text text-anchor="middle" x="399.0839" y="-158.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-200.7272C258.5321,-190.5432 297.7658,-181.5809 330.3024,-174.8241"/>
<polygon fill="#0000ff" stroke="#0000ff" points="331.08,-178.2376 340.1725,-172.7991 329.6731,-171.3804 331.08,-178.2376"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1039.0719,-557.7272C1094.5765,-554.5963 1155.3146,-530.6192 1191.0452,-514.2116"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1192.867,-517.223 1200.4347,-509.8081 1189.8948,-510.8853 1192.867,-517.223"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-397.7272C517.4124,-361.1725 834.1783,-448.0101 947.1636,-498.7272 991.4472,-518.6053 990.6085,-560.4608 1039.0719,-557.7272"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-516.7272C624.9075,-514.466 669.5912,-515.0101 701.7219,-515.9491"/>
<polygon fill="#ff0000" stroke="#ff0000" points="702.0049,-519.4597 712.1111,-516.2792 702.2273,-512.4633 702.0049,-519.4597"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-397.7272C434.7781,-386.7003 449.6446,-399.0909 480.9653,-378.7272 545.8197,-336.5609 515.1979,-271.5205 585.7192,-239.7272"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.044,-428.9343C229.6072,-465.822 249.1943,-584.6294 317.2024,-646.7272 321.562,-650.7078 326.5398,-654.0551 331.8391,-656.8697"/>
<polygon fill="#ff0000" stroke="#ff0000" points="330.464,-660.09 341.0085,-661.1213 333.4086,-653.7394 330.464,-660.09"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M267.6087,-417.2092C303.6272,-415.7293 355.6366,-411.1491 399.0839,-397.7272"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-397.7272C434.7781,-386.7003 454.5081,-405.103 480.9653,-378.7272 530.4378,-329.407 489.13,-289.7989 516.9653,-225.7272 530.6964,-194.1208 554.185,-161.7159 569.8301,-141.902"/>
<polygon fill="#ffff00" stroke="#ffff00" points="572.6644,-143.9626 576.2034,-133.9763 567.2093,-139.576 572.6644,-143.9626"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M229.9844,-428.8779C243.0259,-451.5138 275.71,-503.0476 317.2024,-530.7272 323.2379,-534.7534 329.9486,-538.1532 336.8578,-541.019"/>
<polygon fill="#00ff00" stroke="#00ff00" points="335.7657,-544.3478 346.3575,-544.6046 338.2377,-537.7988 335.7657,-544.3478"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M227.042,-429.0601C235.9554,-458.4194 263.9718,-537.329 317.2024,-575.7272 372.3913,-615.5379 449.474,-628.9886 506.9011,-633.0961"/>
<polygon fill="#00ffff" stroke="#00ffff" points="506.8219,-636.598 517.0236,-633.7385 507.2654,-629.612 506.8219,-636.598"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-397.7272C425.3078,-389.6259 495.873,-408.3856 542.3285,-422.6056"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="541.5501,-426.0286 552.1381,-425.65 543.625,-419.3432 541.5501,-426.0286"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M232.0456,-406.7177C244.578,-389.3589 268.3805,-354.1555 281.2024,-320.7272 310.2635,-244.9608 272.9701,-209.7609 317.2024,-141.7272 328.8997,-123.7355 348.2995,-109.6289 365.2804,-99.8344"/>
<polygon fill="#00ffff" stroke="#00ffff" points="367.3114,-102.7126 374.401,-94.8393 363.949,-96.573 367.3114,-102.7126"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-488.7326 334.8633,-488.7326 334.8633,-466.7217 463.3044,-466.7217 463.3044,-488.7326"/>
<text text-anchor="middle" x="399.0839" y="-474.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M247.6553,-428.8002C266.3074,-437.1965 293.0519,-448.6333 317.2024,-456.7272 324.9187,-459.3132 333.134,-461.7642 341.2702,-464.0174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="340.5507,-467.4482 351.1164,-466.6635 342.3675,-460.688 340.5507,-467.4482"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-447.7326 354.6193,-447.7326 354.6193,-425.7217 443.5485,-425.7217 443.5485,-447.7326"/>
<text text-anchor="middle" x="399.0839" y="-433.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M267.6098,-422.4726C290.9546,-425.0037 319.8949,-428.1414 344.6753,-430.8281"/>
<polygon fill="#7fff00" stroke="#7fff00" points="344.3365,-434.3118 354.6555,-431.9102 345.0911,-427.3526 344.3365,-434.3118"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M253.1349,-406.6077C271.4611,-399.7639 295.6083,-390.9501 317.2024,-383.7272 328.3226,-380.0076 340.3651,-376.2064 351.7053,-372.727"/>
<polygon fill="#00ffff" stroke="#00ffff" points="352.9012,-376.0217 361.4494,-369.7624 350.8636,-369.3248 352.9012,-376.0217"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M230.4864,-406.4874C251.6834,-370.646 316.3536,-261.3627 317.2024,-260.7272 319.9888,-258.6409 322.9618,-256.761 326.0628,-255.067"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.5677,-258.227 335.0927,-250.7688 324.5591,-251.9066 327.5677,-258.227"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M232.7264,-429.0183C247.8319,-447.2499 280.4748,-482.649 317.2024,-497.7272 427.8779,-543.1637 466.2787,-523.6188 585.7192,-516.7272"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-516.7272C632.9898,-514.6344 643.3465,-501.9664 690.4731,-497.7272 739.1889,-493.3449 751.9257,-492.211 800.5261,-497.7272 814.3084,-499.2915 829.0403,-502.1433 842.5601,-505.2516"/>
<polygon fill="#00ff00" stroke="#00ff00" points="842.0868,-508.7371 852.6269,-507.6614 843.7164,-501.9294 842.0868,-508.7371"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M231.4674,-406.4717C243.2261,-388.7838 266.0102,-353.1471 281.2024,-320.7272 301.4238,-277.575 288.4212,-257.7094 317.2024,-219.7272 330.4294,-202.2716 350.4123,-187.9728 367.3258,-177.9399"/>
<polygon fill="#0000ff" stroke="#0000ff" points="369.381,-180.7975 376.3439,-172.812 365.9209,-174.7125 369.381,-180.7975"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-672.7272C597.5811,-667.4274 1026.1485,-559.0599 1039.0719,-557.7272"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-672.7272C614.6642,-659.7948 629.9336,-673.7987 654.4731,-653.7272 681.8593,-631.3274 670.9103,-612.2068 690.4731,-582.7272 701.4715,-566.1534 716.1067,-549.0485 727.5188,-536.5477"/>
<polygon fill="#ff0000" stroke="#ff0000" points="730.2419,-538.7589 734.4823,-529.0496 725.1126,-533.9954 730.2419,-538.7589"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M439.938,-738.6923C453.1862,-734.7337 467.8448,-729.9456 480.9653,-724.7272 529.2634,-705.5176 538.2627,-693.9304 585.7192,-672.7272"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M745.4996,-596.7272C833.0362,-564.5543 859.4058,-570.2917 947.1636,-538.7272 967.3355,-531.4718 989.3757,-521.9368 1006.8153,-513.9961"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1008.3691,-517.134 1015.9895,-509.7733 1005.4421,-510.7752 1008.3691,-517.134"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M448.0511,-741.4513C459.7221,-737.76 471.5182,-732.4277 480.9653,-724.7272 506.8646,-703.6162 491.6282,-680.5096 516.9653,-658.7272 521.2392,-655.0529 526.0972,-651.9013 531.2084,-649.2015"/>
<polygon fill="#00ffff" stroke="#00ffff" points="533.0284,-652.2146 540.6107,-644.8146 530.0686,-645.8711 533.0284,-652.2146"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M423.8273,-738.6542C442.513,-728.9777 467.2113,-713.1214 480.9653,-691.7272 527.2071,-619.7987 476.1928,-577.891 516.9653,-502.7272 527.616,-483.0927 546.1534,-465.8124 561.2977,-453.8636"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="563.444,-456.6285 569.2904,-447.7927 559.21,-451.0541 563.444,-456.6285"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-672.7272C614.6642,-659.7948 626.7398,-669.0868 654.4731,-653.7272 673.4607,-643.2112 672.2775,-632.5605 690.4731,-620.7272 712.8403,-606.1809 720.4564,-605.9314 745.4996,-596.7272"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M745.4996,-596.7272C789.879,-580.4162 837.5449,-552.9328 866.017,-535.3239"/>
<polygon fill="#00ff00" stroke="#00ff00" points="867.9369,-538.2514 874.5583,-529.9804 864.2243,-532.317 867.9369,-538.2514"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~conductiontransferfunctioncalc.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.039,-498.7272C1103.2968,-498.7272 1112.0123,-498.7272 1120.8513,-498.7272"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1120.8656,-502.2273 1130.8655,-498.7272 1120.8655,-495.2273 1120.8656,-502.2273"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.5992,-660.7071C441.5748,-648.0705 481.1498,-627.3487 516.9653,-613.7272 546.5972,-602.4574 555.0693,-602.8288 585.7192,-594.7272"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M590.3288,-134.1227C612.5187,-188.9792 708.4432,-426.1184 737.2738,-497.3918"/>
<polygon fill="#ff0000" stroke="#ff0000" points="734.0294,-498.7048 741.0239,-506.6626 740.5186,-496.0798 734.0294,-498.7048"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M632.382,-120.1091C664.5247,-117.595 708.0275,-112.7812 745.4996,-103.7272"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-594.7272C635.631,-581.534 688.698,-552.5959 719.3801,-534.1944"/>
<polygon fill="#ff0000" stroke="#ff0000" points="721.4345,-537.0413 728.1552,-528.8509 717.7938,-531.0625 721.4345,-537.0413"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M433.7308,-566.8344C479.4618,-580.8253 557.4768,-602.1924 585.7192,-594.7272"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M416.6421,-544.5319C449.6572,-523.4812 521.1288,-477.9105 559.7303,-453.2979"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="561.7935,-456.1334 568.3437,-447.8059 558.0301,-450.231 561.7935,-456.1334"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M625.2951,-622.6642C635.2275,-619.0078 645.5809,-614.3893 654.4731,-608.7272 685.4799,-588.9837 714.2235,-557.0392 730.8097,-536.726"/>
<polygon fill="#ff0000" stroke="#ff0000" points="733.634,-538.7983 737.1448,-528.802 728.1665,-534.4271 733.634,-538.7983"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-311.7326 166.6166,-311.7326 166.6166,-289.7217 281.0645,-289.7217 281.0645,-311.7326"/>
<text text-anchor="middle" x="223.8406" y="-297.5772" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.107,-304.0942C315.5586,-306.8221 360.1407,-311.5946 399.0839,-319.7272"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-319.7272C517.9376,-344.5475 556.356,-345.206 654.4731,-416.7272 686.4951,-440.0691 715.6622,-476.2286 731.949,-498.3584"/>
<polygon fill="#ff0000" stroke="#ff0000" points="729.2318,-500.5743 737.9211,-506.6362 734.9086,-496.4787 729.2318,-500.5743"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-319.7272C435.6536,-327.3641 448.0035,-321.1434 480.9653,-338.7272 518.3746,-358.6834 552.3569,-395.4394 570.9251,-417.824"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="568.2434,-420.0739 577.2618,-425.6345 573.6794,-415.6637 568.2434,-420.0739"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M281.2218,-294.1784C294.877,-292.62 309.649,-290.9341 323.9664,-289.3001"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="324.7501,-292.7334 334.2888,-288.122 323.9563,-285.7786 324.7501,-292.7334"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M607.601,-447.82C635.2527,-461.8379 683.0204,-486.0536 714.4405,-501.9819"/>
<polygon fill="#ff0000" stroke="#ff0000" points="713.1244,-505.2387 723.6264,-506.6386 716.2896,-498.9951 713.1244,-505.2387"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M589.9011,-425.583C611.4219,-368.617 710.0497,-112.2926 745.4996,-103.7272"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M399.0839,-44.7272C483.7485,-48.3177 501.5316,-74.0612 585.7192,-83.7272"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-83.7272C656.8198,-91.8905 675.9338,-120.5357 745.4996,-103.7272"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M251.9606,-72.7203C286.237,-60.4169 346.145,-42.4821 399.0839,-44.7272"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M399.0839,-44.7272C436.409,-46.3101 448.0452,-46.0654 480.9653,-63.7272 500.3585,-74.1316 498.2353,-86.1716 516.9653,-97.7272 523.2077,-101.5784 530.1326,-104.9644 537.1143,-107.8989"/>
<polygon fill="#ffff00" stroke="#ffff00" points="536.0236,-111.2306 546.6112,-111.622 538.5786,-104.7135 536.0236,-111.2306"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M278.8078,-83.7272C295.1003,-83.7272 313.1505,-83.7272 330.2066,-83.7272"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.6733,-87.2272 340.6733,-83.7272 330.6733,-80.2272 330.6733,-87.2272"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M457.7029,-80.308C494.5691,-79.0022 543.0668,-78.83 585.7192,-83.7272"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M452.0668,-94.7987C476.1254,-99.826 504.613,-105.7789 529.0936,-110.8944"/>
<polygon fill="#ffff00" stroke="#ffff00" points="528.4574,-114.337 538.9619,-112.9566 529.8893,-107.485 528.4574,-114.337"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M449.5901,-466.632C473.2157,-461.4419 501.5155,-455.225 526.1772,-449.8073"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="527.1257,-453.1825 536.1418,-447.6183 525.6237,-446.3455 527.1257,-453.1825"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M443.7877,-436.7272C468.4588,-436.7272 499.4194,-436.7272 526.1233,-436.7272"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="526.1275,-440.2273 536.1275,-436.7272 526.1274,-433.2273 526.1275,-440.2273"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M439.5438,-369.5781C452.9027,-373.5567 467.7269,-378.4033 480.9653,-383.7272 507.5307,-394.4105 536.4858,-409.3292 557.2078,-420.6176"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="555.6632,-423.7626 566.1112,-425.5204 559.0398,-417.6308 555.6632,-423.7626"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M451.8841,-291.74C462.047,-295.2387 472.2336,-299.8008 480.9653,-305.7272 524.2605,-335.1124 558.3866,-387.7861 574.8851,-416.5785"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="571.8585,-418.3373 579.7922,-425.3592 577.969,-414.9224 571.8585,-418.3373"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M450.5707,-250.7387C489.4477,-256.5067 543.1833,-258.9037 585.7192,-239.7272"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M947.0856,-511.223C955.5307,-510.0758 964.3203,-508.8818 972.9701,-507.7067"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="973.5932,-511.1543 983.0311,-506.34 972.6509,-504.218 973.5932,-511.1543"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M440.3806,-172.8279C453.5197,-176.7588 468.0027,-181.5142 480.9653,-186.7272 529.3745,-206.1951 538.1527,-261.1717 585.7192,-239.7272"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-239.7272C670.7337,-201.3998 654.8534,-125.6292 745.4996,-103.7272"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileconductiontransferfunctioncalcf90EfferentGraph = svgPanZoom('#sourcefileconductiontransferfunctioncalcf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileconductiontransferfunctioncalcf90AfferentGraph" width="641pt" height="42pt"
 viewBox="0.00 0.00 641.00 42.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph" class="graph" transform="scale(.5888 .5888) rotate(0) translate(4 67.5)">
<title>sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-67.5 1084.6042,-67.5 1084.6042,4 -4,4"/>
<!-- sourcefile~conductiontransferfunctioncalc.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~conductiontransferfunctioncalc.f90</title>
<polygon fill="none" stroke="#000000" points="182.4302,-42.2554 .1897,-42.2554 .1897,-20.2446 182.4302,-20.2446 182.4302,-42.2554"/>
<text text-anchor="middle" x="91.3099" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">ConductionTransferFunctionCalc.f90</text>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="657.3537,-62.2554 527.3431,-62.2554 527.3431,-40.2446 657.3537,-40.2446 657.3537,-62.2554"/>
<text text-anchor="middle" x="592.3484" y="-48.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~conductiontransferfunctioncalc.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~conductiontransferfunctioncalc.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M182.6255,-34.8951C278.5655,-38.7247 427.6959,-44.6775 517.1111,-48.2467"/>
<polygon fill="#ff0000" stroke="#ff0000" points="517.0449,-51.7468 527.1766,-48.6485 517.3242,-44.7524 517.0449,-51.7468"/>
</g>
<!-- sourcefile~ecoroof.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~ecoroof.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/ecoroof.f90.html" xlink:title="EcoRoof.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="288.299,-23.2554 218.7266,-23.2554 218.7266,-1.2446 288.299,-1.2446 288.299,-23.2554"/>
<text text-anchor="middle" x="253.5128" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EcoRoof.f90</text>
</a>
</g>
</g>
<!-- sourcefile~conductiontransferfunctioncalc.f90&#45;&gt;sourcefile~ecoroof.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~conductiontransferfunctioncalc.f90&#45;&gt;sourcefile~ecoroof.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M182.8401,-20.5284C191.634,-19.4983 200.2614,-18.4877 208.2997,-17.5461"/>
<polygon fill="#ff0000" stroke="#ff0000" points="208.9671,-20.992 218.492,-16.3522 208.1526,-14.0395 208.9671,-20.992"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="792.5687,-62.2554 693.6112,-62.2554 693.6112,-40.2446 792.5687,-40.2446 792.5687,-62.2554"/>
<text text-anchor="middle" x="743.09" y="-48.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M657.5891,-51.25C666.0745,-51.25 674.7343,-51.25 683.1278,-51.25"/>
<polygon fill="#ff0000" stroke="#ff0000" points="683.2043,-54.7501 693.2043,-51.25 683.2043,-47.7501 683.2043,-54.7501"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="948.1868,-42.2554 828.3764,-42.2554 828.3764,-20.2446 948.1868,-20.2446 948.1868,-42.2554"/>
<text text-anchor="middle" x="888.2816" y="-28.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M618.5032,-40.1662C648.1559,-28.6251 698.2167,-12.2169 743.09,-12.25"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="490.9417,-23.2554 324.5603,-23.2554 324.5603,-1.2446 490.9417,-1.2446 490.9417,-23.2554"/>
<text text-anchor="middle" x="407.751" y="-9.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~ecoroof.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~ecoroof.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M288.5118,-12.25C296.475,-12.25 305.3024,-12.25 314.4478,-12.25"/>
<polygon fill="#00ffff" stroke="#00ffff" points="314.4705,-15.7501 324.4704,-12.25 314.4704,-8.7501 314.4705,-15.7501"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M792.6506,-44.4231C800.917,-43.2844 809.6279,-42.0845 818.2893,-40.8914"/>
<polygon fill="#ff0000" stroke="#ff0000" points="818.9759,-44.3299 828.4047,-39.498 818.0207,-37.3954 818.9759,-44.3299"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1074.0026,-63.2554 990.5856,-63.2554 990.5856,-41.2446 1074.0026,-41.2446 1074.0026,-63.2554"/>
<text text-anchor="middle" x="1032.2941" y="-49.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M948.1047,-39.9735C958.7694,-41.5286 969.8012,-43.1372 980.2275,-44.6576"/>
<polygon fill="#00ffff" stroke="#00ffff" points="980.0156,-48.1637 990.416,-46.1433 981.0257,-41.2369 980.0156,-48.1637"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1080.4152,-22.2554 984.173,-22.2554 984.173,-.2446 1080.4152,-.2446 1080.4152,-22.2554"/>
<text text-anchor="middle" x="1032.2941" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M948.1047,-22.942C956.5657,-21.7669 965.2577,-20.5598 973.6952,-19.388"/>
<polygon fill="#00ffff" stroke="#00ffff" points="974.4047,-22.8232 983.8281,-17.9808 973.4417,-15.8897 974.4047,-22.8232"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M460.1554,-23.3215C481.9755,-27.9315 507.4792,-33.3196 530.2328,-38.1268"/>
<polygon fill="#ff0000" stroke="#ff0000" points="529.6251,-41.5756 540.1326,-40.2183 531.0721,-34.7268 529.6251,-41.5756"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~conductiontransferfunctioncalc.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M491.1259,-12.2158C558.9759,-12.1963 657.2176,-12.1866 743.09,-12.25"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M743.09,-12.25C768.4482,-12.2687 796.0887,-15.1575 820.3829,-18.677"/>
<polygon fill="#ff0000" stroke="#ff0000" points="820.1625,-22.1833 830.5734,-20.2174 821.2088,-15.262 820.1625,-22.1833"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefileconductiontransferfunctioncalcf90AfferentGraph = svgPanZoom('#sourcefileconductiontransferfunctioncalcf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/conductiontransferfunctioncalc.html">ConductionTransferFunctionCalc</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html#src">ConductionTransferFunctionCalc.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">ConductionTransferFunctionCalc</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   January 1997</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       June-July 2000, RKS</span>
<a name="ln-7"></a>          <span class="c">!       RE-ENGINEERED  June 1996, February 1997, August 1997, RKS</span>
<a name="ln-8"></a>          <span class="c">!       RE-ENGINEERED  November 1999, LKL</span>
<a name="ln-9"></a>
<a name="ln-10"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-11"></a>          <span class="c">! This module calculates the conduction transfer functions (CTFs) for</span>
<a name="ln-12"></a>          <span class="c">! all building constructions.</span>
<a name="ln-13"></a>
<a name="ln-14"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-15"></a>          <span class="c">! This subroutine uses the state space method of calculating CTFs.</span>
<a name="ln-16"></a>          <span class="c">! The state space method involves imposing a finite difference grid</span>
<a name="ln-17"></a>          <span class="c">! to a solution space (i.e., a building construction, inside to</span>
<a name="ln-18"></a>          <span class="c">! outside surface).  The finite difference grid is only used to</span>
<a name="ln-19"></a>          <span class="c">! derive a system of differential equations.  This first order</span>
<a name="ln-20"></a>          <span class="c">! system can then be solved using matrix algebra.  In this</span>
<a name="ln-21"></a>          <span class="c">! implementation of the state space method, a conversion from the</span>
<a name="ln-22"></a>          <span class="c">! internal units of EnergyPlus (SI) to English units is used, This</span>
<a name="ln-23"></a>          <span class="c">! is done due to observations made by Russ Taylor that the solution</span>
<a name="ln-24"></a>          <span class="c">! method was not as stable numerically when SI units were used.</span>
<a name="ln-25"></a>
<a name="ln-26"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-27"></a>          <span class="c">! While there are several important references on the state space</span>
<a name="ln-28"></a>          <span class="c">! method, the most definitive reference which includes details on</span>
<a name="ln-29"></a>          <span class="c">! implementing the state space method is:</span>
<a name="ln-30"></a>          <span class="c">! Seem, J.E.  1987.  Modeling of Heat Transfer in Buildings, Ph.D.</span>
<a name="ln-31"></a>          <span class="c">! Dissertation, Department of Mechanical Engineering, University of</span>
<a name="ln-32"></a>          <span class="c">! Wisconsin-Madison.</span>
<a name="ln-33"></a>
<a name="ln-34"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-35"></a>          <span class="c">! na</span>
<a name="ln-36"></a>
<a name="ln-37"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-38"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-39"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-40"></a><span class="k">USE </span><span class="n">DataHeatBalance</span> <span class="c">! This is the Heat balance super block data-only module</span>
<a name="ln-41"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-42"></a>
<a name="ln-43"></a>
<a name="ln-44"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-45"></a>
<a name="ln-46"></a><span class="k">PRIVATE</span>
<a name="ln-47"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-48"></a><span class="c">!INTEGER, PRIVATE, PARAMETER :: MaxTotNodes = 75   ! Maximum total number of</span>
<a name="ln-49"></a>          <span class="c">! nodes per construction.  This limit is a compromise between faster,</span>
<a name="ln-50"></a>          <span class="c">! less accurate solutions and slower, possibly more accurate answers.</span>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NumOfPerpendNodes</span> <span class="o">=</span> <span class="mi">7</span>     <span class="c">! Number of nodes in the direction</span>
<a name="ln-53"></a>          <span class="c">! perpendicular to the main direction of heat transfer.  This is only used</span>
<a name="ln-54"></a>          <span class="c">! when a two-dimensional solution has been requested for a construction</span>
<a name="ln-55"></a>          <span class="c">! with a heat source/sink.</span>
<a name="ln-56"></a>
<a name="ln-57"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-58"></a>          <span class="c">! na</span>
<a name="ln-59"></a>
<a name="ln-60"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-61"></a>          <span class="c">! na</span>
<a name="ln-62"></a>
<a name="ln-63"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-64"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">AExp</span>   <span class="c">! Exponential of AMat</span>
<a name="ln-65"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">AInv</span>   <span class="c">! Inverse of AMat</span>
<a name="ln-66"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">AMat</span>   <span class="c">! &quot;A&quot; matrix from Seem&#39;s dissertation</span>
<a name="ln-67"></a>                                                                        <span class="c">! (constant coefficients of linear system)</span>
<a name="ln-68"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">BMat</span>   <span class="c">! &quot;B&quot; matrix of state space method (non-zero elements)</span>
<a name="ln-69"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">CMat</span>   <span class="c">! &quot;C&quot; matrix of state space method (non-zero elements)</span>
<a name="ln-70"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">DMat</span>   <span class="c">! &quot;D&quot; matrix of state space method (non-zero elements)</span>
<a name="ln-71"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>          <span class="kd">::</span> <span class="n">e</span>      <span class="c">! Coefficients for the surface flux history term</span>
<a name="ln-72"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">Gamma1</span> <span class="c">! Intermediate calculation array corresponding to a term</span>
<a name="ln-73"></a>                                                                        <span class="c">! in Seem&#39;s dissertation</span>
<a name="ln-74"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">Gamma2</span> <span class="c">! Intermediate calculation array corresponding to a term</span>
<a name="ln-75"></a>                                                                        <span class="c">! in Seem&#39;s dissertation</span>
<a name="ln-76"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PRIVATE</span>                                     <span class="kd">::</span> <span class="n">NodeSource</span> <span class="c">! Node at which a source or sink is present</span>
<a name="ln-77"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PRIVATE</span>                                     <span class="kd">::</span> <span class="n">NodeUserTemp</span> <span class="c">! Node where user wishes to calculate a temperature</span>
<a name="ln-78"></a>                                                                              <span class="c">! (for constructions with sources/sinks only)</span>
<a name="ln-79"></a><span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PRIVATE</span>                                     <span class="kd">::</span> <span class="n">rcmax</span>  <span class="c">! Total number of nodes in the construct (&lt;= MaxTotNodes)</span>
<a name="ln-80"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:)</span>      <span class="kd">::</span> <span class="n">s</span>      <span class="c">! Coefficients for the surface temperature history terms</span>
<a name="ln-81"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">s0</span>     <span class="c">! Coefficients for the current surface temperature terms</span>
<a name="ln-82"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span>                                     <span class="kd">::</span> <span class="n">TinyLimit</span>
<a name="ln-83"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PRIVATE</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">IdenMatrix</span>  <span class="c">! Identity Matrix</span>
<a name="ln-84"></a>
<a name="ln-85"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE ConductionTransferFunctionCalc</span>
<a name="ln-86"></a>
<a name="ln-87"></a><span class="k">PUBLIC  </span><span class="n">InitConductionTransferFunctions</span>
<a name="ln-88"></a><span class="k">PRIVATE </span><span class="n">CalculateExponentialMatrix</span>
<a name="ln-89"></a><span class="k">PRIVATE </span><span class="n">CalculateInverseMatrix</span>
<a name="ln-90"></a><span class="k">PRIVATE </span><span class="n">CalculateGammas</span>
<a name="ln-91"></a><span class="k">PRIVATE </span><span class="n">CalculateCTFs</span>
<a name="ln-92"></a><span class="k">PRIVATE </span><span class="n">ReportCTFs</span>
<a name="ln-93"></a>
<a name="ln-94"></a><span class="k">CONTAINS</span>
<a name="ln-95"></a>
<a name="ln-96"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-97"></a>
<a name="ln-98"></a><span class="k">SUBROUTINE </span><span class="n">InitConductionTransferFunctions</span>
<a name="ln-99"></a>
<a name="ln-100"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-101"></a>          <span class="c">!       AUTHOR         Russ Taylor</span>
<a name="ln-102"></a>          <span class="c">!       DATE WRITTEN   June 1990</span>
<a name="ln-103"></a>          <span class="c">!       MODIFIED       July 1994, LKL, cosmetic and improve execution time</span>
<a name="ln-104"></a>          <span class="c">!                      Dec 1995, Apr 1996, RKS, cosmetic and clean-up changes, changes to allow proper</span>
<a name="ln-105"></a>          <span class="c">!                       handling of resistive layers</span>
<a name="ln-106"></a>          <span class="c">!                      June 2000, RKS, addition of QTFs (both 1- and 2-D solutions for constructions</span>
<a name="ln-107"></a>          <span class="c">!                       with embedded/internal heat sources/sinks)</span>
<a name="ln-108"></a>          <span class="c">!                      July 2010-August 2011, RKS, R-value only layer enhancement</span>
<a name="ln-109"></a>          <span class="c">!       RE-ENGINEERED  June 1996, February 1997, August-October 1997, RKS; Nov 1999, LKL</span>
<a name="ln-110"></a>
<a name="ln-111"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-112"></a>          <span class="c">! This subroutine serves as the main drive for the</span>
<a name="ln-113"></a>          <span class="c">! calculation of Conduction Transfer Functions (CTFs)</span>
<a name="ln-114"></a>          <span class="c">! using the state space method.</span>
<a name="ln-115"></a>
<a name="ln-116"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-117"></a>          <span class="c">! The basic steps of this routine (which may be a little difficult</span>
<a name="ln-118"></a>          <span class="c">! to decipher until another major revision is done) are:</span>
<a name="ln-119"></a>          <span class="c">!   1. Determine if enough material info has been entered</span>
<a name="ln-120"></a>          <span class="c">!   2. Determine whether construct is (a) all resistive,</span>
<a name="ln-121"></a>          <span class="c">!      (b) the reverse of a previously calculated construct, or</span>
<a name="ln-122"></a>          <span class="c">!      (c) neither (a) nor (b), i.e. a layer for which CTFs must</span>
<a name="ln-123"></a>          <span class="c">!      be calculated.</span>
<a name="ln-124"></a>          <span class="c">!   3. If the answer to 2 is (a), calculate the overall resistance</span>
<a name="ln-125"></a>          <span class="c">!      and use this as the CTF (steady state conduction).</span>
<a name="ln-126"></a>          <span class="c">!   4. If the answer to 2 is (b), transfer the CTFs for the reverse</span>
<a name="ln-127"></a>          <span class="c">!      construction to the CTF arrays for this construct (reversing</span>
<a name="ln-128"></a>          <span class="c">!      the inside and outside terms).</span>
<a name="ln-129"></a>          <span class="c">!   5. If the answer to 2 is (c), calculate the CTFs using the state</span>
<a name="ln-130"></a>          <span class="c">!      space method described below.</span>
<a name="ln-131"></a>          <span class="c">! The state space method of calculating CTFs involves</span>
<a name="ln-132"></a>          <span class="c">! applying a finite difference grid to a multilayered</span>
<a name="ln-133"></a>          <span class="c">! building element and performing linear algebra on the</span>
<a name="ln-134"></a>          <span class="c">! resulting system of equations (in matrix form).</span>
<a name="ln-135"></a>          <span class="c">! CTFs must be calculated for non-reversed layers which</span>
<a name="ln-136"></a>          <span class="c">! have an appreciable thermal mass.  A conversion from</span>
<a name="ln-137"></a>          <span class="c">! SI units to English units is made due to concerns</span>
<a name="ln-138"></a>          <span class="c">! about round off problems noted in earlier version of</span>
<a name="ln-139"></a>          <span class="c">! this subroutine.</span>
<a name="ln-140"></a>
<a name="ln-141"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-142"></a>          <span class="c">! Seem, J.E.  &quot;Modeling of Heat Transfer in Buildings&quot;,</span>
<a name="ln-143"></a>          <span class="c">!  Department of Mechanical Engineering, University of</span>
<a name="ln-144"></a>          <span class="c">!  Wisconsin-Madison, 1987.</span>
<a name="ln-145"></a>          <span class="c">! Strand, R.K. &quot;Testing Design Description for the CTF</span>
<a name="ln-146"></a>          <span class="c">!  Calculation Code in BEST&quot;, BSO internal document,</span>
<a name="ln-147"></a>          <span class="c">!  May/June 1996.</span>
<a name="ln-148"></a>          <span class="c">! Strand, R.K. &quot;Heat Source Transfer Functions and Their</span>
<a name="ln-149"></a>          <span class="c">!  Applicatoin to Low Temperature Radiant Heating System&quot;,</span>
<a name="ln-150"></a>          <span class="c">!  Ph.D. Dissertation, Department of Mechanical and</span>
<a name="ln-151"></a>          <span class="c">!  Industrial Engineering, University of Illinois at</span>
<a name="ln-152"></a>          <span class="c">!  Urbana-Champaign, 1995.</span>
<a name="ln-153"></a>
<a name="ln-154"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-155"></a>  <span class="k">USE </span><span class="n">DataConversions</span>
<a name="ln-156"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-157"></a>
<a name="ln-158"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-159"></a>
<a name="ln-160"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-161"></a>          <span class="c">! na</span>
<a name="ln-162"></a>
<a name="ln-163"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-164"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PhysPropLimit</span> <span class="o">=</span> <span class="mf">1.0d-6</span>  <span class="c">! Physical properties limit.</span>
<a name="ln-165"></a>          <span class="c">! This is more or less the traditional value from BLAST.</span>
<a name="ln-166"></a>
<a name="ln-167"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">RValueLowLimit</span> <span class="o">=</span> <span class="mf">1.0d-3</span>  <span class="c">! Physical properties limit for R-value only layers</span>
<a name="ln-168"></a>          <span class="c">! This value was based on trial and error related to CR 7791 where a</span>
<a name="ln-169"></a>          <span class="c">! user had entered a &quot;no insulation&quot; layer with an R-value of 1.0E-05.</span>
<a name="ln-170"></a>          <span class="c">! Some trial and error established this as a potential value though</span>
<a name="ln-171"></a>          <span class="c">! there is no guarantee that this is a good value.</span>
<a name="ln-172"></a>
<a name="ln-173"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MinNodes</span> <span class="o">=</span> <span class="mi">6</span> <span class="c">! Minimum number of state space nodes</span>
<a name="ln-174"></a>          <span class="c">! per layer.  This value was chosen based on experience with IBLAST.</span>
<a name="ln-175"></a>
<a name="ln-176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxAllowedCTFSumError</span> <span class="o">=</span> <span class="mf">0.01d0</span> <span class="c">! Allow a 1 percent</span>
<a name="ln-177"></a>          <span class="c">! difference between the CTF series summations.  If the difference is</span>
<a name="ln-178"></a>          <span class="c">! greater than this, then the coefficients will not yield a valid steady</span>
<a name="ln-179"></a>          <span class="c">! state solution.</span>
<a name="ln-180"></a>
<a name="ln-181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxAllowedTimeStep</span> <span class="o">=</span> <span class="mf">4.0d0</span>   <span class="c">! Sets the maximum allowed time step</span>
<a name="ln-182"></a>          <span class="c">! for CTF calculations to be 4 hours.  This is done in response to some</span>
<a name="ln-183"></a>          <span class="c">! rare situations where odd or faulty input will cause the routine to</span>
<a name="ln-184"></a>          <span class="c">! go off and get some huge time step (in excess of 20 hours).  This value</span>
<a name="ln-185"></a>          <span class="c">! is a compromise that does not really solve any input problems.  One run</span>
<a name="ln-186"></a>          <span class="c">! indicated that 2 meters of concrete will result in a time step of slightly</span>
<a name="ln-187"></a>          <span class="c">! more than 3 hours.  So, 4 hours was arbitrarily picked as a ceiling for</span>
<a name="ln-188"></a>          <span class="c">! time steps so that an error message can be produced to warn the user</span>
<a name="ln-189"></a>          <span class="c">! that something isn&#39;t right.  Note that the 4 hour limit does not guarantee</span>
<a name="ln-190"></a>          <span class="c">! that problems won&#39;t exist and it does not necessarily avoid any problems</span>
<a name="ln-191"></a>          <span class="c">! that interpolated temperature histories might cause.</span>
<a name="ln-192"></a>
<a name="ln-193"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-194"></a>          <span class="c">! na</span>
<a name="ln-195"></a>
<a name="ln-196"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-197"></a>          <span class="c">! na</span>
<a name="ln-198"></a>
<a name="ln-199"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-200"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-201"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AdjacentResLayerNum</span> <span class="c">! Layers that are adjacent to each other which are resistive</span>
<a name="ln-202"></a>                                                           <span class="c">! only can and should be combined</span>
<a name="ln-203"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">AdjLayer</span>   <span class="c">! Loop counter for adjacent resistance-only layers</span>
<a name="ln-204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">amatx</span>      <span class="c">! Intermediate calculation variable</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">amatxx</span>     <span class="c">! Intermediate calculation variable</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">amaty</span>      <span class="c">! Intermediate calculation variable</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">BiggestSum</span> <span class="c">! Largest CTF series summation (maximum of SumXi, SumYi, and SumZi)</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">cap</span>        <span class="c">! Thermal capacitance of a node (intermediate calculation)</span>
<a name="ln-209"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">capavg</span>     <span class="c">! Thermal capacitance of a node (average value for a node at an interface)</span>
<a name="ln-210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">cnd</span>        <span class="c">! Total thermal conductance (1/Rtot) of the bldg element</span>
<a name="ln-211"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">Constr</span>     <span class="c">! Loop counter</span>
<a name="ln-212"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">ConstrNum</span>  <span class="c">! Loop counter (construct number)</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-214"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cp</span>         <span class="c">! Specific heat of a material layer</span>
<a name="ln-215"></a>  <span class="kt">LOGICAL</span>                           <span class="kd">::</span> <span class="n">CTFConvrg</span>  <span class="c">! Set after CTFs are calculated, based on whether there are too</span>
<a name="ln-216"></a>                                                  <span class="c">! many CTF terms</span>
<a name="ln-217"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">CurrentLayer</span> <span class="c">! Pointer to material number in Material derived type (current layer)</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-219"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dl</span>         <span class="c">! Thickness of a material layer</span>
<a name="ln-220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">dtn</span>        <span class="c">! Intermediate calculation of the time step</span>
<a name="ln-221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-222"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dx</span>         <span class="c">! Distance between nodes in a particular material layer</span>
<a name="ln-223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">dxn</span>        <span class="c">! Intermediate calculation of nodal spacing</span>
<a name="ln-224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">dxtmp</span>      <span class="c">! Intermediate calculation variable ( = 1/dx/cap)</span>
<a name="ln-225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">dyn</span>        <span class="c">! Nodal spacing in the direction perpendicular to the main direction</span>
<a name="ln-226"></a>                                                  <span class="c">! of heat transfer (only valid for a 2-D solution)</span>
<a name="ln-227"></a>  <span class="kt">LOGICAL</span>                           <span class="kd">::</span> <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!Flag for input error condition</span>
<a name="ln-228"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">HistTerm</span>   <span class="c">! Loop counter</span>
<a name="ln-229"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">ipts1</span>      <span class="c">! Intermediate calculation for number of nodes per layer</span>
<a name="ln-230"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">ir</span>         <span class="c">! Loop control for constructing Identity Matrix</span>
<a name="ln-231"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">Layer</span>      <span class="c">! Loop counter</span>
<a name="ln-232"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">Layer1</span>     <span class="c">! Loop counter</span>
<a name="ln-233"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">LayersInConstruct</span> <span class="c">! Array containing the number of layers for each construct</span>
<a name="ln-234"></a>                                                  <span class="c">! Different from TotLayers because shades are not include in local var</span>
<a name="ln-235"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-236"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">lr</span>         <span class="c">! R value of a material layer</span>
<a name="ln-237"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">Node</span>       <span class="c">! Loop counter</span>
<a name="ln-238"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">Node2</span>      <span class="c">! Node number (modification of Node and NodeInRow)</span>
<a name="ln-239"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NodeInLayer</span> <span class="c">! Loop counter</span>
<a name="ln-240"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NodeInRow</span>  <span class="c">! Loop counter</span>
<a name="ln-241"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-242"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Nodes</span>      <span class="c">! Array containing the number of nodes per layer</span>
<a name="ln-243"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NumResLayers</span> <span class="c">! Number of resistive layers in the construction</span>
<a name="ln-244"></a>                                                  <span class="c">! property allowable, traditional value from BLAST</span>
<a name="ln-245"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">NumAdjResLayers</span> <span class="c">! Number of resistive layers that are adjacent</span>
<a name="ln-246"></a>  <span class="kt">INTEGER</span>                           <span class="kd">::</span> <span class="n">OppositeLayer</span> <span class="c">! Used for comparing constructions (to see if one is the reverse of another)</span>
<a name="ln-247"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-248"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ResLayer</span>   <span class="c">! Set true if the layer must be handled as a resistive</span>
<a name="ln-249"></a>  <span class="kt">LOGICAL</span>                           <span class="kd">::</span> <span class="n">RevConst</span>   <span class="c">! Set true if one construct is the reverse of another (CTFs already</span>
<a name="ln-250"></a>                                                  <span class="c">! available)</span>
<a name="ln-251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-252"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rho</span>        <span class="c">! Density of a material layer</span>
<a name="ln-253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-254"></a>    <span class="k">DIMENSION</span><span class="p">(</span><span class="n">MaxLayersInConstruct</span><span class="p">)</span> <span class="kd">::</span> <span class="n">rk</span>         <span class="c">! Thermal conductivity of a material layer</span>
<a name="ln-255"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">rs</span>         <span class="c">! Total thermal resistance of the building element</span>
<a name="ln-256"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">SumXi</span>      <span class="c">! Summation of all of the Xi terms (inside CTFs) for a construction</span>
<a name="ln-257"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">SumYi</span>      <span class="c">! Summation of all of the Xi terms (cross CTFs) for a construction</span>
<a name="ln-258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">SumZi</span>      <span class="c">! Summation of all of the Xi terms (outside CTFs) for a construction</span>
<a name="ln-259"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DoCTFErrorReport</span>
<a name="ln-260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Alpha</span> <span class="c">! thermal diffusivity in m2/s, for local check of properties</span>
<a name="ln-261"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DeltaTimestep</span>      <span class="c">! zone timestep in seconds, for local check of properties</span>
<a name="ln-262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ThicknessThreshold</span> <span class="c">! min thickness consistent with other thermal properties, for local check</span>
<a name="ln-263"></a>
<a name="ln-264"></a>          <span class="c">! FLOW:</span>
<a name="ln-265"></a>          <span class="c">! Subroutine initializations</span>
<a name="ln-266"></a>  <span class="n">TinyLimit</span><span class="o">=</span><span class="n">rTinyValue</span>
<a name="ln-267"></a>  <span class="n">DoCTFErrorReport</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-268"></a>
<a name="ln-269"></a>  <span class="k">DO </span><span class="n">ConstrNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotConstructs</span>   <span class="c">! Begin construction loop ...</span>
<a name="ln-270"></a>
<a name="ln-271"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFCross</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-272"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFFlux</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-273"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFInside</span>      <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-274"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFOutside</span>     <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-275"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFSourceIn</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-276"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFSourceOut</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-277"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-278"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceOut</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-279"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceIn</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-280"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceQ</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-281"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserOut</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-282"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserIn</span>     <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-283"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserSource</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-284"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-285"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span>    <span class="o">=</span> <span class="mi">0</span>
<a name="ln-286"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">UValue</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-287"></a>
<a name="ln-288"></a>    <span class="n">AdjacentResLayerNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Zero this out for each construct</span>
<a name="ln-289"></a>
<a name="ln-290"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-291"></a>
<a name="ln-292"></a>          <span class="c">! Initialize construct parameters</span>
<a name="ln-293"></a>
<a name="ln-294"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">=</span> <span class="n">TimeStepZone</span>
<a name="ln-295"></a>    <span class="n">rs</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-296"></a>    <span class="n">LayersInConstruct</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-297"></a>    <span class="n">NumResLayers</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-298"></a>    <span class="n">ResLayer</span>     <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-299"></a>
<a name="ln-300"></a>    <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>    <span class="c">! Begin layer loop ...</span>
<a name="ln-301"></a>
<a name="ln-302"></a>          <span class="c">! Loop through all of the layers in the current construct. The purpose</span>
<a name="ln-303"></a>          <span class="c">! of this loop is to define the thermal properties necessary to</span>
<a name="ln-304"></a>          <span class="c">! calculate the CTFs.</span>
<a name="ln-305"></a>
<a name="ln-306"></a>      <span class="n">CurrentLayer</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-307"></a>
<a name="ln-308"></a>        <span class="n">LayersInConstruct</span> <span class="o">=</span> <span class="n">LayersInConstruct</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-309"></a>
<a name="ln-310"></a>          <span class="c">! Obtain thermal properties from the Material derived type</span>
<a name="ln-311"></a>
<a name="ln-312"></a>        <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span>
<a name="ln-313"></a>        <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span>
<a name="ln-314"></a>        <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Density</span>
<a name="ln-315"></a>        <span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">SpecHeat</span> <span class="c">! Must convert</span>
<a name="ln-316"></a>                                        <span class="c">! from kJ/kg-K to J/kg-k due to rk units</span>
<a name="ln-317"></a>
<a name="ln-318"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">Not</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">WarnedForHighDiffusivity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-319"></a>          <span class="c">! check for materials that are too conductive or thin</span>
<a name="ln-320"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">*</span>  <span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-321"></a><span class="k">            </span><span class="n">Alpha</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">*</span>  <span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span>
<a name="ln-322"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Alpha</span> <span class="o">&gt;</span> <span class="n">HighDiffusivityThreshold</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-323"></a><span class="k">              </span><span class="n">DeltaTimestep</span>      <span class="o">=</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-324"></a>              <span class="n">ThicknessThreshold</span> <span class="o">=</span> <span class="nb">SQRT</span><span class="p">(</span><span class="n">Alpha</span> <span class="o">*</span> <span class="n">DeltaTimestep</span> <span class="o">*</span> <span class="mf">3.d0</span><span class="p">)</span>
<a name="ln-325"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">&lt;</span> <span class="n">ThicknessThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-326"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitConductionTransferFunctions: Found Material that is too thin and/or too &#39;</span> <span class="p">&amp;</span>
<a name="ln-327"></a>                                       <span class="o">//</span><span class="s1">&#39;highly conductive, material name = &#39;</span>  <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-328"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;High conductivity Material layers are not well supported for internal source &#39;</span> <span class="p">&amp;</span>
<a name="ln-329"></a>                                        <span class="o">//</span><span class="s1">&#39;constructions, material conductivity = &#39;</span> <span class="p">&amp;</span>
<a name="ln-330"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Conductivity</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; [W/m-K]&#39;</span><span class="p">)</span>
<a name="ln-331"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material thermal diffusivity = &#39;</span> <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Alpha</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="o">//</span><span class="s1">&#39; [m2/s]&#39;</span><span class="p">)</span>
<a name="ln-332"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material with this thermal diffusivity should have thickness &gt; &#39;</span> <span class="p">&amp;</span>
<a name="ln-333"></a>                                      <span class="o">//</span>  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ThicknessThreshold</span> <span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-334"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Thickness</span> <span class="o">&lt;</span> <span class="n">ThinMaterialLayerThreshold</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-335"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material may be too thin to be modeled well, thickness = &#39;</span> <span class="p">&amp;</span>
<a name="ln-336"></a>                                          <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">currentLayer</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span> <span class="mi">5</span> <span class="p">))</span><span class="o">//</span><span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-337"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Material with this thermal diffusivity should have thickness &gt; &#39;</span> <span class="p">&amp;</span>
<a name="ln-338"></a>                                      <span class="o">//</span>  <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ThinMaterialLayerThreshold</span> <span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="o">//</span> <span class="s1">&#39; [m]&#39;</span><span class="p">)</span>
<a name="ln-339"></a>                <span class="n">ENDIF</span>
<a name="ln-340"></a>                <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">WarnedForHighDiffusivity</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-341"></a>              <span class="n">ENDIF</span>
<a name="ln-342"></a>            <span class="n">ENDIF</span>
<a name="ln-343"></a>          <span class="n">ENDIF</span>
<a name="ln-344"></a>        <span class="n">ENDIF</span>
<a name="ln-345"></a>
<a name="ln-346"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">PhysPropLimit</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Thermal conductivity too small,</span>
<a name="ln-347"></a>                            <span class="c">! thus this must be handled as a resistive layer</span>
<a name="ln-348"></a>
<a name="ln-349"></a>          <span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-350"></a>
<a name="ln-351"></a>        <span class="k">ELSE</span>
<a name="ln-352"></a>
<a name="ln-353"></a><span class="k">          </span><span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-354"></a>          <span class="k">IF</span> <span class="p">((</span><span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-355"></a>                                             <span class="o">&lt;</span> <span class="n">PhysPropLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-356"></a>
<a name="ln-357"></a>          <span class="c">! If the time constant is smaller than some reasonable</span>
<a name="ln-358"></a>          <span class="c">! limit, this should be treated as a resistive layer.</span>
<a name="ln-359"></a>
<a name="ln-360"></a>            <span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-361"></a>
<a name="ln-362"></a>          <span class="k">ELSE</span>      <span class="c">! Layer has significant thermal mass (non-resistive)</span>
<a name="ln-363"></a>
<a name="ln-364"></a>            <span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-365"></a>
<a name="ln-366"></a>          <span class="k">END IF</span>
<a name="ln-367"></a><span class="k">        END IF</span>
<a name="ln-368"></a>
<a name="ln-369"></a>          <span class="c">! If not a resistive layer, nothing further is required</span>
<a name="ln-370"></a>          <span class="c">! for this layer.</span>
<a name="ln-371"></a>
<a name="ln-372"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">! Resistive layer-check for R-value, etc.</span>
<a name="ln-373"></a>          <span class="n">NumResLayers</span> <span class="o">=</span> <span class="n">NumResLayers</span> <span class="o">+</span> <span class="mi">1</span> <span class="c">! Increment number of resistive layers</span>
<a name="ln-374"></a>          <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Resistance</span>    <span class="c">! User defined thermal resistivity</span>
<a name="ln-375"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">RValueLowLimit</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! User didn&#39;t define enough</span>
<a name="ln-376"></a>                    <span class="c">! parameters to calculate CTFs for a building element</span>
<a name="ln-377"></a>                    <span class="c">! containing this layer.</span>
<a name="ln-378"></a>
<a name="ln-379"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;InitConductionTransferFunctions: Material=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">CurrentLayer</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-380"></a>               <span class="s1">&#39;R Value below lowest allowed value&#39;</span><span class="p">)</span>
<a name="ln-381"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Lowest allowed value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">RValueLowLimit</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-382"></a>                          <span class="s1">&#39;], Material R Value=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;].&#39;</span><span class="p">)</span>
<a name="ln-383"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-384"></a>
<a name="ln-385"></a>          <span class="k">ELSE</span>      <span class="c">! A valid user defined R-value is available.</span>
<a name="ln-386"></a>                    <span class="c">! If this is either the first or last layer in the construction,</span>
<a name="ln-387"></a>                    <span class="c">! then assign other properties based on air at 1 atm, 300K.</span>
<a name="ln-388"></a>                    <span class="c">! Reference for air properties:  Incropera and DeWitt,</span>
<a name="ln-389"></a>                    <span class="c">! Introduction to Heat Transfer, Appendix A, Table A.4,</span>
<a name="ln-390"></a>                    <span class="c">! John Wiley &amp; Sons, New York, 1985.</span>
<a name="ln-391"></a>                    <span class="c">! If this is not the first or last layer in the construction,</span>
<a name="ln-392"></a>                    <span class="c">! then use the &quot;exact&quot; approach to model a massless layer</span>
<a name="ln-393"></a>                    <span class="c">! based on the node equations for the state space method.</span>
<a name="ln-394"></a>
<a name="ln-395"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Layer</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Layer</span> <span class="o">==</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-396"></a>                 <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">))%</span><span class="n">ROnly</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-397"></a><span class="k">              </span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.007d0</span>
<a name="ln-398"></a>              <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.1614d0</span>
<a name="ln-399"></a>              <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0263d0</span>
<a name="ln-400"></a>              <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-401"></a>            <span class="k">ELSE</span>
<a name="ln-402"></a><span class="k">              </span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-403"></a>              <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-404"></a>              <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-405"></a>              <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-406"></a>            <span class="k">END IF</span>
<a name="ln-407"></a>
<a name="ln-408"></a><span class="k">          END IF</span>
<a name="ln-409"></a><span class="k">        END IF</span>      <span class="c">! ... end of resistive layer determination IF-THEN block.</span>
<a name="ln-410"></a>    <span class="k">END DO</span>          <span class="c">! ... end of layer loop.</span>
<a name="ln-411"></a>
<a name="ln-412"></a>    <span class="c">! If errors have been found, just cycle</span>
<a name="ln-413"></a>
<a name="ln-414"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-415"></a>
<a name="ln-416"></a>          <span class="c">! Combine any adjacent resistive-only (no mass) layers together</span>
<a name="ln-417"></a>          <span class="c">! to avoid a divide by zero error in the CTF calculations below.</span>
<a name="ln-418"></a>          <span class="c">! Since the inner and outer layers cannot be resistive layers</span>
<a name="ln-419"></a>          <span class="c">! (inner and outer layer still converted to equivalent air layer)</span>
<a name="ln-420"></a>          <span class="c">! there can only be resistive layers adjacent to one another if</span>
<a name="ln-421"></a>          <span class="c">! there are more than three total layers and more than one</span>
<a name="ln-422"></a>          <span class="c">! resistive layer.</span>
<a name="ln-423"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">LayersInConstruct</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">NumResLayers</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-424"></a><span class="k">      </span><span class="n">NumAdjResLayers</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-425"></a>      <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">LayersInConstruct</span><span class="o">-</span><span class="mi">2</span>
<a name="ln-426"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-427"></a><span class="k">          </span><span class="n">NumAdjResLayers</span> <span class="o">=</span> <span class="n">NumAdjResLayers</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-428"></a>          <span class="c">! There is method to the next assignment statement.  As the layers get shifted, the layer</span>
<a name="ln-429"></a>          <span class="c">! numbers will also shift.  Thus, we have to also shift which layer we are dealing with.</span>
<a name="ln-430"></a>          <span class="n">AdjacentResLayerNum</span><span class="p">(</span><span class="n">NumAdjResLayers</span><span class="p">)</span> <span class="o">=</span> <span class="n">Layer</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">NumAdjResLayers</span>
<a name="ln-431"></a>        <span class="k">END IF</span>
<a name="ln-432"></a><span class="k">      END DO</span>
<a name="ln-433"></a><span class="k">      DO </span><span class="n">AdjLayer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAdjResLayers</span>
<a name="ln-434"></a>        <span class="n">Layer</span> <span class="o">=</span> <span class="n">AdjacentResLayerNum</span><span class="p">(</span><span class="n">AdjLayer</span><span class="p">)</span>
<a name="ln-435"></a>          <span class="c">! Double check to make sure we are in the right place...</span>
<a name="ln-436"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-437"></a>            <span class="c">! Shift layers forward after combining two adjacent layers.  Then</span>
<a name="ln-438"></a>            <span class="c">! restart the do loop.</span>
<a name="ln-439"></a>          <span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-440"></a>          <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-441"></a>          <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-442"></a>          <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">+</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-443"></a>          <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-444"></a>          <span class="n">NumResLayers</span> <span class="o">=</span> <span class="n">NumResLayers</span> <span class="o">-</span> <span class="mi">1</span> <span class="c">! Combining layers so decrease number of resistive layers</span>
<a name="ln-445"></a>          <span class="k">DO </span><span class="n">Layer1</span> <span class="o">=</span> <span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">LayersInConstruct</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-446"></a>            <span class="n">lr</span><span class="p">(</span><span class="n">Layer1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-447"></a>            <span class="n">dl</span><span class="p">(</span><span class="n">Layer1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">dl</span><span class="p">(</span><span class="n">Layer1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-448"></a>            <span class="n">rk</span><span class="p">(</span><span class="n">Layer1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-449"></a>            <span class="n">rho</span><span class="p">(</span><span class="n">Layer1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">Layer1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-450"></a>            <span class="n">cp</span><span class="p">(</span><span class="n">Layer1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">cp</span><span class="p">(</span><span class="n">Layer1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-451"></a>            <span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-452"></a>          <span class="k">END DO</span>
<a name="ln-453"></a>            <span class="c">! Then zero out the layer that got shifted forward</span>
<a name="ln-454"></a>          <span class="n">cp</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-455"></a>          <span class="n">rho</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-456"></a>          <span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-457"></a>          <span class="n">lr</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-458"></a>          <span class="n">dl</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-459"></a>            <span class="c">! Now reduce the number of layers in construct since merger is complete</span>
<a name="ln-460"></a>          <span class="n">LayersInConstruct</span> <span class="o">=</span> <span class="n">LayersInConstruct</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-461"></a>            <span class="c">! Also adjust layers with source/sinks if two layers are merged</span>
<a name="ln-462"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-463"></a><span class="k">            </span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceAfterLayer</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceAfterLayer</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-464"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempAfterLayer</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempAfterLayer</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-465"></a>          <span class="k">END IF</span>
<a name="ln-466"></a><span class="k">        ELSE</span> <span class="c">! These are not adjacent layers and there is a logic flaw here (should not happen)</span>
<a name="ln-467"></a>          <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Combining resistance layers failed for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-468"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This should never happen.  Contact EnergyPlus Support for further assistance.&#39;</span><span class="p">)</span>
<a name="ln-469"></a>        <span class="k">END IF</span>
<a name="ln-470"></a><span class="k">      END DO</span>
<a name="ln-471"></a><span class="k">    END IF</span>
<a name="ln-472"></a>
<a name="ln-473"></a>          <span class="c">! Convert SI units to English.  In theory, conversion to English</span>
<a name="ln-474"></a>          <span class="c">! units is not necessary; however, Russ Taylor noted that some</span>
<a name="ln-475"></a>          <span class="c">! numerical problems when SI units were used and decided to continue</span>
<a name="ln-476"></a>          <span class="c">! calculating CTFs in English units.</span>
<a name="ln-477"></a>
<a name="ln-478"></a>    <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">LayersInConstruct</span>  <span class="c">! Begin units conversion loop ...</span>
<a name="ln-479"></a>
<a name="ln-480"></a>      <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-481"></a>      <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">CFL</span>
<a name="ln-482"></a>      <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">CFK</span>
<a name="ln-483"></a>      <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">CFD</span>
<a name="ln-484"></a>      <span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>  <span class="o">=</span> <span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">CFC</span><span class="o">*</span><span class="mi">100</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-485"></a>
<a name="ln-486"></a>    <span class="k">END DO</span>          <span class="c">! ... end of layer loop for units conversion.</span>
<a name="ln-487"></a>
<a name="ln-488"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-489"></a><span class="k">      </span><span class="n">dyn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-490"></a>    <span class="k">ELSE</span>
<a name="ln-491"></a><span class="k">      </span><span class="n">dyn</span> <span class="o">=</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ThicknessPerpend</span><span class="o">/</span><span class="n">CFL</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-492"></a>    <span class="k">END IF</span>
<a name="ln-493"></a>
<a name="ln-494"></a>          <span class="c">! Compute total construct conductivity and resistivity.</span>
<a name="ln-495"></a>
<a name="ln-496"></a>    <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">LayersInConstruct</span>
<a name="ln-497"></a>      <span class="n">rs</span> <span class="o">=</span> <span class="n">rs</span> <span class="o">+</span> <span class="n">lr</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>   <span class="c">! Resistances in series sum algebraically</span>
<a name="ln-498"></a>    <span class="k">END DO</span>
<a name="ln-499"></a>
<a name="ln-500"></a><span class="k">    </span><span class="n">cnd</span> <span class="o">=</span> <span class="mf">1.0D0</span><span class="o">/</span><span class="n">rs</span>      <span class="c">! Conductivity is the inverse of resistivity</span>
<a name="ln-501"></a>
<a name="ln-502"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">LayersInConstruct</span> <span class="o">&gt;</span> <span class="n">NumResLayers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-503"></a>
<a name="ln-504"></a>          <span class="c">! One or more are not simple resistive layers so CTFs will have to be</span>
<a name="ln-505"></a>          <span class="c">! calculated unless this is a reverse of a previously defined</span>
<a name="ln-506"></a>          <span class="c">! construction.</span>
<a name="ln-507"></a>
<a name="ln-508"></a>          <span class="c">! Check for reversed construction of interzone surfaces by checking</span>
<a name="ln-509"></a>          <span class="c">! previous constructions for same number of layers as first indicator.</span>
<a name="ln-510"></a>
<a name="ln-511"></a>      <span class="n">RevConst</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-512"></a>
<a name="ln-513"></a>      <span class="k">DO </span><span class="n">Constr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ConstrNum</span><span class="o">-</span><span class="mi">1</span>       <span class="c">! Constructions loop (check reversed) ...</span>
<a name="ln-514"></a>
<a name="ln-515"></a>          <span class="c">! If a source or sink is present in this construction, do not allow any</span>
<a name="ln-516"></a>          <span class="c">! checks for reversed constructions, i.e., always force EnergyPlus to</span>
<a name="ln-517"></a>          <span class="c">! calculate CTF/QTFs.  So, don&#39;t even check for reversed constructions.</span>
<a name="ln-518"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">EXIT</span> <span class="c">! Constr DO loop</span>
<a name="ln-519"></a>
<a name="ln-520"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span> <span class="o">==</span> <span class="p">&amp;</span> <span class="c">! Same number of layers--now</span>
<a name="ln-521"></a>               <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! check for reversed construct.</span>
<a name="ln-522"></a>
<a name="ln-523"></a>          <span class="n">RevConst</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-524"></a>
<a name="ln-525"></a>          <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>  <span class="c">! Begin layers loop ...</span>
<a name="ln-526"></a>
<a name="ln-527"></a>          <span class="c">! RevConst is set to FALSE anytime a mismatch in materials is found.</span>
<a name="ln-528"></a>          <span class="c">! This will exit this DO immediately and go on to the next construct</span>
<a name="ln-529"></a>          <span class="c">! (if any remain).</span>
<a name="ln-530"></a>
<a name="ln-531"></a>            <span class="n">OppositeLayer</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="o">-</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-532"></a>
<a name="ln-533"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">/=</span>  <span class="p">&amp;</span>
<a name="ln-534"></a>                <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">OppositeLayer</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-535"></a>
<a name="ln-536"></a><span class="k">                </span><span class="n">RevConst</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-537"></a>                <span class="k">EXIT</span> <span class="c">! Layer DO loop</span>
<a name="ln-538"></a>
<a name="ln-539"></a>            <span class="k">END IF</span>
<a name="ln-540"></a>
<a name="ln-541"></a><span class="k">          END DO</span>    <span class="c">! ... end of layers loop.</span>
<a name="ln-542"></a>
<a name="ln-543"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">RevConst</span><span class="p">)</span> <span class="k">THEN</span>        <span class="c">! Curent construction is a reverse of</span>
<a name="ln-544"></a>                    <span class="c">! construction Constr.  Thus, CTFs do not need to be re-</span>
<a name="ln-545"></a>                    <span class="c">! calculated.  Copy CTF info for construction Constr to</span>
<a name="ln-546"></a>                    <span class="c">! construction ConstrNum.</span>
<a name="ln-547"></a>
<a name="ln-548"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">CTFTimeStep</span>
<a name="ln-549"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">NumHistories</span>
<a name="ln-550"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">NumCTFTerms</span>
<a name="ln-551"></a>
<a name="ln-552"></a>          <span class="c">! Transfer the temperature and flux history terms to CTF arrays.</span>
<a name="ln-553"></a>          <span class="c">! Loop through the number of CTF history terms ...</span>
<a name="ln-554"></a>            <span class="k">DO </span><span class="n">HistTerm</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span>
<a name="ln-555"></a>
<a name="ln-556"></a>              <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFInside</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">CTFOutside</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>
<a name="ln-557"></a>              <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFCross</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">CTFCross</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>
<a name="ln-558"></a>              <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFOutside</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">CTFInside</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>
<a name="ln-559"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HistTerm</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-560"></a>                 <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFFlux</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Constr</span><span class="p">)%</span><span class="n">CTFFlux</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>
<a name="ln-561"></a>
<a name="ln-562"></a>            <span class="k">END DO</span>  <span class="c">! ... end of CTF history terms loop.</span>
<a name="ln-563"></a>
<a name="ln-564"></a>            <span class="k">EXIT</span> <span class="c">! Constr DO loop</span>
<a name="ln-565"></a>
<a name="ln-566"></a>          <span class="k">END IF</span>    <span class="c">! ... end of reversed construction found block</span>
<a name="ln-567"></a>
<a name="ln-568"></a>        <span class="k">END IF</span>      <span class="c">! ... end of reversed construct (same number of layers) block.</span>
<a name="ln-569"></a>
<a name="ln-570"></a>      <span class="k">END DO</span>        <span class="c">! ... end of construct loop (check reversed--Constr)</span>
<a name="ln-571"></a>
<a name="ln-572"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RevConst</span><span class="p">)</span> <span class="k">THEN</span>       <span class="c">! Calculate CTFs (non-reversed constr)</span>
<a name="ln-573"></a>
<a name="ln-574"></a>          <span class="c">! Estimate number of nodes each layer of the construct will require</span>
<a name="ln-575"></a>          <span class="c">! and calculate the nodal spacing from that</span>
<a name="ln-576"></a>
<a name="ln-577"></a>        <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">LayersInConstruct</span> <span class="c">! Begin loop thru layers ...</span>
<a name="ln-578"></a>
<a name="ln-579"></a>          <span class="c">! The calculation of dxn used here is based on a standard stability</span>
<a name="ln-580"></a>          <span class="c">! criteria for explicit finite difference solutions.  This criteria</span>
<a name="ln-581"></a>          <span class="c">! was chosen not because it is viewed to be correct, but rather for</span>
<a name="ln-582"></a>          <span class="c">! lack of any better criteria at this time.  The use of a Fourier</span>
<a name="ln-583"></a>          <span class="c">! number based criteria such as this is probably physically correct,</span>
<a name="ln-584"></a>          <span class="c">! though the coefficient (2.0) may not be.</span>
<a name="ln-585"></a>
<a name="ln-586"></a>          <span class="c">! If this is a &quot;resistive&quot; layer, only need a single node</span>
<a name="ln-587"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">ResLayer</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Layer</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Layer</span><span class="o">&lt;</span><span class="n">LayersInConstruct</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-588"></a><span class="k">            </span><span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-589"></a>            <span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>    <span class="o">=</span> <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-590"></a>          <span class="k">ELSE</span>
<a name="ln-591"></a><span class="k">            </span><span class="n">dxn</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-592"></a>                        <span class="o">*</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="p">)</span>
<a name="ln-593"></a>
<a name="ln-594"></a>            <span class="n">ipts1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">dxn</span><span class="p">)</span>  <span class="c">! number of nodes=thickness/spacing</span>
<a name="ln-595"></a>
<a name="ln-596"></a>          <span class="c">! Limit the upper and lower bounds of the number of</span>
<a name="ln-597"></a>          <span class="c">! nodes to MaxCTFTerms and MinNodes respectively.</span>
<a name="ln-598"></a>
<a name="ln-599"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ipts1</span> <span class="o">&gt;</span> <span class="n">MaxCTFTerms</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! Too many nodes</span>
<a name="ln-600"></a>              <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">MaxCTFTerms</span>
<a name="ln-601"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ipts1</span> <span class="o">&lt;</span> <span class="n">MinNodes</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Too few nodes</span>
<a name="ln-602"></a>              <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">MinNodes</span>
<a name="ln-603"></a>            <span class="k">ELSE</span>                              <span class="c">! Calculated number of nodes ok</span>
<a name="ln-604"></a>              <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">ipts1</span>
<a name="ln-605"></a>            <span class="k">END IF</span>
<a name="ln-606"></a>
<a name="ln-607"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-608"></a><span class="k">              IF</span> <span class="p">(</span><span class="n">ipts1</span> <span class="o">&gt;</span> <span class="n">MaxCTFTerms</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="n">ipts1</span> <span class="o">=</span> <span class="n">MaxCTFTerms</span><span class="o">/</span><span class="mi">2</span>
<a name="ln-609"></a>            <span class="k">END IF</span>
<a name="ln-610"></a>
<a name="ln-611"></a><span class="k">            </span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">=</span> <span class="n">dl</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">),</span><span class="n">r64</span><span class="p">)</span> <span class="c">! calc node spacing</span>
<a name="ln-612"></a>
<a name="ln-613"></a>          <span class="k">END IF</span>
<a name="ln-614"></a>
<a name="ln-615"></a><span class="k">        END DO</span>      <span class="c">! . .. end of layers in construction loop (calculating #nodes per layer)</span>
<a name="ln-616"></a>
<a name="ln-617"></a>          <span class="c">! Determine the total number of nodes (rcmax)</span>
<a name="ln-618"></a>
<a name="ln-619"></a>        <span class="n">rcmax</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-620"></a>        <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">LayersInConstruct</span>
<a name="ln-621"></a>          <span class="n">rcmax</span> <span class="o">=</span> <span class="n">rcmax</span> <span class="o">+</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-622"></a>        <span class="k">END DO</span>
<a name="ln-623"></a>
<a name="ln-624"></a>          <span class="c">! Nodes are placed throughout layers and at the interface between</span>
<a name="ln-625"></a>          <span class="c">! layers.  As a result, the end layers share a node with the adjacent</span>
<a name="ln-626"></a>          <span class="c">! layer-leaving one less node total for all layers.</span>
<a name="ln-627"></a>
<a name="ln-628"></a>        <span class="n">rcmax</span> <span class="o">=</span> <span class="n">rcmax</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-629"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">rcmax</span> <span class="o">=</span> <span class="n">rcmax</span> <span class="o">*</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-630"></a>
<a name="ln-631"></a><span class="c">! This section no longer needed as rcmax/number of total nodes is allowed to float.</span>
<a name="ln-632"></a><span class="c">! If reinstated, this node reduction section would have to be modified to account for</span>
<a name="ln-633"></a><span class="c">! the possibility that a 2-D solution is potentially being performed.</span>
<a name="ln-634"></a>          <span class="c">! Check to see if the maximum number of nodes for the construct has</span>
<a name="ln-635"></a>          <span class="c">! been exceeded.  Reduce the nodes per layer if necessary, but only</span>
<a name="ln-636"></a>          <span class="c">! if the number of nodes in a particular layer is greater than the</span>
<a name="ln-637"></a>          <span class="c">! minimum node limit.</span>
<a name="ln-638"></a>
<a name="ln-639"></a><span class="c">!        DO WHILE (rcmax &gt; MaxTotNodes)     ! Begin total node reduction loop ...</span>
<a name="ln-640"></a>
<a name="ln-641"></a><span class="c">!          rcmax = 0</span>
<a name="ln-642"></a>
<a name="ln-643"></a><span class="c">!          DO Layer = 1, LayersInConstruct   ! Begin layer node reduction ...</span>
<a name="ln-644"></a>
<a name="ln-645"></a><span class="c">!          ! If more nodes than the minimum limit for a layer, reduce the</span>
<a name="ln-646"></a><span class="c">!          ! number of nodes.</span>
<a name="ln-647"></a>
<a name="ln-648"></a><span class="c">!            IF (Nodes(Layer) &gt; MinNodes) THEN</span>
<a name="ln-649"></a><span class="c">!              Nodes(Layer) = Nodes(Layer)-1</span>
<a name="ln-650"></a><span class="c">!              dx(Layer) = dl(Layer)/dble(float(Nodes(Layer))) ! Recalc node spacing</span>
<a name="ln-651"></a><span class="c">!            END IF</span>
<a name="ln-652"></a>
<a name="ln-653"></a><span class="c">!            rcmax = rcmax + Nodes(Layer) ! Recalculate total number of nodes</span>
<a name="ln-654"></a>
<a name="ln-655"></a><span class="c">!          END DO        ! ... end of layer loop for node reduction.</span>
<a name="ln-656"></a>
<a name="ln-657"></a><span class="c">!          rcmax = rcmax-1 ! See note above on counting rcmax</span>
<a name="ln-658"></a>
<a name="ln-659"></a><span class="c">!        END DO      ! ... end of total node reduction loop.</span>
<a name="ln-660"></a>
<a name="ln-661"></a>          <span class="c">! For constructions that have sources or sinks present, determine which</span>
<a name="ln-662"></a>          <span class="c">! node the source/sink is applied at and also where the temperature</span>
<a name="ln-663"></a>          <span class="c">! calculation has been requested.</span>
<a name="ln-664"></a>        <span class="n">NodeSource</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-665"></a>        <span class="n">NodeUserTemp</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-666"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-667"></a>
<a name="ln-668"></a><span class="k">          DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceAfterLayer</span>
<a name="ln-669"></a>            <span class="n">NodeSource</span> <span class="o">=</span> <span class="n">NodeSource</span> <span class="o">+</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-670"></a>          <span class="k">END DO</span>
<a name="ln-671"></a><span class="k">          IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-672"></a>            <span class="n">NodeSource</span> <span class="o">=</span> <span class="p">((</span><span class="n">NodeSource</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-673"></a>
<a name="ln-674"></a>          <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempAfterLayer</span>
<a name="ln-675"></a>            <span class="n">NodeUserTemp</span> <span class="o">=</span> <span class="n">NodeUserTemp</span> <span class="o">+</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-676"></a>          <span class="k">END DO</span>
<a name="ln-677"></a><span class="k">          IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">NodeUserTemp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-678"></a>            <span class="n">NodeUserTemp</span> <span class="o">=</span> <span class="p">((</span><span class="n">NodeUserTemp</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-679"></a>
<a name="ln-680"></a>        <span class="k">END IF</span>
<a name="ln-681"></a>
<a name="ln-682"></a>          <span class="c">! &quot;Adjust time step to ensure stability.&quot;  If the time step is too</span>
<a name="ln-683"></a>          <span class="c">! small, it will result in too many history terms which can lead to</span>
<a name="ln-684"></a>          <span class="c">! solution instability.  The method used here to determine whether or</span>
<a name="ln-685"></a>          <span class="c">! not the time step will produce a stable solution is based on a pure</span>
<a name="ln-686"></a>          <span class="c">! Fourier number calculation (Fo = 1) and has not proven to be</span>
<a name="ln-687"></a>          <span class="c">! completely effective.  If too many history terms are calculated,</span>
<a name="ln-688"></a>          <span class="c">! the time step is adjusted and the CTFs end up being recalculated</span>
<a name="ln-689"></a>          <span class="c">! (see later code in this routine).</span>
<a name="ln-690"></a>
<a name="ln-691"></a>        <span class="n">dtn</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-692"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-693"></a>        <span class="k">DO </span><span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">LayersInConstruct</span>
<a name="ln-694"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">MaxCTFTerms</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-695"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-696"></a><span class="k">              </span><span class="n">dtn</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-697"></a>            <span class="k">ELSE</span>    <span class="c">! 2-D solution requested--&gt;this changes length parameter in Fourier number calculation</span>
<a name="ln-698"></a>              <span class="n">dtn</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">dyn</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>
<a name="ln-699"></a>            <span class="k">END IF</span>
<a name="ln-700"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">dtn</span> <span class="o">&gt;</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-701"></a>                       <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">=</span> <span class="n">dtn</span>
<a name="ln-702"></a>          <span class="k">END IF</span>
<a name="ln-703"></a><span class="k">        END DO</span>
<a name="ln-704"></a>
<a name="ln-705"></a>          <span class="c">! If the user defined time step is significantly different than the</span>
<a name="ln-706"></a>          <span class="c">! calculated time step for this construct, then CTFTimeStep must be</span>
<a name="ln-707"></a>          <span class="c">! revised.</span>
<a name="ln-708"></a>
<a name="ln-709"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">TimeStepZone</span><span class="o">-</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="p">)</span><span class="o">/</span><span class="n">TimeStepZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-710"></a>
<a name="ln-711"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">&gt;</span> <span class="n">TimeStepZone</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-712"></a>
<a name="ln-713"></a>          <span class="c">! CTFTimeStep larger than TimeStepZone:  Make sure TimeStepZone</span>
<a name="ln-714"></a>          <span class="c">! divides evenly into CTFTimeStep</span>
<a name="ln-715"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-716"></a>              <span class="nb">INT</span><span class="p">((</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="o">/</span><span class="n">TimeStepZone</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5D0</span><span class="p">)</span>
<a name="ln-717"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-718"></a>              <span class="n">TimeStepZone</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-719"></a>
<a name="ln-720"></a>          <span class="k">ELSE</span>
<a name="ln-721"></a>
<a name="ln-722"></a>          <span class="c">! CTFTimeStep smaller than TimeStepZone:  Set to TimeStepZone</span>
<a name="ln-723"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">=</span> <span class="n">TimeStepZone</span>
<a name="ln-724"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-725"></a>
<a name="ln-726"></a>          <span class="k">END IF</span>
<a name="ln-727"></a>
<a name="ln-728"></a><span class="k">        END IF</span>
<a name="ln-729"></a>
<a name="ln-730"></a>          <span class="c">! Calculate the CTFs using the state space method</span>
<a name="ln-731"></a>          <span class="c">! outlined in Seem&#39;s dissertation.  The main matrices</span>
<a name="ln-732"></a>          <span class="c">! AMat, BMat, CMat, and DMat must be derived from</span>
<a name="ln-733"></a>          <span class="c">! applying a finite difference network to the layers of</span>
<a name="ln-734"></a>          <span class="c">! each bldg element.</span>
<a name="ln-735"></a>
<a name="ln-736"></a>          <span class="c">! This section must continue looping until the CTFs</span>
<a name="ln-737"></a>          <span class="c">! calculated here will produce a stable solution (less</span>
<a name="ln-738"></a>          <span class="c">! history terms than MaxCTFTerms).</span>
<a name="ln-739"></a>
<a name="ln-740"></a>          <span class="c">! This first subsection calculates the elements of AMat</span>
<a name="ln-741"></a>          <span class="c">! which characterizes the heat transfer inside the</span>
<a name="ln-742"></a>          <span class="c">! building element.</span>
<a name="ln-743"></a>
<a name="ln-744"></a>        <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>         <span class="c">! Initialize loop control logical</span>
<a name="ln-745"></a>
<a name="ln-746"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AExp</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-747"></a>        <span class="n">AExp</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-748"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AMat</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-749"></a>        <span class="n">AMat</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-750"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AInv</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-751"></a>        <span class="n">AInv</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-752"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">IdenMatrix</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-753"></a>        <span class="n">IdenMatrix</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-754"></a>        <span class="k">DO </span><span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-755"></a>          <span class="n">IdenMatrix</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0D0</span>
<a name="ln-756"></a>        <span class="n">ENDDO</span>
<a name="ln-757"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-758"></a>        <span class="n">e</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-759"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-760"></a>        <span class="n">Gamma1</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-761"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-762"></a>        <span class="n">Gamma2</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-763"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-764"></a>        <span class="n">s</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-765"></a>
<a name="ln-766"></a>        <span class="k">DO WHILE</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CTFConvrg</span><span class="p">)</span>   <span class="c">! Begin CTF calculation loop ...</span>
<a name="ln-767"></a>
<a name="ln-768"></a>          <span class="n">BMat</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-769"></a>
<a name="ln-770"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-771"></a>
<a name="ln-772"></a>          <span class="c">! Set up intermediate calculations for the first layer.</span>
<a name="ln-773"></a>            <span class="n">cap</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-774"></a>            <span class="n">cap</span> <span class="o">=</span> <span class="mf">1.5d0</span><span class="o">*</span><span class="n">cap</span> <span class="c">! For the first node, account for the fact that the</span>
<a name="ln-775"></a>                            <span class="c">! half-node at the surface results in a &quot;loss&quot; of some</span>
<a name="ln-776"></a>                            <span class="c">! thermal mass.  Therefore, for simplicity, include it</span>
<a name="ln-777"></a>                            <span class="c">! at this node.  Same thing done at the last node...</span>
<a name="ln-778"></a>            <span class="n">dxtmp</span> <span class="o">=</span> <span class="mf">1.0D0</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cap</span>
<a name="ln-779"></a>
<a name="ln-780"></a>            <span class="n">AMat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>    <span class="c">! Assign the matrix values for the</span>
<a name="ln-781"></a>            <span class="n">AMat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>           <span class="c">! first node.</span>
<a name="ln-782"></a>            <span class="n">BMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>           <span class="c">! Assign non-zero value of BMat.</span>
<a name="ln-783"></a>
<a name="ln-784"></a>            <span class="n">Layer</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c">! Initialize the &quot;layer&quot; counter</span>
<a name="ln-785"></a>
<a name="ln-786"></a>            <span class="n">NodeInLayer</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c">! Initialize the node (in a layer) counter (already</span>
<a name="ln-787"></a>                              <span class="c">! on the second node for the first layer</span>
<a name="ln-788"></a>
<a name="ln-789"></a>            <span class="k">DO </span><span class="n">Node</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="n">rcmax</span><span class="o">-</span><span class="mi">1</span> <span class="c">! Begin nodes loop (includes all nodes except the</span>
<a name="ln-790"></a>                                <span class="c">! first/last which have special equations) ...</span>
<a name="ln-791"></a>
<a name="ln-792"></a>              <span class="k">IF</span> <span class="p">((</span><span class="n">NodeInLayer</span> <span class="o">==</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-793"></a>                       <span class="p">(</span><span class="n">LayersInConstruct</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>    <span class="c">! For a node at</span>
<a name="ln-794"></a>                    <span class="c">! the interface between two adjacent layers, the</span>
<a name="ln-795"></a>                    <span class="c">! capacitance of the node must be calculated from the 2</span>
<a name="ln-796"></a>                    <span class="c">! halves which may be made up of 2 different materials.</span>
<a name="ln-797"></a>
<a name="ln-798"></a>                <span class="n">cap</span> <span class="o">=</span> <span class="p">(</span> <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-799"></a>                       <span class="o">+</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="mf">0.5D0</span>
<a name="ln-800"></a>
<a name="ln-801"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">cap</span>           <span class="c">! Assign matrix</span>
<a name="ln-802"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>   <span class="o">=</span> <span class="o">-</span><span class="mf">1.0D0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">+</span> <span class="p">&amp;</span> <span class="c">! values for</span>
<a name="ln-803"></a>                                    <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">cap</span>   <span class="c">! the current</span>
<a name="ln-804"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">cap</span>       <span class="c">! node.</span>
<a name="ln-805"></a>
<a name="ln-806"></a>                <span class="n">NodeInLayer</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c">! At an interface, reset nodes in layer counter</span>
<a name="ln-807"></a>                <span class="n">Layer</span>       <span class="o">=</span> <span class="n">Layer</span><span class="o">+</span><span class="mi">1</span> <span class="c">! Also increment the layer counter</span>
<a name="ln-808"></a>
<a name="ln-809"></a>              <span class="k">ELSE</span>    <span class="c">! Standard node within any layer</span>
<a name="ln-810"></a>
<a name="ln-811"></a>                <span class="n">cap</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span>      <span class="c">! Intermediate</span>
<a name="ln-812"></a>                <span class="n">dxtmp</span> <span class="o">=</span> <span class="mf">1.0D0</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="n">cap</span>               <span class="c">! calculations.</span>
<a name="ln-813"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>       <span class="c">! Assign matrix</span>
<a name="ln-814"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>  <span class="c">! values for the</span>
<a name="ln-815"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>       <span class="c">! current node.</span>
<a name="ln-816"></a>
<a name="ln-817"></a>              <span class="k">END IF</span>
<a name="ln-818"></a>
<a name="ln-819"></a><span class="k">              </span><span class="n">NodeInLayer</span> <span class="o">=</span> <span class="n">NodeInLayer</span><span class="o">+</span><span class="mi">1</span> <span class="c">! Increment nodes in layer counter</span>
<a name="ln-820"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span> <span class="o">==</span> <span class="n">NodeSource</span><span class="p">)</span> <span class="n">BMat</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="n">cap</span>
<a name="ln-821"></a>
<a name="ln-822"></a>            <span class="k">END DO</span>    <span class="c">! ... end of nodes loop.</span>
<a name="ln-823"></a>
<a name="ln-824"></a>            <span class="c">! Intermediate calculations for the last node.</span>
<a name="ln-825"></a>            <span class="n">cap</span> <span class="o">=</span> <span class="n">rho</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">*</span> <span class="n">dx</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>
<a name="ln-826"></a>            <span class="n">cap</span> <span class="o">=</span> <span class="mf">1.5d0</span><span class="o">*</span><span class="n">cap</span> <span class="c">! For the last node, account for the fact that the</span>
<a name="ln-827"></a>                            <span class="c">! half-node at the surface results in a &quot;loss&quot; of some</span>
<a name="ln-828"></a>                            <span class="c">! thermal mass.  Therefore, for simplicity, include it</span>
<a name="ln-829"></a>                            <span class="c">! at this node.  Same thing done at the first node...</span>
<a name="ln-830"></a>            <span class="n">dxtmp</span> <span class="o">=</span> <span class="mf">1.0D0</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="n">cap</span>
<a name="ln-831"></a>
<a name="ln-832"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0D0</span><span class="o">*</span><span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span> <span class="c">! Assign matrix</span>
<a name="ln-833"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>      <span class="c">! values for the</span>
<a name="ln-834"></a>            <span class="n">BMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">*</span><span class="n">dxtmp</span>                  <span class="c">! last node.</span>
<a name="ln-835"></a>
<a name="ln-836"></a>            <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                <span class="c">! Compute the necessary elements</span>
<a name="ln-837"></a>            <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>   <span class="c">! of all other</span>
<a name="ln-838"></a>            <span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                         <span class="c">! matrices for the state</span>
<a name="ln-839"></a>            <span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span>  <span class="c">! space method</span>
<a name="ln-840"></a>
<a name="ln-841"></a>          <span class="k">ELSE</span>  <span class="c">! 2-D solution requested (assign matrices appropriately)</span>
<a name="ln-842"></a>
<a name="ln-843"></a>            <span class="c">! As with the 1-D solution, we are accounting for the thermal mass</span>
<a name="ln-844"></a>            <span class="c">! of the half-node at the surface by adding it to the first row</span>
<a name="ln-845"></a>            <span class="c">! of interior nodes at both sides of the construction.  This is not</span>
<a name="ln-846"></a>            <span class="c">! exact, but it does take all of the thermal mass into account.</span>
<a name="ln-847"></a>            <span class="n">amatx</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.5d0</span><span class="o">*</span><span class="n">rho</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-848"></a>            <span class="n">amaty</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.5d0</span><span class="o">*</span><span class="n">rho</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dyn</span><span class="o">*</span><span class="n">dyn</span><span class="p">)</span>
<a name="ln-849"></a>
<a name="ln-850"></a>            <span class="c">! FIRST ROW OF NODES: This first row within the first material layer</span>
<a name="ln-851"></a>            <span class="c">! is special in that it is exposed to a boundary condition.  Thus,</span>
<a name="ln-852"></a>            <span class="c">! the equations are slightly different.</span>
<a name="ln-853"></a>            <span class="c">! Note also that the first and last nodes in a row are slightly</span>
<a name="ln-854"></a>            <span class="c">! different from the rest since they are on an adiabatic plane in</span>
<a name="ln-855"></a>            <span class="c">! the direction perpendicular to the main direction of heat transfer.</span>
<a name="ln-856"></a>            <span class="n">AMat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-857"></a>            <span class="n">AMat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                   <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-858"></a>            <span class="n">AMat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfPerpendNodes</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-859"></a>
<a name="ln-860"></a>            <span class="k">DO </span><span class="n">Node</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-861"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-862"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-863"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-864"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-865"></a>            <span class="k">END DO</span>
<a name="ln-866"></a>
<a name="ln-867"></a><span class="k">            </span><span class="n">AMat</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="p">,</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-868"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="p">,</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-869"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="p">,</span><span class="n">NumOfPerpendNodes</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-870"></a>
<a name="ln-871"></a>            <span class="n">BMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-872"></a>
<a name="ln-873"></a>            <span class="n">Layer</span>       <span class="o">=</span> <span class="mi">1</span>
<a name="ln-874"></a>            <span class="n">NodeInLayer</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-875"></a>            <span class="n">amatx</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>    <span class="c">! Reset these to the normal capacitance</span>
<a name="ln-876"></a>            <span class="n">amaty</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dyn</span><span class="o">*</span><span class="n">dyn</span><span class="p">)</span>        <span class="c">! Reset these to the normal capacitance</span>
<a name="ln-877"></a>            <span class="k">DO </span><span class="n">Node</span> <span class="o">=</span> <span class="n">NumOfPerpendNodes</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">NumOfPerpendNodes</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-878"></a>              <span class="c">! INTERNAL ROWS OF NODES: This is the majority of nodes which are all within</span>
<a name="ln-879"></a>              <span class="c">! a solid layer and not exposed to a boundary condition.</span>
<a name="ln-880"></a>              <span class="k">IF</span> <span class="p">((</span><span class="n">LayersInConstruct</span> <span class="o">==</span> <span class="mi">1</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">NodeInLayer</span> <span class="o">/=</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">Layer</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-881"></a>                <span class="c">! Single material row: This row of nodes are all contained within a material</span>
<a name="ln-882"></a>                <span class="c">! and thus there is no special considerations necessary.</span>
<a name="ln-883"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">NodeInLayer</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-884"></a>                  <span class="c">! These intermediate variables only need to be reassigned when a new layer is started.</span>
<a name="ln-885"></a>                  <span class="c">! When this is simply another row of the same material, these have already been assigned correctly.</span>
<a name="ln-886"></a>                  <span class="n">amatx</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span>
<a name="ln-887"></a>                  <span class="n">amaty</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dyn</span><span class="o">*</span><span class="n">dyn</span><span class="p">)</span>
<a name="ln-888"></a>                <span class="k">END IF</span>
<a name="ln-889"></a>
<a name="ln-890"></a>                <span class="c">! Note that the first and last layers in a row are slightly different</span>
<a name="ln-891"></a>                <span class="c">! from the rest since they are on an adiabatic plane in the direction</span>
<a name="ln-892"></a>                <span class="c">! perpendicular to the main direction of heat transfer.</span>
<a name="ln-893"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-894"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-895"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-896"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-897"></a>
<a name="ln-898"></a>                <span class="k">DO </span><span class="n">NodeInRow</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-899"></a>                  <span class="n">Node2</span> <span class="o">=</span> <span class="n">Node</span> <span class="o">+</span> <span class="n">NodeInRow</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-900"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-901"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-902"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-903"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-904"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-905"></a>                <span class="k">END DO</span>
<a name="ln-906"></a>
<a name="ln-907"></a><span class="k">                </span><span class="n">Node2</span> <span class="o">=</span> <span class="n">Node</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-908"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-909"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-910"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-911"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-912"></a>
<a name="ln-913"></a>              <span class="k">ELSE</span>  <span class="c">! Row at a two-layer interface (half of node consists of one layer&#39;s materials</span>
<a name="ln-914"></a>                    <span class="c">! and the other half consist of the next layer&#39;s materials)</span>
<a name="ln-915"></a>                <span class="n">capavg</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">+</span><span class="n">rho</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cp</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-916"></a>                <span class="n">amatx</span>  <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">capavg</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">))</span>
<a name="ln-917"></a>                <span class="n">amatxx</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">capavg</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-918"></a>                <span class="n">amaty</span>  <span class="o">=</span> <span class="p">(</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="p">)</span><span class="o">+</span><span class="n">rk</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">(</span><span class="n">Layer</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">capavg</span><span class="o">*</span><span class="n">dyn</span><span class="o">*</span><span class="n">dyn</span><span class="p">)</span>
<a name="ln-919"></a>
<a name="ln-920"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>                   <span class="o">=-</span><span class="n">amatx</span><span class="o">-</span><span class="n">amatxx</span><span class="o">-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-921"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-922"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-923"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatxx</span>
<a name="ln-924"></a>
<a name="ln-925"></a>                <span class="k">DO </span><span class="n">NodeInRow</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-926"></a>                  <span class="n">Node2</span> <span class="o">=</span> <span class="n">Node</span> <span class="o">+</span> <span class="n">NodeInRow</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-927"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-928"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="p">)</span>                   <span class="o">=-</span><span class="n">amatx</span><span class="o">-</span><span class="n">amatxx</span><span class="o">-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-929"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-930"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-931"></a>                  <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatxx</span>
<a name="ln-932"></a>                <span class="k">END DO</span>
<a name="ln-933"></a>
<a name="ln-934"></a><span class="k">                </span><span class="n">Node2</span> <span class="o">=</span> <span class="n">Node</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-935"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="p">)</span>                   <span class="o">=-</span><span class="n">amatx</span><span class="o">-</span><span class="n">amatxx</span><span class="o">-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-936"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-937"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-938"></a>                <span class="n">AMat</span><span class="p">(</span><span class="n">Node2</span><span class="p">,</span><span class="n">Node2</span><span class="o">+</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatxx</span>
<a name="ln-939"></a>
<a name="ln-940"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span> <span class="o">==</span> <span class="n">NodeSource</span><span class="p">)</span> <span class="n">BMat</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">/</span><span class="n">capavg</span>
<a name="ln-941"></a>                <span class="n">NodeInLayer</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-942"></a>                <span class="n">Layer</span>       <span class="o">=</span> <span class="n">Layer</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-943"></a>
<a name="ln-944"></a>              <span class="k">END IF</span>
<a name="ln-945"></a><span class="k">              </span><span class="n">NodeInLayer</span> <span class="o">=</span> <span class="n">NodeInLayer</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-946"></a>
<a name="ln-947"></a>            <span class="k">END DO</span>
<a name="ln-948"></a>
<a name="ln-949"></a>            <span class="c">! LAST ROW OF NODES: Like the first row of nodes, this row is exposed to a boundary</span>
<a name="ln-950"></a>            <span class="c">! condition and thus has slightly modified nodal equations.</span>
<a name="ln-951"></a>
<a name="ln-952"></a>            <span class="c">! As with the 1-D solution, we are accounting for the thermal mass</span>
<a name="ln-953"></a>            <span class="c">! of the half-node at the surface by adding it to the first row</span>
<a name="ln-954"></a>            <span class="c">! of interior nodes at both sides of the construction.  This is not</span>
<a name="ln-955"></a>            <span class="c">! exact, but it does take all of the thermal mass into account.</span>
<a name="ln-956"></a>            <span class="n">amatx</span> <span class="o">=</span> <span class="n">amatx</span><span class="o">/</span><span class="mf">1.5d0</span>
<a name="ln-957"></a>            <span class="n">amaty</span> <span class="o">=</span> <span class="n">amaty</span><span class="o">/</span><span class="mf">1.5d0</span>
<a name="ln-958"></a>
<a name="ln-959"></a>            <span class="n">Node</span> <span class="o">=</span> <span class="n">rcmax</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-960"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-961"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-962"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-963"></a>
<a name="ln-964"></a>            <span class="k">DO </span><span class="n">Node</span> <span class="o">=</span> <span class="n">rcmax</span><span class="o">+</span><span class="mi">2</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">,</span> <span class="n">rcmax</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-965"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-966"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-967"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="n">amaty</span>
<a name="ln-968"></a>              <span class="n">AMat</span><span class="p">(</span><span class="n">Node</span><span class="p">,</span><span class="n">Node</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-969"></a>            <span class="k">END DO</span>
<a name="ln-970"></a>
<a name="ln-971"></a><span class="k">            </span><span class="n">AMat</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">)</span>                   <span class="o">=-</span><span class="mf">2.0d0</span><span class="o">*</span><span class="p">(</span><span class="n">amatx</span><span class="o">+</span><span class="n">amaty</span><span class="p">)</span>
<a name="ln-972"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>                 <span class="o">=</span> <span class="mf">2.0d0</span><span class="o">*</span><span class="n">amaty</span>
<a name="ln-973"></a>            <span class="n">AMat</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-974"></a>
<a name="ln-975"></a>            <span class="n">BMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">amatx</span>
<a name="ln-976"></a>
<a name="ln-977"></a>            <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=-</span><span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-978"></a>            <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-979"></a>
<a name="ln-980"></a>            <span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">rk</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-981"></a>            <span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=-</span><span class="n">rk</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span><span class="p">(</span><span class="n">LayersInConstruct</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-982"></a>
<a name="ln-983"></a>          <span class="k">END IF</span>
<a name="ln-984"></a>
<a name="ln-985"></a>          <span class="c">! Calculation of the CTFs based on the state space</span>
<a name="ln-986"></a>          <span class="c">! method.  This process involves finding the exponential</span>
<a name="ln-987"></a>          <span class="c">! and inverse of AMat and using these results to</span>
<a name="ln-988"></a>          <span class="c">! determine the CTFs.  The Gammas are an intermediate</span>
<a name="ln-989"></a>          <span class="c">! calculations which are necessary before the CTFs can</span>
<a name="ln-990"></a>          <span class="c">! be computed in TransFuncCoeffs.</span>
<a name="ln-991"></a>          <span class="k">CALL </span><span class="n">DisplayNumberAndString</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">,</span><span class="s1">&#39;Calculating CTFs for &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;, Construction #&#39;</span><span class="p">)</span>
<a name="ln-992"></a>
<a name="ln-993"></a><span class="c">!          CALL DisplayNumberandString(ConstrNum,&#39;Matrix exponential for Construction #&#39;)</span>
<a name="ln-994"></a>          <span class="k">CALL </span><span class="n">CalculateExponentialMatrix</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="p">)</span>           <span class="c">! Compute exponential of AMat</span>
<a name="ln-995"></a>
<a name="ln-996"></a><span class="c">!          CALL DisplayNumberandString(ConstrNum,&#39;Invert Matrix for Construction #&#39;)</span>
<a name="ln-997"></a>          <span class="k">CALL </span><span class="n">CalculateInverseMatrix</span>   <span class="c">! Compute inverse of AMat</span>
<a name="ln-998"></a>
<a name="ln-999"></a><span class="c">!          CALL DisplayNumberandString(ConstrNum,&#39;Gamma calculation for Construction #&#39;)</span>
<a name="ln-1000"></a>          <span class="k">CALL </span><span class="n">CalculateGammas</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span><span class="p">)</span>
<a name="ln-1001"></a>                              <span class="c">! Compute &quot;gamma&quot;s from AMat, AExp, and AInv</span>
<a name="ln-1002"></a>
<a name="ln-1003"></a><span class="c">!          CALL DisplayNumberandString(ConstrNum,&#39;Compute CTFs for Construction #&#39;)</span>
<a name="ln-1004"></a>          <span class="k">CALL </span><span class="n">CalculateCTFs</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SolutionDimensions</span><span class="p">)</span>  <span class="c">! Compute CTFs</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>          <span class="c">! Now check to see if the number of transfer functions</span>
<a name="ln-1007"></a>          <span class="c">! is greater than MaxCTFTerms.  If it is, then increase the</span>
<a name="ln-1008"></a>          <span class="c">! time step and the number of history terms and</span>
<a name="ln-1009"></a>          <span class="c">! recalculate.  Whether or not it will be necessary to</span>
<a name="ln-1010"></a>          <span class="c">! recalculate the CTFs is controlled by this DO WHILE</span>
<a name="ln-1011"></a>          <span class="c">! loop and the logical CTFConvrg.</span>
<a name="ln-1012"></a>
<a name="ln-1013"></a>          <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>        <span class="c">! Assume solution convergence</span>
<a name="ln-1014"></a>
<a name="ln-1015"></a>          <span class="c">! If too many terms, then solution did not converge.  Increase the</span>
<a name="ln-1016"></a>          <span class="c">! number of histories and the time step.  Reset CTFConvrg to continue</span>
<a name="ln-1017"></a>          <span class="c">! the DO loop.</span>
<a name="ln-1018"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">MaxCTFTerms</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1019"></a><span class="k">            </span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1020"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="p">&amp;</span>
<a name="ln-1021"></a>                                                <span class="o">+</span><span class="n">TimeStepZone</span>
<a name="ln-1022"></a>            <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1023"></a>          <span class="k">END IF</span>
<a name="ln-1024"></a>
<a name="ln-1025"></a>          <span class="c">! If the number of terms is okay, then do a further check on the summation of</span>
<a name="ln-1026"></a>          <span class="c">! the various series summations.  In theory, Sum(Xi) = Sum(Yi) = Sum(Zi).  If</span>
<a name="ln-1027"></a>          <span class="c">! this is not the case, then the terms have not reached a valid solution, and</span>
<a name="ln-1028"></a>          <span class="c">! we need to increase the number of histories and the time step as above.</span>
<a name="ln-1029"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CTFConvrg</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1030"></a><span class="k">            </span><span class="n">SumXi</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1031"></a>            <span class="n">SumYi</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1032"></a>            <span class="n">SumZi</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1033"></a>            <span class="k">DO </span><span class="n">HistTerm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span>
<a name="ln-1034"></a>              <span class="n">SumXi</span> <span class="o">=</span> <span class="n">SumXi</span> <span class="o">+</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1035"></a>              <span class="n">SumYi</span> <span class="o">=</span> <span class="n">SumYi</span> <span class="o">+</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1036"></a>              <span class="n">SumZi</span> <span class="o">=</span> <span class="n">SumZi</span> <span class="o">+</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1037"></a>            <span class="k">END DO</span>
<a name="ln-1038"></a><span class="k">            </span><span class="n">SumXi</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SumXi</span><span class="p">)</span>
<a name="ln-1039"></a>            <span class="n">SumYi</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SumYi</span><span class="p">)</span>
<a name="ln-1040"></a>            <span class="n">SumZi</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SumZi</span><span class="p">)</span>
<a name="ln-1041"></a>            <span class="n">BiggestSum</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">SumXi</span><span class="p">,</span><span class="n">SumYi</span><span class="p">,</span><span class="n">SumZi</span><span class="p">)</span>
<a name="ln-1042"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">BiggestSum</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1043"></a><span class="k">              IF</span> <span class="p">(</span> <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SumXi</span><span class="o">-</span><span class="n">SumYi</span><span class="p">)</span><span class="o">/</span><span class="n">BiggestSum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxAllowedCTFSumError</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1044"></a>                   <span class="p">((</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SumZi</span><span class="o">-</span><span class="n">SumYi</span><span class="p">)</span><span class="o">/</span><span class="n">BiggestSum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">MaxAllowedCTFSumError</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1045"></a><span class="k">                </span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1046"></a>                <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">+</span> <span class="n">TimeStepZone</span>
<a name="ln-1047"></a>                <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1048"></a>              <span class="k">END IF</span>
<a name="ln-1049"></a><span class="k">            ELSE</span>    <span class="c">! Something terribly wrong--the surface has no CTFs, not even an R-value</span>
<a name="ln-1050"></a>              <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Illegal construction definition, no CTFs calculated for &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1051"></a>            <span class="k">END IF</span>
<a name="ln-1052"></a><span class="k">          END IF</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>          <span class="c">! Once the time step has reached a certain point, it is highly likely that</span>
<a name="ln-1055"></a>          <span class="c">! there is either a problem with the input or the solution.  This should</span>
<a name="ln-1056"></a>          <span class="c">! be extremely rare since other checks should flag most bad user input.</span>
<a name="ln-1057"></a>          <span class="c">! Thus, if the time step reaches a certain point, error out and let the</span>
<a name="ln-1058"></a>          <span class="c">! user know that something needs to be checked in the input file.</span>
<a name="ln-1059"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span> <span class="o">&gt;=</span> <span class="n">MaxAllowedTimeStep</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1060"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;CTF calculation convergence problem for Construction=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-1061"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...with Materials (outside layer to inside)&#39;</span><span class="p">)</span>
<a name="ln-1062"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;(outside)=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1063"></a>            <span class="k">DO </span><span class="n">Layer</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1064"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">Layer</span> <span class="o">/=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1065"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;(next)=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">))%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1066"></a>              <span class="k">ELSE</span>
<a name="ln-1067"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;(inside)=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">Layer</span><span class="p">))%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1068"></a>              <span class="n">ENDIF</span>
<a name="ln-1069"></a>            <span class="n">ENDDO</span>
<a name="ln-1070"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The Construction report will be produced. This will show more &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1071"></a>                <span class="s1">&#39;details on Constructions and their materials.&#39;</span><span class="p">)</span>
<a name="ln-1072"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Attempts will be made to complete the CTF process but the report may be incomplete.&#39;</span><span class="p">)</span>
<a name="ln-1073"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Constructs reported after this construction may appear to have all 0 CTFs.&#39;</span><span class="p">)</span>
<a name="ln-1074"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The potential causes of this problem are related to the input for the construction&#39;</span><span class="p">)</span>
<a name="ln-1075"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;listed in the severe error above.  The CTF calculate routine is unable to come up&#39;</span><span class="p">)</span>
<a name="ln-1076"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;with a series of CTF terms that have a reasonable time step and this indicates an&#39;</span><span class="p">)</span>
<a name="ln-1077"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;error.  Check the definition of this construction and the materials that make up&#39;</span><span class="p">)</span>
<a name="ln-1078"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;the construction.  Very thin, highly conductive materials may cause problems.&#39;</span><span class="p">)</span>
<a name="ln-1079"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;This may be avoided by ignoring the presence of those materials since they probably&#39;</span><span class="p">)</span>
<a name="ln-1080"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;do not effect the heat transfer characteristics of the construction.  Highly&#39;</span><span class="p">)</span>
<a name="ln-1081"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;conductive or highly resistive layers that are alternated with high mass layers&#39;</span><span class="p">)</span>
<a name="ln-1082"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;may also result in problems.  After confirming that the input is correct and&#39;</span><span class="p">)</span>
<a name="ln-1083"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;realistic, the user should contact the EnergyPlus support team.&#39;</span><span class="p">)</span>
<a name="ln-1084"></a>            <span class="n">DoCTFErrorReport</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1085"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1086"></a>            <span class="k">EXIT</span>
<a name="ln-1087"></a><span class="c">!            CALL ShowFatalError(&#39;Program terminated for reasons listed (InitConductionTransferFunctions) &#39;)</span>
<a name="ln-1088"></a>          <span class="k">END IF</span>
<a name="ln-1089"></a>
<a name="ln-1090"></a><span class="k">        END DO</span>      <span class="c">! ... end of CTF calculation loop.</span>
<a name="ln-1091"></a>
<a name="ln-1092"></a>      <span class="k">END IF</span>        <span class="c">! ... end of IF block for non-reversed constructs.</span>
<a name="ln-1093"></a>
<a name="ln-1094"></a>    <span class="k">ELSE</span>            <span class="c">! Construct has only resistive layers (no thermal mass).</span>
<a name="ln-1095"></a>                    <span class="c">! CTF calculation not necessary, overall resistance</span>
<a name="ln-1096"></a>                    <span class="c">! (R-value) is all that is needed.</span>
<a name="ln-1097"></a>
<a name="ln-1098"></a>          <span class="c">! Set time step for construct to user time step and the number of</span>
<a name="ln-1099"></a>          <span class="c">! inter-time step interpolations to 1</span>
<a name="ln-1100"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span>  <span class="o">=</span> <span class="n">TimeStepZone</span>
<a name="ln-1101"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumHistories</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1102"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">cnd</span>  <span class="c">! CTFs for current time</span>
<a name="ln-1105"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">cnd</span>  <span class="c">! step are set to the</span>
<a name="ln-1106"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>  <span class="n">cnd</span>  <span class="c">! overall conductance</span>
<a name="ln-1107"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">cnd</span>  <span class="c">! of the construction.</span>
<a name="ln-1108"></a>
<a name="ln-1109"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1110"></a>      <span class="n">e</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1111"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1112"></a>      <span class="n">s</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1113"></a>      <span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! CTF temperature</span>
<a name="ln-1114"></a>      <span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! and flux</span>
<a name="ln-1115"></a>      <span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! history terms</span>
<a name="ln-1116"></a>      <span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>  <span class="c">! are all</span>
<a name="ln-1117"></a>      <span class="n">e</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>      <span class="c">! zero.</span>
<a name="ln-1118"></a>
<a name="ln-1119"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1120"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Sources/sinks not allowed in purely resistive constructions --&gt; &#39;</span><span class="o">//</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1121"></a>        <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1122"></a>      <span class="k">END IF</span>
<a name="ln-1123"></a>
<a name="ln-1124"></a><span class="k">      </span><span class="n">RevConst</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>    <span class="c">! In the code that follows, handle a resistive</span>
<a name="ln-1125"></a>                            <span class="c">! layer as a non-reversed construction.</span>
<a name="ln-1126"></a>
<a name="ln-1127"></a>    <span class="k">END IF</span>          <span class="c">! ... end of resistive construction IF block.</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a>          <span class="c">! Transfer the CTFs to the storage arrays for all non-reversed</span>
<a name="ln-1130"></a>          <span class="c">! constructions.  This transfer was done earlier in the routine for</span>
<a name="ln-1131"></a>          <span class="c">! reversed constructions.</span>
<a name="ln-1132"></a>
<a name="ln-1133"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RevConst</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! If this is either a new construction or a non-</span>
<a name="ln-1134"></a>                            <span class="c">! reversed construction, the CTFs must be stored</span>
<a name="ln-1135"></a>                            <span class="c">! in the proper arrays.  If this is a reversed</span>
<a name="ln-1136"></a>                            <span class="c">! construction, nothing further needs to be done.</span>
<a name="ln-1137"></a>
<a name="ln-1138"></a>          <span class="c">! Copy the CTFs into the storage arrays, converting them back to SI</span>
<a name="ln-1139"></a>          <span class="c">! units in the process.  First the &quot;zero&quot; terms and then the history terms...</span>
<a name="ln-1140"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFOutside</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="o">=</span>  <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1141"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFCross</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>     <span class="o">=</span>  <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1142"></a>      <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFInside</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="o">=</span> <span class="o">-</span><span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1143"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1144"></a>          <span class="c">! QTFs...</span>
<a name="ln-1145"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFSourceOut</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1146"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFSourceIn</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1147"></a>          <span class="c">! QTFs for temperature calculation at source/sink location</span>
<a name="ln-1148"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceOut</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1149"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceIn</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1150"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceQ</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>     <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">CFU</span>
<a name="ln-1151"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempAfterLayer</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1152"></a>          <span class="c">! QTFs for user specified interior temperature calculations...</span>
<a name="ln-1153"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserOut</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>     <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1154"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserIn</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1155"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserSource</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">CFU</span>
<a name="ln-1156"></a>        <span class="k">END IF</span>
<a name="ln-1157"></a><span class="k">      END IF</span>
<a name="ln-1158"></a>
<a name="ln-1159"></a><span class="k">      DO </span><span class="n">HistTerm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span>
<a name="ln-1160"></a>          <span class="c">! &quot;REGULAR&quot; CTFs...</span>
<a name="ln-1161"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFOutside</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>   <span class="o">=</span>  <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1162"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFCross</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>     <span class="o">=</span>  <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1163"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFInside</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>    <span class="o">=</span> <span class="o">-</span><span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1164"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HistTerm</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFFlux</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">e</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>
<a name="ln-1165"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1166"></a>          <span class="c">! QTFs...</span>
<a name="ln-1167"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFSourceOut</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1168"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFSourceIn</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>  <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1169"></a>          <span class="c">! QTFs for temperature calculation at source/sink location</span>
<a name="ln-1170"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceOut</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>   <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1171"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceIn</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>    <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1172"></a>          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTSourceQ</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>     <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">CFU</span>
<a name="ln-1173"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TempAfterLayer</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1174"></a>            <span class="c">! QTFs for user specified interior temperature calculations...</span>
<a name="ln-1175"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserOut</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>     <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1176"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserIn</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>      <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1177"></a>            <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">CTFTUserSource</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">)</span>  <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">HistTerm</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">CFU</span>
<a name="ln-1178"></a>          <span class="k">END IF</span>
<a name="ln-1179"></a><span class="k">        END IF</span>
<a name="ln-1180"></a><span class="k">      END DO</span>
<a name="ln-1181"></a>
<a name="ln-1182"></a><span class="k">    END IF</span>          <span class="c">! ... end of the reversed construction IF block.</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a>    <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">UValue</span> <span class="o">=</span> <span class="n">cnd</span><span class="o">*</span><span class="n">CFU</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AExp</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AExp</span><span class="p">)</span>
<a name="ln-1187"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AMat</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AMat</span><span class="p">)</span>
<a name="ln-1188"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AInv</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AInv</span><span class="p">)</span>
<a name="ln-1189"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">IdenMatrix</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">IdenMatrix</span><span class="p">)</span>
<a name="ln-1190"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a name="ln-1191"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">)</span>
<a name="ln-1192"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">Gamma2</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Gamma2</span><span class="p">)</span>
<a name="ln-1193"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<a name="ln-1194"></a>
<a name="ln-1195"></a>  <span class="k">END DO</span>            <span class="c">! ... end of construction loop.</span>
<a name="ln-1196"></a>
<a name="ln-1197"></a>  <span class="k">CALL </span><span class="n">ReportCTFs</span><span class="p">(</span><span class="n">DoCTFErrorReport</span><span class="p">)</span>
<a name="ln-1198"></a>
<a name="ln-1199"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1200"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Program terminated for reasons listed (InitConductionTransferFunctions)&#39;</span><span class="p">)</span>
<a name="ln-1201"></a>  <span class="n">ENDIF</span>
<a name="ln-1202"></a>
<a name="ln-1203"></a>  <span class="k">RETURN</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a><span class="k">END SUBROUTINE </span><span class="n">InitConductionTransferFunctions</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a><span class="k">SUBROUTINE </span><span class="n">CalculateExponentialMatrix</span><span class="p">(</span><span class="n">delt</span><span class="p">)</span>
<a name="ln-1208"></a>
<a name="ln-1209"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1210"></a>          <span class="c">!       AUTHOR         Russ Taylor</span>
<a name="ln-1211"></a>          <span class="c">!       DATE WRITTEN   June 1990</span>
<a name="ln-1212"></a>          <span class="c">!       MODIFIED       Dec 1995, Apr 1996, RKS; June 2000 RKS</span>
<a name="ln-1213"></a>          <span class="c">!       RE-ENGINEERED  June 1996, RKS; Nov 1999, LKL;</span>
<a name="ln-1214"></a>
<a name="ln-1215"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1216"></a>          <span class="c">! This subroutine computes the exponential matrix exp(AMat*delt) for</span>
<a name="ln-1217"></a>          <span class="c">! use in the state space method for the calculation of CTFs.</span>
<a name="ln-1218"></a>
<a name="ln-1219"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1220"></a>          <span class="c">! Uses the method of Taylor expansion combined with scaling and</span>
<a name="ln-1221"></a>          <span class="c">! squaring to most efficiently compute the exponential matrix.  The</span>
<a name="ln-1222"></a>          <span class="c">! steps in the procedure are outlined in Seem&#39;s dissertation in</span>
<a name="ln-1223"></a>          <span class="c">! Appendix A, page 128.  Exponential matrix multiplication modified</span>
<a name="ln-1224"></a>          <span class="c">! to take advantage of the characteristic form of AMat.  AMat starts</span>
<a name="ln-1225"></a>          <span class="c">! out as a tri-diagonal matrix.  Each time AMat is raised to a higher</span>
<a name="ln-1226"></a>          <span class="c">! power two extra non-zero diagonals are added.  ExponMatrix now</span>
<a name="ln-1227"></a>          <span class="c">! recognizes this.  This should speed up the calcs somewhat.  Also, a</span>
<a name="ln-1228"></a>          <span class="c">! new cut-off criteria based on the significant figures of double-</span>
<a name="ln-1229"></a>          <span class="c">! precision variables has been added.  The main loop for higher powers</span>
<a name="ln-1230"></a>          <span class="c">! of AMat is now stopped whenever these powers of AMat will no longer</span>
<a name="ln-1231"></a>          <span class="c">! add to the summation (AExp) instead ofstopping potentially at the</span>
<a name="ln-1232"></a>          <span class="c">! artifical limit of AMat**100.</span>
<a name="ln-1233"></a>
<a name="ln-1234"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1235"></a>          <span class="c">! Seem, J.E.  &quot;Modeling of Heat Transfer in Buildings&quot;,</span>
<a name="ln-1236"></a>          <span class="c">!  Department of Mechanical Engineering, University of</span>
<a name="ln-1237"></a>          <span class="c">!  Wisconsin-Madison, 1987.</span>
<a name="ln-1238"></a>          <span class="c">! Strand, R.K. &quot;Testing Design Description for the CTF</span>
<a name="ln-1239"></a>          <span class="c">!  Calculation Code in BEST&quot;, BSO internal document,</span>
<a name="ln-1240"></a>          <span class="c">!  May/June 1996.</span>
<a name="ln-1241"></a>
<a name="ln-1242"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1243"></a>          <span class="c">! none</span>
<a name="ln-1244"></a>
<a name="ln-1245"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a>
<a name="ln-1248"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">delt</span>  <span class="c">! Time step of the resulting CTFs</span>
<a name="ln-1250"></a>
<a name="ln-1251"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DPLimit</span> <span class="o">=</span> <span class="mf">1.0d-20</span>
<a name="ln-1254"></a>          <span class="c">! This argument is nice, but not sure it&#39;s accurate -- LKL Nov 1999.</span>
<a name="ln-1255"></a>          <span class="c">! Parameter set to the significant figures limit of double</span>
<a name="ln-1256"></a>          <span class="c">! precision variables plus a safety factor.- The argument for setting this parameter to 1E-20 involves the</span>
<a name="ln-1257"></a>          <span class="c">! number of significant figures for REAL(r64) variables which is 16 and the largest power to which</span>
<a name="ln-1258"></a>          <span class="c">! AMat will be raised which is 100.  This would be a factor of 1E-18.  A factor of &quot;safety&quot; of another 100</span>
<a name="ln-1259"></a>          <span class="c">! arrives at the value chosen.  It is argued that if one number is 1E-16 larger than a second number, then</span>
<a name="ln-1260"></a>          <span class="c">! adding the second to the first will not effect the first.  However, on the conservative side, there could</span>
<a name="ln-1261"></a>          <span class="c">! be up to 100 numbers which might, added together, still could effect the original number.  Each</span>
<a name="ln-1262"></a>          <span class="c">! successive power of AMat will have terms smaller than the previous power.  Thus, when the ratio between</span>
<a name="ln-1263"></a>          <span class="c">! the terms of the latest power of AMat and the total (AExp) is less than DPLim, all further powers of</span>
<a name="ln-1264"></a>          <span class="c">! AMat will have absolutely no effect on the REAL(r64) value of AExp.  Thus, there is no need to</span>
<a name="ln-1265"></a>          <span class="c">! continue the calculation.  In effect, AExp has &quot;converged&quot;.  In REAL(r64)ity, 1E-16 would probably guarantee</span>
<a name="ln-1266"></a>          <span class="c">! convergence since AMat terms drop off quickly, but the extra powers allows for differences between</span>
<a name="ln-1267"></a>          <span class="c">! computer platforms.</span>
<a name="ln-1268"></a>
<a name="ln-1269"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1270"></a>          <span class="c">! na</span>
<a name="ln-1271"></a>
<a name="ln-1272"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1273"></a>          <span class="c">! na</span>
<a name="ln-1274"></a>
<a name="ln-1275"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">AMatRowNorm</span>      <span class="c">! Row norm for AMat</span>
<a name="ln-1277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">AMatRowNormMax</span>   <span class="c">! Largest row norm for AMat</span>
<a name="ln-1278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">AMat1</span>    <span class="c">! AMat factored by (delt/2^k)</span>
<a name="ln-1279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">AMato</span>    <span class="c">! AMat raised to the previous power (power of AMat1-1)</span>
<a name="ln-1280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">AMatN</span>    <span class="c">! Current value of AMat raised to power n (n = 1,2...)</span>
<a name="ln-1281"></a>  <span class="kt">LOGICAL</span>                                       <span class="kd">::</span> <span class="n">Backup</span>   <span class="c">! Used when numerics get to small in Exponentiation</span>
<a name="ln-1282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">CheckVal</span> <span class="c">! Used to avoid possible overflow from Double-&gt;REAL(r64)-&gt;Integer</span>
<a name="ln-1283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">fact</span>     <span class="c">! Intermediate calculation variable (delt/2^k)</span>
<a name="ln-1284"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">i</span>        <span class="c">! Loop counter</span>
<a name="ln-1285"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">ic</span>       <span class="c">! Loop counter</span>
<a name="ln-1286"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">ict</span>      <span class="c">! Loop counter</span>
<a name="ln-1287"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">idm</span>      <span class="c">! Loop counter</span>
<a name="ln-1288"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">ir</span>       <span class="c">! Loop counter</span>
<a name="ln-1289"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">isq</span>      <span class="c">! Loop counter</span>
<a name="ln-1290"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">j</span>        <span class="c">! Loop counter</span>
<a name="ln-1291"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">k</span>        <span class="c">! Power of 2 which is used to factor AMat</span>
<a name="ln-1292"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">l</span>        <span class="c">! Theoretical power to which the A matrix must be</span>
<a name="ln-1293"></a>                                                            <span class="c">! raised to accurately calculate the exponential matrix</span>
<a name="ln-1294"></a>  <span class="kt">LOGICAL</span>                                       <span class="kd">::</span> <span class="n">SigFigLimit</span>      <span class="c">! Significant figure limit logical, true</span>
<a name="ln-1295"></a>                                                                    <span class="c">! when exponential calculation loop can be exited (i.e.</span>
<a name="ln-1296"></a>                                                                    <span class="c">! the significant figure limit for REAL(r64)</span>
<a name="ln-1297"></a>                                                                    <span class="c">! variables reached)</span>
<a name="ln-1298"></a>
<a name="ln-1299"></a>          <span class="c">! FLOW:</span>
<a name="ln-1300"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AMat1</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1301"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AMato</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1302"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AMatN</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1303"></a>
<a name="ln-1304"></a>  <span class="c">! Subroutine initializations.  AMat is assigned to local variable AMat1 to</span>
<a name="ln-1305"></a>  <span class="c">! avoid the corruption of the original AMat 2-d array.</span>
<a name="ln-1306"></a>  <span class="n">AMat1</span><span class="o">=</span><span class="n">AMat</span>
<a name="ln-1307"></a>
<a name="ln-1308"></a>  <span class="c">!  Other arrays are initialized to zero.</span>
<a name="ln-1309"></a>  <span class="n">AExp</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1310"></a>  <span class="n">AMato</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1311"></a>  <span class="n">AMatN</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-1312"></a>
<a name="ln-1313"></a>
<a name="ln-1314"></a>          <span class="c">! Step 1, page 128 (Seem&#39;s thesis):  Compute the matrix row norm.</span>
<a name="ln-1315"></a>          <span class="c">! See equation (A.3) which states that the matrix row norm is the</span>
<a name="ln-1316"></a>          <span class="c">! maximum summation of the elements in a row of AMat multiplied by</span>
<a name="ln-1317"></a>          <span class="c">! the time step.</span>
<a name="ln-1318"></a>
<a name="ln-1319"></a>  <span class="n">AMatRowNormMax</span> <span class="o">=</span> <span class="mf">0.0D0</span>            <span class="c">! Start of Step 1 ...</span>
<a name="ln-1320"></a>
<a name="ln-1321"></a>  <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1322"></a>
<a name="ln-1323"></a>    <span class="n">AMatRowNorm</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1324"></a>    <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1325"></a>      <span class="n">AMatRowNorm</span> <span class="o">=</span> <span class="n">AMatRowNorm</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AMat1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
<a name="ln-1326"></a>    <span class="k">END DO</span>
<a name="ln-1327"></a>
<a name="ln-1328"></a><span class="k">    </span><span class="n">AMatRowNorm</span> <span class="o">=</span> <span class="n">AMatRowNorm</span><span class="o">*</span><span class="n">delt</span>
<a name="ln-1329"></a>
<a name="ln-1330"></a>    <span class="n">AMatRowNormMax</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">AMatRowNormMax</span><span class="p">,</span><span class="n">AMatRowNorm</span><span class="p">)</span>
<a name="ln-1331"></a>
<a name="ln-1332"></a>  <span class="k">END DO</span>                            <span class="c">! ... end of Step 1.</span>
<a name="ln-1333"></a>
<a name="ln-1334"></a>          <span class="c">! Step 2, page 128:  Find smallest integer k such that</span>
<a name="ln-1335"></a>          <span class="c">! AMatRowNormMax&lt; = 2^k</span>
<a name="ln-1336"></a>
<a name="ln-1337"></a>  <span class="n">k</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="nb">LOG</span><span class="p">(</span><span class="n">AMatRowNormMax</span><span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="mf">2.0D0</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span> <span class="c">!Objexx:Num Handle AMatRowNormMax=0</span>
<a name="ln-1338"></a>
<a name="ln-1339"></a>          <span class="c">! Step 3, page 128:  Divide (AMat*delt) by 2^k.  This section of code</span>
<a name="ln-1340"></a>          <span class="c">! takes advantage of the fact that AMat is tridiagonal.  Thus, it</span>
<a name="ln-1341"></a>          <span class="c">! only factors the elements of the AMat that are known to be non-zero.</span>
<a name="ln-1342"></a>
<a name="ln-1343"></a>  <span class="n">fact</span>  <span class="o">=</span> <span class="n">delt</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0d0</span><span class="o">**</span><span class="n">k</span><span class="p">)</span>   <span class="c">! Start of Step 3 ...</span>
<a name="ln-1344"></a>  <span class="n">AMat1</span> <span class="o">=</span> <span class="n">AMat1</span><span class="o">*</span><span class="n">fact</span>        <span class="c">! ... end of Step 3.</span>
<a name="ln-1345"></a>
<a name="ln-1346"></a>          <span class="c">! Step 4, page 128:  Calculate l, the highest power to which AMat</span>
<a name="ln-1347"></a>          <span class="c">! must be taken theoretically to accurately calculate its exponential.</span>
<a name="ln-1348"></a>          <span class="c">! This is based on a paper by Cadzow and Martens (&quot;Discrete-Time and</span>
<a name="ln-1349"></a>          <span class="c">! Computer Control Systems&quot;,Prentice-Hall, pp. 389-390, 1970).  This</span>
<a name="ln-1350"></a>          <span class="c">! number is now used as the maximum power to which AMat must be</span>
<a name="ln-1351"></a>          <span class="c">! raised in order to calculate the exponential matrix.  A new cut-off</span>
<a name="ln-1352"></a>          <span class="c">! criteria based on the number of significant figures in a double-</span>
<a name="ln-1353"></a>          <span class="c">! precision variable is used as a more practical limit on the</span>
<a name="ln-1354"></a>          <span class="c">! exponentiation algorithm.</span>
<a name="ln-1355"></a>
<a name="ln-1356"></a>  <span class="n">CheckVal</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">3.0d0</span><span class="o">*</span><span class="n">AMatRowNormMax</span><span class="o">+</span><span class="mf">6.d0</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-1357"></a>  <span class="n">l</span>        <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">CheckVal</span><span class="p">)</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>          <span class="c">! Step 5, page 128:  Calculate the exponential.  First, add the</span>
<a name="ln-1360"></a>          <span class="c">! linear term to the identity matrix.</span>
<a name="ln-1361"></a>   <span class="n">AExp</span> <span class="o">=</span> <span class="n">AMat1</span> <span class="o">+</span> <span class="n">IdenMatrix</span>        <span class="c">! Start of Step 5 ...</span>
<a name="ln-1362"></a>
<a name="ln-1363"></a>          <span class="c">! Now, add successive terms to the expansion as per the standard</span>
<a name="ln-1364"></a>          <span class="c">! exponential formula.  AMato contains the last &quot;power&quot; of AMat</span>
<a name="ln-1365"></a>          <span class="c">! which saves the program from having to remultiply the entire power</span>
<a name="ln-1366"></a>          <span class="c">! of AMat each time.  Since this is still the linear power of AMat,</span>
<a name="ln-1367"></a>          <span class="c">! AMat1 is still tridiagonal in nature.</span>
<a name="ln-1368"></a>  <span class="n">AMato</span> <span class="o">=</span> <span class="n">AMat1</span>
<a name="ln-1369"></a>
<a name="ln-1370"></a>  <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c">! Initialize the counter for the following DO loop</span>
<a name="ln-1371"></a>
<a name="ln-1372"></a>          <span class="c">! The following DO WHILE loop continues to raise AMat to successive</span>
<a name="ln-1373"></a>          <span class="c">! powers and add it to the exponential matrix (AExp).</span>
<a name="ln-1374"></a>  <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="c">! Begin power raising loop ...</span>
<a name="ln-1375"></a>
<a name="ln-1376"></a>    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>               <span class="c">! Increment the loop counter</span>
<a name="ln-1377"></a>    <span class="n">SigFigLimit</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! Set the significant factor limit flag</span>
<a name="ln-1378"></a>
<a name="ln-1379"></a>    <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>    <span class="c">! Begin matrix multiplication loop ...</span>
<a name="ln-1380"></a>          <span class="c">! The following matrix multiplication could be &quot;optimized&quot; since</span>
<a name="ln-1381"></a>          <span class="c">! for one-dimensional heat transfer AMat is 3-diagonal, AMat squared</span>
<a name="ln-1382"></a>          <span class="c">! is 5-diagonal, etc.  However, the code can be much simpler if we</span>
<a name="ln-1383"></a>          <span class="c">! ignore this fact and just do a generic matrix multiplication.</span>
<a name="ln-1384"></a>          <span class="c">! For 2-D heat transfer, the number of off-diagonal non-zero terms</span>
<a name="ln-1385"></a>          <span class="c">! is slightly more complicated as well.</span>
<a name="ln-1386"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>
<a name="ln-1387"></a>        <span class="n">AMatN</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1388"></a>        <span class="k">DO </span><span class="n">ict</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>
<a name="ln-1389"></a>          <span class="c">! Make sure the next term won&#39;t cause an underflow.  If it will end up being</span>
<a name="ln-1390"></a>          <span class="c">! so small as to go below TinyLimit, then ignore it since it won&#39;t add anything</span>
<a name="ln-1391"></a>          <span class="c">! to AMatN anyway.</span>
<a name="ln-1392"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AMat1</span><span class="p">(</span><span class="n">ict</span><span class="p">,</span><span class="n">ic</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">TinyLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1393"></a><span class="k">            IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AMato</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ict</span><span class="p">))</span> <span class="o">&gt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="kt">REAL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">*</span><span class="n">TinyLimit</span><span class="o">/</span><span class="n">AMat1</span><span class="p">(</span><span class="n">ict</span><span class="p">,</span><span class="n">ic</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-1394"></a>              <span class="n">AMatN</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AMatN</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">+</span><span class="n">AMato</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ict</span><span class="p">)</span><span class="o">*</span><span class="n">AMat1</span><span class="p">(</span><span class="n">ict</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1395"></a>          <span class="k">END IF</span>
<a name="ln-1396"></a><span class="k">        END DO</span>
<a name="ln-1397"></a><span class="k">      END DO</span>
<a name="ln-1398"></a><span class="k">    END DO</span>          <span class="c">! ... end of matrix multiplication loop.</span>
<a name="ln-1399"></a>
<a name="ln-1400"></a>          <span class="c">! Update AMato and AExp matrices</span>
<a name="ln-1401"></a>    <span class="n">AMato</span> <span class="o">=</span> <span class="n">AMatN</span>
<a name="ln-1402"></a>    <span class="n">AExp</span>  <span class="o">=</span> <span class="n">AExp</span> <span class="o">+</span> <span class="n">AMato</span>
<a name="ln-1403"></a>
<a name="ln-1404"></a>          <span class="c">! The next DO loop tests the significant figures limit criteria to</span>
<a name="ln-1405"></a>          <span class="c">! see if any values in AExp are still changing appreciably.</span>
<a name="ln-1406"></a>    <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>
<a name="ln-1407"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>
<a name="ln-1408"></a>          <span class="c">! Test of limit criteria:</span>
<a name="ln-1409"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">TinyLimit</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Next line divides by AExp entry so it</span>
<a name="ln-1410"></a>                                                <span class="c">! must be checked to avoid dividing by zero.</span>
<a name="ln-1411"></a>          <span class="c">! If the ratio between any current element in the power</span>
<a name="ln-1412"></a>          <span class="c">! of AMat and its corresponding element in AExp is</span>
<a name="ln-1413"></a>          <span class="c">! greater than the number which might effect the overall</span>
<a name="ln-1414"></a>          <span class="c">! exponential matrix based on stability criteria, then</span>
<a name="ln-1415"></a>          <span class="c">! continue raising AMat to another power (SigFigLimit = false).</span>
<a name="ln-1416"></a>
<a name="ln-1417"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AMato</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">/</span><span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">DPLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1418"></a><span class="k">            </span><span class="n">SigFigLimit</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1419"></a>            <span class="k">EXIT</span> <span class="c">! DO loop (anytime SigFigLimit is false, AMat must continue to be raised another power)</span>
<a name="ln-1420"></a>          <span class="k">END IF</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a><span class="k">        ELSE</span>        <span class="c">! There are still elements of AExp which are zero, so</span>
<a name="ln-1423"></a>                    <span class="c">! the raising of AMat to higher powers should continue.</span>
<a name="ln-1424"></a>
<a name="ln-1425"></a>          <span class="n">SigFigLimit</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1426"></a>          <span class="k">EXIT</span> <span class="c">! DO loop (anytime SigFigLimit is false, AMat must continue to be raised another power)</span>
<a name="ln-1427"></a>
<a name="ln-1428"></a>        <span class="k">END IF</span>
<a name="ln-1429"></a><span class="k">      END DO</span>
<a name="ln-1430"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SigFigLimit</span><span class="p">)</span> <span class="k">EXIT</span> <span class="c">! DO loop (anytime SigFigLimit is false, AMat must continue to be raised another power)</span>
<a name="ln-1431"></a>    <span class="k">END DO</span>
<a name="ln-1432"></a>
<a name="ln-1433"></a>          <span class="c">! Compute next term, only if necessary.  If SigFigLimit is still true,</span>
<a name="ln-1434"></a>          <span class="c">! then all of the new terms being added to AExp are too small to</span>
<a name="ln-1435"></a>          <span class="c">! affect it.  Thus, there is no need to continue this do loop further.</span>
<a name="ln-1436"></a>
<a name="ln-1437"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SigFigLimit</span><span class="p">)</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c">! SigFigLimit is still true, set i to maximum possible</span>
<a name="ln-1438"></a>                              <span class="c">! value of l (100).</span>
<a name="ln-1439"></a>
<a name="ln-1440"></a>  <span class="k">END DO</span>            <span class="c">! ... end of power raising loop and Step 5.</span>
<a name="ln-1441"></a>
<a name="ln-1442"></a>          <span class="c">! Step 6, page 128:</span>
<a name="ln-1443"></a>          <span class="c">! Square AExp &quot;k times&quot; to obtain the actual exponential matrix</span>
<a name="ln-1444"></a>          <span class="c">! (remember that AExp was scaled earlier in this routine).</span>
<a name="ln-1445"></a>
<a name="ln-1446"></a>  <span class="k">DO </span><span class="n">isq</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">k</span>      <span class="c">! Begin squaring DO loop and Step 6 ...</span>
<a name="ln-1447"></a>
<a name="ln-1448"></a>          <span class="c">! Use AMato to store the old values of AExp</span>
<a name="ln-1449"></a>    <span class="n">AMato</span>  <span class="o">=</span> <span class="n">AExp</span>
<a name="ln-1450"></a>    <span class="n">Backup</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1451"></a>    <span class="n">AExp</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1452"></a>
<a name="ln-1453"></a>          <span class="c">! Multiply the old value of AExp (AMato) by itself and store in AExp.</span>
<a name="ln-1454"></a>    <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1455"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1456"></a>        <span class="k">DO </span><span class="n">idm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1457"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AMato</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">idm</span><span class="p">)</span><span class="o">*</span><span class="n">AMato</span><span class="p">(</span><span class="n">idm</span><span class="p">,</span><span class="n">ic</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">TinyLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1458"></a><span class="k">            </span><span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">+</span><span class="n">AMato</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">idm</span><span class="p">)</span><span class="o">*</span><span class="n">AMato</span><span class="p">(</span><span class="n">idm</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1459"></a>            <span class="n">Backup</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1460"></a>          <span class="k">END IF</span>
<a name="ln-1461"></a><span class="k">        END DO</span>
<a name="ln-1462"></a><span class="k">      END DO</span>
<a name="ln-1463"></a><span class="k">    END DO</span>
<a name="ln-1464"></a>    <span class="c">! Backup is true when every item of AExp didnt pass the TinyLimit test</span>
<a name="ln-1465"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Backup</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1466"></a><span class="k">      </span><span class="n">AExp</span><span class="o">=</span><span class="n">AMato</span>
<a name="ln-1467"></a>      <span class="k">EXIT</span>
<a name="ln-1468"></a><span class="k">    END IF</span>
<a name="ln-1469"></a>
<a name="ln-1470"></a><span class="k">  END DO</span>            <span class="c">! ... end of squaring loop and Step 6.</span>
<a name="ln-1471"></a>
<a name="ln-1472"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AMat1</span><span class="p">)</span>
<a name="ln-1473"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AMato</span><span class="p">)</span>
<a name="ln-1474"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AMatN</span><span class="p">)</span>
<a name="ln-1475"></a>
<a name="ln-1476"></a>  <span class="k">RETURN</span>            <span class="c">! AExp is now the exponential of AMat.</span>
<a name="ln-1477"></a>
<a name="ln-1478"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateExponentialMatrix</span>
<a name="ln-1479"></a>
<a name="ln-1480"></a><span class="k">SUBROUTINE </span><span class="n">CalculateInverseMatrix</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1483"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-1484"></a>          <span class="c">!       DATE WRITTEN   Dec 1995</span>
<a name="ln-1485"></a>          <span class="c">!       MODIFIED       June 2000 RKS (made routine generic to allow for 2-D solutions)</span>
<a name="ln-1486"></a>          <span class="c">!       RE-ENGINEERED  June 1996, February 1997 RKS</span>
<a name="ln-1487"></a>
<a name="ln-1488"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1489"></a>          <span class="c">! This subroutine computes the inverse of AMat for use</span>
<a name="ln-1490"></a>          <span class="c">! in the calculation of the CTFs.</span>
<a name="ln-1491"></a>
<a name="ln-1492"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1493"></a>          <span class="c">! Uses row elimination to zero the off-diagonal terms of</span>
<a name="ln-1494"></a>          <span class="c">! AMat while performing the same operations on another</span>
<a name="ln-1495"></a>          <span class="c">! matrix which starts as the identity matrix.  Once AMat</span>
<a name="ln-1496"></a>          <span class="c">! has been converted to an identity matrix(I), the other</span>
<a name="ln-1497"></a>          <span class="c">! matrix which started as the I will then be the inverse</span>
<a name="ln-1498"></a>          <span class="c">! of A.  This algorithm has been customized for a</span>
<a name="ln-1499"></a>          <span class="c">! tri-diagonal matrix.</span>
<a name="ln-1500"></a>
<a name="ln-1501"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1502"></a>          <span class="c">! Any linear algebra test (this is a generic routine).</span>
<a name="ln-1503"></a>
<a name="ln-1504"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1505"></a>          <span class="c">! none</span>
<a name="ln-1506"></a>
<a name="ln-1507"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1508"></a>
<a name="ln-1509"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1510"></a>          <span class="c">! na</span>
<a name="ln-1511"></a>
<a name="ln-1512"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1513"></a>          <span class="c">! na</span>
<a name="ln-1514"></a>
<a name="ln-1515"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1516"></a>          <span class="c">! na</span>
<a name="ln-1517"></a>
<a name="ln-1518"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1519"></a>          <span class="c">! na</span>
<a name="ln-1520"></a>
<a name="ln-1521"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1522"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">AMat1</span>  <span class="c">! Intermediate calculation matrix equivalent at first to AMat</span>
<a name="ln-1523"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">ic</span>     <span class="c">! Loop counter</span>
<a name="ln-1524"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">ir</span>     <span class="c">! Loop counter</span>
<a name="ln-1525"></a>  <span class="kt">INTEGER</span>                                       <span class="kd">::</span> <span class="n">irr</span>    <span class="c">! Loop counter</span>
<a name="ln-1526"></a>
<a name="ln-1527"></a>          <span class="c">! FLOW:</span>
<a name="ln-1528"></a>
<a name="ln-1529"></a>          <span class="c">! Subroutine initializations ...</span>
<a name="ln-1530"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">AMat1</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1531"></a>
<a name="ln-1532"></a>  <span class="n">AMat1</span> <span class="o">=</span> <span class="n">AMat</span>          <span class="c">! Set AMat1 = AMat to avoid AMat changes</span>
<a name="ln-1533"></a>  <span class="n">AInv</span>  <span class="o">=</span> <span class="n">IdenMatrix</span>    <span class="c">! Set AInv to Identity Matrix</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a>          <span class="c">! Use Gaussian elimination to zero all of the elements of AMat left</span>
<a name="ln-1536"></a>          <span class="c">! of the diagonal.</span>
<a name="ln-1537"></a>          <span class="c">! This DO loop will cycle through each of the rows in AMat except the</span>
<a name="ln-1538"></a>          <span class="c">! last row which is handled later because it does not have to be used</span>
<a name="ln-1539"></a>          <span class="c">! to eliminate any other rows.  The index ir is the current row</span>
<a name="ln-1540"></a>          <span class="c">! number and also the column of the current diagonal element.</span>
<a name="ln-1541"></a>
<a name="ln-1542"></a>  <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span><span class="o">-</span><span class="mi">1</span>    <span class="c">! Begin forward elimination loop ...</span>
<a name="ln-1543"></a>
<a name="ln-1544"></a>          <span class="c">! Factor all of the elements of the row being used to zero the next</span>
<a name="ln-1545"></a>          <span class="c">! row in both AMat and AInv by the diagonal element of this row.</span>
<a name="ln-1546"></a>          <span class="c">! We should only need to factor the elements to the right of the</span>
<a name="ln-1547"></a>          <span class="c">! diagonal since those to the right of it should be zero.</span>
<a name="ln-1548"></a>    <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>
<a name="ln-1549"></a>      <span class="n">AMat1</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AMat1</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">/</span><span class="n">AMat1</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
<a name="ln-1550"></a>    <span class="k">END DO</span>
<a name="ln-1551"></a>
<a name="ln-1552"></a>          <span class="c">! In the forward elimination process, all the elements in AInv to the</span>
<a name="ln-1553"></a>          <span class="c">! right of the diagonal are zero so they do not need to be factored.</span>
<a name="ln-1554"></a>    <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span>
<a name="ln-1555"></a>      <span class="n">AInv</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AInv</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">/</span><span class="n">AMat1</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
<a name="ln-1556"></a>    <span class="k">END DO</span>
<a name="ln-1557"></a>
<a name="ln-1558"></a><span class="k">    </span><span class="n">AMat1</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>      <span class="c">! By definition, the diagonal of AMat is now 1.</span>
<a name="ln-1559"></a>
<a name="ln-1560"></a>          <span class="c">! Use this factored row to eliminate the off-diagonal element of the</span>
<a name="ln-1561"></a>          <span class="c">! rows below the current one (ir)...</span>
<a name="ln-1562"></a>
<a name="ln-1563"></a>    <span class="k">DO </span><span class="n">irr</span> <span class="o">=</span> <span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>    <span class="c">! Start of row reduction loop...</span>
<a name="ln-1564"></a>
<a name="ln-1565"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="n">ir</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">rcmax</span>
<a name="ln-1566"></a>        <span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">-</span> <span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="o">*</span><span class="n">AMat1</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1567"></a>      <span class="k">END DO</span>
<a name="ln-1568"></a>
<a name="ln-1569"></a>          <span class="c">! Now, determine the effect on the next row of AInv.  Again, all of</span>
<a name="ln-1570"></a>          <span class="c">! the elements in AInv to the right of the diagonal are zero, so they</span>
<a name="ln-1571"></a>          <span class="c">! can be ignored.</span>
<a name="ln-1572"></a>
<a name="ln-1573"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">ir</span>
<a name="ln-1574"></a>        <span class="n">AInv</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AInv</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">-</span> <span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="o">*</span><span class="n">AInv</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1575"></a>      <span class="k">END DO</span>
<a name="ln-1576"></a>
<a name="ln-1577"></a><span class="k">      </span><span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! By definition, the element to the left of the</span>
<a name="ln-1578"></a>                            <span class="c">! diagonal in the next row of AMat is now zero.</span>
<a name="ln-1579"></a>
<a name="ln-1580"></a>    <span class="k">END DO</span>                  <span class="c">! ...end of row reduction loop</span>
<a name="ln-1581"></a>
<a name="ln-1582"></a>  <span class="k">END DO</span>            <span class="c">! ... end of the forward elimination loop.</span>
<a name="ln-1583"></a>
<a name="ln-1584"></a>          <span class="c">! Factor the last row of AInv by the current value of the last</span>
<a name="ln-1585"></a>          <span class="c">! diagonal element of AMat. After this is done, all of the diagonal</span>
<a name="ln-1586"></a>          <span class="c">! elements of AMat are unity and all of the elements in AMat left of</span>
<a name="ln-1587"></a>          <span class="c">! the diagonal are zero.</span>
<a name="ln-1588"></a>
<a name="ln-1589"></a>  <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1590"></a>    <span class="n">AInv</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AInv</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">/</span><span class="n">AMat1</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">)</span>
<a name="ln-1591"></a>  <span class="k">END DO</span>
<a name="ln-1592"></a><span class="k">  </span><span class="n">AMat1</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-1593"></a>
<a name="ln-1594"></a>          <span class="c">! Now, use back substitution to eliminate the elements to the right</span>
<a name="ln-1595"></a>          <span class="c">! of the diagonal in AMat.  The procedure is similar to the forward</span>
<a name="ln-1596"></a>          <span class="c">! elimination process except that we only have to operate on AInv,</span>
<a name="ln-1597"></a>          <span class="c">! though now all of the columns of AInv may be non-zero.</span>
<a name="ln-1598"></a>
<a name="ln-1599"></a>          <span class="c">! This DO loop will cycle through the remaining rows which are not</span>
<a name="ln-1600"></a>          <span class="c">! yet diagonalized in reverse order.  Note that the only effect on</span>
<a name="ln-1601"></a>          <span class="c">! AMat is that the off-diagonal element is zeroed.  The diagonal</span>
<a name="ln-1602"></a>          <span class="c">! (which has already been set to unity) is not effected by this row</span>
<a name="ln-1603"></a>          <span class="c">! elimination process.</span>
<a name="ln-1604"></a>          <span class="c">! In the following code ir is the column being zeroed and irr is the</span>
<a name="ln-1605"></a>          <span class="c">! row being worked on</span>
<a name="ln-1606"></a>
<a name="ln-1607"></a>  <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="n">rcmax</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>  <span class="c">! Begin reverse elimination loop ...</span>
<a name="ln-1608"></a>    <span class="k">DO </span><span class="n">irr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ir</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1609"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1610"></a>        <span class="n">AInv</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">AInv</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">-</span><span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="o">*</span><span class="n">AInv</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1611"></a>      <span class="k">END DO</span>
<a name="ln-1612"></a><span class="k">      </span><span class="n">AMat1</span><span class="p">(</span><span class="n">irr</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1613"></a>    <span class="k">END DO</span>
<a name="ln-1614"></a><span class="k">  END DO</span>                <span class="c">! ... end of reverse elimination loop.</span>
<a name="ln-1615"></a>
<a name="ln-1616"></a>          <span class="c">! At this point, AMat1 is equal to the identity matrix (I)</span>
<a name="ln-1617"></a>          <span class="c">! and AInv is equal to the inverse of AMat.</span>
<a name="ln-1618"></a>
<a name="ln-1619"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">AMat1</span><span class="p">)</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>  <span class="k">RETURN</span>
<a name="ln-1622"></a>
<a name="ln-1623"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateInverseMatrix</span>
<a name="ln-1624"></a>
<a name="ln-1625"></a><span class="k">SUBROUTINE </span><span class="n">CalculateGammas</span><span class="p">(</span><span class="n">delt</span><span class="p">,</span><span class="n">SolutionDimensions</span><span class="p">)</span>
<a name="ln-1626"></a>
<a name="ln-1627"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1628"></a>          <span class="c">!       AUTHOR         Russ Taylor</span>
<a name="ln-1629"></a>          <span class="c">!       DATE WRITTEN   June 1990</span>
<a name="ln-1630"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1631"></a>          <span class="c">!       RE-ENGINEERED  July 1996, RKS</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1634"></a>          <span class="c">! Compute gammas as defined in Seem&#39;s dissertation.</span>
<a name="ln-1635"></a>          <span class="c">! Runs as a subroutine of the conduction transfer</span>
<a name="ln-1636"></a>          <span class="c">! function solver (InitializeCTFs).</span>
<a name="ln-1637"></a>
<a name="ln-1638"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1639"></a>          <span class="c">! Determine the Gamma1 and Gamma2 based on the results</span>
<a name="ln-1640"></a>          <span class="c">! from the ExponMatrix and InvertMatrix subroutines.</span>
<a name="ln-1641"></a>          <span class="c">! This routine is specialized to take advantage of the</span>
<a name="ln-1642"></a>          <span class="c">! fact that most of BMat consists of zeroes.</span>
<a name="ln-1643"></a>
<a name="ln-1644"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1645"></a>          <span class="c">! The state space method of calculating CTFs is</span>
<a name="ln-1646"></a>          <span class="c">! outlined in the doctoral dissertation of John Seem,</span>
<a name="ln-1647"></a>          <span class="c">! &quot;Modeling of Heat Transfer in Buildings&quot;, Department</span>
<a name="ln-1648"></a>          <span class="c">! of Mechanical Engineering, University of Wisconsin-</span>
<a name="ln-1649"></a>          <span class="c">! Madison, 1987.</span>
<a name="ln-1650"></a>
<a name="ln-1651"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1652"></a>          <span class="c">! none</span>
<a name="ln-1653"></a>
<a name="ln-1654"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1655"></a>
<a name="ln-1656"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1657"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">delt</span>               <span class="c">! Time increment in fraction of an hour</span>
<a name="ln-1658"></a>  <span class="kt">INTEGER</span><span class="p">,</span>          <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolutionDimensions</span> <span class="c">! Integer relating whether a 1- or 2-D solution is required</span>
<a name="ln-1659"></a>
<a name="ln-1660"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1661"></a>          <span class="c">! na</span>
<a name="ln-1662"></a>
<a name="ln-1663"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1664"></a>          <span class="c">! na</span>
<a name="ln-1665"></a>
<a name="ln-1666"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1667"></a>          <span class="c">! na</span>
<a name="ln-1668"></a>
<a name="ln-1669"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">ATemp</span>    <span class="c">! Intermediate variable equal to AExp - I</span>
<a name="ln-1671"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">i</span>          <span class="c">! Loop counter</span>
<a name="ln-1672"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">is1</span>        <span class="c">! Loop counter</span>
<a name="ln-1673"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">j</span>          <span class="c">! Loop counter</span>
<a name="ln-1674"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfNode</span>   <span class="c">! Loop counter</span>
<a name="ln-1675"></a>
<a name="ln-1676"></a>
<a name="ln-1677"></a>          <span class="c">! FLOW:</span>
<a name="ln-1678"></a>
<a name="ln-1679"></a>          <span class="c">! Compute Gamma1 from equation (2.1.12) in Seem&#39;s dissertation which</span>
<a name="ln-1680"></a>          <span class="c">! states that:  Gamma1  =  [AInv] * ([AExp]-[I]) * [BMat]</span>
<a name="ln-1681"></a>          <span class="c">! noting that BMat contains only the non-zero values of the B Matrix.</span>
<a name="ln-1682"></a>
<a name="ln-1683"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ATemp</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1684"></a>  <span class="n">ATemp</span>  <span class="o">=</span> <span class="n">AExp</span> <span class="o">-</span> <span class="n">IdenMatrix</span>
<a name="ln-1685"></a>  <span class="n">Gamma1</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1686"></a>
<a name="ln-1687"></a>  <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1688"></a>
<a name="ln-1689"></a>    <span class="k">DO </span><span class="n">is1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1690"></a>
<a name="ln-1691"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1692"></a><span class="k">        </span><span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="n">ATemp</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">BMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1693"></a>        <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="n">ATemp</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">rcmax</span><span class="p">)</span><span class="o">*</span><span class="n">BMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1694"></a>      <span class="k">ELSE</span>  <span class="c">! SolutionDimensions = 2</span>
<a name="ln-1695"></a>        <span class="k">DO </span><span class="n">SurfNode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-1696"></a>          <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="n">ATemp</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">SurfNode</span><span class="p">)</span><span class="o">*</span><span class="n">BMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1697"></a>          <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="n">ATemp</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">)</span><span class="o">*</span><span class="n">BMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1698"></a>        <span class="k">END DO</span>
<a name="ln-1699"></a><span class="k">      END IF</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1702"></a><span class="k">        </span><span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="n">ATemp</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">NodeSource</span><span class="p">)</span><span class="o">*</span><span class="n">BMat</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1703"></a>      <span class="k">END IF</span>
<a name="ln-1704"></a>
<a name="ln-1705"></a><span class="k">    END DO</span>
<a name="ln-1706"></a>
<a name="ln-1707"></a><span class="k">  END DO</span>
<a name="ln-1708"></a>
<a name="ln-1709"></a><span class="k">  DEALLOCATE</span><span class="p">(</span><span class="n">ATemp</span><span class="p">)</span>
<a name="ln-1710"></a>          <span class="c">! Compute Gamma2 from equation (2.1.13) in Seem&#39;s dissertation which</span>
<a name="ln-1711"></a>          <span class="c">! states that:  Gamma2  =  [AInv] * ([Gamma1]/delt - [BMat])</span>
<a name="ln-1712"></a>          <span class="c">! again noting that BMat contains only the non-zero values of B.</span>
<a name="ln-1713"></a>  <span class="n">Gamma2</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1714"></a>
<a name="ln-1715"></a>  <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a>    <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1718"></a>
<a name="ln-1719"></a>      <span class="k">DO </span><span class="n">is1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1720"></a>
<a name="ln-1721"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1722"></a><span class="k">          IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">is1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1723"></a><span class="k">            </span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="o">-</span><span class="n">BMat</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1724"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">is1</span> <span class="o">==</span> <span class="n">rcmax</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1725"></a><span class="k">            </span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="o">-</span><span class="n">BMat</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1726"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">is1</span> <span class="o">==</span> <span class="n">NodeSource</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1727"></a><span class="k">            </span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="o">-</span><span class="n">BMat</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1728"></a>          <span class="k">ELSE</span>  <span class="c">! the element of the actual BMat is zero</span>
<a name="ln-1729"></a>            <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="p">)</span>
<a name="ln-1730"></a>          <span class="k">END IF</span>
<a name="ln-1731"></a><span class="k">        ELSE</span>    <span class="c">! SolutionDimensions = 2</span>
<a name="ln-1732"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">is1</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">is1</span> <span class="o">&lt;=</span> <span class="n">NumOfPerpendNodes</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1733"></a><span class="k">            </span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="o">-</span><span class="n">BMat</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1734"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">is1</span> <span class="o">&lt;=</span> <span class="n">rcmax</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">is1</span> <span class="o">&gt;=</span> <span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">NumOfPerpendNodes</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1735"></a><span class="k">            </span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="o">-</span><span class="n">BMat</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1736"></a>          <span class="k">ELSE IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">is1</span> <span class="o">==</span> <span class="n">NodeSource</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1737"></a><span class="k">            </span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="o">-</span><span class="n">BMat</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-1738"></a>          <span class="k">ELSE</span>  <span class="c">! the element of the actual BMat is zero</span>
<a name="ln-1739"></a>            <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="n">AInv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">is1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="n">delt</span><span class="p">)</span>
<a name="ln-1740"></a>          <span class="k">END IF</span>
<a name="ln-1741"></a><span class="k">        END IF</span>
<a name="ln-1742"></a>
<a name="ln-1743"></a><span class="k">      END DO</span>
<a name="ln-1744"></a>
<a name="ln-1745"></a><span class="k">    END DO</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a><span class="k">  END DO</span>
<a name="ln-1748"></a>
<a name="ln-1749"></a><span class="k">  RETURN</span>  <span class="c">! The calculation of Gamma1 and Gamma2 is now complete.</span>
<a name="ln-1750"></a>
<a name="ln-1751"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateGammas</span>
<a name="ln-1752"></a>
<a name="ln-1753"></a><span class="k">SUBROUTINE </span><span class="n">CalculateCTFs</span><span class="p">(</span><span class="n">nrf</span><span class="p">,</span><span class="n">SolutionDimensions</span><span class="p">)</span>
<a name="ln-1754"></a>
<a name="ln-1755"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1756"></a>          <span class="c">!       AUTHOR         Russ Taylor</span>
<a name="ln-1757"></a>          <span class="c">!       DATE WRITTEN   June 1990</span>
<a name="ln-1758"></a>          <span class="c">!       MODIFIED       Apr 96, RKS, cosmetic, algorithm neutral changes</span>
<a name="ln-1759"></a>          <span class="c">!       RE-ENGINEERED  July 1996, RKS; Nov 1999, LKL (allocatable arrays)</span>
<a name="ln-1760"></a>
<a name="ln-1761"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1762"></a>          <span class="c">! Subprogram to calculate the Sj and ej coefficients of Seem&#39;s</span>
<a name="ln-1763"></a>          <span class="c">! dissertation.  Follows Seem&#39;s technique to compute the coefficients</span>
<a name="ln-1764"></a>          <span class="c">! in order with minimum storage requirements.</span>
<a name="ln-1765"></a>
<a name="ln-1766"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1767"></a>          <span class="c">! Combine the results of the ExponMatrix, InvertMatrix, and</span>
<a name="ln-1768"></a>          <span class="c">! CalculateGammas routines together to arrive at the temperature</span>
<a name="ln-1769"></a>          <span class="c">! coefficients (s, s0) and the heat flux history coefficients (e) of</span>
<a name="ln-1770"></a>          <span class="c">! the CTFs.  The outline of this subroutine is based on step 5 of</span>
<a name="ln-1771"></a>          <span class="c">! Seem&#39;s suggested implementation of the state space method found on</span>
<a name="ln-1772"></a>          <span class="c">! pages 26+27 of his dissertation.</span>
<a name="ln-1773"></a>
<a name="ln-1774"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1775"></a>          <span class="c">! The state space method of calculating CTFs is outlined in the</span>
<a name="ln-1776"></a>          <span class="c">! doctoral dissertation of John Seem, &quot;Modeling of Heat Transfer in</span>
<a name="ln-1777"></a>          <span class="c">! Buildings&quot;, Department of Mechanical Engineering, University of</span>
<a name="ln-1778"></a>          <span class="c">! Wisconsin-Madison, 1987.  In particular, the equations used for</span>
<a name="ln-1779"></a>          <span class="c">! these calculations are equations (2.1.24) through (2.1.26) in Seem&#39;s</span>
<a name="ln-1780"></a>          <span class="c">! dissertation.</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1783"></a>          <span class="c">! none</span>
<a name="ln-1784"></a>
<a name="ln-1785"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1786"></a>
<a name="ln-1787"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1788"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">nrf</span>                <span class="c">! Number of response factor terms</span>
<a name="ln-1789"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SolutionDimensions</span> <span class="c">! Integer relating whether a 1- or 2-D solution is required</span>
<a name="ln-1790"></a>
<a name="ln-1791"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1792"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ConvrgLim</span> <span class="o">=</span> <span class="mf">1.0d-13</span>   <span class="c">! Convergence limit (ratio) for cutting off the calculation of further</span>
<a name="ln-1793"></a>                                                       <span class="c">! CTFs.  This value was found to give suitable accuracy in IBLAST.</span>
<a name="ln-1794"></a>
<a name="ln-1795"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1796"></a>          <span class="c">! na</span>
<a name="ln-1797"></a>
<a name="ln-1798"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1799"></a>          <span class="c">! na</span>
<a name="ln-1800"></a>
<a name="ln-1801"></a>          <span class="c">! SUBROUTINE DUMMY VARIABLE DECLARATIONS:</span>
<a name="ln-1802"></a>          <span class="c">! na</span>
<a name="ln-1803"></a>
<a name="ln-1804"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1805"></a>
<a name="ln-1806"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">avg</span>       <span class="c">! Intermediate calculation variable (average)</span>
<a name="ln-1807"></a>  <span class="kt">LOGICAL</span>                                              <span class="kd">::</span> <span class="n">CTFConvrg</span> <span class="c">! Set after CTFs are calculated, based on whether there are</span>
<a name="ln-1808"></a>                                                                    <span class="c">! too many CTFs terms</span>
<a name="ln-1809"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">i</span>         <span class="c">! Loop counter</span>
<a name="ln-1810"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">ic</span>        <span class="c">! Loop counter</span>
<a name="ln-1811"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">inum</span>      <span class="c">! Loop counter</span>
<a name="ln-1812"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">ir</span>        <span class="c">! Loop counter</span>
<a name="ln-1813"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="k">is</span>        <span class="c">! Loop counter</span>
<a name="ln-1814"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">is2</span>       <span class="c">! Loop counter</span>
<a name="ln-1815"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">j</span>         <span class="c">! Loop counter</span>
<a name="ln-1816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">PhiR0</span>     <span class="c">! Product of Phi( = AExp) and R0 matrices from the state</span>
<a name="ln-1817"></a>                                                                    <span class="c">! space method</span>
<a name="ln-1818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">rat</span>       <span class="c">! Intermediate calculation variable (ratio of flux history</span>
<a name="ln-1819"></a>                                                                    <span class="c">! terms)</span>
<a name="ln-1820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">Rnew</span>      <span class="c">! Current R matrix</span>
<a name="ln-1821"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span>        <span class="kd">::</span> <span class="n">Rold</span>      <span class="c">! R matrix from the last iteration</span>
<a name="ln-1822"></a>  <span class="kt">INTEGER</span>                                              <span class="kd">::</span> <span class="n">SurfNode</span>  <span class="c">! Loop counter (for nodes at a surface)</span>
<a name="ln-1823"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">SurfNodeFac</span> <span class="c">! Multiplying factor applied to various surface nodes</span>
<a name="ln-1824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                <span class="kd">::</span> <span class="n">trace</span>     <span class="c">! Trace of the product of Phi( = AExp) and R0</span>
<a name="ln-1825"></a>
<a name="ln-1826"></a>          <span class="c">! FLOW:</span>
<a name="ln-1827"></a>
<a name="ln-1828"></a>          <span class="c">! Subroutine initializations</span>
<a name="ln-1829"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">PhiR0</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1830"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Rnew</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1831"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Rold</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">rcmax</span><span class="p">))</span>
<a name="ln-1832"></a>  <span class="n">PhiR0</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1833"></a>  <span class="n">Rold</span>  <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1834"></a>
<a name="ln-1835"></a>  <span class="n">s0</span>   <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1836"></a>  <span class="n">s</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1837"></a>  <span class="n">e</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1838"></a>  <span class="n">Rnew</span> <span class="o">=</span> <span class="n">IdenMatrix</span> <span class="c">! Rnew initialized to the identity matrix</span>
<a name="ln-1839"></a>
<a name="ln-1840"></a>          <span class="c">! Calculate Gamma1-Gamma2.  Gamma1 is not used by itself in the</span>
<a name="ln-1841"></a>          <span class="c">! equations, only Gamma1-Gamma2.  Thus, reset Gamma1 to:</span>
<a name="ln-1842"></a>          <span class="c">! Gamma1-Gamma2</span>
<a name="ln-1843"></a>  <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1844"></a>    <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-1845"></a>      <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1846"></a>    <span class="k">END DO</span>
<a name="ln-1847"></a><span class="k">  END DO</span>
<a name="ln-1848"></a>
<a name="ln-1849"></a>          <span class="c">! Compute s0.  See Seem&#39;s thesis equation (2.1.24) which states that:</span>
<a name="ln-1850"></a>          <span class="c">! s0  =  (CMat*R0*Gamma2) + (DMat)</span>
<a name="ln-1851"></a>          <span class="c">! Note that for a two-dimensional solution, there is more than one</span>
<a name="ln-1852"></a>          <span class="c">! node at the surface and the effect of each of these must be added</span>
<a name="ln-1853"></a>          <span class="c">! together.</span>
<a name="ln-1854"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1855"></a><span class="k">    </span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1856"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1857"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1858"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1859"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1860"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1861"></a>  <span class="k">ELSE</span>  <span class="c">! SolutionDimensions = 2</span>
<a name="ln-1862"></a>    <span class="k">DO </span><span class="n">SurfNode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-1863"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SurfNode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfNode</span> <span class="o">==</span> <span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1864"></a><span class="k">        </span><span class="n">SurfNodeFac</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-1865"></a>      <span class="k">ELSE</span>
<a name="ln-1866"></a><span class="k">        </span><span class="n">SurfNodeFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1867"></a>      <span class="k">END IF</span>
<a name="ln-1868"></a><span class="k">      </span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">SurfNode</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1869"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">SurfNode</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1870"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">SurfNode</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1871"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1872"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1873"></a>      <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1874"></a>    <span class="k">END DO</span>
<a name="ln-1875"></a><span class="k">    </span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1876"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1877"></a>  <span class="k">END IF</span>
<a name="ln-1878"></a>
<a name="ln-1879"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1880"></a><span class="k">    </span><span class="n">s0</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1881"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1882"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1883"></a>  <span class="k">END IF</span>
<a name="ln-1884"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">NodeUserTemp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1885"></a><span class="k">    </span><span class="n">s0</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1886"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1887"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">Gamma2</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1888"></a>  <span class="k">END IF</span>
<a name="ln-1889"></a>
<a name="ln-1890"></a>          <span class="c">! Check for and enforce symmetry in the cross term (Y)</span>
<a name="ln-1891"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-1892"></a><span class="k">    </span><span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">0.5D0</span>
<a name="ln-1893"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">avg</span><span class="o">*</span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s0</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1894"></a>    <span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">avg</span><span class="o">*</span><span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1895"></a>  <span class="k">END IF</span>
<a name="ln-1896"></a>
<a name="ln-1897"></a>          <span class="c">! Compute S&#39;s and e&#39;s from 1 to n-1.  See equations (2.1.25) and</span>
<a name="ln-1898"></a>          <span class="c">! (2.1.26) and Appendix C.</span>
<a name="ln-1899"></a>  <span class="n">inum</span> <span class="o">=</span> <span class="mi">1</span>            <span class="c">! Set history term counter</span>
<a name="ln-1900"></a>  <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Set the convergence logical to false</span>
<a name="ln-1901"></a>
<a name="ln-1902"></a>          <span class="c">! The following DO WHILE loop calculates each successive set of time</span>
<a name="ln-1903"></a>          <span class="c">! history terms until there are rcmax number of history terms or the</span>
<a name="ln-1904"></a>          <span class="c">! latest flux history term is negligibly small compared to the first</span>
<a name="ln-1905"></a>          <span class="c">! flux history term.</span>
<a name="ln-1906"></a>  <span class="k">DO WHILE</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CTFConvrg</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">inum</span> <span class="o">&lt;</span> <span class="n">rcmax</span><span class="p">))</span>   <span class="c">! Begin CTF calculation loop ...</span>
<a name="ln-1907"></a>
<a name="ln-1908"></a>          <span class="c">! Compute e(inum) based on Appendix C (Seem&#39;s dissertation). First,</span>
<a name="ln-1909"></a>          <span class="c">! compute the new PhiR0 and its trace.</span>
<a name="ln-1910"></a>
<a name="ln-1911"></a>    <span class="n">trace</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1912"></a>
<a name="ln-1913"></a>    <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1916"></a>        <span class="n">PhiR0</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-1917"></a>        <span class="k">DO is</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1918"></a>          <span class="c">! Make sure the next term won&#39;t cause an underflow.  If it will end up being</span>
<a name="ln-1919"></a>          <span class="c">! so small as to go below TinyLimit, then ignore it since it won&#39;t add anything</span>
<a name="ln-1920"></a>          <span class="c">! to PhiR0 anyway.</span>
<a name="ln-1921"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Rnew</span><span class="p">(</span><span class="k">is</span><span class="p">,</span><span class="n">ic</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">TinyLimit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1922"></a><span class="k">            IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="k">is</span><span class="p">))</span> <span class="o">&gt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">TinyLimit</span><span class="o">/</span><span class="n">Rnew</span><span class="p">(</span><span class="k">is</span><span class="p">,</span><span class="n">ic</span><span class="p">)))</span> <span class="p">&amp;</span>
<a name="ln-1923"></a>              <span class="n">PhiR0</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">PhiR0</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span><span class="o">+</span><span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="k">is</span><span class="p">)</span><span class="o">*</span><span class="n">Rnew</span><span class="p">(</span><span class="k">is</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1924"></a>          <span class="k">END IF</span>
<a name="ln-1925"></a><span class="k">        END DO</span>
<a name="ln-1926"></a><span class="k">      END DO</span>
<a name="ln-1927"></a>
<a name="ln-1928"></a><span class="k">      </span><span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span> <span class="o">+</span> <span class="n">PhiR0</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a>    <span class="k">END DO</span>
<a name="ln-1931"></a>
<a name="ln-1932"></a>          <span class="c">! Now calculate ej from the trace.  According to Appendix C:</span>
<a name="ln-1933"></a>          <span class="c">! e(j) = -Trace[AExp*R(j-1)]/j</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a>    <span class="n">e</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">trace</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1936"></a>
<a name="ln-1937"></a>          <span class="c">! Update Rold and compute Rnew.  Note:  PhiR0 = AExp*R(j-1) here.</span>
<a name="ln-1938"></a>          <span class="c">! According to Appendix C:  R(j) = AExp*R(j-1) + e(j-1)</span>
<a name="ln-1939"></a>
<a name="ln-1940"></a>    <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1941"></a>      <span class="k">DO </span><span class="n">ic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1942"></a>        <span class="n">Rold</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rnew</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1943"></a>        <span class="n">Rnew</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span> <span class="o">=</span> <span class="n">PhiR0</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ic</span><span class="p">)</span>
<a name="ln-1944"></a>      <span class="k">END DO</span>
<a name="ln-1945"></a><span class="k">      </span><span class="n">Rnew</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span> <span class="o">=</span> <span class="n">Rnew</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span>
<a name="ln-1946"></a>    <span class="k">END DO</span>
<a name="ln-1947"></a>
<a name="ln-1948"></a>          <span class="c">! Compute S(inum) based on eq.(2.1.25) which states:</span>
<a name="ln-1949"></a>          <span class="c">! S(j)  =  CMat*[R(j-1)*(Gamma1-Gamma2)+R(j)*Gamma2]</span>
<a name="ln-1950"></a>          <span class="c">!          + e(j)*DMat</span>
<a name="ln-1951"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1952"></a><span class="k">      DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<a name="ln-1953"></a>        <span class="k">DO </span><span class="n">is2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1954"></a>          <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1955"></a>                                               <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1956"></a>          <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1957"></a>                                               <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1958"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1959"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1960"></a>                                         <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1961"></a>          <span class="k">END IF</span>
<a name="ln-1962"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeUserTemp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1963"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1964"></a>                                         <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1965"></a>          <span class="k">END IF</span>
<a name="ln-1966"></a>
<a name="ln-1967"></a><span class="k">        END DO</span>
<a name="ln-1968"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">j</span> <span class="o">/=</span> <span class="mi">3</span><span class="p">)</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1969"></a>      <span class="k">END DO</span>
<a name="ln-1970"></a><span class="k">    ELSE</span> <span class="c">! SolutionDimensions = 2</span>
<a name="ln-1971"></a>      <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<a name="ln-1972"></a>        <span class="k">DO </span><span class="n">is2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-1973"></a>          <span class="k">DO </span><span class="n">SurfNode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-1974"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SurfNode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfNode</span> <span class="o">==</span> <span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1975"></a><span class="k">              </span><span class="n">SurfNodeFac</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-1976"></a>            <span class="k">ELSE</span>
<a name="ln-1977"></a><span class="k">              </span><span class="n">SurfNodeFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-1978"></a>            <span class="k">END IF</span>
<a name="ln-1979"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">SurfNode</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1980"></a>                                                             <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">SurfNode</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1981"></a>            <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1982"></a>                                                             <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1983"></a>          <span class="k">END DO</span>
<a name="ln-1984"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1985"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1986"></a>                                         <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1987"></a>          <span class="k">END IF</span>
<a name="ln-1988"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeUserTemp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1989"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span> <span class="n">Rold</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1990"></a>                                         <span class="o">+</span><span class="n">Rnew</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma2</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-1991"></a>          <span class="k">END IF</span>
<a name="ln-1992"></a><span class="k">        END DO</span>
<a name="ln-1993"></a><span class="k">      END DO</span>
<a name="ln-1994"></a><span class="k">      </span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1995"></a>      <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-1996"></a>    <span class="k">END IF</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>          <span class="c">! Check for and enforce symmetry in the cross term (Y)</span>
<a name="ln-1999"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2000"></a><span class="k">      </span><span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">0.5D0</span>
<a name="ln-2001"></a>      <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">avg</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2002"></a>      <span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">avg</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">inum</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2003"></a>    <span class="k">END IF</span>
<a name="ln-2004"></a>
<a name="ln-2005"></a>          <span class="c">! Check for convergence of the CTFs.</span>
<a name="ln-2006"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2007"></a>
<a name="ln-2008"></a><span class="k">      </span><span class="n">nrf</span> <span class="o">=</span> <span class="mi">1</span>                   <span class="c">! e(1) is zero, so there are no history terms.</span>
<a name="ln-2009"></a>      <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>        <span class="c">! CTF calculations have converged--set logical.</span>
<a name="ln-2010"></a>
<a name="ln-2011"></a>    <span class="k">ELSE</span>
<a name="ln-2012"></a>          <span class="c">! e(1) is non-zero -- Calculate and compare the ratio of the flux</span>
<a name="ln-2013"></a>          <span class="c">! terms to the convergence limit.</span>
<a name="ln-2014"></a>      <span class="n">rat</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">e</span><span class="p">(</span><span class="n">inum</span><span class="p">)</span><span class="o">/</span><span class="n">e</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2015"></a>
<a name="ln-2016"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">rat</span> <span class="o">&lt;</span> <span class="n">ConvrgLim</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2017"></a>
<a name="ln-2018"></a>          <span class="c">! If the ratio is less than the convergence limit, then any other</span>
<a name="ln-2019"></a>          <span class="c">! terms would have a neglible impact on the CTF-based energy balances.</span>
<a name="ln-2020"></a>        <span class="n">nrf</span> <span class="o">=</span> <span class="n">inum</span>
<a name="ln-2021"></a>        <span class="n">CTFConvrg</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>    <span class="c">! CTF calculations have converged--set logical.</span>
<a name="ln-2022"></a>
<a name="ln-2023"></a>      <span class="k">END IF</span>
<a name="ln-2024"></a><span class="k">    END IF</span>  <span class="c">! ... end of convergence check block.</span>
<a name="ln-2025"></a>
<a name="ln-2026"></a>    <span class="n">inum</span> <span class="o">=</span> <span class="n">inum</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>  <span class="k">END DO</span>    <span class="c">! ... end of CTF calculation loop.</span>
<a name="ln-2029"></a>            <span class="c">! Continue to the next coefficient if the solution has not converged</span>
<a name="ln-2030"></a>                    <span class="c">!</span>
<a name="ln-2031"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CTFConvrg</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Compute last e and S, if still unconverged.</span>
<a name="ln-2032"></a>
<a name="ln-2033"></a>          <span class="c">! Compute e(inum) based on Appendix C (Seem&#39;s dissertation) or see</span>
<a name="ln-2034"></a>          <span class="c">! equation above.  First compute the new PhiR0 and its trace.</span>
<a name="ln-2035"></a>
<a name="ln-2036"></a>    <span class="n">trace</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2037"></a>
<a name="ln-2038"></a>    <span class="k">DO </span><span class="n">ir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-2039"></a>      <span class="k">DO is</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-2040"></a>        <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="o">+</span><span class="n">AExp</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="k">is</span><span class="p">)</span><span class="o">*</span><span class="n">Rnew</span><span class="p">(</span><span class="k">is</span><span class="p">,</span><span class="n">ir</span><span class="p">)</span>
<a name="ln-2041"></a>      <span class="k">END DO</span>
<a name="ln-2042"></a><span class="k">    END DO</span>
<a name="ln-2043"></a>
<a name="ln-2044"></a><span class="k">    </span><span class="n">e</span><span class="p">(</span><span class="n">rcmax</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">trace</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>     <span class="c">! Now calculate ej from the trace.</span>
<a name="ln-2045"></a>
<a name="ln-2046"></a>          <span class="c">! Compute S(inum) based on eq.(2.1.25) which states:</span>
<a name="ln-2047"></a>          <span class="c">!   S(last) = CMat*R(last-1)*(Gamma1-Gamma2)+e(last)*DMat</span>
<a name="ln-2048"></a>
<a name="ln-2049"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SolutionDimensions</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2050"></a><span class="k">      DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<a name="ln-2051"></a>        <span class="k">DO </span><span class="n">is2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-2052"></a>          <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Rnew</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2053"></a>          <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Rnew</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2054"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2055"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rnew</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2056"></a>          <span class="k">END IF</span>
<a name="ln-2057"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeUserTemp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2058"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rnew</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2059"></a>          <span class="k">END IF</span>
<a name="ln-2060"></a><span class="k">        END DO</span>
<a name="ln-2061"></a><span class="k">      END DO</span>
<a name="ln-2062"></a><span class="k">      </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="p">(</span><span class="n">rcmax</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2063"></a>      <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="p">(</span><span class="n">rcmax</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2064"></a>      <span class="n">nrf</span> <span class="o">=</span> <span class="n">rcmax</span>
<a name="ln-2065"></a>    <span class="k">ELSE</span> <span class="c">! SolutionDimensions = 2</span>
<a name="ln-2066"></a>      <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<a name="ln-2067"></a>        <span class="k">DO </span><span class="n">is2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">rcmax</span>
<a name="ln-2068"></a>          <span class="k">DO </span><span class="n">SurfNode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfPerpendNodes</span>
<a name="ln-2069"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">SurfNode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfNode</span> <span class="o">==</span> <span class="n">NumOfPerpendNodes</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2070"></a><span class="k">              </span><span class="n">SurfNodeFac</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-2071"></a>            <span class="k">ELSE</span>
<a name="ln-2072"></a><span class="k">              </span><span class="n">SurfNodeFac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-2073"></a>            <span class="k">END IF</span>
<a name="ln-2074"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Rnew</span><span class="p">(</span><span class="n">SurfNode</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2075"></a>            <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfNodeFac</span><span class="o">*</span><span class="n">CMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Rnew</span><span class="p">(</span><span class="n">rcmax</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">SurfNode</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2076"></a>          <span class="k">END DO</span>
<a name="ln-2077"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeSource</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2078"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rnew</span><span class="p">(</span><span class="n">NodeSource</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2079"></a>          <span class="k">END IF</span>
<a name="ln-2080"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">NodeUserTemp</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2081"></a><span class="k">            </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rnew</span><span class="p">(</span><span class="n">NodeUserTemp</span><span class="p">,</span><span class="n">is2</span><span class="p">)</span><span class="o">*</span><span class="n">Gamma1</span><span class="p">(</span><span class="n">is2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
<a name="ln-2082"></a>          <span class="k">END IF</span>
<a name="ln-2083"></a><span class="k">        END DO</span>
<a name="ln-2084"></a><span class="k">      END DO</span>
<a name="ln-2085"></a><span class="k">      </span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="n">rcmax</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-2086"></a>      <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span><span class="p">(</span><span class="n">rcmax</span><span class="p">)</span><span class="o">*</span><span class="n">DMat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">NumOfPerpendNodes</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-2087"></a>    <span class="k">END IF</span>
<a name="ln-2088"></a>
<a name="ln-2089"></a>          <span class="c">! Check for and enforce symmetry in the cross term (Y)</span>
<a name="ln-2090"></a>
<a name="ln-2091"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">/=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2092"></a><span class="k">      </span><span class="n">avg</span> <span class="o">=</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="o">*</span><span class="mf">0.5D0</span>
<a name="ln-2093"></a>      <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">avg</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2094"></a>      <span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">avg</span><span class="o">*</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">rcmax</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2095"></a>    <span class="k">END IF</span>
<a name="ln-2096"></a>
<a name="ln-2097"></a><span class="k">  END IF</span>    <span class="c">! ... end of IF block for calculation of last e and S.</span>
<a name="ln-2098"></a>
<a name="ln-2099"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">PhiR0</span><span class="p">)</span>
<a name="ln-2100"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Rnew</span><span class="p">)</span>
<a name="ln-2101"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Rold</span><span class="p">)</span>
<a name="ln-2102"></a>
<a name="ln-2103"></a>  <span class="k">RETURN</span>    <span class="c">! The array e and the matrices s and s0 now contain the conduction</span>
<a name="ln-2104"></a>            <span class="c">! transfer functions for this construction.</span>
<a name="ln-2105"></a>
<a name="ln-2106"></a><span class="k">END SUBROUTINE </span><span class="n">CalculateCTFs</span>
<a name="ln-2107"></a>
<a name="ln-2108"></a><span class="k">SUBROUTINE </span><span class="n">ReportCTFs</span><span class="p">(</span><span class="n">DoReportBecauseError</span><span class="p">)</span>
<a name="ln-2109"></a>
<a name="ln-2110"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2111"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-2112"></a>          <span class="c">!       DATE WRITTEN   July 1999</span>
<a name="ln-2113"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2114"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-2115"></a>
<a name="ln-2116"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2117"></a>          <span class="c">! This routine gives a detailed report to the user about</span>
<a name="ln-2118"></a>          <span class="c">! the conduction transfer functions and other thermal data</span>
<a name="ln-2119"></a>          <span class="c">! of each construction.</span>
<a name="ln-2120"></a>
<a name="ln-2121"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2122"></a>          <span class="c">! na</span>
<a name="ln-2123"></a>
<a name="ln-2124"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2125"></a>          <span class="c">! na</span>
<a name="ln-2126"></a>
<a name="ln-2127"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2128"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ScanForReports</span>
<a name="ln-2129"></a>
<a name="ln-2130"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2133"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DoReportBecauseError</span>
<a name="ln-2134"></a>
<a name="ln-2135"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2136"></a>          <span class="c">! na</span>
<a name="ln-2137"></a>
<a name="ln-2138"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2139"></a>          <span class="c">! na</span>
<a name="ln-2140"></a>
<a name="ln-2141"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2142"></a>          <span class="c">! na</span>
<a name="ln-2143"></a>
<a name="ln-2144"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2145"></a><span class="c">!  CHARACTER(len=12),DIMENSION(6)  :: Roughness = (/&#39;VeryRough   &#39;,&#39;Rough       &#39;,&#39;MediumRough &#39;, &amp;</span>
<a name="ln-2146"></a><span class="c">!                                                   &#39;MediumSmooth&#39;,&#39;Smooth      &#39;,&#39;VerySmooth  &#39;/)</span>
<a name="ln-2147"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">DoReport</span>
<a name="ln-2148"></a>
<a name="ln-2149"></a>  <span class="kt">INTEGER </span><span class="n">ThisNum</span>
<a name="ln-2150"></a>  <span class="kt">INTEGER </span><span class="n">Layer</span>
<a name="ln-2151"></a>  <span class="kt">INTEGER </span><span class="n">I</span>
<a name="ln-2152"></a>
<a name="ln-2153"></a>  <span class="k">CALL </span><span class="n">ScanForReports</span><span class="p">(</span><span class="s1">&#39;Constructions&#39;</span><span class="p">,</span><span class="n">DoReport</span><span class="p">,</span><span class="s1">&#39;Constructions&#39;</span><span class="p">)</span>
<a name="ln-2154"></a>
<a name="ln-2155"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DoReport</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">DoReportBecauseError</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2156"></a><span class="c">!</span>
<a name="ln-2157"></a><span class="c">!                                      Write Descriptions</span>
<a name="ln-2158"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Construction CTF&gt;,Construction Name,Index,#Layers,#CTFs,Time Step {hours},&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2159"></a>                             <span class="s1">&#39;ThermalConductance {w/m2-K},&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2160"></a>                             <span class="s1">&#39;OuterThermalAbsorptance,InnerThermalAbsorptance,OuterSolarAbsorptance,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2161"></a>                             <span class="s1">&#39;InnerSolarAbsorptance,Roughness&#39;</span>
<a name="ln-2162"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Material CTF Summary&gt;,Material Name,Thickness {m},Conductivity {w/m-K},Density {kg/m3},&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2163"></a>                             <span class="s1">&#39;Specific Heat {J/kg-K},ThermalResistance {m2-K/w}&#39;</span>
<a name="ln-2164"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;Material:Air&gt;,Material Name,ThermalResistance {m2-K/w}&#39;</span>
<a name="ln-2165"></a>    <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span> <span class="s1">&#39;! &lt;CTF&gt;,Time,Outside,Cross,Inside,Flux (except final one)&#39;</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a>
<a name="ln-2168"></a>    <span class="k">DO </span><span class="n">ThisNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotConstructs</span>
<a name="ln-2169"></a>
<a name="ln-2170"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TypeIsWindow</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2171"></a>
<a name="ln-2172"></a><span class="k">      Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">700</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="n">ThisNum</span><span class="p">,</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2173"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2174"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTimeStep</span><span class="p">,</span>                                                          <span class="p">&amp;</span>
<a name="ln-2175"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">UValue</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">OutsideAbsorpThermal</span><span class="p">,</span>                         <span class="p">&amp;</span>
<a name="ln-2176"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">InsideAbsorpThermal</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span><span class="p">,</span>              <span class="p">&amp;</span>
<a name="ln-2177"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2178"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">DisplayMaterialRoughness</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">OutsideRoughness</span><span class="p">))</span>
<a name="ln-2179"></a><span class="c">!</span>
<a name="ln-2180"></a> <span class="mi">700</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Construction CTF,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="mi">3</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">I4</span><span class="p">),</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">F8</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G15</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">F8</span><span class="p">.</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<a name="ln-2181"></a> <span class="mi">701</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Material CTF Summary,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">F8</span><span class="p">.</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">F14</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">F11</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">F13</span><span class="p">.</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G12</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2182"></a> <span class="mi">702</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Material:Air,&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G12</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2183"></a> <span class="mi">703</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; CTF,&#39;</span><span class="p">,</span><span class="n">I4</span><span class="p">,</span><span class="mi">4</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G20</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2184"></a> <span class="mi">704</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; CTF,&#39;</span><span class="p">,</span><span class="n">I4</span><span class="p">,</span><span class="mi">3</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G20</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2185"></a> <span class="mi">705</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; QTF,&#39;</span><span class="p">,</span><span class="n">I4</span><span class="p">,</span><span class="mi">2</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G20</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2186"></a> <span class="mi">706</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; Source/Sink Loc Internal Temp QTF,&#39;</span><span class="p">,</span><span class="n">I4</span><span class="p">,</span><span class="mi">3</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G20</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2187"></a> <span class="mi">707</span>  <span class="k">FORMAT</span><span class="p">(</span><span class="s1">&#39; User Loc Internal Temp QTF,&#39;</span><span class="p">,</span><span class="n">I4</span><span class="p">,</span><span class="mi">3</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">G20</span><span class="p">.</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a>      <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-2190"></a>        <span class="n">Layer</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2191"></a>        <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Group</span><span class="p">)</span>
<a name="ln-2192"></a>          <span class="k">CASE</span> <span class="p">(</span><span class="n">Air</span><span class="p">)</span>
<a name="ln-2193"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">702</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-2194"></a>          <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-2195"></a>            <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">701</span><span class="p">)</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Thickness</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Conductivity</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2196"></a>                                       <span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Density</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">SpecHeat</span><span class="p">,</span><span class="n">Material</span><span class="p">(</span><span class="n">Layer</span><span class="p">)%</span><span class="n">Resistance</span>
<a name="ln-2197"></a>        <span class="k">END SELECT</span>
<a name="ln-2198"></a><span class="k">      </span><span class="n">ENDDO</span>
<a name="ln-2199"></a>
<a name="ln-2200"></a>      <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2201"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2202"></a><span class="k">          Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">703</span><span class="p">)</span> <span class="n">I</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFOutside</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFCross</span><span class="p">(</span><span class="n">I</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-2203"></a>                                     <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFInside</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFFlux</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2204"></a>        <span class="k">ELSE</span>
<a name="ln-2205"></a><span class="k">          Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">704</span><span class="p">)</span> <span class="n">I</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFOutside</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFCross</span><span class="p">(</span><span class="n">I</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-2206"></a>                                     <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFInside</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2207"></a>        <span class="n">ENDIF</span>
<a name="ln-2208"></a>      <span class="n">ENDDO</span>
<a name="ln-2209"></a>
<a name="ln-2210"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">SourceSinkPresent</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2211"></a>          <span class="c">! QTFs...</span>
<a name="ln-2212"></a>        <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2213"></a>          <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">705</span><span class="p">)</span> <span class="n">I</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFSourceOut</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFSourceIn</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2214"></a>        <span class="k">END DO</span>
<a name="ln-2215"></a>          <span class="c">! QTFs for source/sink location temperature calculation...</span>
<a name="ln-2216"></a>        <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2217"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">706</span><span class="p">)</span> <span class="n">I</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTSourceOut</span><span class="p">(</span><span class="n">I</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2218"></a>                                         <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTSourceIn</span><span class="p">(</span><span class="n">I</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2219"></a>                                         <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTSourceQ</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2220"></a>        <span class="k">END DO</span>
<a name="ln-2221"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">TempAfterLayer</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2222"></a>          <span class="c">! QTFs for user specified interior temperature calculation...</span>
<a name="ln-2223"></a>          <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">NumCTFTerms</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-2224"></a>            <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="mi">707</span><span class="p">)</span> <span class="n">I</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTUserOut</span><span class="p">(</span><span class="n">I</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-2225"></a>                                         <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTUserIn</span><span class="p">(</span><span class="n">I</span><span class="p">),</span>   <span class="p">&amp;</span>
<a name="ln-2226"></a>                                         <span class="n">Construct</span><span class="p">(</span><span class="n">ThisNum</span><span class="p">)%</span><span class="n">CTFTUserSource</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-2227"></a>          <span class="k">END DO</span>
<a name="ln-2228"></a><span class="k">        END IF</span>
<a name="ln-2229"></a><span class="k">      END IF</span>
<a name="ln-2230"></a>
<a name="ln-2231"></a><span class="k">    </span><span class="n">ENDDO</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>  <span class="n">ENDIF</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>  <span class="k">RETURN</span>
<a name="ln-2236"></a>
<a name="ln-2237"></a><span class="k">END SUBROUTINE </span><span class="n">ReportCTFs</span>
<a name="ln-2238"></a>
<a name="ln-2239"></a><span class="c">!     NOTICE</span>
<a name="ln-2240"></a><span class="c">!</span>
<a name="ln-2241"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-2242"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-2243"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-2244"></a><span class="c">!</span>
<a name="ln-2245"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-2246"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-2247"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-2248"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-2249"></a><span class="c">!</span>
<a name="ln-2250"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-2251"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-2252"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-2253"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-2254"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-2255"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-2256"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-2257"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-2258"></a><span class="c">!     permit others to do so.</span>
<a name="ln-2259"></a><span class="c">!</span>
<a name="ln-2260"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-2261"></a><span class="c">!</span>
<a name="ln-2262"></a>
<a name="ln-2263"></a><span class="k">END MODULE </span><span class="n">ConductionTransferFunctionCalc</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
