<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>SolarShading.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>SolarShading.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.6% of total for source files.">6236 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/SolarShading.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">SolarShading.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/solarshading.html">SolarShading</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/solarshading.f90.html#src">SolarShading.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~solarshading.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilesolarshadingf90EfferentGraph" width="641pt" height="2873pt"
 viewBox="0.00 0.00 641.00 2872.84" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~solarshading.f90~~EfferentGraph" class="graph" transform="scale(.1425 .1425) rotate(0) translate(4 20163.0269)">
<title>sourcefile~~solarshading.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-20163.0269 4495.7515,-20163.0269 4495.7515,4 -4,4"/>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~solarshading.f90</title>
<polygon fill="none" stroke="#000000" points="4491.5324,-9307.0054 4399.4107,-9307.0054 4399.4107,-9284.9946 4491.5324,-9284.9946 4491.5324,-9307.0054"/>
<text text-anchor="middle" x="4445.4716" y="-9292.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SolarShading.f90</text>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.0827,-18435.0054 339.1473,-18435.0054 339.1473,-18412.9946 456.0827,-18412.9946 456.0827,-18435.0054"/>
<text text-anchor="middle" x="397.615" y="-18420.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1006" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-20072C1880.3545,-20127.8581 1942.6732,-20077.1522 2161.3169,-20096 2211.6992,-20100.3431 2223.7483,-20112.9237 2274.2329,-20110"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M407.6702,-18435.3006C425.0642,-18455.5255 460.5779,-18499.9309 478.0276,-18544 514.1805,-18635.304 476.5188,-18671.2446 514.0276,-18762 608.7349,-18991.1515 665.3953,-19038.2416 838.259,-19216 901.9066,-19281.4497 935.2108,-19277.7831 1002.022,-19340 1050.2295,-19384.8925 1348.0574,-19737.4878 1392.6204,-19786 1512.0188,-19915.9796 1500.5506,-20016.6053 1668.1278,-20072"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1150.9212,-16208.0054 1039.2876,-16208.0054 1039.2876,-16185.9946 1150.9212,-16185.9946 1150.9212,-16208.0054"/>
<text text-anchor="middle" x="1095.1044" y="-16193.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M920.1405,-16656C937.0967,-16613.6189 977.1398,-16632.2694 1002.022,-16594 1023.0786,-16561.6145 1075.8936,-16295.8628 1091.0059,-16218.2228"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1094.485,-16218.6665 1092.9538,-16208.1829 1087.6132,-16217.3332 1094.485,-16218.6665"/>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M420.8434,-18412.8782C439.8796,-18402.3898 465.6285,-18384.7363 478.0276,-18361 543.5705,-18235.5279 483.8981,-17863.316 514.0276,-17725 549.7757,-17560.8905 611.0463,-17536.0046 651.5354,-17373 685.2916,-17237.1014 637.5066,-17190.7861 687.5354,-17060 719.0565,-16977.5972 769.0109,-16979.7213 802.259,-16898 840.9198,-16802.9748 766.1814,-16743.0018 838.259,-16670 864.1985,-16643.728 906.4262,-16690.2782 920.1405,-16656"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="629.4105,-18188.0054 536.1525,-18188.0054 536.1525,-18165.9946 629.4105,-18165.9946 629.4105,-18188.0054"/>
<text text-anchor="middle" x="582.7815" y="-18173.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge962" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M418.7812,-18412.9554C437.2856,-18402.1864 463.4174,-18384.0753 478.0276,-18361 516.7872,-18299.7834 466.1236,-18256.3598 514.0276,-18202 517.7014,-18197.8311 522.1276,-18194.3569 526.9416,-18191.4618"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="528.6411,-18194.5238 535.9472,-18186.851 525.4509,-18188.293 528.6411,-18194.5238"/>
</g>
<!-- sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~windowcomplexmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/windowcomplexmanager.f90.html" xlink:title="WindowComplexManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2149.8082,-14952.0054 2000.4955,-14952.0054 2000.4955,-14929.9946 2149.8082,-14929.9946 2149.8082,-14952.0054"/>
<text text-anchor="middle" x="2075.1519" y="-14937.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowComplexManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge978" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1869.0623,-15550C1919.2444,-15312.1774 2033.1708,-15038.3055 2066.0884,-14961.7887"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2069.4238,-14962.8937 2070.1806,-14952.3259 2062.9988,-14960.1152 2069.4238,-14962.8937"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M456.1119,-18416.0995C535.5803,-18404.5413 681.5851,-18380.3661 802.259,-18344 1297.3437,-18194.8019 1520.0591,-18131.5644 1749.1377,-17668 1778.2432,-17609.102 1781.2025,-16551.5792 1785.1377,-16486 1810.156,-16069.0811 1782.8302,-15958.6702 1869.0623,-15550"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1931.7964,-2750.0054 1806.3282,-2750.0054 1806.3282,-2727.9946 1931.7964,-2727.9946 1931.7964,-2750.0054"/>
<text text-anchor="middle" x="1869.0623" y="-2735.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1007" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3794.094,-704C3945.4239,-667.75 3971.3247,-560.2665 4124.4445,-588"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1931.6849,-2729.3549C1939.3011,-2726.4896 1946.6255,-2722.7855 1952.9868,-2718 1978.45,-2698.8445 1971.3057,-2682.5082 1988.9868,-2656 2136.4929,-2434.8527 2244.4664,-2423.481 2351.1489,-2180 2387.9221,-2096.0728 2356.2202,-2063.2523 2387.1489,-1977 2510.7811,-1632.2209 2578.8854,-1557.118 2791.6838,-1259 2936.1107,-1056.6666 2998.1494,-1026.769 3163.3396,-841 3253.0566,-740.1064 3242.3537,-669.9803 3365.2148,-614 3488.8732,-557.6565 3542.0046,-569.1455 3670.96,-612 3735.7884,-633.5438 3726.7542,-715.4983 3794.094,-704"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~windowequivalentlayer.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/windowequivalentlayer.f90.html" xlink:title="WindowEquivalentLayer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="4362.9841,-17801.0054 4221.8154,-17801.0054 4221.8154,-17778.9946 4362.9841,-17778.9946 4362.9841,-17801.0054"/>
<text text-anchor="middle" x="4292.3998" y="-17786.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindowEquivalentLayer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1931.6803,-2729.2517C2035.6176,-2709.6335 2243.0031,-2655.2789 2351.1489,-2522 2391.9012,-2471.7769 2366.2797,-2442.2175 2387.1489,-2381 2458.3637,-2172.0994 2457.6278,-2106.0989 2583.7793,-1925 2806.3559,-1605.4763 3584.9976,-896.8398 3972.2545,-856"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge985" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1869.5742,-2750.1441C1875.6122,-2882.1616 1933.3787,-4161.1684 1952.9868,-5196 1955.5144,-5329.3937 1952.2017,-14673.7537 1988.9868,-14802 2002.6311,-14849.5689 2037.6381,-14896.7974 2058.5935,-14922.0982"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2055.9813,-14924.4296 2065.1102,-14929.8067 2061.327,-14919.9104 2055.9813,-14924.4296"/>
</g>
<!-- sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~radiantsystemlowtemp.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/radiantsystemlowtemp.f90.html" xlink:title="RadiantSystemLowTemp.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2540.1139,-9552.0054 2394.8143,-9552.0054 2394.8143,-9529.9946 2540.1139,-9529.9946 2540.1139,-9552.0054"/>
<text text-anchor="middle" x="2467.4641" y="-9537.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RadiantSystemLowTemp.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1870.0571,-2750.2939C1878.219,-2842.7733 1935.2003,-3485.1219 1988.9868,-4006 1999.6784,-4109.5394 2146.33,-5777.2529 2197.3169,-5868 2239.6577,-5943.3586 2312.2389,-5909.814 2351.1489,-5987 2393.0721,-6070.1632 2384.1591,-7569.9154 2387.1489,-7663 2411.705,-8427.5249 2458.6241,-9366.4227 2466.3691,-9519.463"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.8916,-9519.9971 2466.8936,-9529.807 2469.8826,-9519.6425 2462.8916,-9519.9971"/>
</g>
<!-- sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~ventilatedslab.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node63"><a xlink:href="../sourcefile/ventilatedslab.f90.html" xlink:title="VentilatedSlab.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3485.0377,-12360.0054 3388.724,-12360.0054 3388.724,-12337.9946 3485.0377,-12337.9946 3485.0377,-12360.0054"/>
<text text-anchor="middle" x="3436.8809" y="-12345.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VentilatedSlab.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge514" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2075.1519,-2812C2106.1643,-2836.8708 2124.7113,-2803.5035 2161.3169,-2788 2460.246,-2661.3954 2482.8859,-2519.1557 2791.6838,-2419 2986.1993,-2355.9108 3119.6242,-2329.4524 3246.2772,-2490"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1931.757,-2746.9449C1939.1179,-2749.0356 1946.3585,-2751.6732 1952.9868,-2755 1972.3857,-2764.7363 1970.01,-2777.4648 1988.9868,-2788 2023.7433,-2807.2955 2043.6275,-2787.7814 2075.1519,-2812"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node93" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node93"><a xlink:href="../sourcefile/heatbalanceconvectioncoeffs.f90.html" xlink:title="HeatBalanceConvectionCoeffs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2161.4823,-10694.0054 1988.8215,-10694.0054 1988.8215,-10671.9946 2161.4823,-10671.9946 2161.4823,-10694.0054"/>
<text text-anchor="middle" x="2075.1519" y="-10679.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceConvectionCoeffs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge598" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.5594,-2750.1444C1875.4243,-2882.1653 1931.597,-4161.2037 1952.9868,-5196 1964.4821,-5752.1178 1937.761,-9648.1272 1988.9868,-10202 2005.6044,-10381.6759 2054.0883,-10594.8204 2070.0158,-10661.7896"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2066.7068,-10663.0007 2072.4407,-10671.9099 2073.5141,-10661.3696 2066.7068,-10663.0007"/>
</g>
<!-- sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node97" class="node">
<title>sourcefile~photovoltaics.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node97"><a xlink:href="../sourcefile/photovoltaics.f90.html" xlink:title="Photovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2916.6003,-8546.0054 2824.6702,-8546.0054 2824.6702,-8523.9946 2916.6003,-8523.9946 2916.6003,-8546.0054"/>
<text text-anchor="middle" x="2870.6353" y="-8531.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Photovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge772" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-2812C2105.4188,-2836.273 2132.9199,-2799.5637 2161.3169,-2826 2212.1303,-2873.3049 2160.295,-2919.2707 2197.3169,-2978 2220.7317,-3015.1438 2241.0674,-3011.2256 2274.2329,-3040"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node100" class="node">
<title>sourcefile~hvactranspiredcollector.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node100"><a xlink:href="../sourcefile/hvactranspiredcollector.f90.html" xlink:title="HVACTranspiredCollector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2743.804,-10142.0054 2595.6592,-10142.0054 2595.6592,-10119.9946 2743.804,-10119.9946 2743.804,-10142.0054"/>
<text text-anchor="middle" x="2669.7316" y="-10127.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACTranspiredCollector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge750" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2075.1519,-2812C2104.6432,-2837.2097 2133.9441,-2798.5046 2161.3169,-2826 2197.5063,-2862.3516 2189.1077,-3003.3668 2197.3169,-3054 2238.4541,-3307.7276 2320.5843,-3946.7277 2387.1489,-4195 2439.7649,-4391.2467 2510.5758,-4423.2574 2547.7793,-4623 2587.3425,-4835.4118 2577.0503,-8296.04 2583.7793,-8512 2604.1784,-9166.6907 2658.5145,-9968.9282 2668.2331,-10109.4907"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2664.7616,-10110.0248 2668.9452,-10119.7586 2671.7448,-10109.5404 2664.7616,-10110.0248"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="451.915,-4765.0054 343.315,-4765.0054 343.315,-4742.9946 451.915,-4742.9946 451.915,-4765.0054"/>
<text text-anchor="middle" x="397.615" y="-4750.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1008" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M398.9761,-4742.892C406.2057,-4688.9035 445.1183,-4451.88 582.7815,-4338"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-4338C664.6818,-4270.2491 713.5059,-4301.487 802.259,-4243 820.6356,-4230.8901 820.1962,-4221.573 838.259,-4209 904.9035,-4162.6108 958.7122,-4196.6856 1002.022,-4128 1079.9015,-4004.4897 975.1385,-1631.7789 1038.022,-1500 1066.4502,-1440.4257 1122.2966,-1463.8543 1152.1868,-1405 1209.6578,-1291.8385 1130.0839,-947.8384 1188.1868,-835 1232.3619,-749.2099 1289.0023,-766.8417 1356.6204,-698 1472.9691,-579.5458 1457.5565,-507.8377 1587.1179,-404 1851.1721,-192.3724 1935.8384,-76 2274.2329,-76 2274.2329,-76 2274.2329,-76 2467.4641,-76 2813.6036,-76 2900.7411,-56.5713 3246.2772,-77"/>
</g>
<!-- sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~daylightingdevices.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/daylightingdevices.f90.html" xlink:title="DaylightingDevices.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1727.4327,-17500.0054 1608.823,-17500.0054 1608.823,-17477.9946 1727.4327,-17477.9946 1727.4327,-17500.0054"/>
<text text-anchor="middle" x="1668.1278" y="-17485.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingDevices.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M420.9536,-4765.0649C440.0587,-4775.5177 465.8467,-4793.151 478.0276,-4817 525.6706,-4910.2805 461.5248,-5668.3658 514.0276,-5759 550.1593,-5821.3733 601.8899,-5792.7386 651.5354,-5845 746.3012,-5944.7592 920.6633,-6372.4802 1188.1868,-6908 1261.599,-7054.9541 1311.3757,-7079.083 1356.6204,-7237 1382.6041,-7327.6909 1332.1784,-7587.5654 1392.6204,-7660 1439.3837,-7716.0419 1506.6682,-7645.1059 1551.1179,-7703 1633.6784,-7810.5318 1506.4197,-17355.0637 1587.1179,-17464 1590.5129,-17468.583 1594.7362,-17472.3514 1599.4593,-17475.4467"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1597.9721,-17478.6219 1608.4297,-17480.3221 1601.3149,-17472.4716 1597.9721,-17478.6219"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1152.2693,-13280.0054 1037.9395,-13280.0054 1037.9395,-13257.9946 1152.2693,-13257.9946 1152.2693,-13280.0054"/>
<text text-anchor="middle" x="1095.1044" y="-13265.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M421.5347,-4765.1731C440.7228,-4775.5898 466.3176,-4793.1136 478.0276,-4817 518.8616,-4900.2945 509.196,-11403.3607 514.0276,-11496 534.3816,-11886.2652 432.4091,-12949.9733 687.5354,-13246 778.2339,-13351.2387 969.0138,-13308.7914 1053.4183,-13283.1297"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1054.6622,-13286.4082 1063.1703,-13280.0945 1052.5819,-13279.7245 1054.6622,-13286.4082"/>
</g>
<!-- sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~daylightingmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/daylightingmanager.f90.html" xlink:title="DaylightingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="4185.7718,-17801.0054 4063.1171,-17801.0054 4063.1171,-17778.9946 4185.7718,-17778.9946 4185.7718,-17801.0054"/>
<text text-anchor="middle" x="4124.4445" y="-17786.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DaylightingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge929" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M582.7815,-4338C638.299,-4292.0739 674.3839,-4352.8082 744.8972,-4338"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M744.8972,-4338C796.7145,-4327.1181 793.6033,-4292.4483 838.259,-4264 872.5844,-4242.1327 899.5098,-4258.0825 920.1405,-4223"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M920.1405,-4223C943.2795,-4183.6521 981.4133,-4201.7302 1002.022,-4161 1065.9124,-4034.7294 982.8972,-1744.3362 1038.022,-1614 1065.9537,-1547.9586 1122.3126,-1565.1858 1152.1868,-1500 1243.1629,-1301.4893 1093.1479,-1206.598 1188.1868,-1010 1248.2718,-885.7079 1747.5157,-544.0813 1785.1377,-527 2598.1583,-157.8689 2920.0153,-329.6629 3794.094,-512"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="778.266,-11493.0054 711.5284,-11493.0054 711.5284,-11470.9946 778.266,-11470.9946 778.266,-11493.0054"/>
<text text-anchor="middle" x="744.8972" y="-11478.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge955" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M421.5176,-4765.1815C440.6953,-4775.6033 466.2844,-4793.13 478.0276,-4817 532.0439,-4926.7974 493.9981,-9101.2852 514.0276,-9222 545.7638,-9413.2689 616.4603,-9445.3151 651.5354,-9636 685.0949,-9818.4451 678.2862,-10284.7248 687.5354,-10470 707.4084,-10868.0858 737.0182,-11353.9389 743.5791,-11460.6367"/>
<polygon fill="#9900ff" stroke="#9900ff" points="740.0948,-11461.0013 744.2029,-11470.7673 747.0816,-11460.5711 740.0948,-11461.0013"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3406,-9213.0054 533.2224,-9213.0054 533.2224,-9190.9946 632.3406,-9190.9946 632.3406,-9213.0054"/>
<text text-anchor="middle" x="582.7815" y="-9198.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1001" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M421.4737,-4765.2032C440.6245,-4775.6383 466.199,-4793.1722 478.0276,-4817 507.0195,-4875.4019 512.4283,-7098.8175 514.0276,-7164 534.4648,-7996.9729 575.4374,-9020.938 581.9113,-9180.637"/>
<polygon fill="#ff0033" stroke="#ff0033" points="578.4286,-9181.1364 582.3317,-9190.9861 585.4229,-9180.8523 578.4286,-9181.1364"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1525.5948,-7734.0054 1418.1434,-7734.0054 1418.1434,-7711.9946 1525.5948,-7711.9946 1525.5948,-7734.0054"/>
<text text-anchor="middle" x="1471.8691" y="-7719.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M420.9784,-4765.0523C440.099,-4775.4971 465.8959,-4793.126 478.0276,-4817 531.2128,-4921.6635 477.8359,-5761.3162 514.0276,-5873 584.7255,-6091.1665 728.2713,-6083.9271 802.259,-6301 842.4184,-6418.8236 760.4727,-6762.8175 838.259,-6860 885.6544,-6919.2135 943.4695,-6859.7904 1002.022,-6908 1068.1092,-6962.4134 1323.0604,-7513.2468 1356.6204,-7592 1376.1254,-7637.7713 1357.0573,-7663.2045 1392.6204,-7698 1397.2221,-7702.5024 1402.6276,-7706.1948 1408.4168,-7709.2227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1407.216,-7712.5209 1417.7695,-7713.4549 1410.1018,-7706.1435 1407.216,-7712.5209"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~heatbalanceinternalheatgains.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/heatbalanceinternalheatgains.f90.html" xlink:title="HeatBalanceInternalHeatGains.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3881.3623,-16830.0054 3706.8257,-16830.0054 3706.8257,-16807.9946 3881.3623,-16807.9946 3881.3623,-16830.0054"/>
<text text-anchor="middle" x="3794.094" y="-16815.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceInternalHeatGains.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge887" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-1083C3464.1667,-1100.9046 3479.898,-1083.3688 3508.5469,-1099 3562.9528,-1128.6845 3571.8775,-1146.462 3607.7534,-1197"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-1197C3795.7505,-1461.8291 3655.5598,-1600.5926 3670.96,-1925 3747.6041,-3539.5232 3791.9921,-16207.5779 3794.0212,-16797.7011"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3790.5217,-16797.8584 3794.056,-16807.8463 3797.5216,-16797.8343 3790.5217,-16797.8584"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-4338C860.8057,-4313.6586 928.68,-4360.9959 1002.022,-4268 1042.533,-4216.633 1033.1265,-3156.236 1038.022,-3091 1069.944,-2665.6121 1115.8566,-2563.0341 1152.1868,-2138 1158.8289,-2060.2918 1143.2453,-1500.7412 1188.1868,-1437 1234.9003,-1370.7454 1303.0696,-1427.8616 1356.6204,-1367 1396.7896,-1321.3468 1360.4226,-1286.5857 1392.6204,-1235 1571.3069,-948.7167 1682.9371,-907.199 1988.9868,-765 2077.4427,-723.901 2101.0239,-711.5315 2197.3169,-696 2527.7707,-642.6997 2632.4302,-624.9841 2949.5867,-732 2967.5768,-738.0703 2968.3405,-747.0587 2985.5867,-755 3045.3876,-782.5363 3070.1481,-765.3882 3127.3396,-798 3146.1947,-808.7516 3146.3542,-817.4868 3163.3396,-831 3233.3426,-886.6927 3264.0794,-883.6855 3329.2148,-945 3385.8582,-998.3205 3371.8414,-1040.322 3436.8809,-1083"/>
</g>
<!-- sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~delightmanagerf.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/delightmanagerf.f90.html" xlink:title="DElightManagerF.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="4027.3075,-16869.0054 3917.2015,-16869.0054 3917.2015,-16846.9946 4027.3075,-16846.9946 4027.3075,-16869.0054"/>
<text text-anchor="middle" x="3972.2545" y="-16854.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DElightManagerF.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge922" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3794.094,-1046C3824.9955,-1095.8078 3860.3731,-1090.2205 3881.228,-1145 3957.1967,-1344.5468 3971.6456,-16194.1439 3972.2352,-16836.5376"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3968.7353,-16836.7616 3972.2445,-16846.7584 3975.7353,-16836.7552 3968.7353,-16836.7616"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-4223C943.4251,-4183.7381 981.2532,-4201.6488 1002.022,-4161 1043.385,-4080.0439 1031.361,-2615.6665 1038.022,-2525 1067.9198,-2118.0409 1104.8206,-2019.2974 1152.1868,-1614 1169.4151,-1466.5828 1123.9915,-1415.8193 1188.1868,-1282 1378.6007,-885.0695 1563.3738,-811.5383 1988.9868,-699 2161.3589,-653.4223 2209.0747,-658.8894 2387.1489,-650 2420.0337,-648.3584 2750.0354,-650.552 2755.6838,-651 2842.6152,-657.8954 2865.6352,-657.4045 2949.5867,-681 3077.0498,-716.8249 3747.7577,-971.314 3794.094,-1046"/>
</g>
<!-- sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~outputreporttabular.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/outputreporttabular.f90.html" xlink:title="OutputReportTabular.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3671.1672,-12360.0054 3544.3397,-12360.0054 3544.3397,-12337.9946 3671.1672,-12337.9946 3671.1672,-12360.0054"/>
<text text-anchor="middle" x="3607.7534" y="-12345.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportTabular.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge556" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.6234,-4742.7113C429.794,-4724.259 472.3724,-4687.4484 514.0276,-4665 542.5191,-4649.6456 553.2947,-4654.3436 582.7815,-4641"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-4641C660.7709,-4605.7076 664.8026,-4567.2118 744.8972,-4537"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-4537C868.2686,-4490.4641 934.2126,-4502.084 1002.022,-4389 1066.738,-4281.0747 1011.9306,-3380.1068 1038.022,-3257 1065.9713,-3125.1265 1124.5693,-3107.9434 1152.1868,-2976 1182.8149,-2829.6731 1116.0182,-1761.9249 1188.1868,-1631 1235.0415,-1545.9984 1473.549,-1446.3413 1551.1179,-1388 1659.7713,-1306.2795 1662.2382,-1249.1337 1785.1377,-1191 2094.8267,-1044.5115 2211.6406,-1012.8413 2547.7793,-1079 2662.4005,-1101.5597 3450.6155,-1404.5559 3508.5469,-1506 3533.8003,-1550.2215 3543.9634,-8788.0791 3544.5469,-8839 3561.3287,-10303.6415 3602.3063,-12111.7295 3607.2605,-12327.6149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.768,-12327.9851 3607.497,-12337.902 3610.7661,-12327.8241 3603.768,-12327.9851"/>
</g>
<!-- sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~plantpipeheattransfer.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/plantpipeheattransfer.f90.html" xlink:title="PlantPipeHeatTransfer.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2341.5082,-12562.0054 2206.9576,-12562.0054 2206.9576,-12539.9946 2341.5082,-12539.9946 2341.5082,-12562.0054"/>
<text text-anchor="middle" x="2274.2329" y="-12547.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantPipeHeatTransfer.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge613" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M452.0199,-4757.338C510.3441,-4763.9668 601.3095,-4783.6598 651.5354,-4842 708.4653,-4908.1272 630.152,-4969.2659 687.5354,-5035 722.8586,-5075.4637 762.0246,-5037.4159 802.259,-5073 830.256,-5097.761 817.1941,-5118.1259 838.259,-5149 898.1118,-5236.7242 952.8042,-5228.8963 1002.022,-5323 1037.8151,-5391.436 1012.9625,-5419.9475 1038.022,-5493 1075.699,-5602.8345 1116.9916,-5617.3452 1152.1868,-5728 1181.9516,-5821.5816 1154.52,-5853.7503 1188.1868,-5946 1249.1598,-6113.071 1277.9822,-6154.0274 1392.6204,-6290 1526.8448,-6449.2039 1644.4125,-6414.0146 1749.1377,-6594 1791.9227,-6667.5322 1725.9957,-6720.8464 1785.1377,-6782 1838.3107,-6836.9816 1904.9148,-6760.507 1952.9868,-6820 2009.712,-6890.2019 1960.6905,-9983.2948 1988.9868,-10069 2009.4585,-10131.0056 2070.4912,-10122.8689 2075.1519,-10188"/>
</g>
<!-- sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~plantwateruse.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/plantwateruse.f90.html" xlink:title="PlantWaterUse.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2517.202,-6018.0054 2417.7262,-6018.0054 2417.7262,-5995.9946 2517.202,-5995.9946 2517.202,-6018.0054"/>
<text text-anchor="middle" x="2467.4641" y="-6003.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterUse.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge630" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M920.1405,-4641C951.9597,-4620.368 977.2406,-4645.7058 1002.022,-4617 1077.679,-4529.3618 950.681,-4435 1038.022,-4359 1083.31,-4319.5925 1317.6722,-4154.6529 1749.1377,-4360 1878.5908,-4421.6105 1897.0551,-4477.9939 1952.9868,-4610 2006.2384,-4735.6805 1938.4565,-4788.2009 1988.9868,-4915 2036.4044,-5033.9883 2099.331,-5033.909 2161.3169,-5146 2182.7657,-5184.7865 2173.722,-5201.4803 2197.3169,-5239 2250.518,-5323.5982 2305.7261,-5313.9832 2351.1489,-5403 2378.5171,-5456.6345 2447.9471,-5884.5996 2464.0793,-5985.6664"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2460.6347,-5986.2923 2465.6638,-5995.6175 2467.5477,-5985.1915 2460.6347,-5986.2923"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~zoneplenumcomponent.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/zoneplenumcomponent.f90.html" xlink:title="ZonePlenumComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3508.7133,-2064.0054 3365.0484,-2064.0054 3365.0484,-2041.9946 3508.7133,-2041.9946 3508.7133,-2064.0054"/>
<text text-anchor="middle" x="3436.8809" y="-2049.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ZonePlenumComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge713" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.1044,-3271C1101.6171,-3220.2405 1138.4393,-3220.2945 1152.1868,-3171 1173.4604,-3094.719 1145.4245,-1812.6539 1188.1868,-1746 1241.6809,-1662.6183 1892.4756,-1376.3543 1988.9868,-1354 2063.6026,-1336.7172 2086.7341,-1336.5755 2161.3169,-1354 2246.9387,-1374.0034 3021.5946,-1791.4271 3127.3396,-1849 3217.836,-1898.2708 3250.3768,-1896.6542 3329.2148,-1963 3348.5472,-1979.269 3346.3504,-1990.1907 3365.2148,-2007 3377.8605,-2018.268 3393.5402,-2028.6631 3407.006,-2036.71"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3405.5061,-2039.8865 3415.9103,-2041.8876 3409.0249,-2033.8351 3405.5061,-2039.8865"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-4527C954.2405,-4496.6543 981.0754,-4505.5575 1002.022,-4465 1061.7046,-4349.4405 964.3933,-3402.2139 1038.022,-3295 1053.6019,-3272.3135 1091.5893,-3298.2957 1095.1044,-3271"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-4537C817.8897,-4509.4671 861.8625,-4578.8618 920.1405,-4527"/>
</g>
<!-- sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~electricpowermanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/electricpowermanager.f90.html" xlink:title="ElectricPowerManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3123.5288,-8565.0054 2989.3975,-8565.0054 2989.3975,-8542.9946 3123.5288,-8542.9946 3123.5288,-8565.0054"/>
<text text-anchor="middle" x="3056.4631" y="-8550.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge805" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M920.1405,-4527C954.2069,-4496.6166 980.9247,-4505.4793 1002.022,-4465 1098.8425,-4279.2307 958.1527,-3716.663 1038.022,-3523 1066.583,-3453.7466 1123.5762,-3468.233 1152.1868,-3399 1229.3109,-3212.3717 1151.2889,-2689.5367 1188.1868,-2491 1239.7397,-2213.6085 1163.231,-2054.269 1392.6204,-1890 1523.9765,-1795.934 1600.4185,-1897.8696 1749.1377,-1961 2040.2345,-2084.5688 2096.1906,-2152.1056 2387.1489,-2276 2456.984,-2305.7368 2499.7696,-2275.2099 2547.7793,-2334 2617.6711,-2419.5857 2522.8647,-2487.8089 2583.7793,-2580 2633.1331,-2654.6944 2709.5552,-2608.272 2755.6838,-2685 2824.2788,-2799.0973 2737.8418,-3161.2441 2791.6838,-3283 2832.3472,-3374.9543 2911.2429,-3352.0546 2949.5867,-3445 2987.9156,-3537.9093 2982.7,-6962.5365 2985.5867,-7063 3002.8355,-7663.3128 3046.9376,-8398.6097 3055.1395,-8532.5506"/>
<polygon fill="#003fff" stroke="#003fff" points="3051.6571,-8532.9447 3055.7637,-8542.7113 3058.6439,-8532.5155 3051.6571,-8532.9447"/>
</g>
<!-- sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~electricpowergenerators.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/electricpowergenerators.f90.html" xlink:title="ElectricPowerGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2540.6879,-6514.0054 2394.2403,-6514.0054 2394.2403,-6491.9946 2540.6879,-6491.9946 2540.6879,-6514.0054"/>
<text text-anchor="middle" x="2467.4641" y="-6499.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ElectricPowerGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge815" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M920.1405,-4641C952.1317,-4620.6357 974.8271,-4643.4306 1002.022,-4617 1039.2135,-4580.8536 996.0721,-4536.4956 1038.022,-4506 1079.0634,-4476.1648 1103.5222,-4491.6369 1152.1868,-4506 1455.2094,-4595.4359 1515.6079,-4679.1965 1749.1377,-4892 1908.5223,-5037.2388 2330.9106,-5663.9304 2351.1489,-5717 2400.5723,-5846.5996 2367.6038,-5889.6803 2387.1489,-6027 2412.2671,-6203.4749 2451.0882,-6415.2859 2463.5033,-6481.8956"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2460.1072,-6482.7765 2465.3851,-6491.9631 2466.9881,-6481.4903 2460.1072,-6482.7765"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/plantwaterthermaltank.f90.html" xlink:title="PlantWaterThermalTank.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3127.2163,-7054.0054 2985.71,-7054.0054 2985.71,-7031.9946 3127.2163,-7031.9946 3127.2163,-7054.0054"/>
<text text-anchor="middle" x="3056.4631" y="-7039.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterThermalTank.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge857" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M920.1405,-4527C954.2069,-4496.6166 981.0321,-4505.5351 1002.022,-4465 1057.9469,-4356.9993 969.0643,-3471.1828 1038.022,-3371 1069.2302,-3325.6602 1120.8843,-3368.2747 1152.1868,-3323 1213.5853,-3234.1955 1164.6674,-2457.3701 1188.1868,-2352 1229.8518,-2165.3347 1300.1405,-2138.7292 1356.6204,-1956 1380.7127,-1878.0541 1329.5278,-1827.7235 1392.6204,-1776 1528.7495,-1664.4008 2182.5976,-1800.91 2351.1489,-1882 2405.2128,-1908.0101 2518.5531,-2014.6047 2547.7793,-2067 2586.6735,-2136.7277 2540.9457,-2175.6205 2583.7793,-2243 2634.8821,-2323.3873 2696.1967,-2296.6032 2755.6838,-2371 2780.2863,-2401.7688 2766.5338,-2421.6772 2791.6838,-2452 2846.1239,-2517.6372 2909.061,-2485.9691 2949.5867,-2561 2977.9746,-2613.5586 3050.2553,-6690.1031 3056.088,-7021.6211"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.592,-7021.8846 3056.2673,-7031.8216 3059.5909,-7021.7616 3052.592,-7021.8846"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~exteriorenergyusemanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node61"><a xlink:href="../sourcefile/exteriorenergyusemanager.f90.html" xlink:title="ExteriorEnergyUseManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1551.3675,-12670.0054 1392.3708,-12670.0054 1392.3708,-12647.9946 1551.3675,-12647.9946 1551.3675,-12670.0054"/>
<text text-anchor="middle" x="1471.8691" y="-12655.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ExteriorEnergyUseManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M421.0439,-4765.0192C440.2054,-4775.4434 466.0256,-4793.0605 478.0276,-4817 555.234,-4970.9989 428.7959,-6217.2934 514.0276,-6367 549.6913,-6429.6421 615.8703,-6390.3587 651.5354,-6453 694.0705,-6527.7075 671.3346,-7915.5726 687.5354,-8000 763.1306,-8393.9512 924.5252,-8452.4185 1002.022,-8846 1048.9716,-9084.4423 960.4543,-9708.6909 1038.022,-9939 1066.0204,-10022.1314 1124.7331,-10016.6871 1152.1868,-10100 1215.3149,-10291.5732 1158.3581,-11715.5114 1188.1868,-11915 1237.3162,-12243.5688 1161.0828,-12395.7532 1392.6204,-12634 1396.0232,-12637.5015 1399.9114,-12640.514 1404.0971,-12643.1058"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1402.5729,-12646.2592 1413.0466,-12647.8566 1405.855,-12640.0764 1402.5729,-12646.2592"/>
</g>
<!-- sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~pollutionanalysismodule.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node64"><a xlink:href="../sourcefile/pollutionanalysismodule.f90.html" xlink:title="PollutionAnalysisModule.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1344.2308,-14078.0054 1200.5763,-14078.0054 1200.5763,-14055.9946 1344.2308,-14055.9946 1344.2308,-14078.0054"/>
<text text-anchor="middle" x="1272.4036" y="-14063.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PollutionAnalysisModule.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge544" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M421.5421,-4765.1695C440.7346,-4775.584 466.3319,-4793.1067 478.0276,-4817 530.4258,-4924.0452 478.9852,-13284.0865 514.0276,-13398 581.4581,-13617.1985 708.6439,-13616.6413 802.259,-13826 828.8361,-13885.4363 791.9586,-13922.2258 838.259,-13968 921.7694,-14050.5612 977.6911,-14027.8909 1095.1044,-14030"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node74" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node74"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1521.2591,-7504.0054 1422.4792,-7504.0054 1422.4792,-7481.9946 1521.2591,-7481.9946 1521.2591,-7504.0054"/>
<text text-anchor="middle" x="1471.8691" y="-7489.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M419.2838,-4765.1671C437.8584,-4775.9029 463.803,-4793.893 478.0276,-4817 520.7964,-4886.4754 482.2681,-4921.8513 514.0276,-4997 556.0202,-5096.3622 611.2246,-5096.9437 651.5354,-5197 688.2325,-5288.0867 636.576,-5331.056 687.5354,-5415 720.6036,-5469.4724 767.004,-5447.9168 802.259,-5501 838.7565,-5555.9539 819.653,-5581.7085 838.259,-5645 1040.6352,-6333.4155 1190.3635,-6475.9809 1356.6204,-7174 1383.0384,-7284.9143 1336.7285,-7328.6219 1392.6204,-7428 1404.1339,-7448.4716 1424.8421,-7465.1126 1442.2029,-7476.4309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1440.5717,-7479.5383 1450.9098,-7481.8565 1444.2738,-7473.5974 1440.5717,-7479.5383"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node77" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node77"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3115.4049,-10846.0054 2997.5214,-10846.0054 2997.5214,-10823.9946 3115.4049,-10823.9946 3115.4049,-10846.0054"/>
<text text-anchor="middle" x="3056.4631" y="-10831.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-4527C954.223,-4496.6346 980.8184,-4505.4238 1002.022,-4465 1087.5723,-4301.9014 978.5737,-3811.3155 1038.022,-3637 1066.4536,-3553.6323 1122.214,-3557.8262 1152.1868,-3475 1219.8573,-3288.0007 1114.3433,-3213.6488 1188.1868,-3029 1292.8479,-2767.2903 1360.9336,-2704.1862 1587.1179,-2536 1720.7652,-2436.6225 1791.7093,-2413.4423 1952.9868,-2455 2159.8591,-2508.3065 2649.952,-2798.37 2755.6838,-2984 2809.6118,-3078.6796 2723.6296,-3387.9055 2791.6838,-3473 2814.5901,-3501.6418 2865.0879,-3460.747 2870.6353,-3497"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node79" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node79"><a xlink:href="../sourcefile/hvacwatercoilcomponent.f90.html" xlink:title="HVACWaterCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2949.5381,-10352.0054 2791.7324,-10352.0054 2791.7324,-10329.9946 2949.5381,-10329.9946 2949.5381,-10352.0054"/>
<text text-anchor="middle" x="2870.6353" y="-10337.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWaterCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge467" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-4537C784.4026,-4524.1842 796.7363,-4540.1109 838.259,-4541 911.0259,-4542.5581 948.9645,-4590.8232 1002.022,-4541 1048.4441,-4497.4077 1009.1923,-4025.7817 1038.022,-3969 1067.9057,-3910.1424 1117.8858,-3930.3976 1152.1868,-3874 1190.9644,-3810.242 1151.3971,-3774.9254 1188.1868,-3710 1218.2158,-3657.0056 1530.5049,-3356.4747 1587.1179,-3334 1739.0654,-3273.6785 1799.3244,-3316.1915 1952.9868,-3372 2143.8328,-3441.3131 2183.5523,-3481.3795 2351.1489,-3596 2447.1417,-3661.6502 2705.5532,-3823.0644 2755.6838,-3928 2783.3865,-3985.9884 2790.0145,-8490.7559 2791.6838,-8555 2810.5417,-9280.7351 2860.8507,-10171.2931 2869.394,-10319.6045"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9044,-10319.8872 2869.9753,-10329.6687 2872.8927,-10319.4834 2865.9044,-10319.8872"/>
</g>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node88" class="node">
<title>sourcefile~heatrecovery.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node88"><a xlink:href="../sourcefile/heatrecovery.f90.html" xlink:title="HeatRecovery.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3104.2304,-13855.0054 3008.6959,-13855.0054 3008.6959,-13832.9946 3104.2304,-13832.9946 3104.2304,-13855.0054"/>
<text text-anchor="middle" x="3056.4631" y="-13840.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatRecovery.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-4527C954.2311,-4496.6437 980.6433,-4505.3314 1002.022,-4465 1073.9326,-4329.3388 995.5711,-3922.5569 1038.022,-3775 1066.8549,-3674.7781 1117.0598,-3668.193 1152.1868,-3570 1182.461,-3485.3721 1149.4954,-3452.1258 1188.1868,-3371 1363.1824,-3004.0794 1415.6061,-2847.4125 1785.1377,-2678 1940.6869,-2606.6882 2031.1379,-2648.9397 2161.3169,-2760 2185.2659,-2780.4318 2177.2035,-2796.783 2197.3169,-2821 2417.6942,-3086.3406 2629.791,-3038.8726 2755.6838,-3360 2794.7241,-3459.584 2785.7248,-5178.203 2791.6838,-5285 2833.884,-6041.3038 2912.3254,-6225.4368 2949.5867,-6982 2984.4692,-7690.2639 2931.6601,-12656.9311 2985.5867,-13364 2999.2118,-13542.6491 3039.1221,-13755.7827 3052.2346,-13822.7776"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3048.8625,-13823.7686 3054.231,-13832.9026 3055.7303,-13822.4143 3048.8625,-13823.7686"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge595" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412.3326,-4765.1443C428.6042,-4777.5541 455.4962,-4798.3283 478.0276,-4817 556.9655,-4882.4157 594.3004,-4883.9437 651.5354,-4969 678.8426,-5009.5809 667.2026,-5028.5132 687.5354,-5073 803.6262,-5326.9992 900.1718,-5356.9631 1002.022,-5617 1138.7912,-5966.1897 964.6582,-6138.8783 1188.1868,-6440 1250.454,-6523.882 1295.4669,-6517.5995 1392.6204,-6556 1430.5168,-6570.9788 1720.8637,-6612.6558 1749.1377,-6642 1805.1405,-6700.1227 1729.5457,-6761.4842 1785.1377,-6820 1838.1784,-6875.8303 1905.444,-6802.4193 1952.9868,-6863 1981.619,-6899.4841 1984.6328,-10155.8271 1988.9868,-10202 2005.9269,-10381.6458 2054.1974,-10594.8102 2070.0434,-10661.787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2066.7326,-10662.9924 2072.4557,-10671.9085 2073.5419,-10661.3695 2066.7326,-10662.9924"/>
</g>
<!-- sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node94" class="node">
<title>sourcefile~poweredinductionunits.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node94"><a xlink:href="../sourcefile/poweredinductionunits.f90.html" xlink:title="PoweredInductionUnits.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3315.2705,-4991.0054 3177.2839,-4991.0054 3177.2839,-4968.9946 3315.2705,-4968.9946 3315.2705,-4991.0054"/>
<text text-anchor="middle" x="3246.2772" y="-4976.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PoweredInductionUnits.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge677" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-3271C1101.7062,-3220.252 1138.3318,-3220.2644 1152.1868,-3171 1188.7519,-3040.9847 1137.5028,-2081.1884 1188.1868,-1956 1238.7675,-1831.0667 1269.5868,-1787.0407 1392.6204,-1732 2000.4299,-1460.0881 2320.5406,-1601.8143 2870.6353,-1977"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge776" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4527C948.4225,-4501.736 978.3294,-4532.6108 1002.022,-4503 1080.2073,-4405.2847 996.4142,-4059.0255 1038.022,-3941 1067.3074,-3857.9283 1117.4287,-3859.9346 1152.1868,-3779 1184.3806,-3704.0363 1152.7987,-3672.5098 1188.1868,-3599 1238.5949,-3494.29 1303.5643,-3502.3935 1356.6204,-3399 1386.3451,-3341.0737 1345.2153,-3301.6293 1392.6204,-3257 1604.0966,-3057.9067 2550.788,-3270.0231 2669.7316,-3535"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node99" class="node">
<title>sourcefile~photovoltaicthermalcollectors.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node99"><a xlink:href="../sourcefile/photovoltaicthermalcollectors.f90.html" xlink:title="PhotovoltaicThermalCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2755.6361,-5180.0054 2583.827,-5180.0054 2583.827,-5157.9946 2755.6361,-5157.9946 2755.6361,-5180.0054"/>
<text text-anchor="middle" x="2669.7316" y="-5165.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PhotovoltaicThermalCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge720" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4641C952.2622,-4620.8423 978.0901,-4646.4177 1002.022,-4617 1065.0509,-4539.5231 1008.5601,-4264.4322 1038.022,-4169 1068.2138,-4071.2031 1113.8911,-4063.9169 1152.1868,-3969 1176.5474,-3908.6214 1140.7337,-3871.5782 1188.1868,-3827 1371.512,-3654.7815 1513.3883,-3664.3097 1749.1377,-3752 1861.3236,-3793.7291 1878.3261,-3834.4437 1952.9868,-3928 1968.37,-3947.2765 2153.4424,-4296.6287 2161.3169,-4320 2193.0921,-4414.3077 2132.0787,-4465.8496 2197.3169,-4541 2244.2678,-4595.0846 2304.9983,-4534.2308 2351.1489,-4589 2429.442,-4681.9142 2322.4073,-4757.1827 2387.1489,-4860 2432.5953,-4932.1742 2499.9621,-4894.3741 2547.7793,-4965 2593.2742,-5032.196 2528.8758,-5084.2447 2583.7793,-5144 2586.8794,-5147.3741 2590.4056,-5150.3026 2594.2186,-5152.8434"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2592.5451,-5155.918 2602.9699,-5157.8088 2595.9996,-5149.8297 2592.5451,-5155.918"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-4641C650.9517,-4609.805 856.841,-4681.168 920.1405,-4641"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge756" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-4641C951.9854,-4620.4078 977.6544,-4646.0579 1002.022,-4617 1095.6872,-4505.3057 941.2593,-4400.0219 1038.022,-4291 1083.5117,-4239.747 1120.1067,-4263.829 1188.1868,-4256 1528.921,-4216.8164 1655.4889,-4188.3243 1952.9868,-4359 2079.7345,-4431.7156 2086.0965,-4484.2236 2197.3169,-4579 2230.7367,-4607.4787 2248.0722,-4605.7363 2274.2329,-4641"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node103" class="node">
<title>sourcefile~plantsolarcollectors.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node103"><a xlink:href="../sourcefile/plantsolarcollectors.f90.html" xlink:title="PlantSolarCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2529.6038,-7018.0054 2405.3244,-7018.0054 2405.3244,-6995.9946 2529.6038,-6995.9946 2529.6038,-7018.0054"/>
<text text-anchor="middle" x="2467.4641" y="-7003.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSolarCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge847" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M444.4133,-4742.9718C524.9499,-4726.8029 691.733,-4705.9247 802.259,-4779 958.1485,-4882.0678 937.9216,-4973.4562 1002.022,-5149 1028.9599,-5222.7716 1007.6618,-5249.5696 1038.022,-5322 1073.3479,-5406.277 1117.6575,-5408.3934 1152.1868,-5493 1184.8276,-5572.9794 1133.8059,-5616.8819 1188.1868,-5684 1358.2435,-5893.888 1581.4673,-5706.2009 1749.1377,-5918 1810.0905,-5994.9949 1727.2447,-6056.6788 1785.1377,-6136 1834.5534,-6203.7062 1898.0146,-6158.7221 1952.9868,-6222 1985.0653,-6258.9251 1968.1447,-6281.7496 1988.9868,-6326 2064.8253,-6487.0144 2057.0487,-6558.4466 2197.3169,-6668 2225.5394,-6690.0426 2246.6741,-6669.1331 2274.2329,-6692"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-6692C2367.2684,-6785.6724 2435.5898,-6932.2873 2458.8144,-6986.2047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2455.7206,-6987.8736 2462.852,-6995.7091 2462.1633,-6985.1366 2455.7206,-6987.8736"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="446.4148,-15448.0054 348.8152,-15448.0054 348.8152,-15425.9946 446.4148,-15425.9946 446.4148,-15448.0054"/>
<text text-anchor="middle" x="397.615" y="-15433.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1009" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M398.7097,-15448.1412C406.7953,-15530.9415 457.5041,-16059.17 478.0276,-16490 483.0406,-16595.233 484.3786,-18284.9057 514.0276,-18386 555.4414,-18527.2091 609.2515,-18543.3937 687.5354,-18668 704.0374,-18694.2667 820.677,-18877.4437 838.259,-18903 1067.3651,-19236.0158 1108.0097,-19336.9706 1392.6204,-19624 1457.5708,-19689.5024 1498.7189,-19682.0824 1551.1179,-19758 1578.426,-19797.5649 1555.0472,-19824.1869 1587.1179,-19860 1679.9298,-19963.6423 1735.145,-19958.2915 1869.0623,-19996"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M744.8972,-17074C772.6695,-17090.1578 778.2459,-17096.6519 802.259,-17118 819.4064,-17133.2443 818.2642,-17143.7471 838.259,-17155 909.0881,-17194.8619 1482.3038,-17275.7525 1551.1179,-17319 1572.8034,-17332.6287 1566.8391,-17348.3549 1587.1179,-17364 1649.5075,-17412.1333 1704.2754,-17371.2185 1749.1377,-17436 1787.9188,-17492.0002 1772.582,-17981.0496 1785.1377,-18048 1839.5386,-18338.0817 1794.4668,-18458.0342 1988.9868,-18680 2257.5856,-18986.4967 2463.0993,-18932 2870.6353,-18932 2870.6353,-18932 2870.6353,-18932 3246.2772,-18932 3366.0543,-18932 3400.5169,-18942.2692 3508.5469,-18994 3526.8287,-19002.7544 3525.7115,-19014.5105 3544.5469,-19022 3648.0836,-19063.1693 3682.6724,-19046 3794.094,-19046 3794.094,-19046 3794.094,-19046 3972.2545,-19046 4237.8816,-19046 4285.8547,-17977.8241 4291.7114,-17811.6225"/>
<polygon fill="#ffff00" stroke="#ffff00" points="4295.2224,-17811.3545 4292.0627,-17801.2418 4288.2264,-17811.1177 4295.2224,-17811.3545"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="975.2785,-11836.0054 865.0025,-11836.0054 865.0025,-11813.9946 975.2785,-11813.9946 975.2785,-11836.0054"/>
<text text-anchor="middle" x="920.1405" y="-11821.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M400.2248,-15425.7868C411.7517,-15375.7364 458.3962,-15167.5956 478.0276,-14994 487.8765,-14906.9082 476.5899,-14285.2489 514.0276,-14206 549.1786,-14131.5915 615.5235,-14155.9957 651.5354,-14082 702.4179,-13977.4487 660.8691,-13673.1764 687.5354,-13560 718.001,-13430.6989 771.0334,-13413.1196 802.259,-13284 872.4814,-12993.6271 913.1492,-12005.9574 919.317,-11846.747"/>
<polygon fill="#00ff00" stroke="#00ff00" points="922.8289,-11846.5016 919.7152,-11836.3746 915.8341,-11846.233 922.8289,-11846.5016"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M744.8972,-16158C849.7635,-16146.7609 972.2132,-16168.3467 1041.0049,-16183.6434"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1040.6392,-16187.1492 1051.1653,-16185.9442 1042.1852,-16180.322 1040.6392,-16187.1492"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="966.7644,-18226.0054 873.5166,-18226.0054 873.5166,-18203.9946 966.7644,-18203.9946 966.7644,-18226.0054"/>
<text text-anchor="middle" x="920.1405" y="-18211.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M398.7008,-15448.1417C406.7219,-15530.9451 457.0514,-16059.1918 478.0276,-16490 480.3341,-16537.3711 484.9068,-18159.5658 514.0276,-18197 533.4933,-18222.0228 563.6052,-18190.7547 582.7815,-18216"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M582.7815,-18216C611.1934,-18253.404 640.6678,-18205.118 687.5354,-18202 738.4112,-18198.6154 751.3476,-18199.2012 802.259,-18202 822.2125,-18203.0969 843.9801,-18205.2307 863.3183,-18207.4574"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="863.1425,-18210.961 873.4848,-18208.6616 863.9659,-18204.0096 863.1425,-18210.961"/>
</g>
<!-- sourcefile~datatimings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~datatimings.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/datatimings.f90.html" xlink:title="DataTimings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1712.1913,-18946.0054 1624.0643,-18946.0054 1624.0643,-18923.9946 1712.1913,-18923.9946 1712.1913,-18946.0054"/>
<text text-anchor="middle" x="1668.1278" y="-18931.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataTimings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datatimings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datatimings.f90</title>
<path fill="none" stroke="#0099ff" stroke-dasharray="5,2" d="M398.7025,-15448.1416C406.7358,-15530.9444 457.1375,-16059.1876 478.0276,-16490 487.3933,-16683.1478 460.2267,-18044.2603 514.0276,-18230 552.8111,-18363.8943 729.8747,-18679.3377 838.259,-18767 911.2916,-18826.0695 947.6815,-18810.2794 1038.022,-18836 1085.5529,-18849.5324 1427.1537,-18912.9562 1471.8691,-18934"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1095.1044,-17340C1175.2449,-17348.4917 1192.7241,-17365.9251 1272.4036,-17378"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M398.4679,-15448.1697C408.9125,-15584.9267 511.8079,-16931.5695 514.0276,-16936 584.4728,-17076.6115 938.709,-17323.4283 1095.1044,-17340"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M400.1791,-15425.7815C411.5118,-15375.7086 457.4513,-15167.4862 478.0276,-14994 494.7004,-14853.4257 468.2327,-14491.9475 514.0276,-14358 548.9242,-14255.9292 594.4806,-14249.5477 651.5354,-14158 741.0763,-14014.3263 720.9887,-13948.0957 838.259,-13826 897.4948,-13764.3269 957.2712,-13797.8686 1002.022,-13725 1052.3191,-13643.1002 982.1259,-13372.1858 1038.022,-13294 1040.2615,-13290.8674 1042.9818,-13288.1225 1046.0059,-13285.7183"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1048.1327,-13288.5099 1054.5986,-13280.1169 1044.31,-13282.6458 1048.1327,-13288.5099"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge930" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M744.8972,-17074C1075.7415,-17240.7733 1207.8685,-17146.5329 1551.1179,-17286 1574.5363,-17295.5152 1735.6798,-17376.6026 1749.1377,-17398 1812.9316,-17499.4291 1730.2968,-17829.4636 1785.1377,-17936 1893.5666,-18146.6389 1998.0156,-18145.9197 2197.3169,-18274 2276.3536,-18324.7927 2298.737,-18335.2189 2387.1489,-18367 2753.1196,-18498.554 2900.9194,-18354.2014 3246.2772,-18533"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge959" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M400.2557,-15425.7903C411.9143,-15375.7545 459.0364,-15167.6668 478.0276,-14994 523.4758,-14578.3935 462.9604,-14468.9535 514.0276,-14054 550.4138,-13758.3386 617.9956,-13693.9978 651.5354,-13398 663.3658,-13293.5935 629.1274,-11594.3451 687.5354,-11507 691.1812,-11501.5479 696.2979,-11497.277 701.9888,-11493.9333"/>
<polygon fill="#9900ff" stroke="#9900ff" points="703.8207,-11496.934 711.2756,-11489.4057 700.7531,-11490.6419 703.8207,-11496.934"/>
</g>
<!-- sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~solarreflectionmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/solarreflectionmanager.f90.html" xlink:title="SolarReflectionManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1342.9879,-15448.0054 1201.8192,-15448.0054 1201.8192,-15425.9946 1342.9879,-15425.9946 1342.9879,-15448.0054"/>
<text text-anchor="middle" x="1272.4036" y="-15433.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SolarReflectionManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge974" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M920.1405,-15550C997.7885,-15545.7963 1025.3351,-15584.3385 1095.1044,-15550"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge993" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1272.4036,-15666C1301.7203,-15640.4014 1331.3367,-15671.5888 1356.6204,-15642 1442.713,-15541.2482 1339.3517,-15467.3479 1392.6204,-15346 1446.1583,-15224.0386 1486.22,-15204.9512 1587.1179,-15118 1699.0183,-15021.5673 1736.457,-14876.9093 1869.0623,-14942"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1005" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M400.3883,-15425.8037C412.6107,-15375.8251 461.7792,-15167.9449 478.0276,-14994 533.3986,-14401.2338 465.3136,-10229.3504 514.0276,-9636 527.1591,-9476.0542 565.137,-9285.909 578.2586,-9223.2057"/>
<polygon fill="#ff0033" stroke="#ff0033" points="581.7037,-9223.8308 580.3425,-9213.3237 574.8543,-9222.3863 581.7037,-9223.8308"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1521.418,-13243.0054 1422.3203,-13243.0054 1422.3203,-13220.9946 1521.418,-13220.9946 1521.418,-13243.0054"/>
<text text-anchor="middle" x="1471.8691" y="-13228.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-15626C1021.6597,-15647.0657 1055.3082,-15638.9387 1152.1868,-15602 1170.6283,-15594.9685 1170.4284,-15584.6123 1188.1868,-15576 1258.2248,-15542.0336 1309.1483,-15589.6883 1356.6204,-15528 1389.3895,-15485.4176 1386.3446,-13647.3638 1392.6204,-13594 1408.1186,-13462.216 1450.084,-13307.807 1465.8095,-13252.7696"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1469.1834,-13253.7014 1468.5891,-13243.1232 1462.457,-13251.7632 1469.1834,-13253.7014"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1931.8859,-9516.0054 1806.2386,-9516.0054 1806.2386,-9493.9946 1931.8859,-9493.9946 1931.8859,-9516.0054"/>
<text text-anchor="middle" x="1869.0623" y="-9501.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-15666C1296.6169,-15635.5291 1332.3544,-15672.429 1356.6204,-15642 1403.5173,-15583.1922 1357.8826,-15032.7155 1392.6204,-14966 1433.9265,-14886.6697 1507.7762,-14920.2368 1551.1179,-14842 1625.1826,-14708.3047 1498.4951,-14624.5231 1587.1179,-14500 1633.237,-14435.1985 1706.2199,-14490.9647 1749.1377,-14424 1784.1073,-14369.4369 1774.5565,-9821.9378 1785.1377,-9758 1799.9357,-9668.5817 1841.212,-9567.9021 1859.7912,-9525.528"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1863.0404,-9526.8348 1863.8964,-9516.2746 1856.6418,-9523.996 1863.0404,-9526.8348"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-15740C612.9803,-15757.2316 1247.5122,-15697.3243 1272.4036,-15666"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1727.4634,-5982.0054 1608.7922,-5982.0054 1608.7922,-5959.9946 1727.4634,-5959.9946 1727.4634,-5982.0054"/>
<text text-anchor="middle" x="1668.1278" y="-5967.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M398.3857,-15425.8809C402.2876,-15376.4882 423.4072,-15173.6035 514.0276,-15042 550.6148,-14988.8662 696.3679,-14908.5056 744.8972,-14866"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M744.8972,-14866C768.9248,-14844.2601 784.033,-14847.7911 802.259,-14821 833.8183,-14774.6097 802.6222,-14743.3367 838.259,-14700 890.4746,-14636.5026 943.4343,-14671.6703 1002.022,-14614 1025.8344,-14590.5605 1015.2311,-14572.434 1038.022,-14548 1079.1016,-14503.9586 1102.4041,-14508.8949 1152.1868,-14475 1244.9062,-14411.8712 1304.4674,-14426.3087 1356.6204,-14327 1437.5939,-14172.8119 1300.0133,-12907.4944 1392.6204,-12760 1434.6863,-12693.002 1509.6351,-12746.3606 1551.1179,-12679 1597.8535,-12603.1099 1574.808,-6350.2722 1587.1179,-6262 1601.6294,-6157.9408 1643.0438,-6038.5264 1660.3644,-5991.5247"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.6489,-5992.7338 1663.8587,-5982.141 1657.0889,-5990.2909 1663.6489,-5992.7338"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1545.1238,-9860.0054 1398.6145,-9860.0054 1398.6145,-9837.9946 1545.1238,-9837.9946 1545.1238,-9860.0054"/>
<text text-anchor="middle" x="1471.8691" y="-9845.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.2729,-15425.8803C408.898,-15362.3896 459.0737,-15045.7692 514.0276,-14966 558.2561,-14901.7993 757.8385,-14830.068 802.259,-14766 839.3561,-14712.4946 793.0765,-14670.878 838.259,-14624 890.8933,-14569.3906 942.9648,-14623.59 1002.022,-14576 1028.0392,-14555.0346 1017.0605,-14536.0204 1038.022,-14510 1155.5498,-14364.1073 1277.8342,-14403.9712 1356.6204,-14234 1394.2615,-14152.7941 1389.0765,-11101.4354 1392.6204,-11012 1410.941,-10549.653 1459.7495,-9985.4964 1469.9744,-9870.1748"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1473.4646,-9870.4386 1470.8649,-9860.1677 1466.4922,-9869.818 1473.4646,-9870.4386"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-14752C642.102,-14653.2174 735.2129,-14707.7109 802.259,-14614 842.655,-14557.5383 789.057,-14510.9787 838.259,-14462 891.2122,-14409.2872 949.7018,-14477.3412 1002.022,-14424 1056.1024,-14368.8642 988.8214,-14313.5311 1038.022,-14254 1135.8827,-14135.5918 1271.2255,-14247.6908 1356.6204,-14120 1401.1632,-14053.3952 1387.3451,-8430.9527 1392.6204,-8351 1408.4118,-8111.6629 1454.8838,-7823.9334 1468.2406,-7744.3108"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1471.7502,-7744.5468 1469.9634,-7734.1037 1464.8478,-7743.3817 1471.7502,-7744.5468"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1521.9964,-8382.0054 1421.7419,-8382.0054 1421.7419,-8359.9946 1521.9964,-8359.9946 1521.9964,-8382.0054"/>
<text text-anchor="middle" x="1471.8691" y="-8367.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.6371,-15425.5861C413.5886,-15347.0499 495.5546,-14889.1186 514.0276,-14866 555.8766,-14813.6267 596.8957,-14842.8433 651.5354,-14804 670.4968,-14790.5204 669.7231,-14780.9652 687.5354,-14766 734.3635,-14726.657 766.8715,-14739.8845 802.259,-14690 839.9298,-14636.897 797.9424,-14599.1232 838.259,-14548 889.1655,-14483.4484 940.6986,-14516.7524 1002.022,-14462 1023.2631,-14443.0349 1020.7229,-14431.6187 1038.022,-14409 1100.2833,-14327.5928 1100.3756,-14286.8469 1188.1868,-14234 1253.9385,-14194.429 1308.4952,-14255.7757 1356.6204,-14196 1402.8884,-14138.531 1386.7226,-8957.5434 1392.6204,-8884 1408.0427,-8691.6889 1453.0918,-8462.2663 1467.4311,-8392.2901"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1470.9366,-8392.6208 1469.53,-8382.1197 1464.081,-8391.2059 1470.9366,-8392.6208"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1340.8013,-5562.0054 1204.0058,-5562.0054 1204.0058,-5539.9946 1340.8013,-5539.9946 1340.8013,-5562.0054"/>
<text text-anchor="middle" x="1272.4036" y="-5547.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M400.3973,-15425.8045C412.6579,-15375.8295 461.9651,-15167.9621 478.0276,-14994 518.1659,-14559.289 463.261,-7569.5983 514.0276,-7136 533.82,-6966.9521 616.6231,-6544.7268 687.5354,-6390 833.3857,-6071.7623 1011.6454,-6074.6176 1152.1868,-5754 1185.2903,-5678.4807 1131.33,-5631.7187 1188.1868,-5572 1190.2811,-5569.8003 1192.5677,-5567.8167 1195.0033,-5566.029"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.0747,-5568.8656 1203.7958,-5560.6755 1193.4342,-5562.8867 1197.0747,-5568.8656"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge889" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-17266C3737.1408,-17140.3006 3780.5373,-16911.3165 3791.1972,-16840.4696"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3794.7217,-16840.5496 3792.6824,-16830.1529 3787.7931,-16839.5521 3794.7217,-16840.5496"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-16922C602.3839,-16946.2531 621.724,-16926.8489 651.5354,-16936 668.1056,-16941.0865 670.7395,-16946.7172 687.5354,-16951 823.717,-16985.7251 866.0789,-16948.3525 1002.022,-16984 1024.8927,-16989.9972 1370.2657,-17145.299 1392.6204,-17153 1547.4454,-17206.336 1645.251,-17119.4177 1749.1377,-17246 1835.4252,-17351.1383 1694.9376,-17755.1985 1785.1377,-17857 1846.2025,-17925.9188 1897.2777,-17885.7445 1988.9868,-17894 2065.2695,-17900.8668 2086.4382,-17910.1053 2161.3169,-17894 2735.1663,-17770.5738 2820.2009,-17568.9379 3365.2148,-17351 3471.2728,-17308.59 3525.8264,-17345.5919 3607.7534,-17266"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge927" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-16922C603.0385,-16945.709 625.5959,-16918.6908 651.5354,-16936 713.1317,-16977.1028 677.0629,-17044.3007 744.8972,-17074"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-17074C783.3329,-17090.828 796.4171,-17063.1197 838.259,-17060 910.8411,-17054.5883 930.2262,-17048.0498 1002.022,-17060 1045.4097,-17067.2218 1722.9347,-17286.6722 1749.1377,-17322 1824.6152,-17423.7612 1697.3346,-17799.661 1785.1377,-17891 1901.1838,-18011.7193 1994.3391,-17924.5813 2161.3169,-17912 2684.826,-17872.5552 2853.0598,-17956.12 3329.2148,-17735 3534.3495,-17639.7382 3528.7717,-17533.2982 3706.96,-17394 3779.8761,-17336.998 3828.8182,-17356.2837 3881.228,-17280 3927.3496,-17212.8689 3960.7684,-16955.5512 3969.8095,-16879.3695"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3973.3229,-16879.4582 3971.0076,-16869.1195 3966.3703,-16878.6455 3973.3229,-16879.4582"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge559" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-18216C600.5066,-18241.6571 628.358,-18209.1368 651.5354,-18230 691.0259,-18265.5473 653.8513,-18302.9087 687.5354,-18344 800.2708,-18481.526 877.9203,-18459.604 1038.022,-18537 1103.183,-18568.5 1119.9328,-18575.925 1188.1868,-18600 1277.3691,-18631.457 1299.2377,-18644.0764 1392.6204,-18659 1822.9003,-18727.7635 1990.8655,-18698.0818 2351.1489,-18453 2457.4058,-18380.719 2468.0481,-18341.7869 2547.7793,-18241 2650.7039,-18110.8948 2675.4966,-18076.2269 2755.6838,-17931 2774.7262,-17896.5125 2770.4527,-17883.1849 2791.6838,-17850 2849.0359,-17760.3572 2882.9307,-17752.9583 2949.5867,-17670 2966.5129,-17648.9341 2969.4239,-17642.6572 2985.5867,-17621 3047.9632,-17537.419 3079.6644,-17526.7561 3127.3396,-17434 3152.0164,-17385.9893 3133.4358,-17362.9415 3163.3396,-17318 3216.6227,-17237.9226 3270.9707,-17255.5447 3329.2148,-17179 3352.5797,-17148.2938 3347.2324,-17134.1383 3365.2148,-17100 3422.7622,-16990.7511 3474.1831,-16980.6008 3508.5469,-16862 3575.4335,-16631.1517 3605.2345,-12697.6992 3607.5997,-12370.611"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.1028,-12370.1756 3607.6748,-12360.1507 3604.103,-12370.1253 3611.1028,-12370.1756"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge616" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M582.7815,-18216C596.1319,-18235.1143 978.9612,-18238.4339 1002.022,-18235 1375.3947,-18179.4017 1602.557,-18178.8684 1749.1377,-17831 1797.7868,-17715.5449 1757.3157,-16826.1579 1785.1377,-16704 1826.1383,-16523.9791 1894.6684,-16499.1785 1952.9868,-16324 1975.4623,-16256.4873 1964.6447,-16234.8623 1988.9868,-16168 2046.6716,-16009.5532 2120.9323,-15993.7132 2161.3169,-15830 2239.8254,-15511.738 2157.7715,-13205.4081 2197.3169,-12880 2211.7191,-12761.4887 2251.8359,-12623.4703 2267.6775,-12571.8662"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2271.0547,-12572.7921 2270.6715,-12562.2042 2264.3684,-12570.7202 2271.0547,-12572.7921"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge635" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M410.5394,-15448.0679C439.9572,-15471.9272 514.6498,-15525.0366 582.7815,-15512"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M582.7815,-15512C682.8871,-15492.8453 609.9396,-15374.0827 687.5354,-15308 812.2444,-15201.7944 880.0893,-15237.4655 1038.022,-15194 1103.9982,-15175.8423 1121.1256,-15173.6147 1188.1868,-15160 1295.8504,-15138.1422 2090.6178,-15069.0885 2161.3169,-14985 2191.3536,-14949.2748 2193.6019,-8310.5262 2197.3169,-8264 2232.7934,-7819.6948 2306.7537,-7716.5029 2351.1489,-7273 2386.1572,-6923.2723 2349.8411,-6832.4898 2387.1489,-6483 2406.0278,-6306.1474 2448.8009,-6095.392 2462.8777,-6028.4831"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2466.3759,-6028.8575 2465.0224,-6018.3495 2459.5276,-6027.408 2466.3759,-6028.8575"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2523.2707,-7654.0054 2411.6575,-7654.0054 2411.6575,-7631.9946 2523.2707,-7631.9946 2523.2707,-7654.0054"/>
<text text-anchor="middle" x="2467.4641" y="-7639.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge643" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M400.119,-15448.2758C411.2728,-15495.3816 461.3289,-15676.9106 582.7815,-15740"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M744.8972,-15550C768.615,-15535.8157 781.7369,-15544.5087 802.259,-15526 827.0716,-15503.6219 813.2231,-15482.1279 838.259,-15460 950.6616,-15360.6537 1021.8991,-15410.3582 1152.1868,-15336 1169.7912,-15325.9527 1169.5694,-15316.0162 1188.1868,-15308 1419.8491,-15208.2516 1500.432,-15263.9837 1749.1377,-15222 1840.9777,-15206.4966 2101.3594,-15217.2744 2161.3169,-15146 2192.5936,-15108.8199 2192.4488,-11696.3414 2197.3169,-11648 2233.507,-11288.6212 2311.9431,-11209.0624 2351.1489,-10850 2415.286,-10262.6078 2366.5249,-10111.5233 2387.1489,-9521 2413.8475,-8756.5469 2458.9857,-7817.5894 2466.4149,-7664.5385"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2469.928,-7664.352 2466.9178,-7654.1938 2462.9363,-7664.0121 2469.928,-7664.352"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M582.7815,-15740C681.2895,-15791.1707 648.6653,-15605.3326 744.8972,-15550"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge715" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-15550C1052.9366,-15542.8107 1058.7073,-15447.357 1188.1868,-15417 1261.0698,-15399.9123 1302.4998,-15365.2806 1356.6204,-15417 1420.387,-15477.9375 1348.9985,-16133.3403 1392.6204,-16210 1495.8679,-16391.4441 1589.3319,-16395.5978 1785.1377,-16468 1942.3256,-16526.1227 1999.3864,-16537.1834 2161.3169,-16494 2255.3205,-16468.9313 2267.5523,-16434.7668 2351.1489,-16385 2715.5836,-16168.0443 2775.5924,-16055.8561 3163.3396,-15884 3198.4217,-15868.451 3233.6966,-15896.2526 3246.2772,-15860"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-15550C812.3636,-15511.0834 842.782,-15559.0489 920.1405,-15550"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3246.2772,-15860C3440.9486,-15398.7313 3311.8497,-15859.3195 3365.2148,-9224 3389.7561,-6172.5846 3432.9965,-2390.9234 3436.6355,-2074.3128"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3440.1368,-2074.21 3436.7521,-2064.1703 3433.1372,-2074.1294 3440.1368,-2074.21"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge809" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M397.9425,-15448.0713C400.5905,-15530.742 420.8549,-16051.7443 514.0276,-16172 703.3981,-16416.4157 941.7098,-16222.5057 1152.1868,-16449 1185.1977,-16484.523 1151.9234,-16519.8041 1188.1868,-16552 1191.1701,-16554.6487 1745.5561,-16674.2426 1749.1377,-16676 1767.8356,-16685.1743 1767.7089,-16694.5976 1785.1377,-16706 1869.915,-16761.4636 1890.3919,-16784.7095 1988.9868,-16808 2063.5265,-16825.6081 2105.6038,-16860.5572 2161.3169,-16808 2211.2696,-16760.8769 2171.3175,-16254.5602 2197.3169,-16191 2236.6498,-16094.8435 2303.459,-16107.2974 2351.1489,-16015 2382.6208,-15954.0905 2364.4218,-15929.6833 2387.1489,-15865 2442.6834,-15706.9439 2502.4813,-15685.2882 2547.7793,-15524 2588.1497,-15380.2572 2522.7075,-15326.2424 2583.7793,-15190 2630.3601,-15086.0848 2707.4289,-15103.1484 2755.6838,-15000 2804.3708,-14895.9281 2770.9903,-14857.0184 2791.6838,-14744 2848.9682,-14431.1399 2913.1525,-14361.9675 2949.5867,-14046 3013.864,-13488.5683 2939.0307,-9555.1907 2985.5867,-8996 2999.1818,-8832.707 3038.4595,-8638.5754 3051.8938,-8575.1659"/>
<polygon fill="#003fff" stroke="#003fff" points="3055.3579,-8575.7034 3054.023,-8565.193 3048.5121,-8574.2418 3055.3579,-8575.7034"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge818" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M582.7815,-15512C655.0716,-15498.656 631.3925,-15431.4542 687.5354,-15384 746.4386,-15334.2126 766.4439,-15326.1239 838.259,-15298 907.8317,-15270.7543 933.1524,-15288.9769 1002.022,-15260 1019.5227,-15252.6366 1020.6188,-15244.5911 1038.022,-15237 1266.5662,-15137.3107 1537.5341,-15170.2709 1952.9868,-15108 1999.5264,-15101.0243 2131.0559,-15106.0397 2161.3169,-15070 2210.4746,-15011.455 2192.5747,-9642.2989 2197.3169,-9566 2233.4631,-8984.4306 2308.7115,-8845.1442 2351.1489,-8264 2392.5004,-7697.7268 2332.5488,-7552.1497 2387.1489,-6987 2404.6067,-6806.2999 2448.6659,-6591.0006 2462.9312,-6523.9665"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2466.355,-6524.6924 2465.0269,-6514.1811 2459.5103,-6523.2264 2466.355,-6524.6924"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge861" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M744.8972,-16158C858.6777,-16146.9065 888.1217,-16141.2123 1002.022,-16151 1170.7413,-16165.4984 1910.5284,-16340.1046 1952.9868,-16381 1993.7046,-16420.2188 1943.7066,-16469.151 1988.9868,-16503 2050.3319,-16548.8583 2106.0941,-16556.0721 2161.3169,-16503 2197.6362,-16468.0951 2188.4599,-15646.5883 2197.3169,-15597 2245.3788,-15327.9121 2275.1213,-15261.3352 2387.1489,-15012 2457.904,-14854.5235 2495.498,-14825.3629 2583.7793,-14677 2659.4214,-14549.8781 2713.5436,-14533.7953 2755.6838,-14392 2788.243,-14282.4435 2729.182,-13459.6882 2791.6838,-13364 2834.2759,-13298.793 2907.893,-13353.785 2949.5867,-13288 2984.934,-13232.2283 2983.7687,-8600.0046 2985.5867,-8534 3002.1219,-7933.6671 3046.8024,-7198.3865 3055.1203,-7064.4488"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.6247,-7064.4867 3055.7534,-7054.2884 3051.6382,-7064.0514 3058.6247,-7064.4867"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M400.2786,-15448.048C422.4809,-15538.8508 580.0844,-16158.7053 744.8972,-16158"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-12894C2278.8437,-12817.2339 2333.0971,-12813.7557 2351.1489,-12739 2421.9916,-12445.628 2360.2688,-10323.6049 2387.1489,-10023 2403.2197,-9843.2785 2448.0273,-9629.4739 2462.7266,-9562.2827"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.2302,-9562.6473 2464.9641,-9552.1284 2459.3941,-9561.141 2466.2302,-9562.6473"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-16542C789.8098,-16557.4514 795.7253,-16572.863 838.259,-16594 909.4595,-16629.3828 929.3214,-16633.812 1002.022,-16666 1084.8569,-16702.6749 1099.5805,-16730.1425 1188.1868,-16749 1261.4063,-16764.5829 1299.6586,-16797.5724 1356.6204,-16749 1433.6799,-16683.2898 1343.7405,-16612.6947 1392.6204,-16524 1418.0983,-16477.7691 1710.2668,-16245.7139 1749.1377,-16210 1935.9783,-16038.3341 2060.2872,-16047.748 2161.3169,-15815 2193.4723,-15740.9217 2145.1956,-12969.6841 2197.3169,-12908 2219.7429,-12881.4595 2272.1497,-12928.6841 2274.2329,-12894"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1272.4036,-15514C1294.9925,-15482.5942 1332.7725,-15522.4609 1356.6204,-15492 1403.4061,-15432.2404 1367.3645,-12831.57 1392.6204,-12760 1404.4193,-12726.5643 1432.1565,-12695.6817 1451.4673,-12677.0906"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1453.9942,-12679.5194 1458.9054,-12670.1316 1449.2118,-12674.4077 1453.9942,-12679.5194"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M744.8972,-15550C817.7568,-15506.4268 836.0673,-15614.2167 920.1405,-15626"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M920.1405,-15626C946.5696,-15629.7042 1129.0701,-15577.3355 1152.1868,-15564 1171.7867,-15552.6933 1168.065,-15538.3497 1188.1868,-15528 1221.9284,-15510.6449 1250.2481,-15544.8032 1272.4036,-15514"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge519" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M582.7815,-18216C600.376,-18241.7468 622.6081,-18218.3519 651.5354,-18230 782.493,-18282.7324 1052.6017,-18530.6645 1188.1868,-18570 1696.7517,-18717.5432 1985.1106,-18693.6529 2351.1489,-18311 2538.8656,-18114.7629 2455.8388,-17985.5366 2583.7793,-17746 2864.0967,-17221.1757 3148.9329,-17201.0245 3329.2148,-16634 3363.7721,-16525.31 3430.9144,-12693.1378 3436.508,-12370.5779"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3440.0132,-12370.3002 3436.687,-12360.2411 3433.0143,-12370.1789 3440.0132,-12370.3002"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge547" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M399.8312,-15425.7329C409.6851,-15375.4534 450.2571,-15166.4808 478.0276,-14994 496.2915,-14880.5636 469.8029,-14844.0451 514.0276,-14738 554.3691,-14641.2662 943.9679,-14199.032 1038.022,-14092 1062.7465,-14063.8639 1057.7559,-14027.1656 1095.1044,-14030"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node67"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2318.0176,-6018.0054 2230.4483,-6018.0054 2230.4483,-5995.9946 2318.0176,-5995.9946 2318.0176,-6018.0054"/>
<text text-anchor="middle" x="2274.2329" y="-6003.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M413.2937,-15425.968C491.8205,-15371.4279 851.9218,-15129.7251 1188.1868,-15042 1214.4332,-15035.1528 2142.9089,-14980.9224 2161.3169,-14961 2203.0394,-14915.8449 2177.5428,-6166.2128 2197.3169,-6108 2208.5441,-6074.9483 2235.318,-6044.1358 2254.1055,-6025.4418"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2256.8402,-6027.6665 2261.5998,-6018.2009 2251.9762,-6022.6324 2256.8402,-6027.6665"/>
</g>
<!-- sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~datasurfacelists.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node68"><a xlink:href="../sourcefile/datasurfacelists.f90.html" xlink:title="DataSurfaceLists.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1327.3731,-16740.0054 1217.4341,-16740.0054 1217.4341,-16717.9946 1327.3731,-16717.9946 1327.3731,-16740.0054"/>
<text text-anchor="middle" x="1272.4036" y="-16725.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaceLists.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M920.1405,-16542C939.7771,-16538.8123 1084.4863,-16487.177 1095.1044,-16504"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M398.1024,-15448.0728C402.8899,-15554.6937 442.86,-16397.1673 514.0276,-16480 583.2647,-16560.5859 640.8689,-16520.4136 744.8972,-16542"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M744.8972,-16542C819.0488,-16565.8278 843.261,-16554.4803 920.1405,-16542"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node69"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2339.728,-4307.0054 2208.7378,-4307.0054 2208.7378,-4284.9946 2339.728,-4284.9946 2339.728,-4307.0054"/>
<text text-anchor="middle" x="2274.2329" y="-4292.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1272.4036,-15666C1302.0268,-15640.7567 1331.0771,-15671.365 1356.6204,-15642 1432.6055,-15554.6461 1328.2408,-15480.2274 1392.6204,-15384 1446.83,-15302.9734 2111.1723,-15044.6033 2161.3169,-14961 2198.7979,-14898.5101 2181.9863,-4539.2375 2197.3169,-4468 2209.8609,-4409.7112 2243.5348,-4347.2306 2261.8902,-4316.0769"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2265.1269,-4317.4847 2267.2653,-4307.1079 2259.1226,-4313.8863 2265.1269,-4317.4847"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node71"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2112.7783,-5752.0054 2037.5254,-5752.0054 2037.5254,-5729.9946 2112.7783,-5729.9946 2112.7783,-5752.0054"/>
<text text-anchor="middle" x="2075.1519" y="-5737.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-15132C739.1319,-15008.6945 833.2362,-15079.6459 1002.022,-14974 1305.5791,-14783.9984 1319.3987,-14657.8528 1587.1179,-14420 1657.188,-14357.7469 1709.1063,-14369.7511 1749.1377,-14285 1815.5048,-14144.4934 1759.5439,-8844.2699 1785.1377,-8691 1823.6767,-8460.2074 1913.3332,-8422.6037 1952.9868,-8192 2037.2048,-7702.2348 1890.9231,-6443.1818 1988.9868,-5956 2004.1379,-5880.7292 2044.621,-5798.1371 2064.22,-5761.0174"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2067.3096,-5762.6617 2068.9409,-5752.1932 2061.1374,-5759.3596 2067.3096,-5762.6617"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node73" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node73"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1932.5649,-6894.0054 1805.5596,-6894.0054 1805.5596,-6871.9946 1932.5649,-6871.9946 1932.5649,-6894.0054"/>
<text text-anchor="middle" x="1869.0623" y="-6879.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-14866C769.2012,-14844.5695 780.7297,-14845.2165 802.259,-14821 822.6689,-14798.0426 816.1009,-14783.2749 838.259,-14762 898.3218,-14704.3315 930.4179,-14713.4977 1002.022,-14671 1069.9355,-14630.6926 1088.4555,-14622.6396 1152.1868,-14576 1248.0085,-14505.8761 1269.6808,-14484.8746 1356.6204,-14404 1373.4195,-14388.3728 1375.9922,-14382.8089 1392.6204,-14367 1476.0388,-14287.6916 1484.035,-14247.209 1587.1179,-14196 1652.9316,-14163.3054 1702.5056,-14219.7963 1749.1377,-14163 1812.4095,-14085.9372 1751.0254,-7077.6929 1785.1377,-6984 1797.5318,-6949.9583 1826.8755,-6919.2623 1847.3512,-6900.8748"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1849.7407,-6903.4349 1854.9761,-6894.2239 1845.1394,-6898.1597 1849.7407,-6903.4349"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-14752C608.4117,-14707.0309 624.5879,-14702.1924 651.5354,-14658 670.1617,-14627.4539 667.3139,-14615.5143 687.5354,-14586 746.2624,-14500.2849 936.6177,-14320.7355 1002.022,-14240 1019.2588,-14218.7228 1016.929,-14207.4617 1038.022,-14190 1094.7428,-14143.044 1118.1712,-14142.8021 1188.1868,-14120 1260.7198,-14096.378 1307.9793,-14145.763 1356.6204,-14087 1414.1242,-14017.5299 1362.9351,-7679.1561 1392.6204,-7594 1404.2916,-7560.5195 1432.0598,-7529.6478 1451.4124,-7511.0713"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1453.9416,-7513.4984 1458.868,-7504.1185 1449.1675,-7508.379 1453.9416,-7513.4984"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.7315,-15425.7162C409.1612,-15375.3658 448.1936,-15166.1359 478.0276,-14994 494.7975,-14897.2414 450.8169,-14851.1523 514.0276,-14776 534.8608,-14751.231 566.8598,-14780.1785 582.7815,-14752"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node75" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node75"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2735.021,-10808.0054 2604.4422,-10808.0054 2604.4422,-10785.9946 2735.021,-10785.9946 2735.021,-10808.0054"/>
<text text-anchor="middle" x="2669.7316" y="-10793.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-15970C1476.746,-15991.2305 2041.6467,-15882.9898 2161.3169,-15716 2212.849,-15644.0913 2183.7283,-14211.4172 2197.3169,-14124 2243.2819,-13828.3004 2291.2133,-13761.4562 2387.1489,-13478 2450.9529,-13289.4817 2509.3964,-13255.2866 2547.7793,-13060 2620.3527,-12690.7572 2551.658,-11741.9338 2583.7793,-11367 2602.2646,-11151.2319 2650.9121,-10892.9689 2665.5231,-10818.2169"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2669.0003,-10818.6736 2667.4955,-10808.1862 2662.1318,-10817.323 2669.0003,-10818.6736"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-15894C1180.3866,-15885.2098 1189.0765,-15949.8276 1272.4036,-15970"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node76" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node76"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3329.1525,-13855.0054 3163.4019,-13855.0054 3163.4019,-13832.9946 3329.1525,-13832.9946 3329.1525,-13855.0054"/>
<text text-anchor="middle" x="3246.2772" y="-13840.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M398.6174,-15448.1461C406.0355,-15530.9819 452.8174,-16059.4188 478.0276,-16490 489.5061,-16686.0495 473.2138,-17180.9026 514.0276,-17373 571.2596,-17642.3728 469.5117,-17948 744.8972,-17948 744.8972,-17948 744.8972,-17948 920.1405,-17948 1026.89,-17948 1067.6185,-17944.8567 1152.1868,-18010 1177.7349,-18029.6798 1170.8768,-18045.7903 1188.1868,-18073 1272.8311,-18206.0531 1263.4923,-18272.4808 1392.6204,-18363 1465.9851,-18414.4289 1498.3141,-18404.1173 1587.1179,-18416 1860.7622,-18452.6161 1985.8626,-18392.1612 2161.3169,-18179 2267.8692,-18049.5486 2296.6339,-18011.5534 2351.1489,-17853 2389.7956,-17740.5987 2348.5154,-17700.4058 2387.1489,-17588 2433.2808,-17453.7775 2503.8753,-17446.9676 2547.7793,-17312 2596.4259,-17162.4528 2541.4988,-17111.4702 2583.7793,-16960 2695.9077,-16558.2991 2786.5869,-16478.5181 2985.5867,-16112 3042.8819,-16006.4737 3091.2454,-15996.5241 3127.3396,-15882 3191.1861,-15679.42 3239.7506,-14069.2269 3245.6699,-13865.225"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3249.1697,-13865.2784 3245.9597,-13855.1815 3242.1726,-13865.0764 3249.1697,-13865.2784"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M398.2172,-15448.1898C403.8317,-15550.7551 448.2883,-16325.5502 514.0276,-16402 583.4511,-16482.7342 638.4189,-16466 744.8972,-16466 744.8972,-16466 744.8972,-16466 920.1405,-16466 1023.8223,-16466 1070.5435,-16426.0915 1152.1868,-16490 1189.3829,-16519.1163 1156.9638,-16554.5537 1188.1868,-16590 1243.7447,-16653.0728 1281.7639,-16637.7721 1356.6204,-16676 1637.6831,-16819.5341 1682.1514,-16925.1738 1988.9868,-16999 2063.4528,-17016.9169 2100.139,-17045.0812 2161.3169,-16999 2405.4598,-16815.1036 2274.3638,-16633.8508 2351.1489,-16338 2368.9156,-16269.5455 2353.7005,-16245.3128 2387.1489,-16183 2436.3118,-16091.412 2504.9161,-16107.7001 2547.7793,-16013 2618.8271,-15856.0302 2534.3381,-15792.0542 2583.7793,-15627 2630.443,-15471.2182 2698.2719,-15456.1491 2755.6838,-15304 2780.1936,-15239.046 2741.213,-15199.6702 2791.6838,-15152 2817.5915,-15127.5299 2856.6132,-15170.7623 2870.6353,-15138"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node78" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node78"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1931.8015,-8722.0054 1806.323,-8722.0054 1806.323,-8699.9946 1931.8015,-8699.9946 1931.8015,-8722.0054"/>
<text text-anchor="middle" x="1869.0623" y="-8707.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge443" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M401.292,-15425.6959C416.2672,-15381.3999 476.9536,-15217.8655 582.7815,-15132"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-15132C878.2226,-14892.2882 1054.4738,-14997.2026 1356.6204,-14766 1462.3996,-14685.0577 1486.5521,-14654.4996 1551.1179,-14538 1576.8739,-14491.527 1555.7393,-14466.8776 1587.1179,-14424 1639.116,-14352.9467 1708.2798,-14387.9937 1749.1377,-14310 1780.2359,-14250.6366 1781.2707,-9551.9041 1785.1377,-9485 1802.4523,-9185.4324 1852.8515,-8823.3542 1865.9315,-8732.4736"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1869.4314,-8732.7253 1867.3995,-8722.3271 1862.5036,-8731.7229 1869.4314,-8732.7253"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge471" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2669.7316,-14340C2694.2128,-14172.9612 2735.6208,-14137.6269 2755.6838,-13970 2767.5817,-13870.5934 2732.1312,-10446.478 2791.6838,-10366 2794.001,-10362.8687 2796.712,-10360.1201 2799.7075,-10357.7084"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.8127,-10360.5125 2808.2265,-10352.0796 2797.9537,-10354.6722 2801.8127,-10360.5125"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-16922C597.6338,-16939.9906 979.0478,-16941.9453 1002.022,-16946 1337.9705,-17005.2911 1440.1602,-17266.6021 1749.1377,-17122 2008.1219,-17000.7949 2056.9989,-16894.2353 2161.3169,-16628 2217.9799,-16483.3875 2177.1587,-16084.0036 2197.3169,-15930 2250.1484,-15526.3813 2281.4088,-15427.0881 2387.1489,-15034 2446.682,-14812.6864 2489.5068,-14765.6488 2547.7793,-14544 2568.5233,-14465.097 2528.2907,-14423.8081 2583.7793,-14364 2610.7551,-14334.9242 2663.9801,-14379.243 2669.7316,-14340"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node80" class="node">
<title>sourcefile~hvacsteamcoilcomponent.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node80"><a xlink:href="../sourcefile/hvacsteamcoilcomponent.f90.html" xlink:title="HVACSteamCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2547.5949,-10428.0054 2387.3333,-10428.0054 2387.3333,-10405.9946 2547.5949,-10405.9946 2547.5949,-10428.0054"/>
<text text-anchor="middle" x="2467.4641" y="-10413.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSteamCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge507" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M582.7815,-15740C657.7907,-15782.5557 1296.0097,-15741.3491 1356.6204,-15680 1426.2537,-15609.5182 1327.3295,-15534.5225 1392.6204,-15460 1441.1234,-15404.639 1480.7582,-15433.6077 1551.1179,-15412 1618.9996,-15391.1533 2118.9139,-15278.9604 2161.3169,-15222 2216.0245,-15148.5107 2173.7909,-12012.5445 2197.3169,-11924 2233.3784,-11788.2756 2313.6689,-11783.3395 2351.1489,-11648 2418.2016,-11405.8746 2300.5687,-10753.8488 2387.1489,-10518 2399.4306,-10484.5441 2427.4624,-10453.6664 2446.927,-10435.0819"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.4729,-10437.4942 2454.4209,-10428.1257 2444.7106,-10432.3638 2449.4729,-10437.4942"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node81" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node81"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2514.0982,-12904.0054 2420.83,-12904.0054 2420.83,-12881.9946 2514.0982,-12881.9946 2514.0982,-12904.0054"/>
<text text-anchor="middle" x="2467.4641" y="-12889.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-13350C2297.5652,-13251.6621 2326.0306,-13233.8969 2351.1489,-13136 2376.5361,-13037.0553 2316.3536,-12982.6382 2387.1489,-12909 2393.5892,-12902.3011 2401.9761,-12897.9799 2410.8959,-12895.2589"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2411.8123,-12898.6384 2420.7171,-12892.8976 2410.1759,-12891.8324 2411.8123,-12898.6384"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-16542C811.935,-16563.5418 783.1894,-16626.1201 838.259,-16670 970.5955,-16775.4468 1022.4338,-16785.9715 1188.1868,-16820 1261.5168,-16835.0544 1287.0755,-16847.7026 1356.6204,-16820 1471.0155,-16774.4316 2111.8581,-16170.7677 2161.3169,-16058 2218.6702,-15927.2327 2160.4365,-13625.9468 2197.3169,-13488 2215.4525,-13420.1658 2258.0228,-13418.32 2274.2329,-13350"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node83" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node83"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1749.1476,-14154.0054 1587.108,-14154.0054 1587.108,-14131.9946 1749.1476,-14131.9946 1749.1476,-14154.0054"/>
<text text-anchor="middle" x="1668.1278" y="-14139.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-15740C597.0034,-15747.5438 1137.5151,-15638.6268 1152.1868,-15632 1170.6596,-15623.6563 1169.8603,-15612.6606 1188.1868,-15604 1257.5701,-15571.2111 1307.4773,-15624.9417 1356.6204,-15566 1419.0029,-15491.1789 1368.1584,-14784.2942 1392.6204,-14690 1450.253,-14467.8415 1606.5602,-14231.4432 1654.1745,-14162.7525"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.2962,-14164.3952 1660.1501,-14154.192 1651.5563,-14160.3885 1657.2962,-14164.3952"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node85" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node85"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="651.2902,-16706.0054 514.2728,-16706.0054 514.2728,-16683.9946 651.2902,-16683.9946 651.2902,-16706.0054"/>
<text text-anchor="middle" x="582.7815" y="-16691.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M398.2291,-15448.182C403.9511,-15550.9035 449.1875,-16331.7805 514.0276,-16556 527.0167,-16600.9167 554.0249,-16648.8625 570.053,-16675.0552"/>
<polygon fill="#00ffff" stroke="#00ffff" points="567.161,-16677.0326 575.4149,-16683.6751 573.1049,-16673.3352 567.161,-16677.0326"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node87" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node87"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2901.8233,-12827.0054 2839.4472,-12827.0054 2839.4472,-12804.9946 2901.8233,-12804.9946 2901.8233,-12827.0054"/>
<text text-anchor="middle" x="2870.6353" y="-12812.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-17264C1161.9706,-17469.4685 1329.6835,-17757.5634 1749.1377,-17557 2012.3777,-17431.1309 2056.5139,-17318.3135 2161.3169,-17046 2212.6403,-16912.6445 2176.0018,-16545.292 2197.3169,-16404 2303.611,-15699.4061 2371.8569,-15528.3233 2583.7793,-14848 2648.1946,-14641.2109 2710.4873,-14603.8214 2755.6838,-14392 2811.4302,-14130.7349 2772.9129,-14058.486 2791.6838,-13792 2818.6824,-13408.7087 2859.552,-12941.4124 2868.7521,-12837.2422"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2872.2561,-12837.351 2869.6509,-12827.0814 2865.2833,-12836.7341 2872.2561,-12837.351"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M398.5052,-15448.1534C405.1131,-15531.042 447.1273,-16059.7897 478.0276,-16490 486.5642,-16608.8516 465.6964,-16916.0841 514.0276,-17025 573.9308,-17159.9938 611.8529,-17199.8835 744.8972,-17264"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-17264C829.8978,-17354.6131 1307.1516,-18086.0322 1356.6204,-18200 1383.4027,-18261.7021 1339.7022,-18305.4776 1392.6204,-18347 1410.5637,-18361.0793 1731.7122,-18345.7791 1749.1377,-18340 1853.6982,-18305.323 1888.8949,-18288.597 1952.9868,-18199 1987.1203,-18151.2833 1965.1712,-18125.6171 1988.9868,-18072 2047.5381,-17940.1811 2104.7225,-17929.6708 2161.3169,-17797 2187.0322,-17736.7171 2179.6427,-17717.1105 2197.3169,-17654 2339.691,-17145.615 2436.9506,-17035.1809 2547.7793,-16519 2575.0439,-16392.0158 2547.5259,-16353.7158 2583.7793,-16229 2633.6074,-16057.5857 2695.5429,-16034.0738 2755.6838,-15866 2777.9094,-15803.887 2770.3908,-15784.4388 2791.6838,-15722 2848.2077,-15556.2515 2909.9264,-15531.5713 2949.5867,-15361 2990.2412,-15186.1525 2972.6661,-14733.0461 2985.5867,-14554 3005.2553,-14281.4424 3043.6548,-13951.4151 3053.8998,-13865.3439"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3057.3943,-13865.5979 3055.1053,-13855.2533 3050.4437,-13864.7675 3057.3943,-13865.5979"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node89" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node89"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2320.8568,-12292.0054 2227.609,-12292.0054 2227.609,-12269.9946 2320.8568,-12269.9946 2320.8568,-12292.0054"/>
<text text-anchor="middle" x="2274.2329" y="-12277.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-15894C1144.5494,-15888.9036 1141.9553,-15850.2601 1188.1868,-15832 1223.4772,-15818.0614 1240.9052,-15839.1554 1272.4036,-15818"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-15818C1310.9876,-15792.0855 1324.5295,-15789.6224 1356.6204,-15756 1376.5357,-15735.1342 1369.0798,-15718.6686 1392.6204,-15702 1539.5426,-15597.9677 1610.1053,-15644.1013 1785.1377,-15602 1859.5041,-15584.1123 1886.5158,-15601.841 1952.9868,-15564 1973.2046,-15552.4903 1969.9701,-15539.4015 1988.9868,-15526 2057.4115,-15477.7797 2115.2016,-15519.8607 2161.3169,-15450 2257.5475,-15304.2189 2093.8433,-12446.7326 2197.3169,-12306 2202.5745,-12298.8493 2209.9251,-12293.7056 2218.0146,-12290.0138"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2219.2968,-12293.2708 2227.3898,-12286.433 2216.7991,-12286.7315 2219.2968,-12293.2708"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node90" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node90"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1321.4031,-13656.0054 1223.4041,-13656.0054 1223.4041,-13633.9946 1321.4031,-13633.9946 1321.4031,-13656.0054"/>
<text text-anchor="middle" x="1272.4036" y="-13641.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M400.0793,-15425.7691C410.9875,-15375.6433 455.3866,-15167.2288 478.0276,-14994 490.9426,-14895.1855 477.9864,-14639.9093 514.0276,-14547 635.7409,-14233.2389 773.7501,-14215.2895 1002.022,-13968 1104.4782,-13857.0081 1217.6185,-13714.8519 1257.5044,-13664.0751"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1260.2599,-13666.2331 1263.675,-13656.2037 1254.7509,-13661.9144 1260.2599,-13666.2331"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node91" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node91"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2327.9637,-12370.0054 2220.5021,-12370.0054 2220.5021,-12347.9946 2327.9637,-12347.9946 2327.9637,-12370.0054"/>
<text text-anchor="middle" x="2274.2329" y="-12355.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-15818C1437.1104,-15708.7553 1729.2338,-15675.0617 1952.9868,-15602 2046.6785,-15571.407 2104.3307,-15606.4154 2161.3169,-15526 2209.4224,-15458.1165 2179.4634,-12612.2624 2197.3169,-12531 2210.1111,-12472.7657 2243.6789,-12410.2619 2261.9525,-12379.0905"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2265.1882,-12380.4978 2267.3023,-12370.116 2259.1755,-12376.9134 2265.1882,-12380.4978"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node92" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node92"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2724.8051,-11398.0054 2614.6581,-11398.0054 2614.6581,-11375.9946 2724.8051,-11375.9946 2724.8051,-11398.0054"/>
<text text-anchor="middle" x="2669.7316" y="-11383.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge448" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M398.2822,-15448.2856C404.884,-15559.0437 459.4046,-16453.2872 514.0276,-16715 533.8339,-16809.8971 517.9677,-16849.9103 582.7815,-16922"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-16922C614.1857,-16956.9296 640.6678,-16911.118 687.5354,-16908 826.9989,-16898.7218 862.2909,-16904.6244 1002.022,-16908 1159.626,-16911.8074 1199.9879,-16934.8835 1356.6204,-16917 1756.2237,-16871.3754 1965.8938,-16854.5313 2161.3169,-16503 2213.0999,-16409.8517 2161.6989,-14685.4462 2197.3169,-14585 2281.921,-14346.4081 2461.6564,-14374.0479 2547.7793,-14136 2590.9693,-14016.6207 2578.3887,-13120.8374 2583.7793,-12994 2611.3863,-12344.4192 2659.8261,-11547.9173 2668.4121,-11408.3563"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2671.9185,-11408.3578 2669.0404,-11398.1615 2664.9318,-11407.9272 2671.9185,-11408.3578"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge599" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-15666C1301.9287,-15640.642 1332.0671,-15672.1976 1356.6204,-15642 1426.6185,-15555.9107 1355.4209,-15248.5338 1392.6204,-15144 1433.752,-15028.4165 1490.5421,-15024.6861 1551.1179,-14918 1657.4026,-14730.8115 1702.2295,-14686.0847 1749.1377,-14476 1797.1356,-14261.0348 1769.1611,-12713.6783 1785.1377,-12494 1837.0076,-11780.7878 1809.2282,-11590.1336 1988.9868,-10898 2008.2055,-10824.0012 2046.4035,-10741.3296 2064.7895,-10703.6828"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2068.1314,-10704.8195 2069.4176,-10694.303 2061.854,-10701.722 2068.1314,-10704.8195"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge680" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-15550C836.0867,-15497.5668 1084.6811,-15402.7445 1188.1868,-15384 1261.848,-15370.6602 1301.5986,-15333.2405 1356.6204,-15384 1429.7041,-15451.4223 1350.6136,-15739.8754 1392.6204,-15830 1486.6897,-16031.824 1612.805,-16005.9451 1749.1377,-16182 1768.6468,-16207.1933 1766.3086,-16218.2945 1785.1377,-16244 1864.6811,-16352.593 1865.8708,-16413.5754 1988.9868,-16468 2059.0386,-16498.967 2093.43,-16503.4624 2161.3169,-16468 2452.8939,-16315.6876 2816.9402,-15516.0334 2949.5867,-15215 3035.9624,-15018.9753 3086.6018,-14977.3019 3127.3396,-14767 3165.6552,-14569.2022 3159.5439,-7715.4389 3163.3396,-7514 3183.0374,-6468.6384 3237.5857,-5181.5678 3245.3524,-5001.3332"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3248.8605,-5001.2182 3245.7955,-4991.0765 3241.8671,-5000.9161 3248.8605,-5001.2182"/>
</g>
<!-- sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node96" class="node">
<title>sourcefile~hvacmixercomponent.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node96"><a xlink:href="../sourcefile/hvacmixercomponent.f90.html" xlink:title="HVACMixerComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1937.9239,-7352.0054 1800.2006,-7352.0054 1800.2006,-7329.9946 1937.9239,-7329.9946 1937.9239,-7352.0054"/>
<text text-anchor="middle" x="1869.0623" y="-7337.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACMixerComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge671" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.23,-15425.9844C406.0387,-15382.6753 435.7512,-15221.4158 514.0276,-15118 554.3763,-15064.6929 948.1685,-14805.6164 1002.022,-14766 1160.7198,-14649.2566 1199.9359,-14619.432 1356.6204,-14500 1444.3639,-14433.1179 1700.2753,-14294.9172 1749.1377,-14196 1787.1772,-14118.9926 1779.5481,-8097.7083 1785.1377,-8012 1801.9381,-7754.3918 1851.7968,-7444.2648 1865.5272,-7361.906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1868.9829,-7362.4612 1867.1848,-7352.02 1862.0793,-7361.3035 1868.9829,-7362.4612"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge779" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-15970C1531.1017,-16032.6274 1908.3792,-16138.8 1952.9868,-16192 2023.9831,-16276.6717 1905.3873,-16365.7442 1988.9868,-16438 2017.9601,-16463.0419 2133.9995,-16464.8386 2161.3169,-16438 2201.666,-16398.3581 2179.9062,-14455.8182 2197.3169,-14402 2234.1531,-14288.1355 2290.6957,-14284.2833 2351.1489,-14181 2452.4272,-14007.9678 2495.6218,-13968.5899 2547.7793,-13775 2603.0871,-13569.7172 2565.8097,-13509.8421 2583.7793,-13298 2652.6395,-12486.2138 2704.7343,-12286.1068 2755.6838,-11473 2787.7188,-10961.7527 2772.3723,-10832.8858 2791.6838,-10321 2819.0529,-9595.536 2862.3198,-8704.7537 2869.5841,-8556.4015"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2873.0837,-8556.494 2870.0777,-8546.3346 2866.0921,-8556.1512 2873.0837,-8556.494"/>
</g>
<!-- sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node98" class="node">
<title>sourcefile~windturbine.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node98"><a xlink:href="../sourcefile/windturbine.f90.html" xlink:title="WindTurbine.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1712.2816,-12102.0054 1623.9741,-12102.0054 1623.9741,-12079.9946 1712.2816,-12079.9946 1712.2816,-12102.0054"/>
<text text-anchor="middle" x="1668.1278" y="-12087.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WindTurbine.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge793" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-15514C1295.5245,-15482.9837 1332.7668,-15522.4564 1356.6204,-15492 1447.6112,-15375.8221 1303.8852,-12953.9098 1392.6204,-12836 1436.8787,-12777.1903 1505.6933,-12845.9136 1551.1179,-12788 1643.4124,-12670.3303 1495.1337,-12233.9124 1587.1179,-12116 1593.9107,-12107.2925 1603.6806,-12101.5417 1614.099,-12097.7623"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.2334,-12101.0756 1623.7824,-12094.8174 1613.1966,-12094.3785 1615.2334,-12101.0756"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge724" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-15894C1152.1885,-15886.7281 1141.4413,-15837.5609 1188.1868,-15804 1256.6297,-15754.8614 1299.8578,-15779.2659 1356.6204,-15717 1385.3662,-15685.4672 1362.3318,-15658.054 1392.6204,-15628 1523.0161,-15498.6143 2057.1445,-15475.3005 2161.3169,-15324 2209.5706,-15253.9161 2183.1803,-12344.9067 2197.3169,-12261 2233.2021,-12048.0067 2307.1709,-12011.4706 2351.1489,-11800 2388.213,-11621.7753 2362.1394,-11572.3117 2387.1489,-11392 2439.729,-11012.9116 2509.6065,-10926.8091 2547.7793,-10546 2580.5412,-10219.1691 2575.9517,-7918.3755 2583.7793,-7590 2607.5375,-6593.3239 2660.9929,-5366.6456 2668.7785,-5190.4596"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.2786,-5190.5324 2669.2245,-5180.3873 2665.2854,-5190.2227 2672.2786,-5190.5324"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-15740C793.7762,-15849.6027 858.9052,-15921.2298 1095.1044,-15894"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge759" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-15894C1213.926,-15881.7529 1249.786,-15885.4321 1356.6204,-15832 1375.2478,-15822.6836 1374.233,-15811.7817 1392.6204,-15802 1449.8674,-15771.5457 1890.9432,-15657.8486 1952.9868,-15639 2045.9195,-15610.7674 2103.4039,-15650.9721 2161.3169,-15573 2204.8979,-15514.324 2182.5546,-13013.5838 2197.3169,-12942 2233.3696,-12767.1773 2303.9931,-12743.1601 2351.1489,-12571 2514.6971,-11973.9053 2477.3054,-11807.0638 2547.7793,-11192 2568.8544,-11008.0663 2563.5651,-10961.0303 2583.7793,-10777 2610.8566,-10530.4881 2654.5777,-10232.5268 2666.5909,-10151.9372"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2670.054,-10152.4438 2668.0706,-10142.0363 2663.1309,-10151.4091 2670.054,-10152.4438"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge849" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-15512C708.9495,-15494.3224 722.8761,-15436.0152 838.259,-15382 991.5076,-15310.2585 1024.0367,-15273.0698 1188.1868,-15232 1430.9271,-15171.2672 1501.1532,-15217.3922 1749.1377,-15184 1760.676,-15182.4463 2153.8306,-15116.9164 2161.3169,-15108 2199.5955,-15062.4088 2185.9797,-10880.4404 2197.3169,-10822 2232.8813,-10638.6743 2315.1794,-10614.2467 2351.1489,-10431 2411.2496,-10124.8172 2364.9405,-7934.2343 2387.1489,-7623 2403.8668,-7388.711 2450.2682,-7107.2257 2463.7476,-7028.4155"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2467.2437,-7028.7368 2465.4901,-7018.2882 2460.345,-7027.5499 2467.2437,-7028.7368"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462.3148,-14345.0054 332.9152,-14345.0054 332.9152,-14322.9946 462.3148,-14322.9946 462.3148,-14345.0054"/>
<text text-anchor="middle" x="397.615" y="-14330.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1010" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.5459,-14345.0947C417.515,-14378.3847 464.4509,-14479.9372 514.0276,-14558 567.9991,-14642.9828 611.8216,-14645.4916 651.5354,-14738 691.4856,-14831.059 669.5912,-14863.3305 687.5354,-14963 733.555,-15218.6113 767.5862,-15278.604 802.259,-15536 832.7128,-15762.0754 784.9116,-15826.2082 838.259,-16048 891.339,-16268.6799 931.3711,-16317.6436 1038.022,-16518 1220.5487,-16860.8981 1320.6506,-16915.3514 1587.1179,-17198 1656.9702,-17272.094 1708.0715,-17266.8183 1749.1377,-17360 1821.2633,-17523.6572 1715.2273,-17999.3843 1785.1377,-18164 1930.0086,-18505.1229 2070.0544,-18549.1577 2387.1489,-18741 2903.57,-19053.435 3104.6329,-19022.1601 3706.96,-19061 3799.6824,-19066.979 4038.2273,-19118.6382 4124.4445,-19084"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~datatimings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~datatimings.f90</title>
<path fill="none" stroke="#0099ff" stroke-dasharray="5,2" d="M1471.8691,-18934C1516.2552,-18955.1289 1572.9457,-18952.7602 1613.9744,-18946.6683"/>
<polygon fill="#0099ff" stroke="#0099ff" points="1614.7318,-18950.0916 1624.0509,-18945.0513 1613.6227,-18943.18 1614.7318,-18950.0916"/>
<path fill="none" stroke="#0099ff" stroke-dasharray="5,2" d="M402.4664,-14345.27C417.2244,-14380.1956 461.571,-14490.0433 478.0276,-14586 565.816,-15097.8843 450.8559,-15238.4986 514.0276,-15754 665.59,-16990.7977 1098.199,-17209.0422 1356.6204,-18428 1378.8963,-18533.0741 1325.4467,-18826.1878 1392.6204,-18910 1415.6359,-18938.7164 1438.6405,-18918.1823 1471.8691,-18934"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M402.3247,-14345.2956C416.6746,-14380.2946 459.9716,-14490.3314 478.0276,-14586 524.282,-14831.0759 460.0126,-14902.5168 514.0276,-15146 550.4035,-15309.9715 601.7693,-15337.5843 651.5354,-15498 738.8916,-15779.5832 758.5581,-15852.4345 802.259,-16144 836.9925,-16375.7361 766.9546,-16446.7877 838.259,-16670 866.3393,-16757.9027 1181.1665,-17364.1737 1272.4036,-17378"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-17378C1316.0468,-17385.7479 1445.7456,-17342.1904 1471.8691,-17378"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M409.5832,-14322.9707C427.457,-14305.7777 460.8558,-14270.7299 478.0276,-14234 512.5799,-14160.0937 480.4668,-14128.3618 514.0276,-14054 566.41,-13937.9346 589.9763,-13907.8372 687.5354,-13826 807.9928,-13724.9546 913.7576,-13794.1136 1002.022,-13664 1094.7743,-13527.2704 941.0177,-13427.7466 1038.022,-13294 1040.3841,-13290.7431 1043.2645,-13287.905 1046.4628,-13285.4325"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1048.4093,-13288.3423 1054.9533,-13280.01 1044.6416,-13282.4428 1048.4093,-13288.3423"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge931" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M419.4865,-14345.1178C442.8731,-14356.9979 481.051,-14376.3699 514.0276,-14393 575.0806,-14423.7891 594.2191,-14424.7136 651.5354,-14462 1041.322,-14715.5711 1182.5549,-14803.8004 1356.6204,-15235 1406.2054,-15357.8334 1357.703,-15702.2209 1392.6204,-15830 1442.6318,-16013.0157 1494.4854,-16044.4249 1587.1179,-16210 1654.7036,-16330.8054 1678.9724,-16356.6744 1749.1377,-16476 1953.7538,-16823.9773 1986.5238,-16921.7294 2197.3169,-17266 2277.3696,-17396.7434 2283.7904,-17440.7777 2387.1489,-17554 2727.5203,-17926.8539 2932.9415,-17957.7049 3436.8809,-17988"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge973" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M407.8472,-14345.3162C454.3345,-14396.7746 643.7165,-14606.9259 651.5354,-14624 699.3738,-14728.4647 635.0136,-14777.8098 687.5354,-14880 759.243,-15019.5195 1152.383,-15340.6462 1250.3066,-15419.3478"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1248.3588,-15422.2723 1258.3493,-15425.7996 1252.739,-15416.812 1248.3588,-15422.2723"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge995" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M443.5117,-14345.0973C494.3874,-14357.4239 578.8648,-14377.9675 651.5354,-14396 718.5864,-14412.6381 735.4921,-14416.2563 802.259,-14434 808.293,-14435.6036 1663.991,-14671.3238 1668.1278,-14676"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1004" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M402.5631,-14322.746C417.5994,-14287.8666 462.6618,-14178.1374 478.0276,-14082 555.9971,-13594.1755 473.2657,-10128.3317 514.0276,-9636 527.2693,-9476.0633 565.1763,-9285.9123 578.2691,-9223.2066"/>
<polygon fill="#ff0033" stroke="#ff0033" points="581.7144,-9223.8306 580.3484,-9213.3242 574.8643,-9222.3893 581.7144,-9223.8306"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-7948C1098.9648,-7945.9348 1353.181,-7774.709 1356.6204,-7772 1373.6715,-7758.5698 1373.2745,-7748.8412 1392.6204,-7739 1397.5463,-7736.4942 1402.8318,-7734.3806 1408.2496,-7732.5981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1409.4715,-7735.8878 1418.0956,-7729.7335 1407.5159,-7729.1664 1409.4715,-7735.8878"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.3827,-14322.7152C416.8997,-14287.7471 460.6263,-14177.7899 478.0276,-14082 534.6598,-13770.2535 494.4328,-13686.2422 514.0276,-13370 565.6741,-12536.4704 613.7373,-12330.2723 651.5354,-11496 693.3822,-10572.3646 627.4104,-10338.6259 687.5354,-9416 726.221,-8822.3644 520.2169,-8588.7415 838.259,-8086 894.1254,-7997.6898 941.6929,-8002.5026 1038.022,-7962 1062.1019,-7951.8753 1073.372,-7962.4933 1095.1044,-7948"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M402.5778,-14322.7483C417.6564,-14287.8756 462.8276,-14178.1637 478.0276,-14082 494.8178,-13975.7759 473.5274,-6438.6253 514.0276,-6339 640.3291,-6028.314 802.3831,-6034.6466 1038.022,-5796 1088.1826,-5745.1992 1114.745,-5743.7859 1152.1868,-5683 1179.3865,-5638.8418 1150.2665,-5607.3812 1188.1868,-5572 1190.3559,-5569.9761 1192.6894,-5568.1394 1195.1493,-5566.4729"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.0042,-5569.444 1203.9442,-5561.4385 1193.5267,-5563.3689 1197.0042,-5569.444"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.5663,-14322.7465C417.6118,-14287.8685 462.6979,-14178.1431 478.0276,-14082 520.8922,-13813.1663 493.6606,-9453.4666 514.0276,-9182 538.6355,-8854.007 415.9824,-7720 744.8972,-7720 744.8972,-7720 744.8972,-7720 920.1405,-7720 1078.7382,-7720 1132.7863,-7738.2346 1272.4036,-7663"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M452.4709,-14322.9621C610.2881,-14291.496 1079.2946,-14200.0113 1471.8691,-14144"/>
</g>
<!-- sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1011" class="edge">
<title>sourcefile~windowequivalentlayer.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4292.5994,-17778.9239C4298.5762,-17447.2659 4436.8393,-9775.0044 4445.0871,-9317.3316"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4448.5904,-9317.1766 4445.2712,-9307.1151 4441.5915,-9317.0504 4448.5904,-9317.1766"/>
</g>
<!-- sourcefile~datashadowingcombinations.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~datashadowingcombinations.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/datashadowingcombinations.f90.html" xlink:title="DataShadowingCombinations.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1952.9114,-14762.0054 1785.2131,-14762.0054 1785.2131,-14739.9946 1952.9114,-14739.9946 1952.9114,-14762.0054"/>
<text text-anchor="middle" x="1869.0623" y="-14747.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataShadowingCombinations.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1012" class="edge">
<title>sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-14788C2102.2987,-14817.041 2136.9541,-14780.5869 2161.3169,-14812 2222.0694,-14890.3335 2167.6584,-16501.4094 2197.3169,-16596 2234.2209,-16713.6986 2309.1318,-16711.0283 2351.1489,-16827 2376.5029,-16896.9798 2341.1127,-17101.5135 2387.1489,-17160 2551.4277,-17368.7072 2756.2183,-17179.9152 2949.5867,-17362 2979.1573,-17389.8452 2958.4511,-17415.7768 2985.5867,-17446 3046.1444,-17513.4483 3077.9051,-17515.7103 3163.3396,-17546 3335.2133,-17606.9355 3793.9748,-17645.6588 3972.2545,-17684"/>
</g>
<!-- sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge984" class="edge">
<title>sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1881.0333,-14762.0365C1915.2526,-14793.5842 2013.7199,-14884.3641 2055.7558,-14923.1182"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2053.4231,-14925.7281 2063.1478,-14929.9331 2058.1679,-14920.5815 2053.4231,-14925.7281"/>
</g>
<!-- sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge561" class="edge">
<title>sourcefile~datashadowingcombinations.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-16848C3489.2916,-16762.4795 3491.2663,-16732.803 3508.5469,-16634 3586.9828,-16185.538 3606.1167,-12678.5433 3607.6496,-12370.5821"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.1508,-12370.3195 3607.7,-12360.3024 3604.1509,-12370.2851 3611.1508,-12370.3195"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-14788C2102.2868,-14817.052 2136.9072,-14780.6233 2161.3169,-14812 2214.3422,-14880.1598 2147.7363,-16295.2949 2197.3169,-16366 2218.5278,-16396.2481 3417.5768,-16879.4992 3436.8809,-16848"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1953.1649,-14761.299C2006.2925,-14768.6203 2066.5101,-14778.7553 2075.1519,-14788"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-18292.0054 168.8556,-18292.0054 168.8556,-18269.9946 278.8255,-18269.9946 278.8255,-18292.0054"/>
<text text-anchor="middle" x="223.8406" y="-18277.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1013" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.7641,-18292.195C243.3102,-18393.3478 378.0879,-19149.9957 514.0276,-19330 557.4686,-19387.5223 591.5156,-19376.0806 651.5354,-19416 970.9844,-19628.467 1083.2744,-19644.794 1356.6204,-19914 1418.5482,-19974.9899 1389.561,-20044.0682 1471.8691,-20072"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-20072C1553.8073,-20101.9087 1584.1737,-20048.3338 1668.1278,-20072"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.6704,-18292.2741C242.3572,-18315.7012 274.7707,-18369.8816 317.2024,-18399 322.9527,-18402.9461 329.3521,-18406.2896 335.959,-18409.1181"/>
<polygon fill="#ff0000" stroke="#ff0000" points="335.1469,-18412.5568 345.736,-18412.9039 337.6745,-18406.0291 335.1469,-18412.5568"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M397.615,-17302C407.5259,-17257.9733 447.9975,-17273.6864 478.0276,-17240 684.4957,-17008.3932 630.7817,-16872.703 838.259,-16642 868.7828,-16608.0593 893.2883,-16616.9138 920.1405,-16580"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M744.8972,-18330C804.8056,-18304.2823 866.69,-18258.2381 898.4439,-18232.9131"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="900.9892,-18235.3567 906.5745,-18226.3537 896.5938,-18229.9086 900.9892,-18235.3567"/>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M232.3726,-18292.2848C247.2049,-18310.8495 279.765,-18347.1542 317.2024,-18361 406.5784,-18394.0547 657.3321,-18367.5903 744.8972,-18330"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge961" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M397.615,-18177C438.4006,-18161.0798 488.1984,-18162.0991 525.8753,-18166.5399"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="525.7965,-18170.0588 536.1631,-18167.8719 526.6954,-18163.1167 525.7965,-18170.0588"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge970" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M397.615,-17302C406.7081,-17257.7971 456.8366,-17279.8437 478.0276,-17240 537.1042,-17128.9228 490.3011,-16798.5526 514.0276,-16675 560.8504,-16431.1757 600.0275,-16376.3468 687.5354,-16144 747.5177,-15984.7379 740.2648,-15931.1382 838.259,-15792 895.4396,-15710.8115 943.3171,-15720.0933 1002.022,-15640 1024.1172,-15609.8547 1009.065,-15587.6311 1038.022,-15564 1058.26,-15547.4842 1071.455,-15561.0931 1095.1044,-15550"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M224.1603,-18269.9708C226.8837,-18180.3164 247.806,-17570.0913 317.2024,-17402 338.966,-17349.2845 383.284,-17357.2015 397.615,-17302"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge990" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M226.1629,-18292.0088C233.3225,-18322.8066 258.2339,-18409.8191 317.2024,-18444 446.5023,-18518.9482 505.6705,-18440.5444 651.5354,-18408 1189.4317,-18287.9882 1535.1635,-18338.8881 1749.1377,-17831 1797.9527,-17715.1328 1772.9136,-16825.1347 1785.1377,-16700 1839.4384,-16144.1374 1897.9509,-16011.0392 1988.9868,-15460 2020.9248,-15266.6801 2059.8422,-15032.9083 2071.6144,-14962.2325"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2075.0747,-14962.7603 2073.2655,-14952.321 2068.1698,-14961.61 2075.0747,-14962.7603"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge594" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M227.2348,-18269.8464C257.1704,-18173.9476 485.3322,-17492 920.1405,-17492 920.1405,-17492 920.1405,-17492 1095.1044,-17492 1167.7993,-17492 1697.4842,-17560.1514 1749.1377,-17509 1785.5059,-17472.9854 1778.8309,-13874.7929 1785.1377,-13824 1824.2403,-13509.0809 1912.8832,-13444.7932 1952.9868,-13130 1984.332,-12883.9563 1940.0392,-11141.1545 1988.9868,-10898 2004.139,-10822.7294 2044.6216,-10740.1372 2064.2202,-10703.0174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2067.3099,-10704.6617 2068.941,-10694.1932 2061.1376,-10701.3596 2067.3099,-10704.6617"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge755" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-18177C600.4765,-18097.8154 498.5761,-17890.2468 687.5354,-17782 777.7154,-17730.3397 816.2116,-17758 920.1405,-17758 920.1405,-17758 920.1405,-17758 1095.1044,-17758 1399.2033,-17758 1608.9159,-17826.8407 1749.1377,-17557 1801.6286,-17455.9873 1743.7265,-17152.0376 1785.1377,-17046 1828.6028,-16934.7031 1887.6808,-16936.0567 1952.9868,-16836 2062.1134,-16668.8049 2112.2728,-16631.5393 2161.3169,-16438 2230.8133,-16163.7512 2132.3401,-14167.3546 2197.3169,-13892 2233.4669,-13738.8055 2309.808,-13724.8759 2351.1489,-13573 2376.7412,-13478.9808 2335.4354,-13218.585 2387.1489,-13136 2431.1682,-13065.7025 2506.1139,-13112.7177 2547.7793,-13041 2579.375,-12986.615 2579.1237,-10839.7243 2583.7793,-10777 2602.1359,-10529.6857 2652.0698,-10232.296 2666.05,-10151.8874"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2669.5025,-10152.4627 2667.777,-10142.0093 2662.607,-10151.2571 2669.5025,-10152.4627"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M242.7387,-18269.9722C274.7917,-18251.2051 341.7775,-18211.7128 397.615,-18177"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1931.207,-2709.0054 1806.9175,-2709.0054 1806.9175,-2686.9946 1931.207,-2686.9946 1931.207,-2709.0054"/>
<text text-anchor="middle" x="1869.0623" y="-2694.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1014" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1878.798,-2686.8498C1896.7727,-2665.5787 1934.9737,-2617.0325 1952.9868,-2569 1993.0227,-2462.2431 1952.8386,-2423.1351 1988.9868,-2315 2319.0143,-1327.7449 2395.9242,-474 3436.8809,-474 3436.8809,-474 3436.8809,-474 3794.094,-474 3901.3334,-474 3927.5188,-496.6581 4027.281,-536 4072.8452,-553.9685 4075.8985,-581.4998 4124.4445,-588"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4124.4445,-588C4161.676,-590.6169 4277.4254,-553.8122 4292.3998,-588"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1874.4777,-2686.87C1887.9902,-2659.0363 1924.1777,-2584.1128 1952.9868,-2521 1969.5147,-2484.7919 1963.9029,-2469.903 1988.9868,-2439 2004.5757,-2419.7947 2338.6991,-2201.3743 2351.1489,-2180 2428.0749,-2047.9303 2315.5727,-1973.0439 2387.1489,-1838 2688.64,-1269.1727 2980.6996,-1277.7051 3544.5469,-967 3616.2664,-927.4793 3628.5151,-903.4942 3706.96,-880 3820.3728,-846.0329 3854.2365,-865.3799 3972.2545,-856"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3972.2545,-856C4039.5677,-849.3589 4056.8237,-854.3861 4124.4445,-856"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge992" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1931.5475,-2703.6025C1939.8695,-2706.9817 1947.4311,-2711.9046 1952.9868,-2719 2004.7176,-2785.0669 1965.8826,-14721.3334 1988.9868,-14802 2002.6128,-14849.5742 2037.6264,-14896.8007 2058.5879,-14922.0998"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2055.9767,-14924.4324 2065.1066,-14929.8078 2061.3215,-14919.9121 2055.9767,-14924.4324"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge893" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1876.1981,-2686.692C1893.3937,-2659.992 1939.3852,-2591.7702 1988.9868,-2545 2131.4733,-2410.6472 2251.0427,-2462.3206 2351.1489,-2294 2426.7904,-2166.8149 2295.8659,-2079.4693 2387.1489,-1963 2545.7248,-1760.6708 3296.8374,-1533.1832 3508.5469,-1679 3610.4059,-1749.1563 3485.5273,-1920.0805 3607.7534,-1939"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-1939C3707.6403,-1954.3268 3790.3611,-16168.782 3793.9712,-16797.5101"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3790.4733,-16797.9092 3794.0307,-16807.8889 3797.4732,-16797.869 3790.4733,-16797.9092"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge615" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1931.5223,-2703.6223C1939.8476,-2706.9989 1947.4168,-2711.9159 1952.9868,-2719 1997.0012,-2774.9786 1982.6571,-7775.0718 1988.9868,-7846 2028.997,-8294.338 2120.5979,-8395.7259 2161.3169,-8844 2179.0837,-9039.5938 2155.349,-12187.1373 2197.3169,-12379 2210.0576,-12437.2461 2243.6481,-12499.7448 2261.9392,-12530.9124"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2259.1642,-12533.0924 2267.2944,-12539.8858 2265.1751,-12529.505 2259.1642,-12533.0924"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge633" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1931.3826,-2705.9756C1939.3168,-2709.0783 1946.8082,-2713.2932 1952.9868,-2719 1989.8454,-2753.0437 1972.2834,-2778.6869 1988.9868,-2826 2062.4983,-3034.2241 2119.6378,-3075.1497 2161.3169,-3292 2176.086,-3368.8413 2149.2248,-4638.2759 2197.3169,-4700 2240.9486,-4755.9994 2306.9472,-4687.4494 2351.1489,-4743 2405.307,-4811.0631 2377.9845,-5438.5032 2387.1489,-5525 2406.1603,-5704.4343 2449.0221,-5918.4289 2462.9791,-5985.6927"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2459.6314,-5986.7843 2465.1009,-5995.8582 2466.4837,-5985.354 2459.6314,-5986.7843"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge649" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1931.3701,-2703.7434C1939.7151,-2707.1044 1947.3302,-2711.9848 1952.9868,-2719 2032.5343,-2817.6541 1928.3395,-3747.724 1988.9868,-3859 2033.5297,-3940.7274 2116.5952,-3896.3703 2161.3169,-3978 2214.7913,-4075.6057 2184.0465,-4868.4999 2197.3169,-4979 2237.7342,-5315.5485 2312.126,-5389.287 2351.1489,-5726 2417.7411,-6300.5976 2341.6971,-6450.3449 2387.1489,-7027 2405.6052,-7261.1584 2450.7872,-7542.7354 2463.8638,-7621.5758"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2460.456,-7622.419 2465.5532,-7631.7071 2467.3607,-7621.2676 2460.456,-7622.419"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge822" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1931.3653,-2704.2649C1939.6032,-2707.5727 1947.1873,-2712.2999 1952.9868,-2719 2004.737,-2778.786 1976.0626,-2994.991 1988.9868,-3073 2044.6061,-3408.7109 2116.1479,-3481.7241 2161.3169,-3819 2215.4566,-4223.2603 2123.6388,-4334.8404 2197.3169,-4736 2236.1062,-4947.1982 2311.9424,-4982.8788 2351.1489,-5194 2418.8089,-5558.3386 2348.2471,-5658.4798 2387.1489,-6027 2405.8202,-6203.8746 2448.7299,-6414.6156 2462.8595,-6481.5189"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2459.5104,-6482.5974 2465.0125,-6491.6516 2466.3575,-6481.1425 2459.5104,-6482.5974"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge868" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1919.6385,-2709.109C1930.7355,-2711.974 1942.3451,-2715.306 1952.9868,-2719 2009.2386,-2738.5263 2024.6293,-2742.4879 2075.1519,-2774"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2075.1519,-2774C2108.882,-2795.0383 2123.1165,-2786.9972 2161.3169,-2798 2333.5205,-2847.5996 2377.6634,-2856.6547 2547.7793,-2913 2641.172,-2943.9333 2681.1358,-2924.7998 2755.6838,-2989 2781.0023,-3010.8041 2773.2657,-3027.1214 2791.6838,-3055 2822.8978,-3102.2469 2849.3669,-3102.5192 2870.6353,-3155"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1931.382,-2703.7339C1939.7254,-2707.096 1947.337,-2711.9793 1952.9868,-2719 2037.5919,-2824.1332 1912.8031,-3821.613 1988.9868,-3933 2035.9451,-4001.6569 2114.4686,-3937.2681 2161.3169,-4006 2203.9174,-4068.4999 2184.4875,-5292.4584 2197.3169,-5367 2234.8125,-5584.8575 2314.3834,-5622.0181 2351.1489,-5840 2384.8434,-6039.7735 2380.8203,-7460.5038 2387.1489,-7663 2411.0432,-8427.5459 2458.5124,-9366.4263 2466.355,-9519.4635"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.8778,-9519.9999 2466.8861,-9529.8072 2469.8686,-9519.6409 2462.8778,-9519.9999"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge524" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2274.2329,-2508C2430.9598,-2457.9606 2436.9812,-2379.2804 2583.7793,-2305 2683.7907,-2254.3938 2960.5203,-2071.0498 3056.4631,-2129"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1887.1936,-2686.7999C1942.6806,-2653.1317 2116.0334,-2552.4269 2274.2329,-2508"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge597" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1931.5361,-2703.6115C1939.8596,-2706.9895 1947.4246,-2711.9097 1952.9868,-2719 1985.0614,-2759.8861 1984.2627,-10150.2493 1988.9868,-10202 2005.3906,-10381.6955 2054.016,-10594.827 2069.9974,-10661.7913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2066.6897,-10663.0062 2072.4307,-10671.9108 2073.4957,-10661.3696 2066.6897,-10663.0062"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge684" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-2508C2659.4226,-2453.4251 2889.9387,-2395.795 3127.3396,-2704 3200.0952,-2798.4548 3241.2916,-4733.1039 3245.8526,-4958.6113"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.3571,-4958.8776 3246.0572,-4968.8053 3249.3557,-4958.737 3242.3571,-4958.8776"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge778" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-2774C2108.882,-2795.0383 2134.2698,-2768.8661 2161.3169,-2798 2216.8246,-2857.7904 2155.0305,-2908.2299 2197.3169,-2978 2220.0751,-3015.5497 2241.0674,-3011.2256 2274.2329,-3040"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-3040C2322.9173,-3082.2387 2330.109,-3100.9879 2387.1489,-3131 2453.089,-3165.6949 2488.8016,-3133.4648 2547.7793,-3179 2688.5794,-3287.7081 2706.9003,-3349.9377 2755.6838,-3521 2784.8694,-3623.3411 2787.6389,-7245.6555 2791.6838,-7352 2809.5906,-7822.7802 2858.5868,-8397.3677 2868.7675,-8513.8315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2865.2921,-8514.2656 2869.6528,-8523.9213 2872.2653,-8513.6536 2865.2921,-8514.2656"/>
</g>
<!-- sourcefile~datadaylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datadaylightingdevices.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datadaylightingdevices.f90.html" xlink:title="DataDaylightingDevices.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1542.353,-18830.0054 1401.3853,-18830.0054 1401.3853,-18807.9946 1542.353,-18807.9946 1542.353,-18830.0054"/>
<text text-anchor="middle" x="1471.8691" y="-18815.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDaylightingDevices.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1015" class="edge">
<title>sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2870.6353,-19578C3036.2257,-19599.2787 3079.3252,-19578 3246.2772,-19578 3246.2772,-19578 3246.2772,-19578 3607.7534,-19578 3773.2378,-19578 3806.7781,-19652.3747 3972.2545,-19654"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3972.2545,-19654C4067.5865,-19649.8609 4116.8052,-19696.1174 4185.6079,-19630 4298.7503,-19521.2735 4140.2446,-18970.3595 4292.3998,-18932"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-19464C1890.4006,-19476.6074 2731.068,-19561.1129 2755.6838,-19564 2806.8005,-19569.9953 2819.7005,-19570.6174 2870.6353,-19578"/>
</g>
<!-- sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1473.8994,-18807.6963C1483.2689,-18755.3745 1523.0676,-18531.4192 1551.1179,-18347 1601.7847,-18013.8866 1653.4212,-17606.4042 1665.4941,-17510.0986"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1668.9706,-17510.5039 1666.7396,-17500.1466 1662.0248,-17509.6346 1668.9706,-17510.5039"/>
</g>
<!-- sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge933" class="edge">
<title>sourcefile~datadaylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1539.4398,-18830.0183C1617.0564,-18843.336 1735.5272,-18865.9534 1749.1377,-18882 1824.0631,-18970.3361 1729.4194,-19300.4492 1785.1377,-19402 1807.445,-19442.6567 1829.1476,-19440.3905 1869.0623,-19464"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1869.0623,-19464C1902.463,-19483.7343 1918.3947,-19457.5625 1952.9868,-19440 1971.0606,-19430.8239 1970.8815,-19421.1138 1988.9868,-19412 2060.0035,-19376.2517 2085.9437,-19389.302 2161.3169,-19364 2313.8904,-19312.7827 3390.9721,-18941.9003 3508.5469,-18832 3596.2577,-18750.0144 3874.7053,-17925.9926 3972.2545,-17856"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1016" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12620C1506.9094,-12629.1683 1526.6847,-12612.2625 1551.1179,-12639 1625.6578,-12720.5695 1527.4391,-12792.0042 1587.1179,-12885 1633.4621,-12957.2167 1706.7197,-12915.4094 1749.1377,-12990 1800.6964,-13080.6641 1756.695,-13827.6542 1785.1377,-13928 1835.3853,-14105.2735 1893.4149,-14131.4668 1988.9868,-14289 2061.8579,-14409.115 2119.438,-14419.8957 2161.3169,-14554 2244.1537,-14819.2594 2138.1937,-15532.4693 2197.3169,-15804 2243.412,-16015.6977 2291.9241,-16058.3903 2387.1489,-16253 2548.9846,-16583.7415 2552.2185,-16696.291 2791.6838,-16976 2862.8976,-17059.1816 2891.9774,-17071.1855 2985.5867,-17128 3128.9691,-17215.0235 3208.4133,-17167.6445 3329.2148,-17284 3354.9828,-17308.8196 3340.3213,-17330.3035 3365.2148,-17356 3378.5507,-17369.766 3954.0096,-17678.1289 3972.2545,-17684"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1471.8691,-12620C1506.8245,-12629.4869 1525.5229,-12613.3725 1551.1179,-12639 1599.8717,-12687.8157 1553.4526,-12729.7792 1587.1179,-12790 1636.8066,-12878.8836 1707.9157,-12858.8871 1749.1377,-12952 1816.5046,-13104.1694 1706.6264,-13553.2696 1785.1377,-13700 1828.8948,-13781.778 1906.2445,-13743.8908 1952.9868,-13824 2019.3303,-13937.7027 1948.5912,-13992.7085 1988.9868,-14118 2037.8361,-14269.5114 2119.4099,-14278.4234 2161.3169,-14432 2229.6186,-14682.3051 2139.8422,-15345.9893 2197.3169,-15599 2220.8606,-15702.6423 2521.5273,-16387.8564 2583.7793,-16474 2661.4444,-16581.4719 3083.4534,-16897.1675 3329.2148,-17100 3425.4177,-17179.3984 3430.6573,-17229.1251 3544.5469,-17280 3632.2353,-17319.1707 3896.8918,-17401.5319 3972.2545,-17342"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M921.0415,-11836.1212C928.5949,-11929.8884 981.5945,-12598.3012 1002.022,-13142 1025.1015,-13756.2853 974.1999,-15296.6034 1038.022,-15908 1048.6377,-16009.6959 1077.4873,-16128.8126 1089.6161,-16176.1152"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1086.234,-16177.0167 1092.1296,-16185.8197 1093.0104,-16175.2616 1086.234,-16177.0167"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M920.6559,-11836.1212C926.4354,-11959.6208 979.9647,-13072.6611 1038.022,-13206 1045.707,-13223.6501 1060.3787,-13239.6687 1072.9228,-13251.1366"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1070.9304,-13254.0435 1080.764,-13257.9869 1075.5358,-13248.7719 1070.9304,-13254.0435"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge934" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1095.1044,-13384C1105.9164,-13409.3084 1134.4466,-13386.9596 1152.1868,-13408 1197.7746,-13462.0688 1144.6323,-13507.2803 1188.1868,-13563 1214.0687,-13596.1111 1244.0908,-13574.9419 1272.4036,-13606"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3794.094,-17988C3879.2409,-17938.3851 3878.1349,-17885.2085 3972.2545,-17856"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1272.4036,-13606C1298.2533,-13634.3563 1320.85,-13611.1159 1356.6204,-13625 1449.4061,-13661.0144 1493.3869,-13654.9238 1551.1179,-13736 1601.4769,-13806.7231 1539.5492,-13855.3709 1587.1179,-13928 1634.8052,-14000.8101 1706.5984,-13962.0671 1749.1377,-14038 1790.7817,-14112.3349 1729.4844,-14739.4817 1785.1377,-14804 1840.786,-14868.5125 2106.6018,-14812.6941 2161.3169,-14878 2231.8652,-14962.2039 2136.5293,-16763.5001 2197.3169,-16855 2238.6816,-16917.2638 2307.7554,-16862.1328 2351.1489,-16923 2406.4276,-17000.5382 2324.9836,-17277.8656 2387.1489,-17350 2435.0411,-17405.5723 2478.3395,-17364.3345 2547.7793,-17388 2643.7657,-17420.7127 2663.8929,-17438.8961 2755.6838,-17482 2871.8603,-17536.5551 3683.199,-18052.6183 3794.094,-17988"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge971" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M920.9271,-11836.1263C927.5392,-11929.9352 974.2904,-12598.6248 1002.022,-13142 1022.4713,-13542.6866 985.485,-13646.2466 1038.022,-14044 1068.0972,-14271.6972 1111.388,-14321.9779 1152.1868,-14548 1214.3268,-14892.2507 1259.9676,-15316.7644 1270.2269,-15415.7031"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1266.7709,-15416.3105 1271.2779,-15425.8988 1273.734,-15415.5926 1266.7709,-15416.3105"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge996" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1869.0623,-14942C1916.2192,-14964.3163 1976.5156,-14960.8867 2019.6855,-14953.7998"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2020.4789,-14957.2141 2029.7223,-14952.0362 2019.2674,-14950.3197 2020.4789,-14957.2141"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1272.4036,-13606C1298.2533,-13634.3563 1328.273,-13599.1405 1356.6204,-13625 1394.9359,-13659.9528 1362.8984,-13693.4985 1392.6204,-13736 1443.8771,-13809.2956 1504.2852,-13783.8016 1551.1179,-13860 1594.2938,-13930.2485 1537.1353,-13976.4199 1587.1179,-14042 1635.9186,-14106.0293 1705.2728,-14055.4934 1749.1377,-14123 1797.3165,-14197.1457 1730.314,-14848.6232 1785.1377,-14918 1809.191,-14948.4383 1833.9956,-14925.4052 1869.0623,-14942"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.6915,-11836.2769C927.2158,-11968.9196 990.3325,-13228.1722 1038.022,-13289 1054.5193,-13310.0424 1075.1205,-13290.2352 1095.1044,-13308"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-13308C1115.0883,-13325.7648 1129.1388,-13302.5548 1152.1868,-13289 1170.8961,-13277.9968 1168.3081,-13264.715 1188.1868,-13256 1260.2484,-13224.4074 1352.3849,-13222.8256 1411.7639,-13226.147"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1411.8948,-13229.662 1422.0938,-13226.7929 1412.3317,-13222.6756 1411.8948,-13229.662"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M925.137,-11813.7499C940.327,-11778.8818 985.9016,-11669.1818 1002.022,-11573 1038.8524,-11353.2514 989.8334,-9785.5403 1038.022,-9568 1065.0529,-9445.973 1123.5337,-9432.6563 1152.1868,-9311 1234.4935,-8961.5384 1124.5921,-8857.3461 1188.1868,-8504 1231.4428,-8263.6601 1286.3565,-8214.8746 1356.6204,-7981 1373.7472,-7923.9931 1354.369,-7897.6064 1392.6204,-7852 1442.8238,-7792.1433 1508.7154,-7841.6143 1551.1179,-7776 1596.7835,-7705.3365 1574.7412,-6345.2196 1587.1179,-6262 1602.5738,-6158.0769 1643.4544,-6038.5856 1660.4983,-5991.544"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.7854,-5992.7458 1663.935,-5982.152 1657.2117,-5990.3403 1663.7854,-5992.7458"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M925.1411,-11813.7506C940.343,-11778.8845 985.9481,-11669.1895 1002.022,-11573 1079.6455,-11108.4842 952.3841,-9917.1053 1038.022,-9454 1065.0237,-9307.9822 1124.0201,-9285.7976 1152.1868,-9140 1175.2141,-9020.8047 1138.8058,-8158.9022 1188.1868,-8048 1230.4354,-7953.116 1292.4915,-7967.7032 1356.6204,-7886 1376.294,-7860.9349 1374.7423,-7850.3758 1392.6204,-7824 1412.8634,-7794.1351 1439.1925,-7761.6556 1455.817,-7741.809"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1458.5294,-7744.0218 1462.3016,-7734.1212 1453.1787,-7739.5085 1458.5294,-7744.0218"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M925.1713,-11813.7556C940.4603,-11778.9039 986.2894,-11669.246 1002.022,-11573 1067.2526,-11173.9431 1003.1949,-8336.8505 1038.022,-7934 1065.021,-7621.6977 1123.3592,-7550.1388 1152.1868,-7238 1156.4436,-7191.9076 1159.2968,-5608.1663 1188.1868,-5572 1190.3028,-5569.351 1192.6975,-5567.0054 1195.3054,-5564.9303"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.218,-5567.8616 1203.7037,-5559.484 1193.4092,-5561.9885 1197.218,-5567.8616"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge896" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-12620C1341.7566,-12675.2198 1386.4453,-12596.2968 1471.8691,-12620"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-12091C1275.4214,-12261.2128 1078.4176,-12465.5459 1272.4036,-12620"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12620C1570.725,-12647.4303 1498.2929,-12471.3323 1587.1179,-12420 1649.4644,-12383.9697 1697.0398,-12370.2901 1749.1377,-12420 1810.8633,-12478.8964 1747.5652,-13110.4028 1785.1377,-13187 1828.297,-13274.9868 1900.4562,-13247.2658 1952.9868,-13330 1985.5816,-13381.3358 1968.9071,-13404.6015 1988.9868,-13462 2052.9066,-13644.7167 2118.3082,-13673.2637 2161.3169,-13862 2247.3992,-14239.7577 2128.0451,-14351.8013 2197.3169,-14733 2236.3879,-14948.0051 2295.4341,-14988.6955 2351.1489,-15200 2371.9494,-15278.8881 2358.8198,-15303.4921 2387.1489,-15380 2445.2094,-15536.8031 2700.2763,-15878.24 2755.6838,-16036 2788.2248,-16128.6528 2750.3714,-16164.9116 2791.6838,-16254 2817.829,-16310.3809 3119.4602,-16627.989 3163.3396,-16672 3250.3324,-16759.2538 3250.6816,-16816.5788 3365.2148,-16862 3424.4314,-16885.4839 3446.1711,-16874.9366 3508.5469,-16862 3555.6009,-16852.2411 3562.5572,-16802.6715 3607.7534,-16819"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge923" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-12620C1598.5759,-12655.6038 1673.1519,-12616.5365 1749.1377,-12724 1819.5962,-12823.6465 1718.1085,-13170.0151 1785.1377,-13272 1831.1757,-13342.0467 1905.3112,-13289.0575 1952.9868,-13358 1993.437,-13416.4941 1973.1981,-13606.6567 1988.9868,-13676 2040.7037,-13903.1378 2117.3805,-13942.2298 2161.3169,-14171 2229.1989,-14524.4519 2130.4961,-14626.346 2197.3169,-14980 2245.7956,-15236.5774 2281.8568,-15297.0529 2387.1489,-15536 2460.5062,-15702.475 2494.0444,-15736.7507 2583.7793,-15895 2658.2524,-16026.3349 2701.4669,-16047.09 2755.6838,-16188 2784.0423,-16261.7037 2755.9048,-16291.599 2791.6838,-16362 2847.3986,-16471.6277 3073.3122,-16688.2299 3163.3396,-16772 3293.6808,-16893.2819 3661.9089,-17385.2695 3794.094,-17266"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3794.094,-17266C3917.9005,-17157.2873 3959.0536,-16946.7277 3969.3587,-16879.3124"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3972.8687,-16879.4972 3970.8475,-16869.0969 3965.9419,-16878.4876 3972.8687,-16879.4972"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge564" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-13608C1501.071,-13630.3963 1526.8664,-13604.3195 1551.1179,-13632 1616.4088,-13706.5225 1536.1889,-13767.0134 1587.1179,-13852 1633.729,-13929.7812 1705.4434,-13896.5437 1749.1377,-13976 1836.8549,-14135.5101 1709.6348,-14218.3586 1785.1377,-14384 1810.1092,-14438.7836 2138.099,-14718.4504 2161.3169,-14774 2192.8843,-14849.5261 2150.6181,-16179.7697 2197.3169,-16247 2268.7295,-16349.8098 3121.3568,-16649.9681 3246.2772,-16658"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge620" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1095.1044,-13308C1312.6693,-13504.3543 1485.8583,-13520.738 1749.1377,-13392 1881.6792,-13327.19 1891.5757,-13264.1502 1952.9868,-13130 1986.9453,-13055.819 1956.5394,-13024.8543 1988.9868,-12950 2059.8548,-12786.5117 2205.4573,-12623.7008 2256.2648,-12569.6969"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2258.9791,-12571.921 2263.317,-12562.2549 2253.898,-12567.1061 2258.9791,-12571.921"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge639" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M922.3695,-11813.922C931.0172,-11773.1161 965.5268,-11628.7098 1038.022,-11535 1076.7293,-11484.9656 1119.1065,-11503.9203 1152.1868,-11450 1201.7059,-11369.2847 1143.3234,-11323.393 1188.1868,-11240 1236.8145,-11149.6096 1294.8163,-11163.9472 1356.6204,-11082 1377.6858,-11054.0689 1372.4116,-11040.5571 1392.6204,-11012 1465.356,-10909.2167 1476.3636,-10865.903 1587.1179,-10806 1594.2446,-10802.1454 2156.0911,-10709.1918 2161.3169,-10703 2235.653,-10614.9222 2123.0933,-6642.1726 2197.3169,-6554 2219.6936,-6527.418 2266.7426,-6573.9296 2274.2329,-6540"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge650" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M924.7561,-11813.6772C938.8497,-11778.6 981.6038,-11668.3619 1002.022,-11573 1033.1888,-11427.4369 1019.6063,-11387.7189 1038.022,-11240 1082.8886,-10880.1079 1115.8725,-10792.8554 1152.1868,-10432 1165.4946,-10299.7603 1151.1511,-9962.6433 1188.1868,-9835 1231.3374,-9686.2813 1307.9764,-9677.0136 1356.6204,-9530 1394.0963,-9416.739 1348.0442,-9374.6592 1392.6204,-9264 1447.3428,-9128.153 1491.8308,-9109.2175 1587.1179,-8998 1653.3708,-8920.6707 1701.6275,-8926.0669 1749.1377,-8836 1789.6451,-8759.2085 1750.1955,-8723.4784 1785.1377,-8644 1835.2061,-8530.116 1909.9957,-8536.7398 1952.9868,-8420 1975.0702,-8360.0339 1946.0783,-7893.3547 1988.9868,-7846 2015.0381,-7817.2494 2048.9888,-7860.6489 2075.1519,-7832"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge718" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3056.4631,-15404C3330.2719,-15432.066 3266.1348,-15115.9176 3329.2148,-14848 3365.0185,-14695.9326 3363.9342,-9380.2202 3365.2148,-9224 3390.2287,-6172.5884 3433.0367,-2390.9237 3436.638,-2074.3128"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3440.1393,-2074.2096 3436.7535,-2064.1704 3433.1398,-2074.1298 3440.1393,-2074.2096"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-12358C1694.1844,-12385.0397 1725.9536,-12352.4603 1749.1377,-12382 1800.5099,-12447.455 1740.0475,-13060.0691 1785.1377,-13130 1830.5607,-13200.4471 1894.0467,-13156.4005 1952.9868,-13216 2025.9655,-13289.7952 2135.7063,-13533.423 2161.3169,-13634 2188.5061,-13740.7764 2151.812,-14524.6518 2197.3169,-14625 2250.5344,-14742.3563 2937.2152,-15452.8316 3056.4631,-15404"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge813" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1095.1044,-12091C1099.6946,-12095.195 1982.7711,-12038.1841 1988.9868,-12038 2065.5444,-12035.7324 2088.8714,-12013.1434 2161.3169,-12038 2180.4895,-12044.5783 2178.1442,-12059.4217 2197.3169,-12066 2261.986,-12088.1885 2291.8664,-12100.0589 2351.1489,-12066 2529.1381,-11963.7418 2417.9436,-11787.9768 2583.7793,-11667 2646.993,-11620.8857 2705.5066,-11689.0395 2755.6838,-11629 2821.3575,-11550.4183 2763.4444,-10806.4411 2791.6838,-10708 2830.6529,-10572.1559 2911.5697,-10568.1136 2949.5867,-10432 2992.5218,-10278.2777 2970.9185,-9154.9302 2985.5867,-8996 3000.6456,-8832.8355 3038.9759,-8638.6207 3052.0305,-8575.1779"/>
<polygon fill="#003fff" stroke="#003fff" points="3055.4962,-8575.7018 3054.098,-8565.1996 3048.6418,-8574.2814 3055.4962,-8575.7018"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge823" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M925.1094,-11813.7452C940.2199,-11778.8637 985.59,-11669.129 1002.022,-11573 1029.6068,-11411.6251 986.4261,-10255.3726 1038.022,-10100 1065.6673,-10016.7505 1124.0086,-10022.0706 1152.1868,-9939 1221.192,-9735.5693 1133.6997,-9180.7906 1188.1868,-8973 1229.6527,-8814.8663 1310.5706,-8802.8602 1356.6204,-8646 1403.9082,-8484.9224 1316.9141,-8419.8355 1392.6204,-8270 1435.2726,-8185.584 1503.0178,-8209.435 1551.1179,-8128 1587.3054,-8066.7335 1548.5899,-8031.8223 1587.1179,-7972 1636.2166,-7895.7647 1691.7566,-7918.2133 1749.1377,-7848 1772.2819,-7819.68 1758.9212,-7799.5025 1785.1377,-7774 1843.8368,-7716.8996 1906.0992,-7765.1386 1952.9868,-7698 2015.2471,-7608.8493 1954.4335,-7313.1032 1988.9868,-7210 1998.2735,-7182.2897 2255.5049,-6790.4358 2274.2329,-6768"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge869" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1471.8691,-11786C1542.2989,-11776.2752 1714.7256,-11841.1478 1785.1377,-11851 1875.1058,-11863.5885 1898.2035,-11862.6644 1988.9868,-11866 2065.5263,-11868.8122 2086.8523,-11883.9228 2161.3169,-11866 2253.4324,-11843.8289 2284.6319,-11836.4709 2351.1489,-11769 2376.5459,-11743.2388 2363.2906,-11723.1923 2387.1489,-11696 2517.0295,-11547.9694 2659.8374,-11622.0334 2755.6838,-11450 2812.2826,-11348.4117 2720.8399,-10496.2211 2791.6838,-10404 2814.0261,-10374.916 2865.0592,-10416.2486 2870.6353,-10380"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M934.6358,-11813.8854C956.8543,-11796.8596 1000.683,-11763.317 1038.022,-11735 1088.6381,-11696.614 1116.171,-11701.3291 1152.1868,-11649 1184.9643,-11601.3759 1158.9306,-11573.8648 1188.1868,-11524 1242.0098,-11432.2631 1301.2816,-11444.8306 1356.6204,-11354 1383.6044,-11309.7096 1363.1461,-11285.6737 1392.6204,-11243 1443.9203,-11168.7265 1487.9912,-11180.5233 1551.1179,-11116 1569.519,-11097.1918 1565.1175,-11083.4335 1587.1179,-11069 1697.0658,-10996.8683 2078.3194,-11027.9948 2161.3169,-10926 2225.3956,-10847.2543 2169.2971,-10110.58 2197.3169,-10013 2225.9301,-9913.3535 2404.2513,-9637.3278 2454.3728,-9560.8627"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2457.5139,-9562.4558 2460.0786,-9552.1761 2451.6631,-9558.6127 2457.5139,-9562.4558"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1272.4036,-12620C1303.0602,-12644.4092 1344.6576,-12654.9797 1381.9334,-12659.1248"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1382.0292,-12662.6504 1392.3198,-12660.1297 1382.7033,-12655.6829 1382.0292,-12662.6504"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge525" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3246.2772,-16354C3376.0496,-16203.1363 3307.7152,-16111.8345 3329.2148,-15914 3410.4189,-15166.7802 3434.4331,-12630.7473 3436.6985,-12370.5968"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3440.2015,-12370.2591 3436.7877,-12360.2293 3433.2017,-12370.1988 3440.2015,-12370.2591"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1668.1278,-13838C1689.656,-13868.7674 1725.5693,-13832.766 1749.1377,-13862 1816.8296,-13945.9643 1717.0484,-14262.3576 1785.1377,-14346 1834.1217,-14406.1729 1898.9584,-14338.3121 1952.9868,-14394 1998.3234,-14440.7291 1948.1437,-14485.2964 1988.9868,-14536 2042.6843,-14602.6612 2115.466,-14549.717 2161.3169,-14622 2208.6447,-14696.6114 2138.4319,-16146.1264 2197.3169,-16212 2236.509,-16255.8435 3207.9276,-16398.5824 3246.2772,-16354"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge545" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M920.6757,-11836.3115C926.6723,-11962.1376 982.0929,-13101.6697 1038.022,-13436 1043.4073,-13468.1924 1169.9326,-13976.942 1188.1868,-14004 1201.4916,-14023.7216 1223.0676,-14039.6872 1241.0495,-14050.6118"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1239.6592,-14053.8522 1250.0624,-14055.8583 1243.1808,-14047.8026 1239.6592,-14053.8522"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-11825C1228.6677,-11810.8476 1259.2644,-11787.989 1392.6204,-11772 1477.5889,-11761.8125 2088.9579,-11769.6904 2161.3169,-11724 2198.0653,-11700.7955 2337.6348,-11423.3069 2351.1489,-11382 2390.8482,-11260.6558 2332.7009,-11212.481 2387.1489,-11097 2388.1823,-11094.8084 2590.0035,-10881.3064 2651.8965,-10815.8571"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2654.7153,-10817.9703 2659.0434,-10808.2999 2649.6294,-10813.1605 2654.7153,-10817.9703"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.5778,-11836.2396C925.6818,-11965.9463 974.8908,-13177.2842 1038.022,-13322 1052.9987,-13356.3313 1080.2822,-13349.6016 1095.1044,-13384"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-13608C1500.6718,-13630.9075 1526.4119,-13604.7244 1551.1179,-13632 1606.4735,-13693.1128 1531.578,-13753.0547 1587.1179,-13814 1612.4113,-13841.755 1647.9914,-13806.3043 1668.1278,-13838"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-13838C1688.2642,-13869.6957 1722.9515,-13835.0857 1749.1377,-13862 1792.4406,-13906.5068 1744.9167,-13949.6896 1785.1377,-13997 1903.8561,-14136.6437 2055.8045,-14016.1282 2161.3169,-14166 2220.215,-14249.6601 2122.1953,-14555.5396 2197.3169,-14625 2391.5309,-14804.578 2593.8337,-14628.2173 2755.6838,-14419 2941.7106,-14178.5306 2904.1837,-14063.6161 2949.5867,-13763 2961.6302,-13683.2593 2938.5947,-10925.5392 2985.5867,-10860 2987.8486,-10856.8453 2990.542,-10854.0863 2993.536,-10851.6734"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6398,-10854.479 3002.0736,-10846.0614 2991.7948,-10848.6296 2995.6398,-10854.479"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-13384C1105.9951,-13409.2746 1133.1787,-13388.0976 1152.1868,-13408 1184.2349,-13441.556 1155.4398,-13473.1257 1188.1868,-13506 1256.5969,-13574.6762 1301.1211,-13549.9962 1392.6204,-13582 1427.6106,-13594.2386 1442.8572,-13584.9261 1471.8691,-13608"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge441" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M924.1669,-11813.5293C936.5644,-11778.026 974.9558,-11666.6922 1002.022,-11573 1020.0917,-11510.45 1010.9017,-11490.1904 1038.022,-11431 1074.8638,-11350.5922 1120.7255,-11350.6615 1152.1868,-11268 1201.211,-11139.1932 1105.7045,-11070.414 1188.1868,-10960 1236.9098,-10894.7774 1310.6242,-10955.1735 1356.6204,-10888 1423.1381,-10790.8566 1366.2486,-9943.7431 1392.6204,-9829 1480.0857,-9448.4391 1600.3904,-9387.0416 1749.1377,-9026 1794.4008,-8916.1368 1843.31,-8782.376 1861.6039,-8731.7488"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1864.9309,-8732.8402 1865.0306,-8722.2458 1858.3459,-8730.4656 1864.9309,-8732.8402"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge478" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-12282C1597.727,-12292.2396 1630.2794,-12301.3648 1749.1377,-12344 1959.3088,-12419.3898 1980.1401,-12519.1371 2197.3169,-12571 2263.8168,-12586.8805 2293.5866,-12607.8918 2351.1489,-12571 2713.5623,-12338.7284 2657.9573,-12110.2172 2755.6838,-11691 2772.4019,-11619.2846 2747.3744,-10424.8156 2791.6838,-10366 2794.0278,-10362.8887 2796.7599,-10360.1559 2799.7718,-10357.7564"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.878,-10360.5608 2808.3235,-10352.1521 2798.0411,-10354.706 2801.878,-10360.5608"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge510" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1095.1044,-11749C1127.2984,-11729.8562 1130.3707,-11717.4467 1152.1868,-11687 1171.6482,-11659.8394 1164.8352,-11644.8987 1188.1868,-11621 1248.5593,-11559.2128 1300.5068,-11589.6792 1356.6204,-11524 1385.6801,-11489.9865 1367.9662,-11467.3304 1392.6204,-11430 1459.526,-11328.6941 1675.7161,-11102.5944 1785.1377,-11050 1937.0471,-10976.9835 2043.9329,-11122.9498 2161.3169,-11002 2218.8509,-10942.7182 2162.057,-10706.7077 2197.3169,-10632 2248.2663,-10524.0496 2284.9987,-10503.7613 2387.1489,-10442 2393.9148,-10437.9093 2401.4112,-10434.4306 2409.0264,-10431.4882"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2410.4464,-10434.6977 2418.6898,-10428.0421 2408.0952,-10428.1044 2410.4464,-10434.6977"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M950.7738,-11813.9266C986.442,-11800.5309 1046.651,-11776.3461 1095.1044,-11749"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-13874C1519.7253,-13916.9233 1524.1856,-13936.6282 1551.1179,-13995 1574.9813,-14046.7202 1547.1362,-14077.4302 1587.1179,-14118 1590.5531,-14121.4857 1594.4626,-14124.4877 1598.6651,-14127.0728"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1597.1679,-14130.2402 1607.6451,-14131.8151 1600.4368,-14124.0503 1597.1679,-14130.2402"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-13606C1298.2533,-13634.3563 1329.9219,-13597.4413 1356.6204,-13625 1415.5116,-13685.7888 1348.4863,-13739.7806 1392.6204,-13812 1415.9396,-13850.1587 1438.5782,-13844.1406 1471.8691,-13874"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-13308C1229.0329,-13438.0605 2617.5902,-13689.6294 2755.6838,-13564 2787.0555,-13535.4599 2785.2245,-13225.9165 2791.6838,-13184 2812.2561,-13050.5002 2851.0845,-12892.6475 2865.2714,-12836.8199"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2868.6826,-12837.6074 2867.7676,-12827.0521 2861.9006,-12835.8742 2868.6826,-12837.6074"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-13838C1688.9675,-13869.2378 1723.9289,-13834.1682 1749.1377,-13862 1806.2492,-13925.054 1751.8945,-13971.6902 1785.1377,-14050 1898.5785,-14317.2284 2039.3546,-14320.5516 2161.3169,-14584 2188.1267,-14641.9114 2166.4351,-14667.1537 2197.3169,-14723 2256.7793,-14830.531 2274.3088,-14875.3604 2387.1489,-14924 2537.5635,-14988.836 2610.5947,-15000.0092 2755.6838,-14924 2835.1762,-14882.3556 2816.5511,-14829.6115 2870.6353,-14758"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-13384C1105.9951,-13409.2746 1135.0858,-13386.4369 1152.1868,-13408 1211.5724,-13482.8811 1124.7946,-13548.4789 1188.1868,-13620 1194.9394,-13627.6186 1203.8963,-13632.9638 1213.4488,-13636.7033"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.5467,-13640.0919 1223.1403,-13639.9323 1214.7594,-13633.4508 1212.5467,-13640.0919"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge453" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-11786C1770.8954,-11715.209 1871.3698,-11939.7782 2161.3169,-11838 2263.2997,-11802.2017 2297.9073,-11780.0603 2351.1489,-11686 2409.9159,-11582.1783 2304.4115,-11505.9477 2387.1489,-11420 2412.278,-11393.8959 2432.9944,-11417.1685 2467.4641,-11406"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.9205,-11836.0055C942.4117,-11875.2189 1006.5629,-12010.0826 1095.1044,-12091"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-12091C1168.67,-12158.2311 1112.6204,-11951.9742 1188.1868,-11887 1247.2087,-11836.2511 1283.6159,-11866.0073 1356.6204,-11839 1409.4965,-11819.439 1416.0206,-11793.7115 1471.8691,-11786"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge602" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M922.9134,-11813.7386C933.6034,-11771.4734 974.7276,-11619.0049 1038.022,-11507 1078.0327,-11436.1975 1117.3243,-11437.4742 1152.1868,-11364 1184.7351,-11295.403 1159.0071,-11267.0963 1188.1868,-11197 1240.9571,-11070.2333 1300.8054,-11063.4559 1356.6204,-10938 1381.8617,-10881.2649 1354.0076,-10851.6318 1392.6204,-10803 1515.5168,-10648.2151 1593.3816,-10641.8698 1785.1377,-10594 1857.5161,-10575.9315 1885.3941,-10562.4353 1952.9868,-10594 1975.5703,-10604.5461 1969.6386,-10621.2875 1988.9868,-10637 2004.0622,-10649.2426 2022.8935,-10659.7375 2039.1032,-10667.5982"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2037.7567,-10670.8326 2048.2961,-10671.9155 2040.7324,-10664.4965 2037.7567,-10670.8326"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge686" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12282C1527.5325,-12288.2475 1534.6558,-12313.3743 1587.1179,-12333 1622.4092,-12346.2022 1642.1488,-12330.7078 1668.1278,-12358"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-12358C1694.0181,-12385.199 1723.0717,-12354.9693 1749.1377,-12382 1793.7341,-12428.2468 1765.3812,-12460.8667 1785.1377,-12522 1926.0563,-12958.0495 2052.4837,-13036.8567 2161.3169,-13482 2197.1957,-13628.7495 2145.4938,-13678.0948 2197.3169,-13820 2302.5628,-14108.1911 2342.6363,-14202.3137 2583.7793,-14392 2627.8277,-14426.649 3012.164,-14602.3278 3056.4631,-14568"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge673" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M925.1212,-11813.7472C940.2658,-11778.8715 985.7235,-11669.1517 1002.022,-11573 1063.7607,-11208.7756 988.9495,-10277.1462 1038.022,-9911 1065.8317,-9703.5023 1120.8525,-9660.9947 1152.1868,-9454 1195.226,-9169.6825 1116.7692,-9086.5468 1188.1868,-8808 1231.2604,-8640.0016 1304.2944,-8621.3505 1356.6204,-8456 1385.7194,-8364.0469 1358.1974,-8332.0954 1392.6204,-8242 1450.4033,-8090.7646 1492.7783,-8065.5715 1587.1179,-7934 1653.7777,-7841.0324 1695.4491,-7835.015 1749.1377,-7734 1819.264,-7602.0575 1854.9201,-7422.9259 1865.5662,-7362.159"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1869.0287,-7362.6751 1867.2657,-7352.228 1862.129,-7361.4943 1869.0287,-7362.6751"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge782" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-11634C1587.2141,-11582.6133 1631.0758,-11616.7934 1749.1377,-11572 1944.873,-11497.7369 2008.1101,-11486.6709 2161.3169,-11344 2274.5971,-11238.51 2287.2813,-11193.0016 2351.1489,-11052 2375.5321,-10998.1687 2356.2648,-10974.3837 2387.1489,-10924 2503.6132,-10734.0029 2660.592,-10785.5449 2755.6838,-10584 2778.5309,-10535.5762 2859.8686,-8770.5117 2869.667,-8556.2316"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2873.1635,-8556.387 2870.1235,-8546.2377 2866.1708,-8556.0675 2873.1635,-8556.387"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge795" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.1044,-12091C1239.2759,-12211.2519 1289.1046,-12239.0688 1471.8691,-12282"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-12282C1561.3888,-12289.2832 1514.6308,-12169.0325 1587.1179,-12116 1595.1362,-12110.1337 1604.5582,-12105.6229 1614.0861,-12102.1606"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.1921,-12105.4813 1623.6013,-12099.0364 1613.0084,-12098.8307 1615.1921,-12105.4813"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge728" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-11749C1136.3732,-11725.7088 1144.4214,-11715.1712 1188.1868,-11697 1260.0764,-11667.1517 1287.5004,-11684.7976 1356.6204,-11649 1374.8644,-11639.5513 1376.6067,-11632.8719 1392.6204,-11620 1478.9902,-11550.5751 1494.7635,-11525.2391 1587.1179,-11464 1647.5446,-11423.9318 2120.8651,-11214.1706 2161.3169,-11154 2244.1243,-11030.8271 2148.7863,-10962.262 2197.3169,-10822 2210.3381,-10784.3665 2357.7365,-10544.8466 2387.1489,-10518 2446.2023,-10464.0981 2505.431,-10504.8184 2547.7793,-10437 2589.6695,-10369.9151 2581.8761,-7669.0668 2583.7793,-7590 2607.7699,-6593.3295 2661.0273,-5366.6464 2668.7823,-5190.4597"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.2824,-5190.5319 2669.2265,-5180.3873 2665.2892,-5190.2234 2672.2824,-5190.5319"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge763" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-11634C1531.6569,-11608.5229 1531.9013,-11578.2752 1587.1179,-11544 1827.688,-11394.6683 1963.2908,-11470.3847 2161.3169,-11268 2304.0148,-11122.1613 2275.5106,-11039.5006 2351.1489,-10850 2369.2813,-10804.5719 2363.4864,-10788.8087 2387.1489,-10746 2442.3023,-10646.22 2495.0074,-10647.0598 2547.7793,-10546 2621.067,-10405.6518 2656.3573,-10214.9848 2666.5274,-10152.0837"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2669.9896,-10152.5973 2668.0904,-10142.174 2663.0751,-10151.5066 2669.9896,-10152.5973"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M975.5984,-11829.0845C1010.1529,-11830.6216 1055.4306,-11830.803 1095.1044,-11825"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-11825C1141.9932,-11818.1417 1144.4214,-11791.1712 1188.1868,-11773 1260.0764,-11743.1517 1287.3266,-11760.4601 1356.6204,-11725 1414.7191,-11695.2688 1412.2534,-11660.559 1471.8691,-11634"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge853" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M924.676,-11813.8372C938.2367,-11781.389 981.0859,-11685.3195 1038.022,-11621 1080.128,-11573.4336 1118.402,-11588.7965 1152.1868,-11535 1195.8076,-11465.5412 1138.7111,-11419.4176 1188.1868,-11354 1238.8885,-11286.9612 1304.7128,-11334.1095 1356.6204,-11268 1399.4941,-11213.396 1349.0684,-11170.0646 1392.6204,-11116 1441.6292,-11055.1614 1503.1862,-11101.6908 1551.1179,-11040 1601.1733,-10975.576 1529.8719,-10918.1282 1587.1179,-10860 1678.7161,-10766.9904 2078.489,-10836.8987 2161.3169,-10736 2199.5329,-10689.4463 2191.6646,-8627.9647 2197.3169,-8568 2257.3177,-7931.4612 2431.1081,-7163.7858 2462.5555,-7028.0145"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.0099,-7028.6118 2464.8645,-7018.0791 2459.1916,-7027.0272 2466.0099,-7028.6118"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1344.2411,-2522.0054 1200.566,-2522.0054 1200.566,-2499.9946 1344.2411,-2499.9946 1344.2411,-2522.0054"/>
<text text-anchor="middle" x="1272.4036" y="-2507.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1017" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-1904C1576.4445,-1587.0757 1458.6279,-1470.0054 1587.1179,-1162 1644.1371,-1025.3185 1678.5973,-996.8696 1785.1377,-894 2293.5034,-403.1499 2539.6165,-267 3246.2772,-267 3246.2772,-267 3246.2772,-267 3436.8809,-267 3595.6423,-267 3637.0782,-243.522 3794.094,-267"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1326.4986,-2499.9783C1338.1278,-2495.1131 1349.1526,-2488.1022 1356.6204,-2478 1419.4152,-2393.0535 1354.1278,-2102.3739 1392.6204,-2004 1413.2842,-1951.1902 1454.5016,-1957.9837 1471.8691,-1904"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge935" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1471.8691,-1904C1507.4316,-1796.3468 1539.7787,-1510.0189 1587.1179,-1407 1618.608,-1338.4717 1928.2887,-904.7603 1988.9868,-860 2292.1458,-636.4428 3354.0773,-446.3617 3670.96,-650 3699.7281,-668.4873 3683.1416,-693.4629 3706.96,-718 3821.1612,-835.6476 3944.775,-759.3115 4027.281,-901 4085.081,-1000.2606 4122.8591,-17103.3025 4124.3957,-17768.7889"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4120.896,-17768.9488 4124.4191,-17778.9406 4127.896,-17768.9326 4120.896,-17768.9488"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1273.872,-2522.1255C1283.5265,-2595.8687 1338.0885,-3021.9456 1356.6204,-3371 1362.881,-3488.9215 1353.5864,-7510.5503 1392.6204,-7622 1404.3405,-7655.4634 1432.0969,-7686.3392 1451.4334,-7704.9213"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1449.1845,-7707.61 1458.8824,-7711.8765 1453.9618,-7702.4936 1449.1845,-7707.61"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge897" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1337.1428,-2499.8923C1344.5791,-2496.2193 1351.3647,-2491.3762 1356.6204,-2485 1404.1024,-2427.3945 1368.9696,-2221.8066 1392.6204,-2151 1414.42,-2085.7354 1430.7618,-2073.1804 1471.8691,-2018"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-2018C1505.7476,-1972.5233 1517.9878,-1964.0246 1551.1179,-1918 1565.0268,-1898.6777 1767.3111,-1574.7804 1785.1377,-1559 2286.0879,-1115.5494 2577.2484,-1197 3246.2772,-1197"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge914" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-1904C1516.0977,-1769.0592 1513.4041,-1727.3732 1587.1179,-1606 1714.7578,-1395.8351 1811.2846,-1391.952 1952.9868,-1191 1972.0179,-1164.0114 1966.6055,-1150.2826 1988.9868,-1126 2133.054,-969.6944 2183.6745,-922.5218 2387.1489,-861 2455.4849,-840.3382 2476.5817,-855.7446 2547.7793,-861 2582.6835,-863.5764 3774.4071,-1017.0627 3794.094,-1046"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge565" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-2018C1525.2151,-1946.3911 1591.2007,-2020.3415 1668.1278,-1975"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-1975C1729.3974,-1938.8872 1719.3582,-1901.5854 1749.1377,-1837 1769.6186,-1792.5812 1758.4053,-1773.9619 1785.1377,-1733 1852.6604,-1629.5352 1878.7052,-1599.698 1988.9868,-1544 2521.1604,-1275.2246 2812.1302,-1190.23 3329.2148,-1487 3447.1863,-1554.7072 3466.332,-1605.6964 3508.5469,-1735 3539.1692,-1828.7957 3543.4086,-8740.3386 3544.5469,-8839 3561.4445,-10303.6402 3602.3204,-12111.7293 3607.2618,-12327.6149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.7692,-12327.9848 3607.4977,-12337.9019 3610.7674,-12327.8243 3603.7692,-12327.9848"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge810" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1471.8691,-2203C1500.4205,-2179.78 1515.9907,-2189.9738 1551.1179,-2179 1746.2661,-2118.0351 1787.0127,-2069.7173 1988.9868,-2038 2064.6507,-2026.118 2089.0548,-2012.6152 2161.3169,-2038 2282.6756,-2080.6318 2279.8101,-2148.1213 2387.1489,-2219 2454.7249,-2263.6222 2499.5282,-2239.9655 2547.7793,-2305 2596.3909,-2370.5203 2544.2208,-2413.6479 2583.7793,-2485 2634.6829,-2576.8155 2710.7822,-2552.1047 2755.6838,-2647 2805.4157,-2752.1035 2749.7902,-3060.5338 2791.6838,-3169 2832.4886,-3274.6471 2911.9217,-3262.1932 2949.5867,-3369 2983.7139,-3465.7749 2982.6499,-6960.426 2985.5867,-7063 3002.7741,-7663.3146 3046.9259,-8398.6101 3055.1379,-8532.5507"/>
<polygon fill="#003fff" stroke="#003fff" points="3051.6554,-8532.9451 3055.7628,-8542.7113 3058.6422,-8532.5153 3051.6554,-8532.9451"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1336.5425,-2499.939C1344.1688,-2496.2655 1351.1665,-2491.4098 1356.6204,-2485 1431.6478,-2396.8222 1317.356,-2314.9757 1392.6204,-2227 1416.5441,-2199.0358 1441.1132,-2223.2094 1471.8691,-2203"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge870" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1668.1278,-1975C1865.0139,-1870.851 1939.6671,-1864.0333 2161.3169,-1886 2246.941,-1894.4858 2288.833,-1864.6685 2351.1489,-1924 2398.6144,-1969.1922 2354.9323,-2009.9264 2387.1489,-2067 2436.9908,-2155.2978 2497.8639,-2140.7438 2547.7793,-2229 2579.8313,-2285.6717 2538.297,-2324.4128 2583.7793,-2371 2639.1931,-2427.7599 2700.27,-2362.2401 2755.6838,-2419 2801.1662,-2465.5872 2756.1838,-2506.422 2791.6838,-2561 2840.3376,-2635.8007 2909.5887,-2605.2347 2949.5867,-2685 3001.6062,-2788.7392 3052.0811,-6696.3543 3056.1934,-7021.5116"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.6986,-7021.9561 3056.3245,-7031.9112 3059.698,-7021.8678 3052.6986,-7021.9561"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1273.8914,-2522.1245C1283.6702,-2595.8612 1338.8882,-3021.9041 1356.6204,-3371 1359.8836,-3435.2441 1354.4864,-12582.1951 1392.6204,-12634 1394.9375,-12637.1479 1397.6519,-12639.9095 1400.6534,-12642.3313"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1398.9224,-12645.3826 1409.1938,-12647.9803 1402.7842,-12639.5442 1398.9224,-12645.3826"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-2511C1511.945,-2530.8444 1517.3683,-2543.6599 1551.1179,-2573 1643.3988,-2653.2241 1683.3238,-2660.9456 1749.1377,-2764 1775.4645,-2805.2237 1762.8226,-2824.4738 1785.1377,-2868 1844.1895,-2983.1821 1905.2081,-2985.7036 1952.9868,-3106 1994.7487,-3211.1473 1936.8336,-3257.6006 1988.9868,-3358 2037.4443,-3451.2849 2116.7175,-3424.8102 2161.3169,-3520 2217.894,-3640.7543 2166.2694,-3989.3134 2197.3169,-4119 2211.668,-4178.9451 2245.1143,-4244.1412 2262.7999,-4276.084"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2259.7954,-4277.882 2267.7439,-4284.8871 2265.8987,-4274.4542 2259.7954,-4277.882"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-2511C1609.5188,-2580.2676 1514.9781,-2701.8336 1587.1179,-2838 1651.2379,-2959.0287 1903.148,-3206.4249 1952.9868,-3334 2006.3511,-3470.5995 1915.0773,-3535.3329 1988.9868,-3662 2036.5409,-3743.4988 2115.7939,-3703.3496 2161.3169,-3786 2225.8662,-3903.1941 2124.7812,-4274.5737 2197.3169,-4387 2239.2073,-4451.9278 2308.71,-4403.4294 2351.1489,-4468 2408.4386,-4555.1659 2346.4042,-4839.9799 2387.1489,-4936 2429.1622,-5035.0096 2509.2373,-5016.5882 2547.7793,-5117 2597.8895,-5247.5501 2574.0386,-10011.5028 2583.7793,-10151 2601.0539,-10398.3922 2651.7587,-10695.7264 2665.9829,-10776.1174"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.5424,-10776.7614 2667.7406,-10785.9933 2669.4341,-10775.5347 2662.5424,-10776.7614"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-2203C1536.5735,-2160.4834 2091.1263,-2271.3259 2161.3169,-2304 2369.5184,-2400.919 2404.7844,-2467.2957 2547.7793,-2647 2568.5841,-2673.1458 2557.6281,-2692.2019 2583.7793,-2713 2614.8213,-2737.6878 2652.3271,-2701.3604 2669.7316,-2737"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge479" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-2511C1552.2484,-2549.0527 1592.7804,-2502.7602 1668.1278,-2550"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-2550C1716.589,-2580.3832 1721.7189,-2599.8021 1749.1377,-2650 1773.5941,-2694.7744 1751.4936,-2720.6472 1785.1377,-2759 1839.7613,-2821.2685 1879.0508,-2802.6561 1952.9868,-2840 2046.4474,-2887.2055 2093.1363,-2870.5352 2161.3169,-2950 2193.1674,-2987.1219 2172.5048,-3011.8473 2197.3169,-3054 2315.6967,-3255.113 2429.3995,-3243.887 2547.7793,-3445 2572.5914,-3487.1527 2557.2136,-3507.9298 2583.7793,-3549 2640.7972,-3637.1489 2713.7174,-3614.7707 2755.6838,-3711 2782.5787,-3772.6702 2789.9479,-8487.7428 2791.6838,-8555 2810.4152,-9280.7384 2860.8289,-10171.2937 2869.3911,-10319.6046"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9016,-10319.8877 2869.9738,-10329.6687 2872.8899,-10319.4831 2865.9016,-10319.8877"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1320.033,-2499.9901C1362.0867,-2492.7571 1423.9814,-2488.3293 1471.8691,-2511"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-2550C1703.7557,-2572.821 1725.5193,-2564.8957 1749.1377,-2600 1802.9768,-2680.0217 1737.1195,-2730.3557 1785.1377,-2814 1833.5021,-2898.2472 1889.0629,-2880.8533 1952.9868,-2954 2280.0467,-3328.2478 2377.2305,-3434.1567 2547.7793,-3901 2587.2054,-4008.9211 2540.8823,-4050.4109 2583.7793,-4157 2632.4958,-4278.0492 2715.1828,-4270.9602 2755.6838,-4395 2783.0201,-4478.721 2789.7633,-10647.9501 2791.6838,-10736 2810.2494,-11587.1725 2861.5108,-12633.3281 2869.5644,-12794.687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.073,-12794.9485 2870.0685,-12804.761 2873.0642,-12794.5985 2866.073,-12794.9485"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1275.1882,-2522.342C1306.825,-2651.6002 1600.1494,-3860.5539 1749.1377,-4854 1773.642,-5017.3937 1740.9133,-5064.8077 1785.1377,-5224 1831.53,-5390.9962 1908.5214,-5408.4805 1952.9868,-5576 2033.3642,-5878.8148 2148.3071,-8074.9695 2161.3169,-8388 2163.5928,-8442.7606 2164.9019,-12289.8053 2197.3169,-12334 2200.9877,-12339.0047 2205.684,-12343.0265 2210.9423,-12346.2556"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.739,-12349.5699 2220.2402,-12350.9751 2212.9073,-12343.3279 2209.739,-12349.5699"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge729" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-2511C1559.5419,-2553.9489 1534.7982,-2615.5757 1587.1179,-2698 1608.6716,-2731.9556 1758.5574,-2970.8168 1785.1377,-3001 1849.9068,-3074.5485 1906.8148,-3057.5561 1952.9868,-3144 2018.1267,-3265.9559 1930.2927,-3327.8143 1988.9868,-3453 2036.1393,-3553.5692 2117.3677,-3531.9903 2161.3169,-3634 2191.3419,-3703.6905 2149.8691,-4256.7803 2197.3169,-4316 2241.7054,-4371.4014 2304.8507,-4305.1842 2351.1489,-4359 2436.4274,-4458.1255 2322.4005,-4537.3958 2387.1489,-4651 2431.8074,-4729.3554 2504.1201,-4696.0834 2547.7793,-4775 2587.663,-4847.0922 2531.1767,-5080.5889 2583.7793,-5144 2586.4381,-5147.2051 2589.4821,-5150.0132 2592.8014,-5152.4722"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.2123,-5155.6048 2601.5571,-5157.893 2594.8971,-5149.6531 2591.2123,-5155.6048"/>
</g>
<!-- sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~datadaylighting.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/datadaylighting.f90.html" xlink:title="DataDaylighting.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1523.5089,-17350.0054 1420.2294,-17350.0054 1420.2294,-17327.9946 1523.5089,-17327.9946 1523.5089,-17350.0054"/>
<text text-anchor="middle" x="1471.8691" y="-17335.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDaylighting.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1018" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-17450C1689.2994,-17480.3214 1725.7406,-17440.3608 1749.1377,-17469 1834.7262,-17573.7648 1725.2434,-18564.6999 1785.1377,-18686 1909.2166,-18937.2892 1993.9797,-19084 2274.2329,-19084 2274.2329,-19084 2274.2329,-19084 3056.4631,-19084 3180.0391,-19084 3208.0657,-19113.63 3329.2148,-19138 3377.096,-19147.6316 3388.3683,-19154.3509 3436.8809,-19160"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-19160C3743.4501,-19183.1885 3833.2186,-19182.539 4124.4445,-19084"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1523.8188,-17347.875C1533.8164,-17351.5352 1543.5236,-17356.7034 1551.1179,-17364 1585.1802,-17396.7272 1552.9535,-17431.3794 1587.1179,-17464 1590.8804,-17467.5925 1595.1481,-17470.6695 1599.7098,-17473.305"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1598.28,-17476.5032 1608.7891,-17477.8482 1601.4125,-17470.2432 1598.28,-17476.5032"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge936" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1668.1278,-17450C1689.2539,-17480.3532 1725.7101,-17440.3858 1749.1377,-17469 1829.0689,-17566.627 1702.8849,-18508.3209 1785.1377,-18604 2067.1967,-18932.1003 2327.5852,-18742.7587 2755.6838,-18680 2868.2899,-18663.4921 3142.9413,-18485.3102 3246.2772,-18533"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge895" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1523.6941,-17340.5051C1588.4117,-17345.4824 1696.9528,-17364.7045 1749.1377,-17436 1805.8882,-17513.5331 1715.7968,-18233.4881 1785.1377,-18300 1864.2775,-18375.911 2187.9826,-18385.1358 2351.1489,-18262 2386.1966,-18235.5508 2362.1484,-18206.0954 2387.1489,-18170 2590.7913,-17875.9844 2697.017,-17843.2887 2985.5867,-17632 3244.435,-17442.473 3383.5876,-17495.5052 3607.7534,-17266"/>
</g>
<!-- sourcefile~datadaylighting.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge924" class="edge">
<title>sourcefile~datadaylighting.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1523.6848,-17349.2675C1533.4657,-17352.824 1543.1221,-17357.5979 1551.1179,-17364 1575.9912,-17383.9155 1562.0708,-17406.3036 1587.1179,-17426 1616.6357,-17449.212 1646.7646,-17419.1178 1668.1278,-17450"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-17450C1689.1669,-17480.4135 1725.573,-17440.4986 1749.1377,-17469 1810.8575,-17543.6499 1718.9511,-18269.2803 1785.1377,-18340 1899.5775,-18462.2779 1995.2805,-18383.915 2161.3169,-18362 2596.1248,-18304.6101 3653.6909,-17768.9378 3881.228,-17394 3935.5294,-17304.5217 3964.0625,-16967.8009 3970.7206,-16879.3765"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3974.2245,-16879.4524 3971.4704,-16869.2218 3967.2435,-16878.9369 3974.2245,-16879.4524"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1019" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-16690C1284.0355,-16726.5648 1332.4068,-16679.2343 1356.6204,-16709 1431.3049,-16800.8096 1317.3926,-18747.635 1392.6204,-18839 1444.1109,-18901.5358 1696.1933,-18853.6902 1749.1377,-18915 1831.0754,-19009.8841 1699.5469,-19386.3976 1785.1377,-19478 1950.5229,-19655.0013 2628.6344,-19567.1686 2870.6353,-19578"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1272.4036,-16690C1284.0579,-16726.5577 1330.3302,-16681.0515 1356.6204,-16709 1425.1066,-16781.8062 1346.6744,-16842.2302 1392.6204,-16931 1448.311,-17038.5971 1495.6174,-17042.5882 1587.1179,-17122 1655.601,-17181.4354 1706.946,-17165.7357 1749.1377,-17246 1823.0577,-17386.6234 1721.9042,-17814.2583 1785.1377,-17960 1958.8247,-18360.3169 2031.0918,-18666 2467.4641,-18666 2467.4641,-18666 2467.4641,-18666 2669.7316,-18666 3092.0682,-18666 3185.4168,-18818 3607.7534,-18818 3607.7534,-18818 3607.7534,-18818 3972.2545,-18818 4191.0988,-18818 4277.4395,-17957.9947 4290.584,-17811.1884"/>
<polygon fill="#ffff00" stroke="#ffff00" points="4294.0733,-17811.4629 4291.4633,-17801.1946 4287.1002,-17810.8493 4294.0733,-17811.4629"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-16690C1284.0552,-16726.5586 1331.8394,-16679.705 1356.6204,-16709 1450.0505,-16819.4491 1299.9332,-17247.9266 1392.6204,-17359 1415.8263,-17386.8093 1450.3406,-17348.8728 1471.8691,-17378"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge937" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1668.1278,-17108C1686.5923,-17140.6979 1725.9311,-17102.478 1749.1377,-17132 1798.9822,-17195.4091 1747.9071,-17785.4523 1785.1377,-17857 1863.3564,-18007.3163 2235.3219,-18249.7556 2387.1489,-18325 2503.5757,-18382.7003 2541.3081,-18380.2022 2669.7316,-18400"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge972" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1097.8018,-16185.786C1106.9476,-16147.3334 1137.0502,-16017.1687 1152.1868,-15908 1159.0148,-15858.7544 1156.8717,-15500.615 1188.1868,-15462 1190.8135,-15458.7609 1193.84,-15455.9285 1197.1508,-15453.4529"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1199.2608,-15456.2622 1205.9003,-15448.0058 1195.5612,-15450.3197 1199.2608,-15456.2622"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge994" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1869.0623,-15094C1908.2772,-15025.8991 1991.2622,-14979.0187 2039.1044,-14956.4391"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2040.8527,-14959.4871 2048.4663,-14952.1194 2037.9198,-14953.1311 2040.8527,-14959.4871"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1095.8501,-16185.9611C1099.1371,-16145.3728 1115.5967,-16002.3909 1188.1868,-15918 1242.9985,-15854.2776 1307.8733,-15900.4733 1356.6204,-15832 1423.7665,-15737.6822 1341.2046,-15677.7346 1392.6204,-15574 1400.9632,-15557.1677 1859.6875,-15110.2802 1869.0623,-15094"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1097.2532,-16185.9246C1109.0322,-16125.5355 1166.0413,-15837.4806 1188.1868,-15804 1239.4697,-15726.468 1304.8572,-15757.2122 1356.6204,-15680 1393.3553,-15625.2045 1367.9592,-15597.1868 1392.6204,-15536 1419.0601,-15470.4006 1444.2337,-15463.1047 1471.8691,-15398"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-15398C1560.7362,-15200.885 1518.4498,-15131.7393 1551.1179,-14918 1568.4773,-14804.4217 1535.8436,-14764.8218 1587.1179,-14662 1632.5606,-14570.8725 1709.8095,-14593.9285 1749.1377,-14500 1800.0123,-14378.4948 1763.6387,-9887.9597 1785.1377,-9758 1799.9302,-9668.5808 1841.2094,-9567.9016 1859.7903,-9525.5278"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1863.0394,-9526.8346 1863.8959,-9516.2745 1856.641,-9523.9957 1863.0394,-9526.8346"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1097.7712,-16185.7817C1106.8187,-16147.3153 1136.6428,-16017.1114 1152.1868,-15908 1165.0237,-15817.8909 1129.2433,-15569.355 1188.1868,-15500 1238.2202,-15441.1288 1309.0707,-15517.8949 1356.6204,-15457 1386.9914,-15418.1051 1389.4004,-8400.2427 1392.6204,-8351 1408.2713,-8111.6537 1454.8423,-7823.9307 1468.2314,-7744.3102"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1471.741,-7744.5472 1469.9585,-7734.1034 1464.8391,-7743.3793 1471.741,-7744.5472"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1098.1184,-16185.8237C1108.2817,-16147.4923 1141.2666,-16017.6707 1152.1868,-15908 1159.2987,-15836.575 1143.898,-5628.4856 1188.1868,-5572 1190.3252,-5569.2726 1192.7592,-5566.8658 1195.4184,-5564.7439"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.5017,-5567.5649 1204.0011,-5559.1978 1193.7025,-5561.6856 1197.5017,-5567.5649"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge898" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1097.3343,-16208.4261C1110.337,-16274.8981 1176.202,-16609.4838 1188.1868,-16628 1213.442,-16667.0188 1258.2896,-16645.7158 1272.4036,-16690"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-16690C1284.0552,-16726.5586 1326.2807,-16685.5096 1356.6204,-16709 1384.2826,-16730.4174 1370.3615,-16752.0103 1392.6204,-16779 1393.7138,-16780.3258 1585.6552,-16931.098 1587.1179,-16932 1654.8183,-16973.7476 1704.8726,-16941.9182 1749.1377,-17008 1841.5056,-17145.8929 1685.1817,-17621.5045 1785.1377,-17754 1842.7424,-17830.3573 1894.6086,-17807.4602 1988.9868,-17823 2064.5604,-17835.4435 2092.285,-17856.1784 2161.3169,-17823 2184.4015,-17811.905 2178.4899,-17795.365 2197.3169,-17778 2235.4051,-17742.8695 2537.6694,-17540.6378 2583.7793,-17517 2898.0239,-17355.9056 3009.9389,-17392.8772 3329.2148,-17242 3488.3285,-17166.8092 3548.0836,-17167.985 3670.96,-17042 3731.5936,-16979.8324 3771.6556,-16881.8352 3787.0312,-16839.5483"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3790.3548,-16840.6481 3790.4059,-16830.0534 3783.759,-16838.3038 3790.3548,-16840.6481"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge925" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-17108C1686.296,-17140.8635 1725.8688,-17102.5271 1749.1377,-17132 1841.256,-17248.6789 1701.6545,-17676.9947 1785.1377,-17800 1841.1647,-17882.5509 1891.5378,-17872.614 1988.9868,-17894 2386.576,-17981.2543 2463.5843,-17646 2870.6353,-17646 2870.6353,-17646 2870.6353,-17646 3056.4631,-17646 3425.2447,-17646 3507.3689,-17497.9237 3794.094,-17266"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-16690C1284.0566,-16726.5581 1329.2203,-16682.1388 1356.6204,-16709 1404.3449,-16755.7861 1356.4215,-16798.8198 1392.6204,-16855 1441.2129,-16930.4152 1499.1275,-16906.8859 1551.1179,-16980 1579.4636,-17019.8625 1551.758,-17050.204 1587.1179,-17084 1614.2642,-17109.9456 1649.6204,-17075.3263 1668.1278,-17108"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge567" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1097.5518,-16208.105C1110.1448,-16264.967 1167.8357,-16522.0161 1188.1868,-16552 1240.3913,-16628.9146 1282.5508,-16619.8318 1356.6204,-16676 1460.189,-16754.5378 1484.2857,-16776.5005 1587.1179,-16856 1658.8571,-16911.4616 1706.9403,-16899.7387 1749.1377,-16980 1822.8611,-17120.2253 1699.269,-17558.8653 1785.1377,-17692 1840.3758,-17777.6436 1889.9432,-17772.9909 1988.9868,-17797 2063.4222,-17815.0438 2098.2894,-17840.5171 2161.3169,-17797 2198.473,-17771.3457 2169.3826,-17737.4738 2197.3169,-17702 2248.5292,-17636.9653 2284.6503,-17646.2965 2351.1489,-17597 2552.9267,-17447.4189 2580.0793,-17378.323 2791.6838,-17243 3074.9403,-17061.8549 3272.1684,-17141.117 3436.8809,-16848"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge618" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1668.1278,-15816C1787.1859,-15764.8819 1835.632,-15808.9156 1952.9868,-15754 1971.346,-15745.4089 1971.8343,-15736.8007 1988.9868,-15726 2061.4214,-15680.3889 2115.8438,-15712.5213 2161.3169,-15640 2204.852,-15570.5695 2176.3434,-12769.2212 2197.3169,-12690 2209.6294,-12643.4932 2240.8735,-12595.8291 2259.5334,-12570.1771"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2262.4086,-12572.1758 2265.5572,-12562.0596 2256.7873,-12568.0043 2262.4086,-12572.1758"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge637" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1096.2502,-16185.9705C1100.7096,-16148.5113 1120.1826,-16024.6884 1188.1868,-15956 1244.8686,-15898.7479 1307.3208,-15952.7197 1356.6204,-15889 1435.2866,-15787.3238 1321.903,-15709.3568 1392.6204,-15602 1437.5489,-15533.7935 1498.6411,-15571.5851 1551.1179,-15509 1580.6635,-15473.7633 1557.6881,-15447.3334 1587.1179,-15412 1610.8807,-15383.4704 2142.8545,-15102.214 2161.3169,-15070 2195.7173,-15009.9766 2194.1591,-10158.1103 2197.3169,-10089 2234.4707,-9275.8609 2308.7174,-9076.8808 2351.1489,-8264 2392.4196,-7473.3592 2313.0871,-7271.2455 2387.1489,-6483 2403.7867,-6305.9225 2448.0344,-6095.3151 2462.6811,-6028.4633"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2466.1781,-6028.8579 2464.9148,-6018.3387 2459.3425,-6027.3498 2466.1781,-6028.8579"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge651" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1471.8691,-15816C1656.4928,-15620.8133 1753.0272,-15629.4433 1952.9868,-15450 1970.3015,-15434.4618 1968.7368,-15423.453 1988.9868,-15412 2057.2554,-15373.3886 2111.8721,-15434.8823 2161.3169,-15374 2221.7358,-15299.6052 2172.729,-12016.6308 2197.3169,-11924 2233.3458,-11788.267 2314.6798,-11783.6154 2351.1489,-11648 2381.84,-11533.871 2383.6238,-9639.131 2387.1489,-9521 2409.9646,-8756.4211 2458.3303,-7817.5682 2466.3319,-7664.5358"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2469.8457,-7664.3619 2466.8739,-7654.1924 2462.8553,-7663.9955 2469.8457,-7664.3619"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge716" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-16538C1320.9152,-16570.1789 1337.3944,-16571.5895 1392.6204,-16590 1461.342,-16612.9094 1494.8759,-16582.3454 1551.1179,-16628 1580.1363,-16651.5557 1560.6396,-16677.6213 1587.1179,-16704 1643.4652,-16760.1354 1703.1423,-16715.1107 1749.1377,-16780 1794.992,-16844.6903 1727.5483,-17080.4939 1785.1377,-17135 1967.9445,-17308.0193 2155.9697,-17312.931 2351.1489,-17154 2412.3861,-17104.1357 2353.3813,-17051.3876 2387.1489,-16980 2499.0535,-16743.4241 3016.219,-16300.9451 3127.3396,-16064 3161.9802,-15990.1351 3108.1324,-15944.068 3163.3396,-15884 3189.3065,-15855.7468 3234.323,-15896.464 3246.2772,-15860"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge811" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1272.4036,-16538C1347.6928,-16584.8038 1384.7261,-16521.7163 1471.8691,-16538"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1471.8691,-16538C1595.9944,-16561.1942 1634.4593,-16547.1425 1749.1377,-16600 1870.1788,-16655.7901 1862.553,-16737.8342 1988.9868,-16780 2061.6439,-16804.2312 2105.6495,-16832.6055 2161.3169,-16780 2212.7605,-16731.3859 2178.0959,-16212.12 2197.3169,-16144 2236.5118,-16005.092 2293.8784,-15990.483 2351.1489,-15858 2367.3261,-15820.5776 2568.3385,-15199.7322 2583.7793,-15162 2649.7188,-15000.8662 2704.6572,-14976.4584 2755.6838,-14810 2800.7421,-14663.0118 2938.1666,-13593.3146 2949.5867,-13440 3022.947,-12455.1405 2903.1692,-9980.1429 2985.5867,-8996 2999.2612,-8832.7136 3038.4875,-8638.5777 3051.9012,-8575.1665"/>
<polygon fill="#003fff" stroke="#003fff" points="3055.3654,-8575.7033 3054.0271,-8565.1934 3048.5192,-8574.244 3055.3654,-8575.7033"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge824" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1097.4598,-16185.7154C1104.7034,-16154.0571 1129.7911,-16063.9846 1188.1868,-16022 1218.9942,-15999.8504 1248.5328,-16037.4938 1272.4036,-16008"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1272.4036,-16008C1296.8887,-15977.7471 1330.2558,-16012.6299 1356.6204,-15984 1412.4765,-15923.3444 1358.0436,-15876.8563 1392.6204,-15802 1440.1802,-15699.0361 1498.4296,-15702.4363 1551.1179,-15602 1576.5897,-15553.4448 1550.7837,-15525.0639 1587.1179,-15484 1639.3349,-15424.986 1684.7904,-15457.4829 1749.1377,-15412 1768.1355,-15398.5717 1764.9199,-15385.5097 1785.1377,-15374 1851.6087,-15336.159 1883.8448,-15368.7065 1952.9868,-15336 1971.31,-15327.3325 1972.7574,-15320.1438 1988.9868,-15308 2064.5364,-15251.4695 2117.9705,-15267.8124 2161.3169,-15184 2222.3272,-15066.0336 2166.8407,-10532.2653 2197.3169,-10403 2232.9778,-10251.7437 2315.1799,-10240.1834 2351.1489,-10089 2391.0392,-9921.335 2371.9981,-7158.6777 2387.1489,-6987 2403.1082,-6806.1614 2448.1641,-6590.9542 2462.8052,-6523.9548"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2466.2264,-6524.6932 2464.9573,-6514.1747 2459.3899,-6523.1888 2466.2264,-6524.6932"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge871" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1272.4036,-16538C1318.0866,-16566.399 1338.9199,-16527.1163 1392.6204,-16524 1462.9454,-16519.9189 1480.8246,-16519.405 1551.1179,-16524 1733.8582,-16535.9456 1817.1487,-16492.1801 1952.9868,-16615 1982.8123,-16641.9672 1955.3703,-16675.9383 1988.9868,-16698 2053.0199,-16740.0234 2106.0115,-16750.986 2161.3169,-16698 2228.7735,-16633.3725 2170.5052,-15947.4888 2197.3169,-15858 2235.5232,-15730.4797 2308.8683,-15727.2279 2351.1489,-15601 2398.7099,-15459.0076 2337.341,-15407.2199 2387.1489,-15266 2431.0774,-15141.4501 2499.7679,-15139.0337 2547.7793,-15016 2581.567,-14929.4159 2535.7821,-14889.5908 2583.7793,-14810 2633.6645,-14727.2784 2711.3781,-14762.8393 2755.6838,-14677 2800.8223,-14589.5474 2772.4167,-13888.5102 2791.6838,-13792 2831.3782,-13593.1685 2913.1984,-13563.463 2949.5867,-13364 2997.7455,-13100.0161 2978.2144,-8802.2395 2985.5867,-8534 3002.0861,-7933.6661 3046.7956,-7198.3863 3055.1194,-7064.4488"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.6237,-7064.4868 3055.7528,-7054.2884 3051.6373,-7064.0512 3058.6237,-7064.4868"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-15816C1795.6841,-15754.3472 2099.9546,-15539.6963 2161.3169,-15412 2237.1422,-15254.2059 2163.2613,-12432.7226 2197.3169,-12261 2233.1617,-12080.2555 2314.5813,-12056.5997 2351.1489,-11876 2392.0156,-11674.168 2368.1752,-10228.0518 2387.1489,-10023 2403.7742,-9843.3289 2448.2149,-9629.491 2462.7742,-9562.287"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.2779,-9562.647 2464.9899,-9552.1308 2459.4388,-9561.155 2466.2779,-9562.647"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1111.6933,-16185.9066C1204.9671,-16123.5401 1660.1948,-15819.2616 1668.1278,-15816"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge526" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1272.4036,-16538C1311.1232,-16563.7114 1319.5856,-16571.9159 1356.6204,-16600 1369.5664,-16609.8172 1574.2639,-16770.0626 1587.1179,-16780 1658.8571,-16835.4616 1707.0429,-16823.6848 1749.1377,-16904 1787.8675,-16977.8949 1733.322,-17588.6121 1785.1377,-17654 1833.3268,-17714.8114 1892.4114,-17653.5146 1952.9868,-17702 1979.0729,-17722.8797 1960.2548,-17750.9437 1988.9868,-17768 2054.8475,-17807.0971 2098.9266,-17812.4258 2161.3169,-17768 2201.161,-17739.6285 2171.9012,-17705.7916 2197.3169,-17664 2248.9087,-17579.1665 2307.9948,-17591.4212 2351.1489,-17502 2401.0865,-17398.5224 2345.9249,-17353.2472 2387.1489,-17246 2440.6903,-17106.7083 2673.599,-16801.2405 2791.6838,-16710 2853.3146,-16662.3798 2886.8209,-16680.1139 2949.5867,-16634 3042.7768,-16565.5334 3060.1804,-16538.1367 3127.3396,-16444 3238.6358,-16287.9967 3280.2987,-16248.2865 3329.2148,-16063 3429.6526,-15682.5579 3436.4397,-12653.5352 3436.8554,-12370.2337"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3440.3555,-12370.0546 3436.8692,-12360.0498 3433.3555,-12370.045 3440.3555,-12370.0546"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1097.3856,-16208.1575C1105.3022,-16246.99 1132.1971,-16379.8585 1152.1868,-16490 1169.4098,-16584.8973 1124.269,-16631.7737 1188.1868,-16704 1193.588,-16710.1033 1200.4038,-16714.7479 1207.8084,-16718.2769"/>
<polygon fill="#ffff00" stroke="#ffff00" points="1206.8575,-16721.6678 1217.4402,-16722.176 1209.4843,-16715.1793 1206.8575,-16721.6678"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1668.1278,-16690C1699.1036,-16723.1078 1723.8048,-16714.3985 1749.1377,-16752 1782.875,-16802.0762 1765.8048,-16825.798 1785.1377,-16883 1862.6352,-17112.2983 1788.3474,-17252.6212 1988.9868,-17388 2052.477,-17430.8392 2097.7536,-17430.7307 2161.3169,-17388 2381.9831,-17239.6562 2265.9539,-17070.667 2387.1489,-16834 2541.5566,-16532.4761 2596.9906,-16465.2237 2791.6838,-16188 2930.6186,-15990.1708 3041.3825,-15985.9439 3127.3396,-15760 3198.1785,-15573.7951 3240.4476,-14063.9333 3245.7173,-13865.4927"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3249.2175,-13865.5266 3245.9823,-13855.4378 3242.22,-13865.3421 3249.2175,-13865.5266"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-16538C1508.0444,-16544.7598 1524.5906,-16536.4922 1551.1179,-16562 1586.3756,-16595.9026 1551.758,-16632.204 1587.1179,-16666 1614.2642,-16691.9456 1642.97,-16662.1221 1668.1278,-16690"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2870.6353,-15138C2955.7036,-14939.2394 2930.9625,-14873.3962 2949.5867,-14658 2954.1309,-14605.4437 2954.9105,-10902.916 2985.5867,-10860 2987.844,-10856.842 2990.5338,-10854.0804 2993.5252,-10851.6657"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6287,-10854.4713 3002.0577,-10846.05 2991.7803,-10848.6241 2995.6287,-10854.4713"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-16690C1698.5031,-16723.6596 1714.3288,-16722.9489 1749.1377,-16752 1859.733,-16844.3017 1854.6239,-16918.0622 1988.9868,-16970 2060.4265,-16997.6149 2105.3058,-17022.2395 2161.3169,-16970 2203.3467,-16930.8004 2180.157,-16508.8511 2197.3169,-16454 2242.7918,-16308.6408 2501.8692,-16010.2224 2547.7793,-15865 2611.5975,-15663.1309 2501.9523,-15585.2646 2583.7793,-15390 2587.1721,-15381.9038 2784.0404,-15156.3171 2791.6838,-15152 2807.1986,-15143.2371 2863.6242,-15154.3812 2870.6353,-15138"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-16006C1889.6137,-15916.3527 2028.7711,-15990.807 2161.3169,-15792 2237.0139,-15678.4612 2162.0292,-13467.8176 2197.3169,-13336 2233.6323,-13200.3433 2299.2701,-13190.4995 2351.1489,-13060 2375.201,-12999.4978 2342.3581,-12965.2525 2387.1489,-12918 2393.6415,-12911.1506 2401.9742,-12906.1662 2410.8044,-12902.5417"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2412.2497,-12905.7434 2420.5178,-12899.1185 2409.923,-12899.1414 2412.2497,-12905.7434"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1150.9846,-16204.8787C1225.4167,-16213.567 1360.6354,-16223.0217 1471.8691,-16196"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-16196C1507.2793,-16185.9769 1524.5906,-16197.5078 1551.1179,-16172 1586.3756,-16138.0974 1558.4832,-16107.6554 1587.1179,-16068 1613.6603,-16031.2423 1626.4034,-16023.7397 1668.1278,-16006"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1097.5599,-16185.7488C1105.928,-16147.1766 1133.8277,-16016.6732 1152.1868,-15908 1161.7564,-15851.354 1150.4599,-15695.3247 1188.1868,-15652 1239.3047,-15593.2974 1304.8456,-15662.1241 1356.6204,-15604 1422.5217,-15530.0169 1373.5812,-15481.2317 1392.6204,-15384 1453.4179,-15073.5102 1490.0934,-15000.4452 1551.1179,-14690 1570.0589,-14593.6429 1567.3636,-14568.1937 1587.1179,-14472 1611.2565,-14354.4575 1648.3632,-14215.3412 1662.4443,-14163.6662"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1665.8243,-14164.5748 1665.0866,-14154.0057 1659.0723,-14162.728 1665.8243,-14164.5748"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-16538C1330.1043,-16571.5464 1334.2911,-16480.4412 1392.6204,-16448 1534.2075,-16369.2529 1595.3679,-16320.9816 1749.1377,-16372 1856.4014,-16407.5884 1890.1868,-16430.0415 1952.9868,-16524 1989.1662,-16578.13 1937.6023,-16626.0169 1988.9868,-16666 2049.4343,-16713.0351 2106.006,-16718.9803 2161.3169,-16666 2194.8882,-16633.8433 2189.1466,-15875.7639 2197.3169,-15830 2245.8784,-15557.9936 2301.8368,-15500.8071 2387.1489,-15238 2511.3707,-14855.3302 2554.9557,-14763.6083 2669.7316,-14378"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1096.8276,-16208.2854C1105.1061,-16258.0949 1145.7503,-16459.2656 1272.4036,-16538"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1098.059,-16185.8176C1108.0315,-16147.4664 1140.4759,-16017.5891 1152.1868,-15908 1199.6557,-15463.7908 1112.7729,-14338.327 1188.1868,-13898 1203.4921,-13808.6353 1244.6705,-13707.9273 1263.1757,-13665.5368"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1266.4256,-13666.8414 1267.2635,-13656.2797 1260.0222,-13664.0137 1266.4256,-13666.8414"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge454" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-16196C1555.7978,-16172.2434 1581.2824,-16187.8602 1668.1278,-16196"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-16196C1797.1305,-16208.0911 1862.1464,-16165.61 1952.9868,-16258 2010.1857,-16316.1746 1925.8942,-16386.2765 1988.9868,-16438 2048.218,-16486.5579 2106.6913,-16491.6866 2161.3169,-16438 2243.5862,-16357.145 2149.3586,-14466.9085 2197.3169,-14362 2284.2668,-14171.7975 2459.2345,-14237.4653 2547.7793,-14048 2597.3915,-13941.8414 2578.6498,-13111.0671 2583.7793,-12994 2612.2402,-12344.4561 2659.9815,-11547.924 2668.4333,-11408.3572"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2671.9397,-11408.3555 2669.0516,-11398.162 2664.9526,-11407.9317 2671.9397,-11408.3555"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge600" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-15398C1580.0696,-15156.4665 1683.0598,-15127.2801 1749.1377,-14871 1798.2217,-14680.6297 1755.5598,-13296.3585 1785.1377,-13102 1825.5117,-12836.6994 1912.3719,-12787.2639 1952.9868,-12522 2007.62,-12165.1807 1916.6824,-11251.6621 1988.9868,-10898 2004.3661,-10822.7755 2044.737,-10740.1606 2064.2642,-10703.0263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2067.3543,-10704.6699 2068.9671,-10694.1985 2061.1763,-10701.3786 2067.3543,-10704.6699"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge773" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-16196C1703.0001,-16200.563 1930.6458,-16306.8379 1952.9868,-16334 1992.9788,-16382.622 1939.1333,-16432.5542 1988.9868,-16471 2049.6378,-16517.7725 2106.6444,-16524.6388 2161.3169,-16471 2236.1232,-16397.6079 2158.4382,-14682.3182 2197.3169,-14585 2282.9162,-14370.7341 2454.22,-14412.9118 2547.7793,-14202 2616.9275,-14046.1186 2547.4936,-13986.6249 2583.7793,-13820 2633.2445,-13592.8544 2715.5688,-13554.9819 2755.6838,-13326 2784.494,-13161.5481 2786.9966,-10487.8906 2791.6838,-10321 2812.0654,-9595.306 2861.1137,-8704.714 2869.428,-8556.3964"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2872.9269,-8556.5125 2869.9937,-8546.3318 2865.9379,-8556.1197 2872.9269,-8556.5125"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge730" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-16006C1876.948,-15917.2171 2036.8222,-16063.7086 2161.3169,-15874 2236.673,-15759.1701 2111.8545,-13509.5203 2197.3169,-13402 2241.1376,-13346.8691 2305.3897,-13417.5328 2351.1489,-13364 2411.7277,-13293.13 2325.1805,-13015.6582 2387.1489,-12946 2435.5911,-12891.5465 2501.5294,-12969.3274 2547.7793,-12913 2571.2374,-12884.4306 2582.9984,-7626.9579 2583.7793,-7590 2604.8389,-6593.2633 2660.5933,-5366.6366 2668.7341,-5190.4586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.2341,-5190.538 2669.2006,-5180.3868 2665.2416,-5190.2141 2672.2341,-5190.538"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge761" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-16196C1620.8305,-16153.8355 2059.1256,-16212.2938 2161.3169,-16096 2204.9613,-16046.3327 2181.9001,-13780.2962 2197.3169,-13716 2233.552,-13564.8802 2306.9057,-13550.9722 2351.1489,-13402 2388.6275,-13275.8052 2329.7115,-13226.4513 2387.1489,-13108 2431.3885,-13016.7664 2508.3998,-13039.4343 2547.7793,-12946 2594.5857,-12834.9441 2574.8168,-10897.1829 2583.7793,-10777 2602.222,-10529.6921 2652.0946,-10232.2979 2666.0554,-10151.8878"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2669.5079,-10152.4625 2667.7799,-10142.0095 2662.6122,-10151.2585 2669.5079,-10152.4625"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge851" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-15816C1546.753,-15735.9779 1514.0049,-15679.6432 1587.1179,-15598 1645.1817,-15533.1618 1682.8175,-15544.365 1749.1377,-15488 1766.8647,-15472.9339 1766.187,-15463.4946 1785.1377,-15450 1861.4255,-15395.6762 2113.1643,-15340.3258 2161.3169,-15260 2212.9639,-15173.8451 2187.2223,-11743.9409 2197.3169,-11644 2233.4395,-11286.3687 2314.8117,-11207.6096 2351.1489,-10850 2423.6468,-10136.5181 2336.7008,-8338.3792 2387.1489,-7623 2403.6718,-7388.6972 2450.21,-7107.2215 2463.7346,-7028.4146"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2467.2306,-7028.7374 2465.483,-7018.2877 2460.3326,-7027.5464 2467.2306,-7028.7374"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-16008C1296.8887,-15977.7471 1327.9606,-16010.332 1356.6204,-15984 1389.8694,-15953.4514 1367.3375,-15926.4098 1392.6204,-15889 1419.4348,-15849.3239 1438.5575,-15850.4027 1471.8691,-15816"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1020" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M943.5915,-18226.1169C962.8492,-18236.6022 988.9966,-18254.254 1002.022,-18278 1045.5828,-18357.4135 1010.9466,-18597.5652 1038.022,-18684 1068.6172,-18781.6714 1115.485,-18788.4555 1152.1868,-18884 1179.1017,-18954.0669 1150.923,-18983.8449 1188.1868,-19049 1356.8114,-19343.8374 1591.0329,-19267.3903 1749.1377,-19568 1800.9829,-19666.5749 1708.6415,-19735.0477 1785.1377,-19816 1802.3601,-19834.2256 2645.1364,-20000.8848 2669.7316,-19996"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-19996C3080.111,-19892.5304 3189.6196,-19897.4319 3607.7534,-19832"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M967.0231,-18209.7252C979.9716,-18206.0822 992.9425,-18200.0253 1002.022,-18190 1056.7877,-18129.5292 1006.2898,-18085.1603 1038.022,-18010 1071.151,-17931.5311 1421.2418,-17309.5034 1471.8691,-17378"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge938" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M943.0082,-18226.0224C962.1715,-18236.5538 988.5031,-18254.3247 1002.022,-18278 1066.8614,-18391.5523 996.8048,-18445.9056 1038.022,-18570 1070.2842,-18667.1335 1116.3186,-18674.1394 1152.1868,-18770 1180.7773,-18846.4106 1146.4167,-18879.9196 1188.1868,-18950 1354.1297,-19228.4137 1597.224,-19129.6899 1749.1377,-19416 1787.4427,-19488.1931 1724.5864,-19727.1124 1785.1377,-19782 1878.3293,-19866.4749 2226.3447,-19797.6389 2351.1489,-19782 3157.9602,-19680.9003 3473.3454,-19482.4184 3881.228,-18779 4082.9679,-18431.0872 4118.2183,-17920.689 4123.5716,-17811.176"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4127.0727,-17811.23 4124.0337,-17801.0804 4120.08,-17810.9098 4127.0727,-17811.23"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge965" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M966.9186,-18211.0491C980.351,-18207.5007 993.622,-18201.1645 1002.022,-18190 1040.6048,-18138.7192 1023.4044,-15942.4875 1038.022,-15880 1064.9272,-15764.9851 1114.8305,-15752.0572 1152.1868,-15640 1177.7128,-15563.4298 1133.7099,-15521.5553 1188.1868,-15462 1191.2814,-15458.6169 1194.8106,-15455.6836 1198.6296,-15453.1411"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1200.4197,-15456.1497 1207.3968,-15448.1765 1196.9705,-15450.0584 1200.4197,-15456.1497"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge980" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M966.7915,-18204.2973C1013.9528,-18193.1137 1088.7322,-18174.3807 1152.1868,-18154 1471.0859,-18051.5742 1614.2802,-18000.5961 1749.1377,-17694 1803.2031,-17571.0832 1777.1381,-16620.0433 1785.1377,-16486 1810.0194,-16069.0729 1782.891,-15958.683 1869.0623,-15550"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge585" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M966.9054,-18207.2955C979.2614,-18203.5878 991.9457,-18198.1045 1002.022,-18190 1027.4525,-18169.5458 1016.6687,-18150.6804 1038.022,-18126 1079.9387,-18077.5521 1104.8195,-18081.1342 1152.1868,-18038 1268.0759,-17932.4676 1269.3693,-17876.8326 1392.6204,-17780 1535.4844,-17667.7584 1656.3888,-17736.2241 1749.1377,-17580 1791.7676,-17508.1951 1771.9328,-14656.4553 1785.1377,-14574 1824.3438,-14329.1859 1913.845,-14286.8244 1952.9868,-14042 2008.1404,-13697.0248 1920.8447,-11240.6462 1988.9868,-10898 2003.9629,-10822.6942 2044.5321,-10740.1193 2064.1861,-10703.0106"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2067.2754,-10704.6555 2068.9208,-10694.1891 2061.1077,-10701.345 2067.2754,-10704.6555"/>
</g>
<!-- sourcefile~datareportingflags.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~datareportingflags.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/datareportingflags.f90.html" xlink:title="DataReportingFlags.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="4353.7958,-560.0054 4231.0037,-560.0054 4231.0037,-537.9946 4353.7958,-537.9946 4353.7958,-560.0054"/>
<text text-anchor="middle" x="4292.3998" y="-545.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataReportingFlags.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datareportingflags.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1021" class="edge">
<title>sourcefile~datareportingflags.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4346.7415,-560.0599C4353.174,-563.524 4358.9484,-568.061 4363.1917,-574 4431.5669,-669.6996 4444.7315,-8800.9569 4445.4402,-9274.4823"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4441.9406,-9274.7594 4445.4554,-9284.7542 4448.9405,-9274.749 4441.9406,-9274.7594"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1529.2723,-18984.0054 1414.466,-18984.0054 1414.466,-18961.9946 1529.2723,-18961.9946 1529.2723,-18984.0054"/>
<text text-anchor="middle" x="1471.8691" y="-18969.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1022" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1527.2922,-18984.1439C1535.8932,-18987.5908 1544.2038,-18992.1006 1551.1179,-18998 1578.3345,-19021.2219 1561.7565,-19044.7651 1587.1179,-19070 1644.0464,-19126.6446 1704.2132,-19083.4323 1749.1377,-19150 1808.7265,-19238.2968 1713.283,-19549.3612 1785.1377,-19628 2033.4749,-19899.7837 3079.3387,-19668.2427 3436.8809,-19756"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~datatimings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~datatimings.f90</title>
<path fill="none" stroke="#0099ff" stroke-dasharray="5,2" d="M1528.8989,-18961.9578C1555.794,-18956.7503 1587.7166,-18950.5694 1614.2058,-18945.4405"/>
<polygon fill="#0099ff" stroke="#0099ff" points="1614.9178,-18948.8677 1624.0702,-18943.5305 1613.5871,-18941.9953 1614.9178,-18948.8677"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge939" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1529.4614,-18983.7658C1595.2591,-18999.4407 1700.1375,-19035.4768 1749.1377,-19112 1796.7875,-19186.4143 1719.8885,-19448.4135 1785.1377,-19508 1840.2237,-19558.3054 1879.3706,-19520.0727 1952.9868,-19508 2606.6068,-19400.8092 2717.6736,-19171.2814 3365.2148,-19032 3471.1142,-19009.2218 3503.4881,-19037.3642 3607.7534,-19008"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3607.7534,-19008C3860.7424,-18913.5954 4084.8588,-17965.2141 4119.7408,-17811.1096"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4123.2218,-17811.5826 4122.0015,-17801.0583 4116.3924,-17810.0465 4123.2218,-17811.5826"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1481.3914,-18961.7862C1499.2646,-18939.9168 1537.2811,-18889.2951 1551.1179,-18839 1597.4533,-18670.5762 1563.2292,-6435.0401 1587.1179,-6262 1601.4864,-6157.9209 1642.9817,-6038.5178 1660.3441,-5991.5219"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.6282,-5992.732 1663.8472,-5982.1394 1657.0704,-5990.2835 1663.6282,-5992.732"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge569" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-18974C1700.8695,-18942.6375 1727.4245,-18996.1985 1749.1377,-19036 1796.3328,-19122.5114 1712.6809,-19411.2047 1785.1377,-19478 1839.9869,-19528.5635 1888.8387,-19516.0804 1952.9868,-19478 1981.7188,-19460.9437 1969.5535,-19439.1807 1988.9868,-19412 2127.5118,-19218.2501 2192.1113,-19194.2998 2351.1489,-19017 2396.653,-18966.2708 2720.7829,-18614.532 2755.6838,-18556 2906.1964,-18303.577 2850.9571,-18197.2399 2985.5867,-17936 3080.341,-17752.1354 3445.723,-17363.0729 3508.5469,-17166 3586.577,-16921.2262 3606.2115,-12708.7327 3607.6637,-12370.53"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.1652,-12370.1612 3607.7077,-12360.1464 3604.1652,-12370.1314 3611.1652,-12370.1612"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-18974C1694.8359,-18948.4207 1726.1231,-18983.9474 1749.1377,-18955 1800.8733,-18889.9277 1756.7752,-7062.1444 1785.1377,-6984 1797.4976,-6949.9459 1826.8496,-6919.2528 1847.3365,-6900.8694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1849.7267,-6903.429 1854.9658,-6894.2202 1845.1275,-6898.1519 1849.7267,-6903.429"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1529.527,-18981.7535C1580.2542,-18987.9902 1648.9338,-18992.3828 1668.1278,-18974"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge589" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-18974C1694.8359,-18948.4207 1726.0434,-18983.8839 1749.1377,-18955 1822.4132,-18863.355 1737.9731,-14838.4412 1785.1377,-14731 1826.1964,-14637.4681 1911.8687,-14667.5058 1952.9868,-14574 1994.0924,-14480.5227 1969.152,-10998.1712 1988.9868,-10898 2003.9005,-10822.6818 2044.5003,-10740.113 2064.174,-10703.0082"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2067.2633,-10704.6533 2068.9136,-10694.1877 2061.0971,-10701.3399 2067.2633,-10704.6533"/>
</g>
<!-- sourcefile~datatimings.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1023" class="edge">
<title>sourcefile~datatimings.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-19832C3781.4181,-19783.5924 3792.9636,-19635.0921 3972.2545,-19654"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-19756C3516.0312,-19781.3684 3525.6364,-19844.8501 3607.7534,-19832"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1712.4513,-18938.8346C1726.2908,-18942.3163 1740.2463,-18948.642 1749.1377,-18960 1835.8502,-19070.7682 1687.297,-19490.9266 1785.1377,-19592 1860.4426,-19669.793 2647.9475,-19668.2551 2755.6838,-19679 3010.8538,-19704.4489 3074.6034,-19711.4653 3329.2148,-19742 3377.1259,-19747.7458 3390.929,-19741.272 3436.8809,-19756"/>
</g>
<!-- sourcefile~dataviewfactorinformation.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dataviewfactorinformation.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dataviewfactorinformation.f90.html" xlink:title="DataViewFactorInformation.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.665,-19442.0054 319.565,-19442.0054 319.565,-19419.9946 475.665,-19419.9946 475.665,-19442.0054"/>
<text text-anchor="middle" x="397.615" y="-19427.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataViewFactorInformation.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataviewfactorinformation.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1024" class="edge">
<title>sourcefile~dataviewfactorinformation.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M414.4852,-19442.138C455.5671,-19469.3661 563.8594,-19541.773 651.5354,-19606 667.8872,-19617.9785 670.4523,-19623.0898 687.5354,-19634 820.0436,-19718.6271 864.2997,-19720.1532 1002.022,-19796 1108.0925,-19854.4155 1354.1152,-20043.7627 1471.8691,-20072"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1001.9036,-4119.0054 838.3774,-4119.0054 838.3774,-4096.9946 1001.9036,-4096.9946 1001.9036,-4119.0054"/>
<text text-anchor="middle" x="920.1405" y="-4104.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1025" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3794.094,-267C3966.2835,-294.2526 4058.2432,-171.9615 4185.6079,-291 4276.6293,-376.0711 4139.5806,-475.2264 4221.6079,-569 4243.0561,-593.5195 4279.3298,-558.1603 4292.3998,-588"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M985.597,-4096.8236C991.9532,-4093.3368 997.6508,-4088.8255 1002.022,-4083 1048.2563,-4021.3829 1028.7992,-1386.4802 1038.022,-1310 1073.5195,-1015.6347 1052.2783,-923.5145 1188.1868,-660 1239.9142,-559.7051 1301.5761,-568.5135 1356.6204,-470 1383.5727,-421.763 1356.7429,-393.0243 1392.6204,-351 1662.59,-34.7764 1858.4434,-38 2274.2329,-38 2274.2329,-38 2274.2329,-38 2467.4641,-38 2760.9525,-38 2834.7326,-40.2719 3127.3396,-63 3180.4059,-67.1219 3193.3106,-71.7502 3246.2772,-77"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4292.3998,-588C4386.3017,-803.2937 4442.155,-8808.7263 4445.3286,-9274.8215"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4441.8293,-9274.9559 4445.3972,-9284.9319 4448.8291,-9274.9084 4441.8293,-9274.9559"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-77C3363.292,-79.9264 3396.284,-67.8632 3508.5469,-101 3556.292,-115.093 3561.596,-134.3533 3607.7534,-153"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-153C3698.4217,-187.716 3697.6791,-255.5935 3794.094,-267"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M985.5924,-4096.8201C991.9494,-4093.3339 997.6485,-4088.8237 1002.022,-4083 1045.5791,-4024.9995 1015.6297,-1540.9918 1038.022,-1472 1065.214,-1388.2197 1123.0775,-1393.1336 1152.1868,-1310 1174.3315,-1246.7565 1146.2374,-760.253 1188.1868,-708 1236.9169,-647.3007 1302.3924,-715.8423 1356.6204,-660 1401.9784,-613.2917 1353.5055,-570.0485 1392.6204,-518 1622.3032,-212.3707 1816.5581,-248.4416 2197.3169,-214 2405.9422,-195.1288 2790.3549,-235.8775 2949.5867,-253 3366.5781,-297.8399 3491.1288,-249.003 3881.228,-403 3953.2549,-431.4336 3981.6873,-435.4097 4027.281,-498 4124.3535,-631.2596 3959.6236,-852.0907 4124.4445,-856"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M4124.4445,-856C4239.5852,-858.7163 4290.2887,-17097.4718 4292.3351,-17768.6084"/>
<polygon fill="#ffff00" stroke="#ffff00" points="4288.8357,-17768.8571 4292.3662,-17778.8464 4295.8357,-17768.8357 4288.8357,-17768.8571"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M933.5766,-4119.0166C953.0577,-4135.9586 988.3135,-4170.5109 1002.022,-4209 1056.5395,-4362.068 1021.9552,-15746.3094 1038.022,-15908 1048.1323,-16009.7474 1077.2659,-16128.8351 1089.5434,-16176.1226"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1086.1654,-16177.0395 1092.0887,-16185.8239 1092.9362,-16175.263 1086.1654,-16177.0395"/>
</g>
<!-- sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1026" class="edge">
<title>sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1669.4335,-17500.1162C1677.838,-17572.0418 1724.7355,-17979.0872 1749.1377,-18312 1755.2042,-18394.7633 1733.6933,-18992.8844 1785.1377,-19058 1843.6075,-19132.008 1895.8099,-19102.373 1988.9868,-19117 2624.9901,-19216.8406 2796.2025,-19096.7574 3436.8809,-19160"/>
</g>
<!-- sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge940" class="edge">
<title>sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1669.4112,-17500.1178C1677.676,-17572.0539 1723.8533,-17979.153 1749.1377,-18312 1754.8015,-18386.5589 1745.5962,-18920.5368 1785.1377,-18984 1877.5215,-19132.2737 1987.4403,-19114.9347 2161.3169,-19098 2454.2223,-19069.4725 3167.1216,-18859.6322 3436.8809,-18742"/>
</g>
<!-- sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge903" class="edge">
<title>sourcefile~daylightingdevices.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1669.1712,-17500.1081C1679.5819,-17610.6781 1764.8144,-18509.837 1785.1377,-18528 1909.7991,-18639.4104 2002.591,-18580.5248 2161.3169,-18528 2166.1136,-18526.4127 3325.4794,-17663.4022 3329.2148,-17660 3497.1429,-17507.0516 3562.7159,-17479.6904 3670.96,-17280 3755.1137,-17124.7519 3784.4972,-16908.4073 3791.9738,-16840.3589"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3795.4899,-16840.3902 3793.0579,-16830.0783 3788.5285,-16839.6561 3795.4899,-16840.3902"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1027" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-13492C1303.9106,-13513.1425 1323.3466,-13487.7638 1356.6204,-13506 1377.5944,-13517.4951 1372.433,-13533.1735 1392.6204,-13546 1454.7442,-13585.4717 1503.2704,-13538.0716 1551.1179,-13594 1626.3823,-13681.9757 1517.4545,-13759.5259 1587.1179,-13852 1634.5313,-13914.9384 1704.8041,-13858.8555 1749.1377,-13924 1802.134,-14001.8736 1723.3147,-14699.9309 1785.1377,-14771 1813.0281,-14803.0617 2133.8032,-14807.6145 2161.3169,-14840 2229.1324,-14919.8236 2152.3123,-16630.4202 2197.3169,-16725 2235.7786,-16805.8294 2309.5587,-16775.7349 2351.1489,-16855 2427.7091,-17000.9128 2291.9578,-17089.4985 2387.1489,-17224 2389.7978,-17227.7428 2981.4046,-17501.1198 2985.5867,-17503 3064.1105,-17538.3041 3081.0245,-17554.7694 3163.3396,-17580 3250.6292,-17606.7554 3275.1885,-17602.8151 3365.2148,-17618 3516.6446,-17643.542 3554.1943,-17653.3157 3706.96,-17669 3824.4394,-17681.0615 3857.2978,-17656.947 3972.2545,-17684"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge941" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1134.6258,-13280.1131C1141.3266,-13283.589 1147.5915,-13288.1169 1152.1868,-13294 1211.0169,-13369.3183 1131.6147,-13428.9713 1188.1868,-13506 1237.9408,-13573.7451 1286.4709,-13545.6976 1356.6204,-13592 1374.0026,-13603.4732 1376.0491,-13609.3837 1392.6204,-13622 1460.8441,-13673.9414 1504.6394,-13659.9435 1551.1179,-13732 1599.1262,-13806.4281 1539.3499,-13853.4174 1587.1179,-13928 1634.6051,-14002.1441 1706.738,-13964.8337 1749.1377,-14042 1789.9548,-14116.286 1734.8667,-14735.7558 1785.1377,-14804 1842.3024,-14881.6026 1896.8045,-14849.8505 1988.9868,-14878 2064.4846,-14901.0546 2112.1653,-14859.2298 2161.3169,-14921 2230.5806,-15008.0455 2154.833,-16820.1919 2197.3169,-16923 2234.9913,-17014.1694 2308.9869,-16993.8171 2351.1489,-17083 2409.4879,-17206.4012 2307.4868,-17277.1611 2387.1489,-17388 2433.2425,-17452.1329 2479.5969,-17424.14 2547.7793,-17464 2753.6079,-17584.3291 2773.4196,-17665.2359 2985.5867,-17774 3115.6961,-17840.6985 3464.7334,-17957.6284 3607.7534,-17988"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3607.7534,-17988C3690.3782,-17993.6551 3722.5377,-18029.6957 3794.094,-17988"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge964" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1136.0817,-13280.1441C1142.3932,-13283.6005 1148.145,-13288.1135 1152.1868,-13294 1202.1116,-13366.7123 1183.4408,-13998.9259 1188.1868,-14087 1217.3189,-14627.6235 1262.2844,-15289.4286 1270.9361,-15415.6592"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1267.462,-15416.1586 1271.6386,-15425.8955 1274.4456,-15415.6793 1267.462,-15416.1586"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1096.2766,-13257.5798C1102.9865,-13193.0828 1137.9944,-12867.9902 1188.1868,-12606 1247.6645,-12295.543 1307.3235,-12227.2355 1356.6204,-11915 1390.3291,-11701.4961 1343.3322,-11640.454 1392.6204,-11430 1435.2848,-11247.8285 1498.8212,-11219.6434 1551.1179,-11040 1571.3543,-10970.4865 1767.196,-9828.1408 1785.1377,-9758 1807.5984,-9670.1926 1844.8127,-9568.6591 1861.0602,-9525.7947"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1864.3388,-9527.0199 1864.6315,-9516.4291 1857.7982,-9524.5258 1864.3388,-9527.0199"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1095.8131,-13257.816C1101.3418,-13170.0459 1137.731,-12582.777 1152.1868,-12105 1162.7119,-11757.1362 1133.767,-9316.7419 1188.1868,-8973 1235.873,-8671.7906 1298.0833,-8607.9376 1392.6204,-8318 1460.4364,-8110.0138 1512.9771,-8067.4125 1551.1179,-7852 1612.7366,-7503.9891 1535.3257,-6611.6084 1587.1179,-6262 1602.5148,-6158.0681 1643.4288,-6038.5818 1660.4899,-5991.5428"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.7769,-5992.745 1663.9302,-5982.1513 1657.204,-5990.3372 1663.7769,-5992.745"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.819,-13257.8162C1101.393,-13170.0475 1138.0631,-12582.7869 1152.1868,-12105 1158.0359,-11907.1319 1154.3504,-8737.0413 1188.1868,-8542 1217.5592,-8372.69 1420.3214,-7853.5937 1463.7091,-7743.6102"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1467.0819,-7744.5984 1467.501,-7734.0119 1460.5715,-7742.0264 1467.0819,-7744.5984"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.8386,-13257.8167C1101.5623,-13170.0523 1139.1604,-12582.8181 1152.1868,-12105 1153.4232,-12059.6481 1160.1571,-5607.6743 1188.1868,-5572 1190.1505,-5569.5006 1192.3625,-5567.2706 1194.7683,-5565.2824"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.2168,-5567.8585 1203.6166,-5559.4149 1193.3482,-5562.0246 1197.2168,-5567.8585"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge904" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-17114C3491.3114,-17095.2628 3491.6091,-17064.6133 3544.5469,-17042 3571.0065,-17030.6973 3582.8377,-17042.39 3607.7534,-17028"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-13492C1304.8762,-13511.6271 1319.4588,-13498.3375 1356.6204,-13506 1443.8228,-13523.9805 1489.7123,-13489.5259 1551.1179,-13554 1608.5865,-13614.3404 1537.4876,-13671.064 1587.1179,-13738 1635.6738,-13803.4869 1704.6318,-13755.696 1749.1377,-13824 1809.7107,-13916.9625 1743.6595,-14219.089 1785.1377,-14322 1882.8413,-14564.411 2069.5443,-14529.282 2161.3169,-14774 2221.1823,-14933.6353 2138.5864,-16147.9437 2197.3169,-16308 2291.4259,-16564.4722 2374.1671,-16610.7938 2583.7793,-16786 2664.635,-16853.584 2695.0747,-16857.9059 2791.6838,-16900 2860.9256,-16930.1697 3365.4649,-17138.5843 3436.8809,-17114"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1129.7124,-13280.1188C1137.6571,-13283.7206 1145.6739,-13288.2997 1152.1868,-13294 1229.6554,-13361.8037 1186.9168,-13434.635 1272.4036,-13492"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge573" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-16658C3330.8095,-16675.7701 3366.766,-16670.4518 3436.8809,-16620"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13724C1689.247,-13764.1199 1727.5645,-13746.1224 1749.1377,-13786 1800.4562,-13880.861 1723.3582,-14181.5948 1785.1377,-14270 1832.0457,-14337.1244 1895.1486,-14288.0277 1952.9868,-14346 1980.5248,-14373.6018 1963.4902,-14396.5022 1988.9868,-14426 2048.4058,-14494.7438 2116.5527,-14456.9273 2161.3169,-14536 2232.7782,-14662.2311 2131.2518,-15711.8629 2197.3169,-15841 2388.9807,-16215.6442 2634.3012,-16137.2737 2949.5867,-16416 3051.2494,-16505.8743 3046.8467,-16564.4148 3163.3396,-16634 3196.2833,-16653.6784 3208.7245,-16650.1058 3246.2772,-16658"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge603" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1471.8691,-13002C1504.7504,-12985.4722 1526.8256,-13005.6447 1551.1179,-12978 1615.3608,-12904.8915 1522.6545,-12834.9141 1587.1179,-12762 1611.9903,-12733.8671 1644.1458,-12766.8957 1668.1278,-12738"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1668.1278,-12738C1697.0834,-12703.1117 1725.1921,-12714.4998 1749.1377,-12676 1792.6866,-12605.9821 1721.4262,-12546.3436 1785.1377,-12494 1851.8337,-12439.2044 2117.6596,-12506.33 2226.9444,-12537.1202"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2226.1352,-12540.5287 2236.711,-12539.8928 2228.047,-12533.7948 2226.1352,-12540.5287"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge621" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1668.1278,-12130C1676.6118,-12094.0049 1725.7225,-12139.6244 1749.1377,-12111 1831.2766,-12010.5876 1697.1026,-11039.2852 1785.1377,-10944 1796.1378,-10932.094 2064.3808,-10924.1136 2075.1519,-10912"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2075.1519,-10912C2125.4037,-10840.8662 2141.2894,-10820.7595 2161.3169,-10736 2187.4816,-10625.267 2139.3149,-6737.8885 2197.3169,-6640 2237.2459,-6572.6128 2304.6688,-6617.0473 2351.1489,-6554 2415.2381,-6467.0672 2455.7829,-6118.0887 2465.3006,-6028.2019"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2468.7947,-6028.4404 2466.351,-6018.1312 2461.8324,-6027.7142 2468.7947,-6028.4404"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge655" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M2075.1519,-11140C2114.3909,-11096.3862 2140.2212,-11094.7433 2161.3169,-11040 2220.2258,-10887.1311 2182.8082,-9729.1829 2197.3169,-9566 2237.0627,-9118.9695 2288.9614,-9012.4645 2351.1489,-8568 2401.6819,-8206.8323 2453.3661,-7764.8709 2465.0296,-7664.1144"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2468.5261,-7664.3453 2466.1974,-7654.0096 2461.5724,-7663.5416 2468.5261,-7664.3453"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge796" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1471.8691,-13078C1685.9651,-13077.8944 1781.7353,-12973.5088 1952.9868,-13102 1992.1116,-13131.3556 1967.3805,-13162.1176 1988.9868,-13206 2050.5528,-13331.0406 2102.9394,-13341.4394 2161.3169,-13468 2185.3533,-13520.1103 2170.3888,-13541.3235 2197.3169,-13592 2259.1902,-13708.4406 2267.7513,-13764.0455 2387.1489,-13820 2538.5842,-13890.9686 2652.8024,-13875.8506 2755.6838,-13744 2849.7068,-13623.5023 2715.0548,-13534.2422 2791.6838,-13402 2835.081,-13327.1075 2909.8517,-13364.8983 2949.5867,-13288 3004.3185,-13182.0785 2975.6198,-9114.8091 2985.5867,-8996 2999.2846,-8832.7156 3038.4957,-8638.5784 3051.9034,-8575.1667"/>
<polygon fill="#003fff" stroke="#003fff" points="3055.3676,-8575.7033 3054.0283,-8565.1935 3048.5212,-8574.2446 3055.3676,-8575.7033"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge829" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1668.1278,-12130C1676.5815,-12093.9978 1725.5571,-12139.4882 1749.1377,-12111 1809.2712,-12038.3516 1734.9554,-11342.8471 1785.1377,-11263 1839.8064,-11176.0144 1891.6613,-11186.9074 1988.9868,-11154 2025.7405,-11141.5729 2049.2378,-11168.8743 2075.1519,-11140"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2075.1519,-11140C2110.5668,-11093.2277 2140.5778,-11094.8794 2161.3169,-11040 2223.3017,-10875.9766 2174.7557,-8057.8872 2197.3169,-7884 2233.3478,-7606.2976 2299.3824,-7548.2037 2351.1489,-7273 2374.8322,-7147.0939 2368.6591,-7113.7729 2387.1489,-6987 2413.2955,-6807.7296 2451.4361,-6592.2459 2463.5916,-6524.4737"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2467.1084,-6524.6918 2465.4329,-6514.2303 2460.2188,-6523.4533 2467.1084,-6524.6918"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge874" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1471.8691,-13078C1508.6565,-13076.9816 1522.4152,-13077.0326 1551.1179,-13054 1576.5716,-13033.5746 1558.9465,-13006.476 1587.1179,-12990 1728.4491,-12907.3428 1810.1069,-12953.0497 1952.9868,-13033 1973.289,-13044.3603 1971.7828,-13055.3393 1988.9868,-13071 2060.9359,-13136.4946 2109.2118,-13123.8339 2161.3169,-13206 2199.8876,-13266.8232 2162.1694,-13301.1365 2197.3169,-13364 2254.9601,-13467.0985 2279.4478,-13501.4973 2387.1489,-13550 2536.604,-13617.3064 2634.0276,-13673.8487 2755.6838,-13564 2814.0437,-13511.3043 2772.2492,-13288.1906 2791.6838,-13212 2836.4823,-13036.3745 2913.0491,-13013.5281 2949.5867,-12836 2997.7678,-12601.8984 2978.911,-8772.9151 2985.5867,-8534 3002.3607,-7933.6738 3046.8476,-7198.3877 3055.1268,-7064.449"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.6311,-7064.486 3055.7568,-7054.2885 3051.6445,-7064.0527 3058.6311,-7064.486"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1272.4036,-13002C1348.1974,-12944.9448 1377.0135,-13076.4454 1471.8691,-13078"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12850C1494.5439,-12821.0138 1528.3215,-12854.8906 1551.1179,-12826 1634.6835,-12720.0948 1497.2045,-12320.5718 1587.1179,-12220 1611.4705,-12192.7606 1657.6039,-12240.9897 1668.1278,-12206"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-12206C1678.9435,-12170.0401 1725.7457,-12211.3753 1749.1377,-12182 1789.2215,-12131.6633 1767.3168,-11665.8297 1785.1377,-11604 1837.5672,-11422.0954 1849.6428,-11358.1458 1988.9868,-11230 2050.6018,-11173.3366 2113.9361,-11223.0087 2161.3169,-11154 2208.6023,-11085.1301 2179.7549,-10484.6734 2197.3169,-10403 2236.4876,-10220.8338 2294.5451,-10190.5243 2351.1489,-10013 2405.6798,-9841.977 2449.8897,-9629.3197 2463.2863,-9562.2678"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.7848,-9562.6188 2465.298,-9552.1288 2459.9187,-9561.2564 2466.7848,-9562.6188"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-13002C1303.9244,-12979.1703 1328.7137,-13005.1289 1356.6204,-12978 1394.7181,-12940.9639 1352.6707,-12899.0305 1392.6204,-12864 1419.5129,-12840.4188 1449.8316,-12878.1715 1471.8691,-12850"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1130.6575,-13257.9915C1138.3918,-13254.4162 1146.0774,-13249.8214 1152.1868,-13244 1239.1311,-13161.1531 1175.1394,-13072.4459 1272.4036,-13002"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1272.4036,-13002C1310.0464,-12974.7363 1332.3294,-12979.6262 1356.6204,-12940 1407.9425,-12856.2773 1342.8581,-12806.6592 1392.6204,-12722 1404.2246,-12702.258 1424.5442,-12686.2927 1441.7023,-12675.3734"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1443.5984,-12678.3167 1450.3237,-12670.1301 1439.961,-12672.336 1443.5984,-12678.3167"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge530" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1272.4036,-13270C1350.2072,-13296.9895 1326.1927,-13362.3255 1392.6204,-13411 1454.3104,-13456.2031 1503.8773,-13417.856 1551.1179,-13478 1612.8602,-13556.6067 1521.076,-13624.9695 1587.1179,-13700 1611.9285,-13728.1874 1650.4846,-13690.8517 1668.1278,-13724"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1668.1278,-13724C1689.0852,-13764.2047 1726.7802,-13746.5568 1749.1377,-13786 1818.6237,-13908.5875 1726.405,-13972.9122 1785.1377,-14101 1836.4715,-14212.9519 2114.3492,-14394.1474 2161.3169,-14508 2203.1666,-14609.4464 2135.3999,-15404.3961 2197.3169,-15495 2346.9804,-15714.0046 3138.807,-16058.6809 3329.2148,-15874 3396.303,-15808.9297 3433.3792,-12659.5181 3436.6447,-12370.231"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3440.145,-12370.2209 3436.7575,-12360.1822 3433.1454,-12370.1423 3440.145,-12370.2209"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge540" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1135.7686,-13280.0056C1142.1952,-13283.4802 1148.068,-13288.0352 1152.1868,-13294 1241.9528,-13423.9995 1113.8933,-13864.5787 1188.1868,-14004 1199.2054,-14024.6778 1220.3375,-14040.455 1238.6759,-14051.0491"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1237.217,-14054.2406 1247.6692,-14055.9735 1240.579,-14048.1008 1237.217,-14054.2406"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12850C1494.5439,-12821.0138 1527.2377,-12854.0014 1551.1179,-12826 1627.9595,-12735.8973 1525.5666,-12663.1659 1587.1179,-12562 1632.8828,-12486.7806 1701.4784,-12522.0335 1749.1377,-12448 1795.8963,-12375.3656 1730.4582,-12323.8751 1785.1377,-12257 1899.3853,-12117.2709 2047.0024,-12243.6744 2161.3169,-12104 2215.7518,-12037.4891 2156.9196,-11989.8612 2197.3169,-11914 2242.4937,-11829.1635 2309.8455,-11848.7883 2351.1489,-11762 2422.1488,-11612.8122 2338.6693,-11549.9484 2387.1489,-11392 2430.9533,-11249.2835 2483.873,-11231.9179 2547.7793,-11097 2596.4352,-10994.2785 2644.2976,-10866.7046 2662.2759,-10817.5923"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2665.6033,-10818.6835 2665.7392,-10808.0895 2659.0265,-10816.2865 2665.6033,-10818.6835"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge427" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1272.4036,-13002C1371.7972,-12929.0526 1310.9918,-13159.6031 1392.6204,-13252 1448.0832,-13314.7794 1490.6029,-13296.075 1551.1179,-13354 1606.1719,-13406.6977 1720.1913,-13563.5011 1749.1377,-13634 1786.4368,-13724.8418 1719.7998,-13778.6896 1785.1377,-13852 1836.7621,-13909.9235 1882.8962,-13866.7205 1952.9868,-13900 2054.8936,-13948.386 2097.9062,-13951.6978 2161.3169,-14045 2200.5835,-14102.7766 2154.0285,-14143.172 2197.3169,-14198 2316.4103,-14348.8407 2396.7679,-14347.6956 2583.7793,-14392 2658.1235,-14409.6127 2699.8387,-14444.1401 2755.6838,-14392 2798.341,-14352.1729 2772.9283,-13923.2635 2791.6838,-13868 2832.4801,-13747.7931 2912.1474,-13751.2944 2949.5867,-13630 2972.2821,-13556.472 2940.7287,-10922.5237 2985.5867,-10860 2987.8495,-10856.846 2990.5436,-10854.0874 2993.5382,-10851.675"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6421,-10854.4806 3002.0769,-10846.0637 2991.7977,-10848.6307 2995.6421,-10854.4806"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge482" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-12738C1757.0477,-12642.6599 1829.0198,-12767.6435 1952.9868,-12808 2267.4651,-12910.3758 2422.6726,-13227.8619 2669.7316,-13008"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge493" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1668.1278,-12206C1677.8048,-12169.7171 1724.6404,-12210.4601 1749.1377,-12182 1824.6675,-12094.2521 1748.9733,-12033.9845 1785.1377,-11924 1894.7274,-11590.7121 2055.1939,-11564.4079 2161.3169,-11230 2202.4709,-11100.3182 2118.83,-11037.1343 2197.3169,-10926 2241.3086,-10863.7095 2307.4649,-10912.5066 2351.1489,-10850 2436.1703,-10728.3447 2330.7336,-10655.2806 2387.1489,-10518 2400.6955,-10485.0359 2428.4202,-10454.0388 2447.4709,-10435.2933"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.9986,-10437.7186 2454.7915,-10428.2698 2445.1524,-10432.6674 2449.9986,-10437.7186"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-12738C1698.3426,-12704.1963 1719.8524,-12710.6121 1749.1377,-12676 1771.2257,-12649.8944 1755.8416,-12625.6386 1785.1377,-12608 1849.0476,-12569.5211 1892.2188,-12564.7294 1952.9868,-12608 1992.8309,-12636.3715 1954.9864,-12676.8366 1988.9868,-12712 2020.7859,-12744.8867 2311.3205,-12842.0758 2423.527,-12878.7633"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2422.5948,-12882.1406 2433.1872,-12881.9163 2424.7668,-12875.4861 2422.5948,-12882.1406"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-13002C1507.673,-12984.0032 1520.3812,-12984.711 1551.1179,-12959 1570.7635,-12942.5667 1566.5078,-12929.2061 1587.1179,-12914 1663.2336,-12857.842 1692.2073,-12853.6429 1785.1377,-12836 1858.4282,-12822.0857 1894.1111,-12790.1879 1952.9868,-12836 2004.3713,-12875.9831 1949.9025,-12925.9286 1988.9868,-12978 2092.4732,-13115.873 2512.7319,-13421.2005 2669.7316,-13350"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2870.6353,-14758C2905.57,-14713.4338 2927.5648,-14710.1691 2949.5867,-14658 3012.8896,-14508.0374 3048.3113,-13977.6956 3055.212,-13865.1068"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3058.7121,-13865.2103 3055.8221,-13855.0173 3051.7248,-13864.7878 3058.7121,-13865.2103"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1152.4415,-13260.5143C1187.8859,-13257.399 1233.8185,-13257.267 1272.4036,-13270"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-13270C1334.3009,-13290.426 1337.1722,-13319.7361 1392.6204,-13354 1460.7984,-13396.1302 1503.6789,-13375.4032 1551.1179,-13440 1600.4413,-13507.1626 1531.0543,-13562.352 1587.1179,-13624 1612.3825,-13651.7812 1648.5794,-13615.9383 1668.1278,-13648"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-13648C1688.2354,-13679.714 1724.6252,-13643.553 1749.1377,-13672 1824.1397,-13759.0407 1722.826,-13831.4669 1785.1377,-13928 1892.4327,-14094.2211 2059.1778,-13996.5618 2161.3169,-14166 2214.1376,-14253.6241 2129.3145,-14548.5561 2197.3169,-14625 2222.6595,-14653.4886 2847.1121,-14788.0085 2870.6353,-14758"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1135.193,-13280.0556C1141.7585,-13283.5305 1147.8288,-13288.0728 1152.1868,-13294 1238.5355,-13411.4423 1094.7142,-13508.1444 1188.1868,-13620 1194.7882,-13627.8997 1203.7633,-13633.3716 1213.4016,-13637.1468"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.6042,-13640.5694 1223.1974,-13640.3835 1214.8004,-13633.9228 1212.6042,-13640.5694"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge458" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-13002C1384.3511,-12920.9194 1468.781,-12975.0268 1551.1179,-12864 1609.0911,-12785.8264 1530.2542,-12726.9843 1587.1179,-12648 1634.7502,-12581.8383 1701.6031,-12628.2319 1749.1377,-12562 1806.9076,-12481.5069 1724.1429,-12420.0777 1785.1377,-12342 1897.2026,-12198.549 2044.6778,-12319.7572 2161.3169,-12180 2206.9099,-12125.3704 2157.8225,-12083.1887 2197.3169,-12024 2243.9688,-11954.0847 2308.8432,-11986.6277 2351.1489,-11914 2428.0785,-11781.9324 2307.5211,-11702.4585 2387.1489,-11572 2442.795,-11480.8321 2562.3153,-11425.7414 2626.6426,-11401.5435"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2627.9233,-11404.8017 2636.0968,-11398.0604 2625.5034,-11398.2332 2627.9233,-11404.8017"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge583" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12774C1489.6149,-12741.7598 1528.3215,-12778.8906 1551.1179,-12750 1634.6835,-12644.0948 1497.2045,-12244.5718 1587.1179,-12144 1611.4705,-12116.7606 1659.8103,-12165.5788 1668.1278,-12130"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-12130C1676.5463,-12093.9895 1725.7643,-12139.6585 1749.1377,-12111 1839.6939,-11999.9676 1707.1113,-10942.1686 1785.1377,-10822 1832.8112,-10748.578 1930.8742,-10712.9523 1999.7213,-10696.3664"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2000.7106,-10699.7298 2009.6576,-10694.0553 1999.1247,-10692.9118 2000.7106,-10699.7298"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge691" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13648C1687.9948,-13679.8653 1725.0459,-13643.1959 1749.1377,-13672 1795.7569,-13727.7378 1754.556,-13931.0848 1785.1377,-13997 1887.4392,-14217.499 2065.4054,-14170.6474 2161.3169,-14394 2191.2586,-14463.7264 2145.6932,-15020.3829 2197.3169,-15076 2425.9292,-15322.2966 2694.0349,-15370.2175 2949.5867,-15152 2988.4276,-15118.8334 2971.7377,-14974.1614 2985.5867,-14925 3030.313,-14766.2296 3094.8124,-14743.711 3127.3396,-14582 3166.0559,-14389.5193 3159.6279,-7710.3008 3163.3396,-7514 3183.1053,-6468.6397 3237.5955,-5181.568 3245.3535,-5001.3332"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3248.8616,-5001.2181 3245.796,-4991.0765 3241.8681,-5000.9163 3248.8616,-5001.2181"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge767" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-13002C1508.0326,-12984.7372 1528.0688,-12991.7801 1551.1179,-12959 1611.8938,-12872.5655 1529.7528,-12812.7349 1587.1179,-12724 1633.7038,-12651.9389 1699.5835,-12689.053 1749.1377,-12619 1788.7309,-12563.0284 1745.1335,-12524.6787 1785.1377,-12469 1900.301,-12308.7132 2015.6759,-12366.2033 2161.3169,-12233 2264.2655,-12138.8431 2283.1161,-12104.801 2351.1489,-11983 2372.7623,-11944.305 2368.9161,-11930.3981 2387.1489,-11890 2465.213,-11717.0354 2454.0604,-11649.5055 2583.7793,-11511 2644.8199,-11445.8248 2710.5474,-11484.0484 2755.6838,-11407 2786.1973,-11354.9132 2789.3508,-10381.3214 2791.6838,-10321 2819.7411,-9595.5623 2862.4386,-8704.7582 2869.5995,-8556.4021"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2873.0992,-8556.4922 2870.086,-8546.3349 2866.1073,-8556.1543 2873.0992,-8556.4922"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-13002C1343.8723,-12949.5474 1391.7496,-13039.9464 1471.8691,-13002"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge785" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-12774C1489.6149,-12741.7598 1528.3593,-12778.9204 1551.1179,-12750 1638.3864,-12639.1041 1500.1419,-12227.1254 1587.1179,-12116 1593.9246,-12107.3034 1603.7003,-12101.557 1614.1198,-12097.7786"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.2542,-12101.092 1623.8032,-12094.8337 1613.2174,-12094.3948 1615.2542,-12101.092"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-13002C1303.9244,-12979.1703 1330.2256,-13006.602 1356.6204,-12978 1411.9494,-12918.0442 1337.7862,-12858.4087 1392.6204,-12798 1417.3552,-12770.7506 1454.1234,-12806.2402 1471.8691,-12774"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge735" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-12850C1494.3813,-12820.8873 1527.8107,-12854.4801 1551.1179,-12826 1604.5579,-12760.6994 1529.7675,-12509.8945 1587.1179,-12448 1611.9517,-12421.1986 1652.0057,-12466.7889 1668.1278,-12434"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-12434C1688.1333,-12393.3133 1726.3429,-12411.1921 1749.1377,-12372 1808.4533,-12270.0163 1748.7333,-12221.2218 1785.1377,-12109 1894.483,-11771.9275 2050.9844,-11742.7507 2161.3169,-11406 2196.5425,-11298.4865 2159.0564,-11260.4713 2197.3169,-11154 2241.6923,-11030.5121 2306.5628,-11025.4119 2351.1489,-10902 2388.6943,-10798.0764 2348.2198,-10759.4133 2387.1489,-10656 2410.2818,-10594.5485 2458.1253,-10596.9938 2467.4641,-10532"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-10532C2474.2951,-10487.4262 2527.6409,-10510.3477 2547.7793,-10470 2583.5088,-10398.4151 2581.8598,-7669.9832 2583.7793,-7590 2607.6977,-6593.3278 2661.0166,-5366.6461 2668.7811,-5190.4596"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.2812,-5190.532 2669.2259,-5180.3873 2665.288,-5190.2232 2672.2812,-5190.532"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge745" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-12434C1687.5839,-12393.0477 1725.4374,-12410.6513 1749.1377,-12372 1795.2069,-12296.8685 1728.0433,-12244.1367 1785.1377,-12177 1847.4812,-12103.691 1896.513,-12130.637 1988.9868,-12104 2064.3535,-12082.2907 2108.6745,-12124.1396 2161.3169,-12066 2206.9766,-12015.5723 2183.144,-11828.5348 2197.3169,-11762 2245.2257,-11537.0915 2303.2401,-11492.9085 2351.1489,-11268 2379.4947,-11134.9304 2346.6838,-11093.8984 2387.1489,-10964 2432.598,-10818.1024 2494.4714,-10803.2131 2547.7793,-10660 2618.623,-10469.6763 2656.606,-10224.9738 2666.8566,-10152.2661"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2670.3584,-10152.4942 2668.2645,-10142.1083 2663.4247,-10151.5331 2670.3584,-10152.4942"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1028" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4124.8865,-17801.234C4129.7453,-17921.248 4175.2834,-18961.865 4292.3998,-18932"/>
</g>
<!-- sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~daylightingmanager.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M4186.0311,-17790C4194.3752,-17790 4203.0374,-17790 4211.6541,-17790"/>
<polygon fill="#ffff00" stroke="#ffff00" points="4211.7268,-17793.5001 4221.7268,-17790 4211.7268,-17786.5001 4211.7268,-17793.5001"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1029" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-11901C1331.1309,-11921.0807 1489.5336,-11911.2862 1551.1179,-11919 1639.9557,-11930.1274 1690.8888,-11888.0071 1749.1377,-11956 1791.5908,-12005.5547 1769.4082,-13066.6713 1785.1377,-13130 1825.953,-13294.3266 1889.5376,-13315.0181 1952.9868,-13472 2066.0325,-13751.6902 2109.6408,-13820.7871 2161.3169,-14118 2203.707,-14361.805 2144.7294,-14989.1895 2197.3169,-15231 2234.9881,-15404.2216 2286.6556,-15433.8774 2351.1489,-15599 2368.1822,-15642.6104 2368.2866,-15655.1489 2387.1489,-15698 2543.8443,-16053.9783 2600.7434,-16135.1553 2791.6838,-16474 2947.9097,-16751.24 2939.9296,-16859.3803 3163.3396,-17086 3224.4276,-17147.9656 3255.6396,-17143.5441 3329.2148,-17190 3452.1313,-17267.6103 3778.412,-17438.2348 3881.228,-17541 3934.5141,-17594.2598 3900.7702,-17660.2091 3972.2545,-17684"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-11559C956.6256,-11564.6493 975.6829,-11547.1286 1002.022,-11573 1063.3374,-11633.2269 983.9777,-11696.1713 1038.022,-11763 1072.6331,-11805.7986 1104.4288,-11783.6353 1152.1868,-11811 1210.0977,-11844.1822 1209.7182,-11878.081 1272.4036,-11901"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3972.2545,-17684C4068.9404,-17717.2314 4124.5818,-17687.9738 4185.6079,-17770 4340.3918,-17978.0477 4040.8943,-18995.142 4292.3998,-18932"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4292.3998,-18932C4534.5353,-18870.4777 4354.1155,-18059.6642 4363.1917,-17810 4429.6465,-15981.9733 4444.511,-9730.8133 4445.4252,-9317.5103"/>
<polygon fill="#ff0000" stroke="#ff0000" points="4448.9257,-9317.2263 4445.4477,-9307.2186 4441.9257,-9317.2109 4448.9257,-9317.2263"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3972.2545,-17342C4134.5214,-17212.4039 4014.403,-17085.2676 4027.281,-16878 4034.1809,-16766.9482 4013.2095,-853.3758 4124.4445,-856"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1668.1278,-11900C1693.7483,-11927.4533 1726.1208,-11894.3298 1749.1377,-11924 1815.7896,-12009.9184 1746.0686,-12800.5207 1785.1377,-12902 1826.8312,-13010.2959 1903.7066,-12996.9391 1952.9868,-13102 1991.1558,-13183.3729 1945.4675,-13222.3585 1988.9868,-13301 2039.1544,-13391.6552 2118.3144,-13363.7348 2161.3169,-13458 2230.3257,-13609.2733 2110.7606,-14812.0358 2197.3169,-14954 2237.8691,-15020.5111 2306.4072,-14974.2318 2351.1489,-15038 2411.585,-15124.1364 2330.7431,-15183.1722 2387.1489,-15272 2433.2645,-15344.6228 2501.3436,-15307.5815 2547.7793,-15380 2601.4963,-15463.774 2531.1253,-15516.5538 2583.7793,-15601 2633.3489,-15680.4995 2705.7847,-15643.7069 2755.6838,-15723 2806.1196,-15803.1458 2758.5665,-15844.285 2791.6838,-15933 2849.8416,-16088.7937 2898.7331,-16111.1887 2985.5867,-16253 3048.1039,-16355.0758 3083.969,-16370.4344 3127.3396,-16482 3158.4807,-16562.1068 3116.3853,-16600.0128 3163.3396,-16672 3212.2101,-16746.925 3271.2098,-16717.9007 3329.2148,-16786 3353.4504,-16814.4531 3342.6554,-16832.2005 3365.2148,-16862 3416.2331,-16929.3917 3453.0294,-16923.2636 3508.5469,-16987 3527.7359,-17009.0298 3524.2229,-17021.0127 3544.5469,-17042 3584.9286,-17083.6997 3926.8971,-17378.2251 3972.2545,-17342"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M778.511,-11490.085C787.4956,-11493.8162 796.342,-11499.2168 802.259,-11507 871.5287,-11598.1162 780.6323,-11663.1081 838.259,-11762 849.9479,-11782.059 870.7494,-11797.9395 888.4603,-11808.7389"/>
<polygon fill="#00ff00" stroke="#00ff00" points="886.9707,-11811.9212 897.3756,-11813.9183 890.4871,-11805.8685 886.9707,-11811.9212"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M778.5563,-11489.3807C787.7716,-11493.1008 796.7339,-11498.6718 802.259,-11507 849.3912,-11578.0431 830.5671,-14491.0918 838.259,-14576 877.3098,-15007.0649 944.7466,-15106.9762 1002.022,-15536 1024.0024,-15700.645 1013.8993,-15743.6552 1038.022,-15908 1052.8397,-16008.9515 1079.2303,-16128.0771 1090.1565,-16175.7381"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1086.8139,-16176.8194 1092.4722,-16185.7767 1093.6348,-16175.2459 1086.8139,-16176.8194"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M778.2882,-11489.2386C787.6104,-11492.9575 796.7005,-11498.5636 802.259,-11507 853.3278,-11584.5092 782.8323,-18115.5448 838.259,-18190 844.5814,-18198.4929 853.7252,-18204.1951 863.6307,-18208.002"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="862.7028,-18211.3799 873.2939,-18211.1004 864.8401,-18204.7142 862.7028,-18211.3799"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datatimings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datatimings.f90</title>
<path fill="none" stroke="#0099ff" stroke-dasharray="5,2" d="M778.5179,-11489.4063C787.7317,-11493.1274 796.7027,-11498.6926 802.259,-11507 860.0888,-11593.4622 808.1877,-13279.4223 838.259,-13379 877.414,-13508.6574 939.0009,-13516.1146 1002.022,-13636 1021.1117,-13672.3145 1020.3903,-13683.9556 1038.022,-13721 1053.3203,-13753.1419 1160.2069,-13981.9939 1188.1868,-14004 1248.9148,-14051.7626 1308.9962,-13986.1633 1356.6204,-14047 1438.6739,-14151.8179 1315.1126,-18730.7775 1392.6204,-18839 1418.8516,-18875.6261 1541.651,-18907.7037 1614.1514,-18923.8699"/>
<polygon fill="#0099ff" stroke="#0099ff" points="1613.5139,-18927.3132 1624.0324,-18926.0442 1615.0183,-18920.4768 1613.5139,-18927.3132"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-17378C1509.5353,-17429.632 1530.1429,-17435.0441 1587.1179,-17464 1595.2122,-17468.1137 1604.1094,-17471.6964 1612.9526,-17474.7653"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1611.8938,-17478.1015 1622.4866,-17477.8945 1614.0767,-17471.4505 1611.8938,-17478.1015"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-13990C1292.1829,-14023.5192 1333.0056,-13983.0629 1356.6204,-14014 1413.0011,-14087.8628 1334.6898,-17286.3463 1392.6204,-17359 1415.2009,-17387.3195 1450.5228,-17348.7389 1471.8691,-17378"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M778.5126,-11489.4098C787.7262,-11493.131 796.6984,-11498.6955 802.259,-11507 857.1973,-11589.0479 799.3043,-13193.2663 838.259,-13284 878.6484,-13378.0752 947.464,-13359.3694 1002.022,-13446 1028.0879,-13487.3891 1021.6647,-13503.903 1038.022,-13550 1087.6803,-13689.9441 1103.1372,-13723.8414 1152.1868,-13864 1168.7603,-13911.3587 1150.9341,-13937.388 1188.1868,-13971 1216.6751,-13996.7042 1252.9035,-13956.954 1272.4036,-13990"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M920.1405,-13156C939.7989,-13182.6096 1020.7459,-13228.9124 1065.3217,-13253.1604"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1063.7851,-13256.3084 1074.2464,-13257.9849 1067.1139,-13250.1505 1063.7851,-13256.3084"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge942" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1272.4036,-11901C1307.0094,-11916.5606 1319.6622,-11906.4096 1356.6204,-11915 1445.3377,-11935.621 1693.879,-11960.5951 1749.1377,-12033 1797.6543,-12096.5708 1759.2389,-13396.3405 1785.1377,-13472 1825.8893,-13591.0498 1908.6296,-13582.2461 1952.9868,-13700 2018.7183,-13874.4957 1946.2664,-13936.4942 1988.9868,-14118 2036.7246,-14320.8229 2118.8146,-14350.0157 2161.3169,-14554 2256.1104,-15008.9493 2102.6903,-15144.016 2197.3169,-15599 2270.6192,-15951.4527 2562.4634,-16828.4138 2791.6838,-17106 2841.1601,-17165.9158 3898.0427,-17879.0304 3972.2545,-17856"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge966" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M778.5309,-11489.3976C787.7452,-11493.1184 796.7132,-11498.6856 802.259,-11507 868.7634,-11606.7056 791.1737,-13553.7866 838.259,-13664 878.4805,-13758.1471 960.3333,-13732.4934 1002.022,-13826 1069.9668,-13978.3984 1011.9538,-14411.1903 1038.022,-14576 1092.2053,-14918.561 1230.8654,-15320.433 1264.8157,-15415.9073"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1261.6036,-15417.3198 1268.2635,-15425.5597 1268.1956,-15414.965 1261.6036,-15417.3198"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge981" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M920.1405,-11559C956.9191,-11562.2269 976.3741,-11546.4432 1002.022,-11573 1084.8984,-11658.8137 961.8992,-11747.1424 1038.022,-11839 1072.1444,-11880.1756 1107.0744,-11848.2833 1152.1868,-11877 1171.8124,-11889.4928 1169.7893,-11900.7604 1188.1868,-11915 1208.7111,-11930.8858 1367.9234,-12020.021 1392.6204,-12028 1468.556,-12052.5329 1695.7996,-12011.644 1749.1377,-12071 1799.2718,-12126.7905 1758.1222,-14701.0274 1785.1377,-14771 1805.4293,-14823.5571 1834.93,-14821.1784 1869.0623,-14866"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M778.508,-11489.4129C787.7214,-11493.1343 796.6947,-11498.698 802.259,-11507 854.8842,-11585.5165 795.2888,-13123.8109 838.259,-13208 859.0107,-13248.6576 900.3975,-13228.8432 920.1405,-13270"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-13270C944.9073,-13321.6297 981.9902,-13310.1906 1038.022,-13322 1177.5594,-13351.4093 1220.5484,-13326.6616 1356.6204,-13284 1386.6772,-13274.5765 1419.2502,-13259.3786 1442.0742,-13247.8409"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1443.9231,-13250.8261 1451.2233,-13243.1477 1440.7281,-13244.5978 1443.9231,-13250.8261"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M745.0906,-11470.8181C746.8642,-11375.7982 762.021,-10702.771 838.259,-10518 860.1686,-10464.8997 894.2677,-10469.2861 920.1405,-10418"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-10418C969.0489,-10321.0516 964.5251,-10283.9326 1038.022,-10204 1079.2793,-10159.13 1117.4761,-10178.1064 1152.1868,-10128 1192.4597,-10069.8642 1147.6584,-10030.958 1188.1868,-9973 1239.4239,-9899.7278 1286.4109,-9918.3596 1356.6204,-9863 1373.9022,-9849.3734 1373.8976,-9840.5674 1392.6204,-9829 1470.907,-9780.6325 1499.7382,-9786.8615 1587.1179,-9758 1622.7745,-9746.2227 1635.5573,-9752.6884 1668.1278,-9734"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M920.1405,-8100C956.631,-8052.3772 1102.629,-7995.8157 1152.1868,-7962 1168.9301,-7950.5752 1170.1087,-7943.1678 1188.1868,-7934 1257.6098,-7898.7938 1299.7418,-7939.14 1356.6204,-7886 1391.1369,-7853.7522 1357.8998,-7818.028 1392.6204,-7786 1446.2702,-7736.5107 1506.0738,-7800.4328 1551.1179,-7743 1601.909,-7678.2396 1574.9892,-6343.4035 1587.1179,-6262 1602.6013,-6158.0809 1643.4664,-6038.5873 1660.5022,-5991.5446"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.7894,-5992.7461 1663.9372,-5982.1523 1657.2153,-5990.3417 1663.7894,-5992.7461"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M920.1405,-10418C936.7629,-10383.9143 970.5854,-10415.2104 1002.022,-10394 1091.2465,-10333.7998 1092.8335,-10293.7901 1152.1868,-10204 1170.612,-10176.1261 1167.8685,-10164.5257 1188.1868,-10138 1251.159,-10055.7892 1284.4938,-10051.3094 1356.6204,-9977 1393.108,-9939.4081 1433.6306,-9893.3207 1455.5767,-9867.9716"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1458.3897,-9870.0692 1462.2745,-9860.2123 1453.0907,-9865.4952 1458.3897,-9870.0692"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M745.681,-11470.7713C751.324,-11389.4938 785.99,-10882.7842 802.259,-10470 830.6913,-9748.605 790.8294,-9566.3954 838.259,-8846 860.1718,-8513.1738 717.2713,-8364.7594 920.1405,-8100"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-8100C947.904,-8063.7666 967.3551,-8067.6964 1002.022,-8038 1045.7249,-8000.5631 1044.3632,-7975.1441 1095.1044,-7948"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-9544C936.7475,-9501.4809 970.8217,-9515.3198 1002.022,-9482 1084.9569,-9393.431 1110.0209,-9367.7748 1152.1868,-9254 1195.9417,-9135.9375 1152.9199,-9093.8697 1188.1868,-8973 1258.6457,-8731.5171 1414.4512,-8465.3469 1459.4661,-8391.1532"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1462.6222,-8392.7001 1464.8416,-8382.3403 1456.6462,-8389.0549 1462.6222,-8392.7001"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M745.7249,-11470.7729C751.6764,-11389.5068 788.1126,-10882.8624 802.259,-10470 813.7887,-10133.507 790.0984,-7773.2282 838.259,-7440 876.5735,-7174.8985 942.8454,-7121.2374 1002.022,-6860 1089.0005,-6476.03 1101.7604,-6377.4554 1152.1868,-5987 1158.115,-5941.0969 1158.141,-5607.2063 1188.1868,-5572 1190.2043,-5569.636 1192.4434,-5567.5165 1194.8552,-5565.6176"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.1227,-5568.3214 1203.6502,-5559.9762 1193.3432,-5562.4294 1197.1227,-5568.3214"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge905" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-11711C1315.4316,-11728.575 1319.3136,-11745.2783 1356.6204,-11773 1372.6736,-11784.9287 1374.5262,-11791.4794 1392.6204,-11800 1466.3528,-11834.7209 1697.1962,-11823.198 1749.1377,-11886 1802.3097,-11950.2898 1760.7078,-12556.2277 1785.1377,-12636 1827.178,-12773.2765 1897.4302,-12779.6154 1952.9868,-12912 1978.1813,-12972.0354 1963.4395,-12994.1139 1988.9868,-13054 2045.7313,-13187.0164 2119.7127,-13191.4994 2161.3169,-13330 2251.681,-13630.8228 2101.9478,-14443.7263 2197.3169,-14743 2234.5443,-14859.8215 2283.6665,-14869.6317 2351.1489,-14972 2439.7115,-15106.3462 2469.472,-15135.429 2547.7793,-15276 2565.9682,-15308.6512 2564.4285,-15320.0237 2583.7793,-15352 2649.4845,-15460.575 2692.9368,-15469.689 2755.6838,-15580 2776.577,-15616.7308 2769.9732,-15631.7463 2791.6838,-15668 2911.9713,-15868.8629 3034.8017,-15858.9379 3127.3396,-16074 3153.3553,-16134.4618 3119.2068,-16319.1662 3163.3396,-16368 3246.9217,-16460.4854 3363.4012,-16329.3012 3436.8809,-16430"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge917" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-11900C1694.6193,-11926.6138 1726.049,-11894.3857 1749.1377,-11924 1808.2155,-11999.7748 1750.3988,-12698.4165 1785.1377,-12788 1827.0936,-12896.1944 1904.5122,-12882.565 1952.9868,-12988 1994.0078,-13077.223 1942.7731,-13119.3527 1988.9868,-13206 2038.4565,-13298.7521 2118.4419,-13272.0211 2161.3169,-13368 2229.4502,-13520.5216 2127.6831,-14719.1575 2197.3169,-14871 2235.728,-14954.7586 2304.3984,-14930.594 2351.1489,-15010 2387.0301,-15070.9444 2355.1859,-15101.9124 2387.1489,-15165 2436.6661,-15262.7354 2496.0296,-15255.4281 2547.7793,-15352 2575.6919,-15404.0887 2556.7284,-15427.4586 2583.7793,-15480 2639.6229,-15588.466 2691.1865,-15590.4457 2755.6838,-15694 2775.6561,-15726.0666 2774.0429,-15737.594 2791.6838,-15771 2943.1331,-16057.7938 2974.3545,-16135.4242 3163.3396,-16399 3243.5721,-16510.8995 3274.2592,-16530.6278 3365.2148,-16634 3443.8626,-16723.3842 3437.2302,-16781.4429 3544.5469,-16833 3662.2451,-16889.5446 3819.6474,-16880.2954 3906.9541,-16868.8978"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3907.5488,-16872.3493 3916.9881,-16867.5378 3906.6086,-16865.4127 3907.5488,-16872.3493"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-11559C956.5763,-11564.9589 972.6057,-11550.6895 1002.022,-11573 1031.8014,-11595.5859 1011.9572,-11622.2125 1038.022,-11649 1099.6492,-11712.3361 1309.9447,-11797.789 1392.6204,-11829 1407.4078,-11834.5824 1656.9585,-11888.8162 1668.1278,-11900"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge575" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-11711C1374.6744,-11752.122 1684.2998,-11758.8575 1749.1377,-11848 1793.2511,-11908.6494 1757.6138,-12452.2377 1785.1377,-12522 1827.7269,-12629.9467 1905.7783,-12615.992 1952.9868,-12722 1999.7286,-12826.9599 1929.5803,-12879.6524 1988.9868,-12978 2037.7737,-13058.7668 2117.329,-13018.5224 2161.3169,-13102 2242.8681,-13256.7628 2114.1931,-14522.0761 2197.3169,-14676 2236.77,-14749.0571 2293.3022,-14722.4379 2351.1489,-14782 2463.2556,-14897.4311 2473.5808,-14943.2175 2547.7793,-15086 2567.4546,-15123.8619 2565.82,-15136.2946 2583.7793,-15175 2586.3887,-15180.6237 2787.7622,-15565.1983 2791.6838,-15570 2926.6712,-15735.2815 2974.4147,-15774.7682 3163.3396,-15874 3197.312,-15891.8438 3213.6911,-15877.7351 3246.2772,-15898"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-11635C1176.7397,-11661.1914 1193.035,-11678.5815 1272.4036,-11711"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge607" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M920.1405,-13270C936.0966,-13303.2938 975.8996,-13257.9098 1002.022,-13284 1068.7127,-13350.6085 981.7965,-13417.3492 1038.022,-13493 1071.8518,-13538.5177 1118.0639,-13504.7016 1152.1868,-13550 1204.9506,-13620.0446 1145.6211,-13667.329 1188.1868,-13744 1237.4209,-13832.6824 1300.5883,-13813.4484 1356.6204,-13898 1514.1959,-14135.7797 1552.1862,-14943.3705 1785.1377,-15108 1846.0594,-15151.054 1881.8806,-15130.5612 1952.9868,-15108 2061.0008,-15073.7285 2108.3774,-15061.1947 2161.3169,-14961 2220.2651,-14849.4332 2164.8007,-12811.921 2197.3169,-12690 2209.7142,-12643.5157 2240.9275,-12595.8435 2259.5593,-12570.1839"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2262.4341,-12572.183 2265.5734,-12562.0639 2256.809,-12568.0167 2262.4341,-12572.183"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge624" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M920.1405,-9468C928.3115,-9430.9679 977.6831,-9473.0819 1002.022,-9444 1049.6501,-9387.0903 1016.296,-9182.9587 1038.022,-9112 1069.8114,-9008.1734 1122.1064,-9000.3346 1152.1868,-8896 1181.6962,-8793.6459 1132.8352,-8509.013 1188.1868,-8418 1233.9028,-8342.8304 1305.4415,-8385.5622 1356.6204,-8314 1398.5164,-8255.4178 1347.6786,-8212.2797 1392.6204,-8156 1441.3692,-8094.9528 1505.7246,-8143.5818 1551.1179,-8080 1631.1986,-7967.8321 1495.3751,-7874.8485 1587.1179,-7772 1636.3526,-7716.8054 1691.3573,-7780.1728 1749.1377,-7734 1777.7099,-7711.1678 1759.8512,-7686.4249 1785.1377,-7660 1843.8061,-7598.6904 1907.6156,-7640.7099 1952.9868,-7569 1992.4324,-7506.6556 1973.6272,-6978.1586 1988.9868,-6906 2025.938,-6732.4059 2148.1906,-6284.9546 2274.2329,-6160"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge656" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M920.1405,-9544C937.1153,-9501.6263 965.9931,-9510.0284 1002.022,-9482 1069.4526,-9429.5427 1092.9583,-9423.5683 1152.1868,-9362 1276.9997,-9232.2563 1267.1395,-9165.0979 1392.6204,-9036 1454.9591,-8971.8643 1495.252,-8981.8463 1551.1179,-8912 1574.4635,-8882.8123 1571.0859,-8869.7626 1587.1179,-8836 1674.9513,-8651.0277 1642.1294,-8566.554 1785.1377,-8420 1843.5374,-8360.1524 1906.6197,-8404.587 1952.9868,-8335 2013.4055,-8244.3246 1915.3868,-7926.346 1988.9868,-7846 2015.1937,-7817.3911 2049.1192,-7860.7675 2075.1519,-7832"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge705" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2075.1519,-12964C2090.1328,-13020.7224 2139.2081,-13009.6579 2161.3169,-13064 2210.3164,-13184.438 2171.5834,-13520.5478 2197.3169,-13648 2247.8317,-13898.1879 2273.8201,-13961.303 2387.1489,-14190 2457.0845,-14331.1295 2651.2154,-14700.746 2791.6838,-14772 2936.2969,-14845.3564 3039.0637,-14765.02 3127.3396,-14629 3318.7698,-14334.0346 3282.6254,-14212.5391 3329.2148,-13864 3363.3694,-13608.4871 3362.9268,-9481.7754 3365.2148,-9224 3392.2997,-6172.6061 3433.2132,-2390.9252 3436.6493,-2074.3129"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3440.1505,-2074.2079 3436.7594,-2064.1704 3433.151,-2074.1318 3440.1505,-2074.2079"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-11635C1327.3839,-11638.8401 1714.486,-11729.1415 1749.1377,-11772 1822.2429,-11862.4192 1741.6271,-12186.1722 1785.1377,-12294 1828.5619,-12401.6135 1908.1756,-12386.9566 1952.9868,-12494 2018.3253,-12650.0782 1919.004,-12718.9483 1988.9868,-12873 2012.0238,-12923.7109 2060.8144,-12910.1786 2075.1519,-12964"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge799" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M920.1405,-11559C1057.8371,-11581.6197 932.4911,-11359.2976 1038.022,-11268 1057.777,-11250.9094 1074.2976,-11269.7934 1095.1044,-11254"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1095.1044,-11254C1251.0046,-11135.664 1293.0702,-11105.6191 1471.8691,-11026"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1471.8691,-11026C1588.1982,-10982.1398 1625.819,-10973.2309 1749.1377,-10989 1841.9933,-11000.8737 1884.9457,-10977.7072 1952.9868,-11042 1990.9906,-11077.9102 1946.7352,-11123.2002 1988.9868,-11154 2050.8791,-11199.117 2093.6707,-11189.9194 2161.3169,-11154 2319.5814,-11069.9632 2254.1749,-10940.1156 2387.1489,-10820 2525.1274,-10695.3638 2650.9405,-10775.6264 2755.6838,-10622 2793.6329,-10566.3404 2782.8058,-10387.778 2791.6838,-10321 2870.1193,-9731.0298 2895.3787,-9584.2852 2985.5867,-8996 3010.4224,-8834.0352 3042.4252,-8639.0439 3052.9432,-8575.2899"/>
<polygon fill="#003fff" stroke="#003fff" points="3056.4231,-8575.6977 3054.5992,-8565.2611 3049.5167,-8574.5573 3056.4231,-8575.6977"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge830" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M745.5614,-11470.9043C754.4714,-11322.775 851.1293,-9738.1782 920.1405,-9544"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M920.1405,-9544C935.4269,-9500.9884 979.3293,-9521.607 1002.022,-9482 1069.6593,-9363.9483 952.0832,-9283.4776 1038.022,-9178 1071.8004,-9136.5417 1119.7794,-9182.5387 1152.1868,-9140 1244.4273,-9018.9228 1090.0437,-8572.344 1188.1868,-8456 1237.6682,-8397.3421 1304.0795,-8473.9341 1356.6204,-8418 1425.656,-8344.5059 1324.0793,-8267.9556 1392.6204,-8194 1441.8611,-8140.8695 1503.0708,-8210.2123 1551.1179,-8156 1643.7018,-8051.5362 1504.4591,-7956.481 1587.1179,-7844 1633.7801,-7780.5027 1692.4629,-7826.747 1749.1377,-7772 1775.4431,-7746.5893 1756.4775,-7720.7216 1785.1377,-7698 1845.0746,-7650.4826 1903.7795,-7718.5574 1952.9868,-7660 2004.9465,-7598.1672 1935.1485,-6994.2042 1988.9868,-6934 2014.8493,-6905.0795 2052.6791,-6951.6266 2075.1519,-6920"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge875" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1668.1278,-10874C1890.3064,-10880.631 1985.0533,-11092.4195 2161.3169,-10957 2210.5589,-10919.1684 2161.9051,-10873.0098 2197.3169,-10822 2372.293,-10569.9515 2614.7478,-10688.5475 2755.6838,-10416 2815.9859,-10299.3855 2774.7536,-9365.1869 2791.6838,-9235 2831.6953,-8927.3274 2903.4156,-8861.8087 2949.5867,-8555 3040.4351,-7951.3082 3054.3967,-7200.0874 3056.2165,-7064.4772"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3059.7195,-7064.251 3056.3463,-7054.2075 3052.7201,-7064.1625 3059.7195,-7064.251"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-10418C1407.7021,-10199.2712 1533.7951,-10176.94 1749.1377,-9862 1776.7457,-9821.6231 1749.6766,-9791.6898 1785.1377,-9758 1975.0159,-9577.6066 2105.5529,-9684.9841 2351.1489,-9594 2380.7775,-9583.0237 2413.4291,-9567.8621 2436.5758,-9556.5661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2438.1435,-9559.6956 2445.569,-9552.1384 2435.0514,-9553.4155 2438.1435,-9559.6956"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M745.4246,-11470.7976C750.1865,-11374.2189 788.6709,-10682.158 920.1405,-10532"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-10532C950.21,-10497.6562 968.0145,-10500.4494 1002.022,-10470 1019.3541,-10454.4813 1017.9078,-10443.6899 1038.022,-10432 1060.6066,-10418.8743 1071.5614,-10429.3171 1095.1044,-10418"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M778.5536,-11489.7103C787.6526,-11493.437 796.5508,-11498.9289 802.259,-11507 828.776,-11544.4929 892.8532,-13119.0639 920.1405,-13156"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M920.1405,-13156C926.0373,-13163.9819 1086.1385,-13196.254 1095.1044,-13192"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M1095.1044,-13192C1199.2173,-13142.602 1131.8068,-13050.5036 1188.1868,-12950 1261.1358,-12819.9602 1270.4553,-12769.4846 1392.6204,-12684 1398.259,-12680.0544 1404.548,-12676.7111 1411.0491,-12673.8828"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1412.6497,-12677.0143 1420.6748,-12670.0971 1410.0877,-12670.5 1412.6497,-12677.0143"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge532" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2075.1519,-12964C2090.1025,-13020.7304 2140.2585,-13009.2423 2161.3169,-13064 2192.4538,-13144.9644 2149.3193,-14552.7437 2197.3169,-14625 2244.536,-14696.0843 2492.9793,-14716.5816 2547.7793,-14782 2590.1418,-14832.5709 2562.0203,-14863.722 2583.7793,-14926 2685.2554,-15216.4422 2669.1201,-15323.5226 2870.6353,-15556"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2870.6353,-15556C3038.1928,-15771.8313 3301.4741,-15215.4408 3329.2148,-15134 3423.6179,-14856.853 3435.7543,-12614.3023 3436.7974,-12370.4809"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3440.2988,-12370.1416 3436.8401,-12360.1273 3433.2988,-12370.1127 3440.2988,-12370.1416"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-9468C929.2139,-9431.1787 977.8437,-9473.2156 1002.022,-9444 1054.6916,-9380.3572 1022.2068,-9155.0825 1038.022,-9074 1072.1899,-8898.8255 1116.0213,-8863.773 1152.1868,-8689 1179.3092,-8557.9282 1131.8255,-8511.4037 1188.1868,-8390 1234.4584,-8290.3297 1296.0471,-8300.6849 1356.6204,-8209 1378.3363,-8176.1303 1368.3865,-8159.0599 1392.6204,-8128 1447.6388,-8057.4842 1507.1772,-8081.9019 1551.1179,-8004 1616.6594,-7887.8025 1506.4398,-7812.2477 1587.1179,-7706 1634.2418,-7643.941 1681.2547,-7677.2607 1749.1377,-7639 1847.1291,-7583.7694 1900.1985,-7588.3284 1952.9868,-7489 1999.2765,-7401.8997 1972.8158,-6699.3021 1988.9868,-6602 2011.0305,-6469.3615 2027.3215,-6437.6629 2075.1519,-6312"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-6312C2120.728,-6192.4046 2218.6821,-6071.2654 2257.7008,-6025.7829"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2260.3763,-6028.0398 2264.2746,-6018.1882 2255.0836,-6023.4585 2260.3763,-6028.0398"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M745.6123,-11470.7683C750.7719,-11389.4698 782.6645,-10882.6398 802.259,-10470 807.2167,-10365.5966 789.9476,-9622.6858 838.259,-9530 859.358,-9489.5216 910.3052,-9512.575 920.1405,-9468"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M778.2711,-11489.2498C787.5926,-11492.9693 796.6865,-11498.5729 802.259,-11507 865.5851,-11602.766 818.459,-15526.9103 838.259,-15640 876.1187,-15856.2385 940.5437,-15895.2564 1002.022,-16106 1052.896,-16280.3932 989.2111,-16356.3932 1095.1044,-16504"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1095.1044,-16504C1112.5161,-16530.565 1134.9052,-16520.3501 1152.1868,-16547 1191.1369,-16607.0652 1139.1896,-16651.806 1188.1868,-16704 1193.6915,-16709.8639 1200.5019,-16714.3728 1207.8466,-16717.836"/>
<polygon fill="#ffff00" stroke="#ffff00" points="1206.7945,-16721.1858 1217.3774,-16721.687 1209.4169,-16714.6955 1206.7945,-16721.1858"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-9392C925.2245,-9354.4195 978.7566,-9397.9476 1002.022,-9368 1071.5946,-9278.445 1001.2212,-8455.2667 1038.022,-8348 1066.1361,-8266.0531 1108.0879,-8264.5721 1152.1868,-8190 1171.2116,-8157.8287 1161.8998,-8140.5694 1188.1868,-8114 1246.7445,-8054.8129 1301.3777,-8094.2926 1356.6204,-8032 1389.0743,-7995.4044 1358.2414,-7962.7934 1392.6204,-7928 1445.2364,-7874.7497 1504.3526,-7929.4555 1551.1179,-7871 1631.9776,-7769.9273 1515.4465,-7689.7831 1587.1179,-7582 1633.092,-7512.8618 1695.2713,-7552.1832 1749.1377,-7489 1778.4311,-7454.64 1750.6427,-7423.1344 1785.1377,-7394 1843.2208,-7344.9432 1904.0487,-7419.1831 1952.9868,-7361 2011.6481,-7291.2569 1975.5483,-5811.1368 1988.9868,-5721 2030.7189,-5441.0882 2114.7986,-5387.1563 2161.3169,-5108 2208.1456,-4826.9809 2130.0532,-4744.8397 2197.3169,-4468 2211.394,-4410.0624 2244.4179,-4347.4328 2262.2717,-4316.1643"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2265.5044,-4317.5666 2267.4921,-4307.1599 2259.4485,-4314.0556 2265.5044,-4317.5666"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M745.6299,-11470.7691C750.9136,-11389.4764 783.5181,-10882.6794 802.259,-10470 804.917,-10411.4706 802.3409,-9462.2887 838.259,-9416 861.5074,-9386.0392 915.0067,-9429.5737 920.1405,-9392"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-9392C925.5142,-9354.4599 977.8437,-9397.2156 1002.022,-9368 1054.6916,-9304.3572 1025.593,-9079.6702 1038.022,-8998 1087.3338,-8673.9749 1029.6265,-8562.8493 1188.1868,-8276 1238.4341,-8185.0982 1292.4915,-8195.7032 1356.6204,-8114 1376.294,-8088.9349 1371.694,-8076.0291 1392.6204,-8052 1451.3593,-7984.5519 1506.5025,-8005.5175 1551.1179,-7928 1609.3106,-7826.8926 1520.2692,-7763.6051 1587.1179,-7668 1633.8339,-7601.1882 1682.6204,-7629.1345 1749.1377,-7582 1799.4175,-7546.3715 1927.5542,-7450.1306 1952.9868,-7394 2018.9492,-7248.4188 1956.7487,-6112.5428 1988.9868,-5956 2004.408,-5881.1176 2044.4491,-5798.8749 2064.0351,-5761.5072"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2067.3784,-5762.6742 2068.9795,-5752.201 2061.1967,-5759.3898 2067.3784,-5762.6742"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-8176C1117.6726,-8129.3087 1148.2302,-7995.0586 1188.1868,-7962 1247.314,-7913.0803 1299.8567,-7975.6434 1356.6204,-7924 1394.6699,-7889.3827 1354.4921,-7848.5305 1392.6204,-7814 1446.0917,-7765.5742 1503.3813,-7833.0875 1551.1179,-7779 1608.2714,-7714.2429 1533.9827,-7460.0929 1587.1179,-7392 1634.0789,-7331.8194 1701.8929,-7394.9581 1749.1377,-7335 1797.6662,-7273.4128 1754.7653,-7056.2877 1785.1377,-6984 1799.1863,-6950.5636 1828.1829,-6919.6812 1848.1247,-6901.0903"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1850.738,-6903.4449 1855.7888,-6894.1314 1846.0325,-6898.2624 1850.738,-6903.4449"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M745.6441,-11470.7698C751.0277,-11389.4815 784.2052,-10882.71 802.259,-10470 805.0962,-10405.1423 803.8284,-9357.0372 838.259,-9302 881.8594,-9232.305 958.2263,-9285.5724 1002.022,-9216 1060.543,-9123.0352 991.8106,-8327.6578 1038.022,-8228 1052.4589,-8196.8659 1080.2687,-8206.9461 1095.1044,-8176"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M745.7112,-11470.7724C751.5661,-11389.5029 787.4482,-10882.8391 802.259,-10470 804.6335,-10403.8128 808.9193,-8145.3764 838.259,-8086 968.2621,-7822.9057 1177.6198,-7909.5472 1356.6204,-7677 1381.1466,-7645.1369 1372.0413,-7628.5441 1392.6204,-7594 1410.9857,-7563.1719 1437.5956,-7531.1719 1454.816,-7511.6673"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1457.514,-7513.9008 1461.5699,-7504.1131 1452.2956,-7509.2352 1457.514,-7513.9008"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-11026C1675.4065,-10940.3666 1765.5708,-11033.2276 1952.9868,-11150 1973.8534,-11163.0012 1967.6669,-11179.7564 1988.9868,-11192 2070.6043,-11238.8715 2103.5808,-11221.5211 2197.3169,-11230 2265.4087,-11236.1593 2300.0405,-11275.4132 2351.1489,-11230 2402.0015,-11184.8141 2347.0593,-10980.9598 2387.1489,-10926 2436.1966,-10858.7595 2528.8041,-10825.7088 2594.6272,-10810.0623"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2595.5785,-10813.435 2604.5429,-10807.7879 2594.0135,-10806.6122 2595.5785,-10813.435"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1272.4036,-11635C1326.1931,-11637.4221 1338.88,-11623.3398 1392.6204,-11620 1462.9281,-11615.6306 1483.0636,-11601.8101 1551.1179,-11620 1649.2252,-11646.2227 1694.4895,-11648.4066 1749.1377,-11734 1798.1181,-11810.7161 1756.7483,-12055.5217 1785.1377,-12142 1829.9179,-12278.4073 1907.2393,-12281.9141 1952.9868,-12418 2002.956,-12566.6441 1923.3949,-12626.5581 1988.9868,-12769 2035.4455,-12869.8915 2115.6399,-12848.7522 2161.3169,-12950 2237.2685,-13118.3548 2156.4409,-13183.8857 2197.3169,-13364 2251.3302,-13602.0019 2418.4357,-14212.4901 2583.7793,-14392 2757.1592,-14580.2347 2932.5148,-14747.9403 3127.3396,-14582 3183.9313,-14533.7985 3234.496,-13980.7195 3244.4905,-13865.1059"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3247.9859,-13865.3087 3245.3528,-13855.0463 3241.0115,-13864.7108 3247.9859,-13865.3087"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M920.1405,-11559C956.5721,-11564.9847 967.7149,-11559.3582 1002.022,-11573 1048.2113,-11591.3666 1047.7737,-11619.8147 1095.1044,-11635"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1095.1044,-11635C1170.1369,-11659.0729 1193.7954,-11629.5096 1272.4036,-11635"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge429" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1272.4036,-11254C1396.189,-11244.7433 1428.7284,-11251.2798 1551.1179,-11272 1750.6614,-11305.7821 1791.9272,-11350.8875 1988.9868,-11397 2080.5534,-11418.4268 2104.0069,-11422.3042 2197.3169,-11434 2281.259,-11444.5216 2302.6242,-11444.4569 2387.1489,-11448 2550.8009,-11454.86 2620.4618,-11542.434 2755.6838,-11450 2988.0165,-11291.1839 2783.384,-11055.7425 2985.5867,-10860 2989.3,-10856.4053 2993.561,-10853.3245 2998.1113,-10850.6846"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2999.7935,-10853.7563 3007.1504,-10846.1322 2996.6448,-10847.5044 2999.7935,-10853.7563"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge483" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-11254C1482.6716,-11227.1679 1542.5187,-11192.6587 1749.1377,-11240 1864.559,-11266.4458 1878.3939,-11313.6837 1988.9868,-11356 2078.9788,-11390.4337 2102.0548,-11401.5302 2197.3169,-11416 2280.7484,-11428.6728 2302.7651,-11419.1111 2387.1489,-11420 2551.035,-11421.7265 2641.4191,-11524.4955 2755.6838,-11407 2836.3727,-11324.0296 2721.7019,-10458.1808 2791.6838,-10366 2794.0393,-10362.8974 2796.7805,-10360.1715 2799.7994,-10357.7773"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.9061,-10360.5818 2808.3652,-10352.1836 2798.0786,-10354.7208 2801.9061,-10360.5818"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge497" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2274.2329,-10417C2313.4345,-10375.9483 2385.2294,-10389.1628 2429.4072,-10402.8427"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2428.3388,-10406.1756 2438.9308,-10405.9312 2430.4982,-10399.517 2428.3388,-10406.1756"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-11444C1595.2598,-11452.6182 1647.9223,-11396.9016 1749.1377,-11468 1780.3807,-11489.9466 1764.1939,-11514.0761 1785.1377,-11546 1846.5808,-11639.6556 1909.4867,-11630.78 1952.9868,-11734 1998.1428,-11841.1491 1915.5124,-12165.8806 1988.9868,-12256 2039.227,-12317.6217 2109.0958,-12244.0477 2161.3169,-12304 2239.964,-12394.2907 2154.8251,-12459.0526 2197.3169,-12571 2240.8269,-12685.63 2287.2031,-12695.3861 2351.1489,-12800 2368.3721,-12828.1768 2361.8958,-12843.7198 2387.1489,-12865 2394.1976,-12870.9398 2402.5841,-12875.6476 2411.2368,-12879.3712"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2410.0909,-12882.6808 2420.6797,-12883.0371 2412.6242,-12876.1553 2410.0909,-12882.6808"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-11559C985.8137,-11564.6506 976.3921,-11492.3806 1038.022,-11469 1084.7519,-11451.272 1389.9183,-11433.6569 1471.8691,-11444"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-13270C940.1572,-13311.0244 975.2038,-13295.0614 1002.022,-13332 1030.7588,-13371.5814 1009.236,-13396.4543 1038.022,-13436 1075.4074,-13487.3596 1117.0601,-13469.0699 1152.1868,-13522 1188.4266,-13576.6075 1151.6567,-13610.5862 1188.1868,-13665 1275.475,-13795.0213 1355.2882,-13769.4359 1471.8691,-13874"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-11444C1537.2847,-11447.3261 1703.5186,-11496.9982 1749.1377,-11544 1784.9646,-11580.9128 1764.745,-11606.7743 1785.1377,-11654 1846.9401,-11797.1228 1906.3967,-11813.2282 1952.9868,-11962 1997.3427,-12103.6376 1946.3246,-12151.8431 1988.9868,-12294 2047.1702,-12487.8758 2097.8423,-12522.7107 2197.3169,-12699 2207.3712,-12716.8183 2567.4347,-13313.694 2583.7793,-13326 2615.4648,-13349.8563 2633.1096,-13365.2291 2669.7316,-13350"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-13350C2707.1289,-13336.7889 2730.5714,-13356.6995 2755.6838,-13326 2825.3748,-13240.8042 2718.9575,-12914.6199 2791.6838,-12832 2800.9621,-12821.4596 2815.1073,-12816.726 2828.8746,-12814.8657"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2829.5867,-12818.3167 2839.2419,-12813.9547 2828.9738,-12811.3436 2829.5867,-12818.3167"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-11558C1699.5817,-11578.5122 1725.3687,-11552.9289 1749.1377,-11582 1806.7505,-11652.4643 1756.7483,-11903.5217 1785.1377,-11990 1829.9179,-12126.4073 1908.2066,-12129.5927 1952.9868,-12266 2009.7655,-12438.9565 1909.4549,-12510.2549 1988.9868,-12674 2034.9135,-12768.5566 2098.5425,-12751.6817 2161.3169,-12836 2182.6819,-12864.6974 2181.0087,-12876.1559 2197.3169,-12908 2365.9079,-13237.1984 2350.7502,-13357.7859 2583.7793,-13645 2687.9746,-13773.4233 2712.8081,-13832.6058 2870.6353,-13882"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-13270C939.8835,-13311.1568 972.232,-13297.4135 1002.022,-13332 1023.8279,-13357.3169 1013.2289,-13375.6003 1038.022,-13398 1058.443,-13416.4498 1070.7657,-13409.1531 1095.1044,-13422"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-13422C1119.443,-13434.8469 1134.7024,-13424.7465 1152.1868,-13446 1202.3576,-13506.9863 1134.7556,-13561.8489 1188.1868,-13620 1195.0748,-13627.4965 1204.0964,-13632.7833 1213.6707,-13636.5031"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.7772,-13639.8943 1223.3706,-13639.7244 1214.9834,-13633.251 1212.7772,-13639.8943"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1272.4036,-11254C1327.0155,-11246.3501 1704.6094,-11359.4698 1749.1377,-11392 1886.6408,-11492.453 2105.4804,-11877.1268 2161.3169,-12038 2183.044,-12100.5991 2155.2006,-12282.844 2197.3169,-12334 2201.1475,-12338.6527 2205.8557,-12342.4481 2211.0397,-12345.5427"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.6352,-12348.754 2220.1421,-12350.1169 2212.7784,-12342.4993 2209.6352,-12348.754"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge459" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-11254C1323.084,-11245.9212 1322.5692,-11213.3965 1356.6204,-11175 1374.5506,-11154.7817 1368.5097,-11138.2044 1392.6204,-11126 1455.4706,-11094.1863 1481.3463,-11116.2952 1551.1179,-11126 1735.0034,-11151.5772 1807.9201,-11124.1392 1952.9868,-11240 1979.0951,-11260.852 1962.1611,-11286.0795 1988.9868,-11306 2076.1966,-11370.7609 2365.5866,-11443.6897 2467.4641,-11406"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-11254C1157.8704,-11206.3575 1194.2378,-11263.9747 1272.4036,-11254"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-11406C2510.5314,-11387.2193 2563.546,-11382.8392 2604.4943,-11382.9581"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2604.5904,-11386.4595 2614.6315,-11383.0793 2604.6741,-11379.46 2604.5904,-11386.4595"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge586" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-10418C1159.6683,-10372.8238 1194.3659,-10407.0684 1272.4036,-10418"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge693" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3056.4631,-14568C3181.1163,-14472.1641 3119.0094,-14021.0145 3127.3396,-13864 3164.7199,-13159.424 3149.798,-8219.4369 3163.3396,-7514 3183.4063,-6468.6454 3237.6389,-5181.5688 3245.3582,-5001.3333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3248.8663,-5001.2175 3245.7985,-4991.0765 3241.8727,-5000.9172 3248.8663,-5001.2175"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-11559C1084.1617,-11585.9441 1530.2169,-11465.2124 1668.1278,-11558"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-11558C1704.7382,-11587.4852 1725.4929,-11585.3721 1749.1377,-11626 1793.6876,-11702.5483 1743.9798,-11743.5757 1785.1377,-11822 1834.1858,-11915.4585 1909.0623,-11894.0268 1952.9868,-11990 2043.677,-12188.1542 1904.4005,-12278.1644 1988.9868,-12479 2033.8804,-12585.5921 2112.2405,-12569.2679 2161.3169,-12674 2205.9648,-12769.2815 2164.7047,-12807.9578 2197.3169,-12908 2229.5009,-13006.7285 2974.1393,-14631.2923 3056.4631,-14568"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge665" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-8176C1160.9893,-8041.0387 1256.3407,-8073.8006 1356.6204,-7962 1377.8962,-7938.2798 1369.7657,-7922.203 1392.6204,-7900 1450.105,-7844.1545 1505.4936,-7879.891 1551.1179,-7814 1617.5282,-7718.0898 1533.821,-7657.7715 1587.1179,-7554 1600.9787,-7527.0126 1758.8769,-7381.1926 1785.1377,-7366 1792.2479,-7361.8865 1800.0953,-7358.3958 1808.0519,-7355.4482"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1809.4448,-7358.6707 1817.7692,-7352.1167 1807.1746,-7352.049 1809.4448,-7358.6707"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge769" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-10874C1791.8067,-10846.2362 1843.9888,-10795.2952 1952.9868,-10860 1981.7188,-10877.0563 1960.2548,-10908.9437 1988.9868,-10926 2054.8475,-10965.0971 2104.3143,-10977.1557 2161.3169,-10926 2216.5475,-10876.4345 2145.5848,-10647.2067 2197.3169,-10594 2306.9118,-10481.281 2411.5529,-10624.4793 2547.7793,-10546 2678.0996,-10470.9232 2704.6507,-10420.4762 2755.6838,-10279 2799.7784,-10156.7593 2780.8301,-9239.4964 2791.6838,-9110 2809.8953,-8892.7192 2853.7298,-8631.9283 2866.858,-8556.4303"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2870.3547,-8556.7526 2868.6295,-8546.2992 2863.4593,-8555.5469 2870.3547,-8556.7526"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-10874C1420.7591,-10779.5357 1492.3644,-10880.3336 1668.1278,-10874"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge786" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-12091C1519.4161,-12097.6603 1574.0808,-12096.9886 1613.6225,-12095.0385"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1614.0471,-12098.5209 1623.8449,-12094.4894 1613.6716,-12091.5309 1614.0471,-12098.5209"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M778.3698,-11492.2165C786.8358,-11495.9148 795.4478,-11500.7653 802.259,-11507 826.906,-11529.5604 819.5595,-11545.3094 838.259,-11573 902.3618,-11667.9247 946.162,-11672.0024 1002.022,-11772 1026.0809,-11815.0691 1006.026,-11839.4495 1038.022,-11877 1177.4652,-12040.6509 1258.9455,-12061.174 1471.8691,-12091"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge736" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-10532C995.7444,-10445.649 1864.419,-10445.0057 1952.9868,-10518 2017.6271,-10571.2741 1924.3466,-10649.7259 1988.9868,-10703 2048.0915,-10751.7119 2105.9021,-10755.8716 2161.3169,-10703 2222.964,-10644.1821 2141.2073,-10001.1218 2197.3169,-9937 2220.1984,-9910.8512 2258.4158,-9953.9377 2274.2329,-9923"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge747" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-11559C1070.4696,-11574.7159 982.1546,-11380.4445 1038.022,-11240 1100.8889,-11081.9594 1054.4643,-10993.1066 1188.1868,-10888 1218.0181,-10864.5524 1236.1064,-10885.055 1272.4036,-10874"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1272.4036,-10874C1401.3031,-10782.82 1830.8848,-10569.9003 1952.9868,-10670 2016.0794,-10721.7235 1925.8942,-10798.2765 1988.9868,-10850 2048.218,-10898.5579 2104.597,-10901.469 2161.3169,-10850 2222.4944,-10794.486 2158.3827,-10552.8603 2197.3169,-10480 2218.1428,-10441.0271 2243.7155,-10448.9577 2274.2329,-10417"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M770.3219,-11493.052C780.2856,-11497.3908 791.8126,-11502.4195 802.259,-11507 854.702,-11529.9948 863.6351,-11549.7177 920.1405,-11559"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2274.2329,-10417C2392.6922,-10293.4509 2570.4517,-10186.8093 2640.1743,-10147.3165"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2642.2788,-10150.1485 2649.278,-10142.1948 2638.8465,-10144.0477 2642.2788,-10150.1485"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge839" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-9544C935.6605,-9501.0722 978.5666,-9521.1601 1002.022,-9482 1054.7362,-9393.9906 982.6591,-9340.3678 1038.022,-9254 1070.9167,-9202.6832 1121.8256,-9230.8553 1152.1868,-9178 1219.3816,-9061.0215 1121.9161,-8689.5045 1188.1868,-8572 1232.8383,-8492.8284 1301.6846,-8528.4152 1356.6204,-8456 1386.4368,-8416.6966 1366.3422,-8392.7521 1392.6204,-8351 1396.3217,-8345.1191 1744.4593,-8005.1378 1749.1377,-8000 1845.6626,-7893.9957 1897.4613,-7882.1775 1952.9868,-7750 2008.7588,-7617.236 1929.5008,-7559.1419 1988.9868,-7428 1992.5307,-7420.1872 2190.8977,-7205.6916 2197.3169,-7200 2279.9407,-7126.7409 2390.1901,-7055.0441 2440.4472,-7023.5979"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2442.4732,-7026.4595 2449.113,-7018.2033 2438.7738,-7020.5169 2442.4732,-7026.4595"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1030" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M629.4812,-18186.9712C637.7297,-18190.5483 645.5723,-18195.4056 651.5354,-18202 695.2038,-18250.2916 668.5878,-18281.7103 687.5354,-18344 745.6165,-18534.9398 748.3718,-18588.8099 838.259,-18767 856.1709,-18802.5081 1014.8592,-19031.6713 1038.022,-19064 1102.1414,-19153.4924 1120.1298,-19174.4642 1188.1868,-19261 1277.3413,-19374.3618 1300.9783,-19401.6395 1392.6204,-19513 1478.3359,-19617.1588 1493.1677,-19649.2034 1587.1179,-19746 1703.7606,-19866.1766 1703.721,-19969.3506 1869.0623,-19996"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-20110C2455.328,-20084.129 2487.2848,-20009.3386 2669.7316,-19996"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-19996C1999.7313,-20019.5916 2035.2886,-20016.1928 2161.3169,-20058 2213.7576,-20075.3961 2219.0007,-20111.4324 2274.2329,-20110"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M626.4114,-18188.1419C635.278,-18191.66 644.142,-18196.1971 651.5354,-18202 872.2279,-18375.2169 862.4991,-18483.6019 1002.022,-18727 1011.514,-18743.5588 1145.2303,-19018.2264 1152.1868,-19036 1172.326,-19087.4553 1160.9153,-19106.9427 1188.1868,-19155 1243.067,-19251.7088 1281.9918,-19257.5682 1356.6204,-19340 1547.665,-19551.0207 1528.9169,-19691.9892 1785.1377,-19816 2403.76,-20115.4131 2646.5765,-19811.6658 3329.2148,-19732 3483.7632,-19713.9638 3540.9272,-19741.4518 3670.96,-19656 3963.4368,-19463.7971 4049.9372,-19382.6114 4185.6079,-19060 4236.0251,-18940.1128 4283.9127,-17969.1945 4291.3902,-17811.5826"/>
<polygon fill="#ffff00" stroke="#ffff00" points="4294.8999,-17811.4578 4291.8751,-17801.3039 4287.9077,-17811.1279 4294.8999,-17811.4578"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M629.506,-18168.3714C638.0681,-18164.6946 646.026,-18159.4574 651.5354,-18152 698.6039,-18088.2888 661.6161,-17514.8516 687.5354,-17440 716.4041,-17356.6309 762.5533,-17356.7862 802.259,-17278 930.2674,-17023.9992 930.0334,-16945.1731 1002.022,-16670 1004.9704,-16658.7297 1073.2371,-16309.0844 1090.9414,-16218.3424"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1094.4048,-16218.8678 1092.8844,-16208.3826 1087.5344,-16217.5274 1094.4048,-16218.8678"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M744.8972,-18102C772.5217,-18102.7849 781.6166,-18107.6256 802.259,-18126 826.6362,-18147.6989 812.8285,-18169.5458 838.259,-18190 845.7375,-18196.0151 854.6526,-18200.5863 863.8039,-18204.0593"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="862.7814,-18207.4082 873.3756,-18207.2955 865.0235,-18200.7769 862.7814,-18207.4082"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-17644C793.1707,-17599.5191 1207.7437,-17366.6871 1272.4036,-17378"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M629.5949,-18168.0207C638.0421,-18164.3663 645.9321,-18159.227 651.5354,-18152 702.1538,-18086.7139 667.4605,-17862.1342 687.5354,-17782 703.6761,-17717.5702 697.9549,-17690.991 744.8972,-17644"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge943" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M920.1405,-18176C954.9703,-18189.5114 976.8335,-18167.41 1002.022,-18195 1080.9736,-18281.4791 985.8693,-18351.1568 1038.022,-18456 1069.9577,-18520.2009 1108.7067,-18512.9813 1152.1868,-18570 1184.9684,-18612.9889 1355.9038,-18953.3191 1392.6204,-18993 1394.65,-18995.1935 1747.6328,-19231.4182 1749.1377,-19234 1800.1039,-19321.4358 1710.7999,-19619.3235 1785.1377,-19688 1839.9328,-19738.6221 1879.8003,-19702.4511 1952.9868,-19688 2343.0198,-19610.9856 3266.9517,-19212.7219 3607.7534,-19008"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge952" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M584.0893,-18165.6865C592.2832,-18094.1931 636.6802,-17697.6756 651.5354,-17373 655.2593,-17291.6114 642.6841,-11575.0172 687.5354,-11507 691.1852,-11501.465 696.355,-11497.1482 702.1126,-11493.7834"/>
<polygon fill="#9900ff" stroke="#9900ff" points="704.0298,-11496.7442 711.5101,-11489.2411 700.9835,-11490.4418 704.0298,-11496.7442"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge967" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M593.6824,-18165.7577C609.8374,-18148.2587 639.5179,-18112.6876 651.5354,-18076 721.8613,-17861.3052 654.0751,-17283.4279 687.5354,-17060 716.7032,-16865.2347 753.9782,-16822.9274 802.259,-16632 896.3373,-16259.9656 913.41,-16165.3741 1002.022,-15792 1018.053,-15724.4518 998.3644,-15696.9827 1038.022,-15640 1072.8414,-15589.9692 1115.3687,-15612.5788 1152.1868,-15564 1183.5133,-15522.6669 1149.2801,-15487.2936 1188.1868,-15453 1189.694,-15451.6715 1191.2764,-15450.4386 1192.922,-15449.2949"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1194.6974,-15452.3115 1201.6196,-15444.2907 1191.2064,-15446.2441 1194.6974,-15452.3115"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge983" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M744.8972,-17796C915.7963,-17647.1358 1602.036,-17790.4185 1749.1377,-17618 1786.6798,-17573.9968 1779.2213,-15593.5386 1785.1377,-15536 1805.5902,-15337.0945 1769.2364,-15267.2527 1869.0623,-15094"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M607.0529,-18165.8807C621.9399,-18157.887 640.2485,-18145.7478 651.5354,-18130 741.3271,-18004.7204 623.8573,-17891.4299 744.8972,-17796"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1546.5409,-18338.0054 1397.1974,-18338.0054 1397.1974,-18315.9946 1546.5409,-18315.9946 1546.5409,-18338.0054"/>
<text text-anchor="middle" x="1471.8691" y="-18323.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-18176C955.5586,-18187.884 965.8335,-18185.7231 1002.022,-18195 1157.7878,-18234.9304 1340.8269,-18288.203 1425.0928,-18313.0897"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1424.289,-18316.5017 1434.871,-18315.9811 1426.274,-18309.7891 1424.289,-18316.5017"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M584.094,-18165.6867C592.3161,-18094.1946 636.8558,-17697.6836 651.5354,-17373 687.2722,-16582.5751 618.0644,-11040.1766 687.5354,-10252 696.1877,-10153.836 772.6731,-9451.5495 838.259,-9378 888.7377,-9321.3921 955.6251,-9389.999 1002.022,-9330 1041.7352,-9278.6441 1033.0364,-8226.728 1038.022,-8162 1069.7995,-7749.4326 1122.3088,-7650.7093 1152.1868,-7238 1155.5291,-7191.8322 1159.2968,-5608.1663 1188.1868,-5572 1190.3028,-5569.351 1192.6975,-5567.0054 1195.3054,-5564.9303"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1197.218,-5567.8616 1203.7037,-5559.484 1193.4092,-5561.9885 1197.218,-5567.8616"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge907" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-18556C1803.2655,-18773.1451 2041.5752,-19022.6734 2547.7793,-18753 3093.7207,-18462.1571 3131.5564,-18236.4282 3508.5469,-17746 3588.1658,-17642.4235 3624.3897,-17623.0593 3670.96,-17501 3710.8199,-17396.5285 3687.9232,-17362.1849 3706.96,-17252 3734.4232,-17093.0427 3775.5903,-16902.9367 3789.3934,-16840.216"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3792.8377,-16840.8497 3791.5749,-16830.3304 3786.0021,-16839.3412 3792.8377,-16840.8497"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge919" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.1044,-18442C1137.2617,-18498.3079 1134.0125,-18525.1339 1188.1868,-18570 1400.5468,-18745.8723 1593.6394,-18607.2982 1749.1377,-18835 1814.7111,-18931.0215 1700.1371,-19277.6596 1785.1377,-19357 1839.6721,-19407.9029 1882.6357,-19381.8158 1952.9868,-19357 2513.2792,-19159.3614 3634.9232,-18045.6686 3881.228,-17505 3907.8841,-17446.4868 3958.7283,-16984.0791 3970.0033,-16879.1338"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3973.4906,-16879.4385 3971.0751,-16869.1227 3966.5304,-16878.6932 3973.4906,-16879.4385"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge577" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-18556C1321.6012,-18575.641 1696.6253,-18557.9733 1749.1377,-18551 2023.1303,-18514.6156 2127.4607,-18557.3556 2351.1489,-18395 2506.5295,-18282.2229 2473.8745,-18188.4254 2583.7793,-18031 2740.4097,-17806.6459 3181.799,-17281.5134 3329.2148,-17051 3384.2367,-16964.9627 3386.818,-16937.0142 3436.8809,-16848"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-18176C954.9703,-18189.5114 974.565,-18169.6666 1002.022,-18195 1040.7611,-18230.7429 1019.6729,-18258.5876 1038.022,-18308 1060.5571,-18368.685 1056.3073,-18390.1803 1095.1044,-18442"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-18442C1109.1411,-18460.7483 1250.7262,-18547.133 1272.4036,-18556"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge878" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M920.1405,-18176C954.9801,-18189.4861 969.6054,-18176.4303 1002.022,-18195 1022.2088,-18206.5639 1021.3253,-18216.7995 1038.022,-18233 1138.1896,-18330.191 1146.4397,-18381.8937 1272.4036,-18442"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1272.4036,-18442C1410.7024,-18507.4318 1850.2253,-18451.3488 1952.9868,-18338 2042.1061,-18239.699 2600.7404,-16346.4611 2755.6838,-15221 2776.1943,-15072.0187 2751.1174,-14012.8119 2791.6838,-13868 2829.8054,-13731.9156 2912.7926,-13728.4493 2949.5867,-13592 2986.1674,-13456.342 2981.7502,-8674.4512 2985.5867,-8534 3001.9853,-7933.6634 3046.7765,-7198.3858 3055.1166,-7064.4487"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.621,-7064.4871 3055.7514,-7054.2883 3051.6346,-7064.0506 3058.621,-7064.4871"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-18102C829.4083,-18104.4013 840.018,-18149.0134 920.1405,-18176"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-18176C1005.8948,-18204.8834 964.1158,-18062.2105 1038.022,-18010 1105.109,-17962.6068 1698.6303,-17872.7749 1749.1377,-17808 1829.7958,-17704.5573 1701.7098,-16729.2221 1785.1377,-16628 1833.7851,-16568.9766 1902.7229,-16647.6531 1952.9868,-16590 2014.2549,-16519.7251 1941.3617,-16252.151 1988.9868,-16172 2035.897,-16093.0522 2117.3787,-16138.6397 2161.3169,-16058 2203.1846,-15981.1603 2140.8713,-12974.8666 2197.3169,-12908 2219.7302,-12881.4488 2272.1569,-12928.6845 2274.2329,-12894"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M601.1351,-18165.9461C636.8326,-18144.8817 714.7511,-18101.1434 744.8972,-18102"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge533" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1272.4036,-18442C1630.3319,-18624.6127 1870.9206,-18554.7232 2161.3169,-18277 2267.3306,-18175.6128 2277.2424,-18133.7126 2351.1489,-18007 2472.6081,-17798.7583 2465.1136,-17726.8461 2583.7793,-17517 2641.0901,-17415.6527 3069.4818,-16712.8949 3163.3396,-16644 3194.2738,-16621.2932 3222.9862,-16650.4967 3246.2772,-16620"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M629.4015,-18168.2935C637.9706,-18164.6219 645.9579,-18159.4066 651.5354,-18152 721.4819,-18059.1157 650.7041,-17740.288 687.5354,-17630 755.5468,-17426.3461 1174.3946,-16860.1034 1257.9213,-16748.3122"/>
<polygon fill="#ffff00" stroke="#ffff00" points="1260.768,-16750.3498 1263.956,-16740.2459 1255.163,-16746.1564 1260.768,-16750.3498"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-18024C1361.0462,-17891.1758 1557.4665,-18111.2212 1749.1377,-17884 1811.2334,-17810.3872 1763.8339,-17111.9194 1785.1377,-17018 1827.0621,-16833.1735 1884.112,-16802.5637 1952.9868,-16626 1970.4576,-16581.2129 1964.8809,-16565.5934 1988.9868,-16524 2018.4046,-16473.2412 2058.2464,-16480.1789 2075.1519,-16424"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-18176C996.5848,-18201.7477 969.3463,-18080.3123 1038.022,-18038 1060.2616,-18024.2978 1071.2019,-18034.5368 1095.1044,-18024"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M593.7307,-18165.7733C609.9487,-18148.2948 639.7106,-18112.7501 651.5354,-18076 700.6944,-17923.2197 609.8424,-16772.4358 687.5354,-16632 717.1429,-16578.4823 772.2992,-16609.3212 802.259,-16556 853.6759,-16464.4905 773.746,-15694.7994 838.259,-15612 884.8748,-15552.1709 952.1101,-15621.1083 1002.022,-15564 1294.3072,-15229.5719 1106.9877,-15017.8482 1152.1868,-14576 1182.895,-14275.8088 1132.0295,-14194.4863 1188.1868,-13898 1205.0597,-13808.918 1245.4071,-13708.0601 1263.4353,-13665.5837"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1266.689,-13666.8768 1267.4138,-13656.3068 1260.2556,-13664.1178 1266.689,-13666.8768"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge587" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-17644C824.1626,-17564.6524 1673.5178,-17624.8293 1749.1377,-17542 1814.6919,-17470.196 1739.1886,-14127.6845 1785.1377,-14042 1827.7557,-13962.5272 1910.3054,-14007.4387 1952.9868,-13928 1992.8255,-13853.8521 1972.5511,-10980.5524 1988.9868,-10898 2003.9791,-10822.6974 2044.5403,-10740.1209 2064.1892,-10703.0112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2067.2786,-10704.656 2068.9226,-10694.1895 2061.1104,-10701.3464 2067.2786,-10704.656"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge771" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-18140C1137.3803,-18138.2016 1146.459,-18152.9803 1188.1868,-18160 1347.6313,-18186.8227 1390.5746,-18204.1801 1551.1179,-18185 1641.036,-18174.2575 1691.0024,-18206.4331 1749.1377,-18137 1833.1789,-18036.6265 1731.0359,-17668.209 1785.1377,-17549 1828.4981,-17453.4587 1891.165,-17467.7722 1952.9868,-17383 1973.8337,-17354.414 1970.9627,-17342.4448 1988.9868,-17312 2058.1099,-17195.243 2119.1659,-17188.9709 2161.3169,-17060 2200.2032,-16941.0183 2182.286,-16058.2693 2197.3169,-15934 2246.1966,-15529.8837 2281.8803,-15431.2146 2387.1489,-15038 2446.8535,-14814.9827 2493.1205,-14768.3073 2547.7793,-14544 2571.0284,-14448.5907 2564.6446,-14422.3188 2583.7793,-14326 2649.4862,-13995.2499 2715.3863,-13921.7972 2755.6838,-13587 2799.0522,-13226.6897 2781.6689,-10683.7727 2791.6838,-10321 2811.718,-9595.2964 2861.0538,-8704.7123 2869.4203,-8556.3962"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2872.9191,-8556.5134 2869.9895,-8546.3317 2865.9303,-8556.1181 2872.9191,-8556.5134"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge737" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-18024C1216.1975,-17970.6194 1260.3104,-18033.3328 1392.6204,-18036 1463.0494,-18037.4198 1480.9908,-18042.6679 1551.1179,-18036 1640.3302,-18027.5175 1690.262,-18065.5606 1749.1377,-17998 1799.2836,-17940.4569 1762.0229,-17384.7429 1785.1377,-17312 1827.472,-17178.7731 1892.622,-17172.086 1952.9868,-17046 2076.3343,-16788.3596 2112.3896,-16719.4237 2161.3169,-16438 2258.0847,-15881.4037 2109.2083,-14454.0326 2197.3169,-13896 2233.5115,-13666.7627 2301.1758,-13623.633 2351.1489,-13397 2376.7429,-13280.9287 2338.7122,-13240.5426 2387.1489,-13132 2432.0728,-13031.3295 2509.4013,-13046.3433 2547.7793,-12943 2573.6626,-12873.302 2582.2102,-7664.3323 2583.7793,-7590 2604.82,-6593.2629 2660.5905,-5366.6365 2668.7338,-5190.4586"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.2338,-5190.5381 2669.2004,-5180.3868 2665.2413,-5190.214 2672.2338,-5190.5381"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge749" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-18176C938.6498,-18183.1648 1075.3704,-18142.1217 1095.1044,-18140"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-18140C1385.5881,-18108.769 1547.2588,-18285.1897 1749.1377,-18074 1798.9659,-18021.8737 1749.6306,-17488.7634 1785.1377,-17426 1829.5413,-17347.5109 1904.6739,-17388.1451 1952.9868,-17312 2007.9483,-17225.3762 1926.4109,-17165.2939 1988.9868,-17084 2040.0465,-17017.6671 2115.1662,-17077.8373 2161.3169,-17008 2205.5489,-16941.0662 2173.0626,-14196.4744 2197.3169,-14120 2233.828,-14004.8797 2310.4818,-14009.7186 2351.1489,-13896 2414.5336,-13718.7559 2337.962,-13655.6968 2387.1489,-13474 2430.6097,-13313.4553 2509.9503,-13297.9642 2547.7793,-13136 2607.4015,-12880.7287 2564.4592,-11038.4287 2583.7793,-10777 2602.0567,-10529.6799 2652.047,-10232.2943 2666.0451,-10151.8871"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2669.4975,-10152.4629 2667.7744,-10142.0091 2662.6023,-10151.2557 2669.4975,-10152.4629"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge841" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-17796C788.7981,-17761.3878 1710.2475,-17772.1603 1749.1377,-17732 1793.2951,-17686.4005 1766.5484,-16650.693 1785.1377,-16590 1826.0763,-16456.3377 1905.3508,-16455.4245 1952.9868,-16324 1994.2406,-16210.1838 1942.4956,-16165.7791 1988.9868,-16054 2037.224,-15938.0229 2120.1416,-15948.6681 2161.3169,-15830 2215.0447,-15675.1553 2158.8254,-13039.3172 2197.3169,-12880 2233.3448,-12730.8797 2315.4886,-12720.2086 2351.1489,-12571 2415.0486,-12303.6337 2368.3434,-7897.2522 2387.1489,-7623 2403.2173,-7388.6656 2450.0743,-7107.2121 2463.7042,-7028.4125"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2467.2,-7028.7385 2465.4665,-7018.2865 2460.3037,-7027.5383 2467.2,-7028.7385"/>
</g>
<!-- sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1031" class="edge">
<title>sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M4124.4445,-19084C4152.3943,-19075.5418 4161.9214,-19077.0788 4185.6079,-19060 4245.7036,-19016.6688 4220.5414,-18950.0405 4292.3998,-18932"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-16576C1484.4687,-16615.9544 1565.1234,-16899.3441 1587.1179,-16935 1640.0862,-17020.8685 1706.9411,-17002.3567 1749.1377,-17094 1798.2322,-17200.6243 1751.238,-17508.6175 1785.1377,-17621 1941.2676,-18138.5937 1950.9289,-18358.6383 2387.1489,-18678 2798.4014,-18979.0827 3013.1151,-18798.3056 3508.5469,-18918 3542.9934,-18926.3221 4090.526,-19094.2645 4124.4445,-19084"/>
</g>
<!-- sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge944" class="edge">
<title>sourcefile~solarreflectionmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1471.8691,-16576C1548.2555,-16810.2263 1674.9408,-16821.0709 1749.1377,-17056 1803.9609,-17229.5863 1728.1063,-17291.1266 1785.1377,-17464 1839.5033,-17628.7928 1877.5154,-17664.0097 1988.9868,-17797 2248.6245,-18106.7592 2283.1246,-18282.1123 2669.7316,-18400"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M2669.7316,-18400C2931.1637,-18428.4185 3018.2256,-18402.0542 3246.2772,-18533"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3246.2772,-18533C3280.4664,-18550.7004 3298.9683,-18534.1809 3329.2148,-18558 3403.6532,-18616.6201 3353.2562,-18786.5455 3436.8809,-18742"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1297.6407,-15448.1793C1317.5613,-15458.4997 1344.024,-15475.8853 1356.6204,-15500 1410.7708,-15603.6665 1321.3312,-16459.2807 1392.6204,-16552 1415.052,-16581.1748 1460.8012,-16540.9024 1471.8691,-16576"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3436.8809,-18742C3764.1599,-18567.6639 3438.2246,-18092.2192 3794.094,-17988"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-14762.0054 -.2403,-14762.0054 -.2403,-14739.9946 130.719,-14739.9946 130.719,-14762.0054"/>
<text text-anchor="middle" x="65.2394" y="-14747.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1032" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-20110C2162.8117,-20097.9772 2186.0007,-20116.6239 2274.2329,-20110"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-18636C230.7643,-18660.1013 344.0776,-18500.8161 383.9048,-18443.7746"/>
<polygon fill="#ff0000" stroke="#ff0000" points="387,-18445.4545 389.8421,-18435.2479 381.2554,-18441.4544 387,-18445.4545"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.3368,-14762.1792C67.0366,-14953.4638 91.3333,-17544.802 166.4788,-18301 181.416,-18451.3154 182.1325,-18490.8164 223.8406,-18636"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#ff3200" stroke-dasharray="5,2" d="M744.8972,-1182C875.3872,-1137.8926 1274.836,-1171.1649 1356.6204,-1282 1440.6708,-1395.9062 1305.0874,-1806.7476 1392.6204,-1918 1438.1325,-1975.8448 1494.6073,-1918.8414 1551.1179,-1966 1699.1554,-2089.5385 1694.738,-2167.0202 1749.1377,-2352 1772.1956,-2430.4056 1731.753,-2656.1196 1785.1377,-2718 1788.6053,-2722.0194 1792.715,-2725.3292 1797.2236,-2728.0488"/>
<polygon fill="#ff3200" stroke="#ff3200" points="1795.8101,-2731.2549 1806.3214,-2732.5825 1798.9322,-2724.9897 1795.8101,-2731.2549"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M223.8406,-4108C269.6575,-3982.0525 374.1028,-4608.2544 394.2255,-4732.7837"/>
<polygon fill="#ff6600" stroke="#ff6600" points="390.8156,-4733.6243 395.8592,-4742.9416 397.7268,-4732.5127 390.8156,-4733.6243"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M223.8406,-15417C246.0851,-15457.3869 303.0679,-15456.9034 345.7596,-15449.8225"/>
<polygon fill="#ff9900" stroke="#ff9900" points="346.514,-15453.2428 355.7264,-15448.0099 345.2615,-15446.3557 346.514,-15453.2428"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M223.8406,-15417C403.1452,-15742.5438 239.588,-14949.4624 317.2024,-14586 335.9455,-14498.2274 372.9368,-14397.5997 389.3901,-14354.9006"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="392.747,-14355.9249 393.107,-14345.3361 386.2224,-14353.3892 392.747,-14355.9249"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1471.8691,-154C1615.3985,-118.4715 1641.6415,-77.6624 1785.1377,-42 1911.5326,-10.5877 1944.912,0 2075.1519,0 2075.1519,0 2075.1519,0 2467.4641,0 2765.5521,0 2837.19,-51.6654 3127.3396,-120 3212.2448,-139.9964 3800.0884,-306.9826 3881.228,-339 3948.9176,-365.71 3978.879,-358.6627 4027.281,-413 4162.4638,-564.7596 4149.237,-642.0437 4185.6079,-842 4268.0975,-1295.503 4291.4303,-17107.6941 4292.3699,-17768.6796"/>
<polygon fill="#ffff00" stroke="#ffff00" points="4288.8699,-17768.7867 4292.3842,-17778.7817 4295.8699,-17768.7767 4288.8699,-17768.7867"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.8406,-4108C343.0713,-3764.3954 277.3873,-2835.5175 317.2024,-2474 376.4633,-1935.9165 138.6974,-1662.0936 514.0276,-1272 535.6489,-1249.5282 551.9506,-1262.682 582.7815,-1258"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M744.8972,-646C984.2975,-337.9491 1089.781,-232.8445 1471.8691,-154"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M582.7815,-1258C779.8122,-1057.1161 568.3165,-865.0768 744.8972,-646"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M65.2749,-14739.8537C66.5035,-14359.4988 99.9417,-4370.246 223.8406,-4108"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#99ff00" stroke-dasharray="5,2" d="M65.7375,-14762.0869C74.9868,-14967.9489 210.0889,-17974.9279 222.8716,-18259.4327"/>
<polygon fill="#99ff00" stroke="#99ff00" points="219.3865,-18259.8468 223.332,-18269.6796 226.3795,-18259.5325 219.3865,-18259.8468"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M582.7815,-1258C634.2049,-1250.4281 640.2571,-1227.5979 687.5354,-1206 712.6723,-1194.5168 718.9264,-1191.4469 744.8972,-1182"/>
<path fill="none" stroke="#65ff00" stroke-dasharray="5,2" d="M744.8972,-1182C789.5322,-1165.7639 792.2878,-1141.9389 838.259,-1130 1062.9379,-1071.6501 1170.1756,-1055.7117 1356.6204,-1194 1664.1872,-1422.126 1629.7131,-1597.1641 1749.1377,-1961 1838.7999,-2234.1624 1863.1145,-2587.1614 1868.0129,-2676.6555"/>
<polygon fill="#65ff00" stroke="#65ff00" points="1864.5299,-2677.0731 1868.549,-2686.876 1871.5203,-2676.7064 1864.5299,-2677.0731"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M920.1405,-19354C975.6341,-19300.1326 983.5878,-19280.9379 1038.022,-19226 1192.4605,-19070.1324 1389.3777,-18892.6498 1451.8918,-18836.7878"/>
<polygon fill="#33ff00" stroke="#33ff00" points="1454.3533,-18839.2821 1459.4832,-18830.012 1449.6921,-18834.0598 1454.3533,-18839.2821"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M582.7815,-19620C675.9254,-19640.9439 851.2005,-19420.0432 920.1405,-19354"/>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M397.615,-19545C468.9841,-19597.8226 495.8829,-19601.7677 582.7815,-19620"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-15417C446.1875,-15855.8638 150.6796,-14776.936 317.2024,-14314 359.6689,-14195.9425 431.3302,-14198.4489 478.0276,-14082 516.2112,-13986.782 491.0349,-13953.9789 514.0276,-13854 514.9549,-13849.9676 684.6455,-13286.9612 687.5354,-13284 725.0503,-13245.5595 769.0369,-13288.2058 802.259,-13246 892.8118,-13130.9605 916.6704,-12015.1069 919.7711,-11846.3385"/>
<polygon fill="#00ff00" stroke="#00ff00" points="923.2725,-11846.29 919.9525,-11836.2288 916.2736,-11846.1643 923.2725,-11846.29"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ff32" stroke-dasharray="5,2" d="M582.7815,-1258C731.9614,-1238.7268 1073.7883,-1495.6264 1152.1868,-1624 1195.2432,-1694.5027 1177.5403,-1912.0784 1188.1868,-1994 1213.3287,-2187.4607 1255.4719,-2419.7329 1268.4678,-2489.919"/>
<polygon fill="#00ff32" stroke="#00ff32" points="1265.0285,-2490.5686 1270.2962,-2499.761 1271.9107,-2489.2899 1265.0285,-2490.5686"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadaylighting.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M397.615,-19545C475.4833,-19602.6328 507.6473,-19491.1545 582.7815,-19430"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M223.8406,-18636C337.4093,-19031.3266 67.0027,-19300.3034 397.615,-19545"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M582.7815,-19430C971.6783,-19113.4625 977.2815,-18925.9413 1152.1868,-18456 1274.195,-18128.1841 1292.144,-18039.7907 1356.6204,-17696 1370.2997,-17623.0614 1345.5769,-17421.394 1392.6204,-17364 1397.4617,-17358.0934 1403.6896,-17353.5606 1410.5235,-17350.086"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1412.3248,-17353.1225 1420.1448,-17345.9742 1409.5739,-17346.6856 1412.3248,-17353.1225"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M397.615,-18636C427.6766,-18614.9078 454.1339,-18644.8867 478.0276,-18617 544.7415,-18539.1371 459.7119,-18243.9666 514.0276,-18157 551.601,-18096.84 615.0066,-18136.8 651.5354,-18076 698.8459,-17997.2544 657.7783,-17336.9119 687.5354,-17250 716.1137,-17166.5309 771.9195,-17170.8452 802.259,-17088 834.3203,-17000.4533 775.1401,-16738.6174 838.259,-16670 863.2539,-16642.8277 905.9851,-16690.0984 920.1405,-16656"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M397.615,-18636C427.6353,-18614.849 446.2849,-18635.4657 478.0276,-18617 628.5851,-18529.4164 592.4161,-18414.1899 744.8972,-18330"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M744.8972,-18862C862.7612,-18879.5618 902.501,-18872.4569 1002.022,-18938 1056.077,-18973.5999 1033.3684,-19030.5585 1095.1044,-19050"/>
<path fill="none" stroke="#00cbff" stroke-dasharray="5,2" d="M1095.1044,-19050C1110.5439,-19053.7578 1311.4494,-19009.3277 1413.3851,-18986.3139"/>
<polygon fill="#00cbff" stroke="#00cbff" points="1414.2465,-18989.7076 1423.2286,-18984.0887 1412.703,-18982.8799 1414.2465,-18989.7076"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datatimings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datatimings.f90</title>
<path fill="none" stroke="#0099ff" stroke-dasharray="5,2" d="M920.1405,-19354C966.9449,-19310.8472 1101.9012,-19225.0407 1152.1868,-19186 1245.5275,-19113.5322 1280.6631,-19106.5238 1356.6204,-19016 1377.3495,-18991.2957 1366.8207,-18972.3489 1392.6204,-18953 1421.5967,-18931.2687 1438.3986,-18920.1581 1471.8691,-18934"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataviewfactorinformation.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataviewfactorinformation.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M223.8406,-18636C271.4322,-18801.6638 206.8206,-19273.6168 317.2024,-19406 319.8648,-19409.1931 322.928,-19411.9853 326.2701,-19414.4263"/>
<polygon fill="#0066ff" stroke="#0066ff" points="324.7222,-19417.5817 335.0825,-19419.7986 328.3659,-19411.6048 324.7222,-19417.5817"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#0033ff" stroke-dasharray="5,2" d="M744.8972,-4108C771.8335,-4106.506 801.1346,-4106.0469 827.9305,-4106.0851"/>
<polygon fill="#0033ff" stroke="#0033ff" points="828.0545,-4109.5855 838.0675,-4106.123 828.0807,-4102.5856 828.0545,-4109.5855"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-19430C766.9171,-19330.7088 863.9825,-19373.1934 1002.022,-19216 1033.4669,-19180.1918 1005.6594,-19149.9811 1038.022,-19115 1075.7613,-19074.2071 1116.408,-19106.5229 1152.1868,-19064 1194.1044,-19014.1811 1166.0269,-18983.2205 1188.1868,-18922 1247.2157,-18758.9222 1306.8325,-18736.1324 1356.6204,-18570 1390.489,-18456.987 1370.689,-18422.9225 1392.6204,-18307 1460.8012,-17946.6162 1322.2615,-17758.7246 1587.1179,-17505 1590.683,-17501.5848 1594.7548,-17498.7989 1599.1326,-17496.5348"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1600.6333,-17499.7004 1608.484,-17492.5858 1597.9101,-17493.2518 1600.6333,-17499.7004"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M397.615,-16771C496.003,-16782.9601 457.7601,-16660.0179 478.0276,-16563 516.0979,-16380.7621 454.9962,-15902.5653 514.0276,-15726 548.2314,-15623.6949 607.9672,-15624.6815 651.5354,-15526 658.9776,-15509.1434 799.8019,-14898.2618 802.259,-14880 816.1969,-14776.4125 782.4951,-14028.4026 838.259,-13940 882.1193,-13870.4683 957.2644,-13922.9575 1002.022,-13854 1069.9137,-13749.4001 966.4725,-13396.1327 1038.022,-13294 1040.2315,-13290.8461 1042.93,-13288.0859 1045.939,-13285.6709"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1048.0641,-13288.4628 1054.506,-13280.0514 1044.2247,-13282.6097 1048.0641,-13288.4628"/>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M223.8406,-15417C361.6638,-15687.2409 96.475,-16734.3932 397.615,-16771"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge945" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1272.4036,-20110C1619.0199,-20194.5397 1720.8185,-20151.6862 2075.1519,-20110"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M2075.1519,-20110C2377.4256,-20055.0402 3070.5465,-19693.773 3329.2148,-19528 3415.5112,-19472.6952 3434.7113,-19454.0913 3508.5469,-19383 3696.1077,-19202.4104 3749.4671,-19155.5678 3881.228,-18931 3967.1499,-18784.5583 3984.0435,-18742.1897 4027.281,-18578 4105.4578,-18281.1326 4121.1495,-17904.4048 4123.9086,-17811.4487"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4127.4107,-17811.4181 4124.1899,-17801.3247 4120.4134,-17811.2236 4127.4107,-17811.4181"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge953" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M65.9612,-14762.2332C70.5949,-14828.3841 100.0212,-15172.6079 223.8406,-15417"/>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M223.8406,-15417C361.0512,-15687.8235 257.7473,-14351.72 317.2024,-14054 360.9331,-13835.0195 430.7521,-13796.2427 478.0276,-13578 575.9579,-13125.914 414.9004,-11880.6873 687.5354,-11507 691.3591,-11501.7591 696.5203,-11497.6029 702.1869,-11494.3106"/>
<polygon fill="#9900ff" stroke="#9900ff" points="703.9389,-11497.3501 711.3882,-11489.8162 700.8666,-11491.0603 703.9389,-11497.3501"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge963" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M223.8406,-15417C325.7597,-15602.0435 280.9547,-17107.8781 317.2024,-17316 377.3516,-17661.3564 535.7071,-18061.8583 574.2393,-18156.3108"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="571.0253,-18157.6981 578.0561,-18165.6239 577.5024,-18155.0435 571.0253,-18157.6981"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge968" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M223.8406,-15417C227.1307,-15423.4512 739.0539,-15393.7224 744.8972,-15398"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-13831.0054 180.0456,-13831.0054 180.0456,-13808.9946 267.6355,-13808.9946 267.6355,-13831.0054"/>
<text text-anchor="middle" x="223.8406" y="-13816.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge975" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M67.131,-14739.8959C83.2966,-14645.0029 198.1495,-13970.8087 220.1885,-13841.4379"/>
<polygon fill="#ff0098" stroke="#ff0098" points="223.696,-13841.6898 221.9251,-13831.244 216.7954,-13840.5141 223.696,-13841.6898"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge987" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M223.8406,-15417C315.6799,-15597.8367 191.8966,-17080.517 317.2024,-17240 363.2874,-17298.6547 422.4478,-17238.2498 478.0276,-17288 508.5964,-17315.3625 484.9674,-17344.0402 514.0276,-17373 624.7156,-17483.3056 686.5663,-17471.4704 838.259,-17509 1162.5965,-17589.2428 1253.3243,-17560.3192 1587.1179,-17575 1659.0572,-17578.164 1697.7723,-17625.4665 1749.1377,-17575 1789.5457,-17535.2991 1779.3332,-15592.3495 1785.1377,-15536 1805.6264,-15337.0983 1769.1884,-15267.225 1869.0623,-15094"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge999" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M223.8406,-6353C291.5974,-6183.0715 444.8659,-6956.0918 478.0276,-7136 555.7028,-7557.4019 579.5884,-8988.2785 582.4728,-9180.565"/>
<polygon fill="#ff0033" stroke="#ff0033" points="578.9763,-9180.8323 582.6236,-9190.7795 585.9755,-9180.7289 578.9763,-9180.8323"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1322.5565,-5603.0054 1222.2506,-5603.0054 1222.2506,-5580.9946 1322.5565,-5580.9946 1322.5565,-5603.0054"/>
<text text-anchor="middle" x="1272.4036" y="-5588.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4069C951.4803,-4089.3343 978.2902,-4059.1474 1002.022,-4088 1039.558,-4133.6356 1026.7877,-5092.9884 1038.022,-5151 1066.2541,-5296.7849 1102.9376,-5324.9114 1152.1868,-5465 1168.6881,-5511.9379 1151.5756,-5537.309 1188.1868,-5571 1195.0268,-5577.2945 1203.4604,-5581.7748 1212.3225,-5584.9497"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1211.4661,-5588.3475 1222.0518,-5587.9067 1213.5017,-5581.65 1211.4661,-5588.3475"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-16771C486.7071,-16781.8301 453.9835,-16869.2961 514.0276,-16936 582.6167,-17012.1967 591.5765,-17051.9126 687.5354,-17088 977.2304,-17196.946 1277.9451,-16887.4728 1356.6204,-16749 1399.9166,-16672.7962 1382.6971,-13681.081 1392.6204,-13594 1407.6439,-13462.1611 1449.8996,-13307.7857 1465.7557,-13252.7634"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1469.1285,-13253.6993 1468.5591,-13243.1198 1462.4067,-13251.7453 1469.1285,-13253.6993"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1095.1044,-4373C1108.7073,-4395.3005 1134.2142,-4368.0438 1152.1868,-4387 1211.3207,-4449.3702 1140.9763,-4505.1805 1188.1868,-4577 1237.8399,-4652.5354 1313.6286,-4611.4843 1356.6204,-4691 1417.9544,-4804.4408 1363.8809,-6886.2832 1392.6204,-7012 1429.9554,-7175.3168 1511.6909,-7191.1756 1551.1179,-7354 1642.6132,-7731.8541 1485.1382,-7852.8397 1587.1179,-8228 1627.2783,-8375.7411 1702.9942,-8386.0169 1749.1377,-8532 1778.9197,-8626.2207 1853.3573,-9350.2055 1866.923,-9483.8313"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1863.4611,-9484.3843 1867.9514,-9493.9805 1870.4254,-9483.6786 1863.4611,-9484.3843"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="640.4745,-3737.0054 525.0885,-3737.0054 525.0885,-3714.9946 640.4745,-3714.9946 640.4745,-3737.0054"/>
<text text-anchor="middle" x="582.7815" y="-3722.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-3765C420.2707,-3726.1044 471.7173,-3717.6722 514.6461,-3718.2362"/>
<polygon fill="#ff0000" stroke="#ff0000" points="514.6888,-3721.7389 524.7873,-3718.5342 514.8945,-3714.7419 514.6888,-3721.7389"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M744.8972,-4031C924.9299,-4011.1431 992.3227,-3931.8556 1152.1868,-4017 1295.8951,-4093.5398 1304.1601,-4166.8625 1356.6204,-4321 1396.8702,-4439.2613 1341.7642,-4767.8973 1392.6204,-4882 1433.627,-4974.0039 1509.0137,-4952.4932 1551.1179,-5044 1589.1635,-5126.686 1576.0932,-5361.6512 1587.1179,-5452 1610.8142,-5646.1947 1651.6827,-5879.3751 1664.3035,-5949.8363"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1660.8655,-5950.4939 1666.0795,-5959.7169 1667.7551,-5949.2554 1660.8655,-5950.4939"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8406,-4108C274.8471,-3962.5185 393.2642,-4049.1029 744.8972,-4031"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="437.9065,-5793.0054 357.3234,-5793.0054 357.3234,-5770.9946 437.9065,-5770.9946 437.9065,-5793.0054"/>
<text text-anchor="middle" x="397.615" y="-5778.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M65.3388,-14739.8312C68.3476,-14403.1371 139.2805,-6565.0696 223.8406,-6353"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-6353C308.8645,-6139.767 198.3934,-6041.4225 317.2024,-5845 329.1613,-5825.2288 349.776,-5809.264 367.1383,-5798.3523"/>
<polygon fill="#00ffff" stroke="#00ffff" points="369.0888,-5801.2637 375.8582,-5793.1134 365.4838,-5795.2633 369.0888,-5801.2637"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4069C951.5,-4089.304 977.2592,-4060.0273 1002.022,-4088 1051.9437,-4144.3929 999.9431,-4360.0204 1038.022,-4425 1069.4769,-4478.6761 1121.9232,-4451.6432 1152.1868,-4506 1214.6812,-4618.247 1169.2101,-4955.9377 1188.1868,-5083 1212.0114,-5242.5227 1251.4191,-5276.0789 1272.4036,-5436"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-5436C1274.835,-5454.8152 1344.2371,-5435.6272 1356.6204,-5450 1436.7712,-5543.0281 1338.3582,-7549.8456 1392.6204,-7660 1402.6075,-7680.2742 1422.5557,-7696.0759 1439.9387,-7706.7831"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.328,-7709.8955 1448.7287,-7711.9145 1441.8572,-7703.8502 1438.328,-7709.8955"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1272.4036,-5436C1279.7445,-5491.9447 1336.175,-5478.4102 1356.6204,-5531 1401.155,-5645.5528 1383.9135,-7620.4036 1392.6204,-7743 1409.6123,-7982.2548 1455.2376,-8270.0424 1468.3188,-8349.6839"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1464.9222,-8350.5976 1470.0054,-8359.8934 1471.8286,-8349.4566 1464.9222,-8350.5976"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-18558C561.3801,-18421.6 1183.0078,-18693.623 1356.6204,-18570 1396.4645,-18541.6285 1372.4209,-18510.5475 1392.6204,-18466 1412.6454,-18421.8371 1442.209,-18373.2718 1458.9917,-18346.8423"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1462.1091,-18348.4644 1464.5552,-18338.1558 1456.2145,-18344.689 1462.1091,-18348.4644"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-4069C951.4993,-4089.3051 978.2746,-4059.1603 1002.022,-4088 1074.8141,-4176.4015 967.6148,-5027.6874 1038.022,-5118 1070.4957,-5159.6546 1117.9749,-5110.7608 1152.1868,-5151 1195.5365,-5201.9869 1161.6681,-5388.5539 1188.1868,-5450 1202.5783,-5483.3465 1231.6044,-5514.2507 1251.5195,-5532.8711"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1249.421,-5535.6941 1259.1701,-5539.8422 1254.1357,-5530.5199 1249.421,-5535.6941"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1141.0643,-4537.0054 1049.1444,-4537.0054 1049.1444,-4514.9946 1141.0643,-4514.9946 1141.0643,-4537.0054"/>
<text text-anchor="middle" x="1095.1044" y="-4522.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4069C951.4678,-4089.3535 977.5327,-4059.7875 1002.022,-4088 1062.4121,-4157.5715 984.3085,-4426.1534 1038.022,-4501 1040.2672,-4504.1286 1042.9916,-4506.8705 1046.0185,-4509.2727"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1044.326,-4512.3473 1054.616,-4514.8706 1048.1455,-4506.4811 1044.326,-4512.3473"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="473.6048,-16554.0054 321.6252,-16554.0054 321.6252,-16531.9946 473.6048,-16531.9946 473.6048,-16554.0054"/>
<text text-anchor="middle" x="397.615" y="-16539.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-15417C342.3028,-15632.0789 163.3821,-16326.6063 317.2024,-16518 319.8068,-16521.2406 322.8249,-16524.0697 326.1326,-16526.5388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="324.5373,-16529.6679 334.8804,-16531.964 328.2267,-16523.7191 324.5373,-16529.6679"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge909" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-570C1145.125,-555.6763 1144.1545,-526.7197 1188.1868,-499 1223.7524,-476.6103 1235.4745,-476.0614 1272.4036,-456"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-646C845.1282,-522.2225 941.9878,-613.8457 1095.1044,-570"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-456C1334.7395,-422.1364 1326.2019,-375.9219 1392.6204,-351 1458.5737,-326.2527 1480.7748,-347.2441 1551.1179,-351 1707.753,-359.3633 2836.6616,-435.1312 2949.5867,-544 2982.6917,-575.9159 2955.4377,-606.2782 2985.5867,-641 3014.0513,-673.782 3294.6782,-800.6919 3329.2148,-827 3503.6871,-959.9033 3588.301,-979.8465 3670.96,-1183 3751.0371,-1379.808 3792.2887,-16158.3209 3794.036,-16797.6403"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3790.5364,-16797.8218 3794.0638,-16807.8122 3797.5364,-16797.8026 3790.5364,-16797.8218"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge920" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3794.094,-894C3808.7227,-931.9551 3857.1719,-889.1993 3881.228,-922 3945.2773,-1009.3318 3971.1421,-16187.2698 3972.2193,-16836.5571"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3968.7197,-16836.8742 3972.2363,-16846.8684 3975.7197,-16836.8625 3968.7197,-16836.8742"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-154C1680.3293,-104.0397 1740.06,-163.225 1952.9868,-188 2217.8158,-218.814 2283.8053,-228.5624 2547.7793,-266 2640.2772,-279.1183 2665.6365,-272.1117 2755.6838,-297 2845.5405,-321.8356 2863.8058,-340.4943 2949.5867,-377 3215.2792,-490.0707 3276.1474,-531.5141 3544.5469,-638 3599.9806,-659.993 3628.0644,-641.5686 3670.96,-683 3702.2444,-713.2165 3686.0171,-735.8798 3706.96,-774 3738.6964,-831.7665 3770.3903,-832.4996 3794.094,-894"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge578" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-20110C1326.9572,-20130.3164 1336.1814,-20072.2653 1392.6204,-20058 1511.7843,-20027.8806 1545.2163,-20034 1668.1278,-20034 1668.1278,-20034 1668.1278,-20034 1869.0623,-20034 2332.1268,-20034 2933.5399,-18793.5597 3127.3396,-18373 3310.1717,-17976.2408 3417.9806,-17894.3677 3508.5469,-17467 3565.2192,-17199.5722 3604.606,-12717.2337 3607.5734,-12370.2547"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.0749,-12370.0738 3607.6603,-12360.0443 3604.0752,-12370.0141 3611.0749,-12370.0738"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-19810C1082.2349,-19864.4505 1041.4186,-19998.2585 1188.1868,-20086 1221.5923,-20105.9707 1236.1156,-20095.9308 1272.4036,-20110"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge611" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M582.7815,-19620C653.2976,-19634.7951 673.3783,-19628.7438 744.8972,-19620"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M744.8972,-19620C895.9864,-19601.5281 1741.4798,-19263.2012 1749.1377,-19254 1759.1297,-19241.9942 1950.7184,-18163.4543 1952.9868,-18148 1968.4078,-18042.9375 2154.9547,-16353.9974 2161.3169,-16248 2183.7393,-15874.4287 2152.4502,-13251.5444 2197.3169,-12880 2211.6293,-12761.4778 2251.7991,-12623.4658 2267.6662,-12571.8649"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2271.0432,-12572.7916 2270.6652,-12562.2035 2264.3579,-12570.7164 2271.0432,-12572.7916"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge628" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M744.8972,-2891C826.6654,-2868.1719 838.4485,-2943.901 920.1405,-2967"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M920.1405,-2967C1109.6213,-3020.5771 1195.0053,-2930.5098 1356.6204,-3043 1380.905,-3059.903 1376.0711,-3074.4729 1392.6204,-3099 1460.8336,-3200.0967 1501.0055,-3211.814 1551.1179,-3323 1579.8222,-3386.6872 1537.7039,-3426.6213 1587.1179,-3476 1639.4362,-3528.2809 1698.9613,-3459.6601 1749.1377,-3514 1821.4156,-3592.2753 1738.8694,-3655.0294 1785.1377,-3751 1832.7822,-3849.8252 1906.3616,-3832.6899 1952.9868,-3932 2005.3724,-4043.5797 1958.1721,-4087.6487 1988.9868,-4207 2052.1553,-4451.6632 2101.7158,-4502.0966 2197.3169,-4736 2263.6104,-4898.1976 2309.0606,-4928.9075 2351.1489,-5099 2396.7889,-5283.4454 2363.5145,-5336.4674 2387.1489,-5525 2409.593,-5704.0373 2450.1835,-5918.2946 2463.2737,-5985.6586"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2459.9099,-5986.6953 2465.2606,-5995.8397 2466.7803,-5985.3545 2459.9099,-5986.6953"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge658" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M397.615,-3765C439.0362,-3693.8878 502.4543,-3782.8943 582.7815,-3765"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M582.7815,-3765C613.7256,-3758.1066 623.8021,-3761.3597 651.5354,-3746 670.5229,-3735.484 667.3068,-3720.8686 687.5354,-3713 740.3617,-3692.4514 887.3518,-3704.732 1152.1868,-3735 1243.6984,-3745.4589 1293.957,-3701.4939 1356.6204,-3769 1416.8868,-3833.9239 1355.6929,-4085.4797 1392.6204,-4166 1440.0849,-4269.4963 1696.9578,-4432.7991 1749.1377,-4534 1789.5262,-4612.3319 1741.0519,-4652.6878 1785.1377,-4729 1834.1612,-4813.8593 1908.8585,-4784.4951 1952.9868,-4872 2005.2435,-4975.6231 1926.5575,-5295.1681 1988.9868,-5393 2036.0335,-5466.726 2113.3353,-5414.879 2161.3169,-5488 2254.3883,-5629.835 2115.4764,-5719.4012 2197.3169,-5868 2239.0168,-5943.7151 2311.7332,-5910.071 2351.1489,-5987 2403.8733,-6089.904 2377.6638,-6911.7649 2387.1489,-7027 2406.4174,-7261.093 2451.0296,-7542.7158 2463.9181,-7621.5714"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2460.5079,-7622.4043 2465.5827,-7631.7047 2467.4154,-7621.2696 2460.5079,-7622.4043"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge709" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1272.4036,-456C1576.6155,-306.1084 2493.8914,-599.4144 2755.6838,-815 2910.7891,-942.7289 3253.8531,-1327.7397 3329.2148,-1514 3402.6403,-1695.4746 3297.7524,-1769.2252 3365.2148,-1953 3376.8841,-1984.7884 3401.5856,-2015.5565 3418.7024,-2034.3764"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3416.3538,-2036.9896 3425.7362,-2041.9111 3421.4707,-2032.2129 3416.3538,-2036.9896"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge803" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M223.8406,-4108C237.7303,-4068.2294 475.4851,-4334.997 514.0276,-4352 712.683,-4439.637 843.9292,-4523.8317 1002.022,-4375 1050.327,-4329.5247 1026.3998,-3844.317 1038.022,-3779 1068.9149,-3605.3808 1118.1165,-3572.0237 1152.1868,-3399 1184.1076,-3236.8919 1125.5771,-3181.8987 1188.1868,-3029 1294.9968,-2768.1599 1339.2325,-2670.1594 1587.1179,-2536 1886.2058,-2374.129 2025.3534,-2396.465 2351.1489,-2494 2469.6991,-2529.4909 2475.1213,-2587.7784 2583.7793,-2647 2657.128,-2686.9771 2708.1914,-2654.2783 2755.6838,-2723 2838.5613,-2842.9239 2719.322,-3251.4529 2791.6838,-3378 2833.5192,-3451.162 2909.4024,-3408.9183 2949.5867,-3483 2997.0045,-3570.4171 2982.7251,-6963.5917 2985.5867,-7063 3002.8672,-7663.3119 3046.9436,-8398.6095 3055.1404,-8532.5506"/>
<polygon fill="#003fff" stroke="#003fff" points="3051.6579,-8532.9446 3055.7641,-8542.7113 3058.6447,-8532.5156 3051.6579,-8532.9446"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge832" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M920.1405,-2967C1126.5437,-3033.4659 1223.2124,-3014.0547 1356.6204,-3185 1395.6176,-3234.9699 1347.3566,-3278.6269 1392.6204,-3323 1444.3493,-3373.7111 1500.0035,-3309.6695 1551.1179,-3361 1600.41,-3410.5005 1557.4617,-3450.7504 1587.1179,-3514 1637.9126,-3622.333 1701.3726,-3619.2976 1749.1377,-3729 1785.717,-3813.0119 1743.2848,-3850.4869 1785.1377,-3932 1833.9253,-4027.0191 1907.2395,-4007.4804 1952.9868,-4104 2014.2844,-4233.3282 1953.1288,-4285.4455 1988.9868,-4424 2093.9234,-4829.4724 2259.0255,-4885.4259 2351.1489,-5294 2422.8913,-5612.1826 2351.9539,-5702.734 2387.1489,-6027 2406.3404,-6203.819 2448.9078,-6414.5965 2462.9051,-6481.514"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2459.5535,-6482.5838 2465.0375,-6491.6489 2466.4035,-6481.1425 2459.5535,-6482.5838"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge879" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M744.8972,-646C804.6269,-576.4344 1469.682,-779.8668 1551.1179,-822 2083.8627,-1097.631 2184.98,-1254.3326 2547.7793,-1732 2671.5952,-1895.018 2678.4061,-1953.4389 2755.6838,-2143 2775.7417,-2192.2016 2757.3998,-2216.408 2791.6838,-2257 2842.5773,-2317.2574 2907.7055,-2271.1639 2949.5867,-2338 2982.9159,-2391.1883 3050.7898,-6680.923 3056.1285,-7021.5773"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.6299,-7021.7004 3056.2861,-7031.6444 3059.629,-7021.5908 3052.6299,-7021.7004"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-19202C973.0682,-19202.8047 985.2239,-19215.2125 1038.022,-19219 1265.5531,-19235.322 1326.0678,-19243.2728 1551.1179,-19206 1641.0001,-19191.1137 1692.2176,-19224.1373 1749.1377,-19153 1811.0398,-19075.6364 1759.6836,-18357.7554 1785.1377,-18262 1826.6998,-18105.6482 1911.4034,-18095.3461 1952.9868,-17939 2003.5787,-17748.7837 1962.2537,-17249.0054 1988.9868,-17054 2034.2637,-16723.7268 2120.5907,-16654.8652 2161.3169,-16324 2235.7915,-15718.9583 2124.9932,-14186.3026 2197.3169,-13581 2233.7186,-13276.3415 2314.8456,-13212.6702 2351.1489,-12908 2427.0105,-12271.3427 2330.2919,-10661.6351 2387.1489,-10023 2403.1499,-9843.2723 2448.0037,-9629.4718 2462.7206,-9562.2821"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.2242,-9562.6474 2464.9608,-9552.1281 2459.3885,-9561.1392 2466.2242,-9562.6474"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M397.615,-18558C444.522,-18517.4524 456.8518,-18502.2749 478.0276,-18444 544.1307,-18262.0865 469.8349,-18198.4387 514.0276,-18010 561.741,-17806.5489 594.2155,-17759.9768 687.5354,-17573 744.9652,-17457.933 761.4678,-17429.1586 838.259,-17326 1044.1055,-17049.4729 1231.809,-17070.3442 1356.6204,-16749 1436.8587,-16542.4152 1319.3055,-12969.1421 1392.6204,-12760 1404.3498,-12726.5399 1432.1039,-12695.6632 1451.4374,-12677.0801"/>
<polygon fill="#ffda00" stroke="#ffda00" points="1453.9656,-12679.508 1458.8851,-12670.1245 1449.1877,-12674.3921 1453.9656,-12679.508"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M223.8406,-18636C237.3935,-18683.1772 271.9499,-18596.0154 317.2024,-18577 351.0579,-18562.7737 369.3976,-18581.5023 397.615,-18558"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node62"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1134.3424,-5109.0054 1055.8664,-5109.0054 1055.8664,-5086.9946 1134.3424,-5086.9946 1134.3424,-5109.0054"/>
<text text-anchor="middle" x="1095.1044" y="-5094.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M920.1405,-4069C951.4678,-4089.3535 977.6529,-4059.6836 1002.022,-4088 1035.3192,-4126.6908 1033.3963,-4495.1642 1038.022,-4546 1056.8339,-4752.7417 1084.4178,-5002.5186 1092.6799,-5076.4216"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1089.2441,-5077.1908 1093.8357,-5086.739 1096.2006,-5076.4114 1089.2441,-5077.1908"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge542" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M397.615,-18636C427.6606,-18614.885 454.4114,-18645.1222 478.0276,-18617 522.1899,-18564.4115 502.756,-18067.7408 514.0276,-18000 551.4346,-17775.1882 617.7137,-17731.3791 651.5354,-17506 696.4681,-17206.5803 623.3947,-16439.9005 687.5354,-16144 723.9343,-15976.0809 738.6771,-15928.0184 838.259,-15788 895.117,-15708.0542 954.7248,-15725.9485 1002.022,-15640 1081.3542,-15495.8373 1246.2494,-14264.9407 1269.6245,-14088.1211"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1273.1189,-14088.3933 1270.9572,-14078.0214 1266.179,-14087.4776 1273.1189,-14088.3933"/>
</g>
<!-- sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~datacostestimate.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node65"><a xlink:href="../sourcefile/datacostestimate.f90.html" xlink:title="DataCostEstimate.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="454.744,-18608.0054 340.486,-18608.0054 340.486,-18585.9946 454.744,-18585.9946 454.744,-18608.0054"/>
<text text-anchor="middle" x="397.615" y="-18593.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataCostEstimate.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge549" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacostestimate.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M223.8406,-18636C225.5964,-18642.1119 296.8751,-18624.258 347.5868,-18610.7195"/>
<polygon fill="#4800ff" stroke="#4800ff" points="348.6775,-18614.0507 357.4282,-18608.0777 346.8627,-18607.29 348.6775,-18614.0507"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node66"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="980.8474,-18758.0054 859.4336,-18758.0054 859.4336,-18735.9946 980.8474,-18735.9946 980.8474,-18758.0054"/>
<text text-anchor="middle" x="920.1405" y="-18743.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge551" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M582.7815,-18748C612.0498,-18761.8163 626.8571,-18751.0594 651.5354,-18772 677.0126,-18793.6185 662.7228,-18815.6219 687.5354,-18838 708.0575,-18856.5087 717.5633,-18857.9272 744.8972,-18862"/>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M744.8972,-18862C814.2452,-18872.3329 878.4727,-18801.9712 906.0055,-18766.5273"/>
<polygon fill="#ff00da" stroke="#ff00da" points="908.9572,-18768.4267 912.1956,-18758.3389 903.3732,-18764.2054 908.9572,-18768.4267"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-3765C653.109,-3749.3333 673.4508,-3774.3178 744.8972,-3765"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-3765C1022.6891,-3728.7715 1187.7065,-3693.5074 1356.6204,-3917 1411.9009,-3990.1426 1355.2531,-4244.2774 1392.6204,-4328 1416.2499,-4380.9429 1721.0167,-4658.2998 1749.1377,-4709 1779.257,-4763.3031 1761.9583,-4786.3917 1785.1377,-4844 1842.7488,-4987.182 1906.6424,-5000.7848 1952.9868,-5148 1998.616,-5292.9433 1933.8736,-5346.391 1988.9868,-5488 2035.7023,-5608.0318 2111.26,-5602.3229 2161.3169,-5721 2199.9926,-5812.694 2148.2735,-5855.407 2197.3169,-5942 2208.7627,-5962.2091 2229.0414,-5978.9475 2245.9038,-5990.3753"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2244.0525,-5993.3463 2254.3454,-5995.8575 2247.865,-5987.4756 2244.0525,-5993.3463"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M397.615,-18636C443.7163,-18602.9542 600.725,-18635.2124 651.5354,-18610 855.8891,-18508.5988 909.1926,-18443.3875 1002.022,-18235 1039.6897,-18150.4418 1024.2736,-17911.5419 1038.022,-17820 1103.5331,-17383.8033 1237.91,-16860.5209 1266.8386,-16750.0853"/>
<polygon fill="#ffff00" stroke="#ffff00" points="1270.2828,-16750.7493 1269.4389,-16740.1881 1263.5126,-16748.9705 1270.2828,-16750.7493"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.1044,-19050C1176.1908,-19074.7739 1722.3348,-19017.1574 1749.1377,-18988 1779.2234,-18955.2714 1781.5218,-17432.3084 1785.1377,-17388 1828.5103,-16856.5229 1901.6648,-16730.7685 1952.9868,-16200 1982.3712,-15896.1089 1929.2539,-15813.4081 1988.9868,-15514 2033.7429,-15289.6625 2122.0723,-15254.367 2161.3169,-15029 2211.6446,-14739.9864 2135.6002,-4754.7975 2197.3169,-4468 2209.8602,-4409.7111 2243.5344,-4347.2305 2261.8901,-4316.0769"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2265.1268,-4317.4847 2267.2652,-4307.1079 2259.1224,-4313.8863 2265.1268,-4317.4847"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node70"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2351.065,-14616.0054 2197.4008,-14616.0054 2197.4008,-14593.9946 2351.065,-14593.9946 2351.065,-14616.0054"/>
<text text-anchor="middle" x="2274.2329" y="-14601.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-19620C1103.9073,-19581.523 1217.0326,-19656.9518 1551.1179,-19520 1653.7746,-19477.9179 1688.4344,-19460.8677 1749.1377,-19368 1785.7041,-19312.0584 1748.0581,-19277.6028 1785.1377,-19222 1836.5961,-19144.8355 1908.1641,-19179.1989 1952.9868,-19098 2005.1088,-19003.5781 1960.7644,-18718.0946 1988.9868,-18614 2034.5673,-18445.8825 2119.3931,-18431.0664 2161.3169,-18262 2254.5248,-17886.1201 2272.6187,-14907.736 2274.1242,-14626.3228"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2277.6247,-14626.2075 2274.1774,-14616.1892 2270.6248,-14626.1707 2277.6247,-14626.2075"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-3765C798.875,-3754.4121 1322.3891,-3961.9493 1356.6204,-4009 1421.2449,-4097.8262 1349.1634,-4401.1144 1392.6204,-4502 1485.5274,-4717.6845 1649.0782,-4679.5391 1749.1377,-4892 1798.0918,-4995.9465 1709.7237,-5061.316 1785.1377,-5148 1836.0647,-5206.5376 1904.1571,-5135.7018 1952.9868,-5196 2025.8834,-5286.0177 1916.2637,-5625.8422 1988.9868,-5716 1998.3626,-5727.6236 2012.8012,-5734.0473 2027.1953,-5737.5357"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2026.5991,-5740.9856 2037.0906,-5739.5095 2027.9685,-5734.1208 2026.5991,-5740.9856"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node72" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node72"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1344.989,-5937.0054 1199.8181,-5937.0054 1199.8181,-5914.9946 1344.989,-5914.9946 1344.989,-5937.0054"/>
<text text-anchor="middle" x="1272.4036" y="-5922.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M920.1405,-4069C951.4678,-4089.3535 978.3765,-4059.0766 1002.022,-4088 1047.4348,-4143.5495 1018.657,-5309.9126 1038.022,-5379 1065.6461,-5477.5529 1110.0324,-5485.7327 1152.1868,-5579 1172.5052,-5623.9549 1172.0795,-5637.3702 1188.1868,-5684 1216.5127,-5766.0023 1250.5563,-5863.5101 1265.1669,-5905.3085"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1261.9197,-5906.626 1268.5241,-5914.9106 1268.5275,-5904.3157 1261.9197,-5906.626"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4031C955.3011,-4045.2082 967.7993,-4038.6614 1002.022,-4055 1075.284,-4089.9769 1107.9573,-4090.9231 1152.1868,-4159 1199.0115,-4231.0715 1128.4748,-4287.183 1188.1868,-4349 1241.5028,-4404.1956 1307.421,-4328.1053 1356.6204,-4387 1416.2987,-4458.4387 1355.8862,-5138.4687 1392.6204,-5224 1432.622,-5317.1393 1511.2604,-5294.799 1551.1179,-5388 1590.5571,-5480.2228 1530.7937,-6207.0056 1587.1179,-6290 1631.3672,-6355.2018 1702.3435,-6298.5999 1749.1377,-6362 1789.1423,-6416.2011 1769.0112,-6597.5931 1785.1377,-6663 1803.8328,-6738.8245 1841.3618,-6823.9959 1859.2043,-6862.3386"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1856.2607,-6864.304 1863.6827,-6871.8647 1862.5956,-6861.3258 1856.2607,-6864.304"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4108C262.7639,-3998.9478 629.2846,-4114.4125 744.8972,-4108"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-4108C824.6886,-4107.9905 853.1473,-4025.6576 920.1405,-4069"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4069C951.507,-4089.2931 977.0723,-4060.1939 1002.022,-4088 1091.4118,-4187.6239 953.3757,-4283.3156 1038.022,-4387 1071.8409,-4428.4253 1118.0644,-4383.8244 1152.1868,-4425 1190.2481,-4470.9288 1177.4788,-4632.319 1188.1868,-4691 1248.0369,-5018.9858 1315.8651,-5091.0986 1356.6204,-5422 1382.8659,-5635.0938 1335.683,-7146.9833 1392.6204,-7354 1405.4702,-7400.7202 1437.6024,-7448.3068 1456.7738,-7473.8879"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1454.1072,-7476.1628 1462.9615,-7481.981 1459.6681,-7471.911 1454.1072,-7476.1628"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-19506C967.4509,-19503.4933 1717.7565,-19341.4934 1749.1377,-19306 1811.2809,-19235.7135 1759.516,-19188.2524 1785.1377,-19098 1839.8108,-18905.4141 1906.591,-18874.7458 1952.9868,-18680 1996.2006,-18498.611 1958.0454,-18445.8804 1988.9868,-18262 2040.8649,-17953.6962 2120.8624,-17890.0097 2161.3169,-17580 2182.8487,-17414.9981 2131.237,-14737.7177 2197.3169,-14585 2234.9927,-14497.9272 2301.7067,-14517.9729 2351.1489,-14437 2509.5452,-14177.59 2501.375,-14082.3823 2547.7793,-13782 2629.723,-13251.5659 2539.6642,-11901.9102 2583.7793,-11367 2601.5789,-11151.1743 2650.6999,-10892.951 2665.4739,-10818.2128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2668.9505,-10818.6746 2667.4687,-10808.1839 2662.085,-10817.309 2668.9505,-10818.6746"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-19392C445.295,-19422.6438 596.0879,-19404.2529 651.5354,-19416 774.7047,-19442.0946 794.2393,-19505.2987 920.1405,-19506"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M920.1405,-19810C1466.1277,-19968.2985 1851.3421,-19977.525 2161.3169,-19501 2373.1306,-19175.3782 2885.346,-17554.072 3127.3396,-16011 3197.0953,-15566.2028 3240.2663,-14063.3065 3245.6955,-13865.5409"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3249.201,-13865.3864 3245.975,-13855.2946 3242.2036,-13865.1954 3249.201,-13865.3864"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge431" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-19506C1293.5541,-19543.8533 1471.2728,-19597.3127 1749.1377,-19345 2467.8283,-18692.3996 2330.7078,-18258.1942 2547.7793,-17312 2584.3281,-17152.687 2557.3459,-17107.3001 2583.7793,-16946 2700.6969,-16232.5542 2864.8986,-16078.985 2949.5867,-15361 2956.9098,-15298.9145 2949.2706,-10910.8859 2985.5867,-10860 2987.8416,-10856.8404 2990.5297,-10854.0775 2993.5197,-10851.6618"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6231,-10854.4674 3002.0497,-10846.0442 2991.773,-10848.6213 2995.6231,-10854.4674"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge438" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.1044,-4373C1109.1915,-4394.9978 1133.7895,-4368.4557 1152.1868,-4387 1201.0816,-4436.2854 1138.8352,-4490.1719 1188.1868,-4539 1242.7393,-4592.9739 1308.1219,-4517.5268 1356.6204,-4577 1389.3664,-4617.1561 1385.1203,-6390.7305 1392.6204,-6442 1430.6809,-6702.1758 1498.14,-6754.4473 1551.1179,-7012 1575.1544,-7128.8535 1557.8107,-7162.3558 1587.1179,-7278 1637.0841,-7475.1627 1705.1658,-7507.4144 1749.1377,-7706 1795.9625,-7917.4697 1759.8267,-7976.8922 1785.1377,-8192 1808.0196,-8386.4638 1851.4852,-8619.4623 1864.969,-8689.8575"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1861.5418,-8690.5699 1866.8679,-8699.7286 1868.4158,-8689.2475 1861.5418,-8690.5699"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-4031C955.4598,-4044.8089 977.1533,-4026.3698 1002.022,-4055 1074.7716,-4138.7535 993.705,-4200.2986 1038.022,-4302 1054.1965,-4339.1183 1073.1767,-4338.9623 1095.1044,-4373"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge486" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-19582C1734.5729,-19540.3913 1729.1602,-19504.8886 1785.1377,-19450 1855.1129,-19381.386 1899.5556,-19389.1554 1952.9868,-19307 1955.7629,-19302.7315 2160.4032,-18609.0091 2161.3169,-18604 2200.8196,-18387.4355 2165.8684,-18327.8799 2197.3169,-18110 2243.3185,-17791.2942 2298.8297,-17719.7298 2351.1489,-17402 2388.5746,-17174.717 2551.0983,-15570.0136 2583.7793,-15342 2647.016,-14900.8005 2715.3369,-14797.8783 2755.6838,-14354 2760.698,-14298.8363 2758.7566,-10410.5418 2791.6838,-10366 2793.9995,-10362.8676 2796.7093,-10360.1181 2799.7039,-10357.7057"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.809,-10360.5098 2808.221,-10352.0756 2797.9488,-10354.6704 2801.809,-10360.5098"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge502" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M397.615,-18558C406.1037,-18550.6305 791.0664,-18553.0456 802.259,-18552 926.742,-18540.3709 1265.3629,-18541.4594 1356.6204,-18456 1406.3477,-18409.4321 1354.2392,-18363.2874 1392.6204,-18307 1441.0704,-18235.9462 1487.5931,-18253.971 1551.1179,-18196 1651.7534,-18104.1629 1698.0423,-18088.2965 1749.1377,-17962 1794.2421,-17850.5119 1764.2168,-17540.4328 1785.1377,-17422 1889.2484,-16832.6313 2072.6936,-16720.8956 2161.3169,-16129 2245.1699,-15568.964 2099.5715,-14138.779 2197.3169,-13581 2233.4376,-13374.8792 2315.0672,-13342.1276 2351.1489,-13136 2376.2294,-12992.7204 2338.2596,-10654.9961 2387.1489,-10518 2399.1274,-10484.4343 2427.2328,-10453.5833 2446.7966,-10435.0347"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.3482,-10437.443 2454.3321,-10428.0936 2444.6056,-10432.2943 2449.3482,-10437.443"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-19316C692.929,-19280.0244 722.9688,-19356.386 838.259,-19368 1041.2284,-19388.4466 1601.9078,-19395.2019 1749.1377,-19254 1809.278,-19196.322 1768.6633,-19151.6835 1785.1377,-19070 1857.6515,-18710.4619 1884.4099,-18622.3097 1952.9868,-18262 2054.5239,-17728.5141 2110.966,-17598.7234 2161.3169,-17058 2264.5931,-15948.9053 2099.54,-15661.593 2197.3169,-14552 2212.5515,-14379.1148 2432.7645,-13094.8746 2463.8314,-12914.1189"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2467.3202,-12914.4822 2465.5653,-12904.0337 2460.4214,-12913.296 2467.3202,-12914.4822"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node82" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node82"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2318.117,-4691.0054 2230.3488,-4691.0054 2230.3488,-4668.9946 2318.117,-4668.9946 2318.117,-4691.0054"/>
<text text-anchor="middle" x="2274.2329" y="-4676.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-2891C1010.2662,-2825.7645 1117.0382,-2821.5589 1356.6204,-2953 1501.5768,-3032.5269 1484.3265,-3115.4977 1587.1179,-3245 1658.8842,-3335.4152 1695.6899,-3345.6836 1749.1377,-3448 1775.1161,-3497.731 1764.4915,-3516.8293 1785.1377,-3569 1846.4175,-3723.8476 1883.4946,-3752.6599 1952.9868,-3904 1970.2776,-3941.6559 1972.8919,-3951.8177 1988.9868,-3990 2065.1293,-4170.6342 2109.0755,-4207.0629 2161.3169,-4396 2176.803,-4452.0073 2160.0012,-4610.4559 2197.3169,-4655 2203.4737,-4662.3494 2211.818,-4667.5568 2220.7451,-4671.242"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2219.5967,-4674.5483 2230.1916,-4674.5574 2221.9149,-4667.9432 2219.5967,-4674.5483"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-18636C450.2633,-18598.1219 456.8489,-18693.3864 514.0276,-18724 542.5608,-18739.2768 553.5131,-18734.1837 582.7815,-18748"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-18748C807.7829,-18854.2132 894.0429,-18601.1593 1002.022,-18377 1073.1487,-18229.3443 1000.8838,-18169.6308 1038.022,-18010 1190.0807,-17356.4078 1435.4608,-17251.0054 1551.1179,-16590 1624.9745,-16167.8936 1549.9886,-15088.9075 1587.1179,-14662 1604.0689,-14467.1007 1649.4969,-14234.3965 1663.7723,-14164.1082"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1667.2132,-14164.7509 1665.7868,-14154.2525 1660.355,-14163.349 1667.2132,-14164.7509"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node84" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node84"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2326.5156,-4499.0054 2221.9502,-4499.0054 2221.9502,-4476.9946 2326.5156,-4476.9946 2326.5156,-4499.0054"/>
<text text-anchor="middle" x="2274.2329" y="-4484.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M744.8972,-1657C1137.4468,-1921.2194 847.6957,-2296.4077 1188.1868,-2625 1246.5198,-2681.2946 1294.8574,-2642.4913 1356.6204,-2695 1379.7354,-2714.6516 1370.0365,-2732.7401 1392.6204,-2753 1450.7726,-2805.1682 1500.9145,-2769.1433 1551.1179,-2829 1589.3693,-2874.6064 1560.6876,-2904.6657 1587.1179,-2958 1640.0883,-3064.8903 1681.605,-3073.6601 1749.1377,-3172 1766.3128,-3197.0102 1764.9479,-3207.3534 1785.1377,-3230 1848.4759,-3301.0457 1907.5044,-3279.3903 1952.9868,-3363 2032.9958,-3510.0794 1892.5821,-3601.1062 1988.9868,-3738 2037.7151,-3807.1936 2113.9115,-3748.8934 2161.3169,-3819 2238.9959,-3933.8775 2125.453,-4323.398 2197.3169,-4442 2205.375,-4455.2988 2218.8634,-4465.2247 2232.3143,-4472.3844"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2231.0328,-4475.6539 2241.5533,-4476.9066 2234.1103,-4469.3666 2231.0328,-4475.6539"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-18636C245.1654,-18710.2307 334.4786,-18680.4831 397.615,-18636"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-18636C427.6353,-18614.849 454.9388,-18645.5568 478.0276,-18617 537.735,-18543.1524 498.2751,-17001.6499 514.0276,-16908 526.2823,-16835.1449 558.2568,-16753.0214 573.9011,-16715.5808"/>
<polygon fill="#00ffff" stroke="#00ffff" points="577.1756,-16716.8237 577.8505,-16706.2504 570.7293,-16714.095 577.1756,-16716.8237"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node86" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node86"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="802.1212,-16438.0054 687.6733,-16438.0054 687.6733,-16415.9946 802.1212,-16415.9946 802.1212,-16438.0054"/>
<text text-anchor="middle" x="744.8972" y="-16423.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M397.615,-18636C427.6353,-18614.849 454.2066,-18644.9489 478.0276,-18617 549.2819,-18533.3983 465.7589,-18222.674 514.0276,-18124 550.1888,-18050.0771 617.1751,-18074.777 651.5354,-18000 719.8457,-17851.3389 643.821,-16685.6562 687.5354,-16528 696.0475,-16497.3009 715.8987,-16466.0279 729.8523,-16446.5803"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="732.8546,-16448.4061 735.9697,-16438.2795 727.2195,-16444.2532 732.8546,-16448.4061"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-19724C789.5967,-19743.1181 794.3619,-19760.1054 838.259,-19781 873.1183,-19797.5926 882.5338,-19801.2696 920.1405,-19810"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-19772C2300.1526,-19661.128 2173.5346,-18926.5777 2351.1489,-18110 2615.3992,-16895.1156 2650.4174,-16580.8266 2755.6838,-15342 2811.167,-14689.0466 2759.1524,-14522.4985 2791.6838,-13868 2812.3423,-13452.3737 2858.5221,-12945.8324 2868.648,-12837.154"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2872.1388,-12837.4147 2869.5848,-12827.1323 2865.1692,-12836.7631 2872.1388,-12837.4147"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-19810C971.5338,-19821.9309 985.4604,-19800.5705 1038.022,-19796 1230.4118,-19779.2709 1279.1107,-19783.7422 1471.8691,-19772"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-19772C1693.186,-19753.5022 1780.8722,-19777.3562 1952.9868,-19637 2069.6336,-19541.8768 2095.6609,-19505.4407 2161.3169,-19370 2225.5379,-19237.5195 2755.9501,-16938.8234 2791.6838,-16796 2860.491,-16520.9864 2911.106,-16458.8667 2949.5867,-16178 2998.5853,-15820.3634 2963.6419,-14914.3099 2985.5867,-14554 3002.1992,-14281.2391 3042.8096,-13951.3589 3053.7245,-13865.3323"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3057.2174,-13865.6093 3055.0102,-13855.2469 3050.2736,-13864.724 3057.2174,-13865.6093"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-18636C459.5044,-18591.4734 455.8674,-18712.7018 514.0276,-18762 719.0743,-18935.8031 777.3287,-18998.4966 1038.022,-19064 1191.5023,-19102.5644 1646.7829,-19146.6936 1749.1377,-19026 1799.8192,-18966.238 1759.7415,-17690.1292 1785.1377,-17616 1825.9199,-17496.9607 1911.9057,-17506.9365 1952.9868,-17388 1995.739,-17264.2254 1971.0626,-16339.7175 1988.9868,-16210 2032.3701,-15896.0342 2120.9721,-15832.3707 2161.3169,-15518 2172.6748,-15429.498 2144.47,-12377.8944 2197.3169,-12306 2202.5736,-12298.8486 2209.9238,-12293.7047 2218.0132,-12290.0128"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2219.2953,-12293.2697 2227.3882,-12286.4319 2216.7976,-12286.7305 2219.2953,-12293.2697"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-18636C427.4975,-18614.6548 454.7774,-18645.4255 478.0276,-18617 556.2241,-18521.3975 463.9784,-17618.9142 514.0276,-17506 548.4816,-17428.2695 617.4305,-17450.8843 651.5354,-17373 720.0566,-17216.5203 651.7118,-16003.0261 687.5354,-15836 715.0497,-15707.7156 761.8119,-15688.8117 802.259,-15564 816.9034,-15518.8104 1175.311,-13943.7249 1188.1868,-13898 1212.7619,-13810.7282 1249.0264,-13708.9107 1264.7109,-13665.8834"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1268.002,-13667.0743 1268.1527,-13656.4805 1261.4286,-13664.6681 1268.002,-13667.0743"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-19316C730.6905,-19259.6861 762.7779,-19185.1083 920.1405,-19202"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-19202C1105.6861,-19204.0625 1623.1853,-19238.2623 1749.1377,-19102 1781.8981,-19066.558 1777.7665,-18281.6975 1785.1377,-18234 1828.6064,-17952.7219 1911.1515,-17897.5256 1952.9868,-17616 1972.692,-17483.3964 1940.4425,-16534.9618 1988.9868,-16410 2031.4749,-16300.6281 2119.9278,-16319.7924 2161.3169,-16210 2233.4173,-16018.7401 2153.6794,-12730.6862 2197.3169,-12531 2210.046,-12472.7514 2243.6414,-12410.2537 2261.9363,-12379.0869"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2265.1723,-12380.4944 2267.2927,-12370.1139 2259.1617,-12376.9064 2265.1723,-12380.4944"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-19392C472.4503,-19440.0966 498.2192,-19343.6192 582.7815,-19316"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-18636C269.1184,-18793.6097 211.0842,-19242.9807 317.2024,-19368 341.338,-19396.4345 366.2395,-19371.835 397.615,-19392"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge461" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-19582C1742.102,-19527.7697 1732.703,-19487.2575 1785.1377,-19412 1859.1324,-19305.7982 1908.9204,-19295.7053 1952.9868,-19174 2020.6903,-18987.0126 1926.5527,-18916.8122 1988.9868,-18728 2034.3884,-18590.6974 2114.7876,-18588.9246 2161.3169,-18452 2214.4763,-18295.5645 2181.1736,-18246.4304 2197.3169,-18082 2351.7079,-16509.4204 2451.4851,-16121.2034 2547.7793,-14544 2589.7717,-13856.206 2557.3746,-13682.5686 2583.7793,-12994 2608.6931,-12344.3103 2659.336,-11547.8975 2668.3452,-11408.3536"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2671.8517,-11408.3652 2669.0048,-11398.16 2664.8663,-11407.9131 2671.8517,-11408.3652"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-19724C842.023,-19760.5845 1582.637,-19640.8487 1668.1278,-19582"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-19620C637.8265,-19631.5491 639.8486,-19661.1787 687.5354,-19691 712.4727,-19706.5947 717.8549,-19712.4339 744.8972,-19724"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge591" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4031C1017.3906,-4069.0655 1074.1111,-3998.6404 1152.1868,-4068 1196.0475,-4106.9643 1157.3629,-4145.0814 1188.1868,-4195 1241.4786,-4281.305 1313.4215,-4257.2262 1356.6204,-4349 1425.131,-4494.5475 1325.8474,-4925.6472 1392.6204,-5072 1433.1332,-5160.796 1510.7316,-5135.1464 1551.1179,-5224 1621.7235,-5379.3389 1537.8558,-5827.6337 1587.1179,-5991 1627.6313,-6125.3532 1699.7304,-6130.6567 1749.1377,-6262 1780.475,-6345.3064 1743.6945,-6380.2317 1785.1377,-6459 1834.1369,-6552.1296 1912.104,-6529.0328 1952.9868,-6626 1991.5795,-6717.5353 1979.6962,-10103.097 1988.9868,-10202 2005.8627,-10381.6518 2054.1757,-10594.8122 2070.0379,-10661.7875"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2066.7275,-10662.994 2072.4527,-10671.9088 2073.5364,-10661.3695 2066.7275,-10662.994"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-4031C822.6801,-4026.9956 847.8412,-4002.0341 920.1405,-4031"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge695" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-570C1256.8209,-526.5536 1304.4181,-570 1471.8691,-570 1471.8691,-570 1471.8691,-570 1668.1278,-570 2499.1153,-570 2895.2127,-941.0919 3127.3396,-1739 3139.3199,-1780.1808 3236.3105,-4681.1013 3245.5681,-4958.7172"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.0708,-4958.8571 3245.9021,-4968.7349 3249.0669,-4958.6238 3242.0708,-4958.8571"/>
</g>
<!-- sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node95" class="node">
<title>sourcefile~datadefineequip.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node95"><a xlink:href="../sourcefile/datadefineequip.f90.html" xlink:title="Datadefineequip.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="797.8896,-4234.0054 691.9048,-4234.0054 691.9048,-4211.9946 797.8896,-4211.9946 797.8896,-4234.0054"/>
<text text-anchor="middle" x="744.8972" y="-4219.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Datadefineequip.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge702" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4108C227.8868,-4096.8772 557.7249,-4176.8484 690.4639,-4209.5231"/>
<polygon fill="#00ffff" stroke="#00ffff" points="689.8808,-4212.9841 700.4278,-4211.9781 691.5555,-4206.1873 689.8808,-4212.9841"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge668" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4031C955.4598,-4044.8089 974.5691,-4028.8375 1002.022,-4055 1037.4309,-4088.7446 1016.4024,-4115.1242 1038.022,-4159 1091.6529,-4267.8411 1109.139,-4294.945 1188.1868,-4387 1253.878,-4463.5006 1314.7138,-4447.2857 1356.6204,-4539 1437.4939,-4715.9953 1314.439,-6111.7992 1392.6204,-6290 1431.8328,-6379.3779 1505.9212,-6355.4941 1551.1179,-6442 1598.6242,-6532.9263 1549.523,-6574.5481 1587.1179,-6670 1634.2807,-6789.7444 1695.1841,-6793.158 1749.1377,-6910 1784.5948,-6986.7861 1846.5186,-7244.8613 1864.2143,-7320.1919"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1860.8083,-7320.9981 1866.4958,-7329.9369 1867.624,-7319.4024 1860.8083,-7320.9981"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge774" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4108C273.1535,-3966.9231 208.8981,-4671.0213 317.2024,-4774 385.738,-4839.1655 1148.4617,-4810.5444 1152.1868,-4807 1210.5369,-4751.4791 1164.8291,-4160.0826 1188.1868,-4083 1236.5145,-3923.5138 1440.2668,-3526.7792 1587.1179,-3448 1870.815,-3295.8089 1939.0027,-3494.7046 2547.7793,-3808 2642.8415,-3856.922 2701.9023,-3836.6002 2755.6838,-3929 2803.5176,-4011.1813 2788.0164,-7256.9822 2791.6838,-7352 2809.8543,-7822.7701 2858.6427,-8397.3656 2868.7764,-8513.8311"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2865.3007,-8514.2636 2869.6576,-8523.9211 2872.2742,-8513.6545 2865.3007,-8514.2636"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge789" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-18558C444.6334,-18517.5815 455.6321,-18501.8172 478.0276,-18444 524.4616,-18324.1238 479.9621,-18280.9595 514.0276,-18157 554.5065,-18009.7029 607.8682,-17988.3836 651.5354,-17842 678.8552,-17750.417 645.8802,-17716.0155 687.5354,-17630 735.9212,-17530.0863 1316.3115,-16991.4366 1356.6204,-16888 1395.1913,-16789.023 1328.9206,-13149.0088 1392.6204,-13064 1436.7569,-13005.0988 1506.0865,-13074.2198 1551.1179,-13016 1612.3485,-12936.8368 1526.096,-12195.3242 1587.1179,-12116 1593.8516,-12107.2467 1603.597,-12101.4769 1614.0103,-12097.6936"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.1449,-12101.0069 1623.6941,-12094.7491 1613.1084,-12094.3097 1615.1449,-12101.0069"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge740" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-1258C771.2309,-1230.2515 841.8066,-1243.9747 1002.022,-1347 1081.6305,-1398.1917 1096.1949,-1421.6912 1152.1868,-1498 1288.1916,-1683.355 1215.4168,-1809.5327 1392.6204,-1956 1449.3525,-2002.8918 1501.8177,-1949.3478 1551.1179,-2004 1607.5168,-2066.5215 1561.0662,-2109.9307 1587.1179,-2190 1639.6548,-2351.4706 1699.1204,-2373.7313 1749.1377,-2536 1778.71,-2631.94 1729.6228,-2675.3513 1785.1377,-2759 1833.7955,-2832.3164 1895.9344,-2797.0082 1952.9868,-2864 2107.481,-3045.4093 2108.2895,-3125.6945 2161.3169,-3358 2197.1162,-3514.8317 2140.823,-3930.3806 2197.3169,-4081 2236.0837,-4184.357 2289.5743,-4184.3806 2351.1489,-4276 2450.0257,-4423.1228 2496.7062,-4453.2553 2547.7793,-4623 2581.217,-4734.1324 2510.9529,-5053.6407 2583.7793,-5144 2586.3392,-5147.1762 2589.2779,-5149.9639 2592.4907,-5152.4094"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2590.6656,-5155.3965 2600.982,-5157.8096 2594.4221,-5149.4898 2590.6656,-5155.3965"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge752" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M582.7815,-1258C772.1515,-1230.1159 629.7112,-1504.1252 744.8972,-1657"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M744.8972,-1657C753.495,-1668.4109 990.9992,-1652.9099 1002.022,-1662 1040.1134,-1693.4126 1158.8439,-2491.2922 1188.1868,-2531 1239.1356,-2599.9458 1283.3359,-2580.5174 1356.6204,-2625 1445.0828,-2678.6954 1484.8738,-2673.4983 1551.1179,-2753 1577.3806,-2784.5187 1563.1995,-2804.6673 1587.1179,-2838 1643.284,-2916.2728 1695.7581,-2901.801 1749.1377,-2982 1776.4722,-3023.0682 1757.0902,-3046.4153 1785.1377,-3087 1840.2048,-3166.6819 1907.0973,-3140.702 1952.9868,-3226 2023.3052,-3356.7057 1909.1554,-3432.8777 1988.9868,-3558 2037.1038,-3633.4152 2115.3258,-3585.2699 2161.3169,-3662 2200.7856,-3727.8483 2147.8829,-4293.2628 2197.3169,-4352 2242.4664,-4405.6463 2305.0888,-4334.1335 2351.1489,-4387 2412.1029,-4456.9613 2343.4591,-4721.1393 2387.1489,-4803 2430.2611,-4883.7785 2507.7781,-4849.6366 2547.7793,-4932 2591.2258,-5021.4573 2580.6424,-8412.6 2583.7793,-8512 2604.4399,-9166.6825 2658.5621,-9968.9267 2668.2396,-10109.4905"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2664.7679,-10110.0234 2668.9486,-10119.7585 2671.7513,-10109.5411 2664.7679,-10110.0234"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node101" class="node">
<title>sourcefile~dataphotovoltaics.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node101"><a xlink:href="../sourcefile/dataphotovoltaics.f90.html" xlink:title="DataPhotovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2132.2962,-3850.0054 2018.0075,-3850.0054 2018.0075,-3827.9946 2132.2962,-3827.9946 2132.2962,-3850.0054"/>
<text text-anchor="middle" x="2075.1519" y="-3835.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPhotovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge765" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-4108C272.5852,-3968.5487 213.0235,-3893.7352 317.2024,-3789 343.5049,-3762.5571 378.8428,-3797.2282 397.615,-3765"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-3765C580.8679,-3450.39 325.6199,-3224.7383 582.7815,-2967"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-2891C888.3217,-2848.0484 893.2457,-2763.148 1038.022,-2725 1175.9181,-2688.6649 1241.1933,-2679.2612 1356.6204,-2763 1383.666,-2782.6208 1374.1767,-2801.1383 1392.6204,-2829 1455.2253,-2923.5734 1500.9308,-2927.2908 1551.1179,-3029 1580.1187,-3087.773 1550.4387,-3117.6866 1587.1179,-3172 1636.9737,-3245.8247 1692.7574,-3221.0294 1749.1377,-3290 1769.4005,-3314.7877 1964.7482,-3793.0834 1988.9868,-3814 1994.6619,-3818.8973 2001.2483,-3822.8368 2008.2029,-3826.0056"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2007.2788,-3829.4054 2017.8636,-3829.8665 2009.8766,-3822.9052 2007.2788,-3829.4054"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-2967C638.9872,-2910.6682 667.6219,-2909.9966 744.8972,-2891"/>
</g>
<!-- sourcefile~datagenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node102" class="node">
<title>sourcefile~datagenerators.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node102"><a xlink:href="../sourcefile/datagenerators.f90.html" xlink:title="DataGenerators.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="797.116,-6421.0054 692.6785,-6421.0054 692.6785,-6398.9946 797.116,-6398.9946 797.116,-6421.0054"/>
<text text-anchor="middle" x="744.8972" y="-6406.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGenerators.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge784" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-6353C249.0681,-6319.4731 275.3605,-6342.1197 317.2024,-6339 388.4824,-6333.6853 410.4186,-6315.8028 478.0276,-6339 497.2002,-6345.5783 495.541,-6358.6868 514.0276,-6367 567.7231,-6391.1461 634.3009,-6401.7336 682.1426,-6406.3757"/>
<polygon fill="#ff0000" stroke="#ff0000" points="682.0828,-6409.8846 692.3587,-6407.3046 682.7167,-6402.9134 682.0828,-6409.8846"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge844" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-2967C652.09,-2897.536 711.3143,-2954.1493 802.259,-2991 821.0452,-2998.6121 821.866,-3007.078 838.259,-3019 1063.477,-3182.7925 1166.2366,-3167.7633 1356.6204,-3371 1474.3282,-3496.6543 1670.1445,-3886.0156 1749.1377,-4039 1850.6163,-4235.5315 1898.305,-4278.6814 1952.9868,-4493 2004.0133,-4692.992 1906.2541,-4766.908 1988.9868,-4956 2034.1591,-5059.2446 2105.1561,-5044.2967 2161.3169,-5142 2188.6417,-5189.5371 2175.4498,-5209.7183 2197.3169,-5260 2251.7817,-5385.2378 2313.3802,-5394.7581 2351.1489,-5526 2412.4612,-5739.0532 2364.9569,-6302.4136 2387.1489,-6523 2405.3211,-6703.6296 2448.9052,-6918.9758 2462.9913,-6986.0276"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.5678,-6986.7556 2465.0601,-6995.8156 2466.4165,-6985.308 2459.5678,-6986.7556"/>
</g>
<!-- sourcefile~datadelight.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node104" class="node">
<title>sourcefile~datadelight.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node104"><a xlink:href="../sourcefile/datadelight.f90.html" xlink:title="DataDElight.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3650.2957,-714.0054 3565.2112,-714.0054 3565.2112,-691.9946 3650.2957,-691.9946 3650.2957,-714.0054"/>
<text text-anchor="middle" x="3607.7534" y="-699.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataDElight.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadelight.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge913" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadelight.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-154C1486.6546,-151.1175 2533.1421,-287.4404 2547.7793,-291 2643.3754,-314.2478 2663.6778,-332.158 2755.6838,-367 2842.247,-399.7809 2866.0121,-403.2124 2949.5867,-443 3048.1532,-489.9249 3063.1824,-520.5738 3163.3396,-564 3300.1822,-623.3324 3470.6133,-669.3411 3555.1405,-690.413"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3554.4666,-693.8517 3565.0148,-692.8583 3556.1494,-687.057 3554.4666,-693.8517"/>
</g>
<!-- sourcefile~tarcogcomplexfenestration.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node105" class="node">
<title>sourcefile~tarcogcomplexfenestration.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node105"><a xlink:href="../sourcefile/tarcogcomplexfenestration.f90.html" xlink:title="TarcogComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="477.9403,-14839.0054 317.2897,-14839.0054 317.2897,-14816.9946 477.9403,-14816.9946 477.9403,-14839.0054"/>
<text text-anchor="middle" x="397.615" y="-14824.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">TarcogComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge977" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-15417C322.5946,-15596.2969 243.9716,-15157.1465 317.2024,-14966 334.5066,-14920.8326 365.5633,-14873.1469 383.5971,-14847.3452"/>
<polygon fill="#ff0000" stroke="#ff0000" points="386.463,-14849.3543 389.3888,-14839.1714 380.7515,-14845.3072 386.463,-14849.3543"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1033" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9214,-13808.8447C226.4801,-13456.0911 289.1511,-4854.3881 317.2024,-4734 363.0718,-4537.1414 349.369,-4441.2385 514.0276,-4324 691.8648,-4197.3781 854.2455,-4428.69 1002.022,-4268 1046.3052,-4219.8471 1033.9501,-3156.2926 1038.022,-3091 1082.2846,-2381.2402 903.2386,-2149.5541 1188.1868,-1498 1233.1385,-1395.2148 1303.6262,-1408.8791 1356.6204,-1310 1386.7659,-1253.7529 1364.791,-1228.4284 1392.6204,-1171 1488.2336,-973.694 1802.6636,-500.5648 1988.9868,-385 2142.9967,-289.4772 3357.1622,-57.0511 3607.7534,-153"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.3555,-13831.3223C229.0941,-13935.9939 265.3014,-14745.9262 281.2024,-15403 283.1904,-15485.1487 280.7811,-18287.3396 317.2024,-18361 327.2431,-18381.3068 347.2837,-18397.0336 364.8453,-18407.6953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="363.3229,-18410.8572 373.7369,-18412.8064 366.8114,-18404.7884 363.3229,-18410.8572"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ff6600" stroke-dasharray="5,2" d="M223.9226,-13808.8654C226.5193,-13456.7754 290.1077,-4871.9223 317.2024,-4817 327.2248,-4796.6842 347.2654,-4780.9573 364.8316,-4770.2979"/>
<polygon fill="#ff6600" stroke="#ff6600" points="366.7984,-4773.2045 373.7258,-4765.1881 363.3113,-4767.1348 366.7984,-4773.2045"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M397.615,-4831C418.4816,-4808.0521 486.7779,-4768.8147 514.0276,-4754 566.0044,-4725.7421 968.09,-4589.4635 1002.022,-4541 1038.8007,-4488.4707 1029.663,-4028.5777 1038.022,-3965 1071.4738,-3710.5679 1123.7219,-3654.0382 1152.1868,-3399 1190.3295,-3057.2511 1113.301,-2187.6178 1188.1868,-1852 1194.3101,-1824.5568 1378.3843,-1413.2479 1392.6204,-1389 1465.3244,-1265.1653 1495.9278,-1241.9291 1587.1179,-1131 1655.6792,-1047.5979 1685.0714,-1036.9027 1749.1377,-950 1767.5913,-924.9685 1763.2541,-912.0957 1785.1377,-890 2087.7768,-584.4267 3243.0695,-411.6961 3670.96,-455 3837.2152,-471.8256 3918.4499,-448.1943 4027.281,-575 4113.3433,-675.2764 3992.3371,-852.8834 4124.4445,-856"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.913,-13808.775C226.0778,-13474.2608 276.3365,-5771.6695 317.2024,-5311 336.3158,-5095.5399 247.0201,-4986.2726 397.615,-4831"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylightingdevices.f90</title>
<path fill="none" stroke="#33ff00" stroke-dasharray="5,2" d="M224.3569,-13831.3223C229.1086,-13935.9935 265.4105,-14745.9236 281.2024,-15403 283.2321,-15487.4538 275.678,-18370.4318 317.2024,-18444 317.7255,-18444.9269 837.2978,-18766.5431 838.259,-18767 923.0923,-18807.3271 945.3871,-18820.4522 1038.022,-18836 1161.7298,-18856.7631 1307.9317,-18843.3489 1395.1098,-18831.4173"/>
<polygon fill="#33ff00" stroke="#33ff00" points="1395.7632,-18834.8601 1405.1823,-18830.0092 1394.794,-18827.9275 1395.7632,-18834.8601"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.5768,-13808.7745C241.8969,-13767.7034 297.5593,-13624.8429 397.615,-13564"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-13564C495.6796,-13504.3678 494.4146,-13457.2391 582.7815,-13384"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M582.7815,-13384C614.4617,-13357.7432 631.5465,-13357.9653 651.5354,-13322 727.5135,-13185.2956 892.9287,-12019.3839 917.155,-11846.4139"/>
<polygon fill="#00ff00" stroke="#00ff00" points="920.653,-11846.6706 918.5714,-11836.2823 913.7205,-11845.7014 920.653,-11846.6706"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ff32" stroke-dasharray="5,2" d="M582.7815,-4223C656.5997,-4225.3595 620.8525,-4320.2497 687.5354,-4352 728.1118,-4371.32 969.0625,-4383.0529 1002.022,-4351 1045.617,-4308.6041 1018.6973,-3314.6584 1038.022,-3257 1066.0132,-3173.4834 1120.5102,-3177.1896 1152.1868,-3095 1199.5286,-2972.1646 1161.745,-2929.9597 1188.1868,-2801 1209.2401,-2698.3201 1248.7739,-2579.1464 1265.0824,-2531.866"/>
<polygon fill="#00ff32" stroke="#00ff32" points="1268.4761,-2532.7626 1268.451,-2522.1678 1261.8636,-2530.4658 1268.4761,-2532.7626"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylighting.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadaylighting.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M224.2952,-13831.324C228.4888,-13936.0106 260.7438,-14746.0523 281.2024,-15403 300.3276,-16017.1329 253.9046,-16173.8385 317.2024,-16785 337.727,-16983.1717 345.9598,-17033.5812 397.615,-17226"/>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M397.615,-17226C403.4537,-17247.7497 779.8423,-17247.8484 802.259,-17250 1026.8535,-17271.5574 1292.065,-17310.98 1409.9918,-17329.2395"/>
<polygon fill="#00ff66" stroke="#00ff66" points="1409.5045,-17332.7057 1419.923,-17330.7812 1410.5783,-17325.7886 1409.5045,-17332.7057"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M397.615,-16504C426.6665,-16540.9761 937.9979,-16489.6185 1002.022,-16440 1073.7582,-16384.4046 1090.2276,-16266.4204 1093.9939,-16218.2029"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1097.4998,-16218.2313 1094.6768,-16208.0195 1090.5155,-16217.7629 1097.4998,-16218.2313"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#00ffcb" stroke-dasharray="5,2" d="M224.3266,-13831.323C228.8041,-13936.0014 263.1178,-14745.9827 281.2024,-15403 292.9013,-15828.0254 268.2189,-16893.6446 317.2024,-17316 323.1863,-17367.596 473.6177,-18197.3658 514.0276,-18230 623.2925,-18318.24 808.1846,-18260.1817 885.024,-18229.9909"/>
<polygon fill="#00ffcb" stroke="#00ffcb" points="886.7253,-18233.0797 894.7037,-18226.1087 884.1195,-18226.5827 886.7253,-18233.0797"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataviewfactorinformation.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataviewfactorinformation.f90</title>
<path fill="none" stroke="#0066ff" stroke-dasharray="5,2" d="M224.3693,-13831.322C229.2328,-13935.9906 266.3451,-14745.9018 281.2024,-15403 282.4592,-15458.5853 284.0351,-19361.3768 317.2024,-19406 319.519,-19409.1167 322.2205,-19411.8558 325.2023,-19414.2621"/>
<polygon fill="#0066ff" stroke="#0066ff" points="323.4096,-19417.2729 333.6774,-19419.885 327.2796,-19411.44 323.4096,-19417.2729"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#0033ff" stroke-dasharray="5,2" d="M582.7815,-4223C642.5757,-4229.9142 781.0753,-4151.7927 838.259,-4133 849.3987,-4129.3391 861.4486,-4125.5604 872.7899,-4122.0841"/>
<polygon fill="#0033ff" stroke="#0033ff" points="873.9863,-4125.3785 882.5333,-4119.1176 871.9475,-4118.682 873.9863,-4125.3785"/>
<path fill="none" stroke="#0033ff" stroke-dasharray="5,2" d="M223.9249,-13808.9919C226.6957,-13447.6542 296.9533,-4311.3583 317.2024,-4286 392.8991,-4191.2038 462.1306,-4210.3642 582.7815,-4223"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-17359C799.6755,-17428.8222 868.2885,-17318.258 1095.1044,-17340"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-17226C407.1651,-17262.0533 446.1855,-17230.5802 478.0276,-17250 535.3907,-17284.9846 521.6125,-17331.2006 582.7815,-17359"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M744.8972,-13574C857.4131,-13539.9579 921.986,-13598.0984 1002.022,-13512 1068.8822,-13440.0753 977.7489,-13371.5282 1038.022,-13294 1040.5277,-13290.777 1043.5349,-13287.9609 1046.8414,-13285.5019"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1048.9061,-13288.34 1055.5615,-13280.0964 1045.218,-13282.3903 1048.9061,-13288.34"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge947" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M920.1405,-4679C953.9943,-4661.9102 973.1831,-4679.6264 1002.022,-4655 1030.4447,-4630.7289 1009.5539,-4603.218 1038.022,-4579 1078.2514,-4544.7766 1120.125,-4587.9725 1152.1868,-4546 1231.886,-4441.6645 1139.5358,-2304.9465 1188.1868,-2183 1229.1475,-2080.3294 1309.2438,-2099.8724 1356.6204,-2000 1405.1102,-1897.7809 1337.0491,-1846.5486 1392.6204,-1748 1504.3062,-1549.9393 1984.9503,-1197.2539 2197.3169,-1116 2547.2458,-982.1131 3638.928,-746.2263 3881.228,-1032 4028.6175,-1205.8342 4120.5438,-17103.8616 4124.3232,-17768.5585"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4120.8241,-17768.7377 4124.3809,-17778.7176 4127.824,-17768.6979 4120.8241,-17768.7377"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge954" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M582.7815,-11482C622.9019,-11482.701 668.6159,-11482.6212 701.2497,-11482.4129"/>
<polygon fill="#9900ff" stroke="#9900ff" points="701.3867,-11485.9121 711.3618,-11482.3415 701.3373,-11478.9123 701.3867,-11485.9121"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge960" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M397.615,-17226C409.3155,-17269.5853 457.0415,-17248.048 478.0276,-17288 547.778,-17420.7865 486.963,-17814.4707 514.0276,-17962 527.4718,-18035.2841 558.869,-18118.3025 574.1373,-18156.1753"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="570.97,-18157.6772 577.9878,-18165.6146 577.4515,-18155.0333 570.97,-18157.6772"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge969" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~solarreflectionmanager.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M744.8972,-15398C778.2781,-15424.1742 1057.0452,-15568.7316 1095.1044,-15550"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1095.1044,-15550C1120.0206,-15538.3127 1132.15,-15544.8664 1152.1868,-15526 1178.5241,-15501.201 1159.3926,-15474.8983 1188.1868,-15453 1189.612,-15451.9161 1191.0893,-15450.8987 1192.6105,-15449.9441"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1194.5293,-15452.8894 1201.7485,-15445.1349 1191.2692,-15446.6949 1194.5293,-15452.8894"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M397.615,-14980C494.9337,-15063.8258 577.0813,-15013.3373 651.5354,-15118 708.4592,-15198.0196 644.37,-15247.7945 687.5354,-15336 704.0366,-15369.719 714.3075,-15376.2392 744.8972,-15398"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge989" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1668.1278,-14676C1748.4251,-14764.459 1693.7235,-14841.0838 1785.1377,-14918 1814.8227,-14942.977 1834.3339,-14924.7086 1869.0623,-14942"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1272.4036,-13912C1300.7717,-13937.8368 1330.9301,-13902.4991 1356.6204,-13931 1402.0193,-13981.3658 1374.0847,-14168.7757 1392.6204,-14234 1399.6219,-14258.6375 1567.7216,-14635.2724 1587.1179,-14652 1615.5548,-14676.5243 1642.8888,-14648.1956 1668.1278,-14676"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1000" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M223.8687,-13808.932C224.4901,-13586.1154 236.8309,-10069.2434 397.615,-9650"/>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M397.615,-9650C461.4167,-9483.6376 546.3324,-9286.0354 573.8027,-9222.6466"/>
<polygon fill="#ff0033" stroke="#ff0033" points="577.0727,-9223.9032 577.8428,-9213.3364 570.6512,-9221.1166 577.0727,-9223.9032"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-5859C845.9105,-5828.5736 927.5158,-5823.3053 1152.1868,-5683 1188.7688,-5660.1548 1228.06,-5629.0207 1251.4193,-5609.7309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1253.8225,-5612.2844 1259.27,-5603.1973 1249.3447,-5606.9039 1253.8225,-5612.2844"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M744.8972,-13840C892.7682,-13816.5561 894.0245,-13714.9897 1038.022,-13674 1174.2654,-13635.2175 1245.5394,-13752.9054 1356.6204,-13665 1390.2615,-13638.3776 1451.5011,-13336.1207 1467.7963,-13253.0269"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1471.2328,-13253.69 1469.7128,-13243.2048 1464.3624,-13252.3494 1471.2328,-13253.69"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-14068C571.296,-14130.6623 561.8404,-13864.1216 744.8972,-13840"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M227.2997,-13831.1404C240.8263,-13872.4752 294.5462,-14017.2793 397.615,-14068"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-9650C807.471,-9566.6354 807.8867,-9872.1209 1038.022,-9939 1086.7461,-9953.1596 1110.8546,-9968.4311 1152.1868,-9939 1192.0309,-9910.6285 1153.4665,-9869.4528 1188.1868,-9835 1256.2565,-9767.4546 1299.0486,-9786.9806 1392.6204,-9766 1422.6915,-9759.2575 1641.2105,-9749.0065 1668.1278,-9734"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-9734C1707.0341,-9710.7208 1718.1409,-9705.0881 1749.1377,-9672 1768.8577,-9650.9495 1768.5332,-9641.5858 1785.1377,-9618 1808.7333,-9584.4836 1837.4377,-9546.3767 1854.4266,-9524.0834"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1857.2442,-9526.1606 1860.5334,-9516.0893 1851.6815,-9521.9112 1857.2442,-9526.1606"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9189,-13808.7524C226.4607,-13444.1617 290.2132,-4337.0056 317.2024,-4209 322.916,-4181.9012 493.8932,-3770.0157 514.0276,-3751 517.8539,-3747.3863 522.2428,-3744.2875 526.9121,-3741.6315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.7543,-3744.625 536.1626,-3737.0508 525.6479,-3738.3519 528.7543,-3744.625"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M744.8972,-6505C887.6323,-6487.5495 1232.5066,-6366.6196 1356.6204,-6294 1375.0973,-6283.1891 1373.941,-6272.4571 1392.6204,-6262 1456.8441,-6226.0461 1495.207,-6261.868 1551.1179,-6214 1622.2441,-6153.1055 1653.6478,-6039.0747 1663.9873,-5992.0755"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1667.4467,-5992.6323 1666.0775,-5982.1263 1660.5963,-5991.1931 1667.4467,-5992.6323"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M397.615,-7150C540.7782,-6857.5872 419.871,-6523.9462 744.8972,-6505"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.9874,-13808.5489C227.8854,-13505.9825 308.7996,-7307.4997 397.615,-7150"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.9043,-13808.7589C225.7891,-13477.6547 269.2067,-5942.1259 317.2024,-5845 327.2383,-5824.6909 347.279,-5808.964 364.8418,-5798.3029"/>
<polygon fill="#00ffff" stroke="#00ffff" points="366.8081,-5801.2098 373.734,-5793.1922 363.3199,-5795.1407 366.8081,-5801.2098"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M224.1082,-13808.7147C227.8495,-13654.4413 271.5002,-11962.8115 397.615,-11482"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M397.615,-11482C519.7561,-11016.3384 345.4615,-10724.7198 744.8972,-10456"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M744.8972,-10456C874.8815,-10383.8225 896.13,-10346.3666 1002.022,-10242 1019.5322,-10224.742 1019.4161,-10216.0706 1038.022,-10200 1083.4198,-10160.7881 1117.2787,-10176.7849 1152.1868,-10128 1192.3346,-10071.8925 1144.2447,-10030.1883 1188.1868,-9977 1242.1148,-9911.7244 1336.3179,-9878.4011 1401.2817,-9862.3711"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1402.1335,-9865.7662 1411.0458,-9860.0372 1400.5061,-9858.958 1402.1335,-9865.7662"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-7150C680.1077,-7140.3404 731.5329,-7098.4461 802.259,-7166 900.0074,-7259.3641 756.661,-7360.2347 838.259,-7468 848.323,-7481.2914 1376.9562,-7692.2923 1392.6204,-7698 1402.9984,-7701.7816 1414.2572,-7705.5373 1424.9417,-7708.9445"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1423.9614,-7712.3051 1434.5508,-7711.9662 1426.0613,-7705.6275 1423.9614,-7712.3051"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M582.7815,-7150C706.9893,-7135.6375 739.1274,-7218.0729 802.259,-7326 851.8418,-7410.7644 799.2313,-7453.8873 838.259,-7544 848.7016,-7568.1112 1362.5045,-8230.185 1457.0146,-8351.878"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1454.4094,-8354.2297 1463.3077,-8359.9804 1459.9378,-8349.9358 1454.4094,-8354.2297"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.3523,-13831.3224C229.0618,-13935.9947 265.0576,-14745.9322 281.2024,-15403 285.0073,-15557.8551 279.716,-18040.7025 317.2024,-18191 336.0791,-18266.6839 353.3083,-18282.8027 397.615,-18347"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-18347C458.5304,-18435.2621 1258.7345,-18499.8094 1356.6204,-18456 1406.832,-18433.5275 1444.1932,-18377.1686 1461.3862,-18346.9224"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1464.4893,-18348.5432 1466.2504,-18338.0958 1458.3585,-18345.1646 1464.4893,-18348.5432"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.8355,-9213.0054 333.3945,-9213.0054 333.3945,-9190.9946 461.8355,-9190.9946 461.8355,-9213.0054"/>
<text text-anchor="middle" x="397.615" y="-9198.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9638,-13808.7527C226.5829,-13570.9691 270.546,-9640.1759 317.2024,-9407 331.3949,-9336.0698 368.5354,-9258.0027 386.9489,-9222.096"/>
<polygon fill="#ff0000" stroke="#ff0000" points="390.1041,-9223.6146 391.6112,-9213.1275 383.8932,-9220.3858 390.1041,-9223.6146"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="442.0796,-9438.0054 353.1504,-9438.0054 353.1504,-9415.9946 442.0796,-9415.9946 442.0796,-9438.0054"/>
<text text-anchor="middle" x="397.615" y="-9423.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8534,-13808.9586C224.1406,-13586.6682 230.0479,-10077.7304 317.2024,-9636 331.4416,-9563.8304 368.5598,-9484.1709 386.9585,-9447.5176"/>
<polygon fill="#7fff00" stroke="#7fff00" points="390.2015,-9448.8618 391.6169,-9438.362 383.9626,-9445.6875 390.2015,-9448.8618"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-5859C447.2631,-5793.3667 501.3362,-5870.8041 582.7815,-5859"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-5859C607.0484,-5855.4829 981.315,-5734.133 1002.022,-5721 1021.6683,-5708.5398 1020.6006,-5698.4185 1038.022,-5683 1100.1714,-5627.996 1113.1141,-5607.3849 1188.1868,-5572 1193.6006,-5569.4482 1199.3618,-5567.1828 1205.2322,-5565.1762"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1206.6899,-5568.3864 1215.1728,-5562.0389 1204.583,-5561.711 1206.6899,-5568.3864"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1337.224,-9004.0054 1207.5831,-9004.0054 1207.5831,-8981.9946 1337.224,-8981.9946 1337.224,-9004.0054"/>
<text text-anchor="middle" x="1272.4036" y="-8989.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M582.7815,-9650C687.727,-9605.6151 616.5915,-9505.1658 687.5354,-9416 739.8295,-9350.2743 767.3461,-9347.0099 838.259,-9302 907.6675,-9257.945 948.4203,-9278.3317 1002.022,-9216 1033.914,-9178.9137 1005.8755,-9148.866 1038.022,-9112 1086.3446,-9056.5831 1166.6797,-9023.7853 1219.5923,-9007.0859"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1220.9321,-9010.3359 1229.4652,-9004.056 1218.8783,-9003.6439 1220.9321,-9010.3359"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M397.615,-9650C427.0836,-9573.1608 505.6247,-9678.6268 582.7815,-9650"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-4679C952.8512,-4659.8127 974.5691,-4681.1625 1002.022,-4655 1037.4309,-4621.2554 1004.8379,-4586.9349 1038.022,-4551 1041.1621,-4547.5996 1044.8468,-4544.6376 1048.8064,-4542.0623"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1050.7931,-4544.9613 1057.8092,-4537.0224 1047.3737,-4538.8532 1050.7931,-4544.9613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-4831C400.1741,-4828.2193 916.8808,-4680.912 920.1405,-4679"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1356.8377,-13962.0054 1187.9694,-13962.0054 1187.9694,-13939.9946 1356.8377,-13939.9946 1356.8377,-13962.0054"/>
<text text-anchor="middle" x="1272.4036" y="-13947.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-14068C702.6213,-14054.1425 1051.8371,-13991.3199 1202.2001,-13963.8842"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1203.036,-13967.2895 1212.2446,-13962.0501 1201.7786,-13960.4034 1203.036,-13967.2895"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14068C475.027,-14095.9294 500.5462,-14071.1657 582.7815,-14068"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2681,-13831.3249C228.217,-13936.0195 258.6967,-14746.1193 281.2024,-15403 283.3246,-15464.9404 279.6543,-16468.6923 317.2024,-16518 319.6727,-16521.244 322.5592,-16524.0779 325.742,-16526.5525"/>
<polygon fill="#ff0000" stroke="#ff0000" points="323.8918,-16529.524 334.195,-16531.9928 327.6802,-16523.6377 323.8918,-16529.524"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge910" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14980C479.7767,-15060.8717 543.4959,-14992.7727 651.5354,-15033 668.6883,-15039.3867 671.4962,-15044.182 687.5354,-15053 761.6984,-15093.7731 1311.8487,-15345.1801 1356.6204,-15417 1456.635,-15577.4372 1302.5749,-16100.7627 1392.6204,-16267 1464.9992,-16400.6222 2737.1111,-17199.7901 2791.6838,-17216 2858.9578,-17235.9826 2879.7892,-17223.308 2949.5867,-17216 3137.3788,-17196.3375 3180.1894,-17165.6575 3365.2148,-17128 3397.0165,-17121.5275 3406.1415,-17124.4082 3436.8809,-17114"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge921" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3794.094,-1159C3966.6221,-1284.4885 3972.0942,-16191.5389 3972.2502,-16836.453"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3968.7502,-16836.7148 3972.2525,-16846.714 3975.7502,-16836.7131 3968.7502,-16836.7148"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-4831C451.0243,-4774.6569 670.1514,-4813.9802 744.8972,-4793"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-4793C793.9019,-4784.0776 792.5197,-4750.7228 838.259,-4731 906.8696,-4701.4152 943.8401,-4739.8779 1002.022,-4693 1031.1262,-4669.5504 1010.0431,-4641.7815 1038.022,-4617 1078.054,-4581.5428 1120.4645,-4622.0519 1152.1868,-4579 1209.8709,-4500.7139 1162.4826,-2922.7841 1188.1868,-2829 1228.4009,-2682.2748 1310.2588,-2675.9002 1356.6204,-2531 1403.1963,-2385.4298 1320.6103,-2323.813 1392.6204,-2189 1445.6248,-2089.7681 1486.433,-2077.1897 1587.1179,-2027 1653.3124,-1994.0032 1697.2131,-2041.672 1749.1377,-1989 1801.5267,-1935.857 1740.6736,-1884.9311 1785.1377,-1825 1935.5755,-1622.2321 2553.1314,-1380.6989 2791.6838,-1298 2955.0526,-1241.365 2992.8974,-1212.0921 3163.3396,-1183 3439.8784,-1135.7987 3567.2211,-993.9838 3794.094,-1159"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge579" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14980C439.5455,-15018.1347 596.955,-14988.7224 651.5354,-15004 735.3849,-15027.4704 1308.8726,-15273.1869 1356.6204,-15346 1461.9985,-15506.6968 1290.9271,-16046.9464 1392.6204,-16210 1435.0325,-16278.0031 1482.9503,-16253.8529 1551.1179,-16296 1849.2249,-16480.3154 1881.1505,-16596.7428 2197.3169,-16748 2589.5736,-16935.6596 2728.8027,-16886.9021 3163.3396,-16903 3237.0114,-16905.7293 3262.0546,-16933.4054 3329.2148,-16903 3351.3061,-16892.9987 3344.1895,-16874.0825 3365.2148,-16862 3393.3532,-16845.8299 3420.7113,-16876.1387 3436.8809,-16848"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge612" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M582.7815,-17359C702.0547,-17413.206 1655.8217,-17623.9594 1749.1377,-17532 1796.9598,-17484.8731 1771.1035,-16389.6578 1785.1377,-16324 1834.7841,-16091.7326 1844.7867,-16018.7307 1988.9868,-15830 2047.7252,-15753.1226 2118.1486,-15783.5842 2161.3169,-15697 2200.1131,-15619.1849 2142.0637,-12634.1373 2197.3169,-12567 2197.8207,-12566.3879 2198.3412,-12565.7953 2198.8775,-12565.2217"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2201.1807,-12567.8588 2206.6539,-12558.7872 2196.7181,-12562.4656 2201.1807,-12567.8588"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge629" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M397.615,-6353C451.2275,-6290.5631 503.8854,-6376.4112 582.7815,-6353"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M582.7815,-6353C641.3493,-6335.6209 633.9293,-6293.302 687.5354,-6264 748.9919,-6230.4069 770.9667,-6237.4203 838.259,-6218 917.1276,-6195.2388 1494.5314,-6083.4666 1551.1179,-6024 1602.5599,-5969.9398 1528.9682,-5906.7697 1587.1179,-5860 1714.1723,-5757.8105 1830.5055,-5779.3719 1952.9868,-5887 1999.633,-5927.9894 1943.3532,-5979.8862 1988.9868,-6022 2058.1529,-6085.8311 2103.5808,-6051.5211 2197.3169,-6060 2265.4087,-6066.1593 2288.1641,-6086.596 2351.1489,-6060 2372.2856,-6051.0748 2366.9904,-6033.9569 2387.1489,-6023 2393.504,-6019.5458 2400.5052,-6016.8325 2407.6446,-6014.7022"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2408.6306,-6018.0622 2417.4182,-6012.1437 2406.8578,-6011.2903 2408.6306,-6018.0622"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge659" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M920.1405,-6846C1251.8681,-6718.2038 2280.9114,-7498.5871 2445.236,-7625.6869"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2443.1692,-7628.5131 2453.2172,-7631.8729 2447.4575,-7622.9804 2443.1692,-7628.5131"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge711" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-4793C859.5682,-4767.1297 895.8153,-4781.3868 1002.022,-4731 1077.7276,-4695.0836 1114.1236,-4691.6493 1152.1868,-4617 1236.2931,-4452.0508 1102.2319,-3114.9935 1188.1868,-2951 1231.0976,-2869.1304 1310.2137,-2908.9399 1356.6204,-2829 1431.1355,-2700.6406 1345.7971,-2637.8411 1392.6204,-2497 1406.0173,-2456.7029 1559.9469,-2200.6355 1587.1179,-2168 1648.1956,-2094.6386 1693.8609,-2104.8258 1749.1377,-2027 1774.0846,-1991.8766 1751.8544,-1964.3536 1785.1377,-1937 2297.0716,-1516.2717 3226.266,-1947.2612 3406.2384,-2037.2639"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3404.8983,-2040.5077 3415.4041,-2041.878 3408.0458,-2034.2553 3404.8983,-2040.5077"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge804" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M582.7815,-11482C613.9626,-11481.5513 624.3672,-11480.6915 651.5354,-11496 672.0865,-11507.58 667.2566,-11522.9495 687.5354,-11535 808.567,-11606.9218 861.5655,-11582.6631 1002.022,-11573 1176.8591,-11560.9716 1218.1433,-11535.4455 1392.6204,-11519 1996.5254,-11462.0783 2329.3407,-11881.4775 2755.6838,-11450 2828.5234,-11376.2833 2744.5794,-10610.3088 2791.6838,-10518 2832.2427,-10438.5185 2909.5398,-10473.7407 2949.5867,-10394 2984.4546,-10324.5714 2978.4202,-9073.3612 2985.5867,-8996 3000.7012,-8832.8406 3038.9955,-8638.6225 3052.0357,-8575.1784"/>
<polygon fill="#003fff" stroke="#003fff" points="3055.5014,-8575.7017 3054.1009,-8565.1999 3048.6467,-8574.283 3055.5014,-8575.7017"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge833" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M582.7815,-6353C701.33,-6326.5912 721.8468,-6290.6317 838.259,-6256 847.9734,-6253.1101 1544.1254,-6107.3366 1551.1179,-6100 1617.3577,-6030.5013 1513.7901,-5948.9743 1587.1179,-5887 1642.1152,-5840.5181 1677.8422,-5876.8899 1749.1377,-5887 1842.5215,-5900.2423 1890.5943,-5875.2677 1952.9868,-5946 2020.8505,-6022.9348 1939.0035,-6084.4114 1988.9868,-6174 2038.1766,-6262.1663 2112.2443,-6233.7685 2161.3169,-6322 2212.0348,-6413.1899 2118.0786,-6486.109 2197.3169,-6554 2268.7779,-6615.2274 2390.4042,-6551.8937 2442.5374,-6519.5467"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2444.5768,-6522.3979 2451.1504,-6514.089 2440.83,-6516.4851 2444.5768,-6522.3979"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge881" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M582.7815,-4983C647.995,-4994.5049 1112.1825,-4859.7714 1152.1868,-4807 1244.1769,-4685.6517 1091.5419,-3554.6748 1188.1868,-3437 1236.8922,-3377.6962 1303.1959,-3454.0907 1356.6204,-3399 1415.2382,-3338.5539 1359.7978,-3290.5401 1392.6204,-3213 1422.3112,-3142.8583 1717.5978,-2686.2103 1785.1377,-2651 2172.926,-2448.8358 2413.4848,-2540.6951 2755.6838,-2813 2888.1949,-2918.4457 2902.6826,-2978.2794 2949.5867,-3141 3006.977,-3340.0998 3052.2694,-6721.0788 3056.1878,-7021.6777"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.6887,-7021.7785 3056.3184,-7031.7322 3059.6882,-7021.6876 3052.6887,-7021.7785"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14600C439.1995,-14636.2337 461.5919,-14574.1069 514.0276,-14557 649.6604,-14512.7504 1659.6681,-14317.1283 1749.1377,-14206 1789.7686,-14155.5331 1772.6053,-13687.5666 1785.1377,-13624 1829.9909,-13396.4963 1893.2745,-13354.0629 1952.9868,-13130 1956.8645,-13115.4495 2159.2271,-12080.9127 2161.3169,-12066 2187.44,-11879.5847 2171.3784,-11830.4411 2197.3169,-11644 2246.8482,-11287.978 2309.0328,-11206.9751 2351.1489,-10850 2394.2555,-10484.6304 2348.8433,-10388.904 2387.1489,-10023 2405.936,-9843.5421 2448.9462,-9629.5631 2462.9598,-9562.3053"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.4644,-9562.6461 2465.0905,-9552.1407 2459.6133,-9561.2099 2466.4644,-9562.6461"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.7133,-13831.1433C231.7272,-13917.8404 281.6571,-14484.1929 397.615,-14600"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M582.7815,-13384C610.0647,-13350.7377 878.5014,-13204.814 920.1405,-13194"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M223.8961,-13808.8073C225.5417,-13479.1069 263.5763,-5974.2605 317.2024,-5762 369.3819,-5555.465 372.3173,-5395.9279 582.7815,-5363"/>
<path fill="none" stroke="#48ff00" stroke-dasharray="5,2" d="M582.7815,-5363C751.3502,-5249.9444 974.1501,-5149.7919 1059.6351,-5112.9817"/>
<polygon fill="#48ff00" stroke="#48ff00" points="1061.0844,-5116.1685 1068.8959,-5109.0109 1058.3258,-5109.735 1061.0844,-5116.1685"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge535" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M397.615,-14980C440.9711,-15016.4868 458.607,-14939.8152 514.0276,-14928 573.7989,-14915.2572 591.6823,-14915.6467 651.5354,-14928 735.0886,-14945.2449 1307.612,-15162.1666 1356.6204,-15232 1433.096,-15340.9722 1357.547,-15701.5737 1392.6204,-15830 1442.6042,-16013.0233 1465.2139,-16064.6201 1587.1179,-16210 1727.6435,-16377.5875 1779.4593,-16431.3004 1988.9868,-16494 2062.3631,-16515.9573 2084.8834,-16498.911 2161.3169,-16494 2168.8982,-16493.5129 3241.3231,-16359.7593 3246.2772,-16354"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M224.1597,-13831.2172C227.0582,-13929.5011 250.2801,-14645.2807 317.2024,-14848 338.7372,-14913.2327 346.7943,-14933.7799 397.615,-14980"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge543" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M582.7815,-14068C680.453,-14064.2401 704.7737,-14061.1033 802.259,-14054 932.5036,-14044.5097 964.5258,-14028.2879 1095.1044,-14030"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacostestimate.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge548" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacostestimate.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M224.359,-13831.3222C229.1295,-13935.993 265.5676,-14745.9198 281.2024,-15403 282.2494,-15447.0043 290.9029,-18536.704 317.2024,-18572 321.0431,-18577.1545 325.9366,-18581.2759 331.4079,-18584.567"/>
<polygon fill="#4800ff" stroke="#4800ff" points="329.9054,-18587.7289 340.4132,-18589.0844 333.0442,-18581.4721 329.9054,-18587.7289"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge550" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M397.615,-18347C421.0073,-18384.0385 442.844,-18377.9009 478.0276,-18404 641.5958,-18525.3342 833.7536,-18677.9636 897.987,-18729.2653"/>
<polygon fill="#ff00da" stroke="#ff00da" points="896.1886,-18732.3085 906.1853,-18735.8179 900.559,-18726.8404 896.1886,-18732.3085"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-6353C676.9875,-5983.7586 942.266,-6152.6366 1356.6204,-5946 1452.401,-5898.2346 1491.8946,-5893.1519 1551.1179,-5804 1589.5327,-5746.1722 1532.6636,-5695.0637 1587.1179,-5652 1650.8903,-5601.5674 1892.2096,-5597.9954 1952.9868,-5652 2054.692,-5742.3718 1894.8816,-5857.7391 1988.9868,-5956 2015.8221,-5984.0203 2043.6208,-5947.3933 2075.1519,-5970"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8572,-13808.9195C224.2751,-13543.3292 233.1844,-8579.1414 317.2024,-7136 337.5347,-6786.761 169.7155,-6618.4112 397.615,-6353"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M397.615,-16504C402.6382,-16510.4583 679.3857,-16555.2749 687.5354,-16556 738.3231,-16560.5186 751.3598,-16559.0119 802.259,-16556 854.9269,-16552.8834 868.0623,-16550.4542 920.1405,-16542"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.532,-13831.2204C227.5884,-13871.1282 243.2527,-14007.7625 317.2024,-14082 382.8322,-14147.8852 425.6256,-14124.1345 514.0276,-14153 656.7718,-14199.6096 689.6202,-14226.6727 838.259,-14248 1142.4387,-14291.645 1677.2165,-14241.8398 1749.1377,-14163 1780.3899,-14128.7414 1778.3168,-12539.8675 1785.1377,-12494 1876.1248,-11882.1499 2075.2832,-11766.5662 2161.3169,-11154 2212.9792,-10786.1604 2118.8139,-4831.0596 2197.3169,-4468 2209.9178,-4409.7235 2243.5676,-4347.2377 2261.9044,-4316.08"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2265.1409,-4317.4877 2267.2737,-4307.1097 2259.1346,-4313.8925 2265.1409,-4317.4877"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1869.0623,-6998C1903.6807,-6980.4894 1929.0845,-7004.5571 1952.9868,-6974 1987.8535,-6929.4259 1977.2863,-6011.3681 1988.9868,-5956 2004.7941,-5881.1981 2044.6478,-5798.9164 2064.1118,-5761.5232"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2067.4543,-5762.6882 2069.024,-5752.2103 2061.2628,-5759.4224 2067.4543,-5762.6882"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-6998C804.4199,-6972.3751 787.2699,-6925.9963 838.259,-6886 870.1267,-6861.0028 883.1242,-6862.4378 920.1405,-6846"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-7150C656.1332,-7145.1572 628.5987,-7065.9362 687.5354,-7022 709.6919,-7005.4827 719.5139,-7008.9277 744.8972,-6998"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-7150C438.0383,-7078.3158 500.664,-7155.4215 582.7815,-7150"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-6846C1257.8156,-6696.0491 1412.7095,-6755.2722 1749.1377,-6908 1809.8176,-6935.5468 1809.5968,-7028.0786 1869.0623,-6998"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M397.615,-5859C431.4832,-5819.3947 462.1495,-5868.0708 514.0276,-5873 759.1796,-5896.2929 1049.8283,-5913.786 1189.4313,-5921.5603"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="1189.4466,-5925.0664 1199.6251,-5922.1256 1189.8343,-5918.0772 1189.4466,-5925.0664"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-6505C937.1941,-6438.6301 987.9382,-6583.1732 1188.1868,-6619 1278.0966,-6635.0859 1301.5764,-6632.6838 1392.6204,-6640 1453.7503,-6644.9123 1611.9553,-6631.3899 1668.1278,-6656"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-6998C770.0101,-6986.4644 778.9772,-7007.1108 802.259,-7022 921.9813,-7098.5647 923.7411,-7153.5282 1038.022,-7238 1179.2242,-7342.3709 1366.1122,-7440.0293 1439.9267,-7477.1881"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.6628,-7480.4696 1449.1709,-7481.8224 1441.7999,-7474.2119 1438.6628,-7480.4696"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14600C506.8262,-14709.0692 592.4536,-14575.8311 744.8972,-14600"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-14562C1396.6987,-14553.0773 1542.0442,-14599.4334 1749.1377,-14380 1800.9531,-14325.0971 1757.6878,-14284.3254 1785.1377,-14214 1838.7284,-14076.7033 1884.073,-14058.2813 1952.9868,-13928 1970.4628,-13894.9617 1972.5918,-13885.5878 1988.9868,-13852 2161.8076,-13497.9489 2149.4238,-13374.175 2387.1489,-13060 2445.5418,-12982.8286 2507.7471,-13001.1055 2547.7793,-12913 2583.3184,-12834.7832 2576.3594,-11452.5912 2583.7793,-11367 2602.4826,-11151.2507 2650.9796,-10892.9747 2665.5388,-10818.2183"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2669.0161,-10818.6733 2667.504,-10808.1869 2662.1467,-10817.3275 2669.0161,-10818.6733"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-14600C787.5678,-14603.8419 796.3613,-14584.9512 838.259,-14576 874.3641,-14568.2864 883.2681,-14560.1289 920.1405,-14562"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-14562C997.8023,-14565.941 1017.36,-14560.3564 1095.1044,-14562"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M744.8972,-14600C1033.53,-14625.9873 1104.491,-14643.9236 1392.6204,-14675 1641.4694,-14701.8398 1705.5642,-14693.2072 1952.9868,-14731 2046.4457,-14745.2755 2099.7932,-14702.2143 2161.3169,-14774 2265.7112,-14895.8072 2098.8343,-15368.3653 2197.3169,-15495 2353.0851,-15695.2959 2528.6785,-15727.361 2755.6838,-15614 3003.4023,-15490.2953 3028.9059,-15372.8012 3127.3396,-15114 3219.4153,-14871.9153 3242.5277,-14011.9016 3245.8302,-13865.3192"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3249.3362,-13865.0807 3246.0559,-13855.0064 3242.3378,-13864.9274 3249.3362,-13865.0807"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge432" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-13840C1013.1151,-13836.9478 1211.797,-13855.8236 1272.4036,-13912"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1272.4036,-13912C1301.371,-13937.163 1330.3789,-13903.0058 1356.6204,-13931 1426.4803,-14005.5262 1331.5776,-14076.0955 1392.6204,-14158 1439.3052,-14220.6397 1483.6455,-14194.6213 1551.1179,-14234 1836.7772,-14400.7186 1938.2379,-14415.8032 2161.3169,-14660 2183.0676,-14683.8098 2169.4244,-14706.8133 2197.3169,-14723 2422.2506,-14853.5341 2588.0873,-14746.861 2755.6838,-14548 2901.0414,-14375.5266 2904.4195,-14299.9883 2949.5867,-14079 2967.4932,-13991.389 2933.5245,-10932.704 2985.5867,-10860 2987.8467,-10856.844 2990.5386,-10854.0838 2993.5315,-10851.6702"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6352,-10854.4758 3002.067,-10846.0566 2991.7887,-10848.6273 2995.6352,-10854.4758"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge439" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-7150C680.4634,-7140.1589 708.7748,-7095.0118 802.259,-7125 852.4577,-7141.1029 1143.5493,-7372.9516 1188.1868,-7401 1275.9079,-7456.1204 1301.0549,-7464.5333 1392.6204,-7513 1462.539,-7550.0088 1508.0823,-7527.6208 1551.1179,-7594 1634.7658,-7723.0207 1538.9894,-8138.9625 1587.1179,-8285 1645.5918,-8462.4288 1798.7225,-8636.2879 1851.1517,-8692.328"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1848.7249,-8694.856 1858.1332,-8699.7278 1853.8164,-8690.0522 1848.7249,-8694.856"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge488" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-14562C1105.2064,-14571.3912 1582.1197,-14732.2657 1749.1377,-14652 1789.4746,-14632.6148 2740.6179,-13436.1411 2755.6838,-13394 2784.0013,-13314.7927 2741.5838,-10433.5697 2791.6838,-10366 2794.004,-10362.8709 2796.7173,-10360.1241 2799.7147,-10357.7137"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.8199,-10360.5178 2808.2372,-10352.0876 2797.9634,-10354.6759 2801.8199,-10360.5178"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge503" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M920.1405,-13840C1210.4213,-13779.6772 1290.7677,-13843.1501 1587.1179,-13852 1659.0946,-13854.1494 1697.0135,-13901.6823 1749.1377,-13852 1809.5288,-13794.4382 1768.7155,-13183.797 1785.1377,-13102 1881.5614,-12621.7248 2055.9919,-12544.402 2161.3169,-12066 2201.7898,-11882.1658 2158.7086,-11828.2349 2197.3169,-11644 2240.8411,-11436.3069 2310.9262,-11400.3576 2351.1489,-11192 2379.5793,-11044.7278 2333.9482,-10658.2393 2387.1489,-10518 2399.7898,-10484.6781 2427.7344,-10453.7679 2447.0815,-10435.1395"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.6213,-10437.5561 2454.5261,-10428.165 2444.8354,-10432.4477 2449.6213,-10437.5561"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M744.8972,-13840C814.5732,-13805.1939 842.2965,-13842.5555 920.1405,-13840"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14600C412.5771,-14611.8634 1736.4393,-14362.2603 1749.1377,-14348 1826.7586,-14260.8317 1743.8824,-13933.1848 1785.1377,-13824 1828.4834,-13709.2828 1893.7106,-13712.3555 1952.9868,-13605 2103.9755,-13331.5437 1959.3583,-13148.3652 2197.3169,-12946 2213.4214,-12932.3044 2336.3026,-12912.2239 2410.6758,-12901.1257"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2411.4531,-12904.5489 2420.8321,-12899.621 2410.4271,-12897.6245 2411.4531,-12904.5489"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-5859C459.5185,-5777.1654 739.2506,-5747.9494 838.259,-5721 910.3534,-5701.3764 945.8499,-5732.2684 1002.022,-5683 1036.2798,-5652.9526 1006.5721,-5619.975 1038.022,-5587 1144.4026,-5475.4609 1268.2318,-5576.2746 1356.6204,-5450 1437.5427,-5334.3918 1326.9099,-4940.8832 1392.6204,-4816 1485.9295,-4638.6653 1639.2964,-4707.598 1749.1377,-4540 1784.8265,-4485.5453 1733.7532,-4437.9831 1785.1377,-4398 1844.0134,-4352.1879 1896.0658,-4349.7807 1952.9868,-4398 2027.2471,-4460.9079 1922.3424,-4543.0738 1988.9868,-4614 2048.4576,-4677.2917 2155.607,-4685.4988 2220.3005,-4683.9571"/>
<polygon fill="#00ffff" stroke="#00ffff" points="2220.4237,-4687.4551 2230.3051,-4683.633 2220.197,-4680.4588 2220.4237,-4687.4551"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14068C468.8197,-14103.0403 350.3876,-14188.9702 1471.8691,-14144"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-14144C1506.1058,-14142.3709 1543.7397,-14141.8677 1576.8145,-14141.8571"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1576.9199,-14145.3572 1586.924,-14141.8689 1576.9281,-14138.3572 1576.9199,-14145.3572"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M397.615,-5859C423.9139,-5823.9655 449.4159,-5835.1726 478.0276,-5802 501.1355,-5775.2086 485.6068,-5752.0716 514.0276,-5731 558.2548,-5698.2091 960.8385,-5681.5406 1002.022,-5645 1043.3542,-5608.3274 1017.1741,-5577.1723 1038.022,-5526 1153.7197,-5242.0134 1261.5092,-5205.5274 1356.6204,-4914 1389.6655,-4812.7126 1339.6524,-4769.4419 1392.6204,-4677 1504.2416,-4482.194 1573.5054,-4433.9696 1785.1377,-4359 1855.4556,-4334.0903 1879.7428,-4344.8434 1952.9868,-4359 2066.2675,-4380.8949 2190.3018,-4442.4945 2245.2586,-4471.9375"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2243.9323,-4475.1992 2254.3933,-4476.8775 2247.2622,-4469.0419 2243.9323,-4475.1992"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.8742,-13808.7455C224.7947,-13504.9771 244.8957,-7147.1696 317.2024,-6339 336.4782,-6123.5544 264.6647,-6029.6241 397.615,-5859"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-16504C421.034,-16532.2865 449.17,-16500.2884 478.0276,-16523 505.8299,-16544.8811 496.0359,-16563.536 514.0276,-16594 531.3328,-16623.3016 553.9498,-16655.5432 568.4249,-16675.5324"/>
<polygon fill="#00ffff" stroke="#00ffff" points="565.734,-16677.7826 574.4543,-16683.7998 571.3897,-16673.6579 565.734,-16677.7826"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M224.1874,-13831.1791C229.9205,-14014.5357 306.0003,-16393.3439 397.615,-16504"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M397.615,-16504C407.1265,-16515.4885 600.097,-16465.7755 694.1859,-16440.6978"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="695.3057,-16444.0215 704.0634,-16438.0588 693.4988,-16437.2587 695.3057,-16444.0215"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-14790C600.9545,-14802.9281 1340.4027,-14988.6905 1356.6204,-15004 1392.8002,-15038.1537 1368.5751,-15066.4422 1392.6204,-15110 1459.5453,-15231.2338 1660.1265,-15534.4284 1785.1377,-15594 1852.4819,-15626.0915 1886.6369,-15628.0997 1952.9868,-15594 2094.4573,-15521.2929 2106.0628,-15452.155 2161.3169,-15303 2224.3991,-15132.7137 2120.6729,-15060.6284 2197.3169,-14896 2328.8251,-14613.5253 2581.9461,-14676.965 2669.7316,-14378"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-14600C460.6534,-14664.3913 442.1568,-14711.6432 514.0276,-14766 539.8416,-14785.5234 557.4556,-14769.8474 582.7815,-14790"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-14378C2680.7193,-14339.8901 2731.1498,-14385.1637 2755.6838,-14354 2790.6896,-14309.5351 2786.4277,-13392.3463 2791.6838,-13336 2809.8777,-13140.9602 2853.0201,-12907.6488 2866.5222,-12837.1674"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2869.9711,-12837.766 2868.4263,-12827.2844 2863.0976,-12836.4416 2869.9711,-12837.766"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-14790C606.7965,-14809.1095 661.3794,-14863.9452 687.5354,-14880 961.6875,-15048.2774 1159.4874,-14901.8046 1356.6204,-15156 1427.0325,-15246.7938 1360.0286,-15301.8221 1392.6204,-15412 1450.7436,-15608.488 1469.6536,-15662.1073 1587.1179,-15830 1645.4932,-15913.4362 1688.3717,-15910.2886 1749.1377,-15992 1816.2915,-16082.3009 1892.3899,-16380.2685 1988.9868,-16438 2054.7311,-16477.2923 2102.8763,-16487.5066 2161.3169,-16438 2235.5772,-16375.0921 2160.4089,-16312.0544 2197.3169,-16222 2417.771,-15684.0988 2757.6688,-15700.7306 2949.5867,-15152 2993.5379,-15026.3348 2974.9726,-14686.7057 2985.5867,-14554 3007.3735,-14281.6036 3044.2407,-13951.4597 3054.0214,-13865.3532"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3057.5169,-13865.5901 3055.1711,-13855.2583 3050.5619,-13864.7979 3057.5169,-13865.5901"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-13650C1022.72,-13634.9216 1049.3085,-13661.1166 1152.1868,-13674 1346.0568,-13698.2783 1392.2547,-13723.7397 1587.1179,-13738 1658.9347,-13743.2556 1690.6843,-13780.0532 1749.1377,-13738 1980.4921,-13571.5564 1888.2865,-13407.5648 1952.9868,-13130 1980.0696,-13013.8147 1949.2938,-12976.5031 1988.9868,-12864 2038.2363,-12724.4108 2112.3054,-12718.6729 2161.3169,-12579 2201.8392,-12463.5196 2119.0547,-12400.0893 2197.3169,-12306 2202.8025,-12299.405 2210.0505,-12294.5339 2217.9072,-12290.9396"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2219.2837,-12294.1598 2227.3407,-12287.2798 2216.7518,-12287.6337 2219.2837,-12294.1598"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-13650C982.2226,-13627.848 975.5786,-13581.1122 1038.022,-13560 1086.0889,-13543.7485 1108.0329,-13535.0005 1152.1868,-13560 1179.2486,-13575.3221 1163.6092,-13600.946 1188.1868,-13620 1195.7014,-13625.8258 1204.5506,-13630.2968 1213.6387,-13633.7273"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.5558,-13637.0557 1223.15,-13636.9387 1214.7952,-13630.4235 1212.5558,-13637.0557"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-13564C410.1835,-13556.3572 906.0228,-13654.1318 920.1405,-13650"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M397.615,-14600C759.3328,-14878.0074 1014.9175,-14663.7302 1356.6204,-14966 1382.2334,-14988.6573 1367.6069,-15010.6824 1392.6204,-15034 1604.6446,-15231.6493 1705.3958,-15238.0362 1988.9868,-15298 2063.9212,-15313.8445 2106.8076,-15351.8047 2161.3169,-15298 2216.0229,-15244.0011 2180.7852,-12606.0689 2197.3169,-12531 2210.1399,-12472.772 2243.6955,-12410.2656 2261.9596,-12379.0921"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2265.1953,-12380.4993 2267.3066,-12370.1169 2259.1816,-12376.9166 2265.1953,-12380.4993"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge462" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-14562C1385.9815,-14562 1498.6413,-14685.8548 1749.1377,-14538 1787.4268,-14515.4 2140.0984,-13891.0716 2161.3169,-13852 2348.2352,-13507.809 2445.8147,-13438.1654 2547.7793,-13060 2637.5471,-12727.07 2665.5915,-11578.516 2669.2917,-11408.1832"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.7945,-11408.0855 2669.5087,-11398.0131 2665.7961,-11407.9361 2672.7945,-11408.0855"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge593" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-10456C792.6962,-10424.2424 948.6661,-10453.1291 1002.022,-10432 1020.8679,-10424.537 1018.8493,-10410.5783 1038.022,-10404 1086.0155,-10387.5331 1101.5321,-10401.0604 1152.1868,-10404 1205.8872,-10407.1163 1218.9863,-10411.6721 1272.4036,-10418"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge696" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-4983C632.9671,-4989.9991 642.1762,-4960.5859 687.5354,-4938 752.5286,-4905.6377 771.238,-4902.9215 838.259,-4875 911.0071,-4844.6925 930.4219,-4839.9281 1002.022,-4807 1069.9806,-4775.7466 1112.1772,-4794.2012 1152.1868,-4731 1192.6142,-4667.1387 1170.2063,-3444.4122 1188.1868,-3371 1271.4514,-3031.0396 1342.9086,-2942.7348 1587.1179,-2692 1651.1475,-2626.2595 1701.0608,-2642.1679 1749.1377,-2564 1791.194,-2495.6208 1743.2823,-2455.5024 1785.1377,-2387 2038.8799,-1971.714 2485.5426,-1945.4244 2870.6353,-2243"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-4831C470.8638,-4753.7276 478.4258,-4961.8741 582.7815,-4983"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2870.6353,-2243C2899.5732,-2263.7987 2920.3483,-2236.6258 2949.5867,-2257 3077.9977,-2346.4809 3082.717,-2410.9832 3127.3396,-2561 3199.5842,-2803.8796 3241.232,-4734.2242 3245.8473,-4958.7236"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.351,-4958.9424 3246.0545,-4968.8688 3249.3495,-4958.7994 3242.351,-4958.9424"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge701" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-4223C615.1695,-4226.7451 651.4411,-4227.1009 681.4498,-4226.3678"/>
<polygon fill="#00ffff" stroke="#00ffff" points="681.8925,-4229.8565 691.7864,-4226.0669 681.6887,-4222.8594 681.8925,-4229.8565"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge669" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-6846C972.3019,-6826.5302 1322.1937,-6979.2804 1749.1377,-7250 1785.5055,-7273.0604 1824.7372,-7304.1327 1848.0813,-7323.3511"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1845.9964,-7326.1691 1855.9282,-7329.8585 1850.4649,-7320.7808 1845.9964,-7326.1691"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge775" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-11482C417.2263,-11402.0746 500.4978,-11480.5623 582.7815,-11482"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-11482C743.1337,-11484.8017 915.2287,-11025.1625 1038.022,-10922 1245.7935,-10747.4446 1321.6171,-10711.106 1587.1179,-10655 1746.3464,-10621.3516 1819.38,-10547.0744 1952.9868,-10640 1990.7381,-10666.2566 1951.2355,-10710.7434 1988.9868,-10737 2051.8649,-10780.7327 2104.3307,-10788.174 2161.3169,-10737 2216.8604,-10687.1215 2153.5106,-10463.4479 2197.3169,-10403 2357.0845,-10182.5386 2605.413,-10378.0409 2755.6838,-10151 2804.7564,-10076.8574 2734.6322,-8619.1934 2791.6838,-8551 2797.6151,-8543.9104 2805.7463,-8539.415 2814.5462,-8536.647"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2815.3943,-8540.0428 2824.2849,-8534.2802 2813.7412,-8533.2408 2815.3943,-8540.0428"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge791" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-13574C790.9708,-13558.4435 997.8474,-13276.4005 1038.022,-13249 1082.8152,-13218.4494 1117.7945,-13247.9159 1152.1868,-13206 1214.4771,-13130.0831 1139.7961,-13073.4505 1188.1868,-12988 1236.5769,-12902.5504 1298.4689,-12924.1305 1356.6204,-12845 1380.9151,-12811.9406 1364.6706,-12790.0329 1392.6204,-12760 1446.5145,-12702.089 1507.6913,-12745.1241 1551.1179,-12679 1619.9374,-12574.2113 1509.4971,-12214.4469 1587.1179,-12116 1593.9556,-12107.3277 1603.7441,-12101.5915 1614.1663,-12097.8151"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.3006,-12101.1285 1623.8494,-12094.87 1613.2636,-12094.4314 1615.3006,-12101.1285"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-13564C523.2188,-13474.1855 595.5793,-13613.3333 744.8972,-13574"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge741" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-6353C489.492,-6246.0002 556.2964,-6275.6398 687.5354,-6224 980.1484,-6108.8628 1070.6269,-6124.7161 1356.6204,-5994 1447.5467,-5952.4412 1485.9067,-5956.7775 1551.1179,-5881 1579.4885,-5848.0324 1551.1481,-5814.4524 1587.1179,-5790 1608.2439,-5775.6385 1937.5266,-5779.9884 1952.9868,-5793 2019.0784,-5848.6239 1928.4335,-5922.3931 1988.9868,-5984 1997.2709,-5992.4282 2185.5602,-6025.7993 2197.3169,-6027 2265.3329,-6033.9462 2295.9408,-6067.3298 2351.1489,-6027 2409.1647,-5984.6192 2531.157,-5480.8975 2547.7793,-5411 2558.8787,-5364.3267 2549.4921,-5237.0058 2582.748,-5188.1507"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2585.5989,-5190.1931 2589.2131,-5180.2337 2580.177,-5185.7655 2585.5989,-5190.1931"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge754" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M397.615,-7150C422.5975,-7105.6976 773.4537,-7322.0825 802.259,-7364 878.0649,-7474.3129 793.5354,-7536.8443 838.259,-7663 882.0334,-7786.4781 1113.2317,-8036.9178 1152.1868,-8162 1180.3279,-8252.3594 1127.7314,-8940.1858 1188.1868,-9013 1386.3305,-9251.6499 2339.1909,-9099.423 2547.7793,-9329 2587.5957,-9372.8228 2575.1082,-9534.4288 2583.7793,-9593 2613.5609,-9794.1683 2653.9434,-10036.9045 2666.1151,-10109.4992"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2662.713,-10110.3744 2667.8204,-10119.6569 2669.6164,-10109.2154 2662.713,-10110.3744"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge764" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-5363C669.8626,-5306.1844 706.1099,-5321.5789 802.259,-5282 892.476,-5244.863 913.7518,-5232.5529 1002.022,-5191 1069.1629,-5159.3937 1108.8137,-5178.2132 1152.1868,-5118 1224.2325,-5017.9816 1157.8068,-4962.4627 1188.1868,-4843 1239.4875,-4641.2714 1300.4132,-4606.417 1356.6204,-4406 1380.8909,-4319.4589 1352.1502,-4287.2533 1392.6204,-4207 1449.9223,-4093.3691 1668.313,-3840.4726 1785.1377,-3790 1853.6193,-3760.4134 1881.5881,-3768.3822 1952.9868,-3790 1971.3913,-3795.5724 1971.5496,-3805.893 1988.9868,-3814 1997.991,-3818.1863 2007.854,-3821.8379 2017.5898,-3824.9616"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2016.6603,-3828.3372 2027.2465,-3827.9095 2018.7042,-3821.6422 2016.6603,-3828.3372"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge783" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datagenerators.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-6467C633.7223,-6476.7397 690.2348,-6446.9676 721.2619,-6426.8543"/>
<polygon fill="#ff0000" stroke="#ff0000" points="723.3085,-6429.6962 729.6753,-6421.2277 719.4171,-6423.8775 723.3085,-6429.6962"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-6353C437.0742,-6300.8475 456.5412,-6411.8195 514.0276,-6443 542.4776,-6458.4312 550.9918,-6460.9219 582.7815,-6467"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge845" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-6467C679.9435,-6485.5771 706.4967,-6454.802 802.259,-6430 806.2119,-6428.9762 1352.8978,-6235.6779 1356.6204,-6234 1373.3069,-6226.4787 1375.5636,-6220.6393 1392.6204,-6214 1460.1262,-6187.7234 1501.8957,-6229.1477 1551.1179,-6176 1619.9314,-6101.6986 1510.0584,-6016.7102 1587.1179,-5951 1614.5143,-5927.6386 1721.87,-5927.4886 1749.1377,-5951 1831.4907,-6022.0083 1715.4567,-6109.5209 1785.1377,-6193 1835.623,-6253.4823 1902.5731,-6189.4579 1952.9868,-6250 2023.6943,-6334.913 1934.758,-6399.7243 1988.9868,-6496 2047.9135,-6600.6161 2091.7336,-6610.8245 2197.3169,-6668 2228.8066,-6685.0523 2248.9977,-6666.592 2274.2329,-6692"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge976" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~tarcogcomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.1447,-13831.3764C226.2768,-13903.2252 241.2101,-14301.0865 317.2024,-14614 335.0103,-14687.3275 370.7201,-14769.7733 387.919,-14807.3485"/>
<polygon fill="#ff0000" stroke="#ff0000" points="384.8748,-14809.1043 392.2489,-14816.7118 391.2284,-14806.1663 384.8748,-14809.1043"/>
</g>
<!-- sourcefile~windowcomplexmanager.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1034" class="edge">
<title>sourcefile~windowcomplexmanager.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.3154,-14952.1799C2077.6128,-15105.0194 2104.7641,-16781.1216 2197.3169,-17266 2298.2553,-17794.81 2238.205,-18001.1962 2583.7793,-18414 2651.4242,-18494.8048 2691.9921,-18493.8417 2791.6838,-18528 2906.123,-18567.2114 3239.929,-18532.3796 3329.2148,-18614 3377.2695,-18657.929 3317.8009,-18711.3801 3365.2148,-18756 3403.3964,-18791.9316 4241.5955,-18944.9552 4292.3998,-18932"/>
</g>
<!-- sourcefile~windowcomplexmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge948" class="edge">
<title>sourcefile~windowcomplexmanager.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3436.8809,-17988C3512.4569,-17995.4603 3533.4666,-17972.2245 3607.7534,-17988"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M2075.5155,-14952.247C2080.6302,-15109.3528 2138.8716,-16862.9513 2197.3169,-17083 2245.8817,-17265.8483 2260.9727,-17323.0334 2387.1489,-17464 2598.2346,-17699.8292 2698.5364,-17716.6781 2985.5867,-17850 3080.7,-17894.1759 3332.5165,-17977.698 3436.8809,-17988"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1035" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~solarshading.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-7036C760.8788,-7007.1646 1005.322,-6994.1956 1038.022,-6990 1104.5487,-6981.4641 1121.4281,-6981.4766 1188.1868,-6975 1230.6641,-6970.879 1924.058,-6934.3756 1952.9868,-6903 2006.1089,-6845.3848 1963.1967,-4156.0023 1988.9868,-4082 2030.2077,-3963.7204 2118.3012,-3976.6387 2161.3169,-3859 2224.9471,-3684.9847 2161.7103,-3207.8304 2197.3169,-3026 2236.3227,-2826.8106 2293.0473,-2790.479 2351.1489,-2596 2370.6507,-2530.7232 2360.4761,-2509.6892 2387.1489,-2447 2439.149,-2324.7842 2498.2791,-2318.2495 2547.7793,-2195 2578.3475,-2118.8889 2545.7473,-2086.6696 2583.7793,-2014 2634.7765,-1916.5571 2687.9896,-1922.6794 2755.6838,-1836 2966.2698,-1566.3543 2932.7211,-1435.7258 3163.3396,-1183 3400.6141,-922.9801 3447.7576,-766.934 3794.094,-704"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3972.2545,-1121C4025.0956,-995.8817 3988.6633,-852.7968 4124.4445,-856"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M583.0594,-9190.6707C586.9765,-9032.5047 631.8271,-7269.9825 687.5354,-7178 765.7103,-7048.9218 860.7744,-7103.1189 1002.022,-7050 1018.9558,-7043.6317 1021.2569,-7037.8 1038.022,-7031 1102.4685,-7004.8603 1119.7129,-6999.1639 1188.1868,-6987 1230.1136,-6979.552 1923.5908,-6966.8092 1952.9868,-6936 1988.1232,-6899.1745 1984.2424,-5154.6771 1988.9868,-5104 2031.924,-4645.3711 2107.3175,-4539.4583 2161.3169,-4082 2188.9423,-3847.9699 2147.5379,-3783.3373 2197.3169,-3553 2276.9982,-3184.2984 2569.021,-2267.4852 2791.6838,-1963 2844.3559,-1890.9724 2883.8242,-1899.3127 2949.5867,-1839 3034.8098,-1760.8394 3064.3193,-1745.9562 3127.3396,-1649 3149.6982,-1614.6015 3140.407,-1598.0184 3163.3396,-1564 3297.2353,-1365.378 3335.197,-1299.4104 3544.5469,-1183 3609.337,-1146.973 3633.7741,-1156.8128 3706.96,-1145 3736.1793,-1140.2837 3960.7394,-1148.2657 3972.2545,-1121"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M585.2128,-9213.3244C595.7362,-9262.9703 637.4615,-9466.4635 651.5354,-9636 690.3093,-10103.0771 636.7543,-13388.0754 687.5354,-13854 714.2136,-14098.7765 773.086,-14151.5083 802.259,-14396 835.0261,-14670.6122 775.0755,-15370.7541 838.259,-15640 890.8873,-15864.2664 1037.9745,-16107.2445 1082.3014,-16177.1713"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1079.523,-16179.3237 1087.8537,-16185.8698 1085.4235,-16175.5574 1079.523,-16179.3237"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.2081,-9213.3248C595.712,-9262.9723 637.3677,-9466.4713 651.5354,-9636 668.8123,-9842.7334 630.9168,-13170.4216 687.5354,-13370 714.4575,-13464.8993 770.9616,-13466.4525 802.259,-13560 827.0663,-13634.1484 794.7516,-13845.0348 838.259,-13910 861.2476,-13944.3265 888.3791,-13927.5805 920.1405,-13954"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-13954C949.7126,-13979.9511 1255.3433,-13954.547 1272.4036,-13990"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M744.8972,-13232C760.4125,-13256.1371 973.5209,-13252.6814 1002.022,-13256 1010.2929,-13256.9631 1018.9651,-13258.0587 1027.55,-13259.1959"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1027.1807,-13262.6777 1037.5585,-13260.5444 1028.1155,-13255.7404 1027.1807,-13262.6777"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge950" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3972.2545,-17856C4014.8375,-17841.1821 4062.2552,-17819.8044 4092.6686,-17805.432"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4094.3931,-17808.4875 4101.9179,-17801.029 4091.3843,-17802.1671 4094.3931,-17808.4875"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M744.8972,-9430C774.8199,-9466.8852 794.4505,-9463.6507 838.259,-9482 908.216,-9511.3015 954.4198,-9470.9527 1002.022,-9530 1072.4944,-9617.4164 999.9916,-9928.3511 1038.022,-10034 1052.8157,-10075.0972 1063.4524,-10083.9005 1095.1044,-10114"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1095.1044,-10114C1165.1718,-10180.6308 1880.0063,-10196.5732 1952.9868,-10260 1992.7708,-10294.576 1955.529,-10332.2711 1988.9868,-10373 2044.5018,-10440.5796 2114.827,-10393.9216 2161.3169,-10468 2200.7693,-10530.8646 2187.8454,-11061.3879 2197.3169,-11135 2204.1449,-11188.0672 2563.0015,-12972.6945 2583.7793,-13022 2667.3876,-13220.4019 3062.3911,-13618.731 3127.3396,-13824 3197.3366,-14045.2248 3137.1034,-15681.4536 3163.3396,-15912 3234.7056,-16539.1171 3225.9016,-16735.1751 3544.5469,-17280 3668.8606,-17492.5536 3737.8569,-17519.806 3881.228,-17720 3923.5772,-17779.1336 3903.5607,-17879.9039 3972.2545,-17856"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge958" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M586.5361,-9213.2293C598.6552,-9250.0705 636.7986,-9370.813 651.5354,-9474 714.1613,-9912.5063 667.0007,-10027.5205 687.5354,-10470 706.013,-10868.153 736.6966,-11353.9544 743.5235,-11460.6394"/>
<polygon fill="#9900ff" stroke="#9900ff" points="740.0402,-11461.0132 744.173,-11470.7687 747.0258,-11460.5652 740.0402,-11461.0132"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge991" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M744.8972,-10266C833.7041,-10360.5225 917.9021,-10305.2832 1002.022,-10404 1033.7466,-10441.2296 1021.0299,-10462.1332 1038.022,-10508 1101.1078,-10678.2875 1094.5261,-10732.4193 1188.1868,-10888 1386.0402,-11216.6562 1614.2498,-11184.8814 1749.1377,-11544 1812.1797,-11711.8399 1720.7445,-14603.6738 1785.1377,-14771 1805.372,-14823.5791 1834.9295,-14821.1787 1869.0623,-14866"/>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1869.0623,-14866C1897.757,-14903.6441 1947.1824,-14922.4137 1990.4377,-14931.7631"/>
<polygon fill="#ff0066" stroke="#ff0066" points="1989.9255,-14935.2303 2000.4208,-14933.7809 1991.3124,-14928.369 1989.9255,-14935.2303"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-9430C793.9655,-9490.4857 852.1849,-9391.9441 920.1405,-9430"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-9430C953.0604,-9448.4355 1549.5569,-9554.4284 1587.1179,-9558 1658.8034,-9564.8164 1678.682,-9572.8748 1749.1377,-9558 1782.563,-9550.9432 1818.0133,-9533.9453 1841.6268,-9521.0874"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1843.3373,-9524.141 1850.3722,-9516.2188 1839.9324,-9518.0249 1843.3373,-9524.141"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M582.8719,-9190.8915C584.1944,-9035.7283 600.8603,-7304.066 687.5354,-7098 702.0903,-7063.3963 726.577,-7068.7663 744.8972,-7036"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M744.8972,-7036C758.3839,-7011.8787 784.7541,-7033.3847 802.259,-7012 853.9361,-6948.8693 794.9876,-6901.1634 838.259,-6832 1049.3555,-6494.5914 1314.6652,-6610.1505 1551.1179,-6290 1622.9353,-6192.7613 1654.7523,-6046.7916 1664.5895,-5992.4157"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1668.0917,-5992.7059 1666.3615,-5982.2532 1661.1957,-5991.5034 1668.0917,-5992.7059"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1272.4036,-9849C1309.8127,-9840.0754 1352.3038,-9838.8942 1388.4271,-9840.4175"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1388.276,-9843.9142 1398.4373,-9840.9147 1388.6233,-9836.9228 1388.276,-9843.9142"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-7986C788.4807,-7930.6955 779.1787,-7896.3095 838.259,-7858 886.1706,-7826.9327 1256.8085,-7760.1985 1407.9862,-7733.9375"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1408.7977,-7737.3491 1418.0529,-7732.1923 1407.602,-7730.452 1408.7977,-7737.3491"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M744.8972,-7986C775.8296,-7947.6129 1116.7941,-8127.6818 1152.1868,-8162 1176.1748,-8185.2598 1164.18,-8204.7595 1188.1868,-8228 1256.8801,-8294.5005 1362.6188,-8336.5093 1423.7347,-8356.703"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1422.9207,-8360.1184 1433.5127,-8359.8732 1425.0796,-8353.4596 1422.9207,-8360.1184"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.8589,-9190.8795C583.9586,-9042.2173 597.7922,-7445.6667 687.5354,-6984 777.4814,-6521.2898 836.2008,-6408.9803 1038.022,-5983 1079.714,-5895.0013 1118.4559,-5887.3467 1152.1868,-5796 1187.1153,-5701.4098 1119.9815,-5646.2654 1188.1868,-5572 1190.2412,-5569.763 1192.4943,-5567.7481 1194.9019,-5565.9341"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1196.9774,-5568.7649 1203.6192,-5560.5104 1193.2795,-5562.8214 1196.9774,-5568.7649"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M920.1405,-9202C1009.5088,-9187.8098 961.7122,-9084.63 1038.022,-9036 1085.4949,-9005.7469 1148.7195,-8995.5061 1197.5386,-8992.5506"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1197.9199,-8996.0357 1207.7266,-8992.0259 1197.5598,-8989.045 1197.9199,-8996.0357"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M632.4843,-9205.965C698.5105,-9210.3285 818.6352,-9215.1205 920.1405,-9202"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge911" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-1939C3512.7768,-1941.6844 3532.6886,-1927.482 3607.7534,-1939"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-7224C1181.384,-7182.9364 1885.5607,-7231.7061 1952.9868,-7164 2053.9728,-7062.5946 1897.7691,-6631.2749 1988.9868,-6521 2039.3016,-6460.1735 2103.8125,-6532.0804 2161.3169,-6478 2200.0222,-6441.5993 2158.5688,-6400.3551 2197.3169,-6364 2248.6754,-6315.8133 2298.4533,-6372.7208 2351.1489,-6326 2384.9341,-6296.0454 2360.8873,-6267.7294 2387.1489,-6231 2441.0578,-6155.6032 2506.4572,-6180.9658 2547.7793,-6098 2587.4483,-6018.3532 2526.5184,-5366.106 2583.7793,-5298 2634.1335,-5238.1088 2706.2278,-5320.635 2755.6838,-5260 2797.3692,-5208.8922 2770.8906,-2948.5884 2791.6838,-2886 2838.0354,-2746.48 2864.5127,-2701.3989 2985.5867,-2618 3039.3022,-2580.9994 3086.2129,-2630.626 3127.3396,-2580 3172.7377,-2524.1159 3111.0328,-1982.4773 3163.3396,-1933 3251.6822,-1849.4362 3315.3537,-1934.7016 3436.8809,-1939"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge926" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M583.1486,-9190.9396C587.3608,-9065.5437 627.514,-7909.8291 687.5354,-7572 703.2636,-7483.474 690.062,-7449.2553 744.8972,-7378"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-7378C775.2753,-7338.5254 795.4604,-7341.4823 838.259,-7316 924.6192,-7264.5811 942.849,-7242.3122 1038.022,-7210 1233.2618,-7143.714 1815.0085,-7209.2137 1952.9868,-7056 2039.1078,-6960.3697 1927.1369,-6590.8564 1988.9868,-6478 2044.0713,-6377.4884 2099.7464,-6386.1404 2197.3169,-6326 2262.745,-6285.6716 2303.6189,-6307.3996 2351.1489,-6247 2393.2798,-6193.4615 2338.4358,-6145.6279 2387.1489,-6098 2439.3933,-6046.9196 2500.6791,-6118.8593 2547.7793,-6063 2605.3518,-5994.721 2525.7411,-5327.8835 2583.7793,-5260 2634.4468,-5200.7375 2705.9372,-5285.0376 2755.6838,-5225 2801.5021,-5169.7033 2775.749,-2710.0223 2791.6838,-2640 2870.4745,-2293.7718 3008.6103,-2249.642 3127.3396,-1915 3149.1099,-1853.6399 3130.7872,-1829.3857 3163.3396,-1773 3212.2405,-1688.2963 3717.9898,-1097.5657 3794.094,-1159"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge582" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-7986C762.2402,-7966.3051 783.0962,-7982.0709 802.259,-8000 841.0578,-8036.301 803.9977,-8073.3887 838.259,-8114 1015.8613,-8324.519 1128.3356,-8313.4475 1392.6204,-8391 1545.035,-8435.725 1590.2984,-8416.7792 1749.1377,-8416 2212.58,-8413.7266 2328.2657,-8400.2485 2791.6838,-8395 2861.8584,-8394.2052 2895.2904,-8350.5364 2949.5867,-8395 3012.3699,-8446.4136 2933.1132,-8512.0999 2985.5867,-8574 3065.7279,-8668.5383 3148.1615,-8597.2807 3246.2772,-8673"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge619" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M744.8972,-10266C822.2489,-10353.5993 915.2475,-10242.7242 1002.022,-10321 1040.532,-10355.7384 1005.7625,-10391.3909 1038.022,-10432 1267.4707,-10720.8361 1523.0511,-10568.5247 1749.1377,-10860 1943.0354,-11109.9766 1896.498,-11230.7226 1952.9868,-11542 1973.8279,-11656.8432 1943.2515,-11958.6147 1988.9868,-12066 2033.6585,-12170.8881 2113.3144,-12152.5939 2161.3169,-12256 2212.2909,-12365.8073 2119.8329,-12432.9826 2197.3169,-12526 2200.0972,-12529.3377 2203.3288,-12532.2337 2206.8621,-12534.7462"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2205.2006,-12537.8304 2215.5834,-12539.9397 2208.7822,-12531.816 2205.2006,-12537.8304"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M632.4569,-9205.6334C639.7346,-9208.2443 646.4705,-9212.1725 651.5354,-9218 689.8802,-9262.1181 708.5537,-10220.2192 744.8972,-10266"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge638" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2274.2329,-6160C2299.4799,-6134.6036 2325.4403,-6160.929 2351.1489,-6136 2386.2641,-6101.9497 2352.0221,-6066.0382 2387.1489,-6032 2393.1137,-6026.2201 2400.3923,-6021.7745 2408.1066,-6018.3555"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2409.5979,-6021.5319 2417.6734,-6014.6736 2407.0836,-6014.999 2409.5979,-6021.5319"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M583.1195,-9190.8137C587.6654,-9041.5599 637.3315,-7447.5609 687.5354,-7364 721.0519,-7308.2142 1126.4174,-7080.4927 1188.1868,-7060 1357.2318,-7003.9173 1409.3455,-7032.8838 1587.1179,-7022 1597.2657,-7021.3787 1945.7244,-7019.1149 1952.9868,-7012 2012.7407,-6953.4593 1938.9822,-6327.0602 1988.9868,-6260 2069.2924,-6152.3038 2179.5202,-6255.2731 2274.2329,-6160"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge662" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M744.8972,-7986C833.562,-7885.0404 1850.6534,-8127.0756 1952.9868,-8040 2029.113,-7975.2241 1932.7677,-7900.647 1988.9868,-7818 2081.7595,-7681.6159 2293.2729,-7651.068 2401.3031,-7644.5342"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2401.6358,-7648.0213 2411.4272,-7643.9742 2401.2491,-7641.032 2401.6358,-7648.0213"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge717" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.1044,-7224C1182.7997,-7186.564 1884.0034,-7267.8272 1952.9868,-7202 2032.9383,-7125.7065 1943.5831,-6806.7544 1988.9868,-6706 2043.3911,-6585.2727 2100.1705,-6582.986 2197.3169,-6493 2262.7765,-6432.3652 2294.8347,-6433.2116 2351.1489,-6364 2372.4837,-6337.779 2362.0448,-6319.6384 2387.1489,-6297 2444.4675,-6245.3112 2503.5276,-6294.2372 2547.7793,-6231 2604.8406,-6149.4574 2519.9135,-5412.3306 2583.7793,-5336 2633.9906,-5275.9889 2706.1628,-5358.582 2755.6838,-5298 2828.8282,-5208.5182 2761.5616,-3329.5784 2791.6838,-3218 2871.3227,-2923.0025 3014.2371,-2901.8551 3127.3396,-2618 3151.4392,-2557.5168 3137.3178,-2535.6815 3163.3396,-2476 3236.9809,-2307.1023 3374.682,-2129.7048 3421.1244,-2072.1936"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3423.9464,-2074.2707 3427.5342,-2064.3018 3418.5128,-2069.8574 3423.9464,-2074.2707"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge812" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M744.8972,-7986C925.6513,-7776.1064 1753.726,-7871.4124 1952.9868,-7679 1992.1243,-7641.2077 1951.0127,-7600.9611 1988.9868,-7562 2057.1641,-7492.0509 2103.382,-7518.7818 2197.3169,-7492 2234.2189,-7481.4789 2839.6427,-7315.3745 2870.6353,-7338"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge836" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M920.1405,-7454C990.6466,-7405.1963 1582.4607,-7260.2514 1668.1278,-7264"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1668.1278,-7264C1794.6855,-7271.1027 1859.1386,-7363.2045 1952.9868,-7278 2014.4775,-7222.1728 1952.3853,-6980.5527 1988.9868,-6906 2035.3133,-6811.6387 2097.0476,-6827.1845 2161.3169,-6744 2181.7454,-6717.5591 2171.4824,-6699.1901 2197.3169,-6678 2225.0049,-6655.2896 2238.5642,-6657.1826 2274.2329,-6654"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge884" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M920.1405,-7454C1110.8242,-7324.5901 1782.9333,-7516.5281 1952.9868,-7361 2019.311,-7300.341 1936.8698,-7235.2273 1988.9868,-7162 2039.9503,-7090.3935 2096.6145,-7124.4842 2161.3169,-7065 2182.2798,-7045.7277 2173.0996,-7026.9795 2197.3169,-7012 2344.7087,-6920.8317 2410.8861,-6971.9973 2583.7793,-6960 2745.9709,-6948.7453 2795.9394,-6905.8463 2949.5867,-6959 2986.7997,-6971.8737 3020.9052,-7003.6491 3040.146,-7024.2185"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3037.6767,-7026.7053 3046.995,-7031.7471 3042.8546,-7021.9948 3037.6767,-7026.7053"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-9316C977.2038,-9311.2253 983.8797,-9349.3551 1038.022,-9368 1103.1141,-9390.4157 1120.9733,-9391.1071 1188.1868,-9406 1364.4044,-9445.0455 1407.4964,-9464.2995 1587.1179,-9482 1668.0329,-9489.9736 1871.8181,-9480.2616 1952.9868,-9485 2105.8233,-9493.9221 2283.1357,-9515.7774 2384.6273,-9529.3958"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2384.4337,-9532.9013 2394.8117,-9530.7689 2385.3691,-9525.9641 2384.4337,-9532.9013"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~exteriorenergyusemanager.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M585.1703,-9213.328C595.5167,-9262.9891 636.6099,-9466.5364 651.5354,-9636 669.0689,-9835.0745 627.7676,-13070.0781 744.8972,-13232"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M744.8972,-13232C791.6072,-13296.5726 843.0035,-13214.0332 920.1405,-13194"/>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M920.1405,-13194C995.4103,-13174.4518 1027.1847,-13229.876 1095.1044,-13192"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge539" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M920.1405,-9202C978.308,-9191.0115 982.6695,-9160.9836 1038.022,-9140 1062.4476,-9130.7405 1069.7939,-9132.4599 1095.1044,-9126"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1095.1044,-9126C1380.0302,-9053.2793 1491.2148,-9167.2331 1749.1377,-9026 1770.4074,-9014.3532 1765.7252,-8999.5329 1785.1377,-8985 1850.9896,-8935.7009 1879.2882,-8943.5431 1952.9868,-8907 1969.1954,-8898.9631 1971.704,-8893.3492 1988.9868,-8888 2078.0232,-8860.4423 2104.2666,-8869.3421 2197.3169,-8864 2352.9643,-8855.0641 2399.1433,-8831.9543 2547.7793,-8879 2583.5033,-8890.3072 3106.4085,-9192.9203 3127.3396,-9224 3459.3516,-9716.9905 3266.5729,-9954.9437 3329.2148,-10546 3406.5989,-11276.1543 3432.4959,-12178.9958 3436.3529,-12327.7953"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3432.8561,-12327.9657 3436.61,-12337.8732 3439.8538,-12327.7871 3432.8561,-12327.9657"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge546" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M1095.1044,-14030C1139.3369,-14033.3568 1188.661,-14044.2501 1224.0325,-14053.3542"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1223.5204,-14056.8381 1234.0812,-14055.989 1225.2959,-14050.067 1223.5204,-14056.8381"/>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M920.1405,-13954C949.2954,-13978.2514 967.0528,-13963.3269 1002.022,-13978 1045.7188,-13996.3352 1047.8525,-14026.414 1095.1044,-14030"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacelists.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datasurfacelists.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.2151,-9213.3242C595.748,-9262.9693 637.5073,-9466.4597 651.5354,-9636 692.7943,-10134.6453 622.8654,-13642.8476 687.5354,-14139 714.0452,-14342.3851 773.7503,-14382.8855 802.259,-14586 842.4595,-14872.4143 761.8902,-15608.0429 838.259,-15887 877.8555,-16031.6364 944.4429,-16043.5362 1002.022,-16182 1059.2217,-16319.5516 1013.4413,-16379.4071 1095.1044,-16504"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M583.0543,-9190.5819C586.8177,-9034.7829 629.1549,-7335.6035 687.5354,-7250 721.9751,-7199.501 1129.1345,-7037.7822 1188.1868,-7022 1360.253,-6976.0139 1409.2134,-6992.454 1587.1179,-6984 1659.0455,-6980.582 1677.2504,-6979.8181 1749.1377,-6984 1802.7089,-6987.1164 1820.6523,-7021.153 1869.0623,-6998"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-7036C758.5816,-7011.9903 777.4378,-7024.1505 802.259,-7012 979.1939,-6925.3871 1003.0649,-6861.3621 1188.1868,-6794 1275.0316,-6762.3989 1300.5946,-6764.4802 1392.6204,-6756 1550.404,-6741.4602 1619.787,-6664.4824 1749.1377,-6756 1788.3824,-6783.7662 1750.3088,-6824.863 1785.1377,-6858 1788.9634,-6861.6399 1793.296,-6864.7523 1797.9275,-6867.4134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1796.6349,-6870.6793 1807.1478,-6871.9944 1799.7495,-6864.4104 1796.6349,-6870.6793"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M583.5511,-9190.9894C591.7235,-9075.3319 663.8362,-8085.4741 744.8972,-7986"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-7663C1353.2744,-7628.2076 1425.8442,-7548.8951 1456.4633,-7512.2356"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1459.3524,-7514.2328 1463.0012,-7504.2861 1453.9459,-7509.7864 1459.3524,-7514.2328"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-7986C801.3296,-7916.7489 770.2245,-7865.8933 838.259,-7808 993.1889,-7676.164 1085.5332,-7743.3957 1272.4036,-7663"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.3747,-9207.6427C639.317,-9210.0467 645.9694,-9213.3846 651.5354,-9218 730.7872,-9283.7171 680.0358,-9350.0463 744.8972,-9430"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-9316C1217.9508,-9273.6355 1288.9023,-9391.59 1587.1179,-9431 1841.1933,-9464.5767 1906.1579,-9460.0097 2161.3169,-9484 2333.1057,-9500.1518 2428.1335,-9396.6732 2547.7793,-9521 2596.3973,-9571.5202 2577.1509,-10081.1998 2583.7793,-10151 2607.224,-10397.8839 2653.533,-10695.5802 2666.3656,-10776.0859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.912,-10776.6549 2667.9483,-10785.9762 2669.8241,-10775.5488 2662.912,-10776.6549"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-9430C765.3111,-9455.1639 780.3486,-9408.8723 802.259,-9385 822.014,-9363.4762 813.8262,-9346.0177 838.259,-9330 869.1353,-9309.7582 883.9414,-9323.2597 920.1405,-9316"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1272.4036,-9849C1351.5791,-9832.3317 1890.1513,-10057.0265 1952.9868,-10108 1975.9649,-10126.6403 1966.4984,-10144.7717 1988.9868,-10164 2052.6095,-10218.3994 2113.5556,-10171.2541 2161.3169,-10240 2238.7948,-10351.519 2132.5696,-10730.6388 2197.3169,-10850 2199.6146,-10854.2358 2753.4682,-11257.7207 2755.6838,-11262 2845.871,-11436.1891 2723.7736,-12842.9789 2791.6838,-13027 2855.9496,-13201.1454 2967.3385,-13187.1703 3056.4631,-13350"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge434" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-9278C1954.8905,-9339.0828 2183.643,-8748.8197 2547.7793,-9072 2598.1631,-9116.7169 2566.6178,-9307.857 2583.7793,-9373 2634.2205,-9564.4682 2712.15,-9590.8442 2755.6838,-9784 2830.2285,-10114.7479 2712.9231,-10216.2306 2791.6838,-10546 2811.5996,-10629.3868 2815.6305,-10656.2393 2870.6353,-10722"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2870.6353,-10722C2908.8106,-10770.188 2973.5944,-10802.7891 3015.6984,-10820.1379"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3014.5173,-10823.4353 3025.1013,-10823.9146 3017.1263,-10816.9396 3014.5173,-10823.4353"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge442" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-8860C1079.3893,-8842.9058 1112.2399,-8784 1272.4036,-8784 1272.4036,-8784 1272.4036,-8784 1471.8691,-8784 1595.5604,-8784 1632.411,-8800.9196 1749.1377,-8760 1767.2846,-8753.6384 1767.7295,-8744.1691 1785.1377,-8736 1793.9223,-8731.8777 1803.5436,-8728.2569 1813.0382,-8725.1437"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1814.3426,-8728.4032 1822.8463,-8722.0836 1812.2577,-8721.7209 1814.3426,-8728.4032"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M587.3525,-9190.6586C611.548,-9132.6714 730.7574,-8871.5923 920.1405,-8860"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge491" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1095.1044,-9126C1267.0369,-9070.8383 1296.0574,-9236.8437 1471.8691,-9278"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-9278C1635.1379,-9303.0931 1638.2637,-9153.5936 1785.1377,-9078 2089.1461,-8921.532 2291.5351,-8750.6325 2547.7793,-8977 2602.7306,-9025.5443 2562.4029,-9067.8627 2583.7793,-9138 2645.1089,-9339.2261 2701.4595,-9375.744 2755.6838,-9579 2832.244,-9865.9802 2862.4661,-10228.2782 2869.1426,-10319.4391"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.6663,-10319.8965 2869.8719,-10329.6209 2872.6484,-10319.3964 2865.6663,-10319.8965"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge509" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1095.1044,-9925C1135.6888,-9953.7 1141.9553,-9881.2601 1188.1868,-9863 1223.4772,-9849.0614 1235.496,-9857.8049 1272.4036,-9849"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2075.1519,-9846C2099.4338,-9876.2598 2134.5489,-9831.9155 2161.3169,-9860 2210.2316,-9911.3203 2164.6565,-10114.0737 2197.3169,-10177 2204.9593,-10191.7245 2384.4494,-10346.0049 2446.55,-10399.1375"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2444.6285,-10402.0996 2454.5035,-10405.9384 2449.1778,-10396.7793 2444.6285,-10402.0996"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M920.1405,-9430C953.4973,-9448.0406 976.4401,-9426.0053 1002.022,-9454 1145.9651,-9611.5192 920.8836,-9801.7967 1095.1044,-9925"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1272.4036,-9849C1420.825,-9813.5915 1807.7725,-9711.1438 1952.9868,-9758 2016.6693,-9778.5484 2031.9046,-9794.9376 2075.1519,-9846"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-9430C973.6621,-9711.9952 666.5831,-9968.0706 920.1405,-10228"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-10228C960.564,-10269.4394 1909.6931,-10327.5691 1952.9868,-10366 2001.0341,-10408.6505 1948.599,-10456.0357 1988.9868,-10506 2042.7976,-10572.5699 2115.5702,-10519.651 2161.3169,-10592 2215.4238,-10677.5709 2144.7989,-12327.4448 2197.3169,-12414 2237.7259,-12480.5982 2308.1732,-12433.0285 2351.1489,-12498 2441.5671,-12634.696 2285.8152,-12736.1873 2387.1489,-12865 2393.3802,-12872.921 2401.9974,-12878.6087 2411.2856,-12882.6908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2410.1422,-12886.0002 2420.7338,-12886.261 2412.6165,-12879.4521 2410.1422,-12886.0002"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.2067,-9213.3249C595.7048,-9262.9729 637.3397,-9466.4737 651.5354,-9636 668.2717,-9835.866 626.0085,-13055.1048 687.5354,-13246 783.8133,-13544.7147 925.6753,-13571.9894 1188.1868,-13744 1273.7929,-13800.0934 1297.8117,-13811.4486 1392.6204,-13850 1426.7112,-13863.8621 1445.4934,-13848.3356 1471.8691,-13874"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-9202C1113.0962,-9167.219 1178.6231,-9183.7893 1356.6204,-9266 1374.5381,-9274.2756 1373.8412,-9285.9277 1392.6204,-9292 1543.3865,-9340.7509 1602.747,-9352.637 1749.1377,-9292 1770.0427,-9283.3409 1764.4512,-9265.1688 1785.1377,-9256 1868.0656,-9219.2441 1898.3055,-9248.2229 1988.9868,-9246 2065.555,-9244.1231 2085.1538,-9237.9135 2161.3169,-9246 2336.0127,-9264.5481 2432.0592,-9196.8202 2547.7793,-9329 2614.59,-9405.3137 2555.6054,-9686.5644 2583.7793,-9784 2629.3877,-9941.7305 2712.9604,-9952.4637 2755.6838,-10111 2774.2135,-10179.759 2860.7165,-12543.5793 2869.8536,-12794.4979"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.3682,-12794.9656 2870.2296,-12804.8317 2873.3636,-12794.711 2866.3682,-12794.9656"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1095.1044,-9925C1118.6854,-9942.2814 1328.8852,-9944.755 1356.6204,-9954 1469.4626,-9991.6137 1476.1193,-10047.251 1587.1179,-10090 1742.017,-10149.6564 1822.1349,-10062.8708 1952.9868,-10165 1982.1343,-10187.7494 1960.009,-10217.0349 1988.9868,-10240 2050.4553,-10288.7142 2110.6047,-10218.1693 2161.3169,-10278 2210.6687,-10336.2257 2161.2115,-10896.7525 2197.3169,-10964 2237.5709,-11038.9743 2299.8098,-11010.1337 2351.1489,-11078 2378.3892,-11114.0095 2356.5188,-11139.826 2387.1489,-11173 2440.7262,-11231.027 2477.6919,-11212.5938 2547.7793,-11249 2642.0655,-11297.9761 2701.4406,-11275.6423 2755.6838,-11367 2815.5671,-11467.8567 2754.6011,-13366.7213 2791.6838,-13478 2842.9909,-13631.9631 2984.3544,-13776.1606 3036.6627,-13825.7835"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3034.58,-13828.629 3044.2658,-13832.9227 3039.3716,-13823.526 3034.58,-13828.629"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-10114C1198.0608,-10210.0804 1255.6697,-10190.1977 1392.6204,-10223 1423.1111,-10230.3031 1929.942,-10268.7406 1952.9868,-10290 2012.3113,-10344.7282 1934.0081,-10408.9076 1988.9868,-10468 2043.1439,-10526.2093 2111.5605,-10453.987 2161.3169,-10516 2208.3891,-10574.6676 2192.667,-11116.9263 2197.3169,-11192 2223.9668,-11622.2707 2263.9781,-12147.6198 2272.5708,-12259.4432"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2269.1061,-12260.037 2273.3631,-12269.739 2276.0854,-12259.4999 2269.1061,-12260.037"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M744.8972,-13232C764.6996,-13263.8924 784.3462,-13261.0092 802.259,-13294 833.3261,-13351.2176 786.8745,-13396.0169 838.259,-13436 895.7015,-13480.6968 929.4411,-13441.4277 1002.022,-13436 1043.7407,-13432.8802 1058.1069,-13402.4712 1095.1044,-13422"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge464" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-9925C1116.4322,-9940.0823 1128.2852,-9928.4613 1152.1868,-9939 1269.8604,-9990.8849 1277.3039,-10043.0682 1392.6204,-10100 1474.4731,-10140.4107 1498.2121,-10145.2961 1587.1179,-10166 1746.8459,-10203.1965 1817.1164,-10122.1532 1952.9868,-10214 1980.0244,-10232.2771 1968.8657,-10252.3051 1988.9868,-10278 2053.7973,-10360.7636 2116.8919,-10344.7287 2161.3169,-10440 2221.3293,-10568.6991 2122.0433,-10957.5889 2197.3169,-11078 2238.8375,-11144.4184 2298.8657,-11105.6748 2351.1489,-11164 2378.5334,-11194.5491 2358.9276,-11219.2222 2387.1489,-11249 2450.5153,-11315.8614 2553.1039,-11354.5339 2615.6886,-11373.1315"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2614.7981,-11376.5174 2625.3775,-11375.9451 2616.7503,-11369.7951 2614.7981,-11376.5174"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge601" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-10228C946.9869,-10254.7845 967.3622,-10236.6105 1002.022,-10252 1066.4606,-10280.6118 1202.5802,-10408.2191 1272.4036,-10418"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-10418C1422.4526,-10437.6845 1838.3924,-10343.155 1952.9868,-10442 2019.7219,-10499.5633 1936.9584,-10565.8652 1988.9868,-10637 1999.018,-10650.715 2014.3976,-10660.7409 2029.4019,-10667.8645"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2028.0817,-10671.1075 2038.6444,-10671.932 2030.9013,-10664.7004 2028.0817,-10671.1075"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge700" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M583.2153,-9190.7674C587.4782,-9082.3767 623.1016,-8220.6984 687.5354,-7972 750.8302,-7727.698 715.3616,-7601.4968 920.1405,-7454"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-7454C968.705,-7412.9831 981.4513,-7401.9941 1038.022,-7373 1101.1388,-7340.6507 1119.862,-7338.0248 1188.1868,-7319 1274.8572,-7294.867 1497.4763,-7257.6517 1587.1179,-7250 1607.3779,-7248.2706 1938.288,-7254.05 1952.9868,-7240 2032.8739,-7163.6391 1916.6911,-6827.5839 1988.9868,-6744 2040.2955,-6684.68 2098.6069,-6753.1051 2161.3169,-6706 2188.0326,-6685.9323 2177.1555,-6666.6451 2197.3169,-6640 2328.8251,-6466.2001 2442.4097,-6487.7828 2547.7793,-6297 2759.0496,-5914.473 2705.0014,-5770.043 2755.6838,-5336 2779.5674,-5131.462 2726.348,-3678.2881 2791.6838,-3483 2807.6088,-3435.4006 3013.3076,-3091.3697 3056.4631,-3117"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge672" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-7264C1724.9819,-7266.4878 1731.755,-7296.2803 1785.1377,-7316 1795.8368,-7319.9523 1807.4728,-7323.7352 1818.5776,-7327.1085"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1817.5798,-7330.4632 1828.1627,-7329.9615 1819.5767,-7323.7541 1817.5798,-7330.4632"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge781" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-8860C1008.0801,-8831.4515 1661.8905,-8818.5996 1749.1377,-8788 1767.2836,-8781.6358 1767.3599,-8771.3298 1785.1377,-8764 1855.4256,-8735.0202 1899.6834,-8785.2122 1952.9868,-8731 2016.6155,-8666.2865 1922.5449,-8591.8216 1988.9868,-8530 2099.8593,-8426.8376 2520.1031,-8474.6225 2669.7316,-8498"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-8498C2719.123,-8503.4965 2774.6364,-8514.0613 2814.7718,-8522.4992"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2814.1223,-8525.9392 2824.6314,-8524.5942 2815.5772,-8519.0921 2814.1223,-8525.9392"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge794" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.1688,-9213.3281C595.5085,-9262.9898 636.5784,-9466.5391 651.5354,-9636 660.8127,-9741.1103 646.4377,-11437.8134 687.5354,-11535 724.5898,-11622.6251 765.9246,-11625.2027 838.259,-11687 906.4666,-11745.2716 951.5018,-11730.8679 1002.022,-11805 1038.4449,-11858.4461 1002.0399,-11892.2561 1038.022,-11946 1084.3418,-12015.1847 1110.8155,-12027.2473 1188.1868,-12058 1306.1422,-12104.8836 1345.156,-12083.5614 1471.8691,-12091"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge744" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-7224C1144.2996,-7195.3472 1137.5011,-7161.9251 1188.1868,-7136 1348.8781,-7053.8082 1408.2694,-7084.2984 1587.1179,-7060 1627.5351,-7054.5089 1924.4323,-7059.1263 1952.9868,-7030 1998.1888,-6983.8929 1958.5539,-6506.9467 1988.9868,-6450 2084.3717,-6271.514 2232.5065,-6337.9497 2351.1489,-6174 2379.8243,-6134.374 2351.345,-6103.3252 2387.1489,-6070 2441.2467,-6019.6474 2501.467,-6084.5944 2547.7793,-6027 2603.1898,-5958.091 2542.0267,-5309.9455 2583.7793,-5232 2594.9656,-5211.1169 2616.4653,-5195.363 2635.1626,-5184.8318"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2636.8859,-5187.8794 2644.0587,-5180.0819 2633.5889,-5181.7045 2636.8859,-5187.8794"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-7378C822.6705,-7289.8523 899.3183,-7373.1897 1002.022,-7316 1052.8411,-7287.7018 1044.0113,-7251.8005 1095.1044,-7224"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge762" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-9202C1028.8432,-9185.4204 1287.3581,-9317.2033 1392.6204,-9349 1414.1781,-9355.512 1564.8265,-9402.8009 1587.1179,-9406 1658.3964,-9416.2294 1690.7792,-9448.1847 1749.1377,-9406 1790.4847,-9376.1121 1746.478,-9330.291 1785.1377,-9297 1854.7952,-9237.0159 1897.3935,-9269.806 1988.9868,-9262 2065.3013,-9255.4962 2088.8714,-9237.1434 2161.3169,-9262 2180.4895,-9268.5783 2179.5339,-9280.2722 2197.3169,-9290 2342.2698,-9369.2931 2446.5609,-9283.4106 2547.7793,-9414 2603.5389,-9485.9396 2567.515,-9732.446 2583.7793,-9822 2603.8948,-9932.7594 2645.843,-10061.2888 2662.596,-10110.4475"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2659.3003,-10111.6269 2665.8582,-10119.9482 2665.9209,-10109.3536 2659.3003,-10111.6269"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge852" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-7454C964.71,-7425.7658 985.3541,-7464.8834 1038.022,-7468 1088.6733,-7470.9972 1101.4597,-7469.1396 1152.1868,-7468 1241.2319,-7465.9995 1885.4541,-7490.0722 1952.9868,-7432 2015.5066,-7378.2386 1939.2843,-7315.7927 1988.9868,-7250 2040.825,-7181.3802 2102.4479,-7224.6923 2161.3169,-7162 2188.8413,-7132.6879 2166.8501,-7105.2405 2197.3169,-7079 2252.421,-7031.5397 2335.5624,-7014.9708 2395.0455,-7009.3906"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2395.4562,-7012.8684 2405.1215,-7008.5287 2394.8595,-7005.8938 2395.4562,-7012.8684"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~solarshading.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-5584.0054 166.6166,-5584.0054 166.6166,-5561.9946 281.0645,-5561.9946 281.0645,-5584.0054"/>
<text text-anchor="middle" x="223.8406" y="-5569.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#ffcc00" stroke-dasharray="5,2" d="M224.9795,-5584.2285C231.9494,-5653.556 268.9501,-6030.5184 281.2024,-6339 289.7385,-6553.9162 283.6221,-13869.5519 317.2024,-14082 331.2446,-14170.8388 370.866,-14271.2403 388.7093,-14313.5157"/>
<polygon fill="#ffcc00" stroke="#ffcc00" points="385.5059,-14314.9265 392.6522,-14322.7483 391.9434,-14312.1772 385.5059,-14314.9265"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#3200ff" stroke-dasharray="5,2" d="M224.9696,-5584.2289C231.8806,-5653.5588 268.5905,-6030.5329 281.2024,-6339 304.611,-6911.5356 256.9897,-10926.1584 317.2024,-11496 402.7532,-12305.6371 107.9793,-12718.2082 687.5354,-13290 787.4554,-13388.5814 868.0721,-13360.9489 1002.022,-13319 1020.6114,-13313.1784 1021.0202,-13303.5077 1038.022,-13294 1044.176,-13290.5586 1050.8961,-13287.2491 1057.4953,-13284.2275"/>
<polygon fill="#3200ff" stroke="#3200ff" points="1059.2679,-13287.2706 1066.9974,-13280.0245 1056.4362,-13280.8689 1059.2679,-13287.2706"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge949" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3794.094,-512C3956.1132,-554.3983 3971.9852,-649.9171 4027.281,-808 4103.5481,-1026.037 4123.6223,-17104.4076 4124.4194,-17768.8236"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4120.9195,-17768.9631 4124.4315,-17778.9589 4127.9195,-17768.9547 4120.9195,-17768.9631"/>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M224.058,-5561.763C226.3145,-5448.9368 246.8183,-4508.6924 317.2024,-3751 420.0334,-2644.0132 516.2152,-2375.4865 651.5354,-1272 669.2782,-1127.3142 636.9676,-1082.7176 687.5354,-946 728.7789,-834.4921 758.657,-813.3094 838.259,-725 1016.5469,-527.2099 1602.7777,-114 1869.0623,-114 1869.0623,-114 1869.0623,-114 2467.4641,-114 2775.252,-114 3531.5214,-351.4105 3794.094,-512"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge957" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M224.9533,-5584.2296C231.7671,-5653.5635 267.9973,-6030.5577 281.2024,-6339 297.0055,-6708.128 272.6278,-9297.2326 317.2024,-9664 408.8899,-10418.4209 691.2045,-11315.3536 738.2256,-11461.4409"/>
<polygon fill="#9900ff" stroke="#9900ff" points="734.9035,-11462.543 741.307,-11470.9837 741.5648,-11460.392 734.9035,-11462.543"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1003" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M224.9291,-5584.0432C229.17,-5620.9266 247.9549,-5740.9623 317.2024,-5802 372.7069,-5850.9241 432.1739,-5786.9332 478.0276,-5845 523.4577,-5902.5303 511.7918,-7090.729 514.0276,-7164 539.4411,-7996.8359 576.2398,-9020.916 582.0084,-9180.6343"/>
<polygon fill="#ff0033" stroke="#ff0033" points="578.5235,-9181.1177 582.3825,-9190.9847 585.5189,-9180.8648 578.5235,-9181.1177"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.615,-5325C453.1683,-5271.8296 443.7002,-5228.1019 514.0276,-5197 569.9203,-5172.2817 591.9098,-5183.5918 651.5354,-5197 654.1784,-5197.5943 1355.1524,-5528.7232 1356.6204,-5531 1420.7204,-5630.4224 1340.3136,-7553.898 1392.6204,-7660 1402.6137,-7680.2711 1422.562,-7696.0729 1439.9434,-7706.7808"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.3319,-7709.8928 1448.7325,-7711.9127 1441.8616,-7703.8478 1438.3319,-7709.8928"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M228.352,-5561.6463C240.1728,-5532.704 274.131,-5454.5329 317.2024,-5399 346.9688,-5360.6215 359.3667,-5354.9336 397.615,-5325"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M397.615,-5325C480.1128,-5247.2581 556.894,-5286.6085 651.5354,-5349 679.4321,-5367.3907 660.9349,-5394.7798 687.5354,-5415 839.1438,-5530.2439 1072.1941,-5550.2671 1193.2582,-5552.283"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1193.5094,-5555.7864 1203.5536,-5552.4152 1193.5994,-5548.787 1193.5094,-5555.7864"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge916" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.2575,-5561.5746C229.7198,-5412.4819 287.5062,-3853.7603 317.2024,-3818 364.1904,-3761.4168 426.6431,-3831.6228 478.0276,-3779 541.4209,-3714.079 640.9455,-3071.1182 651.5354,-2981 663.2929,-2880.9464 646.1865,-1259.8653 687.5354,-1168 862.472,-779.3415 1003.7097,-692.3752 1392.6204,-518 1708.4062,-376.4117 2643.0073,-323.4479 2949.5867,-484 2969.3553,-494.3526 2967.7307,-505.6158 2985.5867,-519 3265.6731,-728.9431 3368.1963,-731.3336 3670.96,-907 3764.9966,-961.561 3827.1985,-937.6571 3881.228,-1032 3934.6785,-1125.3319 3970.6886,-16192.182 3972.2047,-16836.7142"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3968.7052,-16836.9582 3972.2287,-16846.9499 3975.7052,-16836.9417 3968.7052,-16836.9582"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge581" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.2036,-5561.6748C228.3585,-5433.5804 267.7004,-4261.0094 317.2024,-4209 422.8527,-4097.9982 898.693,-4241.166 1002.022,-4128 1052.1243,-4073.1279 1033.0558,-2865.1386 1038.022,-2791 1058.9346,-2478.804 1004.8967,-1644.5911 1188.1868,-1391 1193.5427,-1383.5898 2378.2124,-848.9326 2387.1489,-847 2547.3741,-812.3507 2604.0663,-799.6718 2755.6838,-862 2976.2789,-952.684 2967.8494,-1074.3641 3163.3396,-1211 3307.5907,-1311.8229 3419.2999,-1253.3141 3508.5469,-1405 3534.7264,-1449.4953 3543.9571,-8787.3778 3544.5469,-8839 3561.2798,-10303.6421 3602.3003,-12111.7296 3607.2599,-12327.6149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.7674,-12327.9852 3607.4967,-12337.902 3610.7656,-12327.824 3603.7674,-12327.9852"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1322.5073,-5590.2524C1335.5536,-5587.2352 1348.2751,-5581.4983 1356.6204,-5571 1393.5811,-5524.5033 1383.6314,-3491.7132 1392.6204,-3433 1430.2799,-3187.0207 1503.3061,-3140.2091 1551.1179,-2896 1582.0128,-2738.1979 1539.12,-2689.4673 1587.1179,-2536 1631.42,-2394.3495 1703.2388,-2385.1412 1749.1377,-2244 1789.7126,-2119.2302 1723.1431,-2066.6309 1785.1377,-1951 1854.7475,-1821.1655 2670.1934,-1171.3222 2791.6838,-1088 2948.3525,-980.5514 3360.3275,-729.4058 3544.5469,-683 3599.0285,-669.2758 3618.903,-661.8655 3670.96,-683 3691.6363,-691.3943 3687.8807,-706.426 3706.96,-718 3790.5015,-768.6787 4026.7609,-853.6686 4124.4445,-856"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge979" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1274.9547,-5603.0832C1285.7515,-5649.0971 1330.0267,-5829.107 1392.6204,-5967 1461.8845,-6119.5881 1462.6611,-6177.7897 1587.1179,-6290 1646.1906,-6343.2599 1702.5736,-6301.5175 1749.1377,-6366 1828.2726,-6475.5868 1730.6773,-6544.2839 1785.1377,-6668 1831.2093,-6772.6596 1912.9584,-6755.8835 1952.9868,-6863 2030.1829,-7069.5775 1928.1001,-14590.0417 1988.9868,-14802 2002.6498,-14849.5636 2037.65,-14896.7939 2058.5992,-14922.0966"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2055.986,-14924.4268 2065.1139,-14929.8057 2061.3326,-14919.9086 2055.986,-14924.4268"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1276.4526,-5603.2022C1290.7741,-5643.4507 1339.1116,-5784.7819 1356.6204,-5906 1368.124,-5985.6428 1355.76,-7282.4694 1392.6204,-7354 1432.9706,-7432.303 1510.4108,-7394.8819 1551.1179,-7473 1605.5252,-7577.4092 1565.5427,-8416.2591 1587.1179,-8532 1627.3003,-8747.5589 1687.8164,-8787.4769 1749.1377,-8998 1803.2898,-9183.9104 1850.7382,-9413.4417 1864.8249,-9483.625"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1861.4721,-9484.7088 1866.8627,-9493.8298 1868.3366,-9483.338 1861.4721,-9484.7088"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1471.8691,-5516C1563.7068,-5541.04 1643.4257,-5862.7997 1663.3497,-5949.5671"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1659.995,-5950.6 1665.621,-5959.5777 1666.8215,-5949.0511 1659.995,-5950.6"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1276.5127,-5603.1937C1291.0369,-5643.4137 1339.9742,-5784.6605 1356.6204,-5906 1407.7569,-6278.7522 1364.0607,-8916.842 1392.6204,-9292 1408.629,-9502.288 1454.008,-9754.0808 1467.8263,-9827.7757"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1464.4029,-9828.5098 1469.6966,-9837.6873 1471.2815,-9827.2117 1464.4029,-9828.5098"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge604" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M2075.1519,-10188C2076.534,-10207.3496 2148.628,-10187.3266 2161.3169,-10202 2201.5134,-10248.4829 2181.2857,-12354.6753 2197.3169,-12414 2209.6655,-12459.697 2240.6175,-12506.3949 2259.2763,-12531.7375"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2256.5086,-12533.8806 2265.3128,-12539.7743 2262.1056,-12529.6765 2256.5086,-12533.8806"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1278.6647,-5603.0083C1294.9464,-5631.0344 1340.9564,-5706.5037 1392.6204,-5758 1454.0771,-5819.2573 1506.4389,-5797.6148 1551.1179,-5872 1612.5457,-5974.2699 1527.2163,-6034.8288 1587.1179,-6138 1632.6482,-6216.4187 1703.3617,-6183.7245 1749.1377,-6262 1806.6957,-6360.4224 1724.0207,-6419.7471 1785.1377,-6516 1832.9477,-6591.2956 1910.1819,-6547.7507 1952.9868,-6626 1998.8882,-6709.9098 1959.0294,-9978.1686 1988.9868,-10069 2009.4392,-10131.012 2070.4996,-10122.8683 2075.1519,-10188"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge622" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1322.5994,-5589.3799C1335.3285,-5586.3034 1347.8608,-5580.7538 1356.6204,-5571 1434.8618,-5483.8778 1320.1173,-5401.9528 1392.6204,-5310 1473.2753,-5207.7085 1537.9817,-5215.5448 1668.1278,-5210"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1668.1278,-5210C1790.2089,-5175.8898 1858.6212,-5111.3689 1952.9868,-5196 2007.9046,-5245.2526 1942.9012,-5468.3988 1988.9868,-5526 2095.2753,-5658.8473 2231.7461,-5528.8034 2351.1489,-5650 2400.2269,-5699.8153 2448.7423,-5916.8951 2463.1645,-5985.8765"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2459.7982,-5986.8815 2465.2504,-5995.9658 2466.6532,-5985.4642 2459.7982,-5986.8815"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge644" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1471.8691,-5402C1572.7664,-5370.4056 1735.6365,-5522.1943 1749.1377,-5538 1903.6511,-5718.8866 2098.4427,-6296.5633 2161.3169,-6526 2191.6835,-6636.8118 2166.0219,-6671.4468 2197.3169,-6782 2243.8197,-6946.2765 2297.7124,-6971.8463 2351.1489,-7134 2412.0111,-7318.687 2452.5486,-7551.2722 2464.0866,-7621.7901"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2460.6351,-7622.3718 2465.688,-7631.6841 2467.5452,-7621.2533 2460.6351,-7622.3718"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge703" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1322.4929,-5590.241C1335.5389,-5587.2235 1348.2638,-5581.4894 1356.6204,-5571 1422.2657,-5488.5998 1361.1599,-3775.5453 1392.6204,-3675 1430.5714,-3553.7114 1508.4507,-3556.7109 1551.1179,-3437 1606.4393,-3281.7855 1549.6216,-3228.4557 1587.1179,-3068 1633.4017,-2869.9405 1698.9207,-2837.099 1749.1377,-2640 1778.0485,-2526.5268 1743.3788,-2488.3993 1785.1377,-2379 1843.0184,-2227.3648 1870.0487,-2186.4406 1988.9868,-2076 2138.2581,-1937.3933 2190.247,-1901.1861 2387.1489,-1849 2456.1576,-1830.7102 2486.39,-1812.5573 2547.7793,-1849 2576.5113,-1866.0563 2556.9469,-1895.0885 2583.7793,-1915 2704.5428,-2004.6152 3096.1456,-2061.6713 3246.2772,-2053"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3246.2772,-2053C3281.7783,-2051.4134 3321.036,-2051.158 3354.6512,-2051.396"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3354.8619,-2054.8979 3364.8919,-2051.4848 3354.9227,-2047.8982 3354.8619,-2054.8979"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge797" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1322.7416,-5589.9839C1335.6303,-5586.9372 1348.21,-5581.252 1356.6204,-5571 1409.8871,-5506.0693 1379.0459,-4898.8799 1392.6204,-4816 1443.7041,-4504.1043 1490.5195,-4432.9272 1587.1179,-4132 1652.3433,-3928.8073 1698.7493,-3887.3707 1749.1377,-3680 1777.7224,-3562.3611 1729.5923,-3517.5672 1785.1377,-3410 1900.0126,-3187.5372 1964.3451,-3117.7066 2197.3169,-3026 2446.8996,-2927.7548 2604.6027,-3033.3739 2755.6838,-3255 2810.9973,-3336.1411 2747.3741,-3385.3638 2791.6838,-3473 2837.0508,-3562.727 2911.2172,-3542.0652 2949.5867,-3635 2985.9272,-3723.0207 2982.8254,-6967.8126 2985.5867,-7063 3003.001,-7663.308 3046.9689,-8398.6088 3055.144,-8532.5505"/>
<polygon fill="#003fff" stroke="#003fff" points="3051.6614,-8532.9438 3055.766,-8542.7112 3058.6484,-8532.516 3051.6614,-8532.9438"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge819" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1668.1278,-5210C1712.0866,-5202.1618 1831.8906,-5185.2598 1869.0623,-5210"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1869.0623,-5210C1901.358,-5231.495 1928.0278,-5204.2998 1952.9868,-5234 2001.8677,-5292.1662 1951.1429,-5508.1177 1988.9868,-5574 2088.4617,-5747.1752 2245.8293,-5670.3159 2351.1489,-5840 2359.9372,-5854.1592 2445.4556,-6369.7364 2463.9493,-6481.6907"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2460.5295,-6482.4642 2465.6117,-6491.7606 2467.436,-6481.324 2460.5295,-6482.4642"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge864" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1322.8779,-5590.0946C1335.7688,-5587.0497 1348.3155,-5581.3377 1356.6204,-5571 1402.7739,-5513.5489 1374.5811,-4316.4518 1392.6204,-4245 1430.887,-4093.4293 1484.6779,-4072.5053 1551.1179,-3931 1644.8506,-3731.3664 1699.3348,-3690.8466 1749.1377,-3476 1769.1807,-3389.5358 1720.9785,-2739.3301 1785.1377,-2678 1841.5575,-2624.068 2578.164,-2736.6672 2755.6838,-2920 2798.8799,-2964.6105 2763.8683,-2999.4816 2791.6838,-3055 2817.0491,-3105.6279 2849.5932,-3102.428 2870.6353,-3155"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2870.6353,-3155C2892.1538,-3210.4277 2930.5839,-3206.6602 2949.5867,-3263 2982.6004,-3360.8795 2982.6822,-5018.7437 2985.5867,-5122 3007.6263,-5905.5385 3048.8849,-6868.3349 3055.5449,-7021.9173"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.0483,-7022.073 3055.9791,-7031.9117 3059.0417,-7021.7691 3052.0483,-7022.073"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-5516C1693.062,-5576.3094 1664.1341,-5738.073 1749.1377,-5951 1780.1944,-6028.7944 1749.0651,-6060.4007 1785.1377,-6136 1835.1115,-6240.7328 1910.0327,-6228.198 1952.9868,-6336 2002.265,-6459.6734 1969.7728,-6802.2644 1988.9868,-6934 2091.0891,-7634.0367 2231.7629,-7786.7029 2351.1489,-8484 2421.936,-8897.4455 2458.6947,-9409.6157 2466.0675,-9519.5878"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.5859,-9519.9835 2466.74,-9529.7299 2469.5706,-9519.5202 2462.5859,-9519.9835"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.7907,-5583.4969C1334.2866,-5580.463 1346.1822,-5576.4029 1356.6204,-5571 1375.3719,-5561.2939 1374.1158,-5550.1689 1392.6204,-5540 1424.8727,-5522.2762 1437.2757,-5503.4445 1471.8691,-5516"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge522" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3056.4631,-2129C3084.7206,-2146.5381 3103.6731,-2129.6341 3127.3396,-2153 3240.3666,-2264.5911 3144.8713,-2367.7522 3246.2772,-2490"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3246.2772,-2490C3370.2348,-2639.4345 3334.4725,-7301.7407 3365.2148,-9252 3385.5041,-10539.1253 3430.5023,-12126.7196 3436.2686,-12327.745"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3432.7737,-12327.977 3436.5596,-12337.8723 3439.7708,-12327.7759 3432.7737,-12327.977"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1322.4886,-5590.2376C1335.5345,-5587.22 1348.2605,-5581.4867 1356.6204,-5571 1420.1455,-5491.3137 1353.9273,-3831.2772 1392.6204,-3737 1431.473,-3642.3339 1500.5296,-3658.9496 1551.1179,-3570 1556.1261,-3561.1941 1747.3411,-2877.9699 1749.1377,-2868 1766.5359,-2771.4505 1743.9439,-2517.0369 1785.1377,-2428 1785.1377,-2428 1988.9868,-2224 1988.9868,-2224 2200.144,-2113.8628 2854.1141,-2003.4117 3056.4631,-2129"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-5402C1573.5395,-5366.3386 1877.415,-5385.2048 1952.9868,-5462 2005.0384,-5514.8942 1946.5981,-5733.0873 1988.9868,-5794 2037.8806,-5864.2605 2098.9078,-5821.4147 2161.3169,-5880 2184.5485,-5901.8082 2176.8477,-5917.5803 2197.3169,-5942 2212.6683,-5960.3143 2233.5542,-5977.6019 2249.6879,-5989.7381"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2247.9677,-5992.8177 2258.0969,-5995.9242 2252.1158,-5987.1791 2247.9677,-5992.8177"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.7806,-5586.6794C1334.7842,-5583.5475 1346.9133,-5578.6454 1356.6204,-5571 1383.7938,-5549.5979 1373.7943,-5531.0177 1392.6204,-5502 1423.485,-5454.4264 1417.7516,-5418.946 1471.8691,-5402"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1869.0623,-5210C1901.358,-5231.495 1928.4902,-5203.9173 1952.9868,-5234 2020.8091,-5317.2882 1921.325,-5632.5814 1988.9868,-5716 1998.3941,-5727.5981 2012.8406,-5734.0154 2027.2323,-5737.5057"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2026.6324,-5740.955 2037.1244,-5739.4822 2028.004,-5734.0907 2026.6324,-5740.955"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.1638,-5603.249C1289.5103,-5643.6555 1334.9637,-5785.4539 1356.6204,-5906 1371.7755,-5990.357 1336.4626,-6225.2537 1392.6204,-6290 1440.0847,-6344.7233 1488.393,-6291.7635 1551.1179,-6328 1571.2624,-6339.6376 1569.9461,-6350.3041 1587.1179,-6366 1654.8542,-6427.9145 1703.3331,-6414.4792 1749.1377,-6494 1805.1683,-6591.2741 1747.3731,-6638.2857 1785.1377,-6744 1801.6796,-6790.3058 1834.6434,-6838.0428 1853.9698,-6863.7617"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1851.3362,-6866.0798 1860.1878,-6871.9021 1856.899,-6861.8306 1851.3362,-6866.0798"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.4579,-5603.2014C1290.797,-5643.4474 1339.1867,-5784.7711 1356.6204,-5906 1368.6755,-5989.8279 1354.9179,-7354.1648 1392.6204,-7430 1402.6817,-7450.2375 1422.6296,-7466.0394 1439.9939,-7476.7558"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.3741,-7479.8631 1448.7727,-7481.8927 1441.9095,-7473.8214 1438.3741,-7479.8631"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.8363,-5589.5887C1335.5677,-5586.5143 1348.042,-5580.9135 1356.6204,-5571 1408.9401,-5510.5373 1370.0304,-5289.6993 1392.6204,-5213 1414.4797,-5138.7813 1412.8067,-5107.9787 1471.8691,-5058"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-5058C1553.96,-4988.5346 1854.4774,-4962.8695 1952.9868,-5006 1974.5955,-5015.461 1972.2894,-5028.3374 1988.9868,-5045 2159.128,-5214.7869 2203.3646,-5256.084 2387.1489,-5411 2421.6281,-5440.0633 2456.3739,-5429.2908 2467.4641,-5473"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1668.1278,-3462C1725.5208,-3305.5941 1724.2081,-3260.7279 1749.1377,-3096 1763.6518,-3000.0949 1732.9577,-2742.7661 1785.1377,-2661 1891.4674,-2494.3813 2001.0835,-2517.6699 2197.3169,-2494 2709.3484,-2432.2382 2994.4606,-2689.6689 3127.3396,-3188 3154.8221,-3291.0667 3161.6037,-10761.3463 3163.3396,-10868 3183.442,-12103.0937 3238.2928,-13625.7799 3245.4936,-13822.6861"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3242.0025,-13822.9973 3245.8665,-13832.8623 3248.9978,-13822.7408 3242.0025,-13822.9973"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1471.8691,-4830C1643.0777,-4465.598 1548.6845,-4305.8697 1785.1377,-3980 1787.0689,-3977.3385 2195.9623,-3655.8636 2197.3169,-3655 2416.0567,-3515.5495 2538.8073,-3342.6689 2755.6838,-3485 2789.3003,-3507.0617 2771.1777,-3533.4126 2791.6838,-3568 2849.9764,-3666.3215 2912.1341,-3663.0072 2949.5867,-3771 2974.5304,-3842.9241 2983.6338,-9175.8984 2985.5867,-9252 3001.9922,-9891.3043 3047.0467,-10674.8635 3055.1921,-10813.532"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.7079,-10813.9036 3055.7901,-10823.6804 3058.6957,-10813.4918 3051.7079,-10813.9036"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1322.6768,-5589.9305C1335.5645,-5586.883 1348.1598,-5581.2107 1356.6204,-5571 1401.0721,-5517.3528 1370.0167,-5010.9018 1392.6204,-4945 1412.7587,-4886.2858 1444.1057,-4885.5167 1471.8691,-4830"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge435" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1276.4202,-5603.2069C1290.6323,-5643.4715 1338.6462,-5784.8501 1356.6204,-5906 1392.709,-6149.2454 1341.5324,-6771.4574 1392.6204,-7012 1431.491,-7195.0185 1509.7264,-7219.5351 1551.1179,-7402 1580.5696,-7531.8309 1538.9144,-7875.9038 1587.1179,-8000 1628.5385,-8106.6341 1698.7938,-8097.2771 1749.1377,-8200 1835.5484,-8376.3146 1861.4567,-8617.8387 1867.4941,-8689.8912"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1864.0135,-8690.2746 1868.2987,-8699.9641 1870.9913,-8689.7172 1864.0135,-8690.2746"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge474" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-4830C1538.4034,-4700.086 1672.0253,-4777.928 1749.1377,-4654 1827.5498,-4527.9834 1710.9738,-4450.5626 1785.1377,-4322 1898.6169,-4125.2846 1981.4731,-4090.611 2197.3169,-4020 2300.421,-3986.2706 2613.4946,-4050.234 2669.7316,-4143"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge494" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2274.2329,-9618C2305.7411,-9693.6136 2436.1568,-10276.2674 2462.7261,-10395.6637"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2459.3793,-10396.7375 2464.9664,-10405.7395 2466.2125,-10395.2182 2459.3793,-10396.7375"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1322.6983,-5601.8722C1386.8762,-5617.3006 1496.1408,-5653.6486 1551.1179,-5730 1619.5424,-5825.0268 1527.1965,-5890.3947 1587.1179,-5991 1632.8374,-6067.7609 1703.2752,-6033.3245 1749.1377,-6110 1807.665,-6207.8492 1726.7462,-6266.0697 1785.1377,-6364 1832.637,-6443.6627 1910.5041,-6405.5527 1952.9868,-6488 2006.7127,-6592.267 1974.5871,-8482.5924 1988.9868,-8599 2030.3902,-8933.7054 2099.4773,-9006.4614 2161.3169,-9338 2171.8507,-9394.4746 2160.1309,-9550.2102 2197.3169,-9594 2220.4966,-9621.2962 2260.4587,-9584.9446 2274.2329,-9618"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-12320C2281.2167,-12354.5129 2328.2326,-12312.265 2351.1489,-12339 2409.9519,-12407.6018 2361.1803,-12657.4573 2387.1489,-12744 2402.0976,-12793.8178 2434.7667,-12845.972 2453.5077,-12873.419"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2450.7065,-12875.5215 2459.2838,-12881.7409 2456.4571,-12871.5301 2450.7065,-12875.5215"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1283.4925,-5603.0425C1303.7414,-5622.7478 1348.6767,-5664.3938 1392.6204,-5691 1458.0421,-5730.6104 1505.2128,-5696.8306 1551.1179,-5758 1633.5778,-5867.8793 1505.9483,-5954.1641 1587.1179,-6065 1633.7829,-6128.7204 1702.4117,-6074.3243 1749.1377,-6138 1829.1077,-6246.9789 1705.2684,-6330.9473 1785.1377,-6440 1833.5242,-6506.0665 1908.1014,-6447.5066 1952.9868,-6516 1990.5519,-6573.3229 1975.2662,-8915.8524 1988.9868,-8983 2029.4628,-9181.087 2121.0554,-9205.8693 2161.3169,-9404 2177.3431,-9482.8666 2147.3079,-12237.9455 2197.3169,-12301 2219.1978,-12328.5888 2267.2491,-12285.4871 2274.2329,-12320"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-4830C1531.1499,-4710.294 1660.4131,-4813.8582 1749.1377,-4714 1787.8215,-4670.462 1744.0584,-4629.2854 1785.1377,-4588 1966.516,-4405.7116 2152.5398,-4304.655 2351.1489,-4468 2415.17,-4520.6538 2343.553,-4580.4982 2387.1489,-4651 2434.5822,-4727.7074 2495.2195,-4701.7101 2547.7793,-4775 2645.003,-4910.5697 2610.408,-4974.076 2669.7316,-5130"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-5130C2683.1807,-5166.7389 2731.0882,-5118.575 2755.6838,-5149 2780.0759,-5179.1732 2790.8229,-10697.2101 2791.6838,-10736 2810.5754,-11587.1653 2861.5628,-12633.327 2869.5706,-12794.6869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.0791,-12794.9472 2870.0718,-12804.7609 2873.0704,-12794.5993 2866.0791,-12794.9472"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-4830C1596.8031,-4580.178 1653.945,-4528.5983 1749.1377,-4266 1771.9143,-4203.1685 1742.2703,-4171.2733 1785.1377,-4120 1926.5287,-3950.8834 2613.1199,-3746.871 2755.6838,-3915 2809.9238,-3978.9665 2754.5635,-6858.7951 2791.6838,-6934 2811.4312,-6974.0078 2868.7649,-6951.4233 2870.6353,-6996"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge449" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-5058C1496.9804,-5037.5895 1641.2419,-4975.1644 1952.9868,-5151 2127.9962,-5249.7118 2480.0591,-5642.8274 2547.7793,-5832 2594.4507,-5962.3738 2572.9279,-10678.95 2583.7793,-10817 2600.7495,-11032.8925 2650.4433,-11291.0696 2665.4143,-11365.792"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.0285,-11366.7079 2667.4363,-11375.8187 2668.8903,-11365.3241 2662.0285,-11366.7079"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge584" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1275.5553,-5603.1439C1286.9753,-5642.3714 1328.8978,-5776.8303 1392.6204,-5872 1448.6626,-5955.6991 1501.8232,-5946.1576 1551.1179,-6034 1582.9804,-6090.7785 1557.9466,-6117.7931 1587.1179,-6176 1612.7453,-6227.1357 1645.3232,-6223.5445 1668.1278,-6276"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge683" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.9127,-5590.1224C1335.8041,-5587.078 1348.3424,-5581.3593 1356.6204,-5571 1413.5112,-5499.8054 1360.6361,-4016.3361 1392.6204,-3931 1431.2152,-3828.0264 1506.766,-3841.6282 1551.1179,-3741 1599.0556,-3632.2361 1504.6024,-3561.5499 1587.1179,-3476 1612.4837,-3449.7015 1656.7737,-3496.7292 1668.1278,-3462"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-3462C1725.8805,-3305.7266 1724.9565,-3260.8394 1749.1377,-3096 1764.9525,-2988.1931 1744.1304,-2707.9497 1785.1377,-2607 1828.8109,-2499.4873 1895.6058,-2507.865 1952.9868,-2407 1976.9655,-2364.85 1952.223,-2335.6232 1988.9868,-2304 2137.8745,-2175.9313 2708.8626,-2131.6504 2870.6353,-2243"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge663" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.2748,-5603.2298C1289.9959,-5643.5715 1336.5576,-5785.1784 1356.6204,-5906 1395.7314,-6141.5338 1327.281,-6212.3555 1392.6204,-6442 1501.3884,-6824.2806 1787.0204,-7229.063 1854.5863,-7321.4701"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1851.8547,-7323.6635 1860.5961,-7329.65 1857.4958,-7319.5189 1851.8547,-7323.6635"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge726" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.606,-5589.8715C1335.4926,-5586.8231 1348.105,-5581.165 1356.6204,-5571 1431.9998,-5481.017 1327.5741,-5141.7139 1392.6204,-5044 1468.5086,-4929.9991 1547.5107,-4970.8595 1668.1278,-4906"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-4906C1702.4976,-4876.4308 1725.8037,-4882.8735 1749.1377,-4844 1799.6774,-4759.8026 1710.2555,-4689.5305 1785.1377,-4626 1842.0228,-4577.7383 1892.0882,-4582.9133 1952.9868,-4626 1992.2315,-4653.7662 1963.8267,-4687.0357 1988.9868,-4728 2123.0981,-4946.3524 2156.0342,-5034.322 2387.1489,-5145 2444.8545,-5172.6345 2516.7884,-5178.398 2573.6371,-5177.3738"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2573.7991,-5180.8709 2583.7074,-5177.1192 2573.6221,-5173.8731 2573.7991,-5180.8709"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge746" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-4906C1691.0256,-4887.0045 1809.885,-4904.0559 1952.9868,-4968 2100.1337,-5033.7516 2472.4196,-5240.5346 2547.7793,-5383 2588.4226,-5459.8351 2580.9746,-8425.1228 2583.7793,-8512 2604.9143,-9166.6673 2658.6484,-9968.924 2668.2513,-10109.4901"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2664.7794,-10110.021 2668.9549,-10119.7583 2671.763,-10109.5424 2664.7794,-10110.021"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge837" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1322.6784,-5588.9402C1335.2548,-5585.8413 1347.6895,-5580.3902 1356.6204,-5571 1413.7465,-5510.9357 1329.5567,-5441.7967 1392.6204,-5388 1582.1115,-5226.3536 1774.2906,-5221.4946 1952.9868,-5395 2011.6211,-5451.931 1933.891,-5700.6381 1988.9868,-5761 2041.5593,-5818.5973 2099.4068,-5746.5821 2161.3169,-5794 2190.353,-5816.2392 2174.246,-5839.6202 2197.3169,-5868 2251.8422,-5935.072 2310.4898,-5910.7209 2351.1489,-5987 2407.3027,-6092.3481 2373.3613,-6404.4194 2387.1489,-6523 2408.0727,-6702.9548 2449.6691,-6917.9856 2463.1432,-6985.585"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.7937,-6986.6839 2465.1899,-6995.8016 2466.6574,-6985.3088 2459.7937,-6986.6839"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1668.1278,-13686C1679.1857,-13721.8862 1725.7165,-13680.648 1749.1377,-13710 1826.9157,-13807.4731 1742.0628,-14152.9745 1785.1377,-14270 1881.6891,-14532.3101 2070.1275,-14509.778 2161.3169,-14774 2216.9382,-14935.1632 2153.9774,-16143.1091 2197.3169,-16308 2234.2057,-16448.3483 2293.246,-16462.9373 2351.1489,-16596 2370.8336,-16641.236 2363.0038,-16657.9792 2387.1489,-16701 2676.43,-17216.4305 2961.0649,-17261.6556 3544.5469,-17356 3732.3024,-17386.3586 3824.9276,-17462.2854 3972.2545,-17342"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1478.2241,-13243.0365C1493.4653,-13270.0392 1532.2294,-13341.9835 1551.1179,-13407 1583.0496,-13516.9127 1512.3797,-13575.3129 1587.1179,-13662 1611.6381,-13690.4404 1656.6953,-13650.2314 1668.1278,-13686"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge986" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1668.1278,-13686C1679.1857,-13721.8862 1726.1635,-13680.2968 1749.1377,-13710 1821.3047,-13803.3044 1741.5224,-14661.403 1785.1377,-14771 1805.9691,-14823.3454 1834.93,-14821.1784 1869.0623,-14866"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1480.837,-13220.906C1498.4595,-13198.3114 1537.1071,-13144.6294 1551.1179,-13092 1599.9257,-12908.6606 1560.9455,-6449.911 1587.1179,-6262 1601.6117,-6157.9383 1643.0361,-6038.5253 1660.3619,-5991.5244"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.6463,-5992.7336 1663.8573,-5982.1408 1657.0866,-5990.29 1663.6463,-5992.7336"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge900" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1479.8988,-13243.2967C1524.5728,-13306.1895 1740.7888,-13611.1559 1749.1377,-13634 1805.8527,-13789.1818 1725.7856,-13849.8076 1785.1377,-14004 1839.7907,-14145.9845 1897.946,-14157.1061 1988.9868,-14279 2065.2095,-14381.054 2119.0102,-14387.854 2161.3169,-14508 2244.32,-14743.7189 2118.4388,-15394.8688 2197.3169,-15632 2388.9847,-16208.2109 2522.1016,-16355.6517 2985.5867,-16748 3101.307,-16845.9593 3475.0916,-17101.4035 3607.7534,-17028"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-17028C3690.938,-16979.9569 3756.7299,-16881.5534 3782.4158,-16839.1621"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3785.5684,-16840.7086 3787.6774,-16830.3258 3779.5539,-16837.1273 3785.5684,-16840.7086"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge570" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13378C1748.8889,-13442.5091 1725.3821,-13495.4045 1749.1377,-13596 1783.2489,-13740.4474 1711.227,-13799.2916 1785.1377,-13928 1831.3249,-14008.4306 1899.8822,-13975.959 1952.9868,-14052 1985.6001,-14098.6993 1960.5463,-14125.6484 1988.9868,-14175 2044.4469,-14271.2377 2118.4484,-14253.5314 2161.3169,-14356 2259.0524,-14589.6172 2106.2474,-15258.7045 2197.3169,-15495 2292.7322,-15742.5714 2392.6038,-15766.0228 2583.7793,-15950 2585.1363,-15951.3059 3435.5228,-16621.3048 3436.8809,-16620"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-16620C3666.3408,-16454.8902 3488.751,-16269.9951 3508.5469,-15988 3562.3223,-15221.9595 3603.399,-12631.142 3607.4285,-12370.2333"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3610.9292,-12370.2083 3607.5836,-12360.1556 3603.9301,-12370.1005 3610.9292,-12370.2083"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge627" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1480.4263,-13220.7864C1497.3102,-13197.9769 1534.6955,-13143.9275 1551.1179,-13092 1600.6713,-12935.3128 1531.1373,-12878.5076 1587.1179,-12724 1630.7076,-12603.6915 1709.4736,-12607.6592 1749.1377,-12486 1825.1549,-12252.8373 1700.6764,-11613.2385 1785.1377,-11383 1835.3481,-11246.1281 1896.0847,-11238.3575 1988.9868,-11126 2063.7558,-11035.573 2119.8212,-11035.7522 2161.3169,-10926 2221.6383,-10766.4553 2184.6116,-8026.0934 2197.3169,-7856 2253.8998,-7098.4928 2432.9759,-6179.8522 2463.1326,-6028.5551"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2466.6526,-6028.8013 2465.1816,-6018.3091 2459.7885,-6027.4286 2466.6526,-6028.8013"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge652" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1484.0136,-13220.7399C1517.3492,-13189.2923 1611.5486,-13096.7378 1668.1278,-13004"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1668.1278,-13004C1869.49,-12673.9518 1694.0087,-12517.7314 1785.1377,-12142 1837.463,-11926.2591 1845.4009,-11855.3079 1988.9868,-11686 2048.3841,-11615.9623 2116.4285,-11652.1146 2161.3169,-11572 2217.0749,-11472.486 2144.4431,-10647.076 2197.3169,-10546 2236.8841,-10470.3613 2311.4129,-10506.5501 2351.1489,-10431 2398.2527,-10341.4417 2382.9871,-9622.1046 2387.1489,-9521 2418.6089,-8756.728 2459.7894,-7817.62 2466.5166,-7664.5424"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2470.0288,-7664.34 2466.9715,-7654.1959 2463.0356,-7664.0325 2470.0288,-7664.34"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge708" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-13378C1748.8889,-13442.5091 1723.7909,-13495.7937 1749.1377,-13596 1777.3132,-13707.3891 1726.3491,-13753.2818 1785.1377,-13852 1808.8657,-13891.8442 1843.642,-13875.2135 1869.0623,-13914"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1869.0623,-13914C1904.1828,-13967.5874 1933.5637,-13961.8543 1988.9868,-13994 2063.0322,-14036.9467 2115.0981,-14007.9517 2161.3169,-14080 2227.106,-14182.5555 2145.3015,-15065.8173 2197.3169,-15176 2245.2884,-15277.6166 2289.269,-15287.8029 2387.1489,-15343 2647.3349,-15489.7258 2759.2752,-15373.9252 3056.4631,-15404"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge825" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1479.1507,-13220.7441C1494.0323,-13197.4196 1528.4375,-13141.8223 1551.1179,-13092 1571.0358,-13048.2463 1570.607,-13035.1497 1587.1179,-12990 1622.0459,-12894.4883 1639.4538,-12873.5717 1668.1278,-12776"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1668.1278,-12776C1678.7155,-12739.9723 1726.2093,-12781.7386 1749.1377,-12752 1828.3486,-12649.2621 1737.7169,-11705.7506 1785.1377,-11585 1878.0784,-11348.3393 2070.384,-11391.4394 2161.3169,-11154 2212.7827,-11019.6152 2180.3488,-8706.8989 2197.3169,-8564 2233.8536,-8256.3025 2310.5826,-8191.1922 2351.1489,-7884 2403.3838,-7488.4464 2346.4127,-7383.9026 2387.1489,-6987 2405.6841,-6806.4073 2449.0267,-6591.0366 2463.0218,-6523.9755"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2466.4477,-6524.6919 2465.077,-6514.1861 2459.597,-6523.2536 2466.4477,-6524.6919"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge872" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1869.0623,-13116C1907.8265,-13114.4558 1922.6991,-13115.7573 1952.9868,-13140 1979.0729,-13160.8797 1971.8908,-13177.2916 1988.9868,-13206 2061.0603,-13327.0294 2102.1902,-13344.1457 2161.3169,-13472 2184.6889,-13522.539 2170.9703,-13542.9459 2197.3169,-13592 2259.7078,-13708.164 2267.7513,-13764.0455 2387.1489,-13820 2538.5842,-13890.9686 2653.9181,-13876.7137 2755.6838,-13744 2811.069,-13671.7717 2748.3231,-13416.0268 2791.6838,-13336 2834.1933,-13257.5444 2910.2611,-13292.0989 2949.5867,-13212 2978.2215,-13153.676 2983.7937,-8598.9494 2985.5867,-8534 3002.1588,-7933.6681 3046.8094,-7198.3867 3055.1213,-7064.4489"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.6257,-7064.4866 3055.7539,-7054.2884 3051.6392,-7064.0516 3058.6257,-7064.4866"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13004C1720.4246,-12916.7791 1724.8203,-12888.7477 1749.1377,-12790 1780.8263,-12661.3194 1748.1331,-12621.2538 1785.1377,-12494 1833.5335,-12327.5734 1887.237,-12302.365 1952.9868,-12142 1971.5422,-12096.7431 1970.1981,-12083.1606 1988.9868,-12038 2055.8961,-11877.1764 2118.4828,-11854.8381 2161.3169,-11686 2208.5724,-11499.7343 2145.1235,-11006.9428 2197.3169,-10822 2235.4593,-10686.8457 2311.1799,-10680.6255 2351.1489,-10546 2417.462,-10322.6415 2359.9696,-10254.4038 2387.1489,-10023 2408.1975,-9843.7933 2449.7114,-9629.6481 2463.1539,-9562.3269"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.6597,-9562.6456 2465.1957,-9552.1524 2459.7965,-9561.2683 2466.6597,-9562.6456"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge527" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1869.0623,-13914C1893.1755,-13953.6123 1925.5202,-13938.6347 1952.9868,-13976 1981.9571,-14015.4109 1962.3958,-14038.9462 1988.9868,-14080 2046.134,-14168.2293 2118.1461,-14146.1538 2161.3169,-14242 2215.871,-14363.1189 2116.4389,-15331.6212 2197.3169,-15437 2382.3396,-15678.0725 2659.8642,-15337.0824 2870.6353,-15556"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13004C1685.7877,-12973.8372 1765.378,-12740.8309 1785.1377,-12712 1855.1549,-12609.8396 1879.3403,-12579.5916 1988.9868,-12522 2058.4225,-12485.5291 2109.8207,-12543.1573 2161.3169,-12484 2228.0572,-12407.3307 2148.0576,-12116.9155 2197.3169,-12028 2238.5553,-11953.5626 2308.9874,-11987.9185 2351.1489,-11914 2427.7497,-11779.7021 2325.8036,-11709.9167 2387.1489,-11568 2430.4879,-11467.7392 2499.393,-11479.9247 2547.7793,-11382 2648.0906,-11178.9891 2666.0014,-10896.9002 2669.1021,-10818.1512"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.6039,-10818.1592 2669.4602,-10808.0415 2665.6083,-10817.9113 2672.6039,-10818.1592"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1869.0623,-13838C1995.1847,-13938.0545 2085.9843,-13909.7229 2161.3169,-14052 2214.5902,-14152.6148 2131.1835,-14983.3299 2197.3169,-15076 2400.2578,-15360.3731 2663.7747,-15504.9095 2949.5867,-15304 3199.6262,-15128.2364 3240.8595,-14032.7487 3245.7201,-13865.4249"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3249.2303,-13865.1004 3246.0096,-13855.007 3242.233,-13864.9058 3249.2303,-13865.1004"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge424" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-13378C1771.9023,-13456.3973 1835.1642,-13389.9263 1952.9868,-13445 1971.1052,-13453.4691 1972.0672,-13461.3357 1988.9868,-13472 2062.0856,-13518.0736 2112.1529,-13490.943 2161.3169,-13562 2236.7211,-13670.982 2125.1888,-13746.8226 2197.3169,-13858 2250.8799,-13940.5614 2292.3107,-13945.7114 2387.1489,-13972 2544.9904,-14015.7527 2626.4144,-14072.5865 2755.6838,-13972 2807.0683,-13932.0169 2772.3894,-13892.1831 2791.6838,-13830 2851.7696,-13636.3526 2912.5297,-13601.3398 2949.5867,-13402 2962.4934,-13332.5713 2944.3869,-10917.3542 2985.5867,-10860 2987.8514,-10856.8473 2990.5469,-10854.0898 2993.5425,-10851.6781"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6465,-10854.4837 3002.0832,-10846.0682 2991.8034,-10848.6329 2995.6465,-10854.4837"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge437" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1480.656,-13220.8558C1497.9531,-13198.171 1536.0444,-13144.335 1551.1179,-13092 1575.3145,-13007.9902 1540.3616,-12379.8712 1587.1179,-12306 1630.7185,-12237.1146 1706.6659,-12289.587 1749.1377,-12220 1788.7204,-12155.1464 1780.5373,-9560.8394 1785.1377,-9485 1803.3061,-9185.4829 1853.0782,-8823.3676 1865.9767,-8732.4763"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1869.4769,-8732.7226 1867.4239,-8722.3286 1862.547,-8731.7342 1869.4769,-8732.7226"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge480" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1488.0947,-13243.1796C1504.2098,-13254.3499 1529.5594,-13272.102 1551.1179,-13288 1603.9214,-13326.9391 1613.8025,-13341.2139 1668.1278,-13378"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-13378C1778.4496,-13452.7039 1678.0454,-13181.2642 1785.1377,-13102 2102.9271,-12866.7886 2388.1754,-13285.5619 2669.7316,-13008"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge501" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1668.1278,-13004C1720.4246,-12916.7791 1718.7509,-12887.052 1749.1377,-12790 1768.8491,-12727.044 1759.7104,-12706.8724 1785.1377,-12646 1812.8064,-12579.7618 1832.1473,-12569.5657 1869.0623,-12508"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2075.1519,-12052C2094.1142,-11996.4816 2139.0102,-12006.2611 2161.3169,-11952 2205.5276,-11844.4574 2176.2086,-11544.3435 2197.3169,-11430 2239.8331,-11199.6898 2306.4294,-11155.8926 2351.1489,-10926 2385.908,-10747.3115 2319.643,-10687.0584 2387.1489,-10518 2400.3651,-10484.9021 2428.17,-10453.9375 2447.3288,-10435.2358"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.8604,-10437.6583 2454.6947,-10428.2306 2445.0364,-10432.5859 2449.8604,-10437.6583"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1869.0623,-12508C1880.8284,-12488.3768 1975.6689,-12132.605 1988.9868,-12114 2016.4482,-12075.6368 2059.264,-12096.4234 2075.1519,-12052"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.6507,-13243.1971C1485.5783,-13287.4687 1526.1852,-13454.675 1551.1179,-13594 1571.5128,-13707.9671 1563.5409,-13738.6485 1587.1179,-13852 1608.4687,-13954.6485 1645.8794,-14074.4497 1661.2437,-14122.0065"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.9949,-14123.3342 1664.4147,-14131.7625 1664.652,-14121.1703 1657.9949,-14123.3342"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-13116C2028.2374,-13102.297 2193.3369,-13361.5137 2197.3169,-13364 2415.4479,-13500.2627 2564.2686,-13687.7814 2755.6838,-13516 2810.9145,-13466.4345 2779.8846,-13257.2662 2791.6838,-13184 2813.1605,-13050.6427 2851.4327,-12892.7023 2865.372,-12836.8357"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2868.7856,-12837.6119 2867.8232,-12827.0609 2861.9959,-12835.9092 2868.7856,-12837.6119"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13378C1753.401,-13435.7423 1716.312,-13254.6075 1785.1377,-13178 1816.1304,-13143.5031 1822.7246,-13117.8459 1869.0623,-13116"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-13378C1775.6008,-13454.8397 2093.745,-13596.471 2161.3169,-13710 2247.1779,-13854.2568 2117.0889,-13938.5362 2197.3169,-14086 2302.0178,-14278.4463 2376.8639,-14320.0009 2583.7793,-14392 2655.9377,-14417.1085 2689.9347,-14430.9142 2755.6838,-14392 2961.92,-14269.9374 3036.159,-13950.7152 3052.6681,-13865.286"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3056.1122,-13865.9094 3054.5126,-13855.436 3049.2318,-13864.621 3056.1122,-13865.9094"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge455" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13004C1760.6212,-12848.0647 1857.7383,-12866.2679 1952.9868,-12712 1978.6836,-12670.3806 1956.7129,-12644.7545 1988.9868,-12608 2045.4666,-12543.6791 2111.4077,-12591.5429 2161.3169,-12522 2229.5923,-12426.866 2156.0336,-12370.5796 2197.3169,-12261 2241.0649,-12144.8781 2300.6232,-12141.3373 2351.1489,-12028 2376.9579,-11970.1063 2364.733,-11949.29 2387.1489,-11890 2443.1449,-11741.891 2489.6014,-11719.2656 2547.7793,-11572 2568.7077,-11519.0241 2550.9011,-11495.5131 2583.7793,-11449 2597.5891,-11429.4631 2619.5454,-11413.7773 2637.8096,-11403.0709"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2639.692,-11406.0278 2646.6935,-11398.0761 2636.2614,-11399.9261 2639.692,-11406.0278"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge596" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1480.6457,-13220.8528C1497.9241,-13198.1627 1535.9836,-13144.3174 1551.1179,-13092 1574.24,-13012.0699 1539.2205,-12412.0389 1587.1179,-12344 1631.9734,-12280.2822 1704.8198,-12341.0929 1749.1377,-12277 1821.9089,-12171.7578 1746.6592,-11248.0286 1785.1377,-11126 1843.6314,-10940.4963 2003.5582,-10759.0022 2057.2805,-10701.6191"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2060.0904,-10703.7413 2064.4114,-10694.0676 2055.001,-10698.9353 2060.0904,-10703.7413"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge687" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-13378C1730.7156,-13427.9929 1723.7443,-13463.0284 1749.1377,-13539 1777.6304,-13624.2443 1746.9687,-13656.6271 1785.1377,-13738 1809.7778,-13790.5305 1824.799,-13800.4854 1869.0623,-13838"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-13838C1970.7224,-13924.1603 2075.7029,-13802.8794 2161.3169,-13905 2212.7775,-13966.3824 2155.4658,-14556.703 2197.3169,-14625 2375.3099,-14915.4679 2658.1161,-14948.3463 2949.5867,-14772 3037.1616,-14719.0152 2975.0807,-14630.0778 3056.4631,-14568"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge667" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1480.6818,-13220.8632C1498.0253,-13198.1917 1536.196,-13144.3784 1551.1179,-13092 1578.5384,-12995.7497 1525.6484,-12270.9779 1587.1179,-12192 1633.2461,-12132.7331 1703.9416,-12203.9808 1749.1377,-12144 1783.6752,-12098.1645 1781.32,-8069.2639 1785.1377,-8012 1802.3104,-7754.4164 1851.9018,-7444.2717 1865.5494,-7361.9075"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1869.0055,-7362.4601 1867.1969,-7352.0208 1862.1007,-7361.3095 1869.0055,-7362.4601"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge788" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1480.6957,-13220.8672C1498.0641,-13198.2028 1536.2774,-13144.4015 1551.1179,-13092 1580.6881,-12987.5883 1521.0848,-12202.1152 1587.1179,-12116 1593.8379,-12107.2363 1603.5777,-12101.4621 1613.9899,-12097.6779"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1615.1245,-12100.9913 1623.6738,-12094.7334 1613.0881,-12094.294 1615.1245,-12100.9913"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge731" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-12052C2104.4812,-11969.9936 2130.947,-11957.6268 2161.3169,-11876 2190.2415,-11798.2577 2333.8263,-11235.1198 2351.1489,-11154 2371.6567,-11057.9641 2369.5728,-11032.6154 2387.1489,-10936 2419.9149,-10755.8868 2441.3133,-10713.1919 2467.4641,-10532"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge751" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1869.0623,-12508C1983.0251,-12317.936 2074.0241,-12307.6954 2161.3169,-12104 2195.8596,-12023.3956 2155.7289,-11987.2057 2197.3169,-11910 2242.31,-11826.473 2309.8088,-11847.394 2351.1489,-11762 2423.1415,-11613.2887 2349.8017,-11552.9446 2387.1489,-11392 2433.0761,-11194.0811 2497.0787,-11160.7502 2547.7793,-10964 2589.4318,-10802.3619 2653.8375,-10266.0538 2667.2381,-10152.3146"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2670.7446,-10152.4636 2668.4353,-10142.1235 2663.7924,-10151.6468 2670.7446,-10152.4636"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge843" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-12776C1678.6398,-12739.9501 1726.1438,-12781.688 1749.1377,-12752 1818.6468,-12662.2552 1734.157,-11832.4229 1785.1377,-11731 1837.2354,-11627.3548 1889.2016,-11627.1557 1988.9868,-11568 2060.3898,-11525.6701 2114.6639,-11564.6564 2161.3169,-11496 2191.4535,-11451.6498 2192.7222,-9619.4232 2197.3169,-9566 2235.7734,-9118.8568 2308.3512,-9014.7486 2351.1489,-8568 2391.2299,-8149.6108 2351.942,-8041.8275 2387.1489,-7623 2406.8241,-7388.9408 2451.151,-7107.2943 2463.9453,-7028.4309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2467.4427,-7028.7294 2465.5975,-7018.2965 2460.534,-7027.603 2467.4427,-7028.7294"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~windowequivalentlayer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~windowequivalentlayer.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1907.9892,-9493.9452C2111.3485,-9435.8481 3045.4686,-9164.596 3127.3396,-9061 3264.8649,-8886.9816 3793.0091,-1251.6395 3972.2545,-1121"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge988" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M1874.2306,-9516.2742C1889.9355,-9551.2213 1936.9967,-9661.2043 1952.9868,-9758 1998.6603,-10034.4822 1911.2672,-14532.7638 1988.9868,-14802 2002.7117,-14849.5457 2037.6895,-14896.7826 2058.6181,-14922.0912"/>
<polygon fill="#ff0066" stroke="#ff0066" points="2056.0015,-14924.4175 2065.126,-14929.8022 2061.351,-14919.9027 2056.0015,-14924.4175"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge886" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1932.1113,-9500.5884C2114.6375,-9485.8161 2655.9688,-9427.7885 3056.4631,-9238"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3056.4631,-9238C3302.6339,-9055.9934 3470.5979,-8551.2943 3607.7534,-8825"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge554" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3056.4631,-9238C3211.2719,-9170.0262 3294.3094,-9147.1178 3436.8809,-9238"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge641" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1871.1707,-9493.9797C1881.0801,-9442.0072 1923.7655,-9216.141 1952.9868,-9030 1971.2153,-8913.8836 1957.7101,-8881.3008 1988.9868,-8768 2022.0461,-8648.242 2394.8859,-7806.469 2458.3171,-7663.5873"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2461.6278,-7664.7556 2462.4877,-7654.1957 2455.2302,-7661.9146 2461.6278,-7664.7556"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge710" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1873.0925,-9493.8445C1885.5826,-9460.5802 1926.5936,-9360.6327 1988.9868,-9300 2025.0925,-9264.9131 2461.8719,-9048 2467.4641,-9048 2467.4641,-9048 2467.4641,-9048 2870.6353,-9048 2985.2236,-9048 3048.078,-9106.7532 3127.3396,-9024 3166.047,-8983.5875 3326.7913,-5055.9067 3329.2148,-5000 3382.2052,-3777.5869 3430.09,-2269.1793 3436.2198,-2074.1148"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3439.7207,-2074.1385 3436.5361,-2064.0337 3432.7241,-2073.9189 3439.7207,-2074.1385"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge856" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1879.998,-9493.9491C1898.8347,-9474.1107 1936.9234,-9430.2845 1952.9868,-9385 1990.4512,-9279.3842 1932.2938,-8978.6653 1988.9868,-8882 2086.4266,-8715.8589 2194.3608,-8755.8697 2351.1489,-8644 2441.0654,-8579.8438 2465.0461,-8565.1861 2547.7793,-8492 2646.1504,-8404.9806 2691.6523,-8396.67 2755.6838,-8282 3004.2287,-7836.897 3049.0085,-7189.86 3055.493,-7064.4803"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.9989,-7064.4447 3055.9934,-7054.2851 3052.0073,-7064.1014 3058.9989,-7064.4447"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-9580C2324.5877,-9577.3791 2380.9852,-9564.8571 2419.7911,-9554.6988"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2420.9959,-9557.9998 2429.756,-9552.0408 2419.1918,-9551.2363 2420.9959,-9557.9998"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1921.1811,-9516.0544C2022.5493,-9537.3477 2239.4057,-9581.8127 2274.2329,-9580"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge515" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2075.1519,-9580C2110.689,-9606.41 2124.8514,-9604.8874 2161.3169,-9630 2441.1968,-9822.7441 2592.0786,-9813.147 2755.6838,-10111 2823.3109,-10234.1192 2740.2441,-10294.2877 2791.6838,-10425 2813.3261,-10479.9947 2838.071,-10482.6809 2870.6353,-10532"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2870.6353,-10532C3006.2039,-10705.1326 3096.2507,-10693.2337 3246.2772,-10854"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3246.2772,-10854C3348.2891,-10970.884 3424.8804,-12154.3708 3435.5948,-12327.8254"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3432.1109,-12328.1962 3436.2168,-12337.9631 3439.0978,-12327.7675 3432.1109,-12328.1962"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1927.0524,-9516.0435C1971.1395,-9526.6799 2031.4526,-9546.26 2075.1519,-9580"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-9580C2114.0489,-9606.6999 2137.2935,-9601.3954 2161.3169,-9642 2228.5736,-9755.6779 2147.2783,-9814.7615 2197.3169,-9937 2239.8005,-10040.7825 2283.1419,-10047.8333 2351.1489,-10137 2439.0103,-10252.1985 2481.9435,-10267.942 2547.7793,-10397 2617.0377,-10532.7674 2654.7163,-10714.8567 2666.0339,-10775.9932"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.6136,-10776.7479 2667.8421,-10785.9627 2669.5013,-10775.4986 2662.6136,-10776.7479"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge445" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1881.0898,-9516.0058C1928.0083,-9559.8323 2099.1972,-9728.2953 2161.3169,-9908 2229.7576,-10105.9907 2119.6434,-10655.446 2197.3169,-10850 2223.2676,-10915.0005 2569.9357,-11282.0309 2652.2754,-11368.6729"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2649.7686,-11371.1158 2659.1963,-11375.9499 2654.8409,-11366.2917 2649.7686,-11371.1158"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge592" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1874.032,-9516.3093C1889.1654,-9551.3578 1934.7563,-9661.6011 1952.9868,-9758 2008.5651,-10051.8857 1932.2398,-10136.3377 1988.9868,-10430 2006.2289,-10519.2266 2047.5209,-10620.0079 2065.9726,-10662.4403"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2062.8173,-10663.96 2070.0447,-10671.707 2069.2259,-10661.1439 2062.8173,-10663.96"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge676" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1879.6318,-9493.811C1897.9018,-9473.7588 1935.141,-9429.6122 1952.9868,-9385 1992.5572,-9286.0794 1927.9157,-9235.3008 1988.9868,-9148 2151.3823,-8915.8566 2973.9158,-8812.168 3127.3396,-8574 3128.9532,-8571.4952 3235.8543,-5299.1603 3245.572,-5001.5981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3249.0806,-5001.3887 3245.9089,-4991.2797 3242.0843,-5001.1601 3249.0806,-5001.3887"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge951" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M635.2697,-3737.1047C641.645,-3740.5591 647.3661,-3745.0815 651.5354,-3751 678.407,-3789.1459 686.0897,-10423.362 687.5354,-10470 699.8853,-10868.3901 735.2842,-11354.009 743.2793,-11460.6489"/>
<polygon fill="#9900ff" stroke="#9900ff" points="739.8006,-11461.0649 744.0417,-11470.7738 746.7809,-11460.5392 739.8006,-11461.0649"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-3917C960.994,-3931.4988 971.5178,-3939.1987 1002.022,-3970 1012.9902,-3981.0751 1145.009,-4193.1639 1152.1868,-4207 1171.4568,-4244.1454 1168.5653,-4257.0391 1188.1868,-4294 1251.8743,-4413.9678 1314.8473,-4419.7584 1356.6204,-4549 1386.2733,-4640.7432 1341.6034,-5334.1869 1392.6204,-5416 1435.0276,-5484.0061 1509.435,-5433.5475 1551.1179,-5502 1602.4445,-5586.2894 1568.376,-7181.1091 1587.1179,-7278 1625.7454,-7477.694 1709.0295,-7506.5982 1749.1377,-7706 1794.0816,-7929.443 1768.8423,-8503.6651 1785.1377,-8731 1806.5915,-9030.2997 1853.9508,-9392.5746 1866.1505,-9483.5122"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1862.7144,-9484.2219 1867.5181,-9493.6652 1869.6517,-9483.2874 1862.7144,-9484.2219"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-3955C815.5258,-3991.9195 845.7267,-3888.4688 920.1405,-3917"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M628.933,-3737.0177C637.1306,-3740.5019 645.0943,-3745.0573 651.5354,-3751 724.8198,-3818.6137 656.5311,-3908.8086 744.8972,-3955"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge553" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.6214,-3714.717C596.6978,-3670.0977 637.0959,-3501.502 651.5354,-3360 663.0087,-3247.5662 645.0832,-1430.7416 687.5354,-1326 705.9445,-1280.5796 800.343,-1196.0529 838.259,-1165 1361.5651,-736.416 1531.2243,-597.7034 2197.3169,-480 2213.8981,-477.07 2525.6317,-478.9358 2547.7793,-481 2641.3067,-489.7169 2672.3131,-475.7254 2755.6838,-519 2807.7367,-546.0187 3485.7419,-1204.9681 3508.5469,-1259 3549.4845,-1355.9937 3543.3491,-8733.7278 3544.5469,-8839 3561.2115,-10303.6429 3602.2919,-12111.7297 3607.2592,-12327.6149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.7667,-12327.9853 3607.4963,-12337.902 3610.7648,-12327.8239 3603.7667,-12327.9853"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge608" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M640.7773,-3720.7663C671.9592,-3719.348 710.8843,-3719.8327 744.8972,-3727"/>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M744.8972,-3727C891.3682,-3757.8649 1273.6601,-3884.4048 1356.6204,-4009 1408.0877,-4086.297 1333.5601,-4772.3369 1392.6204,-4844 1438.691,-4899.9017 1504.0569,-4826.9295 1551.1179,-4882 1617.1548,-4959.2759 1560.8702,-5239.7987 1587.1179,-5338 1684.9548,-5704.0403 1866.6885,-5739.0689 1952.9868,-6108 2009.9609,-6351.5683 1969.2699,-8109.6352 1988.9868,-8359 2031.6995,-8899.1985 2119.4671,-9025.7339 2161.3169,-9566 2185.4576,-9877.6476 2130.1234,-12073.7263 2197.3169,-12379 2210.1337,-12437.2294 2243.692,-12499.7352 2261.9581,-12530.9083"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2259.1803,-12533.0841 2267.3057,-12539.8833 2265.1938,-12529.5011 2259.1803,-12533.0841"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge625" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1272.4036,-3385C1303.9001,-3419.1798 1333.4412,-3406.7133 1356.6204,-3447 1430.6379,-3575.647 1324.4018,-3647.1862 1392.6204,-3779 1489.8048,-3966.7825 1614.1687,-3931.2411 1749.1377,-4094 1862.0921,-4230.2116 1896.8054,-4268.2027 1952.9868,-4436 1999.8289,-4575.9033 1940.7014,-4626.5883 1988.9868,-4766 1989.3753,-4767.1217 2350.7239,-5344.8916 2351.1489,-5346 2363.0232,-5376.9647 2445.7887,-5875.7467 2463.9475,-5985.6764"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2460.5446,-5986.552 2465.6267,-5995.8484 2467.4511,-5985.4118 2460.5446,-5986.552"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1095.1044,-3309C1137.7265,-3304.4248 1243.5048,-3353.3386 1272.4036,-3385"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge640" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1095.1044,-3385C1204.8646,-3443.6281 1282.9135,-3384.741 1356.6204,-3485 1432.717,-3588.5096 1341.1877,-3944.2731 1392.6204,-4062 1484.5572,-4272.4389 1642.9878,-4232.3603 1749.1377,-4436 1786.4459,-4507.5728 1750.2894,-4541.1978 1785.1377,-4614 1835.5352,-4719.2865 1909.2641,-4707.7712 1952.9868,-4816 2033.4522,-5015.1795 1896.4352,-5104.1409 1988.9868,-5298 2034.2762,-5392.8635 2111.8472,-5367.2479 2161.3169,-5460 2207.5306,-5546.6473 2153.5798,-5590.0766 2197.3169,-5678 2241.5387,-5766.898 2312.9478,-5748.3534 2351.1489,-5840 2401.9157,-5961.7925 2376.6062,-6895.4723 2387.1489,-7027 2405.9161,-7261.1337 2450.88,-7542.728 2463.8846,-7621.5741"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2460.4759,-7622.4134 2465.5645,-7631.7062 2467.3816,-7621.2684 2460.4759,-7622.4134"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M920.1405,-3347C990.7053,-3383.7795 1024.6116,-3348.0828 1095.1044,-3385"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge704" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.6155,-3714.7164C596.6702,-3670.0949 636.9976,-3501.4919 651.5354,-3360 662.2465,-3255.752 643.5217,-1569.1061 687.5354,-1474 781.8981,-1270.0984 1294.5681,-974.0018 1471.8691,-836"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-836C1821.0117,-658.9372 1987.5204,-638.9964 2351.1489,-784 2724.6062,-932.923 3063.6255,-1289.5607 3329.2148,-1797 3362.2108,-1860.0427 3335.9207,-1888.1543 3365.2148,-1953 3379.2324,-1984.0293 3403.5811,-2015.19 3419.9593,-2034.2868"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3417.4291,-2036.7103 3426.6474,-2041.9327 3422.6979,-2032.1015 3417.4291,-2036.7103"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge798" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M920.1405,-1676C937.221,-1655.451 1366.0178,-1588.5111 1392.6204,-1586 1462.752,-1579.38 1480.9145,-1580.1904 1551.1179,-1586 1640.0365,-1593.3584 1661.2735,-1603.4907 1749.1377,-1619 1839.895,-1635.02 1870.8479,-1615.2062 1952.9868,-1657 2277.1304,-1821.9302 2302.9291,-1950.0773 2547.7793,-2219 2648.7977,-2329.95 2690.6899,-2349.758 2755.6838,-2485 2785.7552,-2547.5737 2773.7305,-2569.9371 2791.6838,-2637 2855.0248,-2873.604 2913.0048,-2922.8114 2949.5867,-3165 2981.9313,-3379.1358 2979.444,-6846.5223 2985.5867,-7063 3002.621,-7663.3189 3046.8969,-8398.6109 3055.1338,-8532.5508"/>
<polygon fill="#003fff" stroke="#003fff" points="3051.6514,-8532.9459 3055.7606,-8542.7114 3058.6381,-8532.5148 3051.6514,-8532.9459"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M744.8972,-3005C760.1221,-2970.6858 786.9631,-2977.2826 802.259,-2943 917.4759,-2684.7659 718.7495,-1874.4979 920.1405,-1676"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M585.0332,-3714.7526C602.3258,-3628.5556 714.1975,-3074.1915 744.8972,-3005"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge814" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1272.4036,-3385C1303.7373,-3419.3291 1333.9283,-3406.437 1356.6204,-3447 1449.8191,-3613.5968 1305.9731,-3704.9037 1392.6204,-3875 1444.4678,-3976.7812 1498.9217,-3970.4122 1587.1179,-4043 1657.7627,-4101.1425 1698.4557,-4093.8254 1749.1377,-4170 1782.5847,-4220.2705 1764.3964,-4244.2935 1785.1377,-4301 1846.195,-4467.9298 1904.2262,-4493.0733 1952.9868,-4664 1988.858,-4789.7439 1947.0637,-4832.1423 1988.9868,-4956 2091.0549,-5257.5499 2255.6427,-5270.3081 2351.1489,-5574 2411.7391,-5766.6654 2362.3235,-5826.5635 2387.1489,-6027 2409.0594,-6203.9018 2450.003,-6415.4304 2463.2279,-6481.9322"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2459.8445,-6482.8625 2465.2358,-6491.983 2466.7089,-6481.4911 2459.8445,-6482.8625"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge854" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1272.4036,-1296C1511.3879,-1205.1487 2172.2048,-1513.3898 2351.1489,-1696 2474.1335,-1821.5043 2475.0254,-1879.0518 2547.7793,-2039 2568.0313,-2083.5236 2558.4921,-2101.1306 2583.7793,-2143 2706.6397,-2346.4266 2859.5548,-2313.0652 2949.5867,-2533 2995.1298,-2644.2553 3051.6508,-6692.6465 3056.1731,-7021.7772"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.6751,-7021.9527 3056.312,-7031.9038 3059.6745,-7021.8567 3052.6751,-7021.9527"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-3385C1136.4533,-3406.6545 1316.4201,-3608.514 1356.6204,-3713 1429.1436,-3901.498 1335.103,-3972.3951 1392.6204,-4166 1429.7235,-4290.8902 1916.8634,-5070.8229 1952.9868,-5196 2022.7521,-5437.7552 1959.1779,-5511.1516 1988.9868,-5761 2099.218,-6684.9199 2239.084,-6899.3008 2351.1489,-7823 2435.1943,-8515.747 2462.6779,-9373.5624 2466.871,-9519.4443"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2463.38,-9519.8154 2467.1611,-9529.7125 2470.3772,-9519.6176 2463.38,-9519.8154"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge511" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1471.8691,-836C1752.5936,-712.7056 1861.7416,-794.713 2161.3169,-860 2250.6052,-879.4588 2270.94,-895.2098 2351.1489,-939 2444.4129,-989.9176 2468.0624,-1004.7434 2547.7793,-1075 2841.6504,-1333.9962 2942.5858,-1393.5941 3127.3396,-1739 3153.4015,-1787.7239 3138.2656,-1808.7605 3163.3396,-1858 3218.7466,-1966.8064 3290.0387,-1961.354 3329.2148,-2077 3361.1887,-2171.3854 3363.8121,-9152.3558 3365.2148,-9252 3383.3352,-10539.1577 3430.2202,-12126.7238 3436.241,-12327.7454"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3432.7465,-12327.9821 3436.545,-12337.8726 3439.7433,-12327.772 3432.7465,-12327.9821"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge541" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~pollutionanalysismodule.f90</title>
<path fill="none" stroke="#0091ff" stroke-dasharray="5,2" d="M744.8972,-11521C746.5813,-11553.385 820.8361,-13826.6493 838.259,-13854 840.8951,-13858.1381 1148.0063,-14013.4315 1152.1868,-14016 1169.0029,-14026.3319 1170.4758,-14033.2906 1188.1868,-14042 1196.7193,-14046.1959 1206.0906,-14049.8308 1215.3862,-14052.9291"/>
<polygon fill="#0091ff" stroke="#0091ff" points="1214.4176,-14056.2935 1225.0073,-14055.9647 1216.5238,-14049.6179 1214.4176,-14056.2935"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-3879C953.1498,-3897.6689 966.7599,-3889.0456 1002.022,-3903 1071.5746,-3930.5243 1096.1316,-3929.4725 1152.1868,-3979 1274.203,-4086.8076 1305.5872,-4128.3842 1356.6204,-4283 1411.6327,-4449.6716 1322.6528,-4911.0332 1392.6204,-5072 1432.7748,-5164.379 1510.8746,-5141.6596 1551.1179,-5234 1618.4024,-5388.3876 1542.9729,-5828.4764 1587.1179,-5991 1627.7648,-6140.6447 1697.0013,-6153.9606 1749.1377,-6300 1758.9538,-6327.4958 1844.9226,-6760.9122 1864.919,-6862.0263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1861.5094,-6862.8266 1866.8822,-6871.958 1868.3765,-6861.4691 1861.5094,-6862.8266"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-3727C771.939,-3732.6983 779.6296,-3735.1368 802.259,-3751 865.5875,-3795.3931 856.2305,-3835.4483 920.1405,-3879"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-5473C2476.5778,-5509.1233 2525.4089,-5467.2087 2547.7793,-5497 2586.5936,-5548.6903 2579.2578,-10086.5175 2583.7793,-10151 2601.1261,-10398.3871 2651.7794,-10695.7249 2665.9874,-10776.1171"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.5467,-10776.7601 2667.7431,-10785.9932 2669.4387,-10775.5349 2662.5467,-10776.7601"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-3347C987.3761,-3389.5617 1015.9843,-3317.493 1095.1044,-3309"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-3309C1210.8353,-3296.5771 1256.1464,-3236.2381 1356.6204,-3295 1384.7918,-3311.476 1374.1459,-3332.0968 1392.6204,-3359 1397.0181,-3365.4041 1745.6215,-3783.0726 1749.1377,-3790 1778.6064,-3848.057 1752.4649,-3875.6839 1785.1377,-3932 1837.166,-4021.6781 1905.6159,-4001.7769 1952.9868,-4094 2003.2728,-4191.8984 1954.1267,-4234.6086 1988.9868,-4339 2095.5844,-4658.2154 2253.7993,-4681.8439 2351.1489,-5004 2377.4133,-5090.9159 2343.5541,-5331.3527 2387.1489,-5411 2408.8001,-5450.5565 2456.4328,-5429.2759 2467.4641,-5473"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1272.4036,-1296C1731.4158,-1119.0205 1974.4963,-1227.5404 2351.1489,-1544 2670.5166,-1812.3294 2751.1214,-1900.1104 2949.5867,-2267 3076.6525,-2501.8982 3086.7974,-2577.0318 3127.3396,-2841 3161.1888,-3061.3902 3159.7335,-10645.0547 3163.3396,-10868 3183.3168,-12103.0957 3238.2762,-13625.7802 3245.4919,-13822.6861"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3242.0009,-13822.9976 3245.8656,-13832.8623 3248.9962,-13822.7406 3242.0009,-13822.9976"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.2216,-3714.9796C594.953,-3670.6735 631.4345,-3501.1358 651.5354,-3360 663.1522,-3278.4338 647.1428,-3062.8084 687.5354,-2991 718.777,-2935.4599 772.9319,-2961.5744 802.259,-2905 865.8473,-2782.3329 782.8157,-1788.5572 838.259,-1662 925.522,-1462.8099 1000.0932,-1429.1437 1188.1868,-1320 1221.8499,-1300.4666 1234.1485,-1303.1631 1272.4036,-1296"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2870.6353,-3497C2877.3837,-3541.1026 2929.9514,-3518.9371 2949.5867,-3559 2984.3855,-3630.0019 2983.5679,-9172.9547 2985.5867,-9252 3001.914,-9891.3063 3047.0323,-10674.8639 3055.1901,-10813.532"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.7059,-10813.904 3055.7891,-10823.6804 3058.6938,-10813.4916 3051.7059,-10813.904"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-1676C970.6953,-1626.1714 1485.0994,-1749.9188 1551.1179,-1776 1582.216,-1788.2856 2529.8083,-2422.8031 2547.7793,-2451 2601.9731,-2536.0314 2530.8497,-2589.176 2583.7793,-2675 2608.5044,-2715.0911 2648.2196,-2695.097 2669.7316,-2737"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2669.7316,-2737C2695.5445,-2789.6148 2733.7679,-2782.6464 2755.6838,-2837 2782.1523,-2902.6445 2747.9464,-3417.351 2791.6838,-3473 2814.3466,-3501.8349 2865.0879,-3460.747 2870.6353,-3497"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge465" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-3005C776.4849,-2933.8071 849.5708,-3037.9565 920.1405,-3005"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-3005C954.501,-2988.9534 974.5691,-3007.1625 1002.022,-2981 1037.4309,-2947.2554 998.1779,-2905.3715 1038.022,-2877 1223.783,-2744.7265 1334.1412,-2806.8248 1551.1179,-2877 2071.0566,-3045.1601 2156,-3216.0498 2547.7793,-3597 2566.6439,-3615.3432 2566.6952,-3623.988 2583.7793,-3644 2655.8127,-3728.3787 2714.1596,-3722.1199 2755.6838,-3825 2780.2727,-3885.9212 2789.9829,-8489.3257 2791.6838,-8555 2810.4802,-9280.7367 2860.8401,-10171.2934 2869.3926,-10319.6046"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.903,-10319.8875 2869.9746,-10329.6687 2872.8913,-10319.4833 2865.903,-10319.8875"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge496" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M920.1405,-3347C973.0434,-3374.5738 1115.5583,-3434.9108 1152.1868,-3482 1187.9454,-3527.9709 1155.7666,-3559.6168 1188.1868,-3608 1241.2827,-3687.2393 1312.4193,-3656.476 1356.6204,-3741 1417.1823,-3856.8102 1356.6443,-4202.3597 1392.6204,-4328 1442.5745,-4502.4563 1487.2652,-4535.4749 1587.1179,-4687 1651.0194,-4783.9696 1705.1559,-4784.5193 1749.1377,-4892 1805.3481,-5029.3646 1733.3747,-5084.8985 1785.1377,-5224 1830.9157,-5347.0182 1912.3817,-5342.1788 1952.9868,-5467 2003.4259,-5622.0513 1971.7283,-6771.8669 1988.9868,-6934 2032.4652,-7342.4519 2094.0688,-7436.7828 2161.3169,-7842 2162.8488,-7851.231 2350.2964,-9166.6817 2351.1489,-9176 2386.6107,-9563.5991 2337.2457,-9664.9945 2387.1489,-10051 2404.3518,-10184.0656 2445.9674,-10340.2875 2461.4925,-10395.9811"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2458.1605,-10397.062 2464.2346,-10405.7428 2464.8997,-10395.1689 2458.1605,-10397.062"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-3955C849.3077,-4009.0106 921.3294,-3931.5167 1002.022,-4017 1063.7189,-4082.3599 1000.8518,-4134.166 1038.022,-4216 1071.6544,-4290.0453 1121.4846,-4283.6925 1152.1868,-4359 1212.3907,-4506.6706 1161.6238,-4558.7565 1188.1868,-4716 1241.9191,-5034.0774 1316.3129,-5101.9442 1356.6204,-5422 1364.2573,-5482.6403 1355.8,-7573.2165 1392.6204,-7622 1436.9612,-7680.7475 1507.0872,-7611.0197 1551.1179,-7670 1602.4826,-7738.8044 1575.2498,-13766.9616 1587.1179,-13852 1601.6405,-13956.0577 1643.0486,-14075.4729 1660.3659,-14122.4751"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.0904,-14123.7085 1663.8596,-14131.8589 1663.6505,-14121.2661 1657.0904,-14123.7085"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-3005C1149.9218,-2926.1982 1763.9749,-3210.4102 1952.9868,-3363 2041.6185,-3434.5526 2493.5716,-4097.8158 2547.7793,-4198 2568.6744,-4236.6173 2557.4646,-4254.8512 2583.7793,-4290 2641.6728,-4367.3287 2712.885,-4336.3995 2755.6838,-4423 2794.5319,-4501.6063 2789.7707,-10648.3389 2791.6838,-10736 2810.2601,-11587.1722 2861.5125,-12633.3281 2869.5646,-12794.687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.0732,-12794.9484 2870.0686,-12804.761 2873.0644,-12794.5985 2866.0732,-12794.9484"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M744.8972,-3005C760.1221,-2970.6858 781.2341,-2974.1 802.259,-2943 823.1919,-2912.0363 818.7632,-2898.8881 838.259,-2867 1041.2933,-2534.9106 1039.4091,-2352.5483 1392.6204,-2189 1456.5437,-2159.4014 1483.3775,-2169.6739 1551.1179,-2189 1758.3425,-2248.1204 2553.3902,-2712.3736 2755.6838,-3103 2780.0051,-3149.9641 2948.0923,-6853.1331 2949.5867,-6906 2969.8614,-7623.2802 2931.0417,-12648.5094 2985.5867,-13364 2999.2059,-13542.6496 3039.1201,-13755.7828 3052.2341,-13822.7776"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3048.862,-13823.7687 3054.2307,-13832.9026 3055.7298,-13822.4143 3048.862,-13823.7687"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M744.8972,-11521C754.9167,-11716.9073 735.2988,-13117.0292 838.259,-13284 891.913,-13371.0108 946.3471,-13352.7746 1038.022,-13398 1062.7032,-13410.1758 1071.9214,-13407.1688 1095.1044,-13422"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M635.2735,-3737.102C641.6483,-3740.5568 647.3683,-3745.08 651.5354,-3751 713.5016,-3839.0316 624.3039,-11414.8728 687.5354,-11502 703.3097,-11523.7355 743.5025,-11494.18 744.8972,-11521"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-3347C1013.3487,-3397.2623 1127.8144,-3653.9986 1188.1868,-3741 1262.0655,-3847.465 1314.397,-3856.4845 1356.6204,-3979 1383.8402,-4057.9814 1348.1899,-4659.2546 1392.6204,-4730 1435.245,-4797.87 1507.1409,-4748.9983 1551.1179,-4816 1601.0618,-4892.0924 1552.9823,-5139.6246 1587.1179,-5224 1630.0209,-5330.0464 1681.2086,-5331.9558 1749.1377,-5424 1845.7352,-5554.8901 1904.316,-5572.7761 1952.9868,-5728 1988.1965,-5840.293 1977.9417,-7728.8358 1988.9868,-7846 2031.2324,-8294.1328 2120.5685,-8395.7285 2161.3169,-8844 2165.7052,-8892.2758 2168.6242,-12294.9291 2197.3169,-12334 2200.9907,-12339.0026 2205.6889,-12343.0229 2210.9484,-12346.2511"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.7462,-12349.5659 2220.2477,-12350.9696 2212.9137,-12343.3235 2209.7462,-12349.5659"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge444" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.1044,-3309C1214.34,-3301.829 1267.1401,-3291.8682 1356.6204,-3371 1391.0671,-3401.4629 1370.9294,-3427.4529 1392.6204,-3468 1519.9995,-3706.1108 1605.6824,-3731.2146 1749.1377,-3960 1767.0956,-3988.6396 1762.141,-4002.2236 1785.1377,-4027 1845.3221,-4091.8419 1906.803,-4058.5434 1952.9868,-4134 2040.8551,-4277.562 1932.1016,-4352.5862 1988.9868,-4511 2035.2158,-4639.7382 2099.9453,-4643.7536 2161.3169,-4766 2183.0742,-4809.3385 2175.6636,-4825.6094 2197.3169,-4869 2252.2294,-4979.0383 2310.0199,-4983.1026 2351.1489,-5099 2380.1089,-5180.6063 2332.2657,-5420.0216 2387.1489,-5487 2410.7617,-5515.8165 2461.4121,-5474.2396 2467.4641,-5511"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge674" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.6077,-3714.7156C596.6328,-3670.091 636.8648,-3501.4782 651.5354,-3360 661.3762,-3265.099 648.3198,-1729.978 687.5354,-1643 774.6034,-1449.8881 864.0918,-1440.9188 1038.022,-1320 1168.4522,-1229.323 1251.8939,-1277.4434 1356.6204,-1158 1388.3139,-1121.8526 1356.3211,-1087.5194 1392.6204,-1056 1653.709,-829.2909 1821.4906,-872.1062 2161.3169,-936 2250.3111,-952.7326 2283.7193,-949.5584 2351.1489,-1010 2376.9057,-1033.0875 2368.3681,-1049.9531 2387.1489,-1079 2675.871,-1525.544 2943.2104,-1520.1429 3127.3396,-2019 3154.4107,-2092.3432 3237.3446,-4697.2565 3245.6114,-4958.8752"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.1164,-4959.0889 3245.9302,-4968.9734 3249.1129,-4958.868 3242.1164,-4959.0889"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge664" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-3879C951.4787,-3900.3555 971.9249,-3879.9283 1002.022,-3903 1026.4011,-3921.6885 1017.8239,-3938.8561 1038.022,-3962 1081.0537,-4011.3077 1114.917,-4001.2045 1152.1868,-4055 1180.7607,-4096.2439 1165.3196,-4117.3388 1188.1868,-4162 1246.7509,-4276.3801 1314.4586,-4275.6124 1356.6204,-4397 1412.8239,-4558.8153 1336.3931,-5005.193 1392.6204,-5167 1432.2955,-5281.1742 1511.8329,-5273.691 1551.1179,-5388 1616.3173,-5577.713 1543.9638,-6094.0926 1587.1179,-6290 1627.4952,-6473.3013 1702.5416,-6498.18 1749.1377,-6680 1785.9836,-6823.7742 1758.7285,-6865.948 1785.1377,-7012 1806.4848,-7130.0568 1846.9336,-7268.3433 1862.6196,-7320.0765"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1859.3092,-7321.2202 1865.5752,-7329.7636 1866.0045,-7319.1774 1859.3092,-7321.2202"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge768" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-3535C2684.9674,-3570.5795 2730.4726,-3519.6329 2755.6838,-3549 2790.0908,-3589.0787 2789.6743,-7299.2164 2791.6838,-7352 2809.6069,-7822.7796 2858.5903,-8397.3676 2868.7681,-8513.8314"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2865.2926,-8514.2654 2869.6531,-8523.9213 2872.2658,-8513.6537 2865.2926,-8514.2654"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-3005C798.135,-2886.7338 924.3274,-2970.8495 1002.022,-2867 1050.895,-2801.6745 974.9294,-2738.7235 1038.022,-2687 1282.8052,-2486.3258 1495.3961,-2536.7801 1749.1377,-2726 1783.013,-2751.2615 1758.3608,-2781.3094 1785.1377,-2814 1912.3424,-2969.2978 1998.7957,-2946.1641 2161.3169,-3064 2338.4624,-3192.4393 2395.7518,-3211.6316 2547.7793,-3369 2611.3861,-3434.8414 2633.6944,-3450.844 2669.7316,-3535"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge787" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M920.1405,-3917C962.3994,-3934.2585 975.2038,-3942.0614 1002.022,-3979 1030.7588,-4018.5814 1019.4143,-4037.7645 1038.022,-4083 1082.6524,-4191.497 1109.0117,-4211.9157 1152.1868,-4321 1166.0401,-4356.0013 1350.6115,-4929.8396 1356.6204,-4967 1379.2011,-5106.6447 1343.4914,-7380.3468 1392.6204,-7513 1411.7166,-7564.5618 1467.1491,-7553.2186 1471.8691,-7608"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1471.8691,-7608C1475.1066,-7644.6587 1529.0645,-7602.5383 1551.1179,-7632 1586.7582,-7679.6127 1574.2076,-11855.9438 1587.1179,-11914 1600.6138,-11974.6893 1636.5483,-12039.56 1655.7017,-12071.2608"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1652.8483,-12073.3026 1661.0637,-12079.9927 1658.8134,-12069.6396 1652.8483,-12073.3026"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge719" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-3347C1000.712,-3388.186 957.6202,-3222.5165 1038.022,-3181 1163.838,-3116.0332 1221.2897,-3139.3352 1356.6204,-3181 1558.2666,-3243.0817 1600.4438,-3298.3155 1749.1377,-3448 1863.7841,-3563.4102 1881.1143,-3606.0629 1952.9868,-3752 1975.1549,-3797.0123 1965.7865,-3814.5109 1988.9868,-3859 2048.5433,-3973.2059 2115.7538,-3971.5261 2161.3169,-4092 2194.1409,-4178.7903 2137.0113,-4437.479 2197.3169,-4508 2220.202,-4534.7617 2259.4135,-4495.0578 2274.2329,-4527"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-3005C779.9507,-2927.1296 847.1924,-3302.6026 920.1405,-3347"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge748" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2274.2329,-4641C2295.7282,-4668.8903 2327.9792,-4633.4843 2351.1489,-4660 2400.1244,-4716.0482 2350.7783,-4928.0602 2387.1489,-4993 2431.2193,-5071.6877 2507.5791,-5036.2665 2547.7793,-5117 2589.817,-5201.4237 2580.7787,-8417.7369 2583.7793,-8512 2604.6192,-9166.6768 2658.5947,-9968.9257 2668.244,-10109.4904"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2664.7723,-10110.0225 2668.951,-10119.7584 2671.7557,-10109.5416 2664.7723,-10110.0225"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M920.1405,-3347C976.4477,-3381.2695 978.6672,-3285.6689 1038.022,-3257 1166.4307,-3194.9775 1227.0336,-3159.478 1356.6204,-3219 1387.0337,-3232.9695 1729.5943,-3648.8306 1749.1377,-3676 1852.4676,-3819.6497 1877.8717,-3857.7814 1952.9868,-4018 1973.3939,-4061.5277 1971.0354,-4075.4034 1988.9868,-4120 2072.6419,-4327.8243 2060.0991,-4401.9113 2197.3169,-4579 2224.2105,-4613.708 2246.8645,-4606.6651 2274.2329,-4641"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge840" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-3385C1303.8685,-3419.2089 1334.2098,-3406.2807 1356.6204,-3447 1411.7224,-3547.1188 1345.6133,-3855.8351 1392.6204,-3960 1485.5051,-4165.827 1642.7985,-4122.7908 1749.1377,-4322 1786.5313,-4392.0507 1750.9935,-4425.3093 1785.1377,-4497 1835.7717,-4603.3134 1908.927,-4592.798 1952.9868,-4702 2027.0641,-4885.6001 1926.7969,-4958.0403 1988.9868,-5146 2034.4132,-5283.2944 2098.9751,-5291.5132 2161.3169,-5422 2182.4029,-5466.1348 2177.3336,-5481.3552 2197.3169,-5526 2254.6905,-5654.1788 2312.4495,-5667.0041 2351.1489,-5802 2395.3565,-5956.2104 2369.9901,-6363.4985 2387.1489,-6523 2406.5267,-6703.1278 2449.1461,-6918.0441 2463.0105,-6985.5999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.6686,-6986.7236 2465.118,-6995.8096 2466.5241,-6985.3085 2459.6686,-6986.7236"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.9961,-5982.0913C1676.1759,-6074.2424 1726.0359,-6722.6398 1749.1377,-7250 1777.953,-7907.7858 1741.6116,-8074.0236 1785.1377,-8731 1804.9743,-9030.4112 1853.5213,-9392.6042 1866.0649,-9483.5181"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1862.6319,-9484.2436 1867.4717,-9493.6684 1869.5656,-9483.2825 1862.6319,-9484.2436"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge614" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1727.6496,-5980.3103C1735.8898,-5983.9836 1743.4608,-5989.0441 1749.1377,-5996 1801.0908,-6059.6591 1749.3735,-6290.0235 1785.1377,-6364 1830.2641,-6457.3419 1911.9602,-6430.7849 1952.9868,-6526 2027.9564,-6699.9907 1929.6371,-9756.0811 1988.9868,-9936 2029.8978,-10060.0219 2120.0484,-10050.0966 2161.3169,-10174 2238.748,-10406.4767 2144.2218,-12139.789 2197.3169,-12379 2210.2364,-12437.2067 2243.7511,-12499.7221 2261.9837,-12530.9026"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2259.202,-12533.0729 2267.3208,-12539.8799 2265.219,-12529.4957 2259.202,-12533.0729"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge631" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1727.4997,-5982.1171C1735.4571,-5985.5675 1742.9818,-5990.0853 1749.1377,-5996 1783.8035,-6029.3075 1750.1274,-6065.0547 1785.1377,-6098 1813.3905,-6124.5864 1837.2368,-6099.8145 1869.0623,-6122"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1869.0623,-6122C1942.9247,-6173.4895 2185.1348,-6134.9754 2274.2329,-6122"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2274.2329,-6122C2309.332,-6114.8981 2323.461,-6120.7104 2351.1489,-6098 2376.9834,-6076.8099 2361.3071,-6053.1812 2387.1489,-6032 2393.2638,-6026.988 2400.3844,-6022.9777 2407.8119,-6019.7697"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2409.2472,-6022.968 2417.3317,-6016.1203 2406.7414,-6016.4318 2409.2472,-6022.968"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge660" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1869.0623,-6350C1880.8593,-6386.9579 1928.1994,-6344.1565 1952.9868,-6374 2007.4655,-6439.5911 1944.8406,-6683.0532 1988.9868,-6756 2036.2813,-6834.149 2112.9377,-6790.5178 2161.3169,-6868 2231.0385,-6979.6633 2133.3851,-7046.9239 2197.3169,-7162 2239.9645,-7238.7649 2301.299,-7213.7045 2351.1489,-7286 2427.9893,-7397.4387 2456.703,-7562.9862 2464.8075,-7621.5371"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2461.3803,-7622.3184 2466.1618,-7631.7729 2468.3198,-7621.4002 2461.3803,-7622.3184"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1727.5822,-5980.3655C1735.8309,-5984.032 1743.4222,-5989.0758 1749.1377,-5996 1843.0575,-6109.7813 1690.0399,-6213.2014 1785.1377,-6326 1810.1438,-6355.6606 1857.2489,-6313.0473 1869.0623,-6350"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge712" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1669.6119,-5959.6137C1678.5169,-5890.8951 1725.2754,-5524.3883 1749.1377,-5224 1824.2971,-4277.8641 1615.8944,-3974.7108 1988.9868,-3102 2067.3803,-2918.6276 2441.5368,-2569.7786 2583.7793,-2430 2657.7948,-2357.2666 2684.0231,-2347.0544 2755.6838,-2272 2772.8959,-2253.9728 2771.4212,-2243.5141 2791.6838,-2229 2967.8156,-2102.837 3033.5382,-2094.0071 3246.2772,-2053"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge834" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1727.5664,-5981.4628C1735.6119,-5984.999 1743.1452,-5989.7149 1749.1377,-5996 1793.4718,-6042.4983 1749.2277,-6082.7264 1785.1377,-6136 1836.9789,-6212.9079 1901.2765,-6183.0041 1952.9868,-6260 1989.2864,-6314.0495 1955.5217,-6346.1511 1988.9868,-6402 2075.9359,-6547.1069 2105.1285,-6658.4551 2274.2329,-6654"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge882" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1669.1095,-5959.747C1676.5504,-5875.6598 1725.4023,-5344.6749 1785.1377,-5196 1833.3943,-5075.8945 1907.2919,-5079.1033 1952.9868,-4958 2005.6953,-4818.309 1960.2092,-4770.5046 1988.9868,-4624 2053.442,-4295.8632 2033.0811,-4192.2985 2197.3169,-3901 2388.7692,-3561.4287 2669.8717,-3178.4817 2949.5867,-3450 3017.9755,-3516.3848 3053.1842,-6729.7375 3056.2445,-7021.8041"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.746,-7021.9683 3056.35,-7031.9313 3059.7456,-7021.8953 3052.746,-7021.9683"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-6350C1880.8756,-6386.9527 1929.2514,-6343.3132 1952.9868,-6374 2003.0348,-6438.7055 1974.757,-7765.4449 1988.9868,-7846 2076.6144,-8342.0614 2223.9869,-8432.5727 2351.1489,-8920 2411.5844,-9151.6562 2453.5179,-9439.7138 2464.5669,-9519.6"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2461.1454,-9520.4127 2465.9715,-9529.8445 2468.0806,-9519.4618 2461.1454,-9520.4127"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge536" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1669.603,-5959.613C1678.4563,-5890.8903 1724.9653,-5524.3635 1749.1377,-5224 1773.5576,-4920.5603 1752.9758,-4842.717 1785.1377,-4540 1834.8813,-4071.7988 1880.764,-3959.2641 1952.9868,-3494 1969.5317,-3387.4165 1942.5947,-3351.3733 1988.9868,-3254 2097.4472,-3026.3505 2663.5916,-2591.8466 2791.6838,-2516 2965.8182,-2412.8907 3116.8771,-2334.4047 3246.2772,-2490"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1691.3339,-5982.18C1710.3896,-5992.7048 1736.2603,-6010.3791 1749.1377,-6034 1792.4927,-6113.526 1772.6928,-6350.2828 1785.1377,-6440 1807.8139,-6603.4761 1850.065,-6798.1676 1864.2658,-6861.7688"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1860.9058,-6862.7809 1866.5101,-6871.7721 1867.736,-6861.2484 1860.9058,-6862.7809"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1727.4985,-5981.3616C1791.9569,-5988.9154 1893.6183,-5989.4453 1952.9868,-5932 2021.3542,-5865.8474 1916.2806,-5782.352 1988.9868,-5721 2182.5009,-5557.7061 2401.4202,-5625.3805 2547.7793,-5832 2582.4541,-5880.9514 2579.5653,-10091.16 2583.7793,-10151 2601.2003,-10398.3819 2651.8008,-10695.7234 2665.992,-10776.1168"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.5512,-10776.7589 2667.7456,-10785.993 2669.4434,-10775.5351 2662.5512,-10776.7589"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1669.3219,-5959.9107C1681.0171,-5851.3948 1774.8989,-4982.5024 1785.1377,-4958 1831.0719,-4848.0751 1911.2791,-4860.5971 1952.9868,-4749 2025.3918,-4555.2666 1903.9528,-4007.532 1988.9868,-3819 2203.8377,-3342.6463 2571.7213,-2780.0408 2949.5867,-3141 3261.8097,-3439.2538 3115.4412,-6591.3787 3127.3396,-7023 3174.4323,-8731.3148 3131.5341,-9159.3322 3163.3396,-10868 3186.329,-12103.0433 3238.6765,-13625.7732 3245.5318,-13822.6854"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3242.0402,-13822.9901 3245.8867,-13832.862 3249.036,-13822.746 3242.0402,-13822.9901"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge433" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1669.6509,-5959.6506C1677.0849,-5906.2149 1712.1967,-5674.9828 1785.1377,-5500 1840.3771,-5367.4827 1907.6296,-5360.2165 1952.9868,-5224 2005.4638,-5066.4015 1955.6353,-5014.723 1988.9868,-4852 2039.7396,-4604.3757 2109.1762,-4557.3358 2161.3169,-4310 2192.0235,-4164.3391 2138.6121,-4113.7982 2197.3169,-3977 2198.1354,-3975.0927 2581.8961,-3521.8725 2583.7793,-3521 2653.1021,-3488.8813 2700.169,-3468.5083 2755.6838,-3521 2825.6493,-3587.1554 2946.1294,-6885.7724 2949.5867,-6982 2985.8148,-7990.3652 2955.0175,-8243.4474 2985.5867,-9252 3004.9614,-9891.2212 3047.5926,-10674.8483 3055.2674,-10813.5299"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.7818,-10813.8885 3055.8305,-10823.6793 3058.7711,-10813.5007 3051.7818,-10813.8885"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge440" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.9371,-5982.0941C1675.6393,-6074.2678 1722.3727,-6722.813 1749.1377,-7250 1770.3814,-7668.4334 1743.6199,-7775.0899 1785.1377,-8192 1804.5409,-8386.8417 1850.358,-8619.5848 1864.6951,-8689.8873"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1861.279,-8690.6522 1866.7169,-8699.745 1868.1363,-8689.2457 1861.279,-8690.6522"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge489" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1675.4956,-5959.8631C1719.3308,-5893.5639 1944.1965,-5552.8964 1952.9868,-5528 2002.6951,-5387.2135 1929.5694,-5330.972 1988.9868,-5194 2035.6816,-5086.3569 2117.978,-5103.0375 2161.3169,-4994 2193.8542,-4912.1384 2136.0368,-4265.283 2197.3169,-4202 2281.092,-4115.4867 2351.7337,-4147.6941 2467.4641,-4181"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge504" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1869.0623,-6350C1880.5097,-6386.0409 1928.2545,-6335.394 1952.9868,-6364 1985.2045,-6401.2637 1983.6235,-8088.0327 1988.9868,-8137 2040.2648,-8605.1692 2071.0301,-8722.2782 2197.3169,-9176 2251.5181,-9370.7335 2308.4775,-9406.4195 2351.1489,-9604 2393.2238,-9798.8182 2357.7212,-9853.8745 2387.1489,-10051 2406.9593,-10183.7025 2446.9808,-10340.1463 2461.7879,-10395.94"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2458.4379,-10396.9615 2464.3996,-10405.7198 2465.2009,-10395.1553 2458.4379,-10396.9615"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-6122C2862.8474,-6002.9001 2669.931,-6672.6902 2755.6838,-7590 2788.2216,-7938.0609 2783.0533,-10386.5281 2791.6838,-10736 2812.7029,-11587.1154 2861.9019,-12633.319 2869.6111,-12794.6859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.1191,-12794.9393 2870.0935,-12804.7604 2873.1111,-12794.6044 2866.1191,-12794.9393"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.7673,-5959.8117C1672.2202,-5907.2389 1692.1101,-5680.9059 1785.1377,-5528 1837.4476,-5442.0202 1907.9508,-5466.0034 1952.9868,-5376 2030.0887,-5221.9136 1945.9936,-5156.8499 1988.9868,-4990 2036.7798,-4804.5228 2116.0016,-4781.098 2161.3169,-4595 2189.8756,-4477.7172 2141.4714,-4160.0147 2197.3169,-4053 2247.3209,-3957.1792 2285.1661,-3936.7983 2387.1489,-3901 2454.5107,-3877.3545 2482.4691,-3872.1679 2547.7793,-3901 2673.2351,-3956.3843 2705.4224,-4001.4055 2755.6838,-4129 2821.3127,-4295.6066 2737.3239,-7181.3838 2791.6838,-7352 2829.1029,-7469.4451 2912.4581,-7462.4627 2949.5867,-7580 2997.9831,-7733.2076 2973.3215,-13203.7991 2985.5867,-13364 2999.2639,-13542.6451 3039.1397,-13755.7813 3052.2391,-13822.7772"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3048.8667,-13823.7673 3054.2334,-13832.9024 3055.7348,-13822.4145 3048.8667,-13823.7673"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge463" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-6122C1900.4744,-6144.7668 1926.6898,-6117.4777 1952.9868,-6146 2008.2883,-6205.9812 1933.5464,-6266.1472 1988.9868,-6326 2076.6377,-6420.627 2469.453,-6380.5211 2547.7793,-6483 2584.3339,-6530.8266 2579.0296,-10756.9912 2583.7793,-10817 2600.8666,-11032.8833 2650.4795,-11291.0668 2665.4227,-11365.7913"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.0364,-11366.7055 2667.4408,-11375.8183 2668.8988,-11365.3243 2662.0364,-11366.7055"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge697" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1669.3225,-5959.9636C1681.2214,-5850.0965 1778.139,-4956.3964 1785.1377,-4930 1833.4998,-4747.5976 1911.5237,-4724.0933 1952.9868,-4540 1976.9773,-4433.4838 1942.217,-3656.6601 1988.9868,-3558 2192.6291,-3128.4199 2346.9302,-3018.9386 2791.6838,-2851 2933.607,-2797.4099 3035.9737,-2791.8953 3127.3396,-2913 3192.3732,-2999.2015 3240.1232,-4745.2261 3245.7258,-4958.6786"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.2323,-4958.9789 3245.992,-4968.8841 3249.2299,-4958.7962 3242.2323,-4958.9789"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge670" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1670.2568,-5982.2736C1680.6105,-6037.5101 1726.1338,-6285.1867 1749.1377,-6490 1775.0938,-6721.098 1748.2465,-6782.3937 1785.1377,-7012 1804.1696,-7130.452 1845.9845,-7268.5054 1862.3277,-7320.1263"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1859.0374,-7321.3284 1865.4112,-7329.7916 1865.7062,-7319.2008 1859.0374,-7321.3284"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge742" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1704.1198,-5959.9296C1766.3129,-5938.7595 1892.9817,-5886.2441 1952.9868,-5794 2016.1186,-5696.9494 1952.56,-5645.8978 1988.9868,-5536 2049.5856,-5353.1767 2031.5911,-5254.1404 2197.3169,-5156 2256.1453,-5121.1626 2286.2876,-5134.3796 2351.1489,-5156 2370.1226,-5162.3246 2368.1753,-5176.6754 2387.1489,-5183 2454.8766,-5205.5759 2476.5046,-5187.0777 2547.7793,-5183 2556.4362,-5182.5047 2565.4219,-5181.8132 2574.4132,-5181.0004"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2574.9266,-5184.4674 2584.5498,-5180.0352 2574.263,-5177.499 2574.9266,-5184.4674"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge757" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1727.5476,-5968.7834C1793.5479,-5962.8818 1898.0237,-5942.6369 1952.9868,-5875 2037.9549,-5770.4394 1913.5171,-5685.6101 1988.9868,-5574 2092.1633,-5421.4152 2202.9553,-5459.4851 2387.1489,-5459 2458.54,-5458.812 2497.0013,-5408.8172 2547.7793,-5459 2577.9409,-5488.8081 2582.4049,-8469.6166 2583.7793,-8512 2605.008,-9166.6643 2658.6654,-9968.9234 2668.2537,-10109.4901"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2664.7817,-10110.0205 2668.9561,-10119.7583 2671.7654,-10109.5427 2664.7817,-10110.0205"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge848" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1727.7962,-5980.7073C1735.9128,-5984.3375 1743.4072,-5989.2805 1749.1377,-5996 1823.1227,-6082.7532 1718.9779,-6157.141 1785.1377,-6250 1833.7761,-6318.2667 1905.4739,-6266.9452 1952.9868,-6336 2037.1167,-6458.2735 1913.8016,-6540.0319 1988.9868,-6668 2044.4486,-6762.3979 2344.4771,-6937.4766 2438.9581,-6991.0256"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2437.2682,-6994.0908 2447.6962,-6995.9634 2440.712,-6987.9965 2437.2682,-6994.0908"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge1002" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M438.0319,-5784.8729C452.9893,-5788.1137 468.5862,-5794.5274 478.0276,-5807 523.5447,-5867.1305 511.7562,-7088.6188 514.0276,-7164 539.123,-7996.8456 576.1885,-9020.9175 582.0022,-9180.6345"/>
<polygon fill="#ff0033" stroke="#ff0033" points="578.5174,-9181.1189 582.3792,-9190.9848 585.5128,-9180.864 578.5174,-9181.1189"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M438.1208,-5780.5244C452.722,-5782.1877 468.0437,-5786.8779 478.0276,-5798 538.3849,-5865.2384 467.4206,-6125.5933 514.0276,-6203 592.7944,-6333.8189 724.6667,-6258.481 802.259,-6390 859.7651,-6487.4728 764.7675,-6811.9367 838.259,-6898 886.7789,-6954.8199 952.1554,-6880.3583 1002.022,-6936 1092.2366,-7036.6624 969.4453,-7121.5146 1038.022,-7238 1049.097,-7256.8123 1340.8071,-7452.9501 1356.6204,-7468 1375.1734,-7485.6574 1372.7734,-7496.8105 1392.6204,-7513 1453.9215,-7563.0044 1508.9795,-7527.0476 1551.1179,-7594 1593.5074,-7661.3514 1565.2349,-8949.4871 1587.1179,-9026 1616.3131,-9128.0792 1803.6432,-9408.5957 1855.6741,-9485.3586"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1852.8149,-9487.3784 1861.3289,-9493.6842 1858.6056,-9483.4453 1852.8149,-9487.3784"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge888" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-1197C3286.2404,-1201.012 3584.0788,-1164.5552 3607.7534,-1197"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.0097,-5770.7597C410.622,-5720.594 453.9471,-5512.0346 478.0276,-5339 489.4144,-5257.178 468.9023,-5038.1968 514.0276,-4969 594.2979,-4845.9105 674.392,-4879.418 802.259,-4807 891.2076,-4756.6236 921.6121,-4756.118 1002.022,-4693 1020.322,-4678.6353 1021.6035,-4671.4823 1038.022,-4655 1087.5311,-4605.2984 1124.1011,-4610.2853 1152.1868,-4546 1204.6609,-4425.8916 1140.2725,-2308.9991 1188.1868,-2187 1229.0762,-2082.8874 1309.2249,-2101.3166 1356.6204,-2000 1404.5593,-1897.5214 1337.4088,-1846.7506 1392.6204,-1748 1554.3984,-1458.6463 1687.8965,-1438.7165 1988.9868,-1300 2380.9014,-1119.4395 2518.9537,-1131.5345 2949.5867,-1159 3082.2567,-1167.4616 3113.6999,-1187.1914 3246.2772,-1197"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge558" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.6505,-5770.8876C414.0465,-5692.4143 500.3281,-5224.087 514.0276,-5197 604.5637,-5017.9899 678.3535,-5004.1264 838.259,-4883 908.95,-4829.4525 944.7202,-4836.6836 1002.022,-4769 1026.1721,-4740.4744 1010.0431,-4717.7815 1038.022,-4693 1078.054,-4657.5428 1120.558,-4698.1207 1152.1868,-4655 1225.076,-4555.6276 1151.2315,-2554.5671 1188.1868,-2437 1228.362,-2309.1894 1310.8784,-2312.9257 1356.6204,-2187 1382.9379,-2114.5489 1342.8474,-1900.8594 1392.6204,-1842 1509.528,-1703.7501 1608.3195,-1771.9324 1785.1377,-1733 2370.9684,-1604.0098 2527.8357,-1570.2372 3127.3396,-1591 3217.2235,-1594.113 3250.2443,-1561.9597 3329.2148,-1605 3364.2981,-1624.121 3420.92,-1712.3708 3436.8809,-1749"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-1749C3480.711,-1832.6342 3492.1395,-1856.0131 3508.5469,-1949 3541.8039,-2137.4799 3542.3239,-8647.6214 3544.5469,-8839 3561.5598,-10303.6389 3602.3346,-12111.7292 3607.2631,-12327.6148"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.7705,-12327.9846 3607.4983,-12337.9019 3610.7687,-12327.8245 3603.7705,-12327.9846"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge817" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M582.7815,-5745C1101.7541,-5753.5693 1250.3405,-5660.4474 1749.1377,-5804 1848.8932,-5832.7094 1891.9028,-5834.0706 1952.9868,-5918 2000.9952,-5983.9636 1944.8081,-6029.4126 1988.9868,-6098 2040.0827,-6177.3262 2088.1345,-6162.4367 2161.3169,-6222 2275.569,-6314.99 2402.3284,-6438.4069 2448.9587,-6484.5551"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2446.6648,-6487.2096 2456.2291,-6491.7676 2451.5948,-6482.2401 2446.6648,-6487.2096"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M430.6711,-5770.9595C467.4094,-5759.7357 528.6978,-5744.107 582.7815,-5745"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge859" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M582.7815,-5211C623.2968,-5162.1048 779.1671,-5106.246 838.259,-5083 908.8397,-5055.2345 947.1162,-5087.3251 1002.022,-5035 1037.4309,-5001.2554 1004.5731,-4966.6884 1038.022,-4931 1075.6623,-4890.8396 1120.9786,-4928.3398 1152.1868,-4883 1221.1444,-4782.8172 1159.3244,-3907.147 1188.1868,-3789 1229.3446,-3620.522 1282.2994,-3593.7009 1356.6204,-3437 1532.3475,-3066.4909 1597.3349,-2982.9369 1749.1377,-2602 1768.024,-2554.6062 1744.7015,-2524.1092 1785.1377,-2493 2054.0839,-2286.0888 2235.5775,-2324.055 2547.7793,-2457 2666.3243,-2507.48 2899.9295,-2756.108 2949.5867,-2875 3035.0124,-3079.531 3054.8134,-6709.2764 3056.3608,-7021.6036"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.861,-7021.6673 3056.4099,-7031.6501 3059.8609,-7021.6331 3052.861,-7021.6673"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-5745C799.6736,-5748.5813 1186.0957,-6223.648 1392.6204,-6290 1459.6874,-6311.5472 1484.4874,-6312.8614 1551.1179,-6290 1570.2906,-6283.4217 1567.9453,-6268.5783 1587.1179,-6262 1655.2291,-6238.6305 1694.5005,-6215.0954 1749.1377,-6262 1829.3102,-6330.826 1732.0533,-6405.6398 1785.1377,-6497 1832.9555,-6579.2963 1910.6844,-6544.7373 1952.9868,-6630 1996.5764,-6717.8569 1969.8387,-8298.8114 1988.9868,-8395 2083.5139,-8869.8476 2171.6619,-8975.4323 2387.1489,-9409 2407.7775,-9450.5055 2437.1462,-9496.1141 2454.0603,-9521.3804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2451.1947,-9523.3911 2459.689,-9529.7233 2456.9975,-9519.4761 2451.1947,-9523.3911"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge517" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M582.7815,-5211C607.3052,-5177.9599 624.7681,-5180.2501 651.5354,-5149 697.3419,-5095.5222 686.6184,-5060.5183 744.8972,-5021"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M398.6131,-5770.6799C404.6107,-5708.3286 440.5447,-5402.6314 582.7815,-5211"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M744.8972,-5021C786.1233,-4993.045 794.796,-4983.3319 838.259,-4959 908.2736,-4919.8038 949.0479,-4943.2671 1002.022,-4883 1037.1003,-4843.0924 1006.0926,-4811.4691 1038.022,-4769 1074.6518,-4720.279 1122.9687,-4746.4956 1152.1868,-4693 1210.834,-4585.6224 1115.2725,-2589.2495 1188.1868,-2491 1235.0359,-2427.8724 1308.2273,-2498.9519 1356.6204,-2437 1431.6105,-2340.9988 1314.9735,-1983.8654 1392.6204,-1890 1403.5301,-1876.8114 1972.0141,-1737.211 1988.9868,-1735 2080.8032,-1723.0391 2104.7249,-1734.2222 2197.3169,-1734 2265.6865,-1733.8359 2282.7794,-1733.8261 2351.1489,-1734 2438.541,-1734.2222 2461.1715,-1723.316 2547.7793,-1735 2642.6155,-1747.7941 2667.7938,-1753.1459 2755.6838,-1791 2933.6638,-1867.6558 2999.8157,-1873.0869 3127.3396,-2019 3200.3999,-2102.5957 3306.0017,-2367.4311 3329.2148,-2476 3368.5697,-2660.0647 3362.5375,-9063.7942 3365.2148,-9252 3383.5253,-10539.155 3430.245,-12126.7235 3436.2435,-12327.7453"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3432.7489,-12327.9816 3436.5463,-12337.8725 3439.7457,-12327.7724 3432.7489,-12327.9816"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M920.1405,-5631C971.4528,-5655.6124 982.2531,-5669.6616 1038.022,-5681 1087.7446,-5691.1092 1101.6092,-5685.0559 1152.1868,-5681 1334.3902,-5666.3888 1401.1292,-5685.4746 1551.1179,-5581 1571.851,-5566.5584 1564.3675,-5547.9927 1587.1179,-5537 1666.3701,-5498.7063 1697.1213,-5534.6667 1785.1377,-5534 1859.7352,-5533.435 1897.3403,-5484.3153 1952.9868,-5534 2005.8716,-5581.2189 1949.4417,-5792.1561 1988.9868,-5851 2004.7677,-5874.4823 2170.7981,-5956.8718 2242.0487,-5991.4928"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2240.5252,-5994.6438 2251.0503,-5995.8575 2243.5793,-5988.3452 2240.5252,-5994.6438"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-5515C794.2201,-5532.6922 794.2856,-5558.5027 838.259,-5587 872.9286,-5609.4678 882.0772,-5614.9388 920.1405,-5631"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M920.1405,-5631C1099.0407,-5706.4889 1167.1786,-5654.6105 1356.6204,-5612 1448.1455,-5591.4136 1470.9876,-5578.783 1551.1179,-5530 1568.9078,-5519.1696 1568.2936,-5508.912 1587.1179,-5500 1668.114,-5461.654 1695.9254,-5470.4825 1785.1377,-5462 1859.4024,-5454.9387 1896.6572,-5413.0911 1952.9868,-5462 2039.0803,-5536.7517 1914.2695,-5629.8767 1988.9868,-5716 1998.5968,-5727.077 2012.7924,-5733.3878 2026.9009,-5736.94"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2026.5877,-5740.4499 2037.0919,-5739.0676 2028.0183,-5733.5977 2026.5877,-5740.4499"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-6656C1702.3675,-6671.4187 1723.7851,-6652.2991 1749.1377,-6680 1803.6308,-6739.5405 1730.6891,-6798.4188 1785.1377,-6858 1788.4869,-6861.6649 1792.3472,-6864.8016 1796.5339,-6867.4852"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1795.0702,-6870.6734 1805.5265,-6872.3814 1798.4176,-6864.5256 1795.0702,-6870.6734"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M438.0253,-5780.6109C452.614,-5782.2855 467.9521,-5786.9608 478.0276,-5798 529.3955,-5854.2815 472.1435,-6075.3447 514.0276,-6139 594.8013,-6261.7597 679.1986,-6220.6851 802.259,-6301 981.9314,-6418.2624 989.7061,-6509.5256 1188.1868,-6591 1287.7519,-6631.8705 1569.9918,-6611.8078 1668.1278,-6656"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-5515C853.6805,-5555.7669 901.8139,-5526.7714 1002.022,-5468 1215.3999,-5342.8553 1254.5364,-5264.3224 1356.6204,-5039 1398.051,-4947.5532 1316.1831,-4881.0873 1392.6204,-4816 1487.4875,-4735.2195 1778.6689,-4833.8872 1952.9868,-4907 2054.5095,-4949.5809 2076.7786,-4970.4786 2161.3169,-5041 2256.1709,-5120.1267 2293.8774,-5134.5547 2351.1489,-5244 2386.3522,-5311.2731 2346.634,-5346.7857 2387.1489,-5411 2411.2113,-5449.1378 2456.794,-5429.1864 2467.4641,-5473"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M582.7815,-5211C613.6564,-5172.898 964.3471,-5104.3947 1002.022,-5073 1027.6911,-5051.6098 1016.1847,-5032.2899 1038.022,-5007 1079.5391,-4958.9188 1122.7116,-4977.2733 1152.1868,-4921 1198.829,-4831.9518 1165.8824,-4115.0184 1188.1868,-4017 1230.0796,-3832.8985 1295.7982,-3805.7429 1356.6204,-3627 1377.594,-3565.363 1367.7959,-3545.1893 1392.6204,-3485 1445.3833,-3357.0711 1486.0352,-3339.1227 1551.1179,-3217 1647.2332,-3036.6471 1676.4033,-2992.9843 1749.1377,-2802 1769.5618,-2748.3708 1739.2497,-2712.4605 1785.1377,-2678 1844.7896,-2633.2033 1879.6946,-2664.095 1952.9868,-2678 2225.3873,-2729.6797 2748.0082,-3090.9642 2755.6838,-3103 2853.5649,-3256.4832 2688.1311,-3361.2849 2791.6838,-3511 2835.9888,-3575.0555 2907.933,-3521.1896 2949.5867,-3587 2991.6667,-3653.4842 2983.5766,-9173.3435 2985.5867,-9252 3001.924,-9891.3061 3047.0341,-10674.8639 3055.1904,-10813.532"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.7062,-10813.904 3055.7892,-10823.6804 3058.694,-10813.4916 3051.7062,-10813.904"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge469" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M744.8972,-5401C889.0137,-5364.4496 918.3369,-5309.8915 1002.022,-5187 1030.7379,-5144.8306 1002.6977,-5114.8112 1038.022,-5078 1075.5628,-5038.8789 1120.4307,-5078.9469 1152.1868,-5035 1209.5023,-4955.6815 1132.6196,-4235.553 1188.1868,-4155 1234.4146,-4087.9857 1305.6163,-4146.4548 1356.6204,-4083 1410.4655,-4016.0107 1351.6577,-3968.5574 1392.6204,-3893 1439.1375,-3807.1969 1499.4911,-3823.8293 1551.1179,-3741 1578.9988,-3696.2683 1544.5643,-3659.104 1587.1179,-3628 1645.2525,-3585.5072 1678.8172,-3612.4988 1749.1377,-3628 1946.3074,-3671.4634 1979.9306,-3730.3208 2161.3169,-3819 2204.7076,-3840.2136 2508.9421,-3989.287 2547.7793,-4018 2578.9848,-4041.0707 2650.3464,-4109.3807 2669.7316,-4143"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M582.7815,-5401C644.5924,-5363.9754 673.8847,-5413.1916 744.8972,-5401"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2669.7316,-4143C2688.594,-4176.7971 2730.4914,-4127.6168 2755.6838,-4157 2795.4438,-4203.3742 2790.0847,-8493.9356 2791.6838,-8555 2810.6887,-9280.7313 2860.8761,-10171.2925 2869.3973,-10319.6045"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9076,-10319.8865 2869.9771,-10329.6686 2872.896,-10319.4838 2865.9076,-10319.8865"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge506" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M437.8621,-5782.8017C451.7563,-5784.8379 466.6689,-5789.1873 478.0276,-5798 507.2407,-5820.6651 490.1311,-5844.7853 514.0276,-5873 627.8826,-6007.4289 688.4488,-6008.3125 838.259,-6101 1085.1171,-6253.7309 1834.6817,-6516.916 1952.9868,-6782 2002.8275,-6893.677 1967.998,-8862.5204 1988.9868,-8983 2038.2273,-9265.6498 1991.8081,-9393.7959 2197.3169,-9594 2222.9676,-9618.9886 2262.837,-9584.0512 2274.2329,-9618"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-4637C2768.7361,-4829.2995 2735.8179,-4900.6251 2755.6838,-5116 2813.0396,-5737.8176 2777.8393,-10111.6962 2791.6838,-10736 2810.5593,-11587.1656 2861.5602,-12633.327 2869.5703,-12794.6869"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.0788,-12794.9473 2870.0717,-12804.7609 2873.0701,-12794.5993 2866.0788,-12794.9473"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-5401C894.2142,-5375.3648 907.0489,-5303.1496 1038.022,-5227 1088.498,-5197.6525 1119.792,-5210.5766 1152.1868,-5162 1224.491,-5053.5786 1140.3905,-4992.2379 1188.1868,-4871 1234.9196,-4752.4594 1309.151,-4757.2476 1356.6204,-4639 1400.7366,-4529.1052 1314.2113,-4463.7419 1392.6204,-4375 1676.1973,-4054.0531 1977.2916,-4067.0658 2351.1489,-4276 2510.0201,-4364.7868 2435.5973,-4507.3344 2583.7793,-4613 2616.0722,-4636.0274 2651.5765,-4601.7369 2669.7316,-4637"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M402.5748,-5770.9459C430.219,-5709.4482 564.6822,-5411.8414 582.7815,-5401"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2870.6353,-6996C2877.5394,-7156.1826 2931.4579,-7188.6969 2949.5867,-7348 3025.1695,-8012.1696 2934.6383,-12697.488 2985.5867,-13364 2999.2425,-13542.6468 3039.1325,-13755.7819 3052.2372,-13822.7774"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3048.865,-13823.7678 3054.2324,-13832.9024 3055.7329,-13822.4144 3048.865,-13823.7678"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M582.7815,-5401C610.547,-5384.3686 624.1994,-5394.3282 651.5354,-5377 751.5342,-5313.6111 740.9924,-5254.5064 838.259,-5187 903.7244,-5141.5647 945.4424,-5170.1145 1002.022,-5114 1029.4179,-5086.8292 1011.2268,-5062.7634 1038.022,-5035 1077.406,-4994.1929 1121.3981,-5025.6274 1152.1868,-4978 1206.4589,-4894.0457 1156.4491,-4173.7972 1188.1868,-4079 1229.9054,-3954.3907 1296.2377,-3952.7127 1356.6204,-3836 1378.1339,-3794.4167 1374.4223,-3780.1373 1392.6204,-3737 1431.2718,-3645.3792 1502.8972,-3386.8694 1587.1179,-3334 1745.0062,-3234.886 2339.7106,-3025.962 2755.6838,-3521 2816.6776,-3593.5869 2749.7783,-6848.9529 2791.6838,-6934 2811.4037,-6974.0214 2868.714,-6951.4254 2870.6353,-6996"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge679" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-5021C845.785,-4960.6647 911.5303,-5034.0331 1002.022,-4959 1032.036,-4934.1132 1015.577,-4910.8814 1038.022,-4879 1078.5834,-4821.3855 1123.7869,-4833.4834 1152.1868,-4769 1214.8165,-4626.7961 1152.0968,-3522.1356 1188.1868,-3371 1224.1215,-3220.5144 1693.5977,-2237.7303 1785.1377,-2113 1858.2368,-2013.3968 1873.97,-1969.1155 1988.9868,-1924 2060.2888,-1896.0317 2085.3327,-1914.377 2161.3169,-1924 2431.9303,-1958.2716 2511.0693,-1956.2943 2755.6838,-2077 2858.9353,-2127.9497 3085.0855,-2330.8957 3127.3396,-2438 3225.1982,-2686.049 3244.2625,-4727.0225 3246.1161,-4958.6292"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.6174,-4958.8224 3246.1956,-4968.7947 3249.6172,-4958.7676 3242.6174,-4958.8224"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge722" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M744.8972,-5515C773.7511,-5525.3499 981.6762,-5437.9285 1002.022,-5415 1044.6638,-5366.9451 996.0349,-5323.6281 1038.022,-5275 1073.9938,-5233.3385 1110.9426,-5263.4496 1152.1868,-5227 1186.3659,-5196.7941 1342.9005,-4914.5014 1356.6204,-4871 1383.4648,-4785.8847 1343.0568,-4545.2206 1392.6204,-4471 1446.8272,-4389.8262 1492.9603,-4394.7275 1587.1179,-4369 1744.0348,-4326.1243 1801.1224,-4300.7039 1952.9868,-4359 2089.4061,-4411.3672 2070.3438,-4506.6787 2197.3169,-4579 2259.5507,-4614.4471 2305.3454,-4571.9403 2351.1489,-4627 2437.0312,-4730.2377 2305.8585,-4820.1092 2387.1489,-4927 2433.8703,-4988.4351 2497.6159,-4934.3417 2547.7793,-4993 2592.6193,-5045.4335 2536.2045,-5094.0346 2583.7793,-5144 2587.0009,-5147.3835 2590.6512,-5150.3171 2594.585,-5152.8598"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2593.1461,-5156.0631 2603.5935,-5157.8247 2596.5249,-5149.9325 2593.1461,-5156.0631"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M582.7815,-5401C592.2269,-5395.3422 734.5871,-5511.1363 744.8972,-5515"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-9848C1710.5475,-9831.994 1726.2709,-9825.1502 1749.1377,-9786 1807.0862,-9686.7863 1710.2007,-9617.0967 1785.1377,-9530 1788.5818,-9525.9971 1792.6363,-9522.6201 1797.0721,-9519.773"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1798.8897,-9522.769 1806.0124,-9514.9256 1795.5531,-9516.6153 1798.8897,-9522.769"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1539.3944,-9860.0477C1578.2577,-9863.6469 1627.3224,-9863.3969 1668.1278,-9848"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1474.0364,-9837.6869C1484.9626,-9780.0392 1534.1495,-9513.0726 1551.1179,-9292 1576.8849,-8956.297 1539.5699,-6595.3161 1587.1179,-6262 1601.9555,-6157.9868 1643.1856,-6038.5464 1660.4106,-5991.5312"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.696,-5992.7379 1663.8851,-5982.1447 1657.1313,-5990.3079 1663.696,-5992.7379"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge617" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1474.2355,-9860.1883C1483.1161,-9900.1192 1517.5611,-10038.0279 1587.1179,-10128 1711.699,-10289.1464 1844.4407,-10231.6447 1952.9868,-10404 1995.9991,-10472.2972 1939.1515,-10518.5098 1988.9868,-10582 2041.2406,-10648.5713 2115.2519,-10592.0055 2161.3169,-10663 2216.5147,-10748.07 2153.0135,-12396.781 2197.3169,-12488 2207.0778,-12508.0973 2226.6315,-12523.9774 2243.5799,-12534.767"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2241.771,-12537.7632 2252.1397,-12539.9406 2245.3919,-12531.7725 2241.771,-12537.7632"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge636" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2274.2329,-6540C2319.5872,-6333.3324 2425.0216,-6097.9231 2457.6571,-6027.764"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2461.0212,-6028.8327 2462.0896,-6018.2919 2454.6811,-6025.8658 2461.0212,-6028.8327"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1473.9116,-9837.6764C1484.2284,-9779.9775 1530.909,-9512.7999 1551.1179,-9292 1559.9665,-9195.3217 1551.7987,-8509.4298 1587.1179,-8419 1627.6157,-8315.3114 1685.5562,-8319.3716 1749.1377,-8228 1767.7784,-8201.2118 1763.5335,-8188.4611 1785.1377,-8164 1846.5356,-8094.4829 1909.4238,-8121.8816 1952.9868,-8040 1996.3432,-7958.5067 1971.8501,-7300.7043 1988.9868,-7210 2042.0154,-6929.3202 2033.3907,-6835.926 2197.3169,-6602 2222.5149,-6566.042 2264.821,-6582.8874 2274.2329,-6540"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge654" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1480.7796,-9837.657C1499.3246,-9814.3734 1543.9465,-9760.0126 1587.1179,-9720 1620.3709,-9689.1801 1645.5804,-9697.3349 1668.1278,-9658"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1668.1278,-9658C1759.1997,-9499.1214 1725.2388,-9435.5636 1749.1377,-9254 1757.318,-9191.8528 1745.1441,-8739.2671 1785.1377,-8691 1834.2712,-8631.7022 1904.0047,-8707.4229 1952.9868,-8648 1996.3137,-8595.4378 1962.4887,-8098.7523 1988.9868,-8036 1990.6555,-8032.0483 2193.7452,-7810.3755 2197.3169,-7808 2257.7746,-7767.7903 2289.2651,-7790.9784 2351.1489,-7753 2392.2576,-7727.7714 2431.0826,-7686.1987 2451.8294,-7662.0341"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2454.6098,-7664.1664 2458.3879,-7654.2681 2449.2617,-7659.6499 2454.6098,-7664.1664"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge828" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1473.5697,-9837.6382C1482.2159,-9779.7523 1522.0264,-9511.806 1551.1179,-9292 1568.3903,-9161.4954 1560.9291,-9127.0113 1587.1179,-8998 1591.0955,-8978.4059 1773.416,-8322.1973 1785.1377,-8306 1838.0066,-8232.9446 1908.9633,-8270.7029 1952.9868,-8192 2038.2367,-8039.5949 1917.7022,-7566.4157 1988.9868,-7407 2032.7773,-7309.0701 2112.1723,-7333.3556 2161.3169,-7238 2208.3147,-7146.8098 2125.631,-7083.3865 2197.3169,-7010 2221.5967,-6985.1442 2257.3305,-7026.3584 2274.2329,-6996"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge873" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1505.0334,-9837.8453C1564.3322,-9816.0728 1688.0311,-9762.0103 1749.1377,-9672 1796.6766,-9601.9749 1762.2687,-9566.4891 1785.1377,-9485 1842.8145,-9279.48 1902.6157,-9242.4316 1952.9868,-9035 1984.6759,-8904.5026 1919.4289,-8849.8716 1988.9868,-8735 2179.0309,-8421.1513 2440.2817,-8554.3049 2669.7316,-8268"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-9848C1710.5475,-9831.994 1724.1802,-9823.8517 1749.1377,-9786 1784.9772,-9731.6443 1736.4612,-9687.239 1785.1377,-9644 1787.6987,-9641.7251 2270.8271,-9580.3662 2274.2329,-9580"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge529" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1869.0623,-9886C1911.5869,-9904.4998 1924.2771,-9911.5811 1952.9868,-9948 1978.3856,-9980.219 1961.3756,-10002.6557 1988.9868,-10033 2047.5608,-10097.3719 2113.8325,-10053.0625 2161.3169,-10126 2217.1384,-10211.7436 2151.0002,-10493.7708 2197.3169,-10585 2247.6586,-10684.1573 2290.837,-10692.408 2387.1489,-10748 2649.3094,-10899.3211 2753.7829,-10877.2934 3056.4631,-10874"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1473.9468,-9837.6796C1484.435,-9779.9959 1531.8209,-9512.8815 1551.1179,-9292 1561.6835,-9171.0614 1544.7032,-8313.7487 1587.1179,-8200 1627.0859,-8092.813 1709.0377,-8107.1377 1749.1377,-8000 1828.3306,-7788.4153 1704.6289,-7195.0875 1785.1377,-6984 1798.0479,-6950.1506 1827.267,-6919.4082 1847.5739,-6900.9578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1849.9538,-6903.5255 1855.1306,-6894.2815 1845.3191,-6898.2796 1849.9538,-6903.5255"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-9886C1906.9126,-9894.5089 1919.0596,-9891.1851 1952.9868,-9910 1980.2541,-9925.1215 2147.2882,-10070.1547 2161.3169,-10098 2235.8543,-10245.9477 2133.6536,-10316.0578 2197.3169,-10469 2248.1207,-10591.049 2278.6255,-10622.504 2387.1489,-10698 2452.2293,-10743.2742 2540.0583,-10769.7408 2600.4338,-10783.7406"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2599.7272,-10787.1692 2610.2532,-10785.9639 2601.273,-10780.342 2599.7272,-10787.1692"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1544.9981,-9857.5544C1558.9739,-9859.1027 1573.4924,-9860.6519 1587.1179,-9862 1712.2686,-9874.3827 1747.6846,-9853.0837 1869.0623,-9886"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2274.2329,-10836C2295.3044,-10863.6282 2321.5013,-10831.8798 2351.1489,-10850 2373.6001,-10863.7218 2368.8973,-10878.0468 2387.1489,-10897 2534.6266,-11050.1466 2663.0637,-11010.6232 2755.6838,-11202 2834.7943,-11365.4624 2746.9568,-12659.9946 2791.6838,-12836 2854.975,-13085.0574 2914.1604,-13136.025 3056.4631,-13350"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge425" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2075.1519,-9922C2103.2461,-9948.7578 2135.1227,-9907.3795 2161.3169,-9936 2235.7791,-10017.3596 2126.2143,-10346.6886 2197.3169,-10431 2242.7187,-10484.8362 2296.7363,-10424.2907 2351.1489,-10469 2380.3373,-10492.9833 2359.284,-10520.4911 2387.1489,-10546 2555.8216,-10700.4113 2721.2435,-10548.8658 2870.6353,-10722"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge481" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-9848C1788.1389,-9806.2904 1833.8463,-9827.8652 1952.9868,-9872 1971.4943,-9878.856 1971.2028,-9889.4408 1988.9868,-9898 2024.8073,-9915.24 2046.5177,-9894.4244 2075.1519,-9922"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2075.1519,-9922C2103.1555,-9948.8526 2134.8151,-9907.6642 2161.3169,-9936 2219.4083,-9998.1115 2150.8803,-10245.7533 2197.3169,-10317 2240.0867,-10382.6209 2288.0099,-10356.6445 2351.1489,-10403 2368.889,-10416.0244 2366.6981,-10428.8692 2387.1489,-10437 2453.4893,-10463.3755 2477.1322,-10447.2809 2547.7793,-10437 2575.6175,-10432.9489 2744.0219,-10380.7471 2825.9446,-10355.0705"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2826.9974,-10358.4085 2835.4913,-10352.0757 2824.9021,-10351.7294 2826.9974,-10358.4085"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge508" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1869.0623,-9772C1907.808,-9770.0454 1918.088,-9779.0553 1952.9868,-9796 1970.7412,-9804.6204 1971.2028,-9813.4408 1988.9868,-9822 2024.8073,-9839.24 2050.2718,-9814.9949 2075.1519,-9846"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-10836C2295.5398,-10863.447 2318.2599,-10838.7913 2351.1489,-10850 2542.7012,-10915.2818 2644.8428,-10889.683 2755.6838,-11059 2855.5655,-11211.5758 2869.1192,-12606.3084 2870.4989,-12794.9269"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.9991,-12794.9803 2870.5688,-12804.9556 2873.9989,-12794.9314 2866.9991,-12794.9803"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1510.5172,-9860.0721C1523.5433,-9864.0992 1538.0789,-9868.919 1551.1179,-9874 1734.8477,-9945.5952 1808.4376,-9927.8806 1952.9868,-10062 1976.9107,-10084.1976 1963.3058,-10105.8611 1988.9868,-10126 2051.5506,-10175.0621 2111.3523,-10112.1546 2161.3169,-10174 2245.2587,-10277.9017 2136.0928,-10655.2844 2197.3169,-10774 2217.4424,-10813.0241 2247.6056,-10801.0872 2274.2329,-10836"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1486.3337,-9860.2313C1547.3044,-9907.9696 1787.81,-10100.2882 1952.9868,-10290 2060.0612,-10412.9789 2111.2924,-10436.8025 2161.3169,-10592 2192.3764,-10688.36 2144.7989,-12327.4448 2197.3169,-12414 2237.7259,-12480.5982 2308.5394,-12432.7878 2351.1489,-12498 2401.7827,-12575.493 2365.0645,-12823.1044 2387.1489,-12913 2431.3822,-13093.0532 2496.6369,-13119.7861 2547.7793,-13298 2574.867,-13392.3913 2544.2566,-13426.1033 2583.7793,-13516 2594.1768,-13539.6497 2845.9096,-13874.5129 2870.6353,-13882"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge690" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-9848C1730.1067,-9826.4808 1725.8217,-9786.037 1785.1377,-9758 2101.6399,-9608.3983 2272.246,-9776.953 2547.7793,-9561 2737.0698,-9412.641 3056.6255,-8876.8713 3127.3396,-8647 3164.373,-8526.615 3159.2795,-7639.887 3163.3396,-7514 3197.043,-6468.9962 3239.6062,-5181.6194 3245.571,-5001.3388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3249.0778,-5001.1897 3245.9105,-4991.0794 3242.0816,-5000.9581 3249.0778,-5001.1897"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge732" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-9658C1721.7011,-9564.5083 1927.1419,-8835.608 1952.9868,-8731 1973.7062,-8647.138 1957.2025,-8620.3236 1988.9868,-8540 2159.0414,-8110.2478 2407.6347,-8103.4146 2547.7793,-7663 2627.0773,-7413.8001 2665.2355,-5418.555 2669.3559,-5190.2568"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.8559,-5190.2832 2669.5355,-5180.2222 2665.857,-5190.1579 2672.8559,-5190.2832"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge760" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1869.0623,-9772C1903.4125,-9770.2672 2147.2444,-9819.4339 2161.3169,-9832 2198.1147,-9864.8587 2162.8581,-9901.696 2197.3169,-9937 2286.7425,-10028.6192 2339.8469,-10026.7603 2467.4641,-10037"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-9848C1703.5979,-9835.6724 1713.8449,-9836.8261 1749.1377,-9824 1803.7385,-9804.157 1811.0287,-9774.6647 1869.0623,-9772"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2467.4641,-10037C2536.6653,-10047.3245 2608.9439,-10089.9026 2645.4819,-10114.061"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2643.7265,-10117.0984 2653.9776,-10119.7753 2647.6333,-10111.29 2643.7265,-10117.0984"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge850" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1476.8008,-9837.6766C1507.7509,-9766.0668 1676.2356,-9368.1114 1749.1377,-9026 1784.3099,-8860.9457 1739.2138,-8810.3915 1785.1377,-8648 1831.2138,-8485.0703 1908.6497,-8469.4115 1952.9868,-8306 2009.9345,-8096.1102 1915.3214,-8022.6221 1988.9868,-7818 2083.1538,-7556.4302 2219.5484,-7552.8826 2351.1489,-7308 2404.8868,-7208.0045 2446.4282,-7077.7253 2461.413,-7027.7525"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2464.7899,-7028.6755 2464.2769,-7018.0931 2458.0787,-7026.6856 2464.7899,-7028.6755"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1477.7516,-7711.5623C1493.3256,-7680.598 1535.503,-7592.138 1551.1179,-7513 1604.9555,-7240.1456 1545.5186,-6536.9863 1587.1179,-6262 1602.8003,-6158.334 1643.3962,-6039.1046 1660.4278,-5991.847"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.824,-5992.7492 1663.956,-5982.1552 1657.2463,-5990.3546 1663.824,-5992.7492"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge552" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1477.8092,-7711.5735C1493.5262,-7680.6369 1536.027,-7592.2396 1551.1179,-7513 1599.2877,-7260.0705 1517.652,-5443.9277 1587.1179,-5196 1625.4939,-5059.0341 1710.7261,-5056.9559 1749.1377,-4920 1816.4179,-4680.1131 1698.0237,-2911.417 1785.1377,-2678 1834.9496,-2544.5319 2081.2374,-2269.5863 2197.3169,-2187 2298.9556,-2114.6878 3139.1459,-1723.1067 3246.2772,-1787"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1473.6471,-7734.1131C1483.4016,-7795.5745 1530.7206,-8100.1743 1551.1179,-8351 1568.7634,-8567.9863 1531.8759,-9119.4229 1587.1179,-9330 1626.9664,-9481.8984 1693.476,-9497.1573 1749.1377,-9644 1772.2149,-9704.8807 1744.5641,-9735.0805 1785.1377,-9786 1837.3733,-9851.5552 1899.4219,-9807.5264 1952.9868,-9872 1988.8415,-9915.1566 1960.8639,-9944.4495 1988.9868,-9993 2044.6609,-10089.114 2119.2321,-10071.2071 2161.3169,-10174 2207.737,-10287.3818 2122.464,-12282.0088 2197.3169,-12379 2240.6895,-12435.2004 2305.9796,-12367.2333 2351.1489,-12422 2413.9929,-12498.1967 2326.7313,-12786.8654 2387.1489,-12865 2393.3139,-12872.9728 2401.9001,-12878.6846 2411.1785,-12882.7743"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2410.032,-12886.0826 2420.6236,-12886.3469 2412.5086,-12879.5353 2410.032,-12886.0826"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1473.7736,-7734.1038C1484.2013,-7795.5156 1534.5117,-8099.8948 1551.1179,-8351 1571.2852,-8655.9515 1544.7655,-13549.3312 1587.1179,-13852 1601.678,-13956.0524 1643.0649,-14075.4707 1660.3713,-14122.4743"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.0952,-14123.7066 1663.8626,-14131.8584 1663.6559,-14121.2656 1657.0952,-14123.7066"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~daylightingdevices.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~daylightingdevices.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1474.2191,-8382.1189C1485.6003,-8436.6024 1535.0991,-8680.9621 1551.1179,-8884 1555.8043,-8943.3993 1551.6385,-17416.1309 1587.1179,-17464 1590.5141,-17468.5821 1594.7382,-17472.3499 1599.4618,-17475.4448"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1597.9752,-17478.6203 1608.4329,-17480.3197 1601.3175,-17472.4697 1597.9752,-17478.6203"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1476.6973,-8359.6828C1491.377,-8324.6117 1535.4297,-8214.31 1551.1179,-8118 1617.4407,-7710.8444 1527.3271,-6670.166 1587.1179,-6262 1602.3462,-6158.0433 1643.3555,-6038.571 1660.466,-5991.5392"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.7525,-5992.7429 1663.9166,-5982.1493 1657.1821,-5990.3283 1663.7525,-5992.7429"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge605" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1474.0828,-8382.1307C1484.8253,-8436.6699 1531.7921,-8681.2502 1551.1179,-8884 1561.4361,-8992.2496 1546.019,-9761.3256 1587.1179,-9862 1678.4261,-10085.6651 1835.8371,-10052.72 1952.9868,-10264 1981.6438,-10315.6829 1960.3741,-10340.2926 1988.9868,-10392 2044.1849,-10491.7509 2119.2241,-10476.0507 2161.3169,-10582 2236.4061,-10771.0028 2144.5344,-12215.5962 2197.3169,-12412 2209.8029,-12458.4606 2240.9841,-12506.1414 2259.5863,-12531.8088"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2256.8316,-12533.9703 2265.5903,-12539.9316 2262.4608,-12529.8095 2256.8316,-12533.9703"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge661" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1522.1097,-8379.571C1625.7161,-8393.9693 1861.08,-8408.9626 1952.9868,-8268 2003.1815,-8191.0136 1930.2631,-7926.6962 1988.9868,-7856 2014.3878,-7825.4203 2049.6113,-7862.4632 2075.1519,-7832"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M2075.1519,-7832C2100.7179,-7801.5581 2125.8085,-7825.8741 2161.3169,-7808 2179.4222,-7798.8862 2180.1993,-7790.856 2197.3169,-7780 2277.795,-7728.9606 2379.7076,-7681.5296 2432.3793,-7658.1748"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2433.8867,-7661.3354 2441.625,-7654.0987 2431.0628,-7654.9302 2433.8867,-7661.3354"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge835" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1668.1278,-8214C1698.7523,-8180.567 1722.4843,-8188.6773 1749.1377,-8152 1777.3989,-8113.1102 1750.1274,-8082.9453 1785.1377,-8050 1813.3905,-8023.4136 1848.4299,-8058.8536 1869.0623,-8026"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1869.0623,-8026C1923.396,-7939.4827 1930.5883,-7911.678 1952.9868,-7812 1978.6736,-7697.6881 1932.0259,-7388.3839 1988.9868,-7286 2011.9239,-7244.772 2052.3504,-7265.3032 2075.1519,-7224"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge883" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1869.0623,-8178C1900.032,-8143.4825 1929.9189,-8156.23 1952.9868,-8116 2027.6946,-7985.7111 1906.623,-7905.5892 1988.9868,-7780 2045.2396,-7694.2251 2697.4415,-7364.4982 2791.6838,-7324 2825.3794,-7309.5202 2846.4617,-7327.5806 2870.6353,-7300"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2870.6353,-7300C2942.7815,-7216.9245 3015.5266,-7106.944 3043.9728,-7062.6859"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3047.0619,-7064.3518 3049.5013,-7054.0416 3041.1648,-7060.5803 3047.0619,-7064.3518"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1474.0788,-8382.0524C1482.8638,-8424.1599 1518.2333,-8577.5237 1587.1179,-8684 1847.6995,-9086.7858 2329.91,-9443.3133 2443.194,-9523.9717"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2441.3921,-9526.9846 2451.5742,-9529.9132 2445.4408,-9521.2742 2441.3921,-9526.9846"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge538" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1506.7655,-8382.0486C1529.4108,-8388.6514 1559.7023,-8396.4297 1587.1179,-8400 1737.2972,-8419.5579 2838.4516,-8336.1151 2949.5867,-8439 3031.3176,-8514.6636 2921.6541,-8595.7993 2985.5867,-8687 3026.6203,-8745.535 3070.2694,-8719.9525 3127.3396,-8763 3230.188,-8840.5776 3278.9102,-8852.4019 3329.2148,-8971 3399.0238,-9135.5815 3433.5034,-12049.1133 3436.6443,-12327.6537"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3433.145,-12327.7433 3436.7568,-12337.7034 3440.1445,-12327.6648 3433.145,-12327.7433"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1522.2938,-8361.642C1532.6203,-8358.0105 1542.847,-8352.9762 1551.1179,-8346 1577.86,-8323.4442 1564.6801,-8302.8411 1587.1179,-8276 1616.1969,-8241.2144 1636.9999,-8246.9648 1668.1278,-8214"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-8214C1707.3977,-8172.4128 1721.2109,-8163.9171 1749.1377,-8114 1772.6097,-8072.0456 1768.3593,-8057.0511 1785.1377,-8012 1856.4502,-7820.5212 1909.7149,-7783.6926 1952.9868,-7584 2016.8923,-7289.0867 1959.2964,-7206.2936 1988.9868,-6906 2015.234,-6640.5313 1980.5071,-6561.4092 2075.1519,-6312"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge490" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1474.7062,-8382.4025C1484.0085,-8417.1873 1517.0878,-8522.4646 1587.1179,-8570 1871.1316,-8762.7845 2022.8527,-8582.7445 2351.1489,-8683 2568.3041,-8749.3151 2662.3856,-8787.9988 2755.6838,-8995 2812.5037,-9121.0664 2862.1923,-10157.2064 2869.666,-10319.6179"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2866.1773,-10319.9475 2870.1307,-10329.7771 2873.17,-10319.6276 2866.1773,-10319.9475"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge495" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1473.9003,-8382.1502C1483.787,-8436.7803 1527.362,-8681.7214 1551.1179,-8884 1562.7158,-8982.7547 1545.0523,-9239.9029 1587.1179,-9330 1639.3725,-9441.9201 1684.1564,-9453.8702 1785.1377,-9525 1852.8563,-9572.7 1886.4409,-9556.6772 1952.9868,-9606 2062.7372,-9687.3453 2101.4255,-9709.2188 2161.3169,-9832 2204.5618,-9920.6547 2158.9606,-9960.1233 2197.3169,-10051 2230.3137,-10129.1785 2398.2685,-10334.0028 2451.3566,-10397.7667"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2448.9653,-10400.3639 2458.0593,-10405.8 2454.3402,-10395.8793 2448.9653,-10400.3639"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1474.0458,-8382.1344C1484.6148,-8436.6904 1530.8941,-8681.3378 1551.1179,-8884 1559.821,-8971.2137 1551.735,-9591.8126 1587.1179,-9672 1628.2264,-9765.1631 1688.1294,-9752.4693 1749.1377,-9834 1769.1563,-9860.7526 1761.2075,-9876.6807 1785.1377,-9900 1845.1697,-9958.4995 1891.5003,-9929.0312 1952.9868,-9986 2082.9867,-10106.448 2111.6888,-10155.8685 2161.3169,-10326 2192.5612,-10433.1095 2130.9337,-12244.3233 2197.3169,-12334 2201.0097,-12338.9885 2205.7204,-12342.9997 2210.9874,-12346.2223"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.7925,-12349.5403 2220.2952,-12350.9346 2212.9543,-12343.295 2209.7925,-12349.5403"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge699" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1522.0078,-8367.5153C1580.0287,-8361.6422 1676.8477,-8346.0448 1749.1377,-8305 1769.0898,-8293.6716 1766.3599,-8281.1839 1785.1377,-8268 1852.1588,-8220.9446 1905.3527,-8258.6111 1952.9868,-8192 2050.122,-8056.1671 1894.1097,-7955.4197 1988.9868,-7818 2037.5082,-7747.7217 2092.9089,-7784.1245 2161.3169,-7733 2180.2122,-7718.8787 2178.4891,-7708.2112 2197.3169,-7694 2346.803,-7581.1686 2807.6978,-7436.248 2949.5867,-7314 3053.147,-7224.775 3082.1896,-7192.0245 3127.3396,-7063 3199.039,-6858.1056 3240.7495,-5210.4746 3245.7652,-5001.7198"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3249.2708,-5001.523 3246.0102,-4991.4423 3242.2728,-5001.356 3249.2708,-5001.523"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge743" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-8178C1899.8957,-8143.3607 1930.1359,-8156.3537 1952.9868,-8116 2035.271,-7970.6895 1924.6217,-7896.0875 1988.9868,-7742 2013.1951,-7684.0464 2312.9902,-7357.8855 2351.1489,-7308 2443.7585,-7186.93 2497.2265,-7170.8015 2547.7793,-7027 2611.8344,-6844.79 2662.5757,-5383.5027 2669.0362,-5190.1074"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.5353,-5190.1902 2669.3693,-5180.0794 2665.5392,-5189.9577 2672.5353,-5190.1902"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1501.6957,-8359.8923C1584.6381,-8328.4974 1815.4458,-8237.5314 1869.0623,-8178"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge838" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1869.0623,-8026C1900.0223,-7976.928 1930.2596,-7979.3859 1952.9868,-7926 2011.8152,-7787.8129 1922.1079,-7724.4755 1988.9868,-7590 2035.7969,-7495.8776 2089.2568,-7504.5346 2161.3169,-7428 2251.7064,-7331.9977 2274.7125,-7307.4438 2351.1489,-7200 2394.0585,-7139.6836 2437.079,-7063.0962 2456.6059,-7027.2391"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.7877,-7028.7134 2461.4709,-7018.2531 2453.632,-7025.3807 2459.7877,-7028.7134"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1473.1532,-18315.516C1482.0258,-18235.5288 1534.3676,-17753.21 1551.1179,-17359 1564.204,-17051.0263 1544.9043,-6567.3475 1587.1179,-6262 1601.5062,-6157.9237 1642.9903,-6038.519 1660.3469,-5991.5223"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1663.6311,-5992.7322 1663.8488,-5982.1396 1657.073,-5990.2845 1663.6311,-5992.7322"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge906" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1483.8118,-18338.1589C1503.8588,-18356.4246 1546.1212,-18392.9729 1587.1179,-18416 1753.8857,-18509.6702 1800.9061,-18535.1968 1988.9868,-18570 2330.9183,-18633.2724 2456.2085,-18590.7345 2755.6838,-18414 3019.1031,-18258.544 3539.3043,-17662.0852 3670.96,-17386 3695.3063,-17334.9451 3771.7172,-16937.0133 3790.0915,-16840.185"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3793.5719,-16840.6166 3791.9942,-16830.1399 3786.6942,-16839.3138 3793.5719,-16840.6166"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge707" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-18402C1725.4355,-18430.3193 1894.8865,-18388.6554 1952.9868,-18362 2065.0014,-18310.6096 2082.996,-18274.1529 2161.3169,-18179 2267.8692,-18049.5486 2296.6339,-18011.5534 2351.1489,-17853 2389.7956,-17740.5987 2348.1991,-17700.2965 2387.1489,-17588 2392.1893,-17573.468 2942.2398,-16647.5132 2949.5867,-16634 2994.6739,-16551.0709 3307.2971,-15965.8134 3329.2148,-15874 3372.1072,-15694.3238 3363.7918,-9408.7194 3365.2148,-9224 3388.722,-6172.5764 3432.9084,-2390.9227 3436.6298,-2074.3128"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3440.1312,-2074.2108 3436.7491,-2064.1703 3433.1317,-2074.1284 3440.1312,-2074.2108"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-18326C1704.6269,-18299.1032 1728.0418,-18304.1322 1749.1377,-18264 1823.0577,-18123.3766 1710.0266,-17689.9908 1785.1377,-17550 1828.9883,-17468.272 1903.2523,-17504.2868 1952.9868,-17426 1996.7346,-17357.1369 1949.3843,-17317.3277 1988.9868,-17246 2040.0139,-17154.0955 2118.9388,-17180.1993 2161.3169,-17084 2220.584,-16949.4622 2163.1467,-14580.9874 2197.3169,-14438 2233.4371,-14286.8527 2308.76,-14273.5104 2351.1489,-14124 2396.2158,-13965.0442 2336.427,-13911.2427 2387.1489,-13754 2430.7203,-13618.9246 2509.6402,-13614.7086 2547.7793,-13478 2610.8181,-13252.0389 2564.2468,-11600.7751 2583.7793,-11367 2601.8105,-11151.1935 2650.7716,-10892.957 2665.4905,-10818.2142"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2668.9673,-10818.6743 2667.4777,-10808.1847 2662.1008,-10817.3137 2668.9673,-10818.6743"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge430" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1668.1278,-18326C1698.2293,-18303.5502 1719.2281,-18324.7048 1749.1377,-18302 2044.0583,-18078.1213 2024.8309,-17922.1967 2161.3169,-17578 2417.2495,-16932.5771 2363.2684,-16732.367 2583.7793,-16074 2664.4035,-15833.2847 2697.8463,-15777.8784 2791.6838,-15542 2860.808,-15368.2433 2913.0684,-15335.4011 2949.5867,-15152 2972.8696,-15035.0691 2916.3079,-10957.033 2985.5867,-10860 2987.8422,-10856.8408 2990.5308,-10854.0782 2993.5211,-10851.6628"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6246,-10854.4684 3002.0518,-10846.0457 2991.7749,-10848.622 2995.6246,-10854.4684"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge436" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1489.4621,-18315.8475C1541.4478,-18281.7058 1694.1511,-18172.5871 1749.1377,-18036 1793.4904,-17925.8276 1778.4774,-9603.578 1785.1377,-9485 1801.9653,-9185.4046 1852.7221,-8823.3468 1865.9057,-8732.4721"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1869.4055,-8732.7268 1867.3855,-8722.3264 1862.4788,-8731.7165 1869.4055,-8732.7268"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge484" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1668.1278,-18326C1698.3767,-18303.7492 1725.4051,-18331.1008 1749.1377,-18302 1808.3413,-18229.4049 1758.446,-17971.7923 1785.1377,-17882 1839.7474,-17698.2896 1878.4843,-17658.5917 1988.9868,-17502 2054.7184,-17408.8526 2118.1781,-17417.5278 2161.3169,-17312 2238.0646,-17124.2566 2161.1748,-16599.5784 2197.3169,-16400 2236.1817,-16185.3865 2298.64,-16145.6891 2351.1489,-15934 2374.2633,-15840.8147 2368.1493,-15815.1105 2387.1489,-15721 2448.8597,-15415.3295 2503.5934,-15346.6913 2547.7793,-15038 2558.4058,-14963.761 2536.86,-14422.5058 2583.7793,-14364 2608.5931,-14333.0586 2663.2101,-14379.1224 2669.7316,-14340"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge500" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1506.4958,-18338.0356C1548.933,-18349.2526 1620.9953,-18360.5431 1668.1278,-18326"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M1668.1278,-18326C1714.2623,-18292.1883 1728.7555,-18279.4433 1749.1377,-18226 1808.7549,-18069.6801 1763.2452,-17639.8639 1785.1377,-17474 1830.9711,-17126.753 1894.3385,-17049.3137 1952.9868,-16704 1975.0294,-16574.2159 1940.8589,-16532.5295 1988.9868,-16410 2036.7319,-16288.4453 2120.2734,-16295.9781 2161.3169,-16172 2210.8374,-16022.4157 2169.283,-13491.0544 2197.3169,-13336 2233.28,-13137.089 2314.9503,-13106.8682 2351.1489,-12908 2374.9296,-12777.3538 2342.4345,-10643.0382 2387.1489,-10518 2399.1494,-10484.4422 2427.2495,-10453.5892 2446.8061,-10435.038"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.3572,-10437.4467 2454.3385,-10428.0959 2444.6132,-10432.2993 2449.3572,-10437.4467"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-18326C1698.3575,-18303.7232 1724.6404,-18330.4601 1749.1377,-18302 1824.6675,-18214.2521 1732.6124,-18147.1772 1785.1377,-18044 1832.1737,-17951.6057 1905.9014,-17974.3692 1952.9868,-17882 2005.1675,-17779.6352 1929.5803,-17724.3476 1988.9868,-17626 2037.7737,-17545.2332 2116.4546,-17585.0109 2161.3169,-17502 2204.6771,-17421.7683 2172.5834,-16769.7809 2197.3169,-16682 2235.6138,-16546.0818 2298.7864,-16535.1433 2351.1489,-16404 2417.3894,-16238.0991 2730.011,-15024.7819 2755.6838,-14848 2823.1737,-14383.269 2764.7445,-14260.8326 2791.6838,-13792 2813.7262,-13408.3918 2858.3914,-12941.3382 2868.5483,-12837.2291"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2872.0514,-12837.3679 2869.5421,-12827.0745 2865.0846,-12836.686 2872.0514,-12837.3679"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1509.758,-18338.0363C1550.3168,-18350.6264 1615.8806,-18373.2436 1668.1278,-18402"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1668.1278,-18402C1740.9562,-18442.0841 1900.9696,-18394.4512 2161.3169,-18072 2289.4937,-17913.2475 2288.5469,-17848.1974 2351.1489,-17654 2376.1802,-17576.3506 2362.0471,-17551.6267 2387.1489,-17474 2440.0587,-17310.3781 2504.4232,-17288.4086 2547.7793,-17122 2597.2481,-16932.1295 2540.4151,-16873.3571 2583.7793,-16682 2684.6909,-16236.698 2860.0225,-16169.7223 2949.5867,-15722 3000.5247,-15467.3661 2968.6795,-14813.1278 2985.5867,-14554 3003.3785,-14281.3135 3043.1358,-13951.3795 3053.7921,-13865.3365"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3057.2857,-13865.6048 3055.0469,-13855.2493 3050.3392,-13864.7407 3057.2857,-13865.6048"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacmixercomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge666" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacmixercomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1476.2534,-18315.7276C1509.3978,-18230.29 1720.0535,-17683.3447 1749.1377,-17509 1792.5462,-17248.7884 1768.2368,-8275.2655 1785.1377,-8012 1801.6765,-7754.3749 1851.723,-7444.26 1865.5116,-7361.905"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1868.967,-7362.4619 1867.1764,-7352.0195 1862.0642,-7361.2994 1868.967,-7362.4619"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge997" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M461.8576,-9202C481.6023,-9202 503.2502,-9202 522.7047,-9202"/>
<polygon fill="#ff0033" stroke="#ff0033" points="522.9577,-9205.5001 532.9576,-9202 522.9576,-9198.5001 522.9577,-9205.5001"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.6723,-9190.8427C398.4222,-9066.7504 408.1054,-7943.3742 514.0276,-7630 559.2248,-7496.2825 563.4229,-7431.2253 687.5354,-7364 732.3693,-7339.7158 762.8276,-7331.674 802.259,-7364 865.3516,-7415.7235 786.2319,-7481.1575 838.259,-7544 871.4528,-7584.094 1220.3536,-7719.6086 1272.4036,-7720"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1272.4036,-7720C1317.6852,-7721.4256 1368.7713,-7722.1776 1407.9068,-7722.5721"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1408.0665,-7726.0737 1418.0995,-7722.6696 1408.1335,-7719.074 1408.0665,-7726.0737"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge998" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0033" stroke-dasharray="5,2" d="M406.7974,-9415.8422C436.4135,-9379.855 529.6519,-9266.5589 567.0422,-9221.1251"/>
<polygon fill="#ff0033" stroke="#ff0033" points="569.8917,-9223.1707 573.5436,-9213.2251 564.4866,-9218.7225 569.8917,-9223.1707"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M403.6077,-9415.8703C419.4696,-9385.732 462.4003,-9299.5786 478.0276,-9222 494.6637,-9139.4129 453.7537,-7764.8595 514.0276,-7706 520.3287,-7699.8467 708.0307,-7702.2322 1272.4036,-7720"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge560" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M402.1843,-9438.2496C414.8039,-9469.4478 450.9908,-9559.788 478.0276,-9636 578.6604,-9919.6662 455.6958,-10088.0524 687.5354,-10280 822.8763,-10392.0531 1296.1618,-10380 1471.8691,-10380 1471.8691,-10380 1471.8691,-10380 1668.1278,-10380 1731.5062,-10380 1904.7176,-10352.9281 1952.9868,-10394 2011.4752,-10443.7673 1943.9016,-10500.8309 1988.9868,-10563 2040.9737,-10634.686 2116.3629,-10586.7068 2161.3169,-10663 2212.2899,-10749.5083 2140.0761,-12387.505 2197.3169,-12470 2239.2454,-12530.4271 2307.9837,-12471.45 2351.1489,-12531 2427.9796,-12636.9944 2340.9662,-12996.5054 2387.1489,-13119 2428.2302,-13227.9635 2503.9208,-13218.1244 2547.7793,-13326 2601.5157,-13458.1716 2557.9878,-13504.6728 2583.7793,-13645 2639.3514,-13947.3584 2680.6658,-14016.8706 2755.6838,-14315 2843.4846,-14663.9293 2886.0653,-14746.8452 2949.5867,-15101 2974.6195,-15240.5673 2932.3668,-15286.572 2985.5867,-15418 3024.3327,-15513.6845 3087.7098,-15506.6782 3127.3396,-15602 3174.1526,-15714.5996 3083.8204,-15781.551 3163.3396,-15874 3188.363,-15903.0922 3214.8883,-15875.9261 3246.2772,-15898"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-15974C3579.9938,-15845.4828 3605.5631,-12662.6662 3607.6107,-12370.4431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.1116,-12370.3168 3607.6804,-12360.293 3604.1118,-12370.2687 3611.1116,-12370.3168"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-15898C3264.5923,-15911.5788 3419.9173,-15989.2335 3436.8809,-15974"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge932" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M1286.5011,-5539.774C1306.5354,-5522.8235 1342.3896,-5488.5526 1356.6204,-5450 1413.435,-5296.0834 1349.8647,-2655.3988 1392.6204,-2497 1429.8855,-2358.9421 1505.132,-2352.403 1551.1179,-2217 1588.0669,-2108.2059 1541.5942,-2066.4939 1587.1179,-1961 1754.9321,-1572.1178 1882.8829,-1512.7644 2197.3169,-1229 2260.2959,-1172.1639 2300.7087,-1184.2091 2351.1489,-1116 2379.9821,-1077.0096 2350.1453,-1044.3423 2387.1489,-1013 2641.5019,-797.5614 3594.3798,-710.214 3881.228,-880 3996.9562,-948.4997 3993.3875,-1014.8599 4027.281,-1145 4084.3286,-1364.0442 4122.8095,-17110.4277 4124.3936,-17768.7639"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4120.8937,-17768.8343 4124.4178,-17778.8258 4127.8937,-17768.8174 4120.8937,-17768.8343"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1341.127,-5559.4652C1347.0608,-5562.6024 1352.3998,-5566.6927 1356.6204,-5572 1428.8319,-5662.8047 1341.3034,-7555.9492 1392.6204,-7660 1402.6171,-7680.2695 1422.5653,-7696.0712 1439.9459,-7706.7795"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1438.334,-7709.8913 1448.7345,-7711.9117 1441.864,-7703.8465 1438.334,-7709.8913"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge562" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-1787C3279.8226,-1805.6341 3302.5375,-1783.4167 3329.2148,-1811 3374.478,-1857.8003 3325.5536,-1901.3667 3365.2148,-1953 3409.6558,-2010.8558 3471.4458,-1970.1844 3508.5469,-2033 3532.5835,-2073.6962 3543.9964,-8791.7387 3544.5469,-8839 3561.607,-10303.6383 3602.3403,-12111.7291 3607.2636,-12327.6148"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.771,-12327.9845 3607.4986,-12337.9019 3610.7692,-12327.8246 3603.771,-12327.9845"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1286.4721,-5539.7632C1306.4702,-5522.7993 1342.28,-5488.5119 1356.6204,-5450 1395.6515,-5345.1798 1378.2737,-3547.9273 1392.6204,-3437 1404.3124,-3346.5986 1529.3924,-2710.547 1587.1179,-2640 1637.4868,-2578.4437 1703.8679,-2629.3977 1749.1377,-2564 1806.9923,-2480.422 1739.2218,-2198.6872 1785.1377,-2108 1839.2056,-2001.2121 1889.2505,-1998.1791 1988.9868,-1932 2153.5009,-1822.8383 2194.8995,-1779.9589 2387.1489,-1735 2480.2699,-1713.223 3163.6309,-1738.882 3246.2772,-1787"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1285.9474,-5539.9704C1305.6327,-5523.0118 1341.451,-5488.4386 1356.6204,-5450 1460.2242,-5187.472 1292.1229,-5079.7328 1392.6204,-4816 1492.4745,-4553.9555 1535.9173,-4450.5589 1785.1377,-4322 1922.1712,-4251.3121 2110.4697,-4267.72 2208.6538,-4283.3048"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2208.2993,-4286.7933 2218.7329,-4284.9525 2209.4286,-4279.885 2208.2993,-4286.7933"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1274.1889,-8981.6328C1292.3762,-8865.834 1443.8996,-7901.0826 1468.5003,-7744.4496"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1472.0106,-7744.6566 1470.1046,-7734.2346 1465.0954,-7743.5704 1472.0106,-7744.6566"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge902" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-8898C1777.8298,-8776.6637 1817.3361,-8634.8889 1952.9868,-8335 1976.21,-8283.6595 1946.4078,-8120.9078 1988.9868,-8084 2046.8619,-8033.8335 2086.5574,-8067.3498 2161.3169,-8084 2363.718,-8129.0781 2386.2852,-8218.7994 2583.7793,-8282 2741.2007,-8332.3768 2796.8948,-8285.7189 2949.5867,-8349 3097.6523,-8410.3638 3088.227,-8527.3715 3246.2772,-8554"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1285.0537,-8981.7883C1305.8938,-8963.9729 1349.451,-8929.4371 1392.6204,-8912 1425.7842,-8898.6044 1437.5762,-8908.1625 1471.8691,-8898"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-8825C3701.4832,-9018.8558 3788.6062,-16349.5909 3793.845,-16797.5904"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3790.3485,-16797.916 3793.965,-16807.8744 3797.348,-16797.8342 3790.3485,-16797.916"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-8554C3444.435,-8586.415 3520.3504,-8644.2295 3607.7534,-8825"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge571" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-9238C3572.0379,-9331.8758 3604.6472,-12059.0731 3607.5339,-12327.7463"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3604.0345,-12327.8245 3607.6402,-12337.7869 3611.0341,-12327.7504 3604.0345,-12327.8245"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-9012C1705.469,-8999.4321 1718.5632,-9000.8499 1749.1377,-8976 1770.3872,-8958.7291 1763.5606,-8942.8598 1785.1377,-8926 1848.4305,-8876.5446 1902.329,-8921.3346 1952.9868,-8859 2011.3276,-8787.2115 1918.1443,-8713.4859 1988.9868,-8654 2047.6419,-8604.7478 2086.4683,-8637.7555 2161.3169,-8654 2199.3997,-8662.2652 3404.8745,-9215.7694 3436.8809,-9238"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge806" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1323.4423,-9004.0489C1399.5565,-9018.6061 1546.851,-9039.3484 1668.1278,-9012"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1668.1278,-9012C1705.2674,-8998.8484 1721.6971,-9004.2724 1749.1377,-8976 1778.5687,-8945.6768 1756.5565,-8919.1254 1785.1377,-8888 1841.8314,-8826.2597 1902.6441,-8869.0197 1952.9868,-8802 2003.5574,-8734.677 1925.6183,-8671.4456 1988.9868,-8616 2026.1741,-8583.4622 2740.0782,-8562.1569 2979.1801,-8555.9105"/>
<polygon fill="#003fff" stroke="#003fff" points="2979.2801,-8559.4091 2989.1858,-8555.6506 2979.0983,-8552.4115 2979.2801,-8559.4091"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge827" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2274.2329,-6996C2368.4227,-6822.7357 2440.4434,-6593.6646 2461.3083,-6523.9856"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2464.7214,-6524.7867 2464.2133,-6514.204 2458.0111,-6522.7937 2464.7214,-6524.7867"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1280.5115,-8981.9056C1298.0715,-8957.1873 1339.4196,-8895.1 1356.6204,-8836 1386.8217,-8732.2314 1332.8319,-8441.03 1392.6204,-8351 1436.3848,-8285.099 1495.1076,-8325.8669 1551.1179,-8270 1575.8872,-8245.2941 1567.5869,-8229.0249 1587.1179,-8200 1726.4513,-7992.9377 1858.4849,-8004.9935 1952.9868,-7774 1998.1897,-7663.5095 1908.6324,-7326.2871 1988.9868,-7238 2015.1016,-7209.3071 2056.4011,-7257.9658 2075.1519,-7224"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2075.1519,-7224C2127.2921,-7127.6905 2107.9328,-7073.282 2197.3169,-7010 2225.6757,-6989.9226 2257.6377,-7026.5274 2274.2329,-6996"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge777" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-8898C1524.39,-8878.0165 1532.1809,-8938.18 1587.1179,-8950 1657.5157,-8965.1465 1692.1546,-8994.0249 1749.1377,-8950 1799.2972,-8911.2469 1740.8435,-8857.3409 1785.1377,-8812 1839.3577,-8756.4986 1900.5702,-8821.2076 1952.9868,-8764 2009.8694,-8701.9182 1927.2804,-8635.2895 1988.9868,-8578 2044.7997,-8526.1822 2594.3215,-8487.3467 2669.7316,-8498"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge792" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1273.8931,-9004.3634C1283.4577,-9077.8905 1336.4785,-9494.0288 1356.6204,-9835 1363.0589,-9943.995 1351.2925,-11698.9388 1392.6204,-11800 1445.3626,-11928.9736 1584.2139,-12034.2578 1642.1538,-12073.9761"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1640.489,-12077.0756 1650.7325,-12079.7813 1644.4121,-12071.2782 1640.489,-12077.0756"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1096.2974,-4537.2683C1102.3698,-4594.6756 1130.4055,-4860.3856 1152.1868,-5078 1168.7298,-5243.2799 1124.1526,-5296.7331 1188.1868,-5450 1202.2503,-5483.6612 1231.5681,-5514.6505 1251.6184,-5533.1892"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1249.2838,-5535.7968 1259.0557,-5539.8908 1253.9696,-5530.5965 1249.2838,-5535.7968"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge908" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1101.3445,-4514.9262C1113.8993,-4491.9562 1141.8896,-4437.0841 1152.1868,-4387 1202.92,-4140.2407 1116.5142,-2361.51 1188.1868,-2120 1228.2114,-1985.1319 1307.2131,-1983.7205 1356.6204,-1852 1392.6494,-1755.9461 1351.7562,-1718.0987 1392.6204,-1624 1435.5161,-1525.2232 1899.6399,-920.1169 1988.9868,-860 2141.6053,-757.311 2204.9549,-772.3531 2387.1489,-747 2635.3001,-712.4687 2715.6856,-695.2132 2949.5867,-785 3041.4529,-820.2644 3048.9971,-857.4564 3127.3396,-917 3143.4773,-929.2653 3146.2106,-934.162 3163.3396,-945 3278.409,-1017.8081 3316.3446,-1019.6518 3436.8809,-1083"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge590" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1095.8139,-4537.0635C1101.5383,-4617.9094 1146.5232,-5122.7134 1392.6204,-5416 1444.1366,-5477.3945 1507.9416,-5434.4795 1551.1179,-5502 1618.298,-5607.0583 1560.7522,-5940.1178 1587.1179,-6062 1608.62,-6161.3987 1627.8173,-6182.6324 1668.1278,-6276"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-6276C1683.0993,-6310.4376 1725.0697,-6271.1759 1749.1377,-6300 1843.6994,-6413.2484 1686.925,-6519.9029 1785.1377,-6630 1836.0541,-6687.0776 1904.9413,-6608.4856 1952.9868,-6668 1983.82,-6706.1934 1984.3931,-10153.1295 1988.9868,-10202 2005.8735,-10381.6508 2054.1793,-10594.8119 2070.0389,-10661.7874"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2066.7283,-10662.9938 2072.4532,-10671.9087 2073.5373,-10661.3695 2066.7283,-10662.9938"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1340.1054,-13939.8729C1346.4859,-13936.3688 1352.2057,-13931.8399 1356.6204,-13926 1381.0281,-13893.712 1390.9939,-11052.4426 1392.6204,-11012 1411.214,-10549.6639 1459.8079,-9985.4987 1469.9837,-9870.1751"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1473.4741,-9870.4377 1470.8699,-9860.1679 1466.5014,-9869.8201 1473.4741,-9870.4377"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1338.8664,-13962.0387C1345.644,-13965.5413 1351.7963,-13970.094 1356.6204,-13976 1414.4789,-14046.8352 1374.0368,-14296.4462 1392.6204,-14386 1448.6843,-14656.1718 1561.3029,-15402.6496 1785.1377,-15564 1845.6536,-15607.6226 1891.2296,-15605.8467 1952.9868,-15564 2159.7788,-15423.8779 2104.571,-15285.2633 2161.3169,-15042 2207.6007,-14843.5865 2126.5829,-14776.0676 2197.3169,-14585 2343.4555,-14190.2489 2610.4079,-14215.0694 2755.6838,-13820 2792.9068,-13718.7743 2779.5802,-13443.1714 2791.6838,-13336 2813.6671,-13141.3509 2854.248,-12907.7754 2866.8206,-12837.1981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2870.2753,-12837.7614 2868.5908,-12827.3013 2863.3847,-12836.5288 2870.2753,-12837.7614"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M416.1656,-16554.0185C438.4871,-16566.5783 477.5297,-16586.3559 514.0276,-16594 598.3066,-16611.6514 911.7105,-16592.679 920.1405,-16580"/>
<path fill="none" stroke="#00ff99" stroke-dasharray="5,2" d="M920.1405,-16580C946.9927,-16543.0862 976.1546,-16555.6105 1002.022,-16518 1069.5577,-16419.805 1088.6415,-16272.5485 1093.5475,-16218.163"/>
<polygon fill="#00ff99" stroke="#00ff99" points="1097.0502,-16218.2742 1094.3915,-16208.0185 1090.0743,-16217.6938 1097.0502,-16218.2742"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge928" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3795.7249,-16830.2192C3804.2188,-16887.3226 3845.7572,-17150.9778 3917.228,-17356 3975.2859,-17522.5455 4078.6204,-17709.7424 4112.9802,-17770.1112"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4110.0547,-17772.0459 4118.0577,-17778.9887 4116.1311,-17768.5705 4110.0547,-17772.0459"/>
</g>
<!-- sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge915" class="edge">
<title>sourcefile~heatbalanceinternalheatgains.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3844.6711,-16830.0715C3865.6359,-16834.6608 3890.124,-16840.0213 3912.0093,-16844.8121"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3911.3424,-16848.2489 3921.8595,-16846.9683 3912.8393,-16841.4108 3911.3424,-16848.2489"/>
</g>
<!-- sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge946" class="edge">
<title>sourcefile~delightmanagerf.f90&#45;&gt;sourcefile~daylightingmanager.f90</title>
<path fill="none" stroke="#6500ff" stroke-dasharray="5,2" d="M3974.0697,-16869.1161C3989.5818,-16964.111 4099.7919,-17639.0293 4120.94,-17768.5391"/>
<polygon fill="#6500ff" stroke="#6500ff" points="4117.5405,-17769.4388 4122.6064,-17778.744 4124.449,-17768.3106 4117.5405,-17769.4388"/>
</g>
<!-- sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge885" class="edge">
<title>sourcefile~outputreporttabular.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3608.2239,-12360.2851C3618.0786,-12596.6848 3779.5993,-16471.2956 3793.1854,-16797.2033"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3789.7071,-16797.8009 3793.6207,-16807.6464 3796.7011,-16797.5093 3789.7071,-16797.8009"/>
</g>
<!-- sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge890" class="edge">
<title>sourcefile~plantpipeheattransfer.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3436.8809,-16430C3533.2465,-16592.3935 3430.1552,-16754.8373 3607.7534,-16819"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2275.3501,-12562.0101C2282.5081,-12631.5647 2323.6602,-13017.0065 2387.1489,-13326 2680.2531,-14752.5097 2693.6946,-15177.5966 3436.8809,-16430"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3607.7534,-16819C3641.3932,-16831.1534 3680.733,-16832.809 3714.5747,-16830.7677"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3715.1665,-16834.2342 3724.8884,-16830.023 3714.6623,-16827.2523 3715.1665,-16834.2342"/>
</g>
<!-- sourcefile~plantwateruse.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge891" class="edge">
<title>sourcefile~plantwateruse.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2475.2571,-5995.7802C2492.1248,-5970.7953 2531.7838,-5908.1084 2547.7793,-5849 2565.7176,-5782.7121 2539.9619,-5284.8763 2583.7793,-5232 2634.0308,-5171.3593 2706.7544,-5250.7123 2755.6838,-5189 2796.9346,-5136.9725 2782.0474,-2864.6934 2791.6838,-2799 2837.5433,-2486.3665 2849.1689,-2400.0141 2985.5867,-2115 3032.6243,-2016.7256 3081.6798,-2013.9221 3127.3396,-1915 3154.6252,-1855.8857 3115.8915,-1817.5835 3163.3396,-1773 3275.8258,-1667.3049 3377.6959,-1653.1304 3508.5469,-1735 3594.0157,-1788.4754 3508.1189,-1923.5892 3607.7534,-1939"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge892" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-7604C2787.7777,-7551.4129 3122.6415,-7565.6099 3246.2772,-7528"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge867" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2523.5961,-7639.0762C2565.3781,-7634.5409 2623.0166,-7624.8105 2669.7316,-7604"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2669.7316,-7604C2731.7261,-7576.3827 2741.0006,-7369.1359 2791.6838,-7324 2819.0725,-7299.6091 2846.4617,-7327.5806 2870.6353,-7300"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2468.2996,-7654.4088C2474.1011,-7731.183 2510.333,-8172.7445 2583.7793,-8282 2691.3201,-8441.9729 2852.9991,-8348.1852 2949.5867,-8515 2953.3993,-8521.5847 3045.1666,-10581.1818 3055.5161,-10813.7144"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3052.0286,-10814.0758 3055.9698,-10823.9103 3059.0217,-10813.7645 3052.0286,-10814.0758"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge894" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3444.1641,-2041.8231C3470.4551,-2002.5944 3561.3532,-1876.8456 3607.7534,-1939"/>
</g>
<!-- sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge566" class="edge">
<title>sourcefile~zoneplenumcomponent.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3437.0499,-2064.2483C3440.4672,-2291.5504 3495.0878,-5918.7739 3544.5469,-8839 3569.3512,-10303.5276 3603.2885,-12111.7156 3607.3507,-12327.6136"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.8566,-12327.969 3607.5443,-12337.9013 3610.8554,-12327.8372 3603.8566,-12327.969"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge899" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3123.678,-8548.5851C3160.1891,-8546.9989 3205.9824,-8547.2111 3246.2772,-8554"/>
</g>
<!-- sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge568" class="edge">
<title>sourcefile~electricpowermanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3067.0684,-8565.2491C3093.8807,-8592.5569 3167.8459,-8660.9953 3246.2772,-8673"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-8673C3482.482,-8709.1536 3462.7829,-8988.1024 3508.5469,-9224 3571.2886,-9547.4124 3604.2491,-12067.7511 3607.4886,-12327.4115"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3603.9932,-12327.8099 3607.6169,-12337.7657 3610.9926,-12327.7231 3603.9932,-12327.8099"/>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge901" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2471.184,-6491.8838C2500.5788,-6403.3786 2695.8094,-5803.1813 2755.6838,-5298 2783.8958,-5059.966 2722.3066,-3370.4404 2791.6838,-3141 2871.6247,-2876.624 3041.4175,-2880.493 3127.3396,-2618 3167.4437,-2495.4815 3086.2275,-2142.3094 3163.3396,-2039 3240.7675,-1935.2674 3308.0638,-1926.2842 3436.8809,-1939"/>
</g>
<!-- sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge802" class="edge">
<title>sourcefile~electricpowergenerators.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M2476.6706,-6514.1026C2533.068,-6582.8473 2833.2812,-6959.4474 2949.5867,-7324 3025.6248,-7562.337 3051.856,-8388.692 3055.8904,-8532.5587"/>
<polygon fill="#003fff" stroke="#003fff" points="3052.3962,-8532.8202 3056.1699,-8542.7202 3059.3936,-8532.6277 3052.3962,-8532.8202"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge912" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~heatbalanceinternalheatgains.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3246.2772,-7528C3542.1607,-7431.7374 3421.6181,-1689.6665 3607.7534,-1939"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3058.2637,-7054.2929C3070.6094,-7129.9079 3145.2811,-7558.723 3246.2772,-7528"/>
</g>
<!-- sourcefile~radiantsystemlowtemp.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge555" class="edge">
<title>sourcefile~radiantsystemlowtemp.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2506.7571,-9552.0764C2571.6321,-9572.683 2699.5453,-9623.6278 2755.6838,-9718 2794.1385,-9782.6446 2737.1011,-10342.2467 2791.6838,-10394 2842.6103,-10442.2866 2891.1137,-10432.8073 2949.5867,-10394 3181.865,-10239.8414 3164.7558,-9177.4519 3436.8809,-9238"/>
</g>
<!-- sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge557" class="edge">
<title>sourcefile~exteriorenergyusemanager.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.4203,-12670.0254C1529.2646,-12725.301 1740.9054,-12970.387 1749.1377,-12990 1812.7401,-13141.5294 1733.8789,-13201.8624 1785.1377,-13358 1887.0965,-13668.5732 2069.7461,-13676.2069 2161.3169,-13990 2233.6886,-14238.0021 2104.6161,-14910.8584 2197.3169,-15152 2371.9405,-15606.2467 2564.6841,-15667.7164 2985.5867,-15912 3160.6913,-16013.6273 3290.389,-16113.7493 3436.8809,-15974"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge563" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1098.4267,-5086.5279C1108.5532,-5051.0109 1139.1339,-4939.5621 1152.1868,-4845 1193.9342,-4542.5593 1147.0153,-4461.5197 1188.1868,-4159 1234.842,-3816.1866 1285.2613,-3737.5346 1356.6204,-3399 1373.4476,-3319.1699 1374.8525,-3298.626 1392.6204,-3219 1471.2764,-2866.5049 1474.5884,-2773.186 1587.1179,-2430 1596.0898,-2402.638 1766.8321,-1973.2279 1785.1377,-1951 2020.2168,-1665.5504 3257.9512,-1425.3832 3436.8809,-1749"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge634" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1126.5472,-5086.9358C1135.2408,-5083.1713 1144.4147,-5078.4988 1152.1868,-5073 1279.8751,-4982.66 1249.1281,-4878.2545 1392.6204,-4816 1457.2438,-4787.963 1493.7355,-4775.1401 1551.1179,-4816 1590.962,-4844.3715 1556.7269,-4881.6741 1587.1179,-4920 1706.6034,-5070.6823 1805.6658,-5027.394 1952.9868,-5151 2003.3711,-5193.2737 2319.3524,-5531.4272 2351.1489,-5589 2428.1024,-5728.3368 2457.2664,-5922.4498 2465.1033,-5985.973"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2461.6347,-5986.4453 2466.29,-5995.9626 2468.5858,-5985.6195 2461.6347,-5986.4453"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge648" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1096.821,-5109.2042C1108.0929,-5182.5213 1171.57,-5591.4691 1188.1868,-5612 1357.7053,-5821.4495 1535.1218,-5678.2844 1749.1377,-5842 1867.4387,-5932.4967 1893.7835,-5971.3261 1952.9868,-6108 1992.0201,-6198.1103 1962.412,-6231.463 1988.9868,-6326 2044.2571,-6522.6177 2108.5107,-6554.7063 2161.3169,-6752 2191.2514,-6863.8408 2145.3981,-6906.5162 2197.3169,-7010 2240.4185,-7095.9095 2303.8651,-7078.3196 2351.1489,-7162 2441.6311,-7322.1306 2462.1228,-7550.8167 2466.4075,-7621.4144"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2462.9295,-7621.9068 2466.9817,-7631.696 2469.9186,-7621.5164 2462.9295,-7621.9068"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge477" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1134.5837,-5087.5857C1141.4617,-5084.0407 1147.8041,-5079.3084 1152.1868,-5073 1233.2075,-4956.3785 1145.9303,-4570.5704 1188.1868,-4435 1230.9495,-4297.8053 1300.9091,-4291.4662 1356.6204,-4159 1381.8612,-4098.9841 1357.0705,-4071.5456 1392.6204,-4017 1441.456,-3942.0695 1488.5786,-3956.9401 1551.1179,-3893 1653.9246,-3787.8908 1669.7299,-3751.7398 1749.1377,-3628 1767.1838,-3599.8791 1756.4057,-3579.0563 1785.1377,-3562 1849.2858,-3523.9196 1888.3357,-3524.7799 1952.9868,-3562 1980.6014,-3577.8979 1965.7261,-3602.2228 1988.9868,-3624 2191.3374,-3813.445 2326.4154,-3734.1672 2547.7793,-3901 2602.5378,-3942.2692 2730.65,-4065.1647 2755.6838,-4129 2800.5714,-4243.4615 2788.4685,-8432.0935 2791.6838,-8555 2810.6699,-9280.7318 2860.8728,-10171.2926 2869.3968,-10319.6045"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9072,-10319.8866 2869.9769,-10329.6686 2872.8956,-10319.4838 2865.9072,-10319.8866"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1134.5661,-5087.5735C1141.4454,-5084.0294 1147.7929,-5079.3006 1152.1868,-5073 1228.5928,-4963.4377 1132.2132,-4594.2796 1188.1868,-4473 1231.7112,-4378.6944 1300.6542,-4398.4969 1356.6204,-4311 1382.9765,-4269.7951 1367.2962,-4248.8471 1392.6204,-4207 1458.5084,-4098.1227 1668.313,-3840.4726 1785.1377,-3790 1853.6193,-3760.4134 1889.1929,-3751.3291 1952.9868,-3790 1982.5662,-3807.9306 1968.9661,-3830.7934 1988.9868,-3859 2067.304,-3969.3388 2094.4279,-3993.1245 2197.3169,-4081 2268.9026,-4142.14 2490.5264,-4244.2691 2547.7793,-4319 2577.5262,-4357.828 2559.4066,-4380.5917 2583.7793,-4423 2642.184,-4524.6238 2714.6191,-4513.2175 2755.6838,-4623 2785.4299,-4702.523 2789.8234,-10651.1161 2791.6838,-10736 2810.3395,-11587.1705 2861.5251,-12633.3278 2869.5661,-12794.687"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.0747,-12794.9481 2870.0694,-12804.761 2873.0659,-12794.5987 2866.0747,-12794.9481"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1095.4939,-5109.0349C1099.7502,-5230.1405 1137.732,-6324.2946 1152.1868,-7210 1152.9132,-7254.5087 1161.463,-13584.3996 1188.1868,-13620 1194.5703,-13628.5039 1203.7231,-13634.2301 1213.6633,-13638.0609"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1212.7789,-13641.4529 1223.3702,-13641.1817 1214.9214,-13634.7888 1212.7789,-13641.4529"/>
</g>
<!-- sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge572" class="edge">
<title>sourcefile~ventilatedslab.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3485.389,-12349C3500.5868,-12349 3517.715,-12349 3534.2367,-12349"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3534.4227,-12352.5001 3544.4227,-12349 3534.4227,-12345.5001 3534.4227,-12352.5001"/>
</g>
<!-- sourcefile~pollutionanalysismodule.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge574" class="edge">
<title>sourcefile~pollutionanalysismodule.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1273.4114,-14078.1362C1280.4293,-14155.6968 1322.7177,-14623.316 1356.6204,-15004 1364.6943,-15094.6601 1355.9814,-15328.6811 1392.6204,-15412 1487.1547,-15626.9762 1626.2673,-15601.8641 1749.1377,-15802 1907.1963,-16059.4517 1801.0973,-16201.4383 1988.9868,-16438 2208.6523,-16714.5691 2316.5413,-16848 2669.7316,-16848 2669.7316,-16848 2669.7316,-16848 3056.4631,-16848 3225.5377,-16848 3351.8151,-16994.1165 3436.8809,-16848"/>
</g>
<!-- sourcefile~datacostestimate.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge576" class="edge">
<title>sourcefile~datacostestimate.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M454.9892,-18606.8254C463.5849,-18610.4249 471.6788,-18615.3274 478.0276,-18622 522.3131,-18668.5446 486.8993,-18703.762 514.0276,-18762 618.726,-18986.7624 642.3329,-19064.0367 838.259,-19216 1181.2063,-19481.9951 1363.8478,-19368.2054 1749.1377,-19568 1766.2086,-19576.8522 1766.7332,-19586.4276 1785.1377,-19592 1856.5364,-19613.6178 1885.0925,-19622.9105 1952.9868,-19592 2447.4671,-19366.8762 2444.4926,-19115.3666 2755.6838,-18670 2855.0015,-18527.8599 3463.6812,-17470.4959 3508.5469,-17303 3576.9778,-17047.5287 3605.4913,-12710.047 3607.6233,-12370.0977"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.1233,-12370.0948 3607.6857,-12360.0732 3604.1234,-12370.0512 3611.1233,-12370.0948"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~outputreporttabular.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge580" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~outputreporttabular.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M980.9812,-18743.5542C1154.7905,-18735.1627 1647.5599,-18721.9676 1749.1377,-18835 1822.2649,-18916.3735 1704.9989,-19251.5218 1785.1377,-19326 1839.7822,-19376.7847 1893.1868,-19370.5989 1952.9868,-19326 1997.9633,-19292.4565 1958.227,-19251.9242 1988.9868,-19205 2043.8626,-19121.2866 2090.6253,-19130.866 2161.3169,-19060 2178.9195,-19042.354 2176.9903,-19031.4245 2197.3169,-19017 2256.9055,-18974.7138 2303.2743,-19014.1992 2351.1489,-18959 2399.4746,-18903.2808 2362.1023,-18866.3734 2387.1489,-18797 2420.5707,-18704.4294 2733.8511,-18088.6348 2791.6838,-18009 2850.2067,-17928.415 2899.138,-17935.8709 2949.5867,-17850 2978.8719,-17800.1523 2952.5088,-17772.416 2985.5867,-17725 3030.2934,-17660.9144 3084.5457,-17686.3785 3127.3396,-17621 3167.2583,-17560.014 3125.8449,-17523.5055 3163.3396,-17461 3213.4101,-17377.53 3278.6759,-17401.1872 3329.2148,-17318 3365.2615,-17258.6671 3328.0014,-17224.6081 3365.2148,-17166 3408.845,-17097.2861 3472.4121,-17124.9348 3508.5469,-17052 3564.2244,-16939.6199 3604.4148,-12710.3953 3607.5554,-12370.6339"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3611.0591,-12370.2334 3607.6514,-12360.2015 3604.0594,-12370.1689 3611.0591,-12370.2334"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M980.8739,-18741.0517C1133.9031,-18722.7428 1538.1091,-18653.2165 1749.1377,-18416 2134.306,-17983.0336 2064.6072,-17750.3683 2161.3169,-17179 2210.0337,-16891.1775 2117.6169,-14832.8256 2197.3169,-14552 2233.662,-14423.9368 2309.8016,-14421.5367 2351.1489,-14295 2405.0777,-14129.9598 2334.2355,-14071.3685 2387.1489,-13906 2430.4021,-13770.8224 2509.7185,-13766.7304 2547.7793,-13630 2615.2171,-13387.7348 2562.9843,-11617.615 2583.7793,-11367 2601.6869,-11151.1832 2650.7333,-10892.9538 2665.4816,-10818.2134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2668.9583,-10818.6745 2667.4729,-10808.1843 2662.0924,-10817.3112 2668.9583,-10818.6745"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge632" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2318.0801,-6007C2344.5753,-6007 2378.708,-6007 2407.6568,-6007"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2407.6591,-6010.5001 2417.6591,-6007 2407.6591,-6003.5001 2407.6591,-6010.5001"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge642" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M2286.6959,-6018.2604C2304.7938,-6035.5132 2337.6571,-6070.4575 2351.1489,-6108 2385.7091,-6204.1679 2378.5342,-6925.1743 2387.1489,-7027 2406.9501,-7261.0485 2451.1886,-7542.7026 2463.9537,-7621.5684"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2460.542,-7622.3947 2465.602,-7631.7031 2467.4512,-7621.2709 2460.542,-7622.3947"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge816" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2284.9852,-6018.1759C2301.4555,-6035.8656 2332.9321,-6072.0141 2351.1489,-6108 2418.7789,-6241.5978 2453.6073,-6421.0149 2464.035,-6481.8309"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2460.5957,-6482.4847 2465.7006,-6491.7686 2467.4994,-6481.3276 2460.5957,-6482.4847"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge858" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2282.7509,-5995.8971C2299.5204,-5973.3055 2336.459,-5919.7363 2351.1489,-5868 2442.4219,-5546.5457 2301.121,-5439.8975 2387.1489,-5117 2427.5049,-4965.5277 2498.7285,-4951.8841 2547.7793,-4803 2563.1434,-4756.3652 2546.3382,-4616.7652 2583.7793,-4585 2642.0388,-4535.5723 2698.4725,-4534.3627 2755.6838,-4585 2949.9893,-4756.9781 3045.3137,-6790.6531 3055.5387,-7021.6753"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.0486,-7021.9798 3055.9838,-7031.8167 3059.0419,-7021.6728 3052.0486,-7021.9798"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2286.7734,-6018.2329C2304.9701,-6035.4507 2337.958,-6070.3507 2351.1489,-6108 2379.7215,-6189.5515 2384.3027,-7576.6348 2387.1489,-7663 2412.3436,-8427.5042 2458.7319,-9366.4192 2466.3827,-9519.4626"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.9049,-9519.9944 2466.9008,-9529.8068 2469.8961,-9519.6442 2462.9049,-9519.9944"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge516" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2282.8524,-5995.9253C2299.8043,-5973.3844 2337.0547,-5919.9017 2351.1489,-5868 2435.3269,-5558.0155 2332.9185,-4739.5998 2387.1489,-4423 2426.1271,-4195.4433 2485.4275,-4151.2917 2547.7793,-3929 2566.5289,-3862.1554 2550.6493,-3838.0095 2583.7793,-3777 2636.5693,-3679.7864 2710.8659,-3698.1366 2755.6838,-3597 2845.949,-3393.3068 2712.9418,-3305.4188 2791.6838,-3097 2878.7374,-2866.582 2981.0044,-2854.1332 3127.3396,-2656 3181.2603,-2582.993 3180.9548,-2426.9886 3246.2772,-2490"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge468" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2467.4641,-5397C2529.6404,-5276.9842 2471.4024,-5191.1073 2583.7793,-5116 2647.3002,-5073.5457 2701.3774,-5062.2591 2755.6838,-5116 2789.6362,-5149.5988 2790.3789,-8507.2513 2791.6838,-8555 2811.5169,-9280.7091 2861.019,-10171.2886 2869.4158,-10319.604"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9259,-10319.8828 2869.9871,-10329.6683 2872.9146,-10319.486 2865.9259,-10319.8828"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2282.5756,-5995.8455C2299.03,-5973.161 2335.4301,-5919.433 2351.1489,-5868 2377.8161,-5780.7437 2343.3587,-5539.045 2387.1489,-5459 2408.7916,-5419.4389 2446.6115,-5436.9832 2467.4641,-5397"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge505" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2286.8414,-6018.2093C2305.1249,-6035.397 2338.2222,-6070.2592 2351.1489,-6108 2386.641,-6211.6226 2374.8446,-9942.161 2387.1489,-10051 2402.2213,-10184.3237 2445.1393,-10340.3878 2461.2511,-10396.0104"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2457.9354,-10397.1423 2464.0998,-10405.7591 2464.6544,-10395.1788 2457.9354,-10397.1423"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge678" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3056.4631,-3117C3084.9796,-3134.1137 3107.0952,-3114.6138 3127.3396,-3141 3185.6076,-3216.9453 3238.89,-4758.4894 3245.573,-4958.6471"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.079,-4958.8886 3245.9093,-4968.7668 3249.0752,-4958.6561 3242.079,-4958.8886"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2282.8347,-5995.9205C2299.7549,-5973.3709 2336.951,-5919.8734 2351.1489,-5868 2387.6833,-5734.5184 2339.3332,-4752.8683 2387.1489,-4623 2426.5402,-4516.0127 2503.4609,-4528.042 2547.7793,-4423 2598.9525,-4301.7108 2546.3794,-4255.2182 2583.7793,-4129 2633.2425,-3962.0703 2711.6962,-3945.4554 2755.6838,-3777 2773.5665,-3708.5165 2742.4892,-3191.8888 2791.6838,-3141 2832.7474,-3098.5223 3005.8045,-3086.598 3056.4631,-3117"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge721" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-5397C2484.6016,-5363.9204 2522.6738,-5400.5258 2547.7793,-5373 2602.4635,-5313.044 2528.8758,-5253.7553 2583.7793,-5194 2586.8794,-5190.6259 2590.4056,-5187.6974 2594.2186,-5185.1566"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2595.9996,-5188.1703 2602.9699,-5180.1912 2592.5451,-5182.082 2595.9996,-5188.1703"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge846" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2286.1741,-6018.0592C2303.9153,-6035.3191 2336.6922,-6070.582 2351.1489,-6108 2417.8711,-6280.696 2363.9777,-6339.3186 2387.1489,-6523 2409.8233,-6702.7426 2450.2614,-6917.9138 2463.2935,-6985.5668"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.9358,-6986.6384 2465.2714,-6995.7917 2466.8084,-6985.3089 2459.9358,-6986.6384"/>
</g>
<!-- sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1327.3863,-16722.1931C1338.4138,-16718.4262 1348.9517,-16712.6918 1356.6204,-16704 1421.5898,-16630.3629 1357.4379,-16577.6823 1392.6204,-16486 1450.0861,-16336.2497 1481.4396,-16302.663 1587.1179,-16182 1807.2087,-15930.7013 2018.6996,-15999.0783 2161.3169,-15697 2228.1371,-15555.468 2160.5167,-13032.1249 2197.3169,-12880 2233.3877,-12730.8901 2314.9776,-12720.0856 2351.1489,-12571 2417.9078,-12295.8434 2361.808,-10305.0031 2387.1489,-10023 2403.2982,-9843.2855 2448.0538,-9629.4763 2462.7334,-9562.2833"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.2369,-9562.6473 2464.9677,-9552.1288 2459.4005,-9561.143 2466.2369,-9562.6473"/>
</g>
<!-- sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge518" class="edge">
<title>sourcefile~datasurfacelists.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1281.865,-16740.0604C1301.5173,-16762.786 1348.6007,-16815.9597 1392.6204,-16856 1473.7783,-16929.8213 1495.0905,-16948.2743 1587.1179,-17008 1655.5027,-17052.3816 1705.4616,-17025.1625 1749.1377,-17094 1793.8344,-17164.4461 1724.7466,-17786.4382 1785.1377,-17844 1906.1603,-17959.3528 2017.5498,-17929.3449 2161.3169,-17844 2190.0489,-17826.9437 2177.6467,-17805.0097 2197.3169,-17778 2255.7683,-17697.7388 2288.8624,-17693.3228 2351.1489,-17616 2508.551,-17420.6004 2779.0414,-16824.4622 2985.5867,-16682 2997.8412,-16673.5476 3236.045,-16630.8129 3246.2772,-16620"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3246.2772,-16620C3274.2108,-16583.4245 3308.0763,-16598.8805 3329.2148,-16558 3354.9431,-16508.2433 3430.1708,-12691.8352 3436.461,-12370.4985"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3439.9661,-12370.2669 3436.6624,-12360.2004 3432.9675,-12370.13 3439.9661,-12370.2669"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge862" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2280.0461,-4284.9863C2295.1799,-4256.9345 2338.0533,-4181.3186 2387.1489,-4129 2508.3898,-3999.8 2614.0098,-3870.6023 2755.6838,-3977 3002.8797,-4162.645 2899.259,-4339.9804 2949.5867,-4645 3030.9856,-5138.3327 3053.6906,-6813.7818 3056.2157,-7021.7563"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.7183,-7022.003 3056.3376,-7031.9605 3059.7178,-7021.9194 3052.7183,-7022.003"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.1668,-4307.1153C2297.2881,-4333.6807 2336.9944,-4403.4579 2351.1489,-4468 2389.1747,-4641.3906 2382.356,-7485.5534 2387.1489,-7663 2407.8021,-8427.6403 2457.9653,-9366.4422 2466.2857,-9519.4655"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.8103,-9520.0137 2466.8495,-9529.8083 2469.7999,-9519.6326 2462.8103,-9520.0137"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge521" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2278.3117,-4284.8352C2289.9079,-4253.0428 2323.9829,-4159.2739 2351.1489,-4081 2367.6002,-4033.5987 2357.5527,-4014.5166 2387.1489,-3974 2413.275,-3938.234 2448.0539,-3954.8124 2467.4641,-3915"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2467.4641,-3915C2547.4775,-3750.8836 2517.639,-3691.1817 2583.7793,-3521 2646.8482,-3358.7211 2705.2049,-3335.6254 2755.6838,-3169 2790.4009,-3054.4029 2735.9376,-3007.9723 2791.6838,-2902 2855.1565,-2781.34 3158.0417,-2386.0668 3246.2772,-2490"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2286.1652,-4307.0627C2303.8947,-4324.3271 2336.6565,-4359.5958 2351.1489,-4397 2416.5963,-4565.9167 2326.5549,-4632.2822 2387.1489,-4803 2429.8352,-4923.2644 2510.0214,-4919.0984 2547.7793,-5041 2589.7778,-5176.5926 2573.8991,-10009.3963 2583.7793,-10151 2601.0408,-10398.3931 2651.7549,-10695.7266 2665.9821,-10776.1175"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.5416,-10776.7616 2667.7402,-10785.9934 2669.4333,-10775.5347 2662.5416,-10776.7616"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2280.4457,-4284.8213C2295.2486,-4259.3274 2335.2719,-4196.7955 2387.1489,-4167 2529.9354,-4084.9908 2638.602,-4013.2186 2755.6838,-4129 2819.3461,-4191.9551 2743.6184,-7276.4623 2791.6838,-7352 2833.4958,-7417.71 2907.4937,-7362.4697 2949.5867,-7428 2976.9749,-7470.638 2983.9532,-9201.3498 2985.5867,-9252 3006.2004,-9891.1825 3047.8204,-10674.8411 3055.2988,-10813.5289"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.8127,-10813.8822 3055.8474,-10823.6787 3058.8025,-10813.5044 3051.8127,-10813.8822"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge472" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2669.7316,-4599C2699.1652,-4625.5849 2731.56,-4591.5177 2755.6838,-4623 2788.9014,-4666.3499 2790.2277,-8500.406 2791.6838,-8555 2811.0407,-9280.722 2860.9368,-10171.2909 2869.4051,-10319.6042"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9154,-10319.8849 2869.9813,-10329.6685 2872.9039,-10319.4848 2865.9154,-10319.8849"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2326.2012,-4307.0108C2335.1348,-4310.4849 2343.8715,-4315.0384 2351.1489,-4321 2376.3951,-4341.6814 2365.8127,-4360.3048 2387.1489,-4385 2459.3631,-4468.5829 2495.2795,-4470.9033 2583.7793,-4537 2621.518,-4565.1854 2634.7767,-4567.4282 2669.7316,-4599"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge498" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2281.1875,-4307.1107C2297.3537,-4333.6664 2337.1499,-4403.424 2351.1489,-4468 2416.8628,-4771.1321 2352.7188,-9742.7437 2387.1489,-10051 2402.0425,-10184.3438 2445.0698,-10340.3956 2461.2308,-10396.0126"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2457.9166,-10397.1489 2464.0885,-10405.7604 2464.6339,-10395.1796 2457.9166,-10397.1489"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-4637C2516.9426,-4712.0552 2628.5821,-4557.0742 2669.7316,-4637"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2331.0965,-4307.0705C2338.5838,-4310.5273 2345.5784,-4315.0593 2351.1489,-4321 2395.3892,-4368.1795 2365.5725,-4401.0281 2387.1489,-4462 2415.6979,-4542.6754 2420.3626,-4565.5506 2467.4641,-4637"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2332.9619,-4307.0559C2390.6547,-4319.7116 2479.6859,-4344.1508 2547.7793,-4385 2657.7286,-4450.9585 2704.7643,-4467.3286 2755.6838,-4585 2788.7259,-4661.3579 2784.234,-7497.1337 2791.6838,-7580 2829.4197,-7999.747 2912.8153,-8095.1674 2949.5867,-8515 3043.6078,-9588.4757 2902.6817,-12289.6087 2985.5867,-13364 2999.3711,-13542.6369 3039.176,-13755.7786 3052.2483,-13822.7765"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3048.8754,-13823.7647 3054.2384,-13832.902 3055.744,-13822.4147 3048.8754,-13823.7647"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge682" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-3915C2582.2071,-3694.1965 2676.3731,-3670.86 2755.6838,-3435 2802.9891,-3294.32 2719.6197,-3232.7513 2791.6838,-3103 2860.2934,-2979.4688 2962.1634,-2821.7632 3056.4631,-2927"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge725" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-4637C2492.2837,-4674.6494 2526.2766,-4659.3626 2547.7793,-4699 2595.0875,-4786.2063 2521.0694,-5067.1204 2583.7793,-5144 2586.4115,-5147.227 2589.4345,-5150.0524 2592.7375,-5152.5248"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.1256,-5155.6446 2601.4618,-5157.9714 2594.8327,-5149.7067 2591.1256,-5155.6446"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge653" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M2274.8192,-14593.7542C2280.7827,-14478.869 2330.6497,-13506.2758 2351.1489,-12718 2388.0892,-11297.5013 2348.7869,-10941.461 2387.1489,-9521 2407.7994,-8756.3596 2457.9648,-7817.5578 2466.2856,-7664.5345"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2469.7999,-7664.3674 2466.8495,-7654.1917 2462.8102,-7663.9863 2469.7999,-7664.3674"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2275.314,-14593.8802C2283.293,-14511.239 2333.2391,-13984.0247 2351.1489,-13554 2383.8023,-12769.9722 2318.4546,-10804.6949 2387.1489,-10023 2402.9448,-9843.2541 2447.9343,-9629.4657 2462.703,-9562.2806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2466.2065,-9562.6475 2464.9513,-9552.1273 2459.372,-9561.1341 2466.2065,-9562.6475"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge528" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2308.5961,-14616.1402C2363.8474,-14635.3423 2473.7246,-14678.977 2547.7793,-14744 2670.7801,-14851.9997 2682.058,-14901.807 2755.6838,-15048 2777.6849,-15091.6858 2751.8397,-15123.6285 2791.6838,-15152 3025.7052,-15318.6379 3296.7338,-14912.0515 3329.2148,-14848 3388.5757,-14730.9422 3431.85,-12605.7303 3436.4712,-12370.1619"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3439.9712,-12370.1921 3436.667,-12360.1256 3432.9725,-12370.0554 3439.9712,-12370.1921"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge456" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-14530C2540.0785,-14437.5591 2528.0909,-14393.8902 2547.7793,-14278 2595.5881,-13996.5867 2572.1556,-13279.2087 2583.7793,-12994 2610.255,-12344.3721 2659.6202,-11547.9088 2668.384,-11408.3551"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2671.8904,-11408.3609 2669.0254,-11398.1608 2664.9043,-11407.9213 2671.8904,-11408.3609"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2316.2966,-14593.9308C2327.8849,-14590.1899 2340.257,-14585.531 2351.1489,-14580 2368.7465,-14571.0638 2369.4459,-14562.7254 2387.1489,-14554 2420.5658,-14537.5297 2444.4505,-14559.2972 2467.4641,-14530"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge688" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-14530C2499.6285,-14489.0536 2531.8997,-14539.5661 2583.7793,-14544 2793.3676,-14561.9126 2888.9723,-14695.2593 3056.4631,-14568"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge609" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M2075.5577,-5752.0443C2080.8722,-5897.1209 2136.9853,-7442.9092 2161.3169,-8692 2165.3064,-8896.8042 2153.5866,-12178.8791 2197.3169,-12379 2210.0454,-12437.2487 2243.6411,-12499.7464 2261.9361,-12530.9131"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2259.1616,-12533.0937 2267.2926,-12539.8862 2265.1721,-12529.5057 2259.1616,-12533.0937"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge626" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2112.8626,-5745.4507C2129.1206,-5748.912 2147.5252,-5755.0645 2161.3169,-5766 2186.8894,-5786.2764 2171.9491,-5809.468 2197.3169,-5830 2225.1524,-5852.5293 2251.956,-5825.9621 2274.2329,-5854"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2274.2329,-5854C2296.5099,-5882.0379 2320.9954,-5858.6829 2351.1489,-5878 2396.775,-5907.2293 2435.6558,-5958.9806 2454.7818,-5987.237"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2452.0499,-5989.4505 2460.4918,-5995.8524 2457.8847,-5985.5833 2452.0499,-5989.4505"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge657" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M2088.7514,-5752.0633C2108.5636,-5769.0648 2144.7965,-5803.6922 2161.3169,-5842 2220.0915,-5978.2872 2156.0465,-6031.4328 2197.3169,-6174 2240.5289,-6323.2746 2311.03,-6337.8646 2351.1489,-6488 2413.1305,-6719.9508 2363.617,-6788.0667 2387.1489,-7027 2410.1707,-7260.7537 2452.1501,-7542.6146 2464.169,-7621.5487"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2460.7485,-7622.3359 2465.719,-7631.6924 2467.6682,-7621.2784 2460.7485,-7622.3359"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge801" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M2274.2329,-4067C2345.5572,-3865.2568 2599.4012,-3918.8385 2755.6838,-4065 2843.2476,-4146.893 3039.6168,-8202.9315 3055.4455,-8532.7329"/>
<polygon fill="#003fff" stroke="#003fff" points="3051.957,-8533.0594 3055.9319,-8542.8803 3058.949,-8532.7242 3051.957,-8533.0594"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge831" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2274.2329,-5854C2296.5099,-5882.0379 2327.3704,-5851.2237 2351.1489,-5878 2371.9422,-5901.4147 2447.3019,-6374.6387 2464.1204,-6481.6284"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2460.7125,-6482.4888 2465.7202,-6491.8255 2467.6279,-6481.4038 2460.7125,-6482.4888"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge877" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2274.2329,-4067C2351.1015,-3851.2668 2758.3098,-3497.1451 2791.6838,-3483 2856.2988,-3455.6139 2899.2235,-3434.1262 2949.5867,-3483 3017.3227,-3548.7331 3053.0919,-6729.4002 3056.236,-7021.5583"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.7377,-7021.7448 3056.3445,-7031.7068 3059.7373,-7021.6699 3052.7377,-7021.7448"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2089.2662,-5752.269C2109.3785,-5769.273 2145.5869,-5803.6099 2161.3169,-5842 2203.8056,-5945.6966 2178.4085,-6234.543 2197.3169,-6345 2240.9397,-6599.8305 2311.013,-6650.5971 2351.1489,-6906 2356.5338,-6940.2665 2456.008,-9272.1538 2466.5601,-9519.7774"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2463.072,-9520.1342 2466.9946,-9529.9761 2470.0657,-9519.8362 2463.072,-9520.1342"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge534" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2075.9355,-5729.6333C2085.9477,-5584.4654 2188.6841,-4096.8748 2197.3169,-4053 2249.6805,-3786.869 2277.2018,-3720.9502 2387.1489,-3473 2521.1391,-3170.8284 2633.5309,-3134.1477 2755.6838,-2827 2780.7007,-2764.0963 2757.0184,-2737.1465 2791.6838,-2679 2851.1294,-2579.2883 2878.3908,-2548.5563 2985.5867,-2504 3092.7293,-2459.4659 3173.8886,-2399.3208 3246.2772,-2490"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2099.1323,-5752.2079C2118.9614,-5762.7502 2146.2284,-5780.4344 2161.3169,-5804 2204.8389,-5871.9736 2143.6095,-5921.7498 2197.3169,-5982 2203.6965,-5989.1568 2212.1449,-5994.2744 2221.1045,-5997.9314"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2219.9664,-6001.2412 2230.5613,-6001.2379 2222.2768,-5994.6334 2219.9664,-6001.2412"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge485" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2077.0695,-5729.8033C2087.5928,-5667.8789 2138.675,-5360.971 2161.3169,-5108 2165.4414,-5061.9187 2163.9026,-4307.9997 2197.3169,-4276 2402.1619,-4079.8269 2644.7185,-4323.9788 2755.6838,-4585 2798.8301,-4686.4918 2788.7482,-8444.7568 2791.6838,-8555 2811.0089,-9280.7229 2860.9314,-10171.291 2869.4044,-10319.6043"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9147,-10319.8851 2869.981,-10329.6685 2872.9032,-10319.4847 2865.9147,-10319.8851"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge499" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2082.8187,-5752.3595C2100.661,-5779.5269 2144.7057,-5850.9909 2161.3169,-5918 2219.7372,-6153.6654 2184.6022,-6767.5346 2197.3169,-7010 2247.2062,-7961.3715 2297.982,-8196.806 2351.1489,-9148 2373.5642,-9549.0262 2335.9051,-9652.6302 2387.1489,-10051 2404.2671,-10184.0765 2445.9344,-10340.2917 2461.4829,-10395.9823"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2458.1516,-10397.0653 2464.2293,-10405.7435 2464.8899,-10395.1693 2458.1516,-10397.0653"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M2077.5109,-5729.7435C2088.9665,-5674.5872 2139.1432,-5427.2284 2161.3169,-5222 2169.79,-5143.5771 2149.3523,-4575.6206 2197.3169,-4513 2201.3511,-4507.7331 2206.5164,-4503.5587 2212.2578,-4500.2531"/>
<polygon fill="#7fff00" stroke="#7fff00" points="2214.1684,-4503.2187 2221.6744,-4495.7413 2211.1437,-4496.9059 2214.1684,-4503.2187"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2082.9412,-5752.33C2101.0481,-5779.4337 2145.6233,-5850.7701 2161.3169,-5918 2181.5739,-6004.7796 2144.7394,-12262.0511 2197.3169,-12334 2200.9789,-12339.0112 2205.6694,-12343.0372 2210.9242,-12346.2688"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.7176,-12349.5816 2220.2183,-12350.9911 2212.8885,-12343.3409 2209.7176,-12349.5816"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge460" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2113.0573,-5746.1375C2209.3852,-5761.5534 2462.0033,-5817.3595 2547.7793,-5987 2578.0502,-6046.8673 2578.5145,-10750.1217 2583.7793,-10817 2600.7745,-11032.8905 2650.451,-11291.069 2665.4161,-11365.7919"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.0302,-11366.7074 2667.4372,-11375.8186 2668.8921,-11365.3241 2662.0302,-11366.7074"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge694" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3056.4631,-2927C3118.9282,-2983.6491 3108.6853,-3020.7624 3127.3396,-3103 3213.258,-3481.7717 3242.2023,-4777.5023 3245.866,-4958.8536"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.3689,-4959.0355 3246.0672,-4968.9638 3249.3675,-4958.8962 3242.3689,-4959.0355"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-4067C2330.0875,-3907.5408 2313.2945,-3855.9621 2387.1489,-3704 2513.3586,-3444.3124 2651.647,-3438.3378 2755.6838,-3169 2777.2564,-3113.1514 2746.6094,-2941.4048 2791.6838,-2902 2880.6752,-2824.2022 2968.9042,-2847.5935 3056.4631,-2927"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2076.7659,-5729.6197C2086.4446,-5660.9358 2137.1778,-5294.5968 2161.3169,-4994 2175.4196,-4818.3836 2148.3486,-4371.2398 2197.3169,-4202 2216.5102,-4135.6658 2250.4921,-4131.8458 2274.2329,-4067"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge738" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2083.6167,-5729.7612C2118.3721,-5683.9671 2254.5425,-5507.9499 2387.1489,-5383 2452.7886,-5321.1503 2489.0195,-5327.4195 2547.7793,-5259 2569.295,-5233.9472 2557.9774,-5214.6114 2583.7793,-5194 2588.5242,-5190.2096 2593.8234,-5186.9939 2599.397,-5184.2657"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2601.197,-5187.3006 2608.9866,-5180.1192 2598.4188,-5180.8755 2601.197,-5187.3006"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge842" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-5854C2296.5099,-5882.0379 2329.1351,-5849.7551 2351.1489,-5878 2395.2734,-5934.614 2379.2622,-6451.6564 2387.1489,-6523 2407.055,-6703.0702 2449.3248,-6918.0247 2463.0559,-6985.5949"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.7113,-6986.7101 2465.1425,-6995.8069 2466.5696,-6985.3086 2459.7113,-6986.7101"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge880" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1275.8029,-5914.9758C1288.1075,-5874.7634 1330.9467,-5732.0435 1356.6204,-5612 1377.7086,-5513.3968 1361.656,-5483.961 1392.6204,-5388 1440.8698,-5238.4711 1500.033,-5220.5841 1551.1179,-5072 1577.6436,-4994.8483 1569.394,-4971.6358 1587.1179,-4892 1627.8293,-4709.0782 1851.0621,-3380.8644 1988.9868,-3254 2239.7825,-3023.3159 2433.8197,-3143.1199 2755.6838,-3255 2847.8571,-3287.0394 2898.1038,-3275.1028 2949.5867,-3358 3001.1567,-3441.0375 3051.6548,-6723.076 3056.1402,-7021.3541"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3052.6457,-7021.7501 3056.2953,-7031.6965 3059.6449,-7021.6451 3052.6457,-7021.7501"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~radiantsystemlowtemp.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1274.8254,-5937.0242C1286.3591,-5986.6186 1340.6925,-6190.3495 1471.8691,-6276"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1471.8691,-6276C1502.6836,-6296.12 1518.4338,-6268.9142 1551.1179,-6252 1569.12,-6242.6839 1567.9453,-6230.5783 1587.1179,-6224 1655.2291,-6200.6305 1692.2316,-6179.8756 1749.1377,-6224 1799.9095,-6263.3679 1758.1822,-6305.6818 1785.1377,-6364 1839.445,-6481.4937 1912.4122,-6479.0865 1952.9868,-6602 2006.4654,-6764.0038 1957.7947,-7969.2733 1988.9868,-8137 2039.1423,-8406.6966 2100.9051,-8461.1798 2197.3169,-8718 2263.0945,-8893.2173 2292.4927,-8932.272 2351.1489,-9110 2402.3622,-9265.176 2448.1153,-9457.0995 2462.6636,-9519.9825"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2459.2872,-9520.9176 2464.941,-9529.8778 2466.1089,-9519.3475 2459.2872,-9520.9176"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1295.9896,-5914.8882C1349.2989,-5888.6029 1479.9599,-5817.4208 1551.1179,-5720 1580.4644,-5679.8224 1546.6734,-5642.9775 1587.1179,-5614 1719.3008,-5519.2942 1831.9663,-5505.3928 1952.9868,-5614 2008.2174,-5663.5655 1940.9764,-5889.4123 1988.9868,-5946 2014.7053,-5976.3132 2043.0021,-5946.6179 2075.1519,-5970"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-5970C2086.8853,-5978.4125 2165.5376,-5991.2642 2220.3934,-5999.3938"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2219.9352,-6002.864 2230.3377,-6000.8547 2220.9527,-5995.9383 2219.9352,-6002.864"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1273.4785,-5937.1632C1278.6944,-5986.7806 1304.8106,-6190.8998 1392.6204,-6328 1506.5,-6505.804 1630.9618,-6467.022 1749.1377,-6642 1776.0441,-6681.8391 1764.6071,-6700.5304 1785.1377,-6744 1806.2448,-6788.6902 1837.8056,-6837.3645 1855.6008,-6863.6036"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1852.7458,-6865.6292 1861.2814,-6871.9057 1858.5229,-6861.6762 1852.7458,-6865.6292"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1273.2976,-5937.2329C1284.2437,-6074.7601 1392.0359,-7428.9028 1392.6204,-7430 1403.3161,-7450.0792 1423.4557,-7465.9595 1440.7549,-7476.7537"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1439.0914,-7479.8363 1449.4773,-7481.93 1442.6639,-7473.8166 1439.0914,-7479.8363"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge487" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1278.0461,-5914.883C1294.2436,-5883.3175 1342.9182,-5790.8482 1392.6204,-5720 1455.7757,-5629.9748 1485.9047,-5618.5458 1551.1179,-5530 1647.182,-5399.5652 1673.6968,-5367.3535 1749.1377,-5224 1971.0989,-4802.2274 2022.5535,-4689.9645 2161.3169,-4234 2185.1967,-4155.533 2133.9149,-4105.0336 2197.3169,-4053 2250.1671,-4009.6262 2292.3578,-4018.0997 2351.1489,-4053 2379.8809,-4070.0563 2365.4612,-4093.5817 2387.1489,-4119 2416.4184,-4153.3043 2424.2131,-4168.2391 2467.4641,-4181"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2467.4641,-4181C2604.6827,-4219.8225 2683.1797,-4199.2023 2755.6838,-4322 2785.5762,-4372.6276 2790.1353,-8496.2266 2791.6838,-8555 2810.8044,-9280.7283 2860.8961,-10171.2919 2869.3998,-10319.6044"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2865.9102,-10319.886 2869.9785,-10329.6686 2872.8986,-10319.4841 2865.9102,-10319.886"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1471.8691,-6276C1501.8913,-6295.4411 1519.5185,-6273.244 1551.1179,-6290 1677.3651,-6356.9442 1909.8215,-6655.7772 1952.9868,-6792 1996.8248,-6930.3455 1930.4694,-9271.1958 1988.9868,-9404 2031.3734,-9500.1955 2118.9677,-9469.788 2161.3169,-9566 2192.2954,-9636.3792 2151.7184,-12272.0833 2197.3169,-12334 2200.9974,-12338.9976 2205.7001,-12343.0147 2210.9622,-12346.2409"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.7626,-12349.5569 2220.2645,-12350.9572 2212.9281,-12343.3134 2209.7626,-12349.5569"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1871.1972,-6871.7214C1881.5921,-6816.4616 1927.4404,-6568.6926 1952.9868,-6364 1975.531,-6183.3635 1946.6736,-6133.0519 1988.9868,-5956 2006.7579,-5881.6402 2045.6585,-5799.1439 2064.5019,-5761.6111"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2067.8428,-5762.7622 2069.2506,-5752.2613 2061.6016,-5759.5923 2067.8428,-5762.7622"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge647" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1521.1246,-7499.1358C1532.524,-7502.8587 1543.5242,-7508.7416 1551.1179,-7518 1597.8998,-7575.0371 1563.9308,-7777.9705 1587.1179,-7848 1609.4727,-7915.5156 1617.6229,-7935.9265 1668.1278,-7986"/>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1668.1278,-7986C1690.6712,-8008.3508 1930.0606,-7985.9579 1952.9868,-7964 2049.333,-7871.7235 1906.0792,-7770.5172 1988.9868,-7666 2091.1968,-7537.1494 2190.4258,-7555.1083 2351.1489,-7590 2383.5509,-7597.0342 2417.7524,-7613.9116 2440.6153,-7626.7461"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2438.9707,-7629.8378 2449.3852,-7631.7845 2442.4578,-7623.7681 2438.9707,-7629.8378"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge800" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1668.1278,-7720C1724.2622,-7736.7967 1885.5691,-7697.8187 1952.9868,-7618 2005.6304,-7555.673 1930.8104,-7495.1971 1988.9868,-7438 2027.7373,-7399.9019 2784.5107,-7277.0197 2870.6353,-7338"/>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M2870.6353,-7338C2899.4183,-7359.0125 2925.5048,-7325.7311 2949.5867,-7352 3032.7159,-7442.6787 3053.2714,-8378.7523 3056.098,-8532.643"/>
<polygon fill="#003fff" stroke="#003fff" points="3052.5996,-8532.7655 3056.2777,-8542.7014 3059.5985,-8532.6404 3052.5996,-8532.7655"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge821" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1521.4146,-7495.9924C1620.5907,-7498.9839 1843.3706,-7490.0624 1952.9868,-7361 2002.3142,-7302.9218 1958.739,-7089.9381 1988.9868,-7020 2012.2753,-6966.1529 2041.4053,-6967.9899 2075.1519,-6920"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2075.1519,-6920C2139.6327,-6829.2544 2202.8955,-6853.4606 2274.2329,-6768"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2274.2329,-6768C2347.3017,-6680.4652 2424.2954,-6567.7212 2454.3616,-6522.7716"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2457.4128,-6524.5045 2460.0468,-6514.2423 2451.5881,-6520.622 2457.4128,-6524.5045"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge866" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1668.1278,-7720C1791.6549,-7757.5846 1915.4614,-7575.1626 1952.9868,-7508 1993.6307,-7435.2561 1931.9858,-7384.7823 1988.9868,-7324 2059.7133,-7248.5816 2769.797,-7100.6261 2991.019,-7056.0272"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="2991.7559,-7059.4491 3000.8686,-7054.0447 2990.3746,-7052.5868 2991.7559,-7059.4491"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1521.2087,-7502.3851C1531.8268,-7506.0224 1542.45,-7511.0524 1551.1179,-7518 1632.0742,-7582.8891 1568.7301,-7690.2579 1668.1278,-7720"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1479.7292,-7481.7844C1496.9695,-7457.7907 1540.3185,-7400.6834 1587.1179,-7364 1651.2802,-7313.7069 1702.9491,-7345.1775 1749.1377,-7278 1823.7215,-7169.524 1732.9558,-7104.8587 1785.1377,-6984 1799.5139,-6950.7031 1828.4309,-6919.7868 1848.2655,-6901.1503"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1850.874,-6903.5074 1855.8848,-6894.1723 1846.1463,-6898.3451 1850.874,-6903.5074"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1521.0847,-7498.7058C1532.6279,-7502.4233 1543.7076,-7508.4111 1551.1179,-7518 1647.7208,-7643.0028 1502.301,-8094.7187 1587.1179,-8228 1630.8869,-8296.7785 1679.9063,-8270.951 1749.1377,-8314 2127.0641,-8548.9997 2356.7955,-8516.0318 2547.7793,-8918 2606.5974,-9041.7959 2572.7263,-10014.388 2583.7793,-10151 2603.7788,-10398.1868 2652.5423,-10695.6673 2666.1519,-10776.1047"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.7053,-10776.7147 2667.8323,-10785.9864 2669.6063,-10775.5412 2662.7053,-10776.7147"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1521.1826,-7499.57C1532.4415,-7503.294 1543.3603,-7509.0687 1551.1179,-7518 1614.9387,-7591.4772 1512.8576,-7671.0921 1587.1179,-7734 1712.5855,-7840.287 1834.6984,-7793.2229 1952.9868,-7679 1992.1243,-7641.2077 1945.2233,-7594.3226 1988.9868,-7562 2126.1278,-7460.7112 2625.5415,-7479.8635 2755.6838,-7590 2826.243,-7649.7126 2936.806,-8307.4531 2949.5867,-8399 3002.052,-8774.804 2969.1005,-8872.9097 2985.5867,-9252 3013.3721,-9890.9109 3049.1391,-10674.7912 3055.4807,-10813.522"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.9917,-10813.8454 3055.9449,-10823.675 3058.9844,-10813.5256 3051.9917,-10813.8454"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.1066,-7504.3507C1498.8464,-7526.9626 1537.1607,-7579.9484 1551.1179,-7632 1595.8668,-7798.8853 1563.2388,-13680.8774 1587.1179,-13852 1601.6386,-13956.0579 1643.0478,-14075.473 1660.3657,-14122.4751"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1657.0901,-14123.7086 1663.8595,-14131.8589 1663.6502,-14121.2661 1657.0901,-14123.7086"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1668.1278,-7986C1694.3257,-8011.4697 1717.1526,-7982.3368 1749.1377,-8000 1770.0749,-8011.5622 1763.289,-8030.2694 1785.1377,-8040 1853.2844,-8070.35 1894.2611,-8086.0043 1952.9868,-8040 2005.5981,-7998.7856 1936.3756,-7935.2144 1988.9868,-7894 2049.2803,-7846.7676 2095.5412,-7854.7603 2161.3169,-7894 2400.0966,-8036.4484 2684.7844,-8726.1495 2755.6838,-8995 2805.0219,-9182.0896 2786.0142,-10542.5973 2791.6838,-10736 2816.6315,-11587.0093 2862.5282,-12633.3021 2869.686,-12794.6839"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.1931,-12794.9245 2870.1336,-12804.7593 2873.1862,-12794.6138 2866.1931,-12794.9245"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1484.7743,-7504.1525C1503.5029,-7521.2677 1537.4662,-7556.0385 1551.1179,-7594 1604.9787,-7743.771 1555.2707,-8870.0574 1587.1179,-9026 1634.8608,-9259.7767 1670.5314,-9315.7243 1785.1377,-9525 1846.4404,-9636.9412 1901.8891,-9641.0475 1952.9868,-9758 1985.3014,-9831.9617 1939.9008,-9871.9287 1988.9868,-9936 2041.0442,-10003.9498 2115.7217,-9949.5554 2161.3169,-10022 2229.7426,-10130.7193 2121.0084,-12230.6608 2197.3169,-12334 2201.0038,-12338.9929 2205.7107,-12343.0069 2210.9754,-12346.2312"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2209.7782,-12349.5482 2220.2805,-12350.9454 2212.9418,-12343.3039 2209.7782,-12349.5482"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge452" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1494.8118,-7504.1849C1513.604,-7514.7128 1538.9981,-7532.3888 1551.1179,-7556 1625.1871,-7700.2975 1549.5732,-8127.2077 1587.1179,-8285 1637.3206,-8495.9912 1663.9669,-8551.1244 1785.1377,-8731 2057.7946,-9135.7537 2358.7344,-9071.0785 2547.7793,-9521 2603.5818,-9653.8084 2571.0157,-10673.511 2583.7793,-10817 2602.9668,-11032.7067 2651.1294,-11291.0121 2665.5735,-11365.7787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.1797,-11366.6626 2667.5229,-11375.8114 2669.0512,-11365.3274 2662.1797,-11366.6626"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge588" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1484.7834,-7504.1492C1503.5235,-7521.2603 1537.5014,-7556.0259 1551.1179,-7594 1609.1141,-7755.7407 1558.5297,-8970.5706 1587.1179,-9140 1626.2655,-9372.0102 1696.5579,-9414.6604 1749.1377,-9644 1774.8136,-9755.9917 1757.0218,-9788.5959 1785.1377,-9900 1864.1301,-10212.9927 2025.1375,-10573.9247 2065.7079,-10662.5697"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2062.5927,-10664.173 2069.9479,-10671.7987 2068.9535,-10661.2506 2062.5927,-10664.173"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge855" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2870.6353,-10380C2876.1226,-10344.3283 2926.9723,-10389.1278 2949.5867,-10361 2981.3922,-10321.4403 2983.8814,-8584.7312 2985.5867,-8534 3005.7624,-7933.7784 3047.4922,-7198.4076 3055.2184,-7064.4518"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.7228,-7064.4754 3055.8059,-7054.29 3051.7344,-7064.0713 3058.7228,-7064.4754"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2679.1273,-10785.7891C2697.2756,-10763.4613 2737.005,-10711.1691 2755.6838,-10660 2795.0832,-10552.0691 2716.9907,-10491.3058 2791.6838,-10404 2815.5257,-10376.1322 2865.0592,-10416.2486 2870.6353,-10380"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge512" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3056.4631,-10874C3141.1928,-10878.1012 3188.4015,-10791.9812 3246.2772,-10854"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2716.1388,-10808.0346C2803.6947,-10828.5539 2990.3922,-10870.802 3056.4631,-10874"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2695.3189,-10808.1281C2715.549,-10818.4181 2742.5039,-10835.7877 2755.6838,-10860 2853.0026,-11038.7802 2868.8282,-12593.1419 2870.4748,-12794.5318"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.9762,-12794.7387 2870.5552,-12804.7107 2873.976,-12794.6834 2866.9762,-12794.7387"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge675" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2683.1877,-10785.7297C2702.474,-10768.7828 2737.6353,-10734.781 2755.6838,-10698 2791.6237,-10624.7584 2748.9544,-10587.4996 2791.6838,-10518 2838.4186,-10441.9856 2904.4963,-10471.0012 2949.5867,-10394 3209.1515,-9950.7394 3082.4198,-9763.6992 3127.3396,-9252 3161.1217,-8867.1749 3153.0209,-7900.1672 3163.3396,-7514 3191.2674,-6468.8259 3238.773,-5181.5948 3245.4809,-5001.3361"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3248.9882,-5001.2014 3245.8631,-4991.078 3241.9931,-5000.9407 3248.9882,-5001.2014"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge513" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3247.7019,-13832.8259C3263.8444,-13706.2118 3412.1473,-12542.9975 3434.1559,-12370.3734"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3437.6522,-12370.624 3435.4451,-12360.2617 3430.7084,-12369.7387 3437.6522,-12370.624"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge520" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M3105.8546,-10823.9498C3149.4583,-10817.4152 3211.367,-10816.5907 3246.2772,-10854"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge681" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3059.416,-10823.7574C3070.9291,-10779.2956 3112.8812,-10611.2758 3127.3396,-10470 3160.781,-10143.238 3155.9667,-7842.386 3163.3396,-7514 3186.8082,-6468.7163 3238.1297,-5181.579 3245.4113,-5001.3344"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3248.9191,-5001.2105 3245.8264,-4991.0771 3241.9248,-5000.9273 3248.9191,-5001.2105"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge606" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M1870.5419,-8722.3397C1879.6256,-8792.3552 1928.266,-9173.0766 1952.9868,-9485 1965.5908,-9644.0354 1949.0972,-10047.5334 1988.9868,-10202 2032.5402,-10370.654 2120.3357,-10384.7026 2161.3169,-10554 2256.7511,-10948.2482 2108.7489,-11983.1528 2197.3169,-12379 2210.3353,-12437.1846 2243.8081,-12499.7094 2262.0083,-12530.8971"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2259.223,-12533.0621 2267.3355,-12539.8767 2265.2433,-12529.4905 2259.223,-12533.0621"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge645" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1931.7416,-8701.837C1939.9292,-8698.127 1947.3991,-8693.0167 1952.9868,-8686 2031.2224,-8587.7573 1919.5502,-8226.647 1988.9868,-8122 2036.3135,-8050.6745 2099.696,-8095.4139 2161.3169,-8036 2185.3705,-8012.808 2177.6467,-7997.0097 2197.3169,-7970 2255.7683,-7889.7388 2288.1937,-7884.7793 2351.1489,-7808 2392.0313,-7758.1405 2434.2234,-7694.7315 2454.7302,-7662.9959"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2457.9117,-7664.5189 2460.3726,-7654.2139 2452.0225,-7660.7351 2457.9117,-7664.5189"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge820" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M1872.7347,-8699.795C1886.1725,-8658.2593 1932.9257,-8508.9292 1952.9868,-8382 1992.1986,-8133.9028 1928.6575,-8061.824 1988.9868,-7818 2083.5085,-7435.9858 2226.0702,-7383.128 2351.1489,-7010 2412.5965,-6826.6928 2452.6144,-6595.4108 2464.0722,-6524.5844"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2467.5963,-6524.7106 2465.7189,-6514.2835 2460.6841,-6523.6055 2467.5963,-6524.7106"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge865" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M1931.7471,-8700.2484C1939.934,-8696.356 1947.4022,-8691.0965 1952.9868,-8684 2019.9598,-8598.8964 1909.632,-8271.6941 1988.9868,-8198 2106.9324,-8088.468 2191.1283,-8180.6271 2351.1489,-8198 2495.272,-8213.647 2579.1861,-8381.2157 2669.7316,-8268"/>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2669.7316,-8268C2728.0237,-8195.2637 2744.9253,-7518.6361 2791.6838,-7438 2836.4456,-7360.8073 2896.2714,-7385.5529 2949.5867,-7314 3010.2815,-7232.5433 3041.5263,-7112.0848 3052.1709,-7063.9682"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3055.6138,-7064.605 3054.2876,-7054.0935 3048.7693,-7063.1378 3055.6138,-7064.605"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge523" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M1909.8817,-8699.8884C1923.8103,-8695.5693 1939.3137,-8690.1671 1952.9868,-8684 2157.597,-8591.7123 2170.7068,-8485.4572 2387.1489,-8426 2455.99,-8407.0892 2476.8143,-8418.21 2547.7793,-8426 2564.0717,-8427.7885 2567.778,-8430.4505 2583.7793,-8434 2746.3467,-8470.0615 2836.2613,-8392.9919 2949.5867,-8515 3025.3851,-8596.606 2940.8646,-8660.9957 2985.5867,-8763 3082.845,-8984.8317 3244.3127,-8959.1517 3329.2148,-9186 3387.8068,-9342.5506 3432.3038,-12060.252 3436.5488,-12327.8366"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3433.0492,-12327.8922 3436.7068,-12337.8357 3440.0483,-12327.7816 3433.0492,-12327.8922"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1870.3469,-8722.3574C1878.2675,-8792.4784 1921.1706,-9173.7203 1952.9868,-9485 1961.4992,-9568.2826 1935.2202,-9795.8315 1988.9868,-9860 2040.0498,-9920.9417 2112.7527,-9845.049 2161.3169,-9908 2242.5311,-10013.2734 2114.5601,-12196.9349 2197.3169,-12301 2219.2339,-12328.5602 2267.2491,-12285.4871 2274.2329,-12320"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1912.849,-8699.9927C2004.7246,-8679.6738 2219.9505,-8646.9946 2351.1489,-8748 2746.1066,-9052.0653 2676.6683,-9301.8579 2755.6838,-9794 2756.0795,-9796.4642 2859.6195,-12525.619 2869.8275,-12794.7074"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2866.3324,-12794.9045 2870.209,-12804.7646 2873.3274,-12794.6391 2866.3324,-12794.9045"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge451" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1931.8379,-8700.284C1994.1445,-8692.894 2090.3458,-8690.4932 2161.3169,-8730 2453.6432,-8892.7266 2464.6034,-9051.9376 2547.7793,-9376 2587.5966,-9531.1327 2569.8115,-10657.4492 2583.7793,-10817 2602.6655,-11032.7333 2651.0362,-11291.0204 2665.5519,-11365.7806"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.1592,-11366.6688 2667.5112,-11375.8124 2669.0294,-11365.327 2662.1592,-11366.6688"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge531" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2894.3463,-10352.1115C2942.7805,-10375.7004 3054.6277,-10434.8323 3127.3396,-10510 3246.8797,-10633.5774 3276.7455,-10676.268 3329.2148,-10840 3423.7299,-11134.9369 3435.4773,-12167.1419 3436.7414,-12327.8863"/>
<polygon fill="#00ff91" stroke="#00ff91" points="3433.2417,-12327.9579 3436.8152,-12337.9318 3440.2415,-12327.9063 3433.2417,-12327.9579"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2879.3207,-10352.226C2917.6241,-10402.4975 3071.9937,-10613.2934 3127.3396,-10815 3211.8143,-11122.8657 3243.0053,-13568.3452 3246.0296,-13822.6456"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3242.5316,-13822.8443 3246.1492,-13832.8024 3249.5312,-13822.7618 3242.5316,-13822.8443"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge692" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2932.9144,-10329.8233C2939.3598,-10326.3514 2945.1576,-10321.8438 2949.5867,-10316 2986.2509,-10267.6246 2974.9352,-9283.7578 2985.5867,-9224 3003.1682,-9125.3628 3047.068,-9109.7504 3056.4631,-9010"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge537" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~ventilatedslab.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M2506.7078,-10428.0183C2607.7935,-10456.4221 2869.3144,-10530.0581 2870.6353,-10532"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge698" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3056.4631,-9010C3068.7027,-8880.0503 3109.5483,-8854.3066 3127.3396,-8725 3164.0373,-8458.2828 3154.936,-7783.0988 3163.3396,-7514 3195.9747,-6468.9623 3239.4521,-5181.6145 3245.5543,-5001.3383"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3249.0612,-5001.1919 3245.9017,-4991.0791 3242.0652,-5000.9549 3249.0612,-5001.1919"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2522.7965,-10405.9246C2588.6297,-10389.7613 2696.9887,-10353.1766 2755.6838,-10279 3053.4676,-9902.6728 2858.8817,-9686.8641 2985.5867,-9224 3012.0401,-9127.3634 3047.068,-9109.7504 3056.4631,-9010"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2480.5396,-12881.8861C2499.516,-12864.82 2533.931,-12830.1113 2547.7793,-12792 2601.8704,-12643.139 2569.9444,-11524.7785 2583.7793,-11367 2602.6958,-11151.2693 2651.0455,-10892.9804 2665.5541,-10818.2196"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2669.0316,-10818.673 2667.5124,-10808.1877 2662.1612,-10817.3318 2669.0316,-10818.673"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2669.7316,-13312C2864.5208,-13334.6109 2863.1747,-13208.2096 2949.5867,-12836 2974.4165,-12729.0484 2921.3493,-10949.0434 2985.5867,-10860 2987.8577,-10856.8519 2990.5582,-10854.0979 2993.5574,-10851.6889"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6618,-10854.4944 3002.1052,-10846.0841 2991.8234,-10848.6406 2995.6618,-10854.4944"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge470" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2669.7316,-13008C2788.7245,-12890.6951 2735.1436,-12807.8248 2755.6838,-12642 2763.4566,-12579.2494 2753.9243,-10416.7176 2791.6838,-10366 2794.0101,-10362.8754 2796.7283,-10360.1322 2799.7294,-10357.7246"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.8349,-10360.5288 2808.2595,-10352.1041 2797.9834,-10354.6836 2801.8349,-10360.5288"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2475.567,-12904.2058C2504.9084,-12943.541 2607.1639,-13069.68 2669.7316,-13008"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2669.7316,-13312C2716.5197,-13317.4311 2728.9943,-13288.811 2755.6838,-13250 2803.8835,-13179.9096 2853.4544,-12913.8511 2867.0206,-12836.9399"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2870.482,-12837.464 2868.7565,-12827.0106 2863.5866,-12836.2585 2870.482,-12837.464"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2470.4758,-12904.3587C2487.2753,-12967.5637 2569.1761,-13273.6011 2583.7793,-13288 2612.0216,-13315.8472 2630.3338,-13307.4268 2669.7316,-13312"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2469.7365,-12904.2339C2482.5142,-12967.0312 2546.1792,-13274.9627 2583.7793,-13364 2639.9996,-13497.1302 2686.3683,-13513.1941 2755.6838,-13640 2812.7965,-13744.482 2757.2081,-13845.7698 2870.6353,-13882"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2870.6353,-13882C2924.3021,-13898.2506 2988.7934,-13876.0693 3025.9641,-13859.3935"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3027.6493,-13862.47 3035.2472,-13855.0862 3024.703,-13856.1203 3027.6493,-13862.47"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge446" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2480.2405,-12881.7721C2498.8352,-12864.5608 2532.7691,-12829.6688 2547.7793,-12792 2654.326,-12524.6164 2668.0297,-11563.2573 2669.5564,-11408.1865"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2673.0571,-11408.1147 2669.6494,-11398.0829 2666.0574,-11408.0502 2673.0571,-11408.1147"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge723" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2468.0815,-12881.7308C2474.3598,-12766.6071 2526.8406,-11791.9925 2547.7793,-11002 2587.9607,-9486.0036 2548.873,-9106.1271 2583.7793,-7590 2606.7265,-6593.3049 2660.8728,-5366.6427 2668.7651,-5190.4593"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.2652,-5190.5341 2669.2173,-5180.3871 2665.2723,-5190.2201 2672.2652,-5190.5341"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge758" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2480.5759,-12881.8992C2499.5986,-12864.8499 2534.0719,-12830.1622 2547.7793,-12792 2585.6273,-12686.6288 2575.3822,-10888.647 2583.7793,-10777 2602.3788,-10529.7039 2652.1397,-10232.3013 2666.0651,-10151.8886"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2669.5178,-10152.4621 2667.7852,-10142.0099 2662.6216,-10151.2612 2669.5178,-10152.4621"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2318.2205,-4685.0416C2330.6837,-4688.6572 2343.0493,-4694.7573 2351.1489,-4705 2412.0002,-4781.952 2354.6484,-5052.4354 2387.1489,-5145 2429.4259,-5265.4089 2509.9906,-5261.108 2547.7793,-5383 2586.9991,-5509.5083 2574.527,-10018.8753 2583.7793,-10151 2601.1033,-10398.3887 2651.7728,-10695.7254 2665.986,-10776.1172"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.5454,-10776.7605 2667.7423,-10785.9932 2669.4372,-10775.5349 2662.5454,-10776.7605"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge426" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2289.8807,-4668.7014C2356.6992,-4621.8966 2620.8291,-4451.777 2755.6838,-4585 2814.1216,-4642.7306 2760.2723,-7466.098 2791.6838,-7542 2830.131,-7634.9027 2910.6256,-7611.3117 2949.5867,-7704 2982.9209,-7783.3021 2982.6626,-9166.0265 2985.5867,-9252 3007.3245,-9891.1452 3048.0271,-10674.8343 3055.3273,-10813.5279"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.8408,-10813.8765 3055.8627,-10823.6782 3058.831,-10813.5077 3051.8408,-10813.8765"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2275.2264,-4691.1388C2282.9706,-4778.556 2333.8293,-5363.4886 2351.1489,-5840 2441.2313,-8318.4151 2311.6151,-8941.0989 2387.1489,-11420 2405.2255,-12013.2461 2456.3916,-12739.5199 2465.9247,-12871.8144"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.4382,-12872.1287 2466.6503,-12881.8502 2469.42,-12871.6238 2462.4382,-12872.1287"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-5131C2540.1776,-5183.8616 2637.7642,-5045.978 2669.7316,-5130"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2318.2249,-4679.7379C2330.5353,-4681.9161 2342.8134,-4686.6205 2351.1489,-4696 2412.0525,-4764.5313 2329.2221,-5035.9348 2387.1489,-5107 2410.6874,-5135.8773 2437.3303,-5109.0932 2467.4641,-5131"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge457" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-5511C2474.7895,-5555.4952 2527.7547,-5532.5958 2547.7793,-5573 2580.1226,-5638.2599 2578.0847,-10744.3879 2583.7793,-10817 2600.711,-11032.8955 2650.4314,-11291.0706 2665.4115,-11365.7922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.0258,-11366.7087 2667.4348,-11375.8188 2668.8875,-11365.324 2662.0258,-11366.7087"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2318.444,-4684.8681C2330.9177,-4688.4755 2343.2331,-4694.6146 2351.1489,-4705 2456.6041,-4843.3543 2280.0492,-5349.9148 2387.1489,-5487 2410.0852,-5516.3579 2461.4121,-5474.2396 2467.4641,-5511"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge734" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-5131C2484.7912,-5143.5965 2530.263,-5152.7298 2573.7123,-5158.8804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2573.4322,-5162.3747 2583.8146,-5160.2637 2574.3819,-5155.4394 2573.4322,-5162.3747"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1690.8413,-14131.9648C1709.8578,-14121.4251 1735.943,-14103.6494 1749.1377,-14080 1821.4522,-13950.3881 1741.3532,-13889.8152 1785.1377,-13748 1831.8198,-13596.7994 1908.8641,-13585.9672 1952.9868,-13434 1983.0592,-13330.4247 1915.7616,-13029.185 1988.9868,-12950 2098.1235,-12831.9806 2312.9932,-12859.0165 2413.3858,-12879.8441"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2412.8052,-12883.2989 2423.3153,-12881.9618 2414.2654,-12876.4529 2412.8052,-12883.2989"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2312.0458,-4476.9662C2403.9044,-4452.7482 2639.7519,-4406.5645 2755.6838,-4532 2810.2889,-4591.0813 2754.6079,-7356.6019 2791.6838,-7428 2831.5741,-7504.8178 2909.3657,-7465.3548 2949.5867,-7542 2993.7404,-7626.1394 2982.4614,-9157.0304 2985.5867,-9252 3006.6207,-9891.1688 3047.8977,-10674.8386 3055.3095,-10813.5285"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3051.8232,-10813.8801 3055.8531,-10823.6785 3058.8132,-10813.5056 3051.8232,-10813.8801"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge475" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2326.7602,-4497.2451C2335.8527,-4500.8841 2344.5035,-4505.9499 2351.1489,-4513 2394.6263,-4559.1248 2336.9894,-4612.2469 2387.1489,-4651 2443.6433,-4694.6474 2480.2522,-4674.1691 2547.7793,-4651 2566.9519,-4644.4217 2565.6769,-4632.1196 2583.7793,-4623 2619.2006,-4605.1555 2639.9415,-4572.8151 2669.7316,-4599"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2281.1924,-4499.1097C2297.369,-4525.6631 2337.1862,-4595.4161 2351.1489,-4660 2390.8294,-4843.5401 2381.5355,-11232.3035 2387.1489,-11420 2404.8915,-12013.2561 2456.3283,-12739.5218 2465.9157,-12871.8147"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2462.4293,-12872.1306 2466.6455,-12881.8503 2469.4109,-12871.6228 2462.4293,-12872.1306"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-4789C2486.1245,-4820.0594 2519.9081,-4779.8463 2547.7793,-4803 2667.0913,-4902.117 2614.5744,-4985.0269 2669.7316,-5130"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2326.6291,-4496.344C2335.9589,-4500.0494 2344.7326,-4505.3701 2351.1489,-4513 2423.9661,-4599.589 2313.303,-4679.2866 2387.1489,-4765 2411.4659,-4793.2248 2448.2777,-4757.0651 2467.4641,-4789"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge450" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2280.8971,-4499.1788C2296.4358,-4525.8817 2334.9743,-4595.9343 2351.1489,-4660 2404.0595,-4869.5726 2316.3122,-4940.7885 2387.1489,-5145 2428.9713,-5265.5676 2510.047,-5261.0905 2547.7793,-5383 2592.4103,-5527.1988 2571.9954,-10666.5129 2583.7793,-10817 2600.6851,-11032.8975 2650.4233,-11291.0712 2665.4097,-11365.7924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2662.0241,-11366.7092 2667.4338,-11375.8189 2668.8857,-11365.324 2662.0241,-11366.7092"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge727" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2467.4641,-4789C2486.6505,-4820.9349 2523.9394,-4784.3711 2547.7793,-4813 2642.4719,-4926.7145 2488.6707,-5030.6332 2583.7793,-5144 2586.4558,-5147.1904 2589.5138,-5149.9868 2592.8441,-5152.4367"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.2702,-5155.5778 2601.6207,-5157.84 2594.94,-5149.6169 2591.2702,-5155.5778"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge956" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#9900ff" stroke-dasharray="5,2" d="M583.8719,-16683.8312C591.4099,-16606.0403 635.9372,-16136.9828 651.5354,-15754 653.9359,-15695.0606 655.0048,-11556.2074 687.5354,-11507 691.1917,-11501.4693 696.3649,-11497.1547 702.1239,-11493.7908"/>
<polygon fill="#9900ff" stroke="#9900ff" points="704.0413,-11496.7516 711.5221,-11489.249 700.9954,-11490.4489 704.0413,-11496.7516"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2075.1519,-16424C2090.484,-16360.5279 2140.7925,-16366.9882 2161.3169,-16305 2210.512,-16156.4198 2156.9854,-13639.2271 2197.3169,-13488 2215.4109,-13420.1546 2258.0228,-13418.32 2274.2329,-13350"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M602.7507,-16706.1436C623.4646,-16717.3605 657.0335,-16734.5908 687.5354,-16746 887.8356,-16820.9222 958.2393,-16780.9006 1152.1868,-16871 1169.8532,-16879.207 1169.5974,-16890.1784 1188.1868,-16896 1259.6249,-16918.3722 1283.6893,-16912.8814 1356.6204,-16896 1545.8222,-16852.2052 1586.9353,-16810.7975 1749.1377,-16704 1789.0192,-16677.7412 2063.9399,-16470.4151 2075.1519,-16424"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M626.555,-16706.0205C774.2299,-16742.0319 1250.7491,-16848.3625 1356.6204,-16749 1402.6503,-16705.7999 1377.416,-16243.2685 1392.6204,-16182 1433.9443,-16015.4783 1512.5132,-15997.173 1551.1179,-15830 1609.547,-15576.98 1563.0477,-14920.5608 1587.1179,-14662 1605.2518,-14467.2072 1649.8802,-14234.4311 1663.8654,-14164.1166"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1667.3081,-14164.7495 1665.8381,-14154.2571 1660.4441,-14163.3761 1667.3081,-14164.7495"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M753.5256,-16415.8965C786.2624,-16374.4424 907.5595,-16226.8757 1038.022,-16144 1066.2068,-16126.0957 2142.1841,-15743.3658 2161.3169,-15716 2245.8732,-15595.0584 2130.0517,-13191.347 2197.3169,-13060 2236.106,-12984.2574 2287.0842,-13002.0112 2351.1489,-12946 2368.422,-12930.8983 2366.9904,-12919.9569 2387.1489,-12909 2394.5112,-12904.9983 2402.7405,-12901.9912 2411.0473,-12899.7327"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2411.8715,-12903.1344 2420.7872,-12897.4107 2410.2481,-12896.3252 2411.8715,-12903.1344"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge447" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M771.0021,-16415.8323C821.7831,-16392.9351 934.7655,-16336.0865 1002.022,-16257 1027.2808,-16227.2983 1009.1363,-16203.1881 1038.022,-16177 1039.5125,-16175.6487 1585.1325,-15992.3255 1587.1179,-15992 1658.1782,-15980.351 1679.6856,-15972.9823 1749.1377,-15992 1868.6202,-16024.7172 1869.5043,-16101.2828 1988.9868,-16134 2062.8586,-16154.2279 2106.6545,-16187.6491 2161.3169,-16134 2237.6158,-16059.1154 2142.3638,-14301.7027 2197.3169,-14210 2237.5797,-14142.8116 2302.0031,-14184.9922 2351.1489,-14124 2398.2246,-14065.5769 2534.5784,-13551.8587 2547.7793,-13478 2566.9994,-13370.4636 2657.6105,-11622.0102 2668.6325,-11408.3403"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.1396,-11408.2919 2669.1591,-11398.125 2665.1489,-11407.9315 2672.1396,-11408.2919"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge876" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2872.5177,-12804.6631C2882.8269,-12741.9626 2932.5961,-12431.205 2949.5867,-12175 3003.1291,-11367.6228 2962.3723,-9342.8176 2985.5867,-8534 3002.8166,-7933.6867 3046.934,-7198.3902 3055.139,-7064.4494"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.6434,-7064.4846 3055.7634,-7054.2887 3051.6566,-7064.0552 3058.6434,-7064.4846"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2872.3702,-12827.079C2881.9509,-12885.6583 2932.5263,-13163.641 3056.4631,-13350"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3056.4631,-13350C3165.8504,-13514.4813 3225.3835,-13751.1183 3241.6475,-13822.7004"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3238.2929,-13823.738 3243.8873,-13832.7354 3245.1248,-13822.2131 3238.2929,-13823.738"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge428" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2879.7731,-12804.9078C2897.3324,-12782.8075 2935.3125,-12731.0048 2949.5867,-12680 2976.8418,-12582.611 2926.3549,-10941.9698 2985.5867,-10860 2987.8602,-10856.8537 2990.5625,-10854.101 2993.5632,-10851.693"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6677,-10854.4985 3002.1137,-10846.0902 2991.8311,-10848.6436 2995.6677,-10854.4985"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M2872.6589,-12827.1946C2890.9651,-12928.4648 3027.8692,-13685.8185 3052.63,-13822.7949"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3049.2241,-13823.63 3054.4472,-13832.8479 3056.1125,-13822.3847 3049.2241,-13823.63"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M3104.3612,-13844C3119.186,-13844 3136.0581,-13844 3152.8675,-13844"/>
<polygon fill="#ffff00" stroke="#ffff00" points="3153.3068,-13847.5001 3163.3068,-13844 3153.3067,-13840.5001 3153.3068,-13847.5001"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge863" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2319.1014,-12269.8771C2329.9714,-12266.2584 2341.2913,-12261.6726 2351.1489,-12256 2452.8048,-12197.5018 2475.336,-12172.2384 2547.7793,-12080 2668.8616,-11925.832 2694.0898,-11877.1045 2755.6838,-11691 2938.8176,-11137.6673 2900.7561,-10974.8017 2949.5867,-10394 3018.8568,-9570.0853 2957.9541,-9360.3596 2985.5867,-8534 3005.6575,-7933.7749 3047.4723,-7198.4069 3055.2155,-7064.4517"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3058.7199,-7064.4757 3055.8044,-7054.29 3051.7317,-7064.0707 3058.7199,-7064.4757"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2321.1587,-12291.1145C2445.9228,-12314.9342 2787.3623,-12359.4999 2949.5867,-12175 3046.1025,-12065.2313 2899.5291,-10978.1463 2985.5867,-10860 2987.8721,-10856.8624 2990.5836,-10854.1163 2993.5912,-10851.7133"/>
<polygon fill="#00ff00" stroke="#00ff00" points="2995.6963,-10854.5188 3002.1548,-10846.12 2991.8684,-10848.6581 2995.6963,-10854.5188"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge473" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2320.8191,-12273.4431C2331.8995,-12269.7394 2342.8887,-12264.2212 2351.1489,-12256 2387.3096,-12220.0102 2366.1848,-12193.512 2387.1489,-12147 2520.7606,-11850.5633 2665.9437,-11827.5276 2755.6838,-11515 2790.9359,-11392.2316 2714.615,-10467.8586 2791.6838,-10366 2794.0342,-10362.8936 2796.7715,-10360.1646 2799.7873,-10357.7681"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.8938,-10360.5726 2808.3469,-10352.1697 2798.0622,-10354.7143 2801.8938,-10360.5726"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge492" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M2286.7806,-12269.7697C2304.9865,-12252.5551 2337.9861,-12217.6591 2351.1489,-12180 2412.0944,-12005.6342 2324.3796,-10691.7176 2387.1489,-10518 2399.26,-10484.4819 2427.3332,-10453.6194 2446.8537,-10435.0551"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="2449.4026,-10437.4652 2454.3709,-10428.1075 2444.6515,-10432.3245 2449.4026,-10437.4652"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2320.9419,-12286.9723C2332.4312,-12290.6705 2343.5913,-12296.5821 2351.1489,-12306 2403.4063,-12371.1201 2333.598,-12615.9395 2387.1489,-12680 2499.6733,-12814.6077 2733.987,-12821.6342 2829.1345,-12818.4756"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2829.3778,-12821.9689 2839.2345,-12818.0836 2829.1063,-12814.9742 2829.3778,-12821.9689"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~plantwateruse.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge623" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~plantwateruse.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1321.5724,-13640.8297C1334.9228,-13637.2247 1348.0435,-13630.9116 1356.6204,-13620 1455.3454,-13494.4001 1290.5861,-13024.9268 1392.6204,-12902 1438.8867,-12846.2602 1503.6132,-12918.6883 1551.1179,-12864 1606.4529,-12800.2973 1531.6259,-12549.566 1587.1179,-12486 1635.7591,-12430.2816 1702.3884,-12505.315 1749.1377,-12448 1794.2778,-12392.6579 1759.3672,-11229.6052 1785.1377,-11163 1835.2725,-11033.4241 1867.7824,-10993.9182 1988.9868,-10926 2022.8329,-10907.034 2050.9486,-10942.3227 2075.1519,-10912"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge646" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M1321.5262,-13640.7933C1334.875,-13637.187 1348.0065,-13630.8824 1356.6204,-13620 1443.9278,-13509.7002 1317.2692,-13106.7891 1392.6204,-12988 1435.55,-12920.3225 1503.4742,-12966.446 1551.1179,-12902 1599.0993,-12837.0973 1555.7892,-12798.3847 1587.1179,-12724 1636.7864,-12606.071 1708.5611,-12607.3579 1749.1377,-12486 1802.4004,-12326.7001 1733.4661,-11890.8231 1785.1377,-11731 1879.312,-11439.7137 2067.1057,-11445.2744 2161.3169,-11154 2212.7355,-10995.0282 2182.2365,-10569.3986 2197.3169,-10403 2243.8996,-9889.0024 2298.3336,-9765.3946 2351.1489,-9252 2417.8449,-8603.6781 2459.3978,-7804.4938 2466.4071,-7664.4342"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="2469.9148,-7664.3642 2466.9161,-7654.2027 2462.9234,-7664.0164 2469.9148,-7664.3642"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge476" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1319.7998,-13633.9647C1332.1047,-13630.2884 1345.1239,-13625.6534 1356.6204,-13620 1374.3313,-13611.2906 1374.9833,-13602.858 1392.6204,-13594 1640.9683,-13469.2712 1716.8776,-13462.4848 1988.9868,-13406 2324.4399,-13336.3663 2524.7977,-13579.119 2755.6838,-13326 2811.0987,-13265.249 2742.6997,-10432.0458 2791.6838,-10366 2794.0044,-10362.8712 2796.7181,-10360.1246 2799.7157,-10357.7144"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2801.821,-10360.5186 2808.2388,-10352.0887 2797.9648,-10354.6765 2801.821,-10360.5186"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1283.6702,-13656.1248C1321.993,-13693.0779 1452.421,-13811.6729 1587.1179,-13852 1656.1014,-13872.6531 1681.0265,-13875.3695 1749.1377,-13852 1768.3103,-13845.4217 1766.7061,-13832.4345 1785.1377,-13824 2185.1327,-13640.9579 2456.5888,-13952.5563 2755.6838,-13630 2800.4381,-13581.7351 2782.7427,-13401.2112 2791.6838,-13336 2818.2929,-13141.9292 2855.7469,-12907.9628 2867.1849,-12837.2437"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2870.6472,-12837.7575 2868.7916,-12827.3264 2863.7373,-12836.638 2870.6472,-12837.7575"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2328.176,-12367.523C2337.0296,-12371.2314 2345.2307,-12376.5074 2351.1489,-12384 2412.7819,-12462.0282 2323.4817,-12753.6227 2387.1489,-12830 2434.4703,-12886.7683 2496.1645,-12820.1052 2547.7793,-12873 2595.3592,-12921.7599 2530.2469,-12979.8613 2583.7793,-13022 2643.8133,-13069.2566 2689.7988,-13060.6837 2755.6838,-13022 2825.3589,-12981.091 2855.9128,-12880.8961 2866.2635,-12837.0849"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2869.7001,-12837.755 2868.4713,-12827.2317 2862.8694,-12836.2245 2869.7001,-12837.755"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge466" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2671.7217,-11375.7891C2682.0043,-11317.511 2729.6358,-11043.1804 2755.6838,-10817 2761.4352,-10767.0596 2760.392,-10405.3439 2791.6838,-10366 2794.2289,-10362.8001 2797.1827,-10360.0025 2800.4232,-10357.5576"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2802.3877,-10360.4569 2808.9987,-10352.1776 2798.6676,-10354.5272 2802.3877,-10360.4569"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge610" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~plantpipeheattransfer.f90</title>
<path fill="none" stroke="#ffbf00" stroke-dasharray="5,2" d="M2078.0451,-10694.1899C2090.8082,-10744.1413 2142.2834,-10951.9229 2161.3169,-11126 2169.7735,-11203.3425 2150.783,-12463.6464 2197.3169,-12526 2199.6368,-12529.1086 2202.3517,-12531.8374 2205.3493,-12534.2323"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="2203.5867,-12537.2619 2213.8674,-12539.8227 2207.4276,-12531.4097 2203.5867,-12537.2619"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge739" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-9923C2433.1411,-9798.8462 2481.9212,-9751.6009 2547.7793,-9561 2583.5461,-9457.4868 2580.8363,-7699.4787 2583.7793,-7590 2610.5697,-6593.4008 2661.4419,-5366.6569 2668.8283,-5190.4608"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2672.3286,-5190.526 2669.2513,-5180.388 2665.3348,-5190.2323 2672.3286,-5190.526"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2076.0212,-10671.9412C2082.4144,-10592.5798 2123.9686,-10109.3815 2197.3169,-9985 2219.6204,-9947.1785 2254.2454,-9962.0949 2274.2329,-9923"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge753" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2076.2639,-10671.8916C2085.5401,-10585.727 2157.6113,-10027.6536 2467.4641,-10037"/>
</g>
<!-- sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge706" class="edge">
<title>sourcefile~poweredinductionunits.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3246.5578,-4968.8606C3251.4382,-4775.9157 3318.9194,-2140.4323 3365.2148,-2078 3367.5499,-2074.851 3370.3101,-2072.0963 3373.365,-2069.6868"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3375.5466,-2072.4445 3382.0507,-2064.081 3371.7507,-2066.5631 3375.5466,-2072.4445"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge714" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~zoneplenumcomponent.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M767.9874,-4234.0088C818.2817,-4256.1935 938.3156,-4299.0983 1002.022,-4237 1058.0542,-4182.3821 991.4485,-2891.8779 1038.022,-2829 1069.8517,-2786.0274 1120.3352,-2833.9564 1152.1868,-2791 1241.8253,-2670.1097 1092.6187,-1553.2596 1188.1868,-1437 1247.3263,-1365.0561 1301.5758,-1410.6033 1392.6204,-1391 1894.57,-1282.9223 2080.2155,-1162.8248 2547.7793,-1375 2823.9087,-1500.3044 2919.0639,-1514.6142 3127.3396,-1735 3150.2897,-1759.2845 3139.4656,-1777.6231 3163.3396,-1801 3222.6734,-1859.0984 3276.2295,-1823.0588 3329.2148,-1887 3364.7429,-1929.8742 3331.7032,-1962.5319 3365.2148,-2007 3374.6856,-2019.5672 3388.6697,-2029.6361 3401.7768,-2037.1116"/>
<polygon fill="#00ffff" stroke="#00ffff" points="3400.1784,-2040.2259 3410.6446,-2041.8715 3403.489,-2034.0583 3400.1784,-2040.2259"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge685" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.4866,-4234.099C804.9418,-4264.3081 933.5335,-4341.4309 1002.022,-4275 1049.1001,-4229.3362 1023.8399,-3159.0344 1038.022,-3095 1065.8408,-2969.3929 1124.5697,-2954.6516 1152.1868,-2829 1167.9229,-2757.4039 1143.585,-1568.1748 1188.1868,-1510 1243.8905,-1437.3448 1897.8246,-1324.4339 1988.9868,-1316 2065.2523,-1308.9443 2085.0991,-1308.4464 2161.3169,-1316 2246.941,-1324.4858 2276.8853,-1310.5441 2351.1489,-1354 2662.3108,-1536.0787 2568.9243,-1779.6556 2870.6353,-1977"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2870.6353,-1977C2903.9685,-1992.2953 2917.424,-1983.3758 2949.5867,-2001 3040.7446,-2050.9518 3081.8744,-2059.5234 3127.3396,-2153 3159.9403,-2220.0273 3237.6704,-4702.2567 3245.6182,-4958.6627"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3242.127,-4959.004 3245.9348,-4968.8909 3249.1236,-4958.7873 3242.127,-4959.004"/>
</g>
<!-- sourcefile~hvacmixercomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge689" class="edge">
<title>sourcefile~hvacmixercomponent.f90&#45;&gt;sourcefile~poweredinductionunits.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1933.8696,-7329.8144C1941.0445,-7326.3504 1947.6663,-7321.8471 1952.9868,-7316 2008.4812,-7255.0132 1948.494,-7205.8286 1988.9868,-7134 2050.5271,-7024.836 2090.2844,-7009.1769 2197.3169,-6944 2306.6656,-6877.4127 2339.4367,-6844 2467.4641,-6844 2467.4641,-6844 2467.4641,-6844 2870.6353,-6844 3068.4727,-6844 3225.1795,-5209.5662 3244.3128,-5001.6613"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3247.824,-5001.6973 3245.2498,-4991.42 3240.8531,-5001.0595 3247.824,-5001.6973"/>
</g>
<!-- sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge807" class="edge">
<title>sourcefile~photovoltaics.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M2917.0481,-8539.7455C2935.8021,-8541.663 2957.9616,-8543.9287 2979.0286,-8546.0827"/>
<polygon fill="#003fff" stroke="#003fff" points="2978.959,-8549.5937 2989.2632,-8547.1291 2979.6711,-8542.63 2978.959,-8549.5937"/>
</g>
<!-- sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge808" class="edge">
<title>sourcefile~windturbine.f90&#45;&gt;sourcefile~electricpowermanager.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M1712.3753,-12092.4542C1803.2356,-12095.3592 2017.4346,-12101.7908 2197.3169,-12104 2265.6815,-12104.8396 2285.7127,-12123.8125 2351.1489,-12104 2369.5534,-12098.4276 2369.5142,-12087.6677 2387.1489,-12080 2454.4261,-12050.7472 2489.3078,-12086.3061 2547.7793,-12042 2699.6672,-11926.9088 2690.0057,-11845.8918 2755.6838,-11667 3166.3289,-10548.4992 2878.408,-10182.6702 2985.5867,-8996 3000.3261,-8832.8063 3038.8632,-8638.6104 3052.0006,-8575.1752"/>
<polygon fill="#003fff" stroke="#003fff" points="3055.466,-8575.7021 3054.0817,-8565.1981 3048.6135,-8574.2728 3055.466,-8575.7021"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge766" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2671.0434,-5180.1391C2680.1198,-5257.7237 2733.8656,-5725.5583 2755.6838,-6108 2795.8428,-6811.9259 2750.7077,-6990.1212 2791.6838,-7694 2810.7251,-8021.0863 2856.6642,-8417.8077 2868.0494,-8513.4937"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2864.6006,-8514.1314 2869.2624,-8523.6455 2871.5512,-8513.3008 2864.6006,-8514.1314"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge770" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2670.9806,-10119.9158C2680.1557,-10038.6291 2738.271,-9526.1006 2791.6838,-9110 2819.4452,-8893.7318 2856.6849,-8632.2416 2867.5439,-8556.5031"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2871.0464,-8556.7346 2869.0028,-8546.3388 2864.1174,-8555.74 2871.0464,-8556.7346"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge780" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2132.3521,-3834.338C2225.166,-3829.3325 2411.8649,-3830.077 2547.7793,-3901 2578.1742,-3916.8607 2743.1185,-4097.1014 2755.6838,-4129 2788.4983,-4212.3033 2788.2015,-7262.5344 2791.6838,-7352 2810.0079,-7822.7642 2858.6752,-8397.3643 2868.7816,-8513.8309"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2865.3058,-8514.2625 2869.6604,-8523.921 2872.2794,-8513.655 2865.3058,-8514.2625"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge733" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2132.555,-3845.1111C2143.6356,-3848.9279 2154.043,-3854.8588 2161.3169,-3864 2250.5643,-3976.1593 2105.8326,-4397.6577 2197.3169,-4508 2219.7915,-4535.1074 2258.9743,-4495.2653 2274.2329,-4527"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2274.2329,-4527C2289.7506,-4559.2736 2327.9393,-4523.7291 2351.1489,-4551 2424.4758,-4637.1578 2322.2837,-4710.3042 2387.1489,-4803 2433.577,-4869.3482 2501.4059,-4822.6136 2547.7793,-4889 2613.3241,-4982.8314 2508.8258,-5057.499 2583.7793,-5144 2586.6416,-5147.3032 2589.9124,-5150.1824 2593.4674,-5152.6908"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2591.8357,-5155.7926 2602.2197,-5157.8961 2595.4139,-5149.7762 2591.8357,-5155.7926"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge826" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~electricpowergenerators.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M763.5076,-6398.8768C775.5666,-6391.031 791.0554,-6379.6882 802.259,-6367 823.6044,-6342.8261 811.7589,-6322.3778 838.259,-6304 954.4132,-6223.447 1014.2675,-6283.9654 1152.1868,-6253 1157.813,-6251.7368 1547.289,-6142.3116 1551.1179,-6138 1616.9067,-6063.9167 1511.6138,-5982.1531 1587.1179,-5918 1641.9934,-5871.3743 1682.1363,-5891.6168 1749.1377,-5918 1763.5426,-5923.6722 1945.6721,-6094.3556 1952.9868,-6108 1999.385,-6194.5486 1928.0554,-6248.9882 1988.9868,-6326 2040.4908,-6391.0964 2109.1704,-6333.4172 2161.3169,-6398 2216.4078,-6466.2295 2152.3866,-6516.6904 2197.3169,-6592 2219.8133,-6629.7071 2230.4695,-6657.5612 2274.2329,-6654"/>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M2274.2329,-6654C2357.4627,-6646.5737 2426.65,-6561.7808 2454.4064,-6522.6145"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="2457.4593,-6524.3533 2460.269,-6514.1378 2451.7021,-6520.3715 2457.4593,-6524.3533"/>
</g>
<!-- sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge790" class="edge">
<title>sourcefile~datagenerators.f90&#45;&gt;sourcefile~windturbine.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.8666,-6421.1866C769.4627,-6435.8403 792.0803,-6462.9809 802.259,-6491 870.0103,-6677.4989 778.4912,-6746.7915 838.259,-6936 923.5047,-7205.8642 973.858,-7283.1848 1188.1868,-7468 1267.3023,-7536.2212 1296.6081,-7542.8291 1392.6204,-7584 1426.4433,-7598.5036 1468.7017,-7571.3351 1471.8691,-7608"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge860" class="edge">
<title>sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff00bf" stroke-dasharray="5,2" d="M2510.9478,-6995.9745C2596.5875,-6976.1614 2792.4235,-6940.3059 2949.5867,-6982 2981.5686,-6990.4845 3013.9705,-7011.0292 3034.5789,-7025.9363"/>
<polygon fill="#ff00bf" stroke="#ff00bf" points="3032.5372,-7028.7797 3042.6534,-7031.9284 3036.7088,-7023.1584 3032.5372,-7028.7797"/>
</g>
<!-- sourcefile~datadelight.f90&#45;&gt;sourcefile~delightmanagerf.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge918" class="edge">
<title>sourcefile~datadelight.f90&#45;&gt;sourcefile~delightmanagerf.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M3647.9205,-714.0278C3656.1595,-717.564 3664.3299,-722.1373 3670.96,-728 3695.9908,-750.1337 3687.872,-766.5756 3706.96,-794 3740.6359,-842.3835 3772.8937,-838.9947 3794.094,-894"/>
</g>
<!-- sourcefile~tarcogcomplexfenestration.f90&#45;&gt;sourcefile~windowcomplexmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~EfferentGraph_edge982" class="edge">
<title>sourcefile~tarcogcomplexfenestration.f90&#45;&gt;sourcefile~windowcomplexmanager.f90</title>
<path fill="none" stroke="#ff0066" stroke-dasharray="5,2" d="M407.1013,-14816.9095C425.3371,-14796.5502 467.6107,-14753.8505 514.0276,-14738 571.8631,-14718.2503 590.6312,-14732.933 651.5354,-14738 685.709,-14740.8431 1838.1454,-14927.1655 1869.0623,-14942"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilesolarshadingf90EfferentGraph = svgPanZoom('#sourcefilesolarshadingf90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~solarshading.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilesolarshadingf90AfferentGraph" width="641pt" height="97pt"
 viewBox="0.00 0.00 641.00 96.88" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~solarshading.f90~~AfferentGraph" class="graph" transform="scale(.718 .718) rotate(0) translate(4 130.9276)">
<title>sourcefile~~solarshading.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-130.9276 888.7583,-130.9276 888.7583,4 -4,4"/>
<!-- sourcefile~solarshading.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~solarshading.f90</title>
<polygon fill="none" stroke="#000000" points="92.3408,-69.0054 .2191,-69.0054 .2191,-46.9946 92.3408,-46.9946 92.3408,-69.0054"/>
<text text-anchor="middle" x="46.2799" y="-54.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">SolarShading.f90</text>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="461.5078,-88.0054 331.4971,-88.0054 331.4971,-65.9946 461.5078,-65.9946 461.5078,-88.0054"/>
<text text-anchor="middle" x="396.5024" y="-73.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M68.0353,-69.127C99.0067,-84.1411 158.0379,-109.7342 211.905,-116"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M211.905,-116C264.099,-122.0712 323.3657,-105.2195 360.3461,-91.7894"/>
<polygon fill="#ff0000" stroke="#ff0000" points="362.0236,-94.8987 370.1611,-88.1141 359.5688,-88.3432 362.0236,-94.8987"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="295.0957,-69.0054 128.7143,-69.0054 128.7143,-46.9946 295.0957,-46.9946 295.0957,-69.0054"/>
<text text-anchor="middle" x="211.905" y="-54.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M92.4157,-58C100.622,-58 109.4304,-58 118.4091,-58"/>
<polygon fill="#ff0000" stroke="#ff0000" points="118.5959,-61.5001 128.5959,-58 118.5958,-54.5001 118.5959,-61.5001"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~solarshading.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="884.5692,-29.0054 788.327,-29.0054 788.327,-6.9946 884.5692,-6.9946 884.5692,-29.0054"/>
<text text-anchor="middle" x="836.4481" y="-14.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M86.3683,-46.9541C151.0754,-30.126 282.7938,0 396.5024,0 396.5024,0 396.5024,0 547.244,0 627.3274,0 719.6442,-6.9604 778.0126,-12.2247"/>
<polygon fill="#ff0000" stroke="#ff0000" points="777.8715,-15.7263 788.149,-13.1527 778.5097,-8.7554 777.8715,-15.7263"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="752.3409,-79.0054 632.5304,-79.0054 632.5304,-56.9946 752.3409,-56.9946 752.3409,-79.0054"/>
<text text-anchor="middle" x="692.4357" y="-64.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~solarshading.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M211.905,-116C382.0013,-135.7855 428.0106,-126.2717 596.7334,-97 615.6083,-93.7254 635.9921,-87.8859 653.0774,-82.3009"/>
<polygon fill="#ff0000" stroke="#ff0000" points="654.3537,-85.5645 662.7194,-79.0633 652.1254,-78.9286 654.3537,-85.5645"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M429.9811,-65.9351C467.0689,-54.1084 524.6206,-37.15 547.244,-38"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~solarshading.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="596.7228,-88.0054 497.7653,-88.0054 497.7653,-65.9946 596.7228,-65.9946 596.7228,-88.0054"/>
<text text-anchor="middle" x="547.244" y="-73.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M461.7432,-77C470.2285,-77 478.8883,-77 487.2818,-77"/>
<polygon fill="#ff0000" stroke="#ff0000" points="487.3584,-80.5001 497.3584,-77 487.3583,-73.5001 487.3584,-80.5001"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M295.2927,-66.5828C304.0143,-67.4805 312.843,-68.3892 321.4634,-69.2765"/>
<polygon fill="#7fff00" stroke="#7fff00" points="321.1626,-72.7639 331.4685,-70.3063 321.8794,-65.8007 321.1626,-72.7639"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M547.244,-38C580.6896,-39.2566 617.6179,-46.9766 645.8621,-54.2698"/>
<polygon fill="#7fff00" stroke="#7fff00" points="645.2889,-57.7389 655.8524,-56.9247 647.0868,-50.9737 645.2889,-57.7389"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M295.2304,-48.5269C363.052,-41.9016 461.2797,-34.7701 547.244,-38"/>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M724.3967,-56.9034C745.1856,-49.6856 772.5043,-40.2008 794.9624,-32.4035"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="796.2776,-35.6519 804.5764,-29.0656 793.9816,-29.0391 796.2776,-35.6519"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~solarshading.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="878.1566,-79.0054 794.7396,-79.0054 794.7396,-56.9946 878.1566,-56.9946 878.1566,-79.0054"/>
<text text-anchor="middle" x="836.4481" y="-64.85" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M752.2588,-68C762.9234,-68 773.9552,-68 784.3816,-68"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="784.5701,-71.5001 794.5701,-68 784.57,-64.5001 784.5701,-71.5001"/>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~solarshading.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M596.8047,-73.9279C605.071,-73.4155 613.7819,-72.8755 622.4434,-72.3386"/>
<polygon fill="#ff0000" stroke="#ff0000" points="622.7945,-75.8237 632.5588,-71.7116 622.3614,-68.8371 622.7945,-75.8237"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilesolarshadingf90AfferentGraph = svgPanZoom('#sourcefilesolarshadingf90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/solarshading.html">SolarShading</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/solarshading.f90.html#src">SolarShading.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">MODULE </span><span class="n">SolarShading</span>
<a name="ln-2"></a>
<a name="ln-3"></a>          <span class="c">! MODULE INFORMATION:</span>
<a name="ln-4"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-5"></a>          <span class="c">!       DATE WRITTEN   March 1997</span>
<a name="ln-6"></a>          <span class="c">!       MODIFIED       December 1998, FCW</span>
<a name="ln-7"></a>          <span class="c">!       MODIFIED       July 1999, Linda Lawrie, eliminate shadefl.scr,</span>
<a name="ln-8"></a>          <span class="c">!                      do shadowing calculations during simulation</span>
<a name="ln-9"></a>          <span class="c">!       MODIFIED       June 2001, FCW, handle window blinds</span>
<a name="ln-10"></a>          <span class="c">!       MODIFIED       May 2004, LKL, Polygons &gt; 4 sides (not subsurfaces)</span>
<a name="ln-11"></a>          <span class="c">!       MODIFIED       January 2007, LKL, Taking parameters back to original integer (HC)</span>
<a name="ln-12"></a>          <span class="c">!       MODIFIED       August 2011, JHK, Including Complex Fenestration optical calculations</span>
<a name="ln-13"></a>          <span class="c">!       MODIFIED       November 2012, BG, Timestep solar and daylighting calculations</span>
<a name="ln-14"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-15"></a>
<a name="ln-16"></a>          <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-17"></a>          <span class="c">! The purpose of this module is to encompass the routines and data</span>
<a name="ln-18"></a>          <span class="c">! which are need to perform the solar calculations in EnergyPlus.</span>
<a name="ln-19"></a>          <span class="c">! This also requires that shading and geometry routines and data</span>
<a name="ln-20"></a>          <span class="c">! which are used by the solar calculations be included in this module.</span>
<a name="ln-21"></a>
<a name="ln-22"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-23"></a>          <span class="c">! Many of the methods used in this module have been carried over from the</span>
<a name="ln-24"></a>          <span class="c">! (I)BLAST program.  As such, there is not much documentation on the</span>
<a name="ln-25"></a>          <span class="c">! methodology used.  The original code was written mainly by George</span>
<a name="ln-26"></a>          <span class="c">! Walton and requires coordinate transformations.  It calculates</span>
<a name="ln-27"></a>          <span class="c">! shading using an overlapping polygon approach.</span>
<a name="ln-28"></a>
<a name="ln-29"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-30"></a>          <span class="c">! TARP Manual, NIST Publication.</span>
<a name="ln-31"></a>          <span class="c">! Passive Solar Extension of the BLAST Program, CERL/UIUC Publication.</span>
<a name="ln-32"></a>
<a name="ln-33"></a>          <span class="c">! OTHER NOTES:</span>
<a name="ln-34"></a>          <span class="c">! na</span>
<a name="ln-35"></a>
<a name="ln-36"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-37"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-38"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-39"></a><span class="k">USE </span><span class="n">DataEnvironment</span>
<a name="ln-40"></a><span class="k">USE </span><span class="n">DataHeatBalance</span>
<a name="ln-41"></a><span class="k">USE </span><span class="n">DataSurfaces</span>
<a name="ln-42"></a><span class="k">USE </span><span class="n">DataShadowingCombinations</span>
<a name="ln-43"></a><span class="k">USE </span><span class="n">DaylightingManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">ProfileAngle</span>
<a name="ln-44"></a><span class="k">USE </span><span class="n">SolarReflectionManager</span>
<a name="ln-45"></a><span class="k">USE </span><span class="n">DataReportingFlags</span>
<a name="ln-46"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-47"></a><span class="k">USE </span><span class="n">DataBSDFWindow</span>    <span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SUNCOSTS</span> <span class="p">,</span> <span class="n">MaxBkSurf</span> <span class="p">,</span> <span class="n">ComplexWind</span>
<a name="ln-48"></a><span class="k">USE </span><span class="n">DataVectorTypes</span>
<a name="ln-49"></a><span class="k">USE </span><span class="n">DataTimings</span>
<a name="ln-50"></a>
<a name="ln-51"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-52"></a>
<a name="ln-53"></a><span class="k">PRIVATE</span>
<a name="ln-54"></a>
<a name="ln-55"></a>          <span class="c">! MODULE PARAMETER DEFINITIONS:</span>
<a name="ln-56"></a>          <span class="c">! General Parameters...</span>
<a name="ln-57"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SmallIncrement</span><span class="o">=</span><span class="mf">1.0d-10</span>     <span class="c">! Small increment added for shading/sunlit area calculations.</span>
<a name="ln-58"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HCMULT</span> <span class="o">=</span> <span class="mi">10000</span><span class="mf">0.d0</span>   <span class="c">! Multiplier used to change meters to .01 millimeters for homogeneous coordinates.</span>
<a name="ln-59"></a>     <span class="c">! Homogeneous Coordinates are represented in integers (64 bit). This changes the surface coordinates from meters</span>
<a name="ln-60"></a>     <span class="c">! to .01 millimeters -- making that the resolution for shadowing, polygon clipping, etc.</span>
<a name="ln-61"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">sqHCMULT</span> <span class="o">=</span> <span class="n">HCMULT</span><span class="o">*</span><span class="n">HCMULT</span>   <span class="c">! Square of HCMult used in Homogeneous coordinates</span>
<a name="ln-62"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">kHCMULT</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">HCMULT</span><span class="o">*</span><span class="n">HCMULT</span><span class="p">)</span>   <span class="c">! half of inverse square of HCMult used in Homogeneous coordinates</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="c">!INTEGER,          PRIVATE, PARAMETER :: MAXCMB = 2000   ! Length of SHDCMB array</span>
<a name="ln-65"></a><span class="c">!INTEGER,          PARAMETER :: MAXHCS = 15000 ! 200      ! Maximum number of HC surfaces (was 56)</span>
<a name="ln-66"></a><span class="c">!INTEGER,          PARAMETER :: MAXHCV = 12      ! Maximum number of HC vertices</span>
<a name="ln-67"></a>
<a name="ln-68"></a>          <span class="c">! Parameters for use with the variable OverlapStatus...</span>
<a name="ln-69"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">NoOverlap</span>             <span class="o">=</span> <span class="mi">1</span>
<a name="ln-70"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">FirstSurfWithinSecond</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-71"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SecondSurfWithinFirst</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-72"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PartialOverlap</span>        <span class="o">=</span> <span class="mi">4</span>
<a name="ln-73"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TooManyVertices</span>       <span class="o">=</span> <span class="mi">5</span>
<a name="ln-74"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">TooManyFigures</span>        <span class="o">=</span> <span class="mi">6</span>
<a name="ln-75"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cOverLapStatus</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-76"></a>                   <span class="p">(</span><span class="o">/</span><span class="s1">&#39;No-Overlap         &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-77"></a>                     <span class="s1">&#39;1st-Surf-within-2nd&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-78"></a>                     <span class="s1">&#39;2nd-Surf-within-1st&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-79"></a>                     <span class="s1">&#39;Partial-Overlap    &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-80"></a>                     <span class="s1">&#39;Too-Many-Vertices  &#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-81"></a>                     <span class="s1">&#39;Too-Many-Figures   &#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-82"></a>
<a name="ln-83"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-84"></a><span class="k">TYPE </span><span class="n">SurfaceErrorTracking</span>
<a name="ln-85"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfIndex1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Tracking for main error message</span>
<a name="ln-86"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfIndex2</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Tracking for Overlapping Figure Name or Surface # 1</span>
<a name="ln-87"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MiscIndex</span>  <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Used for other pertinent information to be stored</span>
<a name="ln-88"></a><span class="k">END TYPE</span>
<a name="ln-89"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-90"></a>          <span class="c">! na</span>
<a name="ln-91"></a>
<a name="ln-92"></a>          <span class="c">! MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-93"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MAXHCV</span> <span class="o">=</span> <span class="mi">12</span>      <span class="c">! Maximum number of HC vertices</span>
<a name="ln-94"></a>                                      <span class="c">! (needs to be based on maxnumvertices)</span>
<a name="ln-95"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MAXHCS</span> <span class="o">=</span> <span class="mi">15000</span> <span class="c">! 200      ! Maximum number of HC surfaces (was 56)</span>
<a name="ln-96"></a><span class="c">! Following are initially set in AllocateModuleArrays</span>
<a name="ln-97"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">PUBLIC</span>   <span class="kd">::</span> <span class="n">MAXHCArrayBounds</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Bounds based on Max Number of Vertices in surfaces</span>
<a name="ln-98"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">MAXHCArrayIncrement</span> <span class="o">=</span> <span class="mi">0</span>   <span class="c">! Increment based on Max Number of Vertices in surfaces</span>
<a name="ln-99"></a>          <span class="c">! The following variable should be re-engineered to lower in module hierarchy but need more analysis</span>
<a name="ln-100"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NVS</span>    <span class="c">! Number of vertices of the shadow/clipped surface</span>
<a name="ln-101"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumVertInShadowOrClippedSurface</span>
<a name="ln-102"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CurrentSurfaceBeingShadowed</span>
<a name="ln-103"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">CurrentShadowingSurface</span>
<a name="ln-104"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">OverlapStatus</span> <span class="c">! Results of overlap calculation:</span>
<a name="ln-105"></a>             <span class="c">! 1=No overlap; 2=NS1 completely within NS2</span>
<a name="ln-106"></a>             <span class="c">! 3=NS2 completely within NS1; 4=Partial overlap</span>
<a name="ln-107"></a>
<a name="ln-108"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>       <span class="kd">::</span> <span class="n">CTHETA</span> <span class="c">! Cosine of angle of incidence of sun&#39;s rays on surface NS</span>
<a name="ln-109"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FBKSHC</span> <span class="c">! HC location of first back surface</span>
<a name="ln-110"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FGSSHC</span> <span class="c">! HC location of first general shadowing surface</span>
<a name="ln-111"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FINSHC</span> <span class="c">! HC location of first back surface overlap</span>
<a name="ln-112"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FRVLHC</span> <span class="c">! HC location of first reveal surface</span>
<a name="ln-113"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">FSBSHC</span> <span class="c">! HC location of first subsurface</span>
<a name="ln-114"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">LOCHCA</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Location of highest data in the HC arrays</span>
<a name="ln-115"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NBKSHC</span> <span class="c">! Number of back surfaces in the HC arrays</span>
<a name="ln-116"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NGSSHC</span> <span class="c">! Number of general shadowing surfaces in the HC arrays</span>
<a name="ln-117"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NINSHC</span> <span class="c">! Number of back surface overlaps in the HC arrays</span>
<a name="ln-118"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NRVLHC</span> <span class="c">! Number of reveal surfaces in HC array</span>
<a name="ln-119"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NSBSHC</span> <span class="c">! Number of subsurfaces in the HC arrays</span>
<a name="ln-120"></a><span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">CalcSkyDifShading</span>  <span class="c">! True when sky diffuse solar shading is</span>
<a name="ln-121"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShadowingCalcFrequency</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Frequency for Shadowing Calculations</span>
<a name="ln-122"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">ShadowingDaysLeft</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Days left in current shadowing period</span>
<a name="ln-123"></a><span class="kt">LOGICAL</span>   <span class="kd">::</span> <span class="n">debugging</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-124"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">OutputFileShading</span>
<a name="ln-125"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>        <span class="kd">::</span> <span class="n">HCNS</span>   <span class="c">! Surface number of back surface HC figures</span>
<a name="ln-126"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>        <span class="kd">::</span> <span class="n">HCNV</span>   <span class="c">! Number of vertices of each HC figure</span>
<a name="ln-127"></a><span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">HCA</span>    <span class="c">! &#39;A&#39; homogeneous coordinates of sides</span>
<a name="ln-128"></a><span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">HCB</span>    <span class="c">! &#39;B&#39; homogeneous coordinates of sides</span>
<a name="ln-129"></a><span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">HCC</span>    <span class="c">! &#39;C&#39; homogeneous coordinates of sides</span>
<a name="ln-130"></a><span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">HCX</span>    <span class="c">! &#39;X&#39; homogeneous coordinates of vertices of figure.</span>
<a name="ln-131"></a><span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:)</span> <span class="kd">::</span> <span class="n">HCY</span>    <span class="c">! &#39;Y&#39; homogeneous coordinates of vertices of figure.</span>
<a name="ln-132"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:)</span>    <span class="kd">::</span> <span class="n">WindowRevealStatus</span>
<a name="ln-133"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">HCAREA</span> <span class="c">! Area of each HC figure.  Sign Convention:  Base Surface</span>
<a name="ln-134"></a>                                               <span class="c">! - Positive, Shadow - Negative, Overlap between two shadows</span>
<a name="ln-135"></a>                                               <span class="c">! - positive, etc., so that sum of HC areas=base sunlit area</span>
<a name="ln-136"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>       <span class="kd">::</span> <span class="n">HCT</span>    <span class="c">! Transmittance of each HC figure</span>
<a name="ln-137"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>       <span class="kd">::</span> <span class="n">ISABSF</span> <span class="c">! For simple interior solar distribution (in which all beam</span>
<a name="ln-138"></a>                                                     <span class="c">! radiation entering zone is assumed to strike the floor),</span>
<a name="ln-139"></a>                                                     <span class="c">! fraction of beam radiation absorbed by each floor surface</span>
<a name="ln-140"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>       <span class="kd">::</span> <span class="n">SAREA</span>  <span class="c">! Sunlit area of heat transfer surface HTS</span>
<a name="ln-141"></a>                                                     <span class="c">! Excludes multiplier for windows</span>
<a name="ln-142"></a><span class="c">! Shadowing combinations data structure...See ShadowingCombinations type</span>
<a name="ln-143"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceErrorTracking</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>         <span class="kd">::</span> <span class="n">TrackTooManyFigures</span>
<a name="ln-144"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumTooManyFigures</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-145"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceErrorTracking</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>         <span class="kd">::</span> <span class="n">TrackTooManyVertices</span>
<a name="ln-146"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumTooManyVertices</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-147"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceErrorTracking</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>         <span class="kd">::</span> <span class="n">TrackBaseSubSurround</span>
<a name="ln-148"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumBaseSubSurround</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-149"></a><span class="k">TYPE</span> <span class="p">(</span><span class="n">SurfaceErrorTracking</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>         <span class="kd">::</span> <span class="n">TempSurfErrorTracking</span>
<a name="ln-150"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SUNCOS</span> <span class="c">! Direction cosines of solar position</span>
<a name="ln-151"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">XShadowProjection</span>  <span class="c">! X projection of a shadow (formerly called C)</span>
<a name="ln-152"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">YShadowProjection</span>  <span class="c">! Y projection of a shadow (formerly called S)</span>
<a name="ln-153"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XTEMP</span>  <span class="c">! Temporary &#39;X&#39; values for HC vertices of the overlap</span>
<a name="ln-154"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XVC</span>    <span class="c">! X-vertices of the clipped figure</span>
<a name="ln-155"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XVS</span>    <span class="c">! X-vertices of the shadow</span>
<a name="ln-156"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YTEMP</span>  <span class="c">! Temporary &#39;Y&#39; values for HC vertices of the overlap</span>
<a name="ln-157"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YVC</span>    <span class="c">! Y-vertices of the clipped figure</span>
<a name="ln-158"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YVS</span>    <span class="c">! Y-vertices of the shadow</span>
<a name="ln-159"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZVC</span>    <span class="c">! Z-vertices of the clipped figure</span>
<a name="ln-160"></a><span class="c">! Used in Sutherland Hodman poly clipping</span>
<a name="ln-161"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ATEMP</span>    <span class="c">! Temporary &#39;A&#39; values for HC vertices of the overlap</span>
<a name="ln-162"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">BTEMP</span>    <span class="c">! Temporary &#39;B&#39; values for HC vertices of the overlap</span>
<a name="ln-163"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CTEMP</span>    <span class="c">! Temporary &#39;C&#39; values for HC vertices of the overlap</span>
<a name="ln-164"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XTEMP1</span>   <span class="c">! Temporary &#39;X&#39; values for HC vertices of the overlap</span>
<a name="ln-165"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YTEMP1</span>   <span class="c">! Temporary &#39;Y&#39; values for HC vertices of the overlap</span>
<a name="ln-166"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">PUBLIC</span> <span class="kd">::</span> <span class="n">maxNumberOfFigures</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-167"></a>
<a name="ln-168"></a>          <span class="c">! SUBROUTINE SPECIFICATIONS FOR MODULE SolarShading</span>
<a name="ln-169"></a>
<a name="ln-170"></a><span class="k">PUBLIC  </span><span class="n">InitSolarCalculations</span>
<a name="ln-171"></a><span class="k">PRIVATE </span><span class="n">AllocateModuleArrays</span>
<a name="ln-172"></a><span class="k">PUBLIC  </span><span class="n">AnisoSkyViewFactors</span>
<a name="ln-173"></a><span class="k">PRIVATE </span><span class="n">CHKBKS</span>
<a name="ln-174"></a><span class="k">PRIVATE </span><span class="n">CHKGSS</span>
<a name="ln-175"></a><span class="k">PRIVATE </span><span class="n">CHKSBS</span>
<a name="ln-176"></a><span class="k">PRIVATE </span><span class="n">ComputeIntSolarAbsorpFactors</span>
<a name="ln-177"></a><span class="k">PRIVATE </span><span class="n">CLIP</span>
<a name="ln-178"></a><span class="k">PRIVATE </span><span class="n">CTRANS</span>
<a name="ln-179"></a><span class="k">PRIVATE </span><span class="n">HTRANS</span>
<a name="ln-180"></a><span class="k">PRIVATE </span><span class="n">HTRANS0</span>
<a name="ln-181"></a><span class="k">PRIVATE </span><span class="n">HTRANS1</span>
<a name="ln-182"></a><span class="k">PRIVATE </span><span class="n">INCLOS</span>
<a name="ln-183"></a><span class="k">PRIVATE </span><span class="n">INTCPT</span>
<a name="ln-184"></a><span class="k">PRIVATE </span><span class="n">CLIPPOLY</span>
<a name="ln-185"></a><span class="k">PRIVATE </span><span class="n">MULTOL</span>
<a name="ln-186"></a><span class="k">PRIVATE </span><span class="n">ORDER</span>
<a name="ln-187"></a><span class="k">PRIVATE </span><span class="n">DeterminePolygonOverlap</span>
<a name="ln-188"></a><span class="k">PRIVATE </span><span class="n">CalcPerSolarBeam</span>
<a name="ln-189"></a><span class="k">PRIVATE </span><span class="n">DetermineShadowingCombinations</span>
<a name="ln-190"></a><span class="k">PRIVATE </span><span class="n">GetShadowingInput</span>
<a name="ln-191"></a><span class="k">PRIVATE </span><span class="n">SHADOW</span>
<a name="ln-192"></a><span class="k">PRIVATE </span><span class="n">SHDBKS</span>
<a name="ln-193"></a><span class="k">PRIVATE </span><span class="n">SHDGSS</span>
<a name="ln-194"></a><span class="k">PRIVATE </span><span class="n">SHDRVL</span>
<a name="ln-195"></a><span class="k">PRIVATE </span><span class="n">SHDSBS</span>
<a name="ln-196"></a><span class="k">PUBLIC  </span><span class="n">PerformSolarCalculations</span>
<a name="ln-197"></a><span class="k">PRIVATE </span><span class="n">SUN3</span>
<a name="ln-198"></a><span class="k">PRIVATE </span><span class="n">SUN4</span>
<a name="ln-199"></a><span class="k">PRIVATE </span><span class="n">CalcWinTransDifSolInitialDistribution</span>
<a name="ln-200"></a><span class="k">PRIVATE </span><span class="n">CalcComplexWindowOverlap</span>
<a name="ln-201"></a><span class="k">PUBLIC  </span><span class="n">TimestepInitComplexFenestration</span>
<a name="ln-202"></a><span class="k">PUBLIC  </span><span class="n">CalcInteriorSolarDistribution</span>
<a name="ln-203"></a><span class="k">PUBLIC  </span><span class="n">CalcBeamSolarOnWinRevealSurface</span>
<a name="ln-204"></a><span class="k">PUBLIC  </span><span class="n">CalcWindowProfileAngles</span>
<a name="ln-205"></a><span class="k">PUBLIC  </span><span class="n">WindowShadingManager</span>
<a name="ln-206"></a><span class="k">PUBLIC  </span><span class="n">WindowGapAirflowControl</span>
<a name="ln-207"></a><span class="k">PUBLIC  </span><span class="n">ReportSurfaceShading</span>
<a name="ln-208"></a><span class="k">PUBLIC  </span><span class="n">ReportSurfaceErrors</span>
<a name="ln-209"></a><span class="k">PRIVATE </span><span class="n">FigureSunCosines</span>
<a name="ln-210"></a><span class="k">PUBLIC  </span><span class="n">SurfaceScheduledSolarInc</span>
<a name="ln-211"></a><span class="k">PUBLIC  </span><span class="n">WindowScheduledSolarAbs</span>
<a name="ln-212"></a>
<a name="ln-213"></a><span class="k">CONTAINS</span>
<a name="ln-214"></a>
<a name="ln-215"></a>          <span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-216"></a>
<a name="ln-217"></a><span class="k">SUBROUTINE </span><span class="n">InitSolarCalculations</span>
<a name="ln-218"></a>
<a name="ln-219"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-220"></a>          <span class="c">!       AUTHOR         George Walton</span>
<a name="ln-221"></a>          <span class="c">!       DATE WRITTEN   September 1977</span>
<a name="ln-222"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-223"></a>          <span class="c">!       RE-ENGINEERED  Mar97, RKS, Initial EnergyPlus Version</span>
<a name="ln-224"></a>
<a name="ln-225"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-226"></a>          <span class="c">! This routine controls the computation of the solar flux multipliers.</span>
<a name="ln-227"></a>
<a name="ln-228"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-229"></a>          <span class="c">! All shadowing calculations have been grouped under this routine to</span>
<a name="ln-230"></a>          <span class="c">! allow segmentation separating it from the hourly loads calculation.</span>
<a name="ln-231"></a>
<a name="ln-232"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-233"></a>          <span class="c">! na</span>
<a name="ln-234"></a>
<a name="ln-235"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-236"></a>          <span class="c">! na</span>
<a name="ln-237"></a>
<a name="ln-238"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-239"></a>
<a name="ln-240"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-241"></a>          <span class="c">! na</span>
<a name="ln-242"></a>
<a name="ln-243"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-244"></a>          <span class="c">! na</span>
<a name="ln-245"></a>
<a name="ln-246"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-247"></a>          <span class="c">! na</span>
<a name="ln-248"></a>
<a name="ln-249"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-250"></a>
<a name="ln-251"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-252"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">EXTERNAL</span> <span class="kd">::</span> <span class="n">GetNewUnitNumber</span>
<a name="ln-253"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">firsttime</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-254"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">write_stat</span>
<a name="ln-255"></a>
<a name="ln-256"></a>          <span class="c">! FLOW:</span>
<a name="ln-257"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-258"></a>  <span class="n">NumInitSolar_Calls</span><span class="o">=</span><span class="n">NumInitSolar_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-259"></a><span class="cp">#endif</span>
<a name="ln-260"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-261"></a>
<a name="ln-262"></a><span class="k">    </span><span class="n">OutputFileShading</span><span class="o">=</span><span class="n">GetNewUnitNumber</span><span class="p">()</span>
<a name="ln-263"></a>    <span class="k">OPEN</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="k">FILE</span><span class="o">=</span><span class="s1">&#39;eplusout.shd&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="o">=</span><span class="s1">&#39;write&#39;</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">write_stat</span><span class="p">)</span>
<a name="ln-264"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">write_stat</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-265"></a><span class="k">     CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitSolarCalculations: Could not open file &quot;eplustbl.shd&quot; for output (write).&#39;</span><span class="p">)</span>
<a name="ln-266"></a>    <span class="n">ENDIF</span>
<a name="ln-267"></a>
<a name="ln-268"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-269"></a><span class="k">      CALL </span><span class="n">GetShadowingInput</span>
<a name="ln-270"></a>      <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-271"></a>      <span class="n">MAXHCV</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-272"></a>    <span class="n">ENDIF</span>
<a name="ln-273"></a>
<a name="ln-274"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Allocate Solar Module Arrays&#39;</span><span class="p">)</span>
<a name="ln-275"></a>    <span class="k">CALL </span><span class="n">AllocateModuleArrays</span>
<a name="ln-276"></a>
<a name="ln-277"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SolarDistribution</span> <span class="o">/=</span>  <span class="n">FullInteriorExterior</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-278"></a><span class="k">      if</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Computing Interior Solar Absorption Factors&#39;</span><span class="p">)</span>
<a name="ln-279"></a>      <span class="k">CALL </span><span class="n">ComputeIntSolarAbsorpFactors</span>
<a name="ln-280"></a>    <span class="n">ENDIF</span>
<a name="ln-281"></a>
<a name="ln-282"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Determining Shadowing Combinations&#39;</span><span class="p">)</span>
<a name="ln-283"></a>    <span class="k">CALL </span><span class="n">DetermineShadowingCombinations</span>
<a name="ln-284"></a>
<a name="ln-285"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Computing Window Shade Absorption Factors&#39;</span><span class="p">)</span>
<a name="ln-286"></a>    <span class="k">CALL </span><span class="n">ComputeWinShadeAbsorpFactors</span>
<a name="ln-287"></a>
<a name="ln-288"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-289"></a><span class="k">      CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Initializing Solar Reflection Factors&#39;</span><span class="p">)</span>
<a name="ln-290"></a>      <span class="k">CALL </span><span class="n">InitSolReflRecSurf</span>
<a name="ln-291"></a>    <span class="n">ENDIF</span>
<a name="ln-292"></a>
<a name="ln-293"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">firsttime</span><span class="p">)</span> <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Proceeding with Initializing Solar Calculations&#39;</span><span class="p">)</span>
<a name="ln-294"></a>
<a name="ln-295"></a>  <span class="k">END IF</span>
<a name="ln-296"></a>
<a name="ln-297"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-298"></a><span class="k">    </span><span class="n">CTHETA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-299"></a>    <span class="n">SAREA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-300"></a>    <span class="n">SurfSunLitArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-301"></a>    <span class="n">SurfSunLitFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-302"></a>    <span class="n">SunlitFracHR</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-303"></a>    <span class="n">SunlitFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-304"></a>    <span class="n">SunlitFracWithoutReveal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-305"></a>    <span class="n">BackSurfaces</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-306"></a>    <span class="n">OverlapAreas</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-307"></a>    <span class="n">CosIncAngHR</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-308"></a>    <span class="n">CosIncAng</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-309"></a>    <span class="n">AnisoSkyMult</span> <span class="o">=</span> <span class="mf">1.0d0</span>   <span class="c">!For isotropic sky; recalculated in AnisoSkyViewFactors if anisotropic radiance</span>
<a name="ln-310"></a><span class="c">!    WithShdgIsoSky=0.0</span>
<a name="ln-311"></a><span class="c">!    WoShdgIsoSky=0.0</span>
<a name="ln-312"></a><span class="c">!    WithShdgHoriz=0.0</span>
<a name="ln-313"></a><span class="c">!    WoShdgHoriz=0.0</span>
<a name="ln-314"></a><span class="c">!    DifShdgRatioIsoSky=0.0</span>
<a name="ln-315"></a><span class="c">!    DifShdgRatioHoriz=0.0</span>
<a name="ln-316"></a>    <span class="n">MultIsoSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-317"></a>    <span class="n">MultCircumSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-318"></a>    <span class="n">MultHorizonZenith</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-319"></a>    <span class="n">WinTransSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-320"></a>    <span class="n">WinBmSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-321"></a>    <span class="n">WinBmBmSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-322"></a>    <span class="n">WinBmDifSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-323"></a>
<a name="ln-324"></a>    <span class="n">WinDifSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-325"></a>    <span class="n">WinDirSolTransAtIncAngle</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-326"></a>    <span class="n">WinHeatGain</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-327"></a>    <span class="n">WinHeatGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-328"></a>    <span class="n">WinHeatLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-329"></a>    <span class="n">WinGainConvGlazToZoneRep</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-330"></a>    <span class="n">WinGainIRGlazToZoneRep</span>          <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-331"></a>    <span class="n">WinLossSWZoneToOutWinRep</span>        <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-332"></a>    <span class="n">WinGainFrameDividerToZoneRep</span>    <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-333"></a>    <span class="n">WinGainConvGlazShadGapToZoneRep</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-334"></a>    <span class="n">WinGainConvShadeToZoneRep</span>       <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-335"></a>    <span class="n">OtherConvGainInsideFaceToZoneRep</span><span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-336"></a>    <span class="n">WinGainIRShadeToZoneRep</span>         <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-337"></a>    <span class="n">WinGapConvHtFlowRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-338"></a>    <span class="n">WinShadingAbsorbedSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-339"></a>    <span class="n">WinSysSolTransmittance</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-340"></a>    <span class="n">WinSysSolReflectance</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-341"></a>    <span class="n">WinSysSolAbsorptance</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-342"></a>    <span class="n">InsideGlassCondensationFlag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-343"></a>    <span class="n">InsideFrameCondensationFlag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-344"></a>    <span class="n">InsideDividerCondensationFlag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-345"></a>    <span class="n">ZoneTransSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-346"></a>    <span class="n">ZoneBmSolFrExtWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-347"></a>    <span class="n">ZoneBmSolFrIntWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-348"></a>    <span class="n">InitialZoneDifSolReflW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-349"></a>    <span class="n">ZoneDifSolFrExtWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-350"></a>    <span class="n">ZoneDifSolFrIntWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-351"></a>    <span class="n">ZoneWinHeatGain</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-352"></a>    <span class="n">ZoneWinHeatGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-353"></a>    <span class="n">ZoneWinHeatLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-354"></a>    <span class="n">ZoneOpaqSurfInsFaceCond</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-355"></a>    <span class="n">ZoneOpaqSurfInsFaceCondGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-356"></a>    <span class="n">ZoneOpaqSurfInsFaceCondLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-357"></a>    <span class="n">QRadSWOutIncident</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-358"></a>    <span class="n">QRadSWOutIncidentBeam</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-359"></a>    <span class="n">BmIncInsSurfIntensRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-360"></a>    <span class="n">BmIncInsSurfAmountRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-361"></a><span class="c">!    DifIncInsSurfIntensRep=0.0</span>
<a name="ln-362"></a><span class="c">!    DifIncInsSurfAmountRep=0.0</span>
<a name="ln-363"></a>    <span class="n">IntBmIncInsSurfIntensRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-364"></a>    <span class="n">IntBmIncInsSurfAmountRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-365"></a><span class="c">!    IntDifIncInsSurfIntensRep=0.0</span>
<a name="ln-366"></a><span class="c">!    IntDifIncInsSurfAmountRep=0.0</span>
<a name="ln-367"></a>    <span class="n">QRadSWOutIncidentSkyDiffuse</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-368"></a>    <span class="n">QRadSWOutIncidentGndDiffuse</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-369"></a>    <span class="n">QRadSWOutIncBmToDiffReflGnd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-370"></a>    <span class="n">QRadSWOutIncSkyDiffReflGnd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-371"></a>    <span class="n">QRadSWOutIncBmToBmReflObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-372"></a>    <span class="n">QRadSWOutIncBmToDiffReflObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-373"></a>    <span class="n">QRadSWOutIncSkyDiffReflObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-374"></a>    <span class="n">CosIncidenceAngle</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-375"></a>    <span class="n">QRadSWwinAbsTot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-376"></a>    <span class="n">SWwinAbsTotalReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-377"></a>    <span class="n">InitialDifSolInAbsReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-378"></a>    <span class="n">InitialDifSolInTransReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-379"></a>    <span class="n">SWInAbsTotalReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-380"></a>    <span class="n">WindowRevealStatus</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-381"></a>    <span class="c">!energy</span>
<a name="ln-382"></a>    <span class="n">WinTransSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-383"></a>    <span class="n">WinBmSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-384"></a>    <span class="n">WinBmBmSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-385"></a>    <span class="n">WinBmDifSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-386"></a>
<a name="ln-387"></a>    <span class="n">WinDifSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-388"></a>    <span class="n">WinHeatGainRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-389"></a>    <span class="n">WinHeatLossRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-390"></a>    <span class="n">WinGapConvHtFlowRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-391"></a>    <span class="n">WinShadingAbsorbedSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-392"></a>    <span class="n">ZoneTransSolarEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-393"></a>    <span class="n">ZoneBmSolFrExtWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-394"></a>    <span class="n">ZoneBmSolFrIntWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-395"></a>    <span class="n">ZoneDifSolFrExtWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-396"></a>    <span class="n">ZoneDifSolFrIntWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-397"></a>    <span class="n">ZoneWinHeatGainRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-398"></a>    <span class="n">ZoneWinHeatLossRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-399"></a>    <span class="n">ZnOpqSurfInsFaceCondGnRepEnrg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-400"></a>    <span class="n">ZnOpqSurfInsFaceCondLsRepEnrg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-401"></a>    <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-402"></a><span class="c">!    DifIncInsSurfAmountRepEnergy=0.0</span>
<a name="ln-403"></a>    <span class="n">IntBmIncInsSurfAmountRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-404"></a><span class="c">!    IntDifIncInsSurfAmountRepEnergy=0.0</span>
<a name="ln-405"></a>    <span class="n">QRadSWwinAbsTotEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-406"></a>
<a name="ln-407"></a>  <span class="n">ENDIF</span>
<a name="ln-408"></a>
<a name="ln-409"></a>  <span class="n">firsttime</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-410"></a>
<a name="ln-411"></a>  <span class="k">RETURN</span>    <span class="c">! Normal subroutine end</span>
<a name="ln-412"></a>
<a name="ln-413"></a><span class="k">END SUBROUTINE </span><span class="n">InitSolarCalculations</span>
<a name="ln-414"></a>
<a name="ln-415"></a><span class="k">SUBROUTINE </span><span class="n">GetShadowingInput</span>
<a name="ln-416"></a>
<a name="ln-417"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-418"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-419"></a>          <span class="c">!       DATE WRITTEN   July 1999</span>
<a name="ln-420"></a>          <span class="c">!       MODIFIED       B. Griffith, Nov 2012, add calculaton method</span>
<a name="ln-421"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-422"></a>
<a name="ln-423"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-424"></a>          <span class="c">! This subroutine gets the Shadowing Calculation object.</span>
<a name="ln-425"></a>
<a name="ln-426"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-427"></a>          <span class="c">! na</span>
<a name="ln-428"></a>
<a name="ln-429"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-430"></a>          <span class="c">! na</span>
<a name="ln-431"></a>
<a name="ln-432"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-433"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span><span class="n">GetObjectItem</span><span class="p">,</span><span class="n">SameString</span>
<a name="ln-434"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-435"></a>  <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-436"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SutherlandHodgman</span><span class="p">,</span><span class="n">DetailedSkyDiffuseAlgorithm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-437"></a>                                 <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-438"></a>
<a name="ln-439"></a>
<a name="ln-440"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-441"></a>
<a name="ln-442"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-443"></a>          <span class="c">! na</span>
<a name="ln-444"></a>
<a name="ln-445"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-446"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmta</span><span class="o">=</span><span class="s2">&quot;(A)&quot;</span>
<a name="ln-447"></a>
<a name="ln-448"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-449"></a>          <span class="c">! na</span>
<a name="ln-450"></a>
<a name="ln-451"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-452"></a>          <span class="c">! na</span>
<a name="ln-453"></a>
<a name="ln-454"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-455"></a>  <span class="kt">INTEGER </span><span class="n">NumItems</span>
<a name="ln-456"></a>  <span class="kt">INTEGER </span><span class="n">NumNumbers</span>
<a name="ln-457"></a>  <span class="kt">INTEGER </span><span class="n">NumAlphas</span>
<a name="ln-458"></a>  <span class="kt">INTEGER </span><span class="n">IOStat</span>
<a name="ln-459"></a>
<a name="ln-460"></a>  <span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>  <span class="c">! so if nothing gotten, defaults will be maintained.</span>
<a name="ln-461"></a>  <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-462"></a>  <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-463"></a>  <span class="n">cCurrentModuleObject</span><span class="o">=</span><span class="s1">&#39;ShadowCalculation&#39;</span>
<a name="ln-464"></a>  <span class="n">NumItems</span><span class="o">=</span><span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span>
<a name="ln-465"></a>  <span class="n">NumAlphas</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-466"></a>  <span class="n">NumNumbers</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-467"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumItems</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-468"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: More than 1 occurence of this object found, only first will be used.&#39;</span><span class="p">)</span>
<a name="ln-469"></a>  <span class="n">ENDIF</span>
<a name="ln-470"></a>
<a name="ln-471"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumItems</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-472"></a><span class="k">    CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cAlphaArgs</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">rNumericArgs</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStat</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-473"></a>                   <span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaFieldBlanks</span><span class="p">,</span><span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericFieldBlanks</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-474"></a>                   <span class="n">AlphaFieldnames</span><span class="o">=</span><span class="n">cAlphaFieldNames</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFieldNames</span><span class="p">)</span>
<a name="ln-475"></a>    <span class="n">ShadowingCalcFrequency</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-476"></a>  <span class="n">ENDIF</span>
<a name="ln-477"></a>
<a name="ln-478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowingCalcFrequency</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-479"></a>    <span class="c">!  Set to default value</span>
<a name="ln-480"></a>    <span class="n">ShadowingCalcFrequency</span><span class="o">=</span><span class="mi">20</span>
<a name="ln-481"></a>  <span class="n">ENDIF</span>
<a name="ln-482"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowingCalcFrequency</span> <span class="o">&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-483"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: suspect &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-484"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value entered=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-485"></a>       <span class="s1">&#39;], Shadowing Calculations will be inaccurate.&#39;</span><span class="p">)</span>
<a name="ln-486"></a>  <span class="n">ENDIF</span>
<a name="ln-487"></a>
<a name="ln-488"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="mf">9.d0</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-489"></a><span class="k">    </span><span class="n">MAXHCS</span><span class="o">=</span><span class="n">rNumericArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-490"></a>  <span class="k">ELSE</span>
<a name="ln-491"></a><span class="k">    </span><span class="n">MAXHCS</span><span class="o">=</span><span class="mi">15000</span>
<a name="ln-492"></a>  <span class="n">ENDIF</span>
<a name="ln-493"></a>
<a name="ln-494"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-495"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;AverageOverDaysInFrequency&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-496"></a><span class="k">      </span><span class="n">DetailedSolarTimestepIntegration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-497"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;AverageOverDaysInFrequency&#39;</span>
<a name="ln-498"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;TimestepFrequency&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-499"></a><span class="k">      </span><span class="n">DetailedSolarTimestepIntegration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-500"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;TimestepFrequency&#39;</span>
<a name="ln-501"></a>    <span class="k">ELSE</span>
<a name="ln-502"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-503"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value entered=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, AverageOverDaysInFrequency will be used.&#39;</span><span class="p">)</span>
<a name="ln-504"></a>      <span class="n">DetailedSolarTimestepIntegration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-505"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;AverageOverDaysInFrequency&#39;</span>
<a name="ln-506"></a>    <span class="n">ENDIF</span>
<a name="ln-507"></a>  <span class="k">ELSE</span>
<a name="ln-508"></a><span class="k">    </span><span class="n">DetailedSolarTimestepIntegration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-509"></a>    <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;AverageOverDaysInFrequency&#39;</span>
<a name="ln-510"></a>  <span class="n">ENDIF</span>
<a name="ln-511"></a>
<a name="ln-512"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-513"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;SutherlandHodgman&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-514"></a><span class="k">      </span><span class="n">SutherlandHodgman</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-515"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;SutherlandHodgman&#39;</span>
<a name="ln-516"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;ConvexWeilerAtherton&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-517"></a><span class="k">      </span><span class="n">SutherlandHodgman</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-518"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;ConvexWeilerAtherton&#39;</span>
<a name="ln-519"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-520"></a><span class="k">      IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SutherlandHodgman</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! if already set.</span>
<a name="ln-521"></a>        <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;ConvexWeilerAtherton&#39;</span>
<a name="ln-522"></a>      <span class="k">ELSE</span>
<a name="ln-523"></a><span class="k">        </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;SutherlandHodgman&#39;</span>
<a name="ln-524"></a>      <span class="n">ENDIF</span>
<a name="ln-525"></a>    <span class="k">ELSE</span>
<a name="ln-526"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-527"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SutherlandHodgman</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-528"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value entered=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, ConvexWeilerAtherton will be used.&#39;</span><span class="p">)</span>
<a name="ln-529"></a>      <span class="k">ELSE</span>
<a name="ln-530"></a><span class="k">        CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value entered=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, SutherlandHodgman will be used.&#39;</span><span class="p">)</span>
<a name="ln-531"></a>      <span class="n">ENDIF</span>
<a name="ln-532"></a>    <span class="n">ENDIF</span>
<a name="ln-533"></a>  <span class="k">ELSE</span>
<a name="ln-534"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SutherlandHodgman</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-535"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;ConvexWeilerAtherton&#39;</span>
<a name="ln-536"></a>    <span class="k">ELSE</span>
<a name="ln-537"></a><span class="k">      </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;SutherlandHodgman&#39;</span>
<a name="ln-538"></a>    <span class="n">ENDIF</span>
<a name="ln-539"></a>  <span class="n">ENDIF</span>
<a name="ln-540"></a>
<a name="ln-541"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-542"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;SimpleSkyDiffuseModeling&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-543"></a><span class="k">      </span><span class="n">DetailedSkyDiffuseAlgorithm</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-544"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;SimpleSkyDiffuseModeling&#39;</span>
<a name="ln-545"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="s1">&#39;DetailedSkyDiffuseModeling&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-546"></a><span class="k">      </span><span class="n">DetailedSkyDiffuseAlgorithm</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-547"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DetailedSkyDiffuseModeling&#39;</span>
<a name="ln-548"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaFieldBlanks</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-549"></a><span class="k">      </span><span class="n">DetailedSkyDiffuseAlgorithm</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-550"></a>      <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;SimpleSkyDiffuseModeling&#39;</span>
<a name="ln-551"></a>    <span class="k">ELSE</span>
<a name="ln-552"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;: invalid &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaFieldNames</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<a name="ln-553"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Value entered=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;, SimpleSkyDiffuseModeling will be used.&#39;</span><span class="p">)</span>
<a name="ln-554"></a>    <span class="n">ENDIF</span>
<a name="ln-555"></a>  <span class="k">ELSE</span>
<a name="ln-556"></a><span class="k">    </span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;SimpleSkyDiffuseModeling&#39;</span>
<a name="ln-557"></a>    <span class="n">DetailedSkyDiffuseAlgorithm</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-558"></a>  <span class="n">ENDIF</span>
<a name="ln-559"></a>
<a name="ln-560"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-561"></a>      <span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-562"></a><span class="k">    CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetShadowingInput: The shading transmittance for shading devices changes throughout the year.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-563"></a>       <span class="s1">&#39; Choose DetailedSkyDiffuseModeling in the &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object to remove this warning.&#39;</span><span class="p">)</span>
<a name="ln-564"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Simulation has been reset to use DetailedSkyDiffuseModeling. Simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-565"></a>    <span class="n">DetailedSkyDiffuseAlgorithm</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-566"></a>    <span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;DetailedSkyDiffuseModeling&#39;</span>
<a name="ln-567"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowingCalcFrequency</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-568"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Better accuracy may be gained by setting the &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cNumericFieldNames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span>   <span class="p">&amp;</span>
<a name="ln-569"></a>         <span class="s1">&#39; to 1 in the &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; object.&#39;</span><span class="p">)</span>
<a name="ln-570"></a>    <span class="n">ENDIF</span>
<a name="ln-571"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DetailedSkyDiffuseAlgorithm</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-572"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-573"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;GetShadowingInput: DetailedSkyDiffuseModeling is chosen but not needed as&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-574"></a>          <span class="s1">&#39; either the shading transmittance for shading devices does not change throughout the year&#39;</span><span class="p">)</span>
<a name="ln-575"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; or MinimalShadowing has been chosen.&#39;</span><span class="p">)</span>
<a name="ln-576"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Simulation should be set to use SimpleSkyDiffuseModeling, but is left at Detailed for simulation.&#39;</span><span class="p">)</span>
<a name="ln-577"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Choose SimpleSkyDiffuseModeling in the &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cCurrentModuleObject</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-578"></a>         <span class="s1">&#39; object to reduce computation time.&#39;</span><span class="p">)</span>
<a name="ln-579"></a>    <span class="n">ENDIF</span>
<a name="ln-580"></a>  <span class="n">ENDIF</span>
<a name="ln-581"></a>
<a name="ln-582"></a>
<a name="ln-583"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;! &lt;Shadowing/Sun Position Calculations&gt; [Annual Simulations], Calculation Method,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-584"></a>     <span class="s1">&#39;Value {days}, Allowable Number Figures in Shadow Overlap {}, Polygon Clipping Algorithm, &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-585"></a>     <span class="s1">&#39;Sky Diffuse Modeling Algorithm&#39;</span>
<a name="ln-586"></a>  <span class="k">Write</span><span class="p">(</span><span class="n">OutputFileInits</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;Shadowing/Sun Position Calculations,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-587"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-588"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">ShadowingCalcFrequency</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-589"></a>                                <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MAXHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-590"></a>                                <span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;,&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cAlphaArgs</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-591"></a>
<a name="ln-592"></a>
<a name="ln-593"></a>  <span class="k">RETURN</span>
<a name="ln-594"></a>
<a name="ln-595"></a><span class="k">END SUBROUTINE </span><span class="n">GetShadowingInput</span>
<a name="ln-596"></a>
<a name="ln-597"></a><span class="k">SUBROUTINE </span><span class="n">AllocateModuleArrays</span>
<a name="ln-598"></a>
<a name="ln-599"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-600"></a>          <span class="c">!       AUTHOR         Rick Strand</span>
<a name="ln-601"></a>          <span class="c">!       DATE WRITTEN   February 1998</span>
<a name="ln-602"></a>          <span class="c">!       MODIFIED       August 2005 JG - Added output variables for energy in J</span>
<a name="ln-603"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-604"></a>
<a name="ln-605"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-606"></a>          <span class="c">! This routine allocates all of the arrays at the module level which</span>
<a name="ln-607"></a>          <span class="c">! require allocation.</span>
<a name="ln-608"></a>
<a name="ln-609"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-610"></a>          <span class="c">! Allocation is dependent on the user input file.</span>
<a name="ln-611"></a>
<a name="ln-612"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-613"></a>          <span class="c">! na</span>
<a name="ln-614"></a>
<a name="ln-615"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-616"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-617"></a>
<a name="ln-618"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-619"></a>
<a name="ln-620"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-621"></a>          <span class="c">! na</span>
<a name="ln-622"></a>
<a name="ln-623"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-624"></a>          <span class="c">! na</span>
<a name="ln-625"></a>
<a name="ln-626"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-627"></a>          <span class="c">! na</span>
<a name="ln-628"></a>
<a name="ln-629"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-630"></a>  <span class="kt">INTEGER </span><span class="n">SurfLoop</span><span class="p">,</span> <span class="n">ZoneLoop</span>
<a name="ln-631"></a>  <span class="kt">INTEGER </span><span class="n">I</span><span class="p">,</span> <span class="n">MaxNumOfLayers</span><span class="p">,</span> <span class="n">NumOfLayers</span>
<a name="ln-632"></a>
<a name="ln-633"></a>          <span class="c">! FLOW:</span>
<a name="ln-634"></a>
<a name="ln-635"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CTHETA</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-636"></a>  <span class="n">CTHETA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-637"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-638"></a>  <span class="n">SAREA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-639"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfSunLitArea</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-640"></a>  <span class="n">SurfSunLitArea</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-641"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfSunLitFrac</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-642"></a>  <span class="n">SurfSunLitFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-643"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SunlitFracHR</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-644"></a>  <span class="n">SunlitFracHR</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-645"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SunlitFrac</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-646"></a>  <span class="n">SunlitFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-647"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SunlitFracWithoutReveal</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-648"></a>  <span class="n">SunlitFracWithoutReveal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-649"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BackSurfaces</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">MaxBkSurf</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-650"></a>  <span class="n">BackSurfaces</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-651"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">OverlapAreas</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">MaxBkSurf</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-652"></a>  <span class="n">OverlapAreas</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-653"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CosIncAngHR</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span>
<a name="ln-654"></a>  <span class="n">CosIncAngHR</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-655"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-656"></a>  <span class="n">CosIncAng</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-657"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-658"></a>  <span class="n">AnisoSkyMult</span> <span class="o">=</span> <span class="mf">1.0d0</span>  <span class="c">! For isotropic sky; recalculated in AnisoSkyViewFactors if anisotropic radiance</span>
<a name="ln-659"></a><span class="c">!  ALLOCATE (WithShdgIsoSky(TotSurfaces))</span>
<a name="ln-660"></a><span class="c">!  WithShdgIsoSky=0.0</span>
<a name="ln-661"></a><span class="c">!  ALLOCATE (WoShdgIsoSky(TotSurfaces))</span>
<a name="ln-662"></a><span class="c">!  WoShdgIsoSky=0.0</span>
<a name="ln-663"></a><span class="c">!  ALLOCATE (WithShdgHoriz(TotSurfaces))</span>
<a name="ln-664"></a><span class="c">!  WithShdgHoriz=0.0</span>
<a name="ln-665"></a><span class="c">!  ALLOCATE (WoShdgHoriz(TotSurfaces))</span>
<a name="ln-666"></a><span class="c">!  WoShdgHoriz=0.0</span>
<a name="ln-667"></a><span class="c">!  ALLOCATE (DifShdgRatioIsoSky(TotSurfaces))</span>
<a name="ln-668"></a><span class="c">!  DifShdgRatioIsoSky=0.0</span>
<a name="ln-669"></a><span class="c">!  ALLOCATE (DifShdgRatioHoriz(TotSurfaces))</span>
<a name="ln-670"></a><span class="c">!  DifShdgRatioHoriz=0.0</span>
<a name="ln-671"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MultIsoSky</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-672"></a>  <span class="n">MultIsoSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-673"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MultCircumSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-674"></a>  <span class="n">MultCircumSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-675"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">MultHorizonZenith</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-676"></a>  <span class="n">MultHorizonZenith</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-677"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinTransSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-678"></a>  <span class="n">WinTransSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-679"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinBmSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-680"></a>  <span class="n">WinBmSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-681"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinBmBmSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-682"></a>  <span class="n">WinBmBmSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-683"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinBmDifSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-684"></a>  <span class="n">WinBmDifSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-685"></a>
<a name="ln-686"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinDifSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-687"></a>  <span class="n">WinDifSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-688"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinDirSolTransAtIncAngle</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-689"></a>  <span class="n">WinDirSolTransAtIncAngle</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-690"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinHeatGain</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-691"></a>  <span class="n">WinHeatGain</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-692"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinHeatGainRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-693"></a>  <span class="n">WinHeatGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-694"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinHeatLossRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-695"></a>  <span class="n">WinHeatLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-696"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGainConvGlazToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-697"></a>  <span class="n">WinGainConvGlazToZoneRep</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-698"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGainIRGlazToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-699"></a>  <span class="n">WinGainIRGlazToZoneRep</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-700"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinLossSWZoneToOutWinRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-701"></a>  <span class="n">WinLossSWZoneToOutWinRep</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-702"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGainFrameDividerToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-703"></a>  <span class="n">WinGainFrameDividerToZoneRep</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-704"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGainConvGlazShadGapToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-705"></a>  <span class="n">WinGainConvGlazShadGapToZoneRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-706"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGainConvShadeToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-707"></a>  <span class="n">WinGainConvShadeToZoneRep</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-708"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">OtherConvGainInsideFaceToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-709"></a>  <span class="n">OtherConvGainInsideFaceToZoneRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-710"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGainIRShadeToZoneRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-711"></a>  <span class="n">WinGainIRShadeToZoneRep</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-712"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGapConvHtFlowRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-713"></a>  <span class="n">WinGapConvHtFlowRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-714"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinShadingAbsorbedSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-715"></a>  <span class="n">WinShadingAbsorbedSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-716"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinSysSolTransmittance</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-717"></a>  <span class="n">WinSysSolTransmittance</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-718"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinSysSolReflectance</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-719"></a>  <span class="n">WinSysSolReflectance</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-720"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinSysSolAbsorptance</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-721"></a>  <span class="n">WinSysSolAbsorptance</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-722"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">InsideGlassCondensationFlag</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-723"></a>  <span class="n">InsideGlassCondensationFlag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-724"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">InsideFrameCondensationFlag</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-725"></a>  <span class="n">InsideFrameCondensationFlag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-726"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">InsideDividerCondensationFlag</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-727"></a>  <span class="n">InsideDividerCondensationFlag</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-728"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneTransSolar</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-729"></a>  <span class="n">ZoneTransSolar</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-730"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneBmSolFrExtWinsRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-731"></a>  <span class="n">ZoneBmSolFrExtWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-732"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneBmSolFrIntWinsRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-733"></a>  <span class="n">ZoneBmSolFrIntWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-734"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-735"></a>  <span class="n">InitialZoneDifSolReflW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-736"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneDifSolFrExtWinsRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-737"></a>  <span class="n">ZoneDifSolFrExtWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-738"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneDifSolFrIntWinsRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-739"></a>  <span class="n">ZoneDifSolFrIntWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-740"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneWinHeatGain</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-741"></a>  <span class="n">ZoneWinHeatGain</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-742"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneWinHeatGainRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-743"></a>  <span class="n">ZoneWinHeatGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-744"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneWinHeatLossRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-745"></a>  <span class="n">ZoneWinHeatLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-746"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneOpaqSurfInsFaceCond</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-747"></a>  <span class="n">ZoneOpaqSurfInsFaceCond</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-748"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneOpaqSurfInsFaceCondGainRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-749"></a>  <span class="n">ZoneOpaqSurfInsFaceCondGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-750"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneOpaqSurfInsFaceCondLossRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-751"></a>  <span class="n">ZoneOpaqSurfInsFaceCondLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-752"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneOpaqSurfExtFaceCond</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-753"></a>  <span class="n">ZoneOpaqSurfExtFaceCond</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-754"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneOpaqSurfExtFaceCondGainRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-755"></a>  <span class="n">ZoneOpaqSurfExtFaceCondGainRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-756"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneOpaqSurfExtFaceCondLossRep</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-757"></a>  <span class="n">ZoneOpaqSurfExtFaceCondLossRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-758"></a>
<a name="ln-759"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncident</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-760"></a>  <span class="n">QRadSWOutIncident</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-761"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncidentBeam</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-762"></a>  <span class="n">QRadSWOutIncidentBeam</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-763"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-764"></a>  <span class="n">BmIncInsSurfIntensRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-765"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-766"></a>  <span class="n">BmIncInsSurfAmountRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-767"></a><span class="c">!  ALLOCATE (DifIncInsSurfIntensRep(TotSurfaces))</span>
<a name="ln-768"></a><span class="c">!  DifIncInsSurfIntensRep=0.0</span>
<a name="ln-769"></a><span class="c">!  ALLOCATE (DifIncInsSurfAmountRep(TotSurfaces))</span>
<a name="ln-770"></a><span class="c">!  DifIncInsSurfAmountRep=0.0</span>
<a name="ln-771"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IntBmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-772"></a>  <span class="n">IntBmIncInsSurfIntensRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-773"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IntBmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-774"></a>  <span class="n">IntBmIncInsSurfAmountRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-775"></a><span class="c">!  ALLOCATE (IntDifIncInsSurfIntensRep(TotSurfaces))</span>
<a name="ln-776"></a><span class="c">!  IntDifIncInsSurfIntensRep=0.0</span>
<a name="ln-777"></a><span class="c">!  ALLOCATE (IntDifIncInsSurfAmountRep(TotSurfaces))</span>
<a name="ln-778"></a><span class="c">!  IntDifIncInsSurfAmountRep=0.0</span>
<a name="ln-779"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncidentSkyDiffuse</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-780"></a>  <span class="n">QRadSWOutIncidentSkyDiffuse</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-781"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncidentGndDiffuse</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-782"></a>  <span class="n">QRadSWOutIncidentGndDiffuse</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-783"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncBmToDiffReflGnd</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-784"></a>  <span class="n">QRadSWOutIncBmToDiffReflGnd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-785"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncSkyDiffReflGnd</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-786"></a>  <span class="n">QRadSWOutIncSkyDiffReflGnd</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-787"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncBmToBmReflObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-788"></a>  <span class="n">QRadSWOutIncBmToBmReflObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-789"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncBmToDiffReflObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-790"></a>  <span class="n">QRadSWOutIncBmToDiffReflObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-791"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWOutIncSkyDiffReflObs</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-792"></a>  <span class="n">QRadSWOutIncSkyDiffReflObs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-793"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">CosIncidenceAngle</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-794"></a>  <span class="n">CosIncidenceAngle</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-795"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BSDFBeamDirectionRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-796"></a>  <span class="n">BSDFBeamDirectionRep</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-797"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BSDFBeamThetaRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-798"></a>  <span class="n">BSDFBeamThetaRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-799"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BSDFBeamPhiRep</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-800"></a>  <span class="n">BSDFBeamPhiRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-801"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWwinAbsTot</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-802"></a>  <span class="n">QRadSWwinAbsTot</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-803"></a>
<a name="ln-804"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWwinAbsLayer</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span> <span class="n">MaxSolidWinLayers</span><span class="p">))</span>
<a name="ln-805"></a>  <span class="n">QRadSWwinAbsLayer</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-806"></a>
<a name="ln-807"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">FenLaySurfTempFront</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span> <span class="n">MaxSolidWinLayers</span><span class="p">))</span>
<a name="ln-808"></a>  <span class="n">FenLaySurfTempFront</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-809"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">FenLaySurfTempBack</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span> <span class="n">MaxSolidWinLayers</span><span class="p">))</span>
<a name="ln-810"></a>  <span class="n">FenLaySurfTempBack</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-811"></a>
<a name="ln-812"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SWwinAbsTotalReport</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-813"></a>  <span class="n">SWwinAbsTotalReport</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-814"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">InitialDifSolInAbsReport</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-815"></a>  <span class="n">InitialDifSolInAbsReport</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-816"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">InitialDifSolInTransReport</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-817"></a>  <span class="n">InitialDifSolInTransReport</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-818"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">SWInAbsTotalReport</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-819"></a>  <span class="n">SWInAbsTotalReport</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-820"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WindowRevealStatus</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-821"></a>  <span class="n">WindowRevealStatus</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-822"></a>
<a name="ln-823"></a>  <span class="c">! Weiler-Atherton</span>
<a name="ln-824"></a>  <span class="n">MAXHCArrayBounds</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-825"></a>  <span class="n">MAXHCArrayIncrement</span><span class="o">=</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-826"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">((</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-827"></a>  <span class="n">XTEMP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-828"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">((</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-829"></a>  <span class="n">YTEMP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-830"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XVC</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-831"></a>  <span class="n">XVC</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-832"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XVS</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-833"></a>  <span class="n">XVS</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-834"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVC</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-835"></a>  <span class="n">YVC</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-836"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVS</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-837"></a>  <span class="n">YVS</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-838"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZVC</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-839"></a>  <span class="n">ZVC</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-840"></a>
<a name="ln-841"></a>  <span class="c">!Sutherland-Hodgman</span>
<a name="ln-842"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ATEMP</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<a name="ln-843"></a>  <span class="n">ATEMP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-844"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">BTEMP</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<a name="ln-845"></a>  <span class="n">BTEMP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-846"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CTEMP</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<a name="ln-847"></a>  <span class="n">CTEMP</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-848"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XTEMP1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<a name="ln-849"></a>  <span class="n">XTEMP1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-850"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YTEMP1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<a name="ln-851"></a>  <span class="n">YTEMP1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-852"></a>
<a name="ln-853"></a>  <span class="c">!energy</span>
<a name="ln-854"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-855"></a>  <span class="n">WinTransSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-856"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinBmSolarEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-857"></a>  <span class="n">WinBmSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-858"></a>
<a name="ln-859"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinBmBmSolarEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-860"></a>  <span class="n">WinBmBmSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-861"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinBmDifSolarEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-862"></a>  <span class="n">WinBmDifSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-863"></a>
<a name="ln-864"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-865"></a>  <span class="n">WinDifSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-866"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinHeatGainRepEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-867"></a>  <span class="n">WinHeatGainRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-868"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinHeatLossRepEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-869"></a>  <span class="n">WinHeatLossRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-870"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinGapConvHtFlowRepEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-871"></a>  <span class="n">WinGapConvHtFlowRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-872"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneTransSolarEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-873"></a>  <span class="n">ZoneTransSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-874"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneBmSolFrExtWinsRepEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-875"></a>  <span class="n">ZoneBmSolFrExtWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-876"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneBmSolFrIntWinsRepEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-877"></a>  <span class="n">ZoneBmSolFrIntWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-878"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneDifSolFrExtWinsRepEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-879"></a>  <span class="n">ZoneDifSolFrExtWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-880"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneDifSolFrIntWinsRepEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-881"></a>  <span class="n">ZoneDifSolFrIntWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-882"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneWinHeatGainRepEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-883"></a>  <span class="n">ZoneWinHeatGainRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-884"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZoneWinHeatLossRepEnergy</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-885"></a>  <span class="n">ZoneWinHeatLossRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-886"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">BmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-887"></a>  <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-888"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZnOpqSurfInsFaceCondGnRepEnrg</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-889"></a>  <span class="n">ZnOpqSurfInsFaceCondGnRepEnrg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-890"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZnOpqSurfInsFaceCondLsRepEnrg</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-891"></a>  <span class="n">ZnOpqSurfInsFaceCondLsRepEnrg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-892"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZnOpqSurfExtFaceCondGnRepEnrg</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-893"></a>  <span class="n">ZnOpqSurfExtFaceCondGnRepEnrg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-894"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ZnOpqSurfExtFaceCondLsRepEnrg</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-895"></a>  <span class="n">ZnOpqSurfExtFaceCondLsRepEnrg</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-896"></a><span class="c">!  ALLOCATE (DifIncInsSurfAmountRepEnergy(TotSurfaces))</span>
<a name="ln-897"></a><span class="c">!  DifIncInsSurfAmountRepEnergy=0.0</span>
<a name="ln-898"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IntBmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-899"></a>  <span class="n">IntBmIncInsSurfAmountRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-900"></a><span class="c">!  ALLOCATE (IntDifIncInsSurfAmountRepEnergy(TotSurfaces))</span>
<a name="ln-901"></a><span class="c">!  IntDifIncInsSurfAmountRepEnergy=0.0</span>
<a name="ln-902"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">QRadSWwinAbsTotEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-903"></a>  <span class="n">QRadSWwinAbsTotEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-904"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinShadingAbsorbedSolarEnergy</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-905"></a>  <span class="n">WinShadingAbsorbedSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-906"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolAbsdOutsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-907"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolRefldOutsRevealReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-908"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolAbsdInsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-909"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolRefldInsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-910"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolRefldInsRevealReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-911"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-912"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-913"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InsRevealDiffIntoZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-914"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">OutsRevealDiffOntoFrame</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-915"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InsRevealDiffOntoFrame</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-916"></a>
<a name="ln-917"></a>  <span class="c">! Added report variables for inside reveal to debug CR 7596. TH 5/26/2009</span>
<a name="ln-918"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InsRevealDiffOntoGlazingReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-919"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InsRevealDiffIntoZoneReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-920"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InsRevealDiffOntoFrameReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-921"></a>  <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolAbsdInsRevealReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-922"></a>
<a name="ln-923"></a>
<a name="ln-924"></a>  <span class="k">CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Initializing Zone Report Variables&#39;</span><span class="p">)</span>
<a name="ln-925"></a>  <span class="c">! CurrentModuleObject=&#39;Zone&#39;</span>
<a name="ln-926"></a>  <span class="k">DO </span><span class="n">ZoneLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-927"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Windows Total Transmitted Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-928"></a>                              <span class="n">ZoneTransSolar</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-929"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Exterior Windows Total Transmitted Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-930"></a>                              <span class="n">ZoneBmSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-931"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-932"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Interior Windows Total Transmitted Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-933"></a>                              <span class="n">ZoneBmSolFrIntWinsRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-934"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-935"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Exterior Windows Total Transmitted Diffuse Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-936"></a>                              <span class="n">ZoneDifSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-937"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-938"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Interior Windows Total Transmitted Diffuse Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-939"></a>                              <span class="n">ZoneDifSolFrIntWinsRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-940"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-941"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Windows Total Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-942"></a>                              <span class="n">ZoneWinHeatGainRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-943"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Windows Total Heat Loss Rate [W]&#39;</span><span class="p">,</span><span class="n">ZoneWinHeatLossRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-944"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-945"></a>    <span class="c">! Energy variables</span>
<a name="ln-946"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Windows Total Transmitted Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">ZoneTransSolarEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-947"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-948"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Exterior Windows Total Transmitted Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-949"></a>                              <span class="n">ZoneBmSolFrExtWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-950"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-951"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Interior Windows Total Transmitted Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-952"></a>                              <span class="n">ZoneBmSolFrIntWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-953"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-954"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Exterior Windows Total Transmitted Diffuse Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-955"></a>                              <span class="n">ZoneDifSolFrExtWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-956"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-957"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Interior Windows Total Transmitted Diffuse Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-958"></a>                              <span class="n">ZoneDifSolFrIntWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-959"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-960"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Windows Total Heat Gain Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-961"></a>                              <span class="n">ZoneWinHeatGainRepEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-962"></a>                             <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-963"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Windows Total Heat Loss Energy [J]&#39;</span><span class="p">,</span><span class="n">ZoneWinHeatLossRepEnergy</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-964"></a>           <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-965"></a>
<a name="ln-966"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayAdvancedReportVariables</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-967"></a>      <span class="c">! CurrentModuleObject=&#39;Zone(Advanced)&#39;</span>
<a name="ln-968"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Opaque Surface Inside Faces Total Conduction Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-969"></a>                                <span class="n">ZoneOpaqSurfInsFaceCondGainRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-970"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-971"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Opaque Surface Inside Faces Total Conduction Heat Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-972"></a>                                <span class="n">ZoneOpaqSurfInsFaceCondLossRep</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-973"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-974"></a>      <span class="c">! Energy variables</span>
<a name="ln-975"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Opaque Surface Inside Faces Total Conduction Heat Gain Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-976"></a>                                <span class="n">ZnOpqSurfInsFaceCondGnRepEnrg</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-977"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-978"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Zone Opaque Surface Inside Faces Total Conduction Heat Loss Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-979"></a>                                <span class="n">ZnOpqSurfInsFaceCondLsRepEnrg</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-980"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-981"></a>    <span class="n">ENDIF</span>
<a name="ln-982"></a>  <span class="k">END DO</span>
<a name="ln-983"></a>
<a name="ln-984"></a><span class="k">  CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Initializing Surface (Shading) Report Variables&#39;</span><span class="p">)</span>
<a name="ln-985"></a>  <span class="c">! CurrentModuleObject=&#39;Surfaces&#39;</span>
<a name="ln-986"></a>  <span class="k">DO </span><span class="n">SurfLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-987"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-988"></a><span class="k">      CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Sunlit Area [m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-989"></a>                                <span class="n">SurfSunlitArea</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-990"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Sunlit Fraction []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-991"></a>                                <span class="n">SurfSunlitFrac</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-992"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Incident Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-993"></a>                                <span class="n">QRadSWOutIncident</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-994"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-995"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-996"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Incident Beam Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-997"></a>                                <span class="n">QRadSWOutIncidentBeam</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-998"></a>                               <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-999"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Incident Sky Diffuse Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1000"></a>                               <span class="n">QRadSWOutIncidentSkyDiffuse</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1001"></a>                               <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1002"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Incident Ground Diffuse Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1003"></a>                                <span class="n">QRadSWOutIncidentGndDiffuse</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1004"></a>                               <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1005"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1006"></a>                  <span class="s1">&#39;Surface Outside Face Beam Solar Incident Angle Cosine Value []&#39;</span><span class="p">,</span><span class="n">CosIncidenceAngle</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1007"></a>                               <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1008"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1009"></a>                  <span class="s1">&#39;Surface Outside Face Incident Sky Diffuse Ground Reflected Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1010"></a>                               <span class="n">QRadSWOutIncSkyDiffReflGnd</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1011"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1012"></a>                  <span class="s1">&#39;Surface Outside Face Incident Sky Diffuse Surface Reflected Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1013"></a>                               <span class="n">QRadSWOutIncSkyDiffReflObs</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1014"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1015"></a>                  <span class="s1">&#39;Surface Outside Face Incident Beam To Beam Surface Reflected Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1016"></a>                               <span class="n">QRadSWOutIncBmToBmReflObs</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1017"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1018"></a>                  <span class="s1">&#39;Surface Outside Face Incident Beam To Diffuse Surface Reflected Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1019"></a>                               <span class="n">QRadSWOutIncBmToDiffReflObs</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1020"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1021"></a>                  <span class="s1">&#39;Surface Outside Face Incident Beam To Diffuse Ground Reflected Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1022"></a>                               <span class="n">QRadSWOutIncBmToDiffReflGnd</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1023"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Anisotropic Sky Multiplier []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1024"></a>                               <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1025"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window BSDF Beam Direction Number []&#39;</span><span class="p">,</span><span class="n">BSDFBeamDirectionRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1026"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1027"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window BSDF Beam Theta Angle [rad]&#39;</span><span class="p">,</span><span class="n">BSDFBeamThetaRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1028"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1029"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window BSDF Beam Phi Angle [rad]&#39;</span><span class="p">,</span><span class="n">BSDFBeamPhiRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1030"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1031"></a>    <span class="k">END IF</span>
<a name="ln-1032"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1033"></a>
<a name="ln-1034"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1035"></a>      <span class="c">! CurrentModuleObject=&#39;Windows/GlassDoors&#39;</span>
<a name="ln-1036"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1037"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1038"></a>                                  <span class="n">QRadSWwinAbsTot</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1039"></a>                                  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1040"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Shortwave Radiation Rate [W]&#39;</span><span class="p">,&amp;</span>
<a name="ln-1041"></a>                                  <span class="n">SWwinAbsTotalReport</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1042"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1043"></a>
<a name="ln-1044"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeBSDF</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1045"></a><span class="k">          </span><span class="n">NumOfLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TotSolidLayers</span>
<a name="ln-1046"></a>        <span class="k">ELSE</span>
<a name="ln-1047"></a><span class="k">          </span><span class="n">NumOfLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-1048"></a>        <span class="k">END IF</span>
<a name="ln-1049"></a><span class="k">        DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfLayers</span>
<a name="ln-1050"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Absorbed Shortwave Radiation Rate Layer &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1051"></a>                                <span class="s1">&#39; [W]&#39;</span><span class="p">,</span> <span class="n">QRadSWwinAbsLayer</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">,</span> <span class="n">I</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1052"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Front Face Temperature Layer &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1053"></a>                                <span class="n">FenLaySurfTempFront</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">,</span> <span class="n">I</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1054"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Back Face Temperature Layer &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">I</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1055"></a>                                <span class="n">FenLaySurfTempBack</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">,</span> <span class="n">I</span><span class="p">),</span> <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1056"></a>        <span class="k">END DO</span>
<a name="ln-1057"></a>
<a name="ln-1058"></a><span class="k">        CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1059"></a>                                  <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1060"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1061"></a>                                  <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1062"></a>
<a name="ln-1063"></a>        <span class="c">!added TH 12/9/2009</span>
<a name="ln-1064"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span><span class="n">WinBmBmSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1065"></a>           <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1066"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Diffuse Solar Radiation Rate [W]&#39;</span><span class="p">,</span><span class="n">WinBmDifSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-1067"></a>           <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1068"></a>
<a name="ln-1069"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Diffuse Solar Radiation Rate [W]&#39;</span><span class="p">,</span><span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1070"></a>                               <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1071"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Gain Rate [W]&#39;</span><span class="p">,</span><span class="n">WinHeatGainRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1072"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1073"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Loss Rate [W]&#39;</span><span class="p">,</span><span class="n">WinHeatLossRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1074"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1075"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Gap Convective Heat Transfer Rate [W]&#39;</span><span class="p">,&amp;</span>
<a name="ln-1076"></a>                                  <span class="n">WinGapConvHtFlowRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1077"></a>                                  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1078"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Shading Device Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1079"></a>                                  <span class="n">WinShadingAbsorbedSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1080"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1081"></a>
<a name="ln-1082"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayAdvancedReportVariables</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1083"></a>          <span class="c">! CurrentModuleObject=&#39;Windows/GlassDoors(Advanced)&#39;</span>
<a name="ln-1084"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Glazing Zone Convection Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1085"></a>                                   <span class="n">WinGainConvGlazToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1086"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Glazing Net Infrared Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1087"></a>                                   <span class="n">WinGainIRGlazToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1088"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Shortwave from Zone Back Out Window Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1089"></a>                                   <span class="n">WinLossSWZoneToOutWinRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1090"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Frame and Divider Zone Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1091"></a>                                   <span class="n">WinGainFrameDividerToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1092"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Gap between Shade and Glazing Zone Convection Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1093"></a>                                   <span class="n">WinGainConvGlazShadGapToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1094"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Shade Zone Convection Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1095"></a>                                   <span class="n">WinGainConvShadeToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1096"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Shade Net Infrared Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1097"></a>                                   <span class="n">WinGainIRShadeToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1098"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeEQL</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1099"></a><span class="k">               CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Other Convection Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1100"></a>                                         <span class="n">OtherConvGainInsideFaceToZoneRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1101"></a>          <span class="n">ENDIF</span>
<a name="ln-1102"></a>        <span class="n">ENDIF</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>
<a name="ln-1105"></a>        <span class="c">! Added TH 12/23/2008 for thermochromic windows</span>
<a name="ln-1106"></a>        <span class="c">! CurrentModuleObject=&#39;Thermochromic Windows&#39;</span>
<a name="ln-1107"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TCFlag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1108"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Thermochromic Layer Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">TCLayerTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1109"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1110"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Thermochromic Layer Property Specification Temperature [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1111"></a>                                  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">SpecTemp</span><span class="p">,</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1112"></a>        <span class="n">ENDIF</span>
<a name="ln-1113"></a>
<a name="ln-1114"></a>        <span class="c">! Added TH 5/26/2009 for switchable windows to report switching factor (tinted level)</span>
<a name="ln-1115"></a>        <span class="c">! CurrentModuleObject=&#39;Switchable Windows&#39;</span>
<a name="ln-1116"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1117"></a><span class="k">          IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_SwitchableGlazing</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-1118"></a>          <span class="c">!IF (SurfaceWindow(SurfLoop)%ShadingFlag == SwitchableGlazing) THEN  !ShadingFlag is not set to SwitchableGlazing yet!</span>
<a name="ln-1119"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Switchable Glazing Switching Factor []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1120"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1121"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1122"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Switchable Glazing Visible Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1123"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">VisTransSelected</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1124"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1125"></a>          <span class="n">ENDIF</span>
<a name="ln-1126"></a>        <span class="n">ENDIF</span>
<a name="ln-1127"></a>
<a name="ln-1128"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1129"></a>          <span class="c">! CurrentModuleObject=&#39;Window Frames&#39;</span>
<a name="ln-1130"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Heat Gain Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameHeatGain</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1131"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1132"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Heat Loss Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameHeatLoss</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1133"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1134"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Inside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameTempSurfIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1135"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1136"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Outside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameTempSurfOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1137"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1138"></a>        <span class="n">ENDIF</span>
<a name="ln-1139"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1140"></a>          <span class="c">! CurrentModuleObject=&#39;Window Dividers&#39;</span>
<a name="ln-1141"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Heat Gain Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerHeatGain</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1142"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1143"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Heat Loss Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerHeatLoss</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1144"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1145"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Inside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerTempSurfIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1146"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1147"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Outside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerTempSurfOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1148"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1149"></a>        <span class="n">ENDIF</span>
<a name="ln-1150"></a>
<a name="ln-1151"></a>        <span class="c">! CurrentModuleObject=&#39;Windows&#39;</span>
<a name="ln-1152"></a>        <span class="c">! Energy</span>
<a name="ln-1153"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1154"></a>                                  <span class="n">QRadSWwinAbsTotEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1155"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1156"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1157"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1158"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinBmSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1159"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1160"></a>
<a name="ln-1161"></a>        <span class="c">!added TH 12/9/2009</span>
<a name="ln-1162"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1163"></a>                                  <span class="n">WinBmBmSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1164"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1165"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Diffuse Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1166"></a>                                  <span class="n">WinBmDifSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1167"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Diffuse Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1170"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1171"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Gain Energy [J]&#39;</span><span class="p">,</span><span class="n">WinHeatGainRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1172"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1173"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Loss Energy [J]&#39;</span><span class="p">,</span><span class="n">WinHeatLossRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1174"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1175"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Gap Convective Heat Transfer Energy [J]&#39;</span><span class="p">,</span><span class="n">WinGapConvHtFlowRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1176"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1177"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Shading Device Absorbed Solar Radiation Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1178"></a>                                <span class="n">WinShadingAbsorbedSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1179"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1180"></a>
<a name="ln-1181"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window System Solar Transmittance []&#39;</span><span class="p">,</span><span class="n">WinSysSolTransmittance</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1182"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1183"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window System Solar Reflectance []&#39;</span><span class="p">,</span><span class="n">WinSysSolReflectance</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1184"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1185"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window System Solar Absorptance []&#39;</span><span class="p">,</span><span class="n">WinSysSolAbsorptance</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1186"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1187"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Glazing Condensation Status []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1188"></a>                                  <span class="n">InsideGlassCondensationFlag</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1189"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1190"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Frame Condensation Status []&#39;</span><span class="p">,</span><span class="n">InsideFrameCondensationFlag</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1191"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1192"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Divider Condensation Status []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1193"></a>                                  <span class="n">InsideDividerCondensationFlag</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1194"></a>                                 <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1195"></a>
<a name="ln-1196"></a>      <span class="c">! Outside reveal report variables</span>
<a name="ln-1197"></a>      <span class="c">!IF (Surface(SurfLoop)%Reveal &gt; 0.0) THEN</span>
<a name="ln-1198"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Outside Reveal Reflected Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1199"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1200"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1201"></a>        <span class="c">! Energy</span>
<a name="ln-1202"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Outside Reveal Reflected Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1203"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealRepEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1204"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1205"></a>      <span class="c">!ENDIF</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a>      <span class="c">! Inside reveal report variables</span>
<a name="ln-1208"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">InsideReveal</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">InsideSillDepth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1209"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1210"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1211"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1212"></a>          <span class="c">! Energy</span>
<a name="ln-1213"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1214"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealRepEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1215"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1216"></a>
<a name="ln-1217"></a>          <span class="c">! Added report variables for inside reveal to debug CR 7596. TH 5/26/2009</span>
<a name="ln-1218"></a>          <span class="c">! All reflected solar by the inside reveal is turned into diffuse</span>
<a name="ln-1219"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Absorbed Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1220"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolAbsdInsRevealReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1221"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1222"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Diffuse Zone Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1223"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZoneReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1224"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1225"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Diffuse Frame Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1226"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrameReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1227"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1228"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Diffuse Glazing Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1229"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazingReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1230"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1231"></a>        <span class="n">ENDIF</span>
<a name="ln-1232"></a>
<a name="ln-1233"></a>    <span class="c">!     Output blind report variables only when blinds are used</span>
<a name="ln-1234"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlindNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1235"></a>          <span class="c">! CurrentModuleObject=&#39;Window Blinds&#39;</span>
<a name="ln-1236"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind Beam to Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1237"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1238"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1239"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind Beam to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1240"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlTsolBmDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1241"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1242"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind Diffuse to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1243"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1244"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1245"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind and Glazing System Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1246"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlGlSysTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1247"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1248"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind and Glazing System Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1249"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlGlSysTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1250"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1251"></a>        <span class="k">END IF</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a>  <span class="c">!     Output screen report variables only when screens are used</span>
<a name="ln-1254"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScreenNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1255"></a>          <span class="c">! CurrentModuleObject=&#39;Window Screens&#39;</span>
<a name="ln-1256"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen Beam to Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1257"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1258"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1259"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen Beam to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1260"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScTsolBmDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1261"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1262"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen Diffuse to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1263"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1264"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1265"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen and Glazing System Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1266"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScGlSysTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1267"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1268"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen and Glazing System Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1269"></a>                                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScGlSysTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1270"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1271"></a>        <span class="k">END IF</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>        <span class="c">! CurrentModuleObject=&#39;Windows&#39;</span>
<a name="ln-1274"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Solar Horizontal Profile Angle [deg]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1275"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ProfileAngHor</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1276"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1277"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Solar Vertical Profile Angle [deg]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1278"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ProfileAngVert</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1279"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1280"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Glazing Beam to Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1281"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GlTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1282"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1283"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Glazing Beam to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1284"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GlTsolBmDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1285"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1286"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Glazing Diffuse to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1287"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GlTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1288"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1289"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Model Solver Iteration Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1290"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">WindowCalcIterationsRep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1291"></a>                                <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1292"></a>      <span class="n">ELSEIF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Not ExtSolar</span>
<a name="ln-1293"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayAdvancedReportVariables</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1294"></a>          <span class="c">! CurrentModuleObject=&#39;InteriorWindows(Advanced)&#39;</span>
<a name="ln-1295"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1296"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1297"></a>                                      <span class="n">QRadSWwinAbsTot</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1298"></a>                                      <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1299"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Shortwave Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1300"></a>                                    <span class="n">SWwinAbsTotalReport</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1301"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1302"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1303"></a>             <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1304"></a>                                       <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1305"></a>                                       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1306"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span><span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1307"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1308"></a>
<a name="ln-1309"></a>          <span class="c">!added TH 12/9/2009</span>
<a name="ln-1310"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span><span class="n">WinBmBmSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1311"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1312"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Diffuse Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1313"></a>                                    <span class="n">WinBmDifSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1314"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1315"></a>
<a name="ln-1316"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Diffuse Solar Radiation Rate [W]&#39;</span><span class="p">,</span><span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1317"></a>                                 <span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1318"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Gain Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1319"></a>                                    <span class="n">WinHeatGainRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1320"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Loss Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1321"></a>                                    <span class="n">WinHeatLossRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1322"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Gap Convective Heat Transfer Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1323"></a>                                  <span class="n">WinGapConvHtFlowRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1324"></a>                                  <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1325"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Shading Device Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1326"></a>                                    <span class="n">WinShadingAbsorbedSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1327"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1328"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1329"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Heat Gain Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameHeatGain</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1330"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1331"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Heat Loss Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameHeatLoss</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1332"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1333"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Inside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameTempSurfIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1334"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1335"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Frame Outside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">FrameTempSurfOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1336"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1337"></a>          <span class="n">ENDIF</span>
<a name="ln-1338"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1339"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Heat Gain Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerHeatGain</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1340"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1341"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Heat Loss Rate [W]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerHeatLoss</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1342"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1343"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Inside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerTempSurfIn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1344"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1345"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Divider Outside Temperature [C]&#39;</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">DividerTempSurfOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1346"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1347"></a>          <span class="n">ENDIF</span>
<a name="ln-1348"></a>          <span class="c">! Energy</span>
<a name="ln-1349"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1350"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1351"></a>                                      <span class="n">QRadSWwinAbsTotEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1352"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1353"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1354"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1355"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1356"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinBmSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1357"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1358"></a>
<a name="ln-1359"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1360"></a>                                    <span class="n">WinBmBmSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1361"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1362"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam To Diffuse Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1363"></a>                                    <span class="n">WinBmDifSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1364"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1365"></a>
<a name="ln-1366"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Diffuse Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1367"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1368"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Gain Energy [J]&#39;</span><span class="p">,</span><span class="n">WinHeatGainRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1369"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1370"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Heat Loss Energy [J]&#39;</span><span class="p">,</span><span class="n">WinHeatLossRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1371"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1372"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Gap Convective Heat Transfer Energy [J]&#39;</span><span class="p">,</span><span class="n">WinGapConvHtFlowRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1373"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1374"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Shading Device Absorbed Solar Radiation Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1375"></a>                                   <span class="n">WinShadingAbsorbedSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1376"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window System Solar Transmittance []&#39;</span><span class="p">,</span><span class="n">WinSysSolTransmittance</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1379"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1380"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window System Solar Reflectance []&#39;</span><span class="p">,</span><span class="n">WinSysSolReflectance</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1381"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1382"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window System Solar Absorptance []&#39;</span><span class="p">,</span><span class="n">WinSysSolAbsorptance</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1383"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1384"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Glazing Condensation Status []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1385"></a>                                    <span class="n">InsideGlassCondensationFlag</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1386"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1387"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Frame Condensation Status []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1388"></a>                                    <span class="n">InsideFrameCondensationFlag</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1389"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1390"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Face Divider Condensation Status []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1391"></a>                                    <span class="n">InsideDividerCondensationFlag</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1392"></a>                                   <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1393"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Outside Reveal Reflected Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1394"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1395"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1396"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1397"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealReport</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1398"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1399"></a>          <span class="c">! Energy</span>
<a name="ln-1400"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Outside Reveal Reflected Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1401"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealRepEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1402"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1403"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Inside Reveal Reflected Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1404"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealRepEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1405"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a>    <span class="c">!     Output blind report variables only when blinds are used</span>
<a name="ln-1408"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlindNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1409"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind Beam to Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1410"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1411"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1412"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind Beam to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1413"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlTsolBmDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1414"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1415"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind Diffuse to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1416"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1417"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1418"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind and Glazing System Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1419"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlGlSysTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1420"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1421"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Blind and Glazing System Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1422"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BlGlSysTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1423"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1424"></a>          <span class="k">END IF</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>    <span class="c">!     Output screen report variables only when screens are used</span>
<a name="ln-1427"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScreenNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1428"></a><span class="k">            CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen Beam to Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1429"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1430"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1431"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen Beam to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1432"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScTsolBmDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1433"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1434"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen Diffuse to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1435"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1436"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1437"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen and Glazing System Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1438"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScGlSysTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1439"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1440"></a>            <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Screen and Glazing System Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1441"></a>                                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ScGlSysTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1442"></a>                                     <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1443"></a>          <span class="k">END IF</span>
<a name="ln-1444"></a>
<a name="ln-1445"></a><span class="k">          CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Solar Horizontal Profile Angle [deg]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1446"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ProfileAngHor</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1447"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1448"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Solar Vertical Profile Angle [deg]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1449"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ProfileAngVert</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1450"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1451"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Glazing Beam to Beam Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1452"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GlTsolBmBm</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1453"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1454"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Glazing Beam to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1455"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GlTsolBmDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1456"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1457"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Glazing Diffuse to Diffuse Solar Transmittance []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1458"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">GlTsolDifDif</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1459"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1460"></a>          <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Model Solver Iteration Count []&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1461"></a>                                   <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">WindowCalcIterationsRep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1462"></a>                                  <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1463"></a>        <span class="k">END IF</span>
<a name="ln-1464"></a><span class="k">      END IF</span> <span class="c">! end non extsolar reporting as advanced variables</span>
<a name="ln-1465"></a>    <span class="k">END IF</span>  <span class="c">! Window Reporting</span>
<a name="ln-1466"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span>   <span class="p">&amp;</span>
<a name="ln-1467"></a>         <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">SurfLoop</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Interzone window</span>
<a name="ln-1468"></a>      <span class="c">! CurrentModuleObject=&#39;InterzoneWindows&#39;</span>
<a name="ln-1469"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1470"></a>                               <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1471"></a>                              <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1472"></a>      <span class="c">!energy</span>
<a name="ln-1473"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1474"></a>                               <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRepEnergy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1475"></a>                              <span class="s1">&#39;Zone&#39;</span><span class="p">,</span> <span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1476"></a>    <span class="k">END IF</span>
<a name="ln-1477"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1478"></a>      <span class="c">! CurrentModuleObject=&#39;TDD Domes&#39;</span>
<a name="ln-1479"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,&amp;</span>
<a name="ln-1480"></a>                                <span class="n">QRadSWwinAbsTot</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1481"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1482"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1483"></a>                                <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1484"></a>      <span class="c">!energy</span>
<a name="ln-1485"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1486"></a>                                <span class="n">QRadSWwinAbsTotEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1487"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1488"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1489"></a>                              <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1490"></a>    <span class="k">END IF</span>
<a name="ln-1491"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1492"></a>      <span class="c">! CurrentModuleObject=&#39;TDD Diffusers&#39;</span>
<a name="ln-1493"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Outside Face Incident Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1494"></a>                                <span class="n">QRadSWOutIncident</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1495"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1496"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1497"></a>                                <span class="n">QRadSWwinAbsTot</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1498"></a>                                <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1499"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1500"></a>                                <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1501"></a>      <span class="c">!energy</span>
<a name="ln-1502"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Total Glazing Layers Absorbed Solar Radiation Energy [J]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1503"></a>                                <span class="n">QRadSWwinAbsTotEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1504"></a>                               <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1505"></a>      <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Window Transmitted Solar Radiation Energy [J]&#39;</span><span class="p">,</span><span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),&amp;</span>
<a name="ln-1506"></a>                              <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1507"></a>    <span class="k">END IF</span>
<a name="ln-1508"></a><span class="k">  </span><span class="n">ENDDO</span>
<a name="ln-1509"></a>
<a name="ln-1510"></a>  <span class="k">DO </span><span class="n">SurfLoop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1511"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1512"></a>    <span class="c">! CurrentModuleObject=&#39;Surfaces&#39;</span>
<a name="ln-1513"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Exterior Windows Incident Beam Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1514"></a>                              <span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1515"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Exterior Windows Incident Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1516"></a>                              <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1517"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Interior Windows Incident Beam Solar Radiation Rate per Area [W/m2]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1518"></a>                              <span class="n">IntBmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1519"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Interior Windows Incident Beam Solar Radiation Rate [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1520"></a>                              <span class="n">IntBmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1521"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Initial Transmitted Diffuse Absorbed Solar Radiation Rate [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1522"></a>                              <span class="n">InitialDifSolInAbsReport</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1523"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Initial Transmitted Diffuse Transmitted Out Window Solar Radiation Rate [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1524"></a>                              <span class="n">InitialDifSolInTransReport</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1525"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Absorbed Shortwave Radiation Rate [W]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1526"></a>                              <span class="n">SWInAbsTotalReport</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1527"></a>    <span class="c">!energy</span>
<a name="ln-1528"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Exterior Windows Incident Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1529"></a>                              <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1530"></a>    <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Surface Inside Face Interior Windows Incident Beam Solar Radiation Energy [J]&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1531"></a>                              <span class="n">IntBmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">),</span><span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Sum&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfLoop</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-1532"></a>  <span class="k">END DO</span>
<a name="ln-1533"></a>
<a name="ln-1534"></a><span class="k">  RETURN</span>
<a name="ln-1535"></a>
<a name="ln-1536"></a><span class="k">END SUBROUTINE </span><span class="n">AllocateModuleArrays</span>
<a name="ln-1537"></a>
<a name="ln-1538"></a><span class="k">SUBROUTINE </span><span class="n">AnisoSkyViewFactors</span>
<a name="ln-1539"></a>
<a name="ln-1540"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1541"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-1542"></a>          <span class="c">!       DATE WRITTEN   April 1999</span>
<a name="ln-1543"></a>          <span class="c">!       MODIFIED       LKL; Dec 2002 -- Anisotropic is only sky radiance option</span>
<a name="ln-1544"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-1545"></a>
<a name="ln-1546"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1547"></a>          <span class="c">! Calculates view factor multiplier, AnisoSkyMult, for diffuse</span>
<a name="ln-1548"></a>          <span class="c">! sky irradiance on exterior surfaces taking into account</span>
<a name="ln-1549"></a>          <span class="c">! anisotropic radiance of the sky. Called by InitSurfaceHeatBalance</span>
<a name="ln-1550"></a>          <span class="c">!</span>
<a name="ln-1551"></a>          <span class="c">! In this case the diffuse sky irradiance on a surface is given by</span>
<a name="ln-1552"></a>          <span class="c">!</span>
<a name="ln-1553"></a>          <span class="c">!  AnisoSkyMult(SurfNum) * DifSolarRad</span>
<a name="ln-1554"></a>          <span class="c">!</span>
<a name="ln-1555"></a>          <span class="c">! AnisoSkyMult accounts not only for the sky radiance distribution but</span>
<a name="ln-1556"></a>          <span class="c">! also for the effects of shading of sky diffuse radiation by</span>
<a name="ln-1557"></a>          <span class="c">! shadowing surfaces such as overhangs. It does not account for reflection</span>
<a name="ln-1558"></a>          <span class="c">! of sky diffuse radiation from shadowing surfaces.</span>
<a name="ln-1559"></a>          <span class="c">!</span>
<a name="ln-1560"></a>          <span class="c">! Based on an empirical model described in</span>
<a name="ln-1561"></a>          <span class="c">! R. Perez, P. Ineichen, R. Seals, J. Michalsky and R. Stewart,</span>
<a name="ln-1562"></a>          <span class="c">! &quot;Modeling Daylight Availability and Irradiance Components from Direct</span>
<a name="ln-1563"></a>          <span class="c">! and Global Irradiance,&quot; Solar Energy 44, 271-289, 1990.</span>
<a name="ln-1564"></a>          <span class="c">! In this model the radiance of the sky consists of three distributions</span>
<a name="ln-1565"></a>          <span class="c">! that are superimposed:</span>
<a name="ln-1566"></a>
<a name="ln-1567"></a>          <span class="c">! (1) An isotropic distribution that covers the entire sky dome;</span>
<a name="ln-1568"></a>          <span class="c">! (2) A circumsolar brightening centered around the position of the sun;</span>
<a name="ln-1569"></a>          <span class="c">! (3) A horizon brightening</span>
<a name="ln-1570"></a>          <span class="c">!</span>
<a name="ln-1571"></a>          <span class="c">! The circumsolar brightening is assumed to be concentrated at a point</span>
<a name="ln-1572"></a>          <span class="c">! source at the center of the sun although this region actually begins at the</span>
<a name="ln-1573"></a>          <span class="c">! periphery of the solar disk and falls off in intensity with increasing</span>
<a name="ln-1574"></a>          <span class="c">! angular distance from the periphery.</span>
<a name="ln-1575"></a>          <span class="c">!</span>
<a name="ln-1576"></a>          <span class="c">! The horizon brightening is assumed to be concentrated at the horizon and</span>
<a name="ln-1577"></a>          <span class="c">! to be independent of azimuth. In actuality, for clear skies, the horizon</span>
<a name="ln-1578"></a>          <span class="c">! brightening is highest at the horizon and decreases in intensity away from</span>
<a name="ln-1579"></a>          <span class="c">! the horizon. For overcast skies the horizon brightening has a negative value</span>
<a name="ln-1580"></a>          <span class="c">! since for such skies the sky radiance increases rather than decreases away</span>
<a name="ln-1581"></a>          <span class="c">! from the horizon.</span>
<a name="ln-1582"></a>          <span class="c">!</span>
<a name="ln-1583"></a>          <span class="c">! The F11R, F12R, etc. values were provided by R. Perez, private communication,</span>
<a name="ln-1584"></a>          <span class="c">! 5/21/99. These values have higher precision than those listed in the above</span>
<a name="ln-1585"></a>          <span class="c">! paper.</span>
<a name="ln-1586"></a>
<a name="ln-1587"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1588"></a><span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span>
<a name="ln-1589"></a>
<a name="ln-1590"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1591"></a>
<a name="ln-1592"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1593"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EpsilonLimit</span><span class="o">=</span>  <span class="p">&amp;</span>         <span class="c">! Upper limit of bins of the sky clearness parameter, Epsilon</span>
<a name="ln-1594"></a>      <span class="p">(</span><span class="o">/</span><span class="mf">1.065d0</span><span class="p">,</span><span class="mf">1.23d0</span><span class="p">,</span><span class="mf">1.5d0</span><span class="p">,</span><span class="mf">1.95d0</span><span class="p">,</span><span class="mf">2.8d0</span><span class="p">,</span><span class="mf">4.5d0</span><span class="p">,</span><span class="mf">6.2d0</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1595"></a>       <span class="c">! Circumsolar brightening coefficients; index corresponds to range of Epsilon, the sky clearness parameter</span>
<a name="ln-1596"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F11R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1597"></a>               <span class="p">(</span><span class="o">/</span> <span class="o">-</span><span class="mf">0.0083117d0</span><span class="p">,</span>  <span class="mf">0.1299457d0</span><span class="p">,</span>  <span class="mf">0.3296958d0</span><span class="p">,</span>  <span class="mf">0.5682053d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1598"></a>                   <span class="mf">0.8730280d0</span><span class="p">,</span>  <span class="mf">1.1326077d0</span><span class="p">,</span>  <span class="mf">1.0601591d0</span><span class="p">,</span>  <span class="mf">0.6777470d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1599"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F12R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1600"></a>               <span class="p">(</span><span class="o">/</span>  <span class="mf">0.5877285d0</span><span class="p">,</span>  <span class="mf">0.6825954d0</span><span class="p">,</span>  <span class="mf">0.4868735d0</span><span class="p">,</span>  <span class="mf">0.1874525d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1601"></a>                  <span class="o">-</span><span class="mf">0.3920403d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2367284d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5999137d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3272588d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1602"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F13R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1603"></a>               <span class="p">(</span><span class="o">/</span> <span class="o">-</span><span class="mf">0.0620636d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1513752d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2210958d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2951290d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1604"></a>                  <span class="o">-</span><span class="mf">0.3616149d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4118494d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3589221d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2504286d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1605"></a>       <span class="c">! Horizon/zenith brightening coefficient array; index corresponds to range of Epsilon, the sky clearness parameter</span>
<a name="ln-1606"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F21R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1607"></a>               <span class="p">(</span><span class="o">/</span> <span class="o">-</span><span class="mf">0.0596012d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0189325d0</span><span class="p">,</span>  <span class="mf">0.0554140d0</span><span class="p">,</span>  <span class="mf">0.1088631d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1608"></a>                   <span class="mf">0.2255647d0</span><span class="p">,</span>  <span class="mf">0.2877813d0</span><span class="p">,</span>  <span class="mf">0.2642124d0</span><span class="p">,</span>  <span class="mf">0.1561313d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1609"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F22R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1610"></a>               <span class="p">(</span><span class="o">/</span>  <span class="mf">0.0721249d0</span><span class="p">,</span>  <span class="mf">0.0659650d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0639588d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1519229d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1611"></a>                  <span class="o">-</span><span class="mf">0.4620442d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8230357d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1272340d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3765031d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1612"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="kd">::</span> <span class="n">F23R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-1613"></a>               <span class="p">(</span><span class="o">/</span> <span class="o">-</span><span class="mf">0.0220216d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0288748d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0260542d0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0139754d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1614"></a>                   <span class="mf">0.0012448d0</span><span class="p">,</span>  <span class="mf">0.0558651d0</span><span class="p">,</span>  <span class="mf">0.1310694d0</span><span class="p">,</span>  <span class="mf">0.2506212d0</span> <span class="o">/</span><span class="p">)</span>
<a name="ln-1615"></a>
<a name="ln-1616"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1617"></a>
<a name="ln-1618"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CosZenithAng</span>            <span class="c">! Cosine of solar zenith angle</span>
<a name="ln-1619"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZenithAng</span>               <span class="c">! Solar zenith angle (radians)</span>
<a name="ln-1620"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ZenithAngDeg</span>            <span class="c">! Solar zenith angle (degrees)</span>
<a name="ln-1621"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">F1</span>                      <span class="c">! Circumsolar brightening coefficient</span>
<a name="ln-1622"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">F2</span>                      <span class="c">! Horizon/zenith brightening coefficient</span>
<a name="ln-1623"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="nb">Epsilon</span>                 <span class="c">! Sky clearness parameter</span>
<a name="ln-1624"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Delta</span>                   <span class="c">! Sky brightness parameter</span>
<a name="ln-1625"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CosIncAngBeamOnSurface</span>  <span class="c">! Cosine of incidence angle of beam solar on surface</span>
<a name="ln-1626"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">IncAng</span>                  <span class="c">! Incidence angle of beam solar on surface (radians)</span>
<a name="ln-1627"></a><span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">SurfNum</span>                 <span class="c">! Surface number</span>
<a name="ln-1628"></a><span class="kt">INTEGER</span>     <span class="kd">::</span> <span class="n">EpsilonBin</span>              <span class="c">! Sky clearness (Epsilon) bin index</span>
<a name="ln-1629"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AirMass</span>                 <span class="c">! Relative air mass</span>
<a name="ln-1630"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AirMassH</span>                <span class="c">! Intermediate variable for relative air mass calculation</span>
<a name="ln-1631"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CircumSolarFac</span>          <span class="c">! Ratio of cosine of incidence angle to cosine of zenith angle</span>
<a name="ln-1632"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">KappaZ3</span>                 <span class="c">! Intermediate variable</span>
<a name="ln-1633"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ViewFactorSkyGeom</span>       <span class="c">! Geometrical sky view factor</span>
<a name="ln-1634"></a>
<a name="ln-1635"></a>
<a name="ln-1636"></a>        <span class="c">! FLOW:</span>
<a name="ln-1637"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-1638"></a>      <span class="n">NumAnisoSky_Calls</span><span class="o">=</span><span class="n">NumAnisoSky_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1639"></a><span class="cp">#endif</span>
<a name="ln-1640"></a>
<a name="ln-1641"></a>      <span class="n">CosZenithAng</span> <span class="o">=</span> <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1642"></a>      <span class="n">ZenithAng</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">CosZenithAng</span><span class="p">)</span>
<a name="ln-1643"></a>      <span class="n">ZenithAngDeg</span> <span class="o">=</span> <span class="n">ZenithAng</span><span class="o">/</span><span class="n">DegToRadians</span>
<a name="ln-1644"></a>
<a name="ln-1645"></a>      <span class="n">AnisoSkyMult</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1646"></a>
<a name="ln-1647"></a><span class="c">!           Relative air mass</span>
<a name="ln-1648"></a>      <span class="n">AirMassH</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="mf">0.1d0</span> <span class="o">*</span> <span class="n">Elevation</span> <span class="o">/</span> <span class="mi">100</span><span class="mf">0.d0</span><span class="p">)</span>
<a name="ln-1649"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ZenithAngDeg</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="mf">5.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1650"></a><span class="k">        </span><span class="n">AirMass</span>  <span class="o">=</span> <span class="n">AirMassH</span><span class="o">/</span><span class="n">CosZenithAng</span>
<a name="ln-1651"></a>      <span class="k">ELSE</span>
<a name="ln-1652"></a><span class="k">        </span><span class="n">AirMass</span> <span class="o">=</span> <span class="n">AirMassH</span><span class="o">/</span><span class="p">(</span><span class="n">CosZenithAng</span> <span class="o">+</span> <span class="mf">0.15d0</span><span class="o">*</span><span class="p">(</span><span class="mi">9</span><span class="mf">3.9d0</span><span class="o">-</span><span class="n">ZenithAngDeg</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.253d0</span><span class="p">))</span>
<a name="ln-1653"></a>      <span class="k">END IF</span>
<a name="ln-1654"></a><span class="k">      </span><span class="n">KappaZ3</span> <span class="o">=</span> <span class="mf">1.041d0</span><span class="o">*</span><span class="n">ZenithAng</span><span class="o">**</span><span class="mi">3</span>
<a name="ln-1655"></a>      <span class="nb">Epsilon</span> <span class="o">=</span> <span class="p">((</span><span class="n">BeamSolarRad</span><span class="o">+</span><span class="n">DifSolarRad</span><span class="p">)</span><span class="o">/</span><span class="n">DifSolarRad</span> <span class="o">+</span> <span class="n">KappaZ3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span><span class="n">KappaZ3</span><span class="p">)</span>
<a name="ln-1656"></a>      <span class="n">Delta</span> <span class="o">=</span> <span class="n">DifSolarRad</span><span class="o">*</span><span class="n">AirMass</span><span class="o">/</span><span class="mi">135</span><span class="mf">3.d0</span> <span class="c">! 1353 is average extraterrestrial irradiance (W/m2)</span>
<a name="ln-1657"></a><span class="c">!           Circumsolar (F1) and horizon/zenith (F2) brightening coefficients</span>
<a name="ln-1658"></a>      <span class="k">DO </span><span class="n">EpsilonBin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span>
<a name="ln-1659"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">EpsilonBin</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-1660"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">Epsilon</span> <span class="o">&lt;</span> <span class="n">EpsilonLimit</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">))</span> <span class="k">EXIT</span>
<a name="ln-1661"></a><span class="k">      END DO</span>
<a name="ln-1662"></a><span class="k">      </span><span class="n">F1</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">F11R</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">)</span> <span class="o">+</span> <span class="n">F12R</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">)</span><span class="o">*</span><span class="n">Delta</span> <span class="o">+</span> <span class="n">F13R</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">)</span><span class="o">*</span><span class="n">ZenithAng</span><span class="p">)</span>
<a name="ln-1663"></a>      <span class="n">F2</span> <span class="o">=</span> <span class="n">F21R</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">)</span> <span class="o">+</span> <span class="n">F22R</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">)</span><span class="o">*</span><span class="n">Delta</span> <span class="o">+</span> <span class="n">F23R</span><span class="p">(</span><span class="n">EpsilonBin</span><span class="p">)</span><span class="o">*</span><span class="n">ZenithAng</span>
<a name="ln-1664"></a>
<a name="ln-1665"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-1666"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1667"></a>
<a name="ln-1668"></a><span class="k">      </span><span class="n">CosIncAngBeamOnSurface</span> <span class="o">=</span> <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1669"></a>                <span class="o">+</span> <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-1670"></a>                <span class="o">+</span> <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1671"></a>      <span class="n">IncAng</span> <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">CosIncAngBeamOnSurface</span><span class="p">)</span>
<a name="ln-1672"></a>
<a name="ln-1673"></a>      <span class="n">ViewFactorSkyGeom</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSky</span>
<a name="ln-1674"></a>      <span class="n">MultIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ViewFactorSkyGeom</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">F1</span><span class="p">)</span>
<a name="ln-1675"></a><span class="c">!           0.0871557 below corresponds to a zenith angle of 85 deg</span>
<a name="ln-1676"></a>      <span class="n">CircumSolarFac</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span><span class="n">CosIncAngBeamOnSurface</span><span class="p">)</span><span class="o">/</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0871557d0</span><span class="p">,</span><span class="n">CosZenithAng</span><span class="p">)</span>
<a name="ln-1677"></a><span class="c">!           For near-horizontal roofs, model has an inconsistency that gives sky diffuse</span>
<a name="ln-1678"></a><span class="c">!           irradiance significantly different from DifSolarRad when zenith angle is</span>
<a name="ln-1679"></a><span class="c">!           above 85 deg. The following forces irradiance to be very close to DifSolarRad</span>
<a name="ln-1680"></a><span class="c">!           in this case.</span>
<a name="ln-1681"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CircumSolarFac</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CosZenithAng</span> <span class="o">&lt;</span> <span class="mf">0.0871557d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">&lt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1682"></a>        <span class="n">CircumSolarFac</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-1683"></a>      <span class="n">MultCircumSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">F1</span><span class="o">*</span><span class="n">CircumSolarFac</span>
<a name="ln-1684"></a>      <span class="n">MultHorizonZenith</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">F2</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-1685"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span>  <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-1686"></a>          <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1687"></a><span class="k">        </span><span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1688"></a>          <span class="n">MultIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1689"></a>          <span class="n">MultCircumSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1690"></a>          <span class="n">MultHorizonZenith</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">DifShdgRatioHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-1691"></a>      <span class="k">ELSE</span>
<a name="ln-1692"></a><span class="k">        </span><span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1693"></a>          <span class="n">MultIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1694"></a>          <span class="n">MultCircumSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-1695"></a>          <span class="n">MultHorizonZenith</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">DifShdgRatioHorizHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-1696"></a>        <span class="n">curDifShdgRatioIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-1697"></a>      <span class="n">ENDIF</span>
<a name="ln-1698"></a>      <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>  <span class="c">! make sure not negative.</span>
<a name="ln-1699"></a>    <span class="k">END DO</span>
<a name="ln-1700"></a>
<a name="ln-1701"></a><span class="k">END SUBROUTINE </span><span class="n">AnisoSkyViewFactors</span>
<a name="ln-1702"></a>
<a name="ln-1703"></a><span class="k">SUBROUTINE </span><span class="n">CHKBKS</span><span class="p">(</span><span class="n">NBS</span><span class="p">,</span><span class="n">NRS</span><span class="p">)</span>
<a name="ln-1704"></a>
<a name="ln-1705"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1706"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-1707"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-1708"></a>          <span class="c">!       MODIFIED       Nov 2001, FW: Reverse subroutine arguments NRS and NBS to</span>
<a name="ln-1709"></a>          <span class="c">!                                    correspond to how CHKBKS is called</span>
<a name="ln-1710"></a>          <span class="c">!                      Jan 2002, FW: change error message</span>
<a name="ln-1711"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-1712"></a>
<a name="ln-1713"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1714"></a>          <span class="c">! Determines whether a any vertices of the back surface are in front of the receiving surface;</span>
<a name="ln-1715"></a>          <span class="c">! if so, gives severe error.  Only base heat transfer surfaces are checked.</span>
<a name="ln-1716"></a>
<a name="ln-1717"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1718"></a>          <span class="c">! na</span>
<a name="ln-1719"></a>
<a name="ln-1720"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1721"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-1722"></a>
<a name="ln-1723"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1724"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-1725"></a>
<a name="ln-1726"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1727"></a>
<a name="ln-1728"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1729"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBS</span>       <span class="c">! Surface Number of the potential back surface</span>
<a name="ln-1730"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NRS</span>       <span class="c">! Surface Number of the potential shadow receiving surface</span>
<a name="ln-1731"></a>
<a name="ln-1732"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1733"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ValFmt</span><span class="o">=</span><span class="s2">&quot;(F20.4)&quot;</span>
<a name="ln-1734"></a>
<a name="ln-1735"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1736"></a>          <span class="c">! na</span>
<a name="ln-1737"></a>
<a name="ln-1738"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1739"></a>          <span class="c">! na</span>
<a name="ln-1740"></a>
<a name="ln-1741"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1742"></a>  <span class="kt">INTEGER </span><span class="n">N</span>             <span class="c">! Loop Control (vertex counter)</span>
<a name="ln-1743"></a>  <span class="kt">INTEGER </span><span class="n">NVRS</span>          <span class="c">! Number of vertices of the receiving surface</span>
<a name="ln-1744"></a>  <span class="kt">INTEGER </span><span class="n">NVBS</span>          <span class="c">! Number of vertices of the back surface</span>
<a name="ln-1745"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">AVec</span>    <span class="c">! Vector from vertex 2 to vertex 1, both same surface</span>
<a name="ln-1746"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">BVec</span>    <span class="c">! Vector from vertex 2 to vertex 3, both same surface</span>
<a name="ln-1747"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">CVec</span>    <span class="c">! Vector perpendicular to surface at vertex 2</span>
<a name="ln-1748"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">DVec</span>    <span class="c">! Vector from vertex 2 of first surface to vertex &#39;n&#39; of second surface</span>
<a name="ln-1749"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DOTP</span> <span class="c">! Dot product of C and D</span>
<a name="ln-1750"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="n">CharDotP</span>  <span class="c">! for error messages</span>
<a name="ln-1751"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="n">VTString</span>
<a name="ln-1752"></a>
<a name="ln-1753"></a>  <span class="n">NVRS</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1754"></a>  <span class="n">NVBS</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NBS</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a>          <span class="c">! SEE IF ANY VERTICES OF THE back surface ARE IN FRONT OF THE receiving surface</span>
<a name="ln-1757"></a>
<a name="ln-1758"></a>  <span class="n">AVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1759"></a>  <span class="n">BVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1760"></a>
<a name="ln-1761"></a>  <span class="n">CVec</span><span class="o">=</span><span class="n">BVec</span><span class="o">*</span><span class="n">AVec</span>
<a name="ln-1762"></a>
<a name="ln-1763"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVBS</span>
<a name="ln-1764"></a>    <span class="n">DVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NBS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1765"></a>    <span class="n">DOTP</span><span class="o">=</span><span class="n">CVec</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">DVec</span>
<a name="ln-1766"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DOTP</span> <span class="o">&gt;</span> <span class="p">.</span><span class="mi">0009</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1767"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Problem in interior solar distribution calculation (CHKBKS)&#39;</span><span class="p">)</span>
<a name="ln-1768"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1769"></a>       <span class="s1">&#39;   Solar Distribution = FullInteriorExterior will not work in Zone=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">ZoneName</span><span class="p">))</span>
<a name="ln-1770"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">VTString</span><span class="p">,</span><span class="s1">&#39;(I4)&#39;</span><span class="p">)</span> <span class="n">N</span>
<a name="ln-1771"></a>      <span class="n">VTString</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">VTString</span><span class="p">)</span>
<a name="ln-1772"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-1773"></a>       <span class="s1">&#39;   because vertex &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">VTString</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; of back surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NBS</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1774"></a>       <span class="o">//</span><span class="s1">&#39; is in front of receiving surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1775"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CharDotP</span><span class="p">,</span><span class="n">ValFmt</span><span class="p">)</span> <span class="n">DOTP</span>
<a name="ln-1776"></a>      <span class="n">CharDotP</span><span class="o">=</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CharDotp</span><span class="p">)</span>
<a name="ln-1777"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   (Dot Product indicator=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CharDotP</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-1778"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;   Check surface geometry; if OK, use Solar Distribution = FullExterior instead.&#39;</span><span class="p">)</span>
<a name="ln-1779"></a>    <span class="k">END IF</span>
<a name="ln-1780"></a><span class="k">  END DO</span>
<a name="ln-1781"></a>
<a name="ln-1782"></a><span class="k">  RETURN</span>
<a name="ln-1783"></a>
<a name="ln-1784"></a><span class="k">END SUBROUTINE </span><span class="n">CHKBKS</span>
<a name="ln-1785"></a>
<a name="ln-1786"></a><span class="k">SUBROUTINE </span><span class="n">CHKGSS</span><span class="p">(</span><span class="n">NRS</span><span class="p">,</span><span class="n">NSS</span><span class="p">,</span><span class="n">ZMIN</span><span class="p">,</span><span class="n">CannotShade</span><span class="p">)</span>
<a name="ln-1787"></a>
<a name="ln-1788"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1789"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-1790"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-1791"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1792"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-1793"></a>
<a name="ln-1794"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1795"></a>          <span class="c">! Determines the possible shadowing combinations.  The</span>
<a name="ln-1796"></a>          <span class="c">! routine checks detached shadowing or base heat transfer surfaces</span>
<a name="ln-1797"></a>          <span class="c">! for the possibility that they cannot shade a given base heat transfer surface.</span>
<a name="ln-1798"></a>
<a name="ln-1799"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1800"></a>          <span class="c">! Shadowing is not possible if:</span>
<a name="ln-1801"></a>          <span class="c">! 1.  The lowest point of the shadow receiving surface (receiving surface)</span>
<a name="ln-1802"></a>          <span class="c">!     Is higher than the highest point of the shadow casting surface (s.s.)</span>
<a name="ln-1803"></a>          <span class="c">! 2.  The shadow casting surface Faces up (e.g. A flat roof)</span>
<a name="ln-1804"></a>          <span class="c">! 3.  The shadow casting surface Is behind the receiving surface</span>
<a name="ln-1805"></a>          <span class="c">! 4.  The receiving surface is behind the shadow casting surface</span>
<a name="ln-1806"></a>
<a name="ln-1807"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1808"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-1809"></a>
<a name="ln-1810"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1811"></a>  <span class="k">USE </span><span class="n">Vectors</span>
<a name="ln-1812"></a>
<a name="ln-1813"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZMIN</span>   <span class="c">! Lowest point of the receiving surface</span>
<a name="ln-1817"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NRS</span>    <span class="c">! Surface number of the potential shadow receiving surface</span>
<a name="ln-1818"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NSS</span>    <span class="c">! Surface number of the potential shadow casting surface</span>
<a name="ln-1819"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CannotShade</span> <span class="c">! TRUE if shadow casting surface cannot shade receiving surface.</span>
<a name="ln-1820"></a>
<a name="ln-1821"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1822"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="nb">KIND</span><span class="o">=</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TolValue</span><span class="o">=</span><span class="mf">0.0003d0</span>
<a name="ln-1823"></a>
<a name="ln-1824"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1825"></a>          <span class="c">! na</span>
<a name="ln-1826"></a>
<a name="ln-1827"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1828"></a>          <span class="c">! na</span>
<a name="ln-1829"></a>
<a name="ln-1830"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1831"></a>  <span class="kt">INTEGER </span><span class="n">I</span>             <span class="c">! Loop Control (vertex counter)</span>
<a name="ln-1832"></a>  <span class="kt">INTEGER </span><span class="n">NVRS</span>          <span class="c">! Number of vertices of the receiving surface</span>
<a name="ln-1833"></a>  <span class="kt">INTEGER </span><span class="n">NVSS</span>          <span class="c">! Number of vertices of the shadow casting surface</span>
<a name="ln-1834"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">AVec</span>    <span class="c">! Vector from vertex 2 to vertex 1, both same surface</span>
<a name="ln-1835"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">BVec</span>    <span class="c">! Vector from vertex 2 to vertex 3, both same surface</span>
<a name="ln-1836"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">CVec</span>    <span class="c">! Vector perpendicular to surface at vertex 2</span>
<a name="ln-1837"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">Vector</span><span class="p">)</span> <span class="n">DVec</span>    <span class="c">! Vector from vertex 2 of first surface to vertex &#39;n&#39; of second surface</span>
<a name="ln-1838"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ZMAX</span> <span class="c">! Highest point of the shadow casting surface</span>
<a name="ln-1839"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DOTP</span> <span class="c">! Dot Product</span>
<a name="ln-1840"></a>
<a name="ln-1841"></a>  <span class="n">CannotShade</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1842"></a>  <span class="n">NVRS</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1843"></a>  <span class="n">NVSS</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-1844"></a>
<a name="ln-1845"></a>          <span class="c">! see if no point of shadow casting surface is above low point of receiving surface</span>
<a name="ln-1846"></a>
<a name="ln-1847"></a>  <span class="n">ZMAX</span><span class="o">=</span><span class="nb">MAXVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Sides</span><span class="p">)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-1848"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ZMAX</span> <span class="o">&lt;=</span> <span class="n">ZMIN</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1849"></a>
<a name="ln-1850"></a>          <span class="c">! SEE IF Shadow Casting Surface IS HORIZONTAL AND FACING UPWARD.</span>
<a name="ln-1851"></a>
<a name="ln-1852"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.9999d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1853"></a>
<a name="ln-1854"></a>          <span class="c">! SEE IF ANY VERTICES OF THE Shadow Casting Surface ARE ABOVE THE PLANE OF THE receiving surface</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>  <span class="n">AVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1857"></a>  <span class="n">BVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1858"></a>
<a name="ln-1859"></a>  <span class="n">CVec</span><span class="o">=</span><span class="n">BVec</span><span class="o">*</span><span class="n">AVec</span>
<a name="ln-1860"></a>
<a name="ln-1861"></a>  <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVSS</span>
<a name="ln-1862"></a>    <span class="n">DVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1863"></a>    <span class="n">DOTP</span><span class="o">=</span><span class="n">CVec</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">DVec</span>
<a name="ln-1864"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DOTP</span> <span class="o">&gt;</span> <span class="n">TolValue</span><span class="p">)</span> <span class="k">EXIT</span> <span class="c">! DO loop</span>
<a name="ln-1865"></a>  <span class="k">END DO</span>
<a name="ln-1866"></a>
<a name="ln-1867"></a>          <span class="c">! SEE IF ANY VERTICES OF THE receiving surface ARE ABOVE THE PLANE OF THE S.S.</span>
<a name="ln-1868"></a>
<a name="ln-1869"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DOTP</span> <span class="o">&gt;</span> <span class="n">TolValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1870"></a>
<a name="ln-1871"></a><span class="k">    </span><span class="n">AVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1872"></a>    <span class="n">BVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1873"></a>
<a name="ln-1874"></a>    <span class="n">CVec</span><span class="o">=</span><span class="n">BVec</span><span class="o">*</span><span class="n">AVec</span>
<a name="ln-1875"></a>
<a name="ln-1876"></a>    <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVRS</span>
<a name="ln-1877"></a>      <span class="n">DVec</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NRS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">NSS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1878"></a>      <span class="n">DOTP</span><span class="o">=</span><span class="n">CVec</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">DVec</span>
<a name="ln-1879"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DOTP</span> <span class="o">&gt;</span> <span class="n">TolValue</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1880"></a><span class="k">        </span><span class="n">CannotShade</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1881"></a>        <span class="k">EXIT</span> <span class="c">! DO loop</span>
<a name="ln-1882"></a>      <span class="n">ENDIF</span>
<a name="ln-1883"></a>    <span class="k">END DO</span>
<a name="ln-1884"></a>
<a name="ln-1885"></a><span class="k">  END IF</span>
<a name="ln-1886"></a>
<a name="ln-1887"></a><span class="k">  RETURN</span>
<a name="ln-1888"></a>
<a name="ln-1889"></a><span class="k">END SUBROUTINE </span><span class="n">CHKGSS</span>
<a name="ln-1890"></a>
<a name="ln-1891"></a><span class="k">SUBROUTINE </span><span class="n">CHKSBS</span><span class="p">(</span><span class="n">HTS</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">SBSNR</span><span class="p">)</span>
<a name="ln-1892"></a>
<a name="ln-1893"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-1894"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-1895"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-1896"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-1897"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-1898"></a>
<a name="ln-1899"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-1900"></a>          <span class="c">! Checks that a subsurface is completely</span>
<a name="ln-1901"></a>          <span class="c">! enclosed by its base surface.</span>
<a name="ln-1902"></a>
<a name="ln-1903"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-1904"></a>          <span class="c">! na</span>
<a name="ln-1905"></a>
<a name="ln-1906"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-1907"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-1908"></a>
<a name="ln-1909"></a>          <span class="c">! 3D Planar Polygons</span>
<a name="ln-1910"></a>          <span class="c">! In 3D applications, one sometimes wants to test a point and polygon that are in the same plane.</span>
<a name="ln-1911"></a>          <span class="c">! For example, one may have the intersection point of a ray with the plane of a polyhedron&#39;s face,</span>
<a name="ln-1912"></a>          <span class="c">! and want to test if it is inside the face.  Or one may want to know if the base of a 3D perpendicular</span>
<a name="ln-1913"></a>          <span class="c">! dropped from a point is inside a planar polygon.</span>
<a name="ln-1914"></a>
<a name="ln-1915"></a>          <span class="c">! 3D inclusion is easily determined by projecting the point and polygon into 2D.  To do this, one simply</span>
<a name="ln-1916"></a>          <span class="c">! ignores one of the 3D coordinates and uses the other two.  To optimally select the coordinate to ignore,</span>
<a name="ln-1917"></a>          <span class="c">! compute a normal vector to the plane, and select the coordinate with the largest absolute value [Snyder &amp; Barr, 1987].</span>
<a name="ln-1918"></a>          <span class="c">! This gives the projection of the polygon with maximum area, and results in robust computations.</span>
<a name="ln-1919"></a>          <span class="c">! John M. Snyder &amp; Alan H. Barr, &quot;Ray Tracing Complex Models Containing Surface Tessellations&quot;,</span>
<a name="ln-1920"></a>          <span class="c">! Computer Graphics 21(4), 119-126 (1987) [also in the Proceedings of SIGGRAPH 1987]</span>
<a name="ln-1921"></a>          <span class="c">!--- using adapted routine from Triangulation code -- EnergyPlus.</span>
<a name="ln-1922"></a>
<a name="ln-1923"></a>
<a name="ln-1924"></a>
<a name="ln-1925"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-1926"></a>          <span class="c">! na</span>
<a name="ln-1927"></a>
<a name="ln-1928"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-1929"></a>
<a name="ln-1930"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-1931"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTS</span>      <span class="c">! Heat transfer surface number of the general receiving surf</span>
<a name="ln-1932"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GRSNR</span>    <span class="c">! Surface number of general receiving surface</span>
<a name="ln-1933"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SBSNR</span>    <span class="c">! Surface number of subsurface</span>
<a name="ln-1934"></a>
<a name="ln-1935"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-1936"></a>          <span class="c">! MSG - for error message</span>
<a name="ln-1937"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSG</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;misses  &#39;</span><span class="p">,</span><span class="s1">&#39;        &#39;</span><span class="p">,</span><span class="s1">&#39;within  &#39;</span><span class="p">,</span><span class="s1">&#39;overlaps&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-1938"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">AFormat</span><span class="o">=</span><span class="s1">&#39;(1X,A)&#39;</span>
<a name="ln-1939"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">A4Format</span><span class="o">=</span><span class="s1">&#39;(1X,A,A,A,A)&#39;</span>
<a name="ln-1940"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">A2I2Format</span><span class="o">=</span><span class="s1">&#39;(1X,A,I5,A,I5)&#39;</span>
<a name="ln-1941"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">VFormat</span><span class="o">=</span><span class="s1">&#39;(1X,A,I5,A,&quot;(&quot;,2(F15.2,&quot;,&quot;),F15.2,&quot;)&quot;)&#39;</span>
<a name="ln-1942"></a>
<a name="ln-1943"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-1944"></a>          <span class="c">! na</span>
<a name="ln-1945"></a>
<a name="ln-1946"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-1947"></a>          <span class="c">! na</span>
<a name="ln-1948"></a>
<a name="ln-1949"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-1950"></a>  <span class="kt">INTEGER </span><span class="n">N</span>        <span class="c">! Loop Control</span>
<a name="ln-1951"></a>  <span class="kt">INTEGER </span><span class="n">NVT</span>      <span class="c">! Number of vertices</span>
<a name="ln-1952"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XVT</span>      <span class="c">! X Vertices of</span>
<a name="ln-1953"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YVT</span>      <span class="c">! Y vertices of</span>
<a name="ln-1954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ZVT</span>      <span class="c">! Z vertices of</span>
<a name="ln-1955"></a>
<a name="ln-1956"></a>  <span class="kt">INTEGER </span><span class="n">NS1</span>      <span class="c">! Number of the figure being overlapped</span>
<a name="ln-1957"></a>  <span class="kt">INTEGER </span><span class="n">NS2</span>      <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-1958"></a>  <span class="kt">INTEGER </span><span class="n">NS3</span>      <span class="c">! Location to place results of overlap</span>
<a name="ln-1959"></a>
<a name="ln-1960"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1961"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">inside</span>
<a name="ln-1962"></a>
<a name="ln-1963"></a>  <span class="kt">LOGICAL </span><span class="n">Out</span>
<a name="ln-1964"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">X1</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Z1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">Z2</span><span class="p">,</span><span class="n">BX</span><span class="p">,</span><span class="n">BY</span><span class="p">,</span><span class="n">BZ</span><span class="p">,</span><span class="n">BMAX</span> <span class="c">!,SX,SY,SZ</span>
<a name="ln-1965"></a><span class="c">!  INTEGER M</span>
<a name="ln-1966"></a>
<a name="ln-1967"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1968"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">XVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1969"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1970"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1971"></a>    <span class="n">XVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1972"></a>    <span class="n">YVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1973"></a>    <span class="n">ZVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1974"></a>    <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-1975"></a>  <span class="n">ENDIF</span>
<a name="ln-1976"></a>
<a name="ln-1977"></a>  <span class="n">NS1</span>    <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1978"></a>  <span class="n">NS2</span>    <span class="o">=</span> <span class="mi">2</span>
<a name="ln-1979"></a>  <span class="n">NS3</span>    <span class="o">=</span> <span class="mi">3</span>
<a name="ln-1980"></a>  <span class="n">HCT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1981"></a>  <span class="n">HCT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1982"></a>
<a name="ln-1983"></a>          <span class="c">! Put coordinates of base surface into clockwise sequence on the x&#39;-y&#39; plane.</span>
<a name="ln-1984"></a>
<a name="ln-1985"></a>  <span class="n">XVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1986"></a>  <span class="n">YVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1987"></a>  <span class="n">ZVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1988"></a>  <span class="n">XVS</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1989"></a>  <span class="n">YVS</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1990"></a>  <span class="k">CALL </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">HTS</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-1991"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-1992"></a>    <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-1993"></a>    <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-1994"></a>  <span class="k">END DO</span>
<a name="ln-1995"></a>
<a name="ln-1996"></a><span class="k">  CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS2</span><span class="p">,</span><span class="n">NVT</span><span class="p">)</span>
<a name="ln-1997"></a>
<a name="ln-1998"></a>          <span class="c">! Put coordinates of the subsurface into clockwise sequence.</span>
<a name="ln-1999"></a>
<a name="ln-2000"></a>  <span class="n">NVS</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-2001"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVS</span>
<a name="ln-2002"></a>    <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2003"></a>    <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2004"></a>  <span class="k">END DO</span>
<a name="ln-2005"></a><span class="k">  CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-2006"></a>
<a name="ln-2007"></a>          <span class="c">! Determine the overlap condition.</span>
<a name="ln-2008"></a>
<a name="ln-2009"></a>  <span class="k">CALL </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-2010"></a>
<a name="ln-2011"></a>          <span class="c">! Print error condition if necessary.</span>
<a name="ln-2012"></a>
<a name="ln-2013"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">/=</span> <span class="n">FirstSurfWithinSecond</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2014"></a><span class="k">      </span><span class="n">OUT</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2015"></a><span class="c">!C                            COMPUTE COMPONENTS OF VECTOR</span>
<a name="ln-2016"></a><span class="c">!C                            NORMAL TO BASE SURFACE.</span>
<a name="ln-2017"></a>      <span class="n">X1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">X</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span> <span class="c">!XV(1,GRSNR)-XV(2,GRSNR)</span>
<a name="ln-2018"></a>      <span class="n">Y1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Y</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span> <span class="c">!YV(1,GRSNR)-YV(2,GRSNR)</span>
<a name="ln-2019"></a>      <span class="n">Z1</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">Z</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span> <span class="c">!ZV(1,GRSNR)-ZV(2,GRSNR)</span>
<a name="ln-2020"></a>      <span class="n">X2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">X</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">X</span> <span class="c">!XV(3,GRSNR)-XV(2,GRSNR)</span>
<a name="ln-2021"></a>      <span class="n">Y2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Y</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Y</span> <span class="c">!YV(3,GRSNR)-YV(2,GRSNR)</span>
<a name="ln-2022"></a>      <span class="n">Z2</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">3</span><span class="p">)%</span><span class="n">Z</span><span class="o">-</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="mi">2</span><span class="p">)%</span><span class="n">Z</span> <span class="c">!ZV(3,GRSNR)-ZV(2,GRSNR)</span>
<a name="ln-2023"></a>      <span class="n">BX</span> <span class="o">=</span> <span class="n">Y1</span><span class="o">*</span><span class="n">Z2</span><span class="o">-</span><span class="n">Y2</span><span class="o">*</span><span class="n">Z1</span>
<a name="ln-2024"></a>      <span class="n">BY</span> <span class="o">=</span> <span class="n">Z1</span><span class="o">*</span><span class="n">X2</span><span class="o">-</span><span class="n">Z2</span><span class="o">*</span><span class="n">X1</span>
<a name="ln-2025"></a>      <span class="n">BZ</span> <span class="o">=</span> <span class="n">X1</span><span class="o">*</span><span class="n">Y2</span><span class="o">-</span><span class="n">X2</span><span class="o">*</span><span class="n">Y1</span>
<a name="ln-2026"></a><span class="c">!C                            FIND LARGEST COMPONENT.</span>
<a name="ln-2027"></a>      <span class="n">BMAX</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">BX</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">BY</span><span class="p">),</span><span class="nb">ABS</span><span class="p">(</span><span class="n">BZ</span><span class="p">))</span>
<a name="ln-2028"></a><span class="c">!C</span>
<a name="ln-2029"></a>      <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">BX</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="n">BMAX</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2030"></a><span class="c">!        write(outputfiledebug,*) &#39; looking bx-bmax&#39;,bmax</span>
<a name="ln-2031"></a>        <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span> <span class="c">!NV(SBSNR)</span>
<a name="ln-2032"></a>          <span class="n">inside</span><span class="o">=</span><span class="n">polygon_contains_point</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">),.</span><span class="n">true</span><span class="p">.,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-2033"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">inside</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2034"></a><span class="k">            </span><span class="n">OUT</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2035"></a><span class="c">!            do m=1,surface(grsnr)%sides</span>
<a name="ln-2036"></a><span class="c">!            write(outputfiledebug,*) &#39;grsnr,side=&#39;,m,surface(grsnr)%vertex</span>
<a name="ln-2037"></a><span class="c">!            write(outputfiledebug,*) &#39;point outside=&#39;,surface(sbsnr)%vertex(n)</span>
<a name="ln-2038"></a><span class="c">!            enddo</span>
<a name="ln-2039"></a><span class="c">!            EXIT</span>
<a name="ln-2040"></a>          <span class="n">ENDIF</span>
<a name="ln-2041"></a><span class="c">!          Y1 = Surface(GRSNR)%Vertex(Surface(GRSNR)%Sides)%Y-Surface(SBSNR)%Vertex(N)%Y !YV(NV(GRSNR),GRSNR)-YV(N,SBSNR)</span>
<a name="ln-2042"></a><span class="c">!          Z1 = Surface(GRSNR)%Vertex(Surface(GRSNR)%Sides)%Z-Surface(SBSNR)%Vertex(N)%Z !ZV(NV(GRSNR),GRSNR)-ZV(N,SBSNR)</span>
<a name="ln-2043"></a><span class="c">!          DO M=1,Surface(GRSNR)%Sides !NV(GRSNR)</span>
<a name="ln-2044"></a><span class="c">!            Y2 = Y1</span>
<a name="ln-2045"></a><span class="c">!            Z2 = Z1</span>
<a name="ln-2046"></a><span class="c">!            Y1 = Surface(GRSNR)%Vertex(M)%Y-Surface(SBSNR)%Vertex(N)%Y !YV(M,GRSNR)-YV(N,SBSNR)</span>
<a name="ln-2047"></a><span class="c">!            Z1 = Surface(GRSNR)%Vertex(M)%Z-Surface(SBSNR)%Vertex(N)%Z !ZV(M,GRSNR)-ZV(N,SBSNR)</span>
<a name="ln-2048"></a><span class="c">!            SX = Y1*Z2-Y2*Z1</span>
<a name="ln-2049"></a><span class="c">!            IF(SX*BX.LT.-1.0E-6) THEN</span>
<a name="ln-2050"></a><span class="c">!              OUT=.TRUE.</span>
<a name="ln-2051"></a><span class="c">!              write(outputfiledebug,*) &#39;sx*bx=&#39;,sx*bx</span>
<a name="ln-2052"></a><span class="c">!              write(outputfiledebug,*) &#39;grsnr=&#39;,surface(grsnr)%vertex(m)</span>
<a name="ln-2053"></a><span class="c">!              write(outputfiledebug,*) &#39;sbsnr=&#39;,surface(sbsnr)%vertex(n)</span>
<a name="ln-2054"></a><span class="c">!            endif</span>
<a name="ln-2055"></a><span class="c">!          ENDDO</span>
<a name="ln-2056"></a><span class="c">!          IF (OUT) EXIT</span>
<a name="ln-2057"></a>        <span class="n">ENDDO</span>
<a name="ln-2058"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">BY</span><span class="p">).</span><span class="n">EQ</span><span class="p">.</span><span class="n">BMAX</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2059"></a><span class="c">!        write(outputfiledebug,*) &#39; looking by-bmax&#39;,bmax</span>
<a name="ln-2060"></a>        <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span> <span class="c">!NV(SBSNR)</span>
<a name="ln-2061"></a>          <span class="n">inside</span><span class="o">=</span><span class="n">polygon_contains_point</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">),.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.,.</span><span class="n">false</span><span class="p">.)</span>
<a name="ln-2062"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">inside</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2063"></a><span class="k">            </span><span class="n">OUT</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2064"></a><span class="c">!            do m=1,surface(grsnr)%sides</span>
<a name="ln-2065"></a><span class="c">!            write(outputfiledebug,*) &#39;grsnr,side=&#39;,m,surface(grsnr)%vertex</span>
<a name="ln-2066"></a><span class="c">!            write(outputfiledebug,*) &#39;point outside=&#39;,surface(sbsnr)%vertex(n)</span>
<a name="ln-2067"></a><span class="c">!            enddo</span>
<a name="ln-2068"></a><span class="c">!            EXIT</span>
<a name="ln-2069"></a>          <span class="n">ENDIF</span>
<a name="ln-2070"></a><span class="c">!          Z1 = Surface(GRSNR)%Vertex(Surface(GRSNR)%Sides)%Z-Surface(SBSNR)%Vertex(N)%Z !ZV(NV(GRSNR),GRSNR)-ZV(N,SBSNR)</span>
<a name="ln-2071"></a><span class="c">!          X1 = Surface(GRSNR)%Vertex(Surface(GRSNR)%Sides)%X-Surface(SBSNR)%Vertex(N)%X !XV(NV(GRSNR),GRSNR)-XV(N,SBSNR)</span>
<a name="ln-2072"></a><span class="c">!          DO M=1,Surface(GRSNR)%Sides !NV(GRSNR)</span>
<a name="ln-2073"></a><span class="c">!            Z2 = Z1</span>
<a name="ln-2074"></a><span class="c">!            X2 = X1</span>
<a name="ln-2075"></a><span class="c">!            Z1 = Surface(GRSNR)%Vertex(M)%Z-Surface(SBSNR)%Vertex(N)%Z !ZV(M,GRSNR)-ZV(N,SBSNR)</span>
<a name="ln-2076"></a><span class="c">!            X1 = Surface(GRSNR)%Vertex(M)%X-Surface(SBSNR)%Vertex(N)%X !XV(M,GRSNR)-XV(N,SBSNR)</span>
<a name="ln-2077"></a><span class="c">!            SY = Z1*X2-Z2*X1</span>
<a name="ln-2078"></a><span class="c">!            IF(SY*BY.LT.-1.0E-6) THEN</span>
<a name="ln-2079"></a><span class="c">!              OUT=.TRUE.</span>
<a name="ln-2080"></a><span class="c">!              write(outputfiledebug,*) &#39;sy*by=&#39;,sy*by</span>
<a name="ln-2081"></a><span class="c">!              write(outputfiledebug,*) &#39;grsnr=&#39;,surface(grsnr)%vertex(m)</span>
<a name="ln-2082"></a><span class="c">!              write(outputfiledebug,*) &#39;sbsnr=&#39;,surface(sbsnr)%vertex(n)</span>
<a name="ln-2083"></a><span class="c">!            ENDIF</span>
<a name="ln-2084"></a><span class="c">!          ENDDO</span>
<a name="ln-2085"></a><span class="c">!          IF (OUT) EXIT</span>
<a name="ln-2086"></a>        <span class="n">ENDDO</span>
<a name="ln-2087"></a>      <span class="k">ELSE</span>
<a name="ln-2088"></a><span class="c">!        write(outputfiledebug,*) &#39; looking bz-bmax&#39;,bmax</span>
<a name="ln-2089"></a>        <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span> <span class="c">!NV(SBSNR)</span>
<a name="ln-2090"></a>          <span class="n">inside</span><span class="o">=</span><span class="n">polygon_contains_point</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Sides</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">),.</span><span class="n">false</span><span class="p">.,.</span><span class="n">false</span><span class="p">.,.</span><span class="n">true</span><span class="p">.)</span>
<a name="ln-2091"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">inside</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2092"></a><span class="k">            </span><span class="n">OUT</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-2093"></a><span class="c">!            do m=1,surface(grsnr)%sides</span>
<a name="ln-2094"></a><span class="c">!            write(outputfiledebug,*) &#39;grsnr,side=&#39;,m,surface(grsnr)%vertex</span>
<a name="ln-2095"></a><span class="c">!            write(outputfiledebug,*) &#39;point outside=&#39;,surface(sbsnr)%vertex(n)</span>
<a name="ln-2096"></a><span class="c">!            enddo</span>
<a name="ln-2097"></a><span class="c">!            EXIT</span>
<a name="ln-2098"></a>          <span class="n">ENDIF</span>
<a name="ln-2099"></a><span class="c">!          X1 = Surface(GRSNR)%Vertex(Surface(GRSNR)%Sides)%X-Surface(SBSNR)%Vertex(N)%X !XV(NV(GRSNR),GRSNR)-XV(N,SBSNR)</span>
<a name="ln-2100"></a><span class="c">!          Y1 = Surface(GRSNR)%Vertex(Surface(GRSNR)%Sides)%Y-Surface(SBSNR)%Vertex(N)%Y !YV(NV(GRSNR),GRSNR)-YV(N,SBSNR)</span>
<a name="ln-2101"></a><span class="c">!          DO M=1,Surface(GRSNR)%Sides !NV(GRSNR)</span>
<a name="ln-2102"></a><span class="c">!            X2 = X1</span>
<a name="ln-2103"></a><span class="c">!            Y2 = Y1</span>
<a name="ln-2104"></a><span class="c">!            X1 = Surface(GRSNR)%Vertex(M)%X-Surface(SBSNR)%Vertex(N)%X !XV(M,GRSNR)-XV(N,SBSNR)</span>
<a name="ln-2105"></a><span class="c">!            Y1 = Surface(GRSNR)%Vertex(M)%Y-Surface(SBSNR)%Vertex(N)%Y !YV(M,GRSNR)-YV(N,SBSNR)</span>
<a name="ln-2106"></a><span class="c">!            SZ = X1*Y2-X2*Y1</span>
<a name="ln-2107"></a><span class="c">!            IF(SZ*BZ.LT.-1.0E-6) THEN</span>
<a name="ln-2108"></a><span class="c">!              OUT=.TRUE.</span>
<a name="ln-2109"></a><span class="c">!              write(outputfiledebug,*) &#39;sz*bz=&#39;,sz*bz</span>
<a name="ln-2110"></a><span class="c">!              write(outputfiledebug,*) &#39;grsnr=&#39;,surface(grsnr)%vertex(m)</span>
<a name="ln-2111"></a><span class="c">!              write(outputfiledebug,*) &#39;sbsnr=&#39;,surface(sbsnr)%vertex(n)</span>
<a name="ln-2112"></a><span class="c">!            ENDIF</span>
<a name="ln-2113"></a><span class="c">!          ENDDO</span>
<a name="ln-2114"></a><span class="c">!          IF (OUT) EXIT</span>
<a name="ln-2115"></a>        <span class="n">ENDDO</span>
<a name="ln-2116"></a>      <span class="k">END IF</span>
<a name="ln-2117"></a><span class="c">!    CALL ShowWarningError(&#39;Base surface does not surround subsurface (CHKSBS), Overlap Status=&#39;//  &amp;</span>
<a name="ln-2118"></a><span class="c">!                           TRIM(cOverLapStatus(OverLapStatus)))</span>
<a name="ln-2119"></a><span class="c">!    CALL ShowContinueError(&#39;Surface &quot;&#39;//TRIM(Surface(GRSNR)%Name)//&#39;&quot; &#39;//TRIM(MSG(OverlapStatus))//  &amp;</span>
<a name="ln-2120"></a><span class="c">!                     &#39; SubSurface &quot;&#39;//TRIM(Surface(SBSNR)%Name)//&#39;&quot;&#39;)</span>
<a name="ln-2121"></a><span class="c">!    IF (FirstSurroundError) THEN</span>
<a name="ln-2122"></a><span class="c">!      CALL ShowWarningError(&#39;Base Surface does not surround subsurface errors occuring...&#39;//  &amp;</span>
<a name="ln-2123"></a><span class="c">!                     &#39;Check that the SurfaceGeometry object is expressing the proper starting corner and &#39;//  &amp;</span>
<a name="ln-2124"></a><span class="c">!                     &#39;direction [CounterClockwise/Clockwise]&#39;)</span>
<a name="ln-2125"></a><span class="c">!      FirstSurroundError=.false.</span>
<a name="ln-2126"></a><span class="c">!    ENDIF</span>
<a name="ln-2127"></a><span class="k">IF</span> <span class="p">(</span><span class="n">Out</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2128"></a><span class="k">    </span><span class="n">NumBaseSubSurround</span><span class="o">=</span><span class="n">NumBaseSubSurround</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2129"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumBaseSubSurround</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2130"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="n">NumBaseSubSurround</span><span class="p">))</span>
<a name="ln-2131"></a>      <span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumBaseSubSurround</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">TrackBaseSubSurround</span>
<a name="ln-2132"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">)</span>
<a name="ln-2133"></a>      <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">NumBaseSubSurround</span><span class="p">))</span>
<a name="ln-2134"></a>      <span class="n">TrackBaseSubSurround</span><span class="o">=</span><span class="n">TempSurfErrorTracking</span>
<a name="ln-2135"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">)</span>
<a name="ln-2136"></a>    <span class="k">ELSE</span>
<a name="ln-2137"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">NumBaseSubSurround</span><span class="p">))</span>
<a name="ln-2138"></a>    <span class="n">ENDIF</span>
<a name="ln-2139"></a>    <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">NumBaseSubSurround</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="o">=</span><span class="n">GRSNR</span>
<a name="ln-2140"></a>    <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">NumBaseSubSurround</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="o">=</span><span class="n">SBSNR</span>
<a name="ln-2141"></a>    <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">NumBaseSubSurround</span><span class="p">)%</span><span class="n">MiscIndex</span><span class="o">=</span><span class="n">OverLapStatus</span>
<a name="ln-2142"></a><span class="c">!    CALL ShowRecurringWarningErrorAtEnd(&#39;Base surface does not surround subsurface (CHKSBS), Overlap Status=&#39;//  &amp;</span>
<a name="ln-2143"></a><span class="c">!                       TRIM(cOverLapStatus(OverLapStatus)), &amp;</span>
<a name="ln-2144"></a><span class="c">!                       TrackBaseSubSurround(GRSNR)%ErrIndex1)</span>
<a name="ln-2145"></a><span class="c">!    CALL ShowRecurringContinueErrorAtEnd(&#39;Surface &quot;&#39;//TRIM(Surface(GRSNR)%Name)//&#39;&quot; &#39;//TRIM(MSG(OverlapStatus))//  &amp;</span>
<a name="ln-2146"></a><span class="c">!                       &#39; SubSurface &quot;&#39;//TRIM(Surface(SBSNR)%Name)//&#39;&quot;&#39;,  &amp;</span>
<a name="ln-2147"></a><span class="c">!                      TrackBaseSubSurround(SBSNR)%ErrIndex2)</span>
<a name="ln-2148"></a>
<a name="ln-2149"></a>    <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="s1">&#39;==== Base does not Surround subsurface details ====&#39;</span>
<a name="ln-2150"></a>    <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">A4Format</span><span class="p">)</span> <span class="s1">&#39;Surface=&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cOverLapStatus</span><span class="p">(</span><span class="n">OverLapStatus</span><span class="p">))</span>
<a name="ln-2151"></a>    <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">A2I2Format</span><span class="p">)</span> <span class="s1">&#39;Surface#=&#39;</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="s1">&#39; NSides=&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-2152"></a>    <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-2153"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">VFormat</span><span class="p">)</span> <span class="s1">&#39;Vertex &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2154"></a>    <span class="n">ENDDO</span>
<a name="ln-2155"></a>    <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">A4Format</span><span class="p">)</span> <span class="s1">&#39;SubSurface=&#39;</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-2156"></a>    <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">A2I2Format</span><span class="p">)</span> <span class="s1">&#39;Surface#=&#39;</span><span class="p">,</span><span class="n">SBSNR</span><span class="p">,</span><span class="s1">&#39; NSides=&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-2157"></a>    <span class="k">DO </span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-2158"></a>      <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">VFormat</span><span class="p">)</span> <span class="s1">&#39;Vertex &#39;</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2159"></a>    <span class="n">ENDDO</span>
<a name="ln-2160"></a>    <span class="k">write</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">AFormat</span><span class="p">)</span> <span class="s1">&#39;================================&#39;</span>
<a name="ln-2161"></a>  <span class="k">END IF</span>
<a name="ln-2162"></a><span class="n">ENDIF</span>
<a name="ln-2163"></a>  <span class="k">RETURN</span>
<a name="ln-2164"></a>
<a name="ln-2165"></a><span class="k">contains</span>
<a name="ln-2166"></a>
<a name="ln-2167"></a><span class="k">function </span><span class="n">polygon_contains_point</span> <span class="p">(</span> <span class="n">nsides</span><span class="p">,</span> <span class="n">polygon_3d</span><span class="p">,</span> <span class="n">point_3d</span><span class="p">,</span> <span class="n">ignorex</span><span class="p">,</span> <span class="n">ignorey</span><span class="p">,</span> <span class="n">ignorez</span><span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">inside</span><span class="p">)</span>
<a name="ln-2168"></a>
<a name="ln-2169"></a>          <span class="c">! Function information:</span>
<a name="ln-2170"></a>          <span class="c">!       Author         Linda Lawrie</span>
<a name="ln-2171"></a>          <span class="c">!       Date written   October 2005</span>
<a name="ln-2172"></a>          <span class="c">!       Modified       na</span>
<a name="ln-2173"></a>          <span class="c">!       Re-engineered  na</span>
<a name="ln-2174"></a>
<a name="ln-2175"></a>          <span class="c">! Purpose of this function:</span>
<a name="ln-2176"></a>          <span class="c">! Determine if a point is inside a simple 2d polygon.  For a simple polygon (one whose</span>
<a name="ln-2177"></a>          <span class="c">! boundary never crosses itself).  The polygon does not need to be convex.</span>
<a name="ln-2178"></a>
<a name="ln-2179"></a>          <span class="c">! Methodology employed:</span>
<a name="ln-2180"></a>          <span class="c">! &lt;Description&gt;</span>
<a name="ln-2181"></a>
<a name="ln-2182"></a>          <span class="c">! References:</span>
<a name="ln-2183"></a>          <span class="c">! M Shimrat, Position of Point Relative to Polygon, ACM Algorithm 112,</span>
<a name="ln-2184"></a>          <span class="c">! Communications of the ACM, Volume 5, Number 8, page 434, August 1962.</span>
<a name="ln-2185"></a>
<a name="ln-2186"></a>          <span class="c">! Use statements:</span>
<a name="ln-2187"></a>  <span class="k">Use </span><span class="n">DataVectorTypes</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a>  <span class="k">Implicit none</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2190"></a>
<a name="ln-2191"></a>          <span class="c">! Function argument definitions:</span>
<a name="ln-2192"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nsides</span>      <span class="c">! number of sides (vertices)</span>
<a name="ln-2193"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">polygon_3d</span><span class="p">(</span><span class="n">nsides</span><span class="p">)</span>  <span class="c">! points of polygon</span>
<a name="ln-2194"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span> <span class="kd">::</span> <span class="n">point_3d</span>  <span class="c">! point to be tested</span>
<a name="ln-2195"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ignorex</span>
<a name="ln-2196"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ignorey</span>
<a name="ln-2197"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ignorez</span>
<a name="ln-2198"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">inside</span>  <span class="c">! return value, true=inside, false = not inside</span>
<a name="ln-2199"></a>
<a name="ln-2200"></a>          <span class="c">! Function parameter definitions:</span>
<a name="ln-2201"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">point_tolerance</span><span class="o">=</span><span class="p">.</span><span class="mi">00001</span><span class="n">d0</span>
<a name="ln-2202"></a>
<a name="ln-2203"></a>          <span class="c">! Interface block specifications:</span>
<a name="ln-2204"></a>          <span class="c">! na</span>
<a name="ln-2205"></a>
<a name="ln-2206"></a>          <span class="c">! Derived type definitions:</span>
<a name="ln-2207"></a>          <span class="c">! na</span>
<a name="ln-2208"></a>
<a name="ln-2209"></a>          <span class="c">! Function local variable declarations:</span>
<a name="ln-2210"></a>  <span class="kt">integer </span><span class="n">i</span>
<a name="ln-2211"></a>  <span class="kt">integer </span><span class="n">ip1</span>
<a name="ln-2212"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector_2d</span><span class="p">)</span> <span class="n">polygon</span><span class="p">(</span><span class="n">nsides</span><span class="p">)</span>
<a name="ln-2213"></a>  <span class="k">type</span><span class="p">(</span><span class="n">vector_2d</span><span class="p">)</span> <span class="n">point</span>
<a name="ln-2214"></a>
<a name="ln-2215"></a>  <span class="n">inside</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-2216"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">ignorex</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2217"></a><span class="k">    </span><span class="n">polygon</span><span class="p">%</span><span class="n">x</span><span class="o">=</span><span class="n">polygon_3d</span><span class="p">%</span><span class="n">y</span>
<a name="ln-2218"></a>    <span class="n">polygon</span><span class="p">%</span><span class="n">y</span><span class="o">=</span><span class="n">polygon_3d</span><span class="p">%</span><span class="n">z</span>
<a name="ln-2219"></a>    <span class="n">point</span><span class="p">%</span><span class="n">x</span><span class="o">=</span><span class="n">point_3d</span><span class="p">%</span><span class="n">y</span>
<a name="ln-2220"></a>    <span class="n">point</span><span class="p">%</span><span class="n">y</span><span class="o">=</span><span class="n">point_3d</span><span class="p">%</span><span class="n">z</span>
<a name="ln-2221"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="n">ignorey</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2222"></a><span class="k">    </span><span class="n">polygon</span><span class="p">%</span><span class="n">x</span><span class="o">=</span><span class="n">polygon_3d</span><span class="p">%</span><span class="n">x</span>
<a name="ln-2223"></a>    <span class="n">polygon</span><span class="p">%</span><span class="n">y</span><span class="o">=</span><span class="n">polygon_3d</span><span class="p">%</span><span class="n">z</span>
<a name="ln-2224"></a>    <span class="n">point</span><span class="p">%</span><span class="n">x</span><span class="o">=</span><span class="n">point_3d</span><span class="p">%</span><span class="n">x</span>
<a name="ln-2225"></a>    <span class="n">point</span><span class="p">%</span><span class="n">y</span><span class="o">=</span><span class="n">point_3d</span><span class="p">%</span><span class="n">z</span>
<a name="ln-2226"></a>  <span class="n">elseif</span> <span class="p">(</span><span class="n">ignorez</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-2227"></a><span class="k">    </span><span class="n">polygon</span><span class="p">%</span><span class="n">x</span><span class="o">=</span><span class="n">polygon_3d</span><span class="p">%</span><span class="n">x</span>
<a name="ln-2228"></a>    <span class="n">polygon</span><span class="p">%</span><span class="n">y</span><span class="o">=</span><span class="n">polygon_3d</span><span class="p">%</span><span class="n">y</span>
<a name="ln-2229"></a>    <span class="n">point</span><span class="p">%</span><span class="n">x</span><span class="o">=</span><span class="n">point_3d</span><span class="p">%</span><span class="n">x</span>
<a name="ln-2230"></a>    <span class="n">point</span><span class="p">%</span><span class="n">y</span><span class="o">=</span><span class="n">point_3d</span><span class="p">%</span><span class="n">y</span>
<a name="ln-2231"></a>  <span class="n">endif</span>
<a name="ln-2232"></a>
<a name="ln-2233"></a>  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsides</span>
<a name="ln-2234"></a>
<a name="ln-2235"></a>    <span class="k">if</span> <span class="p">(</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nsides</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-2236"></a><span class="k">      </span><span class="n">ip1</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2237"></a>    <span class="k">else</span>
<a name="ln-2238"></a><span class="k">      </span><span class="n">ip1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2239"></a>    <span class="k">end if</span>
<a name="ln-2240"></a>
<a name="ln-2241"></a><span class="k">    if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">y</span>   <span class="o">&lt;</span>  <span class="n">point</span><span class="p">%</span><span class="n">y</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">point</span><span class="p">%</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">ip1</span><span class="p">)%</span><span class="n">y</span>   <span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2242"></a>         <span class="p">(</span> <span class="n">point</span><span class="p">%</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">y</span>   <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">polygon</span><span class="p">(</span><span class="n">ip1</span><span class="p">)%</span><span class="n">y</span>   <span class="o">&lt;</span> <span class="n">point</span><span class="p">%</span><span class="n">y</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-2243"></a><span class="k">      if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">point</span><span class="p">%</span><span class="n">x</span> <span class="o">-</span> <span class="n">polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">x</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="n">point</span><span class="p">%</span><span class="n">y</span> <span class="o">-</span> <span class="n">polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">y</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2244"></a>         <span class="o">*</span> <span class="p">(</span> <span class="n">polygon</span><span class="p">(</span><span class="n">ip1</span><span class="p">)%</span><span class="n">x</span> <span class="o">-</span> <span class="n">polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">x</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">polygon</span><span class="p">(</span><span class="n">ip1</span><span class="p">)%</span><span class="n">y</span> <span class="o">-</span> <span class="n">polygon</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">y</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-2245"></a><span class="k">        </span><span class="n">inside</span> <span class="o">=</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">inside</span>
<a name="ln-2246"></a>      <span class="k">end if</span>
<a name="ln-2247"></a><span class="k">    end if</span>
<a name="ln-2248"></a>
<a name="ln-2249"></a><span class="k">  end do</span>
<a name="ln-2250"></a>
<a name="ln-2251"></a><span class="k">  return</span>
<a name="ln-2252"></a>
<a name="ln-2253"></a><span class="k">end function </span><span class="n">polygon_contains_point</span>
<a name="ln-2254"></a>
<a name="ln-2255"></a><span class="k">END SUBROUTINE </span><span class="n">CHKSBS</span>
<a name="ln-2256"></a>
<a name="ln-2257"></a><span class="k">SUBROUTINE </span><span class="n">ComputeIntSolarAbsorpFactors</span>
<a name="ln-2258"></a>
<a name="ln-2259"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2260"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-2261"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2262"></a>          <span class="c">!       MODIFIED       B. Griffith, Oct 2010, deal with no floor case</span>
<a name="ln-2263"></a>          <span class="c">!                      L. Lawrie, Mar 2012, relax &gt;154 tilt even further (&gt;120 considered non-wall by ASHRAE)</span>
<a name="ln-2264"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-2265"></a>
<a name="ln-2266"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2267"></a>          <span class="c">! This routine computes the fractions of diffusely transmitted</span>
<a name="ln-2268"></a>          <span class="c">! solar energy absorbed by each zone surface.</span>
<a name="ln-2269"></a>
<a name="ln-2270"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2271"></a>          <span class="c">! It is assumed that all transmitted solar energy is incident</span>
<a name="ln-2272"></a>          <span class="c">! on the floors of the zone.  The fraction directly absorbed in</span>
<a name="ln-2273"></a>          <span class="c">! the floor is given by &#39;ISABSF&#39;.  It is proportional to the</span>
<a name="ln-2274"></a>          <span class="c">! area * solar absorptance.  The remaining solar energy is then</span>
<a name="ln-2275"></a>          <span class="c">! distributed uniformly around the room according to</span>
<a name="ln-2276"></a>          <span class="c">! area*absorptance product</span>
<a name="ln-2277"></a>
<a name="ln-2278"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2279"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2282"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-2283"></a>  <span class="k">USE </span><span class="n">DataWindowEquivalentLayer</span>
<a name="ln-2284"></a>
<a name="ln-2285"></a>
<a name="ln-2286"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2287"></a>
<a name="ln-2288"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2289"></a>          <span class="c">! na</span>
<a name="ln-2290"></a>
<a name="ln-2291"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2292"></a>          <span class="c">! na</span>
<a name="ln-2293"></a>
<a name="ln-2294"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2295"></a>          <span class="c">! na</span>
<a name="ln-2296"></a>
<a name="ln-2297"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2298"></a>          <span class="c">! na</span>
<a name="ln-2299"></a>
<a name="ln-2300"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2301"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span>    <span class="n">ConstrNum</span>        <span class="c">! Index for constructions</span>
<a name="ln-2302"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span>    <span class="n">FirstZoneSurf</span>    <span class="c">! Index of first surface in current zone</span>
<a name="ln-2303"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span>    <span class="n">LastZoneSurf</span>     <span class="c">! Index of last surface in current zone</span>
<a name="ln-2304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span>    <span class="n">AreaSum</span>              <span class="c">! Intermediate calculation value</span>
<a name="ln-2305"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span>    <span class="n">SurfNum</span>          <span class="c">! DO loop counter for zone surfaces</span>
<a name="ln-2306"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span>    <span class="n">ZoneNum</span>          <span class="c">! Loop Counter for Zones</span>
<a name="ln-2307"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span>    <span class="n">Lay</span>              <span class="c">! Window glass layer number</span>
<a name="ln-2308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span>    <span class="n">AbsDiffTotWin</span>    <span class="c">! Sum of a window&#39;s glass layer solar absorptances</span>
<a name="ln-2309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span>    <span class="n">TestFractSum</span>
<a name="ln-2310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span>    <span class="n">HorizAreaSum</span>
<a name="ln-2311"></a>
<a name="ln-2312"></a>          <span class="c">! FLOW:</span>
<a name="ln-2313"></a>
<a name="ln-2314"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ISABSF</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2315"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-2316"></a>  <span class="n">ENDIF</span>
<a name="ln-2317"></a>  <span class="n">ISABSF</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2318"></a>
<a name="ln-2319"></a>  <span class="k">DO </span><span class="n">ZoneNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2320"></a>
<a name="ln-2321"></a>    <span class="n">FirstZoneSurf</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span>
<a name="ln-2322"></a>    <span class="n">LastZoneSurf</span><span class="o">=</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-2323"></a>    <span class="n">AreaSum</span>           <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-2324"></a>
<a name="ln-2325"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FirstZoneSurf</span><span class="p">,</span> <span class="n">LastZoneSurf</span>
<a name="ln-2326"></a>
<a name="ln-2327"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2328"></a>        <span class="c">!CR 8229, relaxed from -0.99 to -0.5  (Tilt &gt; 154)</span>
<a name="ln-2329"></a>        <span class="c">! CR8769   !use ASHRAE std of &gt;120, -0.9 to -0.5  (Tilt &gt; 120)</span>
<a name="ln-2330"></a><span class="c">!      IF (Surface(SurfNum)%Class == SurfaceClass_Floor) THEN</span>
<a name="ln-2331"></a><span class="c">!        write(outputfiledebug,*) &#39;surf=&#39;,trim(surface(surfnum)%name),Surface(SurfNum)%CosTilt</span>
<a name="ln-2332"></a><span class="c">!      endif</span>
<a name="ln-2333"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OfType</span> <span class="o">==</span> <span class="n">StandardZone</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2334"></a>           <span class="n">AreaSum</span> <span class="o">=</span> <span class="n">AreaSum</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-2335"></a>      <span class="c">!  Next is not implemented but would be:</span>
<a name="ln-2336"></a>      <span class="c">! IF ((Zone(ZoneNum)%OfType .eq. SolarWallZone .or Zone(ZoneNum)%OfType .eq. RoofPondZone) .and.     &amp;</span>
<a name="ln-2337"></a>      <span class="c">!      Surface(SurfNum)%ExtBoundCond &gt; 0)    AreaSum = AreaSum + Surface(SurfNum)%Area</span>
<a name="ln-2338"></a>
<a name="ln-2339"></a>    <span class="k">END DO</span>
<a name="ln-2340"></a>
<a name="ln-2341"></a><span class="k">    </span><span class="n">HorizAreaSum</span> <span class="o">=</span> <span class="n">AreaSum</span>
<a name="ln-2342"></a>
<a name="ln-2343"></a>    <span class="k">IF</span> <span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">HasFloor</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HorizAreaSum</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2344"></a>      <span class="c">!fill floor area even though surfs not called &quot;Floor&quot;, they are roughly horizontal and face upwards.</span>
<a name="ln-2345"></a>      <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span><span class="o">=</span> <span class="n">HorizAreaSum</span>
<a name="ln-2346"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;ComputeIntSolarAbsorpFactors: Solar distribution model is set to place solar gains &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2347"></a>               <span class="s1">&#39;on the zone floor,&#39;</span><span class="p">)</span>
<a name="ln-2348"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Zone=&quot;&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; has no floor, but has approximate horizontal surfaces.&#39;</span><span class="p">)</span>
<a name="ln-2349"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...these Tilt &gt; 120, (area=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">HorizAreaSum</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] m2) will be used.&#39;</span><span class="p">)</span>
<a name="ln-2350"></a>    <span class="n">ENDIF</span>
<a name="ln-2351"></a>
<a name="ln-2352"></a>          <span class="c">! Compute ISABSF</span>
<a name="ln-2353"></a>
<a name="ln-2354"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FirstZoneSurf</span><span class="p">,</span> <span class="n">LastZoneSurf</span>
<a name="ln-2355"></a>
<a name="ln-2356"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2357"></a>
<a name="ln-2358"></a>        <span class="c">! only horizontal surfaces. !      !CR 8229, relaxed from -0.99 to -0.5  (Tilt &gt; 154)</span>
<a name="ln-2359"></a>        <span class="c">! only horizontal surfaces. !      !CR8769 use ASHRAE std of &gt;120, -0.9 to -0.5  (Tilt &gt; 120)</span>
<a name="ln-2360"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OfType</span> <span class="o">/=</span> <span class="n">StandardZone</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2361"></a>           <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">OfType</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="n">StandardZone</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2362"></a>
<a name="ln-2363"></a><span class="k">        </span><span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-2364"></a><span class="c">! last minute V3.1</span>
<a name="ln-2365"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Opaque surface</span>
<a name="ln-2366"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">AreaSum</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2367"></a>            <span class="n">ISABSF</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span><span class="o">/</span><span class="n">AreaSum</span>
<a name="ln-2368"></a>        <span class="k">ELSE</span>  <span class="c">!Window (floor windows are assumed to have no shading device and no divider,</span>
<a name="ln-2369"></a>              <span class="c">!and assumed to be non-switchable)</span>
<a name="ln-2370"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-2371"></a>          <span class="n">AbsDiffTotWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2372"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeEQL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2373"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-2374"></a>                <span class="n">AbsDiffTotWin</span> <span class="o">=</span> <span class="n">AbsDiffTotWin</span> <span class="o">+</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2375"></a>              <span class="k">END DO</span>
<a name="ln-2376"></a><span class="k">          ELSE</span>
<a name="ln-2377"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">EQLConsPtr</span><span class="p">)%</span><span class="n">NL</span>
<a name="ln-2378"></a>                <span class="n">AbsDiffTotWin</span> <span class="o">=</span> <span class="n">AbsDiffTotWin</span> <span class="o">+</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBackEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2379"></a>              <span class="k">END DO</span>
<a name="ln-2380"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-2381"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">AreaSum</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2382"></a>            <span class="n">ISABSF</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">AbsDiffTotWin</span> <span class="o">/</span> <span class="n">AreaSum</span>
<a name="ln-2383"></a>        <span class="k">END IF</span>
<a name="ln-2384"></a>
<a name="ln-2385"></a><span class="k">      END IF</span>
<a name="ln-2386"></a>
<a name="ln-2387"></a><span class="k">    END DO</span>
<a name="ln-2388"></a>
<a name="ln-2389"></a>    <span class="c">!CR 8229  test ISABSF for problems</span>
<a name="ln-2390"></a>    <span class="n">TestFractSum</span> <span class="o">=</span> <span class="nb">SUM</span><span class="p">(</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">FirstZoneSurf</span><span class="p">:</span><span class="n">LastZoneSurf</span><span class="p">))</span>
<a name="ln-2391"></a>
<a name="ln-2392"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="n">TestFractSum</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2393"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">ExtWindowArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! we have a problem, the sun has no floor to go to</span>
<a name="ln-2394"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2395"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;ComputeIntSolarAbsorpFactors: Solar distribution model is set to place solar gains &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2396"></a>               <span class="s1">&#39;on the zone floor,&#39;</span><span class="p">)</span>
<a name="ln-2397"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;but Zone =&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; does not appear to have any floor surfaces.&#39;</span><span class="p">)</span>
<a name="ln-2398"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Solar gains will be spread evenly on all surfaces in the zone, and the simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-2399"></a>        <span class="k">ELSE</span> <span class="c">! Floor Area &gt; 0 but still can&#39;t absorb</span>
<a name="ln-2400"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;ComputeIntSolarAbsorpFactors: Solar distribution model is set to place solar gains &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2401"></a>               <span class="s1">&#39;on the zone floor,&#39;</span><span class="p">)</span>
<a name="ln-2402"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;but Zone =&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; floor cannot absorb any solar gains. &#39;</span><span class="p">)</span>
<a name="ln-2403"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Check the solar absorptance of the inside layer of the floor surface construction/material.&#39;</span><span class="p">)</span>
<a name="ln-2404"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Solar gains will be spread evenly on all surfaces in the zone, and the simulation continues...&#39;</span><span class="p">)</span>
<a name="ln-2405"></a>        <span class="n">ENDIF</span>
<a name="ln-2406"></a>
<a name="ln-2407"></a>        <span class="c">! try again but use an even spread across all the surfaces in the zone, regardless of horizontal</span>
<a name="ln-2408"></a>        <span class="c">!  so as to not lose solar energy</span>
<a name="ln-2409"></a>        <span class="n">AreaSum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2410"></a>        <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FirstZoneSurf</span><span class="p">,</span> <span class="n">LastZoneSurf</span>
<a name="ln-2411"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2412"></a><span class="k">          </span><span class="n">AreaSum</span> <span class="o">=</span> <span class="n">AreaSum</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-2413"></a>        <span class="n">ENDDO</span>
<a name="ln-2414"></a>
<a name="ln-2415"></a>        <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">FirstZoneSurf</span><span class="p">,</span> <span class="n">LastZoneSurf</span>
<a name="ln-2416"></a>
<a name="ln-2417"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2418"></a><span class="k">          </span><span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-2419"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Opaque surface</span>
<a name="ln-2420"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">AreaSum</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2421"></a>              <span class="n">ISABSF</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="o">*</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span><span class="o">/</span><span class="n">AreaSum</span>
<a name="ln-2422"></a>          <span class="k">ELSE</span>  <span class="c">!Window (floor windows are assumed to have no shading device and no divider,</span>
<a name="ln-2423"></a>                <span class="c">!and assumed to be non-switchable)</span>
<a name="ln-2424"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-2425"></a>            <span class="n">AbsDiffTotWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2426"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">WindowTypeEQL</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2427"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-2428"></a>                <span class="n">AbsDiffTotWin</span> <span class="o">=</span> <span class="n">AbsDiffTotWin</span> <span class="o">+</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2429"></a>              <span class="k">END DO</span>
<a name="ln-2430"></a><span class="k">            ELSE</span>
<a name="ln-2431"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">EQLConsPtr</span><span class="p">)%</span><span class="n">NL</span>
<a name="ln-2432"></a>                <span class="n">AbsDiffTotWin</span> <span class="o">=</span> <span class="n">AbsDiffTotWin</span> <span class="o">+</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBackEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-2433"></a>              <span class="k">END DO</span>
<a name="ln-2434"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-2435"></a>
<a name="ln-2436"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">AreaSum</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2437"></a>              <span class="n">ISABSF</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">AbsDiffTotWin</span> <span class="o">/</span> <span class="n">AreaSum</span>
<a name="ln-2438"></a>          <span class="k">END IF</span>
<a name="ln-2439"></a><span class="k">        </span><span class="n">ENDDO</span>
<a name="ln-2440"></a>      <span class="n">ENDIF</span>
<a name="ln-2441"></a>
<a name="ln-2442"></a>    <span class="n">ENDIF</span>
<a name="ln-2443"></a>
<a name="ln-2444"></a>  <span class="k">END DO</span> <span class="c">! zone loop</span>
<a name="ln-2445"></a>
<a name="ln-2446"></a>  <span class="k">RETURN</span>
<a name="ln-2447"></a>
<a name="ln-2448"></a><span class="k">END SUBROUTINE </span><span class="n">ComputeIntSolarAbsorpFactors</span>
<a name="ln-2449"></a>
<a name="ln-2450"></a><span class="k">SUBROUTINE </span><span class="n">CLIP</span><span class="p">(</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-2451"></a>
<a name="ln-2452"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2453"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-2454"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2455"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2456"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-2457"></a>
<a name="ln-2458"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2459"></a>          <span class="c">! This subroutine &#39;clips&#39; the shadow casting surface polygon so that</span>
<a name="ln-2460"></a>          <span class="c">! none of it lies below the plane of the receiving surface polygon.  This</span>
<a name="ln-2461"></a>          <span class="c">! prevents the casting of &#39;false&#39; shadows.</span>
<a name="ln-2462"></a>
<a name="ln-2463"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2464"></a>          <span class="c">! na</span>
<a name="ln-2465"></a>
<a name="ln-2466"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2467"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-2468"></a>
<a name="ln-2469"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2470"></a>          <span class="c">! na</span>
<a name="ln-2471"></a>
<a name="ln-2472"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2473"></a>
<a name="ln-2474"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2475"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">NVT</span>
<a name="ln-2476"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XVT</span>
<a name="ln-2477"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YVT</span>
<a name="ln-2478"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZVT</span>
<a name="ln-2479"></a>
<a name="ln-2480"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2481"></a>          <span class="c">! na</span>
<a name="ln-2482"></a>
<a name="ln-2483"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2484"></a>          <span class="c">! na</span>
<a name="ln-2485"></a>
<a name="ln-2486"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2487"></a>          <span class="c">! na</span>
<a name="ln-2488"></a>
<a name="ln-2489"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2490"></a>  <span class="kt">INTEGER  </span><span class="n">N</span>            <span class="c">! Loop Control (vertex number)</span>
<a name="ln-2491"></a>  <span class="kt">INTEGER  </span><span class="n">NABOVE</span>       <span class="c">! Number of vertices of shadow casting surface. above the plane of receiving surface</span>
<a name="ln-2492"></a>  <span class="kt">INTEGER  </span><span class="n">NEXT</span>         <span class="c">! First vertex above plane of receiving surface</span>
<a name="ln-2493"></a>  <span class="kt">INTEGER  </span><span class="n">NON</span>          <span class="c">! Number of vertices of shadow casting surface. on plane of receiving surface</span>
<a name="ln-2494"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">XIN</span>  <span class="c">! X of entry point of shadow casting surface. into plane of receiving surface</span>
<a name="ln-2495"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">XOUT</span> <span class="c">! X of exit point of shadow casting surface. from plane of receiving surface</span>
<a name="ln-2496"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">YIN</span>  <span class="c">! Y of entry point of shadow casting surface. into plane of receiving surface</span>
<a name="ln-2497"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">YOUT</span> <span class="c">! Y of exit point of shadow casting surface. from plane of receiving surface</span>
<a name="ln-2498"></a><span class="c">!  INTEGER NVS      ! Number of vertices of the shadow/clipped surface</span>
<a name="ln-2499"></a>
<a name="ln-2500"></a>  <span class="c">! Determine if the shadow casting surface. is above, below, or intersects with the plane of the receiving surface</span>
<a name="ln-2501"></a>
<a name="ln-2502"></a>  <span class="n">NABOVE</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2503"></a>  <span class="n">NON</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2504"></a>  <span class="n">NumVertInShadowOrClippedSurface</span> <span class="o">=</span> <span class="n">NVS</span>
<a name="ln-2505"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-2506"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">NABOVE</span> <span class="o">=</span> <span class="n">NABOVE</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2507"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">NON</span>    <span class="o">=</span> <span class="n">NON</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2508"></a>  <span class="k">END DO</span>
<a name="ln-2509"></a>
<a name="ln-2510"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">NABOVE</span><span class="o">+</span><span class="n">NON</span> <span class="o">==</span> <span class="n">NVT</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Rename the unclipped shadow casting surface.</span>
<a name="ln-2511"></a>
<a name="ln-2512"></a>    <span class="n">NVS</span><span class="o">=</span><span class="n">NVT</span>
<a name="ln-2513"></a>    <span class="n">NumVertInShadowOrClippedSurface</span> <span class="o">=</span> <span class="n">NVT</span>
<a name="ln-2514"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-2515"></a>      <span class="n">XVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2516"></a>      <span class="n">YVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2517"></a>      <span class="n">ZVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-2518"></a>    <span class="k">END DO</span>
<a name="ln-2519"></a>
<a name="ln-2520"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NABOVE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Totally submerged shadow casting surface.</span>
<a name="ln-2521"></a>
<a name="ln-2522"></a>    <span class="n">NVS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2523"></a>    <span class="n">NumVertInShadowOrClippedSurface</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2524"></a>
<a name="ln-2525"></a>  <span class="k">ELSE</span>  <span class="c">! Remove (clip) that portion of the shadow casting surface. which is below the receiving surface</span>
<a name="ln-2526"></a>
<a name="ln-2527"></a>    <span class="n">NVS</span>        <span class="o">=</span> <span class="n">NABOVE</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2528"></a>    <span class="n">NumVertInShadowOrClippedSurface</span> <span class="o">=</span> <span class="n">NABOVE</span> <span class="o">+</span> <span class="mi">2</span>
<a name="ln-2529"></a>    <span class="n">XVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2530"></a>    <span class="n">YVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2531"></a>    <span class="n">ZVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZVT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2532"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-2533"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Line enters plane of receiving surface</span>
<a name="ln-2534"></a>
<a name="ln-2535"></a>        <span class="n">XIN</span><span class="o">=</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<a name="ln-2536"></a>        <span class="n">YIN</span><span class="o">=</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<a name="ln-2537"></a>
<a name="ln-2538"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Line exits plane of receiving surface</span>
<a name="ln-2539"></a>
<a name="ln-2540"></a>        <span class="n">NEXT</span><span class="o">=</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2541"></a>        <span class="n">XOUT</span><span class="o">=</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<a name="ln-2542"></a>        <span class="n">YOUT</span><span class="o">=</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<a name="ln-2543"></a>
<a name="ln-2544"></a>      <span class="k">END IF</span>
<a name="ln-2545"></a><span class="k">    END DO</span>
<a name="ln-2546"></a>
<a name="ln-2547"></a>          <span class="c">! Renumber the vertices of the clipped shadow casting surface. so they are still counter-clockwise sequential.</span>
<a name="ln-2548"></a>
<a name="ln-2549"></a>    <span class="n">XVC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="o">=</span> <span class="n">XOUT</span>
<a name="ln-2550"></a>    <span class="n">YVC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="o">=</span> <span class="n">YOUT</span>
<a name="ln-2551"></a>    <span class="n">ZVC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2552"></a>    <span class="n">XVC</span><span class="p">(</span><span class="n">NVS</span><span class="p">)</span> <span class="o">=</span> <span class="n">XIN</span>
<a name="ln-2553"></a>    <span class="n">YVC</span><span class="p">(</span><span class="n">NVS</span><span class="p">)</span> <span class="o">=</span> <span class="n">YIN</span>
<a name="ln-2554"></a>    <span class="n">ZVC</span><span class="p">(</span><span class="n">NVS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-2555"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NABOVE</span>
<a name="ln-2556"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NEXT</span> <span class="o">&gt;</span> <span class="n">NVT</span><span class="p">)</span> <span class="n">NEXT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-2557"></a>      <span class="n">XVC</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">NEXT</span><span class="p">)</span>
<a name="ln-2558"></a>      <span class="n">YVC</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">NEXT</span><span class="p">)</span>
<a name="ln-2559"></a>      <span class="n">ZVC</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZVT</span><span class="p">(</span><span class="n">NEXT</span><span class="p">)</span>
<a name="ln-2560"></a>      <span class="n">NEXT</span>     <span class="o">=</span> <span class="n">NEXT</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2561"></a>    <span class="k">END DO</span>
<a name="ln-2562"></a>
<a name="ln-2563"></a><span class="k">  END IF</span>
<a name="ln-2564"></a>
<a name="ln-2565"></a><span class="k">  RETURN</span>
<a name="ln-2566"></a>
<a name="ln-2567"></a><span class="k">END SUBROUTINE </span><span class="n">CLIP</span>
<a name="ln-2568"></a>
<a name="ln-2569"></a><span class="k">SUBROUTINE </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">NS</span><span class="p">,</span><span class="n">NGRS</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-2570"></a>
<a name="ln-2571"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2572"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-2573"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2574"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2575"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-2576"></a>
<a name="ln-2577"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2578"></a>          <span class="c">! Transforms the general coordinates of the vertices</span>
<a name="ln-2579"></a>          <span class="c">! of surface NS to coordinates in the plane of the receiving surface NGRS.</span>
<a name="ln-2580"></a>          <span class="c">! See subroutine &#39;CalcCoordinateTransformation&#39; SurfaceGeometry Module.</span>
<a name="ln-2581"></a>
<a name="ln-2582"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2583"></a>          <span class="c">! na</span>
<a name="ln-2584"></a>
<a name="ln-2585"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2586"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-2587"></a>          <span class="c">! NECAP subroutine &#39;SHADOW&#39;</span>
<a name="ln-2588"></a>
<a name="ln-2589"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2590"></a>          <span class="c">! na</span>
<a name="ln-2591"></a>
<a name="ln-2592"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2593"></a>
<a name="ln-2594"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2595"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">NS</span>     <span class="c">! Surface number whose vertex coordinates are being transformed</span>
<a name="ln-2596"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">NGRS</span>   <span class="c">! Base surface number for surface NS</span>
<a name="ln-2597"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">NVT</span>    <span class="c">! Number of vertices for surface NS</span>
<a name="ln-2598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">XVT</span>    <span class="c">! XYZ coordinates of vertices of NS in plane of NGRS</span>
<a name="ln-2599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">YVT</span>
<a name="ln-2600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ZVT</span>
<a name="ln-2601"></a>
<a name="ln-2602"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2603"></a>          <span class="c">! na</span>
<a name="ln-2604"></a>
<a name="ln-2605"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2606"></a>          <span class="c">! na</span>
<a name="ln-2607"></a>
<a name="ln-2608"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2609"></a>          <span class="c">! na</span>
<a name="ln-2610"></a>
<a name="ln-2611"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2612"></a>  <span class="kt">INTEGER </span><span class="n">N</span>             <span class="c">! Loop Control (vertex number)</span>
<a name="ln-2613"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Xdif</span> <span class="c">! Intermediate Result</span>
<a name="ln-2614"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Ydif</span> <span class="c">! Intermediate Result</span>
<a name="ln-2615"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">Zdif</span> <span class="c">! Intermediate Result</span>
<a name="ln-2616"></a>
<a name="ln-2617"></a>        <span class="c">! Perform transformation.</span>
<a name="ln-2618"></a>
<a name="ln-2619"></a>  <span class="n">NVT</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NS</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-2620"></a>
<a name="ln-2621"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-2622"></a>
<a name="ln-2623"></a>    <span class="n">Xdif</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">X</span><span class="o">-</span><span class="n">X0</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)</span>
<a name="ln-2624"></a>    <span class="n">Ydif</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Y</span><span class="o">-</span><span class="n">Y0</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)</span>
<a name="ln-2625"></a>    <span class="n">Zdif</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NS</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(</span><span class="n">N</span><span class="p">)%</span><span class="n">Z</span><span class="o">-</span><span class="n">Z0</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)</span>
<a name="ln-2626"></a>
<a name="ln-2627"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Xdif</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.D-15</span><span class="p">)</span> <span class="n">Xdif</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-2628"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Ydif</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.D-15</span><span class="p">)</span> <span class="n">Ydif</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-2629"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Zdif</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.D-15</span><span class="p">)</span> <span class="n">Zdif</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-2630"></a>
<a name="ln-2631"></a>    <span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">Xdif</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">Ydif</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">Zdif</span>
<a name="ln-2632"></a>    <span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">Xdif</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">Ydif</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">Zdif</span>
<a name="ln-2633"></a>    <span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">Xdif</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">Ydif</span><span class="o">+</span><span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">Zdif</span>
<a name="ln-2634"></a>
<a name="ln-2635"></a>  <span class="k">END DO</span>
<a name="ln-2636"></a>
<a name="ln-2637"></a><span class="k">  RETURN</span>
<a name="ln-2638"></a>
<a name="ln-2639"></a><span class="k">END SUBROUTINE </span><span class="n">CTRANS</span>
<a name="ln-2640"></a>
<a name="ln-2641"></a><span class="k">SUBROUTINE </span><span class="n">HTRANS</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="n">NS</span><span class="p">,</span><span class="n">NumVertices</span><span class="p">)</span>
<a name="ln-2642"></a>
<a name="ln-2643"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2644"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-2645"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2646"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2647"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-2648"></a>
<a name="ln-2649"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2650"></a>          <span class="c">! This subroutine sets up the homogeneous coordinates.</span>
<a name="ln-2651"></a>          <span class="c">! This routine converts the cartesian coordinates of a surface</span>
<a name="ln-2652"></a>          <span class="c">! or shadow polygon to homogeneous coordinates.  It also</span>
<a name="ln-2653"></a>          <span class="c">! computes the area of the polygon.</span>
<a name="ln-2654"></a>
<a name="ln-2655"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2656"></a>          <span class="c">! Note: Original legacy code used integer arithmetic (tests in subroutines</span>
<a name="ln-2657"></a>          <span class="c">! INCLOS and INTCPT are sensitive to round-off error).  However, porting to Fortran 77</span>
<a name="ln-2658"></a>          <span class="c">! (BLAST/IBLAST) required some variables to become REAL(r64) instead.</span>
<a name="ln-2659"></a>
<a name="ln-2660"></a>          <span class="c">! Notes on homogeneous coordinates:</span>
<a name="ln-2661"></a>          <span class="c">! A point (X,Y) is represented by a 3-element vector</span>
<a name="ln-2662"></a>          <span class="c">! (W*X,W*Y,W), where W may be any REAL(r64) number except 0.  a line</span>
<a name="ln-2663"></a>          <span class="c">! is also represented by a 3-element vector (A,B,C).  The</span>
<a name="ln-2664"></a>          <span class="c">! directed line (A,B,C) from point (W*X1,W*Y1,W) to point</span>
<a name="ln-2665"></a>          <span class="c">! (V*X2,V*Y2,V) is given by (A,B,C) = (W*X1,W*Y1,W) cross</span>
<a name="ln-2666"></a>          <span class="c">! (V*X2,V*Y2,V).  The sequence of the cross product is a</span>
<a name="ln-2667"></a>          <span class="c">! convention to determine sign.  The condition that a point lie</span>
<a name="ln-2668"></a>          <span class="c">! on a line is that (A,B,C) dot (W*X,W*Y,W) = 0.  &#39;Normalize&#39;</span>
<a name="ln-2669"></a>          <span class="c">! the representation of a point by setting W to 1.  Then if</span>
<a name="ln-2670"></a>          <span class="c">! (A,B,C) dot (X,Y,1) &gt; 0.0, The point is to the left of the</span>
<a name="ln-2671"></a>          <span class="c">! line, and if it is less than zero, the point is to the right</span>
<a name="ln-2672"></a>          <span class="c">! of the line.  The intercept of two lines is given by</span>
<a name="ln-2673"></a>          <span class="c">! (W*X,W*Y,W) = (A1,B1,C1) cross (A2,B2,C3).</span>
<a name="ln-2674"></a>
<a name="ln-2675"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2676"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-2677"></a>          <span class="c">! W. M. Newman &amp; R. F. Sproull, &#39;Principles of Interactive Computer Graphics&#39;, Appendix II, McGraw-Hill, 1973.</span>
<a name="ln-2678"></a>          <span class="c">! &#39;CRC Math Tables&#39;, 22 ED, &#39;Analytic Geometry&#39;, P.369</span>
<a name="ln-2679"></a>
<a name="ln-2680"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2681"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2682"></a>
<a name="ln-2683"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2684"></a>
<a name="ln-2685"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2686"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">I</span>   <span class="c">! Mode selector: 0 - Compute H.C. of sides</span>
<a name="ln-2687"></a>                             <span class="c">!                1 - Compute H.C. of vertices &amp; sides</span>
<a name="ln-2688"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS</span>  <span class="c">! Figure Number</span>
<a name="ln-2689"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumVertices</span> <span class="c">! Number of vertices</span>
<a name="ln-2690"></a>
<a name="ln-2691"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2692"></a>          <span class="c">! na</span>
<a name="ln-2693"></a>
<a name="ln-2694"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2695"></a>          <span class="c">! na</span>
<a name="ln-2696"></a>
<a name="ln-2697"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2698"></a>          <span class="c">! na</span>
<a name="ln-2699"></a>
<a name="ln-2700"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2701"></a>  <span class="kt">INTEGER </span><span class="n">N</span>              <span class="c">! Loop Control (vertex number)</span>
<a name="ln-2702"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="nb">SUM</span>   <span class="c">! Sum variable</span>
<a name="ln-2703"></a>  <span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">ITEMP</span> <span class="c">!</span>
<a name="ln-2704"></a>
<a name="ln-2705"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NS</span> <span class="o">&gt;</span> <span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2706"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Solar Shading: HTrans: Too many Figures (&gt;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-2707"></a>  <span class="n">ENDIF</span>
<a name="ln-2708"></a>
<a name="ln-2709"></a>  <span class="n">HCNV</span><span class="p">(</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">NumVertices</span>
<a name="ln-2710"></a>
<a name="ln-2711"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Transform vertices of figure ns.</span>
<a name="ln-2712"></a>
<a name="ln-2713"></a>    <span class="c">! See comment at top of module regarding HCMULT</span>
<a name="ln-2714"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertices</span>
<a name="ln-2715"></a>      <span class="n">ITEMP</span>     <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">HCMULT</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-2716"></a>      <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITEMP</span>
<a name="ln-2717"></a>      <span class="n">ITEMP</span>     <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">HCMULT</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-2718"></a>      <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITEMP</span>
<a name="ln-2719"></a>    <span class="k">END DO</span>
<a name="ln-2720"></a>
<a name="ln-2721"></a><span class="k">  END IF</span>
<a name="ln-2722"></a>
<a name="ln-2723"></a>          <span class="c">! Establish extra point for finding lines between points.</span>
<a name="ln-2724"></a>
<a name="ln-2725"></a>  <span class="n">HCX</span><span class="p">(</span><span class="n">NumVertices</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">HCX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2726"></a>  <span class="n">HCY</span><span class="p">(</span><span class="n">NumVertices</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">HCY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2727"></a>
<a name="ln-2728"></a>          <span class="c">! Determine lines between points.</span>
<a name="ln-2729"></a>  <span class="nb">SUM</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-2730"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertices</span>
<a name="ln-2731"></a>    <span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2732"></a>    <span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2733"></a>    <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">))</span>
<a name="ln-2734"></a>    <span class="nb">SUM</span> <span class="o">=</span> <span class="nb">SUM</span> <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2735"></a>  <span class="k">END DO</span>
<a name="ln-2736"></a>
<a name="ln-2737"></a>          <span class="c">! Compute area of polygon.</span>
<a name="ln-2738"></a><span class="c">!  SUM=0.0D0</span>
<a name="ln-2739"></a><span class="c">!  DO N = 1, NumVertices</span>
<a name="ln-2740"></a><span class="c">!    SUM = SUM + HCX(N,NS)*HCY(N+1,NS) - HCY(N,NS)*HCX(N+1,NS) ! Since HCX and HCY integerized, value of SUM should be ok</span>
<a name="ln-2741"></a><span class="c">!  END DO</span>
<a name="ln-2742"></a>  <span class="n">HCAREA</span><span class="p">(</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">SUM</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sqHCMULT</span><span class="p">)</span>
<a name="ln-2743"></a><span class="c">!  HCAREA(NS)=0.5d0*SUM*(kHCMULT)</span>
<a name="ln-2744"></a>
<a name="ln-2745"></a>
<a name="ln-2746"></a>  <span class="k">RETURN</span>
<a name="ln-2747"></a>
<a name="ln-2748"></a><span class="k">END SUBROUTINE </span><span class="n">HTRANS</span>
<a name="ln-2749"></a>
<a name="ln-2750"></a><span class="k">SUBROUTINE </span><span class="n">HTRANS0</span><span class="p">(</span><span class="n">NS</span><span class="p">,</span><span class="n">NumVertices</span><span class="p">)</span>
<a name="ln-2751"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2752"></a>
<a name="ln-2753"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2754"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS</span>  <span class="c">! Figure Number</span>
<a name="ln-2755"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumVertices</span> <span class="c">! Number of vertices</span>
<a name="ln-2756"></a>  <span class="kt">INTEGER </span><span class="n">N</span>              <span class="c">! Loop Control (vertex number)</span>
<a name="ln-2757"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="nb">SUM</span>   <span class="c">! Sum variable</span>
<a name="ln-2758"></a>
<a name="ln-2759"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NS</span> <span class="o">&gt;</span> <span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2760"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Solar Shading: HTrans0: Too many Figures (&gt;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-2761"></a>  <span class="n">ENDIF</span>
<a name="ln-2762"></a>
<a name="ln-2763"></a>  <span class="n">HCNV</span><span class="p">(</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">NumVertices</span>
<a name="ln-2764"></a>  <span class="n">HCX</span><span class="p">(</span><span class="n">NumVertices</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">HCX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2765"></a>  <span class="n">HCY</span><span class="p">(</span><span class="n">NumVertices</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">HCY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2766"></a>
<a name="ln-2767"></a>  <span class="nb">SUM</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-2768"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertices</span>
<a name="ln-2769"></a>    <span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2770"></a>    <span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2771"></a>    <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">))</span>
<a name="ln-2772"></a>    <span class="nb">SUM</span> <span class="o">=</span> <span class="nb">SUM</span> <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2773"></a>  <span class="k">END DO</span>
<a name="ln-2774"></a>
<a name="ln-2775"></a><span class="k">  </span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">SUM</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sqHCMULT</span><span class="p">)</span>
<a name="ln-2776"></a>
<a name="ln-2777"></a>  <span class="k">RETURN</span>
<a name="ln-2778"></a><span class="k">END SUBROUTINE </span><span class="n">HTRANS0</span>
<a name="ln-2779"></a>
<a name="ln-2780"></a><span class="k">SUBROUTINE </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS</span><span class="p">,</span><span class="n">NumVertices</span><span class="p">)</span>
<a name="ln-2781"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-2782"></a>
<a name="ln-2783"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2784"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS</span>  <span class="c">! Figure Number</span>
<a name="ln-2785"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumVertices</span> <span class="c">! Number of vertices</span>
<a name="ln-2786"></a>  <span class="kt">INTEGER </span><span class="n">N</span>              <span class="c">! Loop Control (vertex number)</span>
<a name="ln-2787"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="nb">SUM</span>   <span class="c">! Sum variable</span>
<a name="ln-2788"></a>  <span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">ITEMP</span> <span class="c">!</span>
<a name="ln-2789"></a>
<a name="ln-2790"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NS</span> <span class="o">&gt;</span> <span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2791"></a><span class="k">    CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Solar Shading: HTrans1: Too many Figures (&gt;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
<a name="ln-2792"></a>  <span class="n">ENDIF</span>
<a name="ln-2793"></a>
<a name="ln-2794"></a>  <span class="c">! only in HTRANS1</span>
<a name="ln-2795"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertices</span>
<a name="ln-2796"></a>     <span class="n">ITEMP</span>     <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">HCMULT</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-2797"></a>     <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITEMP</span>
<a name="ln-2798"></a>     <span class="n">ITEMP</span>     <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">HCMULT</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-2799"></a>     <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">ITEMP</span>
<a name="ln-2800"></a>  <span class="k">END DO</span>
<a name="ln-2801"></a>
<a name="ln-2802"></a><span class="k">  </span><span class="n">HCNV</span><span class="p">(</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">NumVertices</span>
<a name="ln-2803"></a>  <span class="n">HCX</span><span class="p">(</span><span class="n">NumVertices</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">HCX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2804"></a>  <span class="n">HCY</span><span class="p">(</span><span class="n">NumVertices</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="n">HCY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>  <span class="nb">SUM</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-2807"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertices</span>
<a name="ln-2808"></a>    <span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2809"></a>    <span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2810"></a>    <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">))</span>
<a name="ln-2811"></a>    <span class="nb">SUM</span> <span class="o">=</span> <span class="nb">SUM</span> <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS</span><span class="p">)</span>
<a name="ln-2812"></a>  <span class="k">END DO</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a><span class="k">  </span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">SUM</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sqHCMULT</span><span class="p">)</span>
<a name="ln-2815"></a>
<a name="ln-2816"></a>  <span class="k">RETURN</span>
<a name="ln-2817"></a><span class="k">END SUBROUTINE </span><span class="n">HTRANS1</span>
<a name="ln-2818"></a>
<a name="ln-2819"></a><span class="k">SUBROUTINE </span><span class="n">INCLOS</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span><span class="n">N1NumVert</span><span class="p">,</span><span class="n">N2</span><span class="p">,</span><span class="n">N2NumVert</span><span class="p">,</span><span class="n">NumVerticesOverlap</span><span class="p">,</span><span class="n">NIN</span><span class="p">)</span>
<a name="ln-2820"></a>
<a name="ln-2821"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2822"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-2823"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2824"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2825"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-2826"></a>
<a name="ln-2827"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2828"></a>          <span class="c">! This subroutine determines which vertices of figure N1 lie within figure N2.</span>
<a name="ln-2829"></a>
<a name="ln-2830"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2831"></a>          <span class="c">! For vertex N of figure N1 to lie within figure N2, it must be</span>
<a name="ln-2832"></a>          <span class="c">! on or to the right of all sides of figure N2, assuming</span>
<a name="ln-2833"></a>          <span class="c">! figure N2 is convex.</span>
<a name="ln-2834"></a>
<a name="ln-2835"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2836"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-2837"></a>
<a name="ln-2838"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2839"></a>          <span class="c">! na</span>
<a name="ln-2840"></a>
<a name="ln-2841"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2842"></a>
<a name="ln-2843"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2844"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">N1</span>         <span class="c">! Figure number of figure 1</span>
<a name="ln-2845"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">N1NumVert</span>  <span class="c">! Number of vertices of figure 1</span>
<a name="ln-2846"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">N2</span>         <span class="c">! Figure number of figure 2</span>
<a name="ln-2847"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">N2NumVert</span>  <span class="c">! Number of vertices of figure 2</span>
<a name="ln-2848"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NumVerticesOverlap</span> <span class="c">! Number of vertices which overlap</span>
<a name="ln-2849"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">NIN</span>        <span class="c">! Number of vertices of figure 1 within figure 2</span>
<a name="ln-2850"></a>
<a name="ln-2851"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2852"></a>          <span class="c">! na</span>
<a name="ln-2853"></a>
<a name="ln-2854"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2855"></a>          <span class="c">! na</span>
<a name="ln-2856"></a>
<a name="ln-2857"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2858"></a>          <span class="c">! na</span>
<a name="ln-2859"></a>
<a name="ln-2860"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2861"></a>  <span class="kt">INTEGER </span><span class="n">K</span>  <span class="c">! Vertex number of the overlap</span>
<a name="ln-2862"></a>  <span class="kt">INTEGER </span><span class="n">M</span>  <span class="c">! Side number of figure N2</span>
<a name="ln-2863"></a>  <span class="kt">INTEGER </span><span class="n">N</span>  <span class="c">! Vertex number of figure N1</span>
<a name="ln-2864"></a>  <span class="kt">LOGICAL </span><span class="n">CycleMainLoop</span> <span class="c">! Sets when to cycle main loop</span>
<a name="ln-2865"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HFunct</span>
<a name="ln-2866"></a>
<a name="ln-2867"></a>  <span class="n">NIN</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-2868"></a>
<a name="ln-2869"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N1NumVert</span>
<a name="ln-2870"></a>
<a name="ln-2871"></a>    <span class="n">CycleMainLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2872"></a>
<a name="ln-2873"></a>          <span class="c">! Eliminate cases where vertex N is to the left of side M.</span>
<a name="ln-2874"></a>
<a name="ln-2875"></a>    <span class="k">DO </span><span class="n">M</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N2NumVert</span>
<a name="ln-2876"></a>      <span class="n">HFunct</span><span class="o">=</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="n">HCA</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N2</span><span class="p">)</span><span class="o">+</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N1</span><span class="p">)</span><span class="o">*</span><span class="n">HCB</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N2</span><span class="p">)</span><span class="o">+</span><span class="n">HCC</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">N2</span><span class="p">)</span>
<a name="ln-2877"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HFunct</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2878"></a><span class="k">        </span><span class="n">CycleMainLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! Set to cycle to the next value of N</span>
<a name="ln-2879"></a>        <span class="k">EXIT</span> <span class="c">! M DO loop</span>
<a name="ln-2880"></a>      <span class="k">END IF</span>
<a name="ln-2881"></a><span class="k">    END DO</span>
<a name="ln-2882"></a>
<a name="ln-2883"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CycleMainLoop</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2884"></a><span class="k">    </span><span class="n">NIN</span><span class="o">=</span><span class="n">NIN</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-2885"></a>
<a name="ln-2886"></a>          <span class="c">! Check for duplication of previously determined points.</span>
<a name="ln-2887"></a>
<a name="ln-2888"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumVerticesOverlap</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2889"></a><span class="k">      DO </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVerticesOverlap</span>
<a name="ln-2890"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N1</span><span class="p">)).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">==</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-2891"></a><span class="k">          </span><span class="n">CycleMainLoop</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>    <span class="c">! Set to cycle to the next value of N</span>
<a name="ln-2892"></a>          <span class="k">EXIT</span> <span class="c">! K DO loop</span>
<a name="ln-2893"></a>        <span class="k">END IF</span>
<a name="ln-2894"></a><span class="k">      END DO</span>
<a name="ln-2895"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CycleMainLoop</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2896"></a><span class="k">    END IF</span>
<a name="ln-2897"></a>
<a name="ln-2898"></a>          <span class="c">! Record enclosed vertices in temporary arrays.</span>
<a name="ln-2899"></a>
<a name="ln-2900"></a>   <span class="n">NumVerticesOverlap</span>        <span class="o">=</span> <span class="n">NumVerticesOverlap</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2901"></a>   <span class="n">XTEMP</span><span class="p">(</span><span class="n">NumVerticesOverlap</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N1</span><span class="p">)</span>
<a name="ln-2902"></a>   <span class="n">YTEMP</span><span class="p">(</span><span class="n">NumVerticesOverlap</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N1</span><span class="p">)</span>
<a name="ln-2903"></a>
<a name="ln-2904"></a>  <span class="k">END DO</span>
<a name="ln-2905"></a>
<a name="ln-2906"></a><span class="k">  RETURN</span>
<a name="ln-2907"></a>
<a name="ln-2908"></a><span class="k">END SUBROUTINE </span><span class="n">INCLOS</span>
<a name="ln-2909"></a>
<a name="ln-2910"></a><span class="k">SUBROUTINE </span><span class="n">INTCPT</span><span class="p">(</span><span class="n">NV1</span><span class="p">,</span><span class="n">NV2</span><span class="p">,</span><span class="n">NV3</span><span class="p">,</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-2911"></a>
<a name="ln-2912"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-2913"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-2914"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-2915"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-2916"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-2917"></a>
<a name="ln-2918"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-2919"></a>          <span class="c">! This subroutine determines all intercepts between the sides of figure NS1</span>
<a name="ln-2920"></a>          <span class="c">! and the sides of figure NS2.</span>
<a name="ln-2921"></a>
<a name="ln-2922"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-2923"></a>          <span class="c">! The requirements for intersection are that the end points of</span>
<a name="ln-2924"></a>          <span class="c">! line N lie on both sides of line M and vice versa.  Also</span>
<a name="ln-2925"></a>          <span class="c">! eliminate cases where the end point of one line lies exactly</span>
<a name="ln-2926"></a>          <span class="c">! on the other to reduce duplication with the enclosed points.</span>
<a name="ln-2927"></a>
<a name="ln-2928"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-2929"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-2930"></a>
<a name="ln-2931"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-2932"></a>          <span class="c">! na</span>
<a name="ln-2933"></a>
<a name="ln-2934"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-2935"></a>
<a name="ln-2936"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-2937"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NV1</span>      <span class="c">! Number of vertices of figure NS1</span>
<a name="ln-2938"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NV2</span>      <span class="c">! Number of vertices of figure NS2</span>
<a name="ln-2939"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NV3</span>      <span class="c">! Number of vertices of figure NS3</span>
<a name="ln-2940"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NS1</span>      <span class="c">! Number of the figure being overlapped</span>
<a name="ln-2941"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NS2</span>      <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-2942"></a>
<a name="ln-2943"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-2944"></a>          <span class="c">! na</span>
<a name="ln-2945"></a>
<a name="ln-2946"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-2947"></a>          <span class="c">! na</span>
<a name="ln-2948"></a>
<a name="ln-2949"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-2950"></a>          <span class="c">! na</span>
<a name="ln-2951"></a>
<a name="ln-2952"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-2953"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">W</span>        <span class="c">! Normalization factor</span>
<a name="ln-2954"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">XUntrunc</span> <span class="c">! Untruncated X coordinate</span>
<a name="ln-2955"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">YUntrunc</span> <span class="c">! Untruncated Y coordinate</span>
<a name="ln-2956"></a>  <span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">I1</span>       <span class="c">! Intermediate result for testing intersection</span>
<a name="ln-2957"></a>  <span class="kt">INTEGER</span><span class="p">(</span><span class="n">i64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">I2</span>       <span class="c">! Intermediate result for testing intersection</span>
<a name="ln-2958"></a>  <span class="kt">INTEGER </span><span class="n">K</span>                 <span class="c">!</span>
<a name="ln-2959"></a>  <span class="kt">INTEGER </span><span class="n">KK</span>                <span class="c">!</span>
<a name="ln-2960"></a>  <span class="kt">INTEGER </span><span class="n">M</span>                 <span class="c">! Side number of figure NS2</span>
<a name="ln-2961"></a>  <span class="kt">INTEGER </span><span class="n">N</span>                 <span class="c">! Side number of figure NS1</span>
<a name="ln-2962"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>      <span class="kd">::</span> <span class="n">XTEMP1</span>  <span class="c">! Temporary &#39;X&#39; values for HC vertices of the overlap</span>
<a name="ln-2963"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>      <span class="kd">::</span> <span class="n">YTEMP1</span>  <span class="c">! Temporary &#39;Y&#39; values for HC vertices of the overlap</span>
<a name="ln-2964"></a>
<a name="ln-2965"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NV1</span>
<a name="ln-2966"></a>    <span class="k">DO </span><span class="n">M</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NV2</span>
<a name="ln-2967"></a>
<a name="ln-2968"></a>          <span class="c">! Eliminate cases where sides N and M do not intersect.</span>
<a name="ln-2969"></a>
<a name="ln-2970"></a>      <span class="n">I1</span> <span class="o">=</span> <span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>   <span class="o">+</span> <span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>   <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-2971"></a>      <span class="n">I2</span> <span class="o">=</span> <span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span> <span class="o">+</span> <span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span> <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-2972"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">I1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">I2</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2973"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">I1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">I2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2974"></a>
<a name="ln-2975"></a><span class="k">      </span><span class="n">I1</span> <span class="o">=</span> <span class="n">HCA</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>   <span class="o">+</span> <span class="n">HCB</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>   <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-2976"></a>      <span class="n">I2</span> <span class="o">=</span> <span class="n">HCA</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span> <span class="o">+</span> <span class="n">HCB</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span> <span class="o">+</span> <span class="n">HCC</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-2977"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">I1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">I2</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2978"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">I1</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">I2</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2979"></a>
<a name="ln-2980"></a>          <span class="c">! Determine the point of intersection and record in the temporary array.</span>
<a name="ln-2981"></a>
<a name="ln-2982"></a>      <span class="n">KK</span>         <span class="o">=</span> <span class="n">NV3</span>
<a name="ln-2983"></a>      <span class="n">NV3</span>        <span class="o">=</span> <span class="n">NV3</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2984"></a>      <span class="n">W</span>          <span class="o">=</span> <span class="n">HCB</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span> <span class="o">-</span> <span class="n">HCA</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-2985"></a>      <span class="n">XUntrunc</span>   <span class="o">=</span> <span class="p">(</span><span class="n">HCC</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCB</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span><span class="o">-</span><span class="n">HCB</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">))</span><span class="o">/</span><span class="n">W</span>
<a name="ln-2986"></a>      <span class="n">YUntrunc</span>   <span class="o">=</span> <span class="p">(</span><span class="n">HCA</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCC</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span><span class="o">-</span><span class="n">HCC</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCA</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS1</span><span class="p">))</span><span class="o">/</span><span class="n">W</span>
<a name="ln-2987"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NV3</span> <span class="o">&gt;</span> <span class="n">SIZE</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2988"></a><span class="c">!        write(outputfiledebug,*) &#39;nv3=&#39;,nv3,&#39; size(xtemp)=&#39;,size(xtemp)</span>
<a name="ln-2989"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XTEMP1</span><span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-2990"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YTEMP1</span><span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span>
<a name="ln-2991"></a>        <span class="n">XTEMP1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2992"></a>        <span class="n">YTEMP1</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-2993"></a>        <span class="n">XTEMP1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NV3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">XTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NV3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2994"></a>        <span class="n">YTEMP1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NV3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">YTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NV3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2995"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">)</span>
<a name="ln-2996"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">)</span>
<a name="ln-2997"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">XTEMP1</span><span class="p">)))</span>
<a name="ln-2998"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">SIZE</span><span class="p">(</span><span class="n">YTEMP1</span><span class="p">)))</span>
<a name="ln-2999"></a>        <span class="n">XTEMP</span><span class="o">=</span><span class="n">XTEMP1</span>
<a name="ln-3000"></a>        <span class="n">YTEMP</span><span class="o">=</span><span class="n">YTEMP1</span>
<a name="ln-3001"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">XTEMP1</span><span class="p">)</span>
<a name="ln-3002"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">YTEMP1</span><span class="p">)</span>
<a name="ln-3003"></a>      <span class="n">ENDIF</span>
<a name="ln-3004"></a>      <span class="n">XTEMP</span><span class="p">(</span><span class="n">NV3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">XUntrunc</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3005"></a>      <span class="n">YTEMP</span><span class="p">(</span><span class="n">NV3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">YUntrunc</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3006"></a>
<a name="ln-3007"></a>          <span class="c">! Eliminate near-duplicate points.</span>
<a name="ln-3008"></a>
<a name="ln-3009"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">KK</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3010"></a><span class="k">        DO </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">KK</span>
<a name="ln-3011"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NV3</span><span class="p">)</span><span class="o">-</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3012"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">NV3</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3013"></a><span class="k">          </span><span class="n">NV3</span> <span class="o">=</span> <span class="n">KK</span>
<a name="ln-3014"></a>          <span class="k">EXIT</span> <span class="c">! K DO loop</span>
<a name="ln-3015"></a>        <span class="k">END DO</span>
<a name="ln-3016"></a><span class="k">      END IF</span>
<a name="ln-3017"></a>
<a name="ln-3018"></a><span class="k">    END DO</span>
<a name="ln-3019"></a>
<a name="ln-3020"></a><span class="k">  END DO</span>
<a name="ln-3021"></a>
<a name="ln-3022"></a><span class="k">  RETURN</span>
<a name="ln-3023"></a>
<a name="ln-3024"></a><span class="k">END SUBROUTINE </span><span class="n">INTCPT</span>
<a name="ln-3025"></a>
<a name="ln-3026"></a><span class="k">SUBROUTINE </span><span class="n">CLIPPOLY</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NV1</span><span class="p">,</span><span class="n">NV2</span><span class="p">,</span><span class="n">NV3</span><span class="p">)</span>
<a name="ln-3027"></a>
<a name="ln-3028"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3029"></a>          <span class="c">!       AUTHOR         Tyler Hoyt</span>
<a name="ln-3030"></a>          <span class="c">!       DATE WRITTEN   May 4, 2010</span>
<a name="ln-3031"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3032"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3033"></a>
<a name="ln-3034"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3035"></a>          <span class="c">! Populate global arrays XTEMP and YTEMP with the vertices</span>
<a name="ln-3036"></a>          <span class="c">! of the overlap between NS1 and NS2, and determine relevant</span>
<a name="ln-3037"></a>          <span class="c">! overlap status.</span>
<a name="ln-3038"></a>
<a name="ln-3039"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3040"></a>          <span class="c">! The Sutherland-Hodgman algorithm for polygon clipping is employed.</span>
<a name="ln-3041"></a>
<a name="ln-3042"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3043"></a>          <span class="c">!</span>
<a name="ln-3044"></a>
<a name="ln-3045"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3046"></a>          <span class="c">!</span>
<a name="ln-3047"></a>
<a name="ln-3048"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3049"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReallocateRealArray</span><span class="p">,</span><span class="n">SafeDivide</span>
<a name="ln-3050"></a>
<a name="ln-3051"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3052"></a>
<a name="ln-3053"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3054"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">NS1</span>     <span class="c">! Figure number of figure 1 (The subject polygon)</span>
<a name="ln-3055"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">NS2</span>     <span class="c">! Figure number of figure 2 (The clipping polygon)</span>
<a name="ln-3056"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">NV1</span>     <span class="c">! Number of vertices of figure 1</span>
<a name="ln-3057"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">NV2</span>     <span class="c">! Number of vertices of figure 2</span>
<a name="ln-3058"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">NV3</span>     <span class="c">! Number of vertices of figure 3</span>
<a name="ln-3059"></a>
<a name="ln-3060"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3061"></a>          <span class="c">! na</span>
<a name="ln-3062"></a>
<a name="ln-3063"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3064"></a>          <span class="c">! na</span>
<a name="ln-3065"></a>
<a name="ln-3066"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3067"></a>          <span class="c">! na</span>
<a name="ln-3068"></a>
<a name="ln-3069"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3070"></a>  <span class="kt">LOGICAL </span><span class="n">INTFLAG</span>    <span class="c">! For overlap status</span>
<a name="ln-3071"></a>  <span class="kt">INTEGER </span><span class="n">E</span>          <span class="c">! Edge loop index</span>
<a name="ln-3072"></a>  <span class="kt">INTEGER </span><span class="n">P</span>          <span class="c">! Point loop index</span>
<a name="ln-3073"></a>  <span class="kt">INTEGER </span><span class="n">S</span>          <span class="c">! Test vertex</span>
<a name="ln-3074"></a>  <span class="kt">INTEGER </span><span class="n">K</span>          <span class="c">! Duplicate test index</span>
<a name="ln-3075"></a>  <span class="kt">INTEGER </span><span class="n">KK</span>         <span class="c">! Duplicate test index</span>
<a name="ln-3076"></a>  <span class="kt">INTEGER </span><span class="n">NVOUT</span>      <span class="c">! Current output length for loops</span>
<a name="ln-3077"></a>  <span class="kt">INTEGER </span><span class="n">NVTEMP</span>
<a name="ln-3078"></a>  <span class="kt">INTEGER </span><span class="n">SaveArrayBounds</span>
<a name="ln-3079"></a>
<a name="ln-3080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">W</span>        <span class="c">! Normalization factor</span>
<a name="ln-3081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HFunct</span>
<a name="ln-3082"></a><span class="c">!  REAL(r64), DIMENSION(2*(MaxVerticesPerSurface + 1))  :: ATEMP    ! Temporary &#39;A&#39; values for HC vertices of the overlap</span>
<a name="ln-3083"></a><span class="c">!  REAL(r64), DIMENSION(2*(MaxVerticesPerSurface + 1))  :: BTEMP    ! Temporary &#39;B&#39; values for HC vertices of the overlap</span>
<a name="ln-3084"></a><span class="c">!  REAL(r64), DIMENSION(2*(MaxVerticesPerSurface + 1))  :: CTEMP    ! Temporary &#39;C&#39; values for HC vertices of the overlap</span>
<a name="ln-3085"></a><span class="c">!  REAL(r64), DIMENSION(2*(MaxVerticesPerSurface + 1))  :: XTEMP1   ! Temporary &#39;X&#39; values for HC vertices of the overlap</span>
<a name="ln-3086"></a><span class="c">!  REAL(r64), DIMENSION(2*(MaxVerticesPerSurface + 1))  :: YTEMP1   ! Temporary &#39;Y&#39; values for HC vertices of the overlap</span>
<a name="ln-3087"></a>
<a name="ln-3088"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-3089"></a>  <span class="n">NumClipPoly_Calls</span><span class="o">=</span><span class="n">NumClipPoly_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3090"></a><span class="cp">#endif</span>
<a name="ln-3091"></a>  <span class="c">! Populate the arrays with the original polygon</span>
<a name="ln-3092"></a>  <span class="k">DO </span><span class="n">P</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NV1</span>
<a name="ln-3093"></a>     <span class="n">XTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-3094"></a>     <span class="n">YTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-3095"></a>     <span class="n">ATEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCA</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-3096"></a>     <span class="n">BTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCB</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-3097"></a>     <span class="n">CTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCC</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-3098"></a>  <span class="k">END DO</span>
<a name="ln-3099"></a>
<a name="ln-3100"></a><span class="k">  </span><span class="n">NVOUT</span>   <span class="o">=</span> <span class="n">NV1</span> <span class="c">! First point-loop is the length of the subject polygon.</span>
<a name="ln-3101"></a>  <span class="n">INTFLAG</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3102"></a>  <span class="n">NVTEMP</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3103"></a>  <span class="n">KK</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3104"></a>
<a name="ln-3105"></a>  <span class="k">DO </span><span class="n">E</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NV2</span>  <span class="c">! Loop over edges of the clipping polygon</span>
<a name="ln-3106"></a>    <span class="k">DO </span><span class="n">P</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NVOUT</span>
<a name="ln-3107"></a>        <span class="n">XTEMP1</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<a name="ln-3108"></a>        <span class="n">YTEMP1</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<a name="ln-3109"></a>    <span class="k">END DO</span>
<a name="ln-3110"></a><span class="k">    </span><span class="n">S</span> <span class="o">=</span> <span class="n">NVOUT</span>
<a name="ln-3111"></a>    <span class="k">DO </span><span class="n">P</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NVOUT</span>
<a name="ln-3112"></a>      <span class="n">HFunct</span><span class="o">=</span><span class="n">XTEMP1</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">+</span><span class="n">YTEMP1</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">+</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-3113"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">HFunct</span> <span class="o">&lt;=</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>          <span class="c">! Vertex is not in the clipping plane</span>
<a name="ln-3114"></a>        <span class="n">HFunct</span><span class="o">=</span><span class="n">XTEMP1</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">*</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">+</span><span class="n">YTEMP1</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">*</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">+</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-3115"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HFunct</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span> <span class="p">)</span> <span class="k">THEN</span>        <span class="c">! Test vertex is in the clipping plane</span>
<a name="ln-3116"></a>
<a name="ln-3117"></a>          <span class="c">! Find/store the intersection of the clip edge and the line connecting S and P</span>
<a name="ln-3118"></a>          <span class="n">KK</span>            <span class="o">=</span> <span class="n">NVTEMP</span>
<a name="ln-3119"></a>          <span class="n">NVTEMP</span>        <span class="o">=</span> <span class="n">NVTEMP</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3120"></a>          <span class="n">W</span>             <span class="o">=</span> <span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">ATEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">BTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<a name="ln-3121"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">W</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3122"></a><span class="k">            </span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">((</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">BTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">))</span><span class="o">/</span><span class="n">W</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3123"></a>            <span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">((</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">ATEMP</span><span class="p">(</span><span class="n">S</span><span class="p">))</span><span class="o">/</span><span class="n">W</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3124"></a>          <span class="k">ELSE</span>
<a name="ln-3125"></a><span class="k">            </span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">((</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">BTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)),</span><span class="n">W</span><span class="p">)</span>
<a name="ln-3126"></a>            <span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">((</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">ATEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)),</span><span class="n">W</span><span class="p">)</span>
<a name="ln-3127"></a>          <span class="n">ENDIF</span>
<a name="ln-3128"></a>          <span class="n">INTFLAG</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3129"></a>
<a name="ln-3130"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="o">==</span><span class="n">NV2</span><span class="p">)</span> <span class="k">THEN</span>       <span class="c">! Remove near-duplicates on last edge</span>
<a name="ln-3131"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">KK</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3132"></a><span class="k">              DO </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">KK</span>
<a name="ln-3133"></a>                <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span><span class="o">-</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3134"></a><span class="k">                IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3135"></a><span class="k">                </span><span class="n">NVTEMP</span> <span class="o">=</span> <span class="n">KK</span>
<a name="ln-3136"></a>                <span class="k">EXIT</span> <span class="c">! K DO loop</span>
<a name="ln-3137"></a>              <span class="k">END DO</span>
<a name="ln-3138"></a><span class="k">            END IF</span>
<a name="ln-3139"></a><span class="k">          END IF</span>
<a name="ln-3140"></a>
<a name="ln-3141"></a><span class="k">        END IF</span>
<a name="ln-3142"></a>
<a name="ln-3143"></a><span class="k">        </span><span class="n">KK</span>            <span class="o">=</span> <span class="n">NVTEMP</span>
<a name="ln-3144"></a>        <span class="n">NVTEMP</span>        <span class="o">=</span> <span class="n">NVTEMP</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3145"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NVTEMP</span> <span class="o">&gt;</span> <span class="n">MAXHCArrayBounds</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3146"></a><span class="k">          </span><span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3147"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3148"></a>          <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3149"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3150"></a>          <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3151"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">XTEMP1</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3152"></a>          <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3153"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">YTEMP1</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3154"></a>          <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3155"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">ATEMP</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3156"></a>          <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3157"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">BTEMP</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3158"></a>          <span class="n">SaveArrayBounds</span><span class="o">=</span><span class="n">MAXHCArrayBounds</span>
<a name="ln-3159"></a>          <span class="k">CALL </span><span class="n">ReallocateRealArray</span><span class="p">(</span><span class="n">CTEMP</span><span class="p">,</span><span class="n">SaveArrayBounds</span><span class="p">,</span><span class="n">MAXHCArrayIncrement</span><span class="p">)</span>
<a name="ln-3160"></a>          <span class="n">MAXHCArrayBounds</span><span class="o">=</span><span class="n">SaveArrayBounds</span>
<a name="ln-3161"></a>        <span class="n">ENDIF</span>
<a name="ln-3162"></a>
<a name="ln-3163"></a>        <span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP1</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<a name="ln-3164"></a>        <span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="n">YTEMP1</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<a name="ln-3165"></a>
<a name="ln-3166"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="o">==</span><span class="n">NV2</span><span class="p">)</span> <span class="k">THEN</span>            <span class="c">! Remove near-duplicates on last edge</span>
<a name="ln-3167"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">KK</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3168"></a><span class="k">            DO </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">KK</span>
<a name="ln-3169"></a>              <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span><span class="o">-</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3170"></a><span class="k">              IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3171"></a><span class="k">              </span><span class="n">NVTEMP</span> <span class="o">=</span> <span class="n">KK</span>
<a name="ln-3172"></a>              <span class="k">EXIT</span> <span class="c">! K DO loop</span>
<a name="ln-3173"></a>            <span class="k">END DO</span>
<a name="ln-3174"></a><span class="k">          END IF</span>
<a name="ln-3175"></a><span class="k">        END IF</span>
<a name="ln-3176"></a>
<a name="ln-3177"></a><span class="k">        ELSE</span>
<a name="ln-3178"></a><span class="k">          </span><span class="n">HFunct</span><span class="o">=</span><span class="n">XTEMP1</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">*</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">+</span><span class="n">YTEMP1</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">*</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">+</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-3179"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HFunct</span> <span class="o">&lt;=</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="k">THEN</span>      <span class="c">! Test vertex is not in the clipping plane</span>
<a name="ln-3180"></a>
<a name="ln-3181"></a>            <span class="n">KK</span>            <span class="o">=</span> <span class="n">NVTEMP</span>
<a name="ln-3182"></a>            <span class="n">NVTEMP</span>        <span class="o">=</span> <span class="n">NVTEMP</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3183"></a>            <span class="n">W</span>             <span class="o">=</span> <span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">ATEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">BTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<a name="ln-3184"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">W</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3185"></a><span class="k">              </span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">((</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">BTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">))</span><span class="o">/</span><span class="n">W</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3186"></a>              <span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">((</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">ATEMP</span><span class="p">(</span><span class="n">S</span><span class="p">))</span><span class="o">/</span><span class="n">W</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3187"></a>            <span class="k">ELSE</span>
<a name="ln-3188"></a><span class="k">              </span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">((</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">BTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCB</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)),</span><span class="n">W</span><span class="p">)</span>
<a name="ln-3189"></a>              <span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span> <span class="o">=</span> <span class="n">SafeDivide</span><span class="p">((</span><span class="n">HCA</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">CTEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)</span><span class="o">-</span><span class="n">HCC</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">ATEMP</span><span class="p">(</span><span class="n">S</span><span class="p">)),</span><span class="n">W</span><span class="p">)</span>
<a name="ln-3190"></a>            <span class="n">ENDIF</span>
<a name="ln-3191"></a>            <span class="n">INTFLAG</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3192"></a>
<a name="ln-3193"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">E</span><span class="o">==</span><span class="n">NV2</span><span class="p">)</span> <span class="k">THEN</span>         <span class="c">! Remove near-duplicates on last edge</span>
<a name="ln-3194"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">KK</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3195"></a><span class="k">                DO </span><span class="n">K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">KK</span>
<a name="ln-3196"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span><span class="o">-</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3197"></a><span class="k">                  IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">NVTEMP</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">2.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3198"></a><span class="k">                  </span><span class="n">NVTEMP</span> <span class="o">=</span> <span class="n">KK</span>
<a name="ln-3199"></a>                  <span class="k">EXIT</span> <span class="c">! K DO loop</span>
<a name="ln-3200"></a>                <span class="k">END DO</span>
<a name="ln-3201"></a><span class="k">              END IF</span>
<a name="ln-3202"></a><span class="k">            END IF</span>
<a name="ln-3203"></a>
<a name="ln-3204"></a><span class="k">          END IF</span>
<a name="ln-3205"></a><span class="k">        END IF</span>
<a name="ln-3206"></a><span class="k">        </span><span class="n">S</span> <span class="o">=</span> <span class="n">P</span>
<a name="ln-3207"></a>      <span class="k">END DO</span>  <span class="c">! end loop over points of subject polygon</span>
<a name="ln-3208"></a>
<a name="ln-3209"></a>      <span class="n">NVOUT</span>  <span class="o">=</span> <span class="n">NVTEMP</span>
<a name="ln-3210"></a>      <span class="n">NVTEMP</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3211"></a>
<a name="ln-3212"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">E</span> <span class="o">/=</span> <span class="n">NV2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3213"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NVOUT</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Compute HC values for edges of output polygon</span>
<a name="ln-3214"></a>          <span class="k">DO </span><span class="n">P</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">NVOUT</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-3215"></a>            <span class="n">ATEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3216"></a>            <span class="n">BTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<a name="ln-3217"></a>            <span class="n">CTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">P</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3218"></a>          <span class="k">END DO</span>
<a name="ln-3219"></a><span class="k">          </span><span class="n">ATEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3220"></a>          <span class="n">BTEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span>
<a name="ln-3221"></a>          <span class="n">CTEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span><span class="o">*</span><span class="n">YTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">NVOUT</span><span class="p">)</span><span class="o">*</span><span class="n">XTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3222"></a>        <span class="k">END IF</span>
<a name="ln-3223"></a><span class="k">      END IF</span>
<a name="ln-3224"></a>
<a name="ln-3225"></a><span class="k">    END DO</span>  <span class="c">! end loop over edges in NS2</span>
<a name="ln-3226"></a>
<a name="ln-3227"></a>    <span class="n">NV3</span> <span class="o">=</span> <span class="n">NVOUT</span>
<a name="ln-3228"></a>
<a name="ln-3229"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">NV3</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>     <span class="c">! Determine overlap status</span>
<a name="ln-3230"></a>    <span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">NoOverlap</span>
<a name="ln-3231"></a>  <span class="k">ELSE IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">INTFLAG</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3232"></a><span class="k">    </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">FirstSurfWithinSecond</span>
<a name="ln-3233"></a>  <span class="k">END IF</span>
<a name="ln-3234"></a>
<a name="ln-3235"></a><span class="k">END SUBROUTINE </span><span class="n">CLIPPOLY</span>
<a name="ln-3236"></a>
<a name="ln-3237"></a>
<a name="ln-3238"></a><span class="k">SUBROUTINE </span><span class="n">MULTOL</span><span class="p">(</span><span class="n">NNN</span><span class="p">,</span><span class="n">LOC0</span><span class="p">,</span><span class="n">NRFIGS</span><span class="p">)</span>
<a name="ln-3239"></a>
<a name="ln-3240"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3241"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-3242"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-3243"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3244"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-3245"></a>
<a name="ln-3246"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3247"></a>          <span class="c">! This subroutine determines the overlaps of figure &#39;NS2&#39; with previous figures</span>
<a name="ln-3248"></a>          <span class="c">! &#39;LOC0+1&#39; through &#39;LOC0+NRFIGS&#39;.  For example, if NS2</span>
<a name="ln-3249"></a>          <span class="c">! is a shadow, overlap with previous shadows.</span>
<a name="ln-3250"></a>
<a name="ln-3251"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3252"></a>          <span class="c">! na</span>
<a name="ln-3253"></a>
<a name="ln-3254"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3255"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-3256"></a>
<a name="ln-3257"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3258"></a>          <span class="c">! na</span>
<a name="ln-3259"></a>
<a name="ln-3260"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3261"></a>
<a name="ln-3262"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3263"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NNN</span>    <span class="c">! argument</span>
<a name="ln-3264"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">LOC0</span>   <span class="c">! Location in the homogeneous coordinate array</span>
<a name="ln-3265"></a>                                <span class="c">! first figure overlapped (minus 1)</span>
<a name="ln-3266"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NRFIGS</span> <span class="c">! Number of figures overlapped</span>
<a name="ln-3267"></a>
<a name="ln-3268"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3269"></a>          <span class="c">! na</span>
<a name="ln-3270"></a>
<a name="ln-3271"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3272"></a>          <span class="c">! na</span>
<a name="ln-3273"></a>
<a name="ln-3274"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3275"></a>          <span class="c">! na</span>
<a name="ln-3276"></a>
<a name="ln-3277"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3278"></a>  <span class="kt">INTEGER  </span><span class="n">I</span>  <span class="c">! Loop Control</span>
<a name="ln-3279"></a>  <span class="kt">INTEGER </span><span class="n">NS1</span> <span class="c">! Number of the figure being overlapped</span>
<a name="ln-3280"></a>  <span class="kt">INTEGER </span><span class="n">NS2</span> <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-3281"></a>  <span class="kt">INTEGER </span><span class="n">NS3</span> <span class="c">! Location to place results of overlap</span>
<a name="ln-3282"></a>
<a name="ln-3283"></a>  <span class="n">maxNumberOfFigures</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">maxNumberOfFigures</span><span class="p">,</span><span class="n">NRFIGS</span><span class="p">)</span>
<a name="ln-3284"></a>
<a name="ln-3285"></a>  <span class="n">NS2</span><span class="o">=</span><span class="n">NNN</span>
<a name="ln-3286"></a>  <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NRFIGS</span>
<a name="ln-3287"></a>    <span class="n">NS1</span><span class="o">=</span><span class="n">LOC0</span><span class="o">+</span><span class="n">I</span>
<a name="ln-3288"></a>    <span class="n">NS3</span><span class="o">=</span><span class="n">LOCHCA</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3289"></a>
<a name="ln-3290"></a>    <span class="k">CALL </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="c">! Find overlap of figure NS2 on figure NS1.</span>
<a name="ln-3291"></a>
<a name="ln-3292"></a>          <span class="c">! Process overlap cases:</span>
<a name="ln-3293"></a>
<a name="ln-3294"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">NoOverlap</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3295"></a>
<a name="ln-3296"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3297"></a>         <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-3298"></a>
<a name="ln-3299"></a><span class="k">    </span><span class="n">LOCHCA</span><span class="o">=</span><span class="n">NS3</span>  <span class="c">! Increment h.c. arrays pointer.</span>
<a name="ln-3300"></a>
<a name="ln-3301"></a>  <span class="k">END DO</span>
<a name="ln-3302"></a>
<a name="ln-3303"></a><span class="k">  RETURN</span>
<a name="ln-3304"></a>
<a name="ln-3305"></a><span class="k">END SUBROUTINE </span><span class="n">MULTOL</span>
<a name="ln-3306"></a>
<a name="ln-3307"></a><span class="k">SUBROUTINE </span><span class="n">ORDER</span><span class="p">(</span><span class="n">NV3</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-3308"></a>
<a name="ln-3309"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3310"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-3311"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-3312"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3313"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-3314"></a>
<a name="ln-3315"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3316"></a>          <span class="c">! This subroutine sorts the vertices found by inclosure and</span>
<a name="ln-3317"></a>          <span class="c">! intercept in to clockwise order so that the overlap polygon</span>
<a name="ln-3318"></a>          <span class="c">! may be used in computing subsequent overlaps.</span>
<a name="ln-3319"></a>
<a name="ln-3320"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3321"></a>          <span class="c">! The slopes of the lines from the left-most vertex to all</span>
<a name="ln-3322"></a>          <span class="c">! others are found.  The slopes are sorted into descending</span>
<a name="ln-3323"></a>          <span class="c">! sequence.  This sequence puts the vertices in clockwise order.</span>
<a name="ln-3324"></a>
<a name="ln-3325"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3326"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-3327"></a>
<a name="ln-3328"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3329"></a>          <span class="c">! na</span>
<a name="ln-3330"></a>
<a name="ln-3331"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3332"></a>
<a name="ln-3333"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3334"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NV3</span>  <span class="c">! Number of vertices of figure NS3</span>
<a name="ln-3335"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS3</span>  <span class="c">! Location to place results of overlap</span>
<a name="ln-3336"></a>
<a name="ln-3337"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3338"></a>          <span class="c">! na</span>
<a name="ln-3339"></a>
<a name="ln-3340"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3341"></a>          <span class="c">! na</span>
<a name="ln-3342"></a>
<a name="ln-3343"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3344"></a>          <span class="c">! na</span>
<a name="ln-3345"></a>
<a name="ln-3346"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SLOPE</span>  <span class="c">! Slopes from left-most vertex to others</span>
<a name="ln-3348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DELTAX</span> <span class="c">! Difference between X coordinates of two vertices</span>
<a name="ln-3349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">DELTAY</span> <span class="c">! Difference between Y coordinates of two vertices</span>
<a name="ln-3350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SAVES</span>  <span class="c">! Temporary location for exchange of variables</span>
<a name="ln-3351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SAVEX</span>  <span class="c">! Temporary location for exchange of variables</span>
<a name="ln-3352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SAVEY</span>  <span class="c">! Temporary location for exchange of variables</span>
<a name="ln-3353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">XMIN</span>   <span class="c">! X coordinate of left-most vertex</span>
<a name="ln-3354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">YXMIN</span>  <span class="c">!</span>
<a name="ln-3355"></a>  <span class="kt">INTEGER </span><span class="n">I</span>      <span class="c">! Sort index</span>
<a name="ln-3356"></a>  <span class="kt">INTEGER </span><span class="n">IM1</span>    <span class="c">! Sort control</span>
<a name="ln-3357"></a>  <span class="kt">INTEGER </span><span class="n">J</span>      <span class="c">! Sort index</span>
<a name="ln-3358"></a>  <span class="kt">INTEGER </span><span class="n">M</span>      <span class="c">! Number of slopes to be sorted</span>
<a name="ln-3359"></a>  <span class="kt">INTEGER </span><span class="n">N</span>      <span class="c">! Vertex number</span>
<a name="ln-3360"></a>  <span class="kt">INTEGER </span><span class="n">P</span>      <span class="c">! Location of first slope to be sorted</span>
<a name="ln-3361"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">FirstTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3362"></a>
<a name="ln-3363"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FirstTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3364"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">SLOPE</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3365"></a>    <span class="n">FirstTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3366"></a>  <span class="n">ENDIF</span>
<a name="ln-3367"></a>          <span class="c">! Determine left-most vertex.</span>
<a name="ln-3368"></a>
<a name="ln-3369"></a>  <span class="n">XMIN</span>  <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3370"></a>  <span class="n">YXMIN</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3371"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NV3</span>
<a name="ln-3372"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">XMIN</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3373"></a><span class="k">    </span><span class="n">XMIN</span>  <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-3374"></a>    <span class="n">YXMIN</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-3375"></a>  <span class="k">END DO</span>
<a name="ln-3376"></a>
<a name="ln-3377"></a>          <span class="c">! Determine slopes from left-most vertex to all others.  Identify</span>
<a name="ln-3378"></a>          <span class="c">! first and second or last points as they occur.</span>
<a name="ln-3379"></a>
<a name="ln-3380"></a>  <span class="n">P</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-3381"></a>  <span class="n">M</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3382"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NV3</span>
<a name="ln-3383"></a>
<a name="ln-3384"></a>    <span class="n">DELTAX</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">XMIN</span>
<a name="ln-3385"></a>    <span class="n">DELTAY</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">YXMIN</span>
<a name="ln-3386"></a>
<a name="ln-3387"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">DELTAX</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3388"></a>
<a name="ln-3389"></a><span class="k">      </span><span class="n">M</span>        <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3390"></a>      <span class="n">SLOPE</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">DELTAY</span><span class="o">/</span><span class="n">DELTAX</span>
<a name="ln-3391"></a>      <span class="n">XTEMP</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-3392"></a>      <span class="n">YTEMP</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-3393"></a>
<a name="ln-3394"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DELTAY</span> <span class="o">&gt;</span> <span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3395"></a>
<a name="ln-3396"></a><span class="k">      </span><span class="n">P</span>          <span class="o">=</span> <span class="mi">2</span>
<a name="ln-3397"></a>      <span class="n">HCX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3398"></a>      <span class="n">HCY</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3399"></a>
<a name="ln-3400"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">DELTAY</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.5d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3401"></a>
<a name="ln-3402"></a><span class="k">      </span><span class="n">HCX</span><span class="p">(</span><span class="n">NV3</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3403"></a>      <span class="n">HCY</span><span class="p">(</span><span class="n">NV3</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3404"></a>
<a name="ln-3405"></a>    <span class="k">ELSE</span>
<a name="ln-3406"></a>
<a name="ln-3407"></a><span class="k">      </span><span class="n">HCX</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">XMIN</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3408"></a>      <span class="n">HCY</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">NINT</span><span class="p">(</span><span class="n">YXMIN</span><span class="p">,</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3409"></a>
<a name="ln-3410"></a>    <span class="k">END IF</span>
<a name="ln-3411"></a>
<a name="ln-3412"></a><span class="k">  END DO</span>
<a name="ln-3413"></a>
<a name="ln-3414"></a>  <span class="c">! Sequence the temporary arrays in order of decreasing slopes.(bubble sort)</span>
<a name="ln-3415"></a>
<a name="ln-3416"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">M</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3417"></a>
<a name="ln-3418"></a><span class="k">    DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span>
<a name="ln-3419"></a>      <span class="n">IM1</span> <span class="o">=</span> <span class="n">I</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-3420"></a>      <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">IM1</span>
<a name="ln-3421"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SLOPE</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SLOPE</span><span class="p">(</span><span class="n">J</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-3422"></a><span class="k">        </span><span class="n">SAVEX</span>    <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-3423"></a>        <span class="n">SAVEY</span>    <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-3424"></a>        <span class="n">SAVES</span>    <span class="o">=</span> <span class="n">SLOPE</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-3425"></a>        <span class="n">XTEMP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">XTEMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-3426"></a>        <span class="n">YTEMP</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">YTEMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-3427"></a>        <span class="n">SLOPE</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">SLOPE</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-3428"></a>        <span class="n">XTEMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAVEX</span>
<a name="ln-3429"></a>        <span class="n">YTEMP</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAVEY</span>
<a name="ln-3430"></a>        <span class="n">SLOPE</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAVES</span>
<a name="ln-3431"></a>      <span class="k">END DO</span>
<a name="ln-3432"></a><span class="k">    END DO</span>
<a name="ln-3433"></a>
<a name="ln-3434"></a><span class="k">  END IF</span>
<a name="ln-3435"></a>
<a name="ln-3436"></a>          <span class="c">! Place sequenced points in the homogeneous coordinate arrays.</span>
<a name="ln-3437"></a>
<a name="ln-3438"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">M</span>
<a name="ln-3439"></a>    <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">P</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3440"></a>    <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">P</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3441"></a>  <span class="k">END DO</span>
<a name="ln-3442"></a>
<a name="ln-3443"></a><span class="k">  RETURN</span>
<a name="ln-3444"></a>
<a name="ln-3445"></a><span class="k">END SUBROUTINE </span><span class="n">ORDER</span>
<a name="ln-3446"></a>
<a name="ln-3447"></a><span class="k">SUBROUTINE </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-3448"></a>
<a name="ln-3449"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3450"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-3451"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-3452"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3453"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-3454"></a>
<a name="ln-3455"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3456"></a>          <span class="c">! This subroutine computes the possible overlap of two polygons.</span>
<a name="ln-3457"></a>          <span class="c">! It uses homogeneous coordinate techniques to determine the overlap area</span>
<a name="ln-3458"></a>          <span class="c">! between two convex polygons.  Results are stored in the homogeneous coordinate (HC) arrays.</span>
<a name="ln-3459"></a>
<a name="ln-3460"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3461"></a>          <span class="c">! The vertices defining the overlap between fig.1 and fig.2</span>
<a name="ln-3462"></a>          <span class="c">! consist of: the vertices of fig.1 enclosed by fig.2 (A)</span>
<a name="ln-3463"></a>          <span class="c">! plus the vertices of fig.2 enclosed by fig.1 (B)</span>
<a name="ln-3464"></a>          <span class="c">! plus the intercepts of fig.1 and fig.2 (C &amp; D)</span>
<a name="ln-3465"></a>
<a name="ln-3466"></a>          <span class="c">!                               +----------------------+</span>
<a name="ln-3467"></a>          <span class="c">!                               !                      !</span>
<a name="ln-3468"></a>          <span class="c">!                               !         FIG.2        !</span>
<a name="ln-3469"></a>          <span class="c">!                               !                      !</span>
<a name="ln-3470"></a>          <span class="c">!                +--------------C----------A           !</span>
<a name="ln-3471"></a>          <span class="c">!                !              !         /            !</span>
<a name="ln-3472"></a>          <span class="c">!                !              !        /             !</span>
<a name="ln-3473"></a>          <span class="c">!                !              B-------D--------------+</span>
<a name="ln-3474"></a>          <span class="c">!                !    FIG.1            /</span>
<a name="ln-3475"></a>          <span class="c">!                !                    /</span>
<a name="ln-3476"></a>          <span class="c">!                +-------------------+</span>
<a name="ln-3477"></a>
<a name="ln-3478"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3479"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-3480"></a>
<a name="ln-3481"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3482"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-3483"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SutherlandHodgman</span>
<a name="ln-3484"></a>
<a name="ln-3485"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3486"></a>
<a name="ln-3487"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3488"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS1</span>  <span class="c">! Number of the figure being overlapped</span>
<a name="ln-3489"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS2</span>  <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-3490"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NS3</span>  <span class="c">! Location to place results of overlap</span>
<a name="ln-3491"></a>
<a name="ln-3492"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3493"></a>          <span class="c">! na</span>
<a name="ln-3494"></a>
<a name="ln-3495"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3496"></a>          <span class="c">! na</span>
<a name="ln-3497"></a>
<a name="ln-3498"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3499"></a>          <span class="c">! na</span>
<a name="ln-3500"></a>
<a name="ln-3501"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3502"></a>  <span class="kt">INTEGER </span><span class="n">N</span>  <span class="c">! Loop index</span>
<a name="ln-3503"></a>  <span class="kt">INTEGER </span><span class="n">NV1</span>      <span class="c">! Number of vertices of figure NS1</span>
<a name="ln-3504"></a>  <span class="kt">INTEGER </span><span class="n">NV2</span>      <span class="c">! Number of vertices of figure NS2</span>
<a name="ln-3505"></a>  <span class="kt">INTEGER </span><span class="n">NV3</span>      <span class="c">! Number of vertices of figure NS3 (the overlap of NS1 and NS2)</span>
<a name="ln-3506"></a>  <span class="kt">INTEGER </span><span class="n">NIN1</span>     <span class="c">! Number of vertices of NS1 within NS2</span>
<a name="ln-3507"></a>  <span class="kt">INTEGER </span><span class="n">NIN2</span>     <span class="c">! Number of vertices of NS2 within NS1</span>
<a name="ln-3508"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">TooManyFiguresMessage</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3509"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">TooManyVerticesMessage</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3510"></a>
<a name="ln-3511"></a>          <span class="c">! Check for exceeding array limits.</span>
<a name="ln-3512"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-3513"></a><span class="n">NumDetPolyOverlap_Calls</span><span class="o">=</span><span class="n">NumDetPolyOverlap_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3514"></a><span class="cp">#endif</span>
<a name="ln-3515"></a>
<a name="ln-3516"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NS3</span> <span class="o">&gt;</span> <span class="n">MAXHCS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3517"></a>
<a name="ln-3518"></a><span class="k">    </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">TooManyFigures</span>
<a name="ln-3519"></a>
<a name="ln-3520"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TooManyFiguresMessage</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3521"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;DeterminePolygonOverlap: Too many figures [&gt;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3522"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]  detected in an overlap calculation.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3523"></a>           <span class="s1">&#39; Use Output:Diagnostics,DisplayExtraWarnings; for more details.&#39;</span><span class="p">)</span>
<a name="ln-3524"></a>      <span class="n">TooManyFiguresMessage</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3525"></a>    <span class="n">ENDIF</span>
<a name="ln-3526"></a>
<a name="ln-3527"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3528"></a><span class="k">      </span><span class="n">NumTooManyFigures</span><span class="o">=</span><span class="n">NumTooManyFigures</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3529"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumTooManyFigures</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3530"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">))</span>
<a name="ln-3531"></a>        <span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumTooManyFigures</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">TrackTooManyFigures</span>
<a name="ln-3532"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">)</span>
<a name="ln-3533"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">))</span>
<a name="ln-3534"></a>        <span class="n">TrackTooManyFigures</span><span class="o">=</span><span class="n">TempSurfErrorTracking</span>
<a name="ln-3535"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">)</span>
<a name="ln-3536"></a>      <span class="k">ELSE</span>
<a name="ln-3537"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">))</span>
<a name="ln-3538"></a>      <span class="n">ENDIF</span>
<a name="ln-3539"></a>      <span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="o">=</span><span class="n">CurrentShadowingSurface</span>
<a name="ln-3540"></a>      <span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="o">=</span><span class="n">CurrentSurfaceBeingShadowed</span>
<a name="ln-3541"></a>    <span class="n">ENDIF</span>
<a name="ln-3542"></a>
<a name="ln-3543"></a>    <span class="k">RETURN</span>
<a name="ln-3544"></a>
<a name="ln-3545"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-3546"></a>
<a name="ln-3547"></a>  <span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">PartialOverlap</span>
<a name="ln-3548"></a>  <span class="n">NV1</span>           <span class="o">=</span> <span class="n">HCNV</span><span class="p">(</span><span class="n">NS1</span><span class="p">)</span>
<a name="ln-3549"></a>  <span class="n">NV2</span>           <span class="o">=</span> <span class="n">HCNV</span><span class="p">(</span><span class="n">NS2</span><span class="p">)</span>
<a name="ln-3550"></a>  <span class="n">NV3</span>           <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3551"></a>
<a name="ln-3552"></a>
<a name="ln-3553"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SutherlandHodgman</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3554"></a><span class="k">    CALL </span><span class="n">INCLOS</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NV1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NV2</span><span class="p">,</span><span class="n">NV3</span><span class="p">,</span><span class="n">NIN1</span><span class="p">)</span> <span class="c">! Find vertices of NS1 within NS2.</span>
<a name="ln-3555"></a>
<a name="ln-3556"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NIN1</span> <span class="o">&gt;=</span> <span class="n">NV1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3557"></a>
<a name="ln-3558"></a><span class="k">      </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">FirstSurfWithinSecond</span>
<a name="ln-3559"></a>
<a name="ln-3560"></a>    <span class="k">ELSE</span>
<a name="ln-3561"></a>
<a name="ln-3562"></a><span class="k">      CALL </span><span class="n">INCLOS</span><span class="p">(</span><span class="n">NS2</span><span class="p">,</span><span class="n">NV2</span><span class="p">,</span><span class="n">NS1</span><span class="p">,</span><span class="n">NV1</span><span class="p">,</span><span class="n">NV3</span><span class="p">,</span><span class="n">NIN2</span><span class="p">)</span>   <span class="c">! Find vertices of NS2 within NS1.</span>
<a name="ln-3563"></a>
<a name="ln-3564"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NIN2</span> <span class="o">&gt;=</span> <span class="n">NV2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3565"></a>
<a name="ln-3566"></a><span class="k">        </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">SecondSurfWithinFirst</span>
<a name="ln-3567"></a>
<a name="ln-3568"></a>      <span class="k">ELSE</span>
<a name="ln-3569"></a>
<a name="ln-3570"></a><span class="k">        CALL </span><span class="n">INTCPT</span><span class="p">(</span><span class="n">NV1</span><span class="p">,</span><span class="n">NV2</span><span class="p">,</span><span class="n">NV3</span><span class="p">,</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">)</span>   <span class="c">! Find intercepts of NS1 &amp; NS2.</span>
<a name="ln-3571"></a>
<a name="ln-3572"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NV3</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! Overlap must have 3 or more vertices</span>
<a name="ln-3573"></a>          <span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">NoOverlap</span>
<a name="ln-3574"></a>          <span class="k">RETURN</span>
<a name="ln-3575"></a><span class="k">        END IF</span>
<a name="ln-3576"></a>
<a name="ln-3577"></a><span class="k">      END IF</span>
<a name="ln-3578"></a>
<a name="ln-3579"></a><span class="k">    END IF</span>
<a name="ln-3580"></a>
<a name="ln-3581"></a><span class="k">  ELSE</span>
<a name="ln-3582"></a>    <span class="c">! simple polygon clipping</span>
<a name="ln-3583"></a>    <span class="k">CALL </span><span class="n">CLIPPOLY</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NV1</span><span class="p">,</span><span class="n">NV2</span><span class="p">,</span><span class="n">NV3</span><span class="p">)</span>
<a name="ln-3584"></a>  <span class="n">ENDIF</span>
<a name="ln-3585"></a>
<a name="ln-3586"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NV3</span> <span class="o">&lt;</span> <span class="n">MAXHCV</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">NS3</span> <span class="o">&lt;=</span> <span class="n">MAXHCS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3587"></a>
<a name="ln-3588"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">SutherlandHodgman</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3589"></a><span class="k">      CALL </span><span class="n">ORDER</span><span class="p">(</span><span class="n">NV3</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>  <span class="c">! Put vertices in clockwise order.</span>
<a name="ln-3590"></a>    <span class="k">ELSE</span>
<a name="ln-3591"></a><span class="k">      DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NV3</span>
<a name="ln-3592"></a>        <span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">XTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3593"></a>        <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">YTEMP</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="n">i64</span><span class="p">)</span>
<a name="ln-3594"></a>      <span class="k">END DO</span>
<a name="ln-3595"></a><span class="k">    </span><span class="n">ENDIF</span>
<a name="ln-3596"></a>
<a name="ln-3597"></a>    <span class="k">CALL </span><span class="n">HTRANS0</span><span class="p">(</span><span class="n">NS3</span><span class="p">,</span><span class="n">NV3</span><span class="p">)</span>  <span class="c">! Determine h.c. values of sides.</span>
<a name="ln-3598"></a>        <span class="c">! Skip overlaps of negligible area.</span>
<a name="ln-3599"></a>
<a name="ln-3600"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS3</span><span class="p">))</span><span class="o">*</span><span class="n">HCMULT</span> <span class="o">&lt;</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-3601"></a><span class="k">      </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">NoOverlap</span>
<a name="ln-3602"></a>    <span class="k">ELSE</span>
<a name="ln-3603"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS1</span><span class="p">)</span><span class="o">*</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span>  <span class="c">! Determine sign of area of overlap</span>
<a name="ln-3604"></a>      <span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCT</span><span class="p">(</span><span class="n">NS2</span><span class="p">)</span><span class="o">*</span><span class="n">HCT</span><span class="p">(</span><span class="n">NS1</span><span class="p">)</span>  <span class="c">! Determine transmission of overlap</span>
<a name="ln-3605"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">HCT</span><span class="p">(</span><span class="n">NS2</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">HCT</span><span class="p">(</span><span class="n">NS2</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">HCT</span><span class="p">(</span><span class="n">NS1</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">HCT</span><span class="p">(</span><span class="n">NS1</span><span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3606"></a><span class="k">        if</span> <span class="p">(</span><span class="n">HCT</span><span class="p">(</span><span class="n">NS2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">.</span><span class="mi">5</span><span class="n">d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">HCT</span><span class="p">(</span><span class="n">NS1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">.</span><span class="mi">5</span><span class="n">d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-3607"></a><span class="k">          </span><span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-3608"></a>        <span class="n">endif</span>
<a name="ln-3609"></a>      <span class="n">endif</span>
<a name="ln-3610"></a>    <span class="k">END IF</span>
<a name="ln-3611"></a>
<a name="ln-3612"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NV3</span> <span class="o">&gt;</span> <span class="n">MAXHCV</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3613"></a>
<a name="ln-3614"></a><span class="k">    </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">TooManyVertices</span>
<a name="ln-3615"></a>
<a name="ln-3616"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TooManyVerticesMessage</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3617"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;DeterminePolygonOverlap: Too many vertices [&gt;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3618"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCV</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] detected in an overlap calculation.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3619"></a>           <span class="s1">&#39; Use Output:Diagnostics,DisplayExtraWarnings; for more details.&#39;</span><span class="p">)</span>
<a name="ln-3620"></a>      <span class="n">TooManyVerticesMessage</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3621"></a>    <span class="n">ENDIF</span>
<a name="ln-3622"></a>
<a name="ln-3623"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3624"></a><span class="k">      </span><span class="n">NumTooManyVertices</span><span class="o">=</span><span class="n">NumTooManyVertices</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3625"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumTooManyVertices</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3626"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="n">NumTooManyVertices</span><span class="p">))</span>
<a name="ln-3627"></a>        <span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumTooManyVertices</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">TrackTooManyVertices</span>
<a name="ln-3628"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">)</span>
<a name="ln-3629"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">NumTooManyVertices</span><span class="p">))</span>
<a name="ln-3630"></a>        <span class="n">TrackTooManyVertices</span><span class="o">=</span><span class="n">TempSurfErrorTracking</span>
<a name="ln-3631"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">)</span>
<a name="ln-3632"></a>      <span class="k">ELSE</span>
<a name="ln-3633"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">NumTooManyVertices</span><span class="p">))</span>
<a name="ln-3634"></a>      <span class="n">ENDIF</span>
<a name="ln-3635"></a>      <span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">NumTooManyVertices</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="o">=</span><span class="n">CurrentShadowingSurface</span>
<a name="ln-3636"></a>      <span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">NumTooManyVertices</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="o">=</span><span class="n">CurrentSurfaceBeingShadowed</span>
<a name="ln-3637"></a>    <span class="n">ENDIF</span>
<a name="ln-3638"></a>
<a name="ln-3639"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">NS3</span> <span class="o">&gt;</span> <span class="n">MAXHCS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3640"></a>
<a name="ln-3641"></a><span class="k">    </span><span class="n">OverlapStatus</span> <span class="o">=</span> <span class="n">TooManyFigures</span>
<a name="ln-3642"></a>
<a name="ln-3643"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">TooManyFiguresMessage</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3644"></a><span class="k">      CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;DeterminePolygonOverlap: Too many figures [&gt;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3645"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]  detected in an overlap calculation.&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3646"></a>           <span class="s1">&#39; Use Output:Diagnostics,DisplayExtraWarnings; for more details.&#39;</span><span class="p">)</span>
<a name="ln-3647"></a>      <span class="n">TooManyFiguresMessage</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3648"></a>    <span class="n">ENDIF</span>
<a name="ln-3649"></a>
<a name="ln-3650"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3651"></a><span class="k">      </span><span class="n">NumTooManyFigures</span><span class="o">=</span><span class="n">NumTooManyFigures</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3652"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NumTooManyFigures</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3653"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">))</span>
<a name="ln-3654"></a>        <span class="n">TempSurfErrorTracking</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NumTooManyFigures</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">TrackTooManyFigures</span>
<a name="ln-3655"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">)</span>
<a name="ln-3656"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">))</span>
<a name="ln-3657"></a>        <span class="n">TrackTooManyFigures</span><span class="o">=</span><span class="n">TempSurfErrorTracking</span>
<a name="ln-3658"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">TempSurfErrorTracking</span><span class="p">)</span>
<a name="ln-3659"></a>      <span class="k">ELSE</span>
<a name="ln-3660"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">))</span>
<a name="ln-3661"></a>      <span class="n">ENDIF</span>
<a name="ln-3662"></a>      <span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="o">=</span><span class="n">CurrentShadowingSurface</span>
<a name="ln-3663"></a>      <span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">NumTooManyFigures</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="o">=</span><span class="n">CurrentSurfaceBeingShadowed</span>
<a name="ln-3664"></a>    <span class="n">ENDIF</span>
<a name="ln-3665"></a>
<a name="ln-3666"></a>  <span class="n">ENDIF</span>
<a name="ln-3667"></a>
<a name="ln-3668"></a>  <span class="k">RETURN</span>
<a name="ln-3669"></a>
<a name="ln-3670"></a><span class="k">END SUBROUTINE </span><span class="n">DeterminePolygonOverlap</span>
<a name="ln-3671"></a>
<a name="ln-3672"></a><span class="k">SUBROUTINE </span><span class="n">CalcPerSolarBeam</span><span class="p">(</span><span class="n">AvgEqOfTime</span><span class="p">,</span><span class="n">AvgSinSolarDeclin</span><span class="p">,</span><span class="n">AvgCosSolarDeclin</span><span class="p">)</span>
<a name="ln-3673"></a>
<a name="ln-3674"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3675"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-3676"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-3677"></a>          <span class="c">!       MODIFIED       BG, Nov 2012 - Timestep solar.  DetailedSolarTimestepIntegration</span>
<a name="ln-3678"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-3679"></a>
<a name="ln-3680"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3681"></a>          <span class="c">! This subroutine manages computation of solar gain multipliers for beam radiation.  These</span>
<a name="ln-3682"></a>          <span class="c">! are calculated for a period of days depending on the input &quot;Shadowing Calculations&quot;.</span>
<a name="ln-3683"></a>
<a name="ln-3684"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3685"></a>          <span class="c">! na</span>
<a name="ln-3686"></a>
<a name="ln-3687"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3688"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-3689"></a>
<a name="ln-3690"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3691"></a>  <span class="k">USE </span><span class="n">WindowComplexManager</span><span class="p">,</span><span class="n">ONLY</span><span class="p">:</span> <span class="n">InitComplexWindows</span><span class="p">,</span> <span class="n">UpdateComplexWindows</span>
<a name="ln-3692"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span><span class="p">,</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-3693"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepZone</span><span class="p">,</span> <span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span>
<a name="ln-3694"></a>
<a name="ln-3695"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3696"></a>
<a name="ln-3697"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3698"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvgSinSolarDeclin</span> <span class="c">! Average value of Sine of Solar Declination for period</span>
<a name="ln-3699"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvgCosSolarDeclin</span> <span class="c">! Average value of Cosine of Solar Declination for period</span>
<a name="ln-3700"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AvgEqOfTime</span>       <span class="c">! Average value of Equation of Time for period</span>
<a name="ln-3701"></a>
<a name="ln-3702"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3703"></a>
<a name="ln-3704"></a>
<a name="ln-3705"></a>
<a name="ln-3706"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-3707"></a>          <span class="c">! na</span>
<a name="ln-3708"></a>
<a name="ln-3709"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-3710"></a>          <span class="c">! na</span>
<a name="ln-3711"></a>
<a name="ln-3712"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3713"></a>  <span class="kt">INTEGER </span><span class="n">IHOUR</span>   <span class="c">! Hour index number</span>
<a name="ln-3714"></a>  <span class="kt">INTEGER </span><span class="n">TS</span>     <span class="c">! TimeStep Loop Counter</span>
<a name="ln-3715"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">Once</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-3716"></a>
<a name="ln-3717"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Once</span><span class="p">)</span> <span class="k">CALL </span><span class="n">InitComplexWindows</span>
<a name="ln-3718"></a>  <span class="n">Once</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-3719"></a>
<a name="ln-3720"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">KickOffSizing</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">KickOffSimulation</span><span class="p">)</span> <span class="k">RETURN</span>  <span class="c">! Skip solar calcs for these Initialization steps.</span>
<a name="ln-3721"></a>
<a name="ln-3722"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-3723"></a>  <span class="n">NumCalcPerSolBeam_Calls</span><span class="o">=</span><span class="n">NumCalcPerSolBeam_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-3724"></a><span class="cp">#endif</span>
<a name="ln-3725"></a>
<a name="ln-3726"></a>  <span class="c">! Intialize some values for the appropriate period</span>
<a name="ln-3727"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3728"></a><span class="k">    </span><span class="n">SunLitFracHR</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3729"></a>    <span class="n">SunLitFrac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3730"></a>    <span class="n">SunLitFracWithoutReveal</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3731"></a>    <span class="n">CTHETA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3732"></a>    <span class="n">CosIncAngHR</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3733"></a>    <span class="n">CosIncAng</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3734"></a>    <span class="n">AOSurf</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3735"></a>    <span class="n">BackSurfaces</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-3736"></a>    <span class="n">OverlapAreas</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3737"></a>    <span class="k">DO </span><span class="n">IHOUR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">24</span>
<a name="ln-3738"></a>      <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">OutProjSLFracMult</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">)</span>   <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3739"></a>      <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InOutProjSLFracMult</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3740"></a>    <span class="k">END DO</span>
<a name="ln-3741"></a>
<a name="ln-3742"></a><span class="k">  ELSE</span>
<a name="ln-3743"></a><span class="k">    </span><span class="n">SunLitFracHR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>                      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3744"></a>    <span class="n">SunLitFrac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>               <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3745"></a>    <span class="n">SunLitFracWithoutReveal</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3746"></a>    <span class="n">CTHETA</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">)</span>                                      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3747"></a>    <span class="n">CosIncAngHR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">)</span>                       <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3748"></a>    <span class="n">CosIncAng</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>                <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3749"></a>    <span class="n">AOSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">)</span>                                      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3750"></a>    <span class="n">BackSurfaces</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxBkSurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3751"></a>    <span class="n">OverlapAreas</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxBkSurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-3752"></a>    <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">OutProjSLFracMult</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>                <span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-3753"></a>    <span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">InOutProjSLFracMult</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>              <span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-3754"></a>  <span class="n">ENDIF</span>
<a name="ln-3755"></a>
<a name="ln-3756"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3757"></a><span class="k">    DO </span><span class="n">IHOUR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span>  <span class="c">! Do for all hours.</span>
<a name="ln-3758"></a>      <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-3759"></a>        <span class="k">CALL </span><span class="n">FigureSunCosines</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span> <span class="n">TS</span><span class="p">,</span> <span class="n">AvgEqOfTime</span><span class="p">,</span> <span class="n">AvgSinSolarDeclin</span><span class="p">,</span> <span class="n">AvgCosSolarDeclin</span><span class="p">)</span>
<a name="ln-3760"></a>      <span class="k">END DO</span>
<a name="ln-3761"></a><span class="k">    END DO</span>
<a name="ln-3762"></a><span class="k">  ELSE</span>
<a name="ln-3763"></a><span class="k">    CALL </span><span class="n">FigureSunCosines</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">,</span> <span class="n">AvgEqOfTime</span><span class="p">,</span> <span class="n">AvgSinSolarDeclin</span><span class="p">,</span> <span class="n">AvgCosSolarDeclin</span><span class="p">)</span>
<a name="ln-3764"></a>  <span class="n">ENDIF</span>
<a name="ln-3765"></a>  <span class="c">!</span>
<a name="ln-3766"></a>  <span class="c">!Initialize/update the Complex Fenestration geometry and optical properties</span>
<a name="ln-3767"></a>  <span class="k">CALL </span><span class="n">UpdateComplexWindows</span>
<a name="ln-3768"></a>  <span class="c">!</span>
<a name="ln-3769"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3770"></a><span class="k">    DO </span><span class="n">IHOUR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">24</span>  <span class="c">! Do for all hours.</span>
<a name="ln-3771"></a>      <span class="k">DO </span><span class="n">TS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span>
<a name="ln-3772"></a>        <span class="k">CALL </span><span class="n">FigureSolarBeamAtTimestep</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span> <span class="n">TS</span><span class="p">)</span>
<a name="ln-3773"></a>      <span class="k">END DO</span>  <span class="c">! TimeStep Loop</span>
<a name="ln-3774"></a>    <span class="k">END DO</span>  <span class="c">! Hour Loop</span>
<a name="ln-3775"></a>  <span class="k">ELSE</span>
<a name="ln-3776"></a><span class="k">    CALL </span><span class="n">FigureSolarBeamAtTimestep</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-3777"></a>  <span class="n">ENDIF</span>
<a name="ln-3778"></a>
<a name="ln-3779"></a>  <span class="k">RETURN</span>
<a name="ln-3780"></a>
<a name="ln-3781"></a><span class="k">END SUBROUTINE </span><span class="n">CalcPerSolarBeam</span>
<a name="ln-3782"></a>
<a name="ln-3783"></a><span class="k">SUBROUTINE </span><span class="n">FigureSunCosines</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span> <span class="n">iTimeStep</span><span class="p">,</span> <span class="n">EqOfTime</span><span class="p">,</span> <span class="n">SinSolarDeclin</span><span class="p">,</span> <span class="n">CosSolarDeclin</span><span class="p">)</span>
<a name="ln-3784"></a>
<a name="ln-3785"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3786"></a>          <span class="c">!       AUTHOR         B. Griffith</span>
<a name="ln-3787"></a>          <span class="c">!       DATE WRITTEN   October 2012</span>
<a name="ln-3788"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3789"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3790"></a>
<a name="ln-3791"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3792"></a>            <span class="c">! Determine solar position.  Default for sun below horizon.</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3795"></a>            <span class="c">! Given hour, timestep, equation of time, solar declination sine, and solar declination cosine,</span>
<a name="ln-3796"></a>            <span class="c">! determine sun directions for use elsewhere</span>
<a name="ln-3797"></a>
<a name="ln-3798"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3799"></a>          <span class="c">! na</span>
<a name="ln-3800"></a>
<a name="ln-3801"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3802"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">TimeStepZone</span>
<a name="ln-3803"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-3804"></a>
<a name="ln-3805"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3806"></a>
<a name="ln-3807"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3808"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-3809"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">iTimeStep</span>
<a name="ln-3810"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EqOfTime</span>    <span class="c">!  value of Equation of Time for period</span>
<a name="ln-3811"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSolarDeclin</span> <span class="c">!  value of Sine of Solar Declination for period</span>
<a name="ln-3812"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosSolarDeclin</span>  <span class="c">!  value of Cosine of Solar Declination for period</span>
<a name="ln-3813"></a>
<a name="ln-3814"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3815"></a>          <span class="c">! na</span>
<a name="ln-3816"></a>
<a name="ln-3817"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3818"></a>          <span class="c">! na</span>
<a name="ln-3819"></a>
<a name="ln-3820"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3821"></a>          <span class="c">! na</span>
<a name="ln-3822"></a>
<a name="ln-3823"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-3824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">CurrentTime</span> <span class="c">! Current Time for passing to Solar Position Routine</span>
<a name="ln-3825"></a>
<a name="ln-3826"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumOfTimeStepInHour</span> <span class="o">/=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3827"></a><span class="k">    </span><span class="n">CurrentTime</span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">iHour</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span> <span class="o">+</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">iTimeStep</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">TimeStepZone</span><span class="p">)</span>
<a name="ln-3828"></a>  <span class="k">ELSE</span>
<a name="ln-3829"></a><span class="k">    </span><span class="n">CurrentTime</span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span><span class="o">+</span><span class="n">TS1TimeOffset</span>
<a name="ln-3830"></a>  <span class="n">ENDIF</span>
<a name="ln-3831"></a>  <span class="k">CALL </span><span class="n">SUN4</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">,</span><span class="n">EqOfTime</span><span class="p">,</span><span class="n">SinSolarDeclin</span><span class="p">,</span><span class="n">CosSolarDeclin</span><span class="p">)</span>
<a name="ln-3832"></a>
<a name="ln-3833"></a>  <span class="c">! Save hourly values for use in DaylightingManager</span>
<a name="ln-3834"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3835"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">iTimeStep</span> <span class="o">==</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">SUNCOS</span>
<a name="ln-3836"></a>  <span class="k">ELSE</span>
<a name="ln-3837"></a><span class="k">    </span><span class="n">SUNCOSHR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">SUNCOS</span>
<a name="ln-3838"></a>  <span class="n">ENDIF</span>
<a name="ln-3839"></a>  <span class="c">! Save timestep values for use in WindowComplexManager</span>
<a name="ln-3840"></a>  <span class="n">SUNCOSTS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="n">SUNCOS</span>
<a name="ln-3841"></a>
<a name="ln-3842"></a>  <span class="k">RETURN</span>
<a name="ln-3843"></a>
<a name="ln-3844"></a><span class="k">END SUBROUTINE </span><span class="n">FigureSunCosines</span>
<a name="ln-3845"></a>
<a name="ln-3846"></a><span class="k">SUBROUTINE </span><span class="n">FigureSolarBeamAtTimestep</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span> <span class="n">iTimeStep</span><span class="p">)</span>
<a name="ln-3847"></a>
<a name="ln-3848"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-3849"></a>          <span class="c">!       AUTHOR         B.Griffith, derived from CalcPerSolarBeam, Legacy and Lawrie.</span>
<a name="ln-3850"></a>          <span class="c">!       DATE WRITTEN   October 2012</span>
<a name="ln-3851"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-3852"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-3853"></a>
<a name="ln-3854"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-3855"></a>          <span class="c">! This subroutine computes solar gain multipliers for beam solar</span>
<a name="ln-3856"></a>
<a name="ln-3857"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-3858"></a>          <span class="c">! na</span>
<a name="ln-3859"></a>
<a name="ln-3860"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-3861"></a>          <span class="c">! na</span>
<a name="ln-3862"></a>
<a name="ln-3863"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-3864"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span><span class="p">,</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-3865"></a>
<a name="ln-3866"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-3867"></a>
<a name="ln-3868"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-3869"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iHour</span>
<a name="ln-3870"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">iTimeStep</span>
<a name="ln-3871"></a>
<a name="ln-3872"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-3873"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">NPhi</span> <span class="o">=</span> <span class="mi">6</span>          <span class="c">! Number of altitude angle steps for sky integration</span>
<a name="ln-3874"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">NTheta</span> <span class="o">=</span> <span class="mi">24</span>       <span class="c">! Number of azimuth angle steps for sky integration</span>
<a name="ln-3875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Eps</span> <span class="o">=</span> <span class="mf">1.d-10</span>       <span class="c">! Small number</span>
<a name="ln-3876"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DPhi</span> <span class="o">=</span> <span class="n">PiOvr2</span><span class="o">/</span><span class="n">NPhi</span>         <span class="c">! Altitude step size, 15 deg for NPhi = 6</span>
<a name="ln-3877"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DTheta</span> <span class="o">=</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Pi</span><span class="o">/</span><span class="n">NTheta</span>    <span class="c">! Azimuth step size, 15 deg for NTheta = 24</span>
<a name="ln-3878"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DThetaDPhi</span> <span class="o">=</span> <span class="n">DTheta</span><span class="o">*</span><span class="n">DPhi</span>   <span class="c">! Product of DTheta and DPhi</span>
<a name="ln-3879"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">PhiMin</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">DPhi</span>        <span class="c">! Minimum altitude</span>
<a name="ln-3880"></a>
<a name="ln-3881"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-3882"></a>          <span class="c">! na</span>
<a name="ln-3883"></a>
<a name="ln-3884"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-3885"></a>          <span class="c">! na</span>
<a name="ln-3886"></a>
<a name="ln-3887"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS</span>
<a name="ln-3888"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfArea</span>          <span class="c">! Surface area. For walls, includes all window frame areas.</span>
<a name="ln-3889"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CosPhi</span>            <span class="c">! Cosine of Phi</span>
<a name="ln-3890"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface Loop index</span>
<a name="ln-3891"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Fac1WoShdg</span>        <span class="c">! Intermediate calculation factor, without shading</span>
<a name="ln-3892"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Fac1WithShdg</span>      <span class="c">! Intermediate calculation factor, with shading</span>
<a name="ln-3893"></a>
<a name="ln-3894"></a>  <span class="c">!Recover the sun direction from the array stored in previous loop</span>
<a name="ln-3895"></a>  <span class="n">SUNCOS</span> <span class="o">=</span> <span class="n">SUNCOSTS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span>
<a name="ln-3896"></a>
<a name="ln-3897"></a>  <span class="n">CTHETA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3898"></a>
<a name="ln-3899"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-3900"></a>
<a name="ln-3901"></a><span class="k">  DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-3902"></a>    <span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3903"></a>                    <span class="o">+</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-3904"></a>                    <span class="o">+</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3905"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3906"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">iTimeStep</span> <span class="o">==</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="n">CosIncAngHR</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-3907"></a>    <span class="k">ELSE</span>
<a name="ln-3908"></a><span class="k">      </span><span class="n">CosIncAngHR</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-3909"></a>    <span class="n">ENDIF</span>
<a name="ln-3910"></a>    <span class="n">CosIncAng</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-3911"></a>  <span class="k">END DO</span>
<a name="ln-3912"></a>
<a name="ln-3913"></a><span class="k">  CALL </span><span class="n">SHADOW</span><span class="p">(</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span>  <span class="c">! Determine sunlit areas and solar multipliers for all surfaces.</span>
<a name="ln-3914"></a>
<a name="ln-3915"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-3916"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">&gt;=</span> <span class="mf">1.d-10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3917"></a><span class="k">      </span><span class="n">SurfArea</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-3918"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3919"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">iTimeStep</span> <span class="o">==</span> <span class="n">NumOfTimeStepInHour</span><span class="p">)</span> <span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="n">SurfArea</span>
<a name="ln-3920"></a>      <span class="k">ELSE</span>
<a name="ln-3921"></a><span class="k">        </span><span class="n">SunLitFracHR</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="n">SurfArea</span>
<a name="ln-3922"></a>      <span class="n">ENDIF</span>
<a name="ln-3923"></a>      <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="n">SurfArea</span>
<a name="ln-3924"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-5</span><span class="p">)</span> <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-3925"></a>    <span class="n">ENDIF</span>
<a name="ln-3926"></a>
<a name="ln-3927"></a>    <span class="c">!Added check</span>
<a name="ln-3928"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3929"></a><span class="k">      </span><span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-3930"></a>    <span class="n">ENDIF</span>
<a name="ln-3931"></a>  <span class="k">END DO</span>
<a name="ln-3932"></a>
<a name="ln-3933"></a><span class="c">!   Note -- if not the below, values are set in SkyDifSolarShading routine (constant for simulation)</span>
<a name="ln-3934"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3935"></a>      <span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3936"></a><span class="k">    </span><span class="n">CosPhi</span><span class="o">=</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3937"></a>
<a name="ln-3938"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3939"></a>
<a name="ln-3940"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-3941"></a>         <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3942"></a>         <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3943"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3944"></a>
<a name="ln-3945"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3946"></a>
<a name="ln-3947"></a><span class="k">      </span><span class="n">Fac1WoShdg</span> <span class="o">=</span> <span class="n">CosPhi</span> <span class="o">*</span> <span class="n">DThetaDPhi</span> <span class="o">*</span> <span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-3948"></a>      <span class="n">Fac1WithShdg</span> <span class="o">=</span> <span class="n">Fac1WoShdg</span> <span class="o">*</span> <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span>
<a name="ln-3949"></a>      <span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Fac1WithShdg</span>
<a name="ln-3950"></a>      <span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Fac1WoShdg</span>
<a name="ln-3951"></a>
<a name="ln-3952"></a>      <span class="c">! Horizon region</span>
<a name="ln-3953"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">PhiMin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3954"></a><span class="k">        </span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Fac1WithShdg</span>
<a name="ln-3955"></a>        <span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Fac1WoShdg</span>
<a name="ln-3956"></a>      <span class="k">END IF</span>
<a name="ln-3957"></a><span class="k">    END DO</span>  <span class="c">! End of surface loop</span>
<a name="ln-3958"></a>
<a name="ln-3959"></a>    <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-3960"></a>
<a name="ln-3961"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>                                                     <span class="p">&amp;</span>
<a name="ln-3962"></a>         <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3963"></a>         <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3964"></a>          <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-3965"></a>
<a name="ln-3966"></a><span class="k">      IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">Eps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3967"></a><span class="k">        </span><span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-3968"></a>      <span class="k">ELSE</span>
<a name="ln-3969"></a><span class="k">        </span><span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">+</span><span class="n">Eps</span><span class="p">)</span>
<a name="ln-3970"></a>      <span class="n">ENDIF</span>
<a name="ln-3971"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">Eps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3972"></a><span class="k">        </span><span class="n">DifShdgRatioHorizHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-3973"></a>      <span class="k">ELSE</span>
<a name="ln-3974"></a><span class="k">        </span><span class="n">DifShdgRatioHorizHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">+</span><span class="n">Eps</span><span class="p">)</span>
<a name="ln-3975"></a>      <span class="n">ENDIF</span>
<a name="ln-3976"></a>    <span class="k">END DO</span>
<a name="ln-3977"></a>
<a name="ln-3978"></a>  <span class="c">!  ! Get IR view factors. An exterior surface can receive IR radiation from</span>
<a name="ln-3979"></a>  <span class="c">!  ! sky, ground or shadowing surfaces. Assume shadowing surfaces have same</span>
<a name="ln-3980"></a>  <span class="c">!  ! temperature as outside air (and therefore same temperature as ground),</span>
<a name="ln-3981"></a>  <span class="c">!  ! so that the view factor to these shadowing surfaces can be included in</span>
<a name="ln-3982"></a>  <span class="c">!  ! the ground view factor. Sky IR is assumed to be isotropic and shadowing</span>
<a name="ln-3983"></a>  <span class="c">!  ! surfaces are assumed to be opaque to IR so they totally &quot;shade&quot; IR from</span>
<a name="ln-3984"></a>  <span class="c">!  ! sky or ground.</span>
<a name="ln-3985"></a>
<a name="ln-3986"></a>  <span class="c">!  DO SurfNum = 1,TotSurfaces</span>
<a name="ln-3987"></a>  <span class="c">!    Surface(SurfNum)%ViewFactorSkyIR = Surface(SurfNum)%ViewFactorSkyIR * DifShdgRatioIsoSky(SurfNum,IHOUR,TS)</span>
<a name="ln-3988"></a>  <span class="c">!    Surface(SurfNum)%ViewFactorGroundIR = 1.0 - Surface(SurfNum)%ViewFactorSkyIR</span>
<a name="ln-3989"></a>  <span class="c">!  END DO</span>
<a name="ln-3990"></a>
<a name="ln-3991"></a>  <span class="n">ENDIF</span>  <span class="c">! test for shading surfaces</span>
<a name="ln-3992"></a>
<a name="ln-3993"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-3994"></a>  <span class="c">! For exterior windows with frame/divider that are partially or fully sunlit,</span>
<a name="ln-3995"></a>  <span class="c">! correct SunLitFrac due to shadowing of frame and divider projections onto window glass.</span>
<a name="ln-3996"></a>  <span class="c">! Note: if SunLitFrac = 0.0 the window is either completely shaded or the sun is in back</span>
<a name="ln-3997"></a>  <span class="c">! of the window; in either case, frame/divider shadowing doesn&#39;t have to be done.</span>
<a name="ln-3998"></a>
<a name="ln-3999"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4000"></a>       <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4001"></a>       <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">iHour</span><span class="p">,</span><span class="n">iTimeStep</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4002"></a>          <span class="k">CALL </span><span class="n">CalcFrameDividerShadow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span><span class="p">,</span><span class="n">iHour</span><span class="p">)</span>
<a name="ln-4003"></a>  <span class="k">END DO</span>
<a name="ln-4004"></a><span class="k">  RETURN</span>
<a name="ln-4005"></a>
<a name="ln-4006"></a><span class="k">END SUBROUTINE </span><span class="n">FigureSolarBeamAtTimestep</span>
<a name="ln-4007"></a>
<a name="ln-4008"></a><span class="k">SUBROUTINE </span><span class="n">DetermineShadowingCombinations</span>
<a name="ln-4009"></a>
<a name="ln-4010"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4011"></a>          <span class="c">!       AUTHOR         From Legacy Code</span>
<a name="ln-4012"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-4013"></a>          <span class="c">!       MODIFIED       LKL; March 2002 -- another missing translation from BLAST&#39;s routine</span>
<a name="ln-4014"></a>          <span class="c">!                      FCW; Jan 2003 -- removed line that prevented beam solar through interior windows</span>
<a name="ln-4015"></a>          <span class="c">!       RE-ENGINEERED  Rick Strand; 1998</span>
<a name="ln-4016"></a>          <span class="c">!                      Linda Lawrie; Oct 2000</span>
<a name="ln-4017"></a>
<a name="ln-4018"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4019"></a>          <span class="c">! This routine prepares a list of heat transfer surfaces and</span>
<a name="ln-4020"></a>          <span class="c">! their possible shadowers which is used to direct the hourly</span>
<a name="ln-4021"></a>          <span class="c">! calculation of shadows and sunlit areas.</span>
<a name="ln-4022"></a>
<a name="ln-4023"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4024"></a>          <span class="c">! As appropriate surfaces are identified, they are placed into the</span>
<a name="ln-4025"></a>          <span class="c">! ShadowComb data structure (module level) with the accompanying lists</span>
<a name="ln-4026"></a>          <span class="c">! of other surface numbers.</span>
<a name="ln-4027"></a>
<a name="ln-4028"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4029"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-4030"></a>
<a name="ln-4031"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4032"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ShadowRelate</span><span class="p">,</span><span class="n">numShadowRelate</span><span class="p">,</span><span class="n">recKindSurface</span><span class="p">,</span><span class="n">recKindSubsurface</span>
<a name="ln-4033"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span>
<a name="ln-4034"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-4035"></a>
<a name="ln-4036"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4037"></a>
<a name="ln-4038"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4039"></a>          <span class="c">! na</span>
<a name="ln-4040"></a>
<a name="ln-4041"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4042"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">fmta</span><span class="o">=</span><span class="s1">&#39;(A)&#39;</span>
<a name="ln-4043"></a>
<a name="ln-4044"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4045"></a>          <span class="c">! na</span>
<a name="ln-4046"></a>
<a name="ln-4047"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4048"></a>          <span class="c">! na</span>
<a name="ln-4049"></a>
<a name="ln-4050"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4051"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">GSS</span> <span class="c">! List of shadowing surfaces numbers for a receiving surface</span>
<a name="ln-4052"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">BKS</span> <span class="c">! List of back surface numbers for a receiving surface</span>
<a name="ln-4053"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SBS</span> <span class="c">! List of subsurfaces for a receiving surface</span>
<a name="ln-4054"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ListTemp</span> <span class="c">! Temporary array for reallocations</span>
<a name="ln-4055"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxGSS</span><span class="o">=</span><span class="mi">50</span> <span class="c">! Current Max for GSS array</span>
<a name="ln-4056"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxBKS</span><span class="o">=</span><span class="mi">50</span> <span class="c">! Current Max for BKS array</span>
<a name="ln-4057"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxSBS</span><span class="o">=</span><span class="mi">50</span> <span class="c">! Current Max for SBS array</span>
<a name="ln-4058"></a>  <span class="kt">LOGICAL </span><span class="n">CannotShade</span>  <span class="c">! TRUE if subsurface cannot shade receiving surface</span>
<a name="ln-4059"></a>  <span class="kt">LOGICAL </span><span class="n">HasWindow</span>   <span class="c">! TRUE if a window is present on receiving surface</span>
<a name="ln-4060"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ZMIN</span> <span class="c">! Lowest point on the receiving surface</span>
<a name="ln-4061"></a>  <span class="kt">INTEGER </span><span class="n">BackSurfaceNumber</span> <span class="c">! Back surface number</span>
<a name="ln-4062"></a>  <span class="kt">INTEGER </span><span class="n">HTS</span>      <span class="c">! Heat transfer surface number for a receiving surface</span>
<a name="ln-4063"></a>  <span class="kt">INTEGER </span><span class="n">GRSNR</span>    <span class="c">! Receiving surface number</span>
<a name="ln-4064"></a>  <span class="kt">INTEGER </span><span class="n">GSSNR</span>    <span class="c">! Shadowing surface number</span>
<a name="ln-4065"></a>  <span class="kt">INTEGER </span><span class="n">SBSNR</span>    <span class="c">! Subsurface number</span>
<a name="ln-4066"></a>  <span class="kt">INTEGER </span><span class="n">NBKS</span>     <span class="c">! Number of back surfaces for a receiving surface</span>
<a name="ln-4067"></a>  <span class="kt">INTEGER </span><span class="n">NGSS</span>     <span class="c">! Number of shadowing surfaces for a receiving surface</span>
<a name="ln-4068"></a>  <span class="kt">INTEGER </span><span class="n">NSBS</span>     <span class="c">! Number of subsurfaces for a receiving surface</span>
<a name="ln-4069"></a>  <span class="kt">LOGICAL </span><span class="n">ShadowingSurf</span>  <span class="c">! True if a receiving surface is a shadowing surface</span>
<a name="ln-4070"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CastingSurface</span> <span class="c">! tracking during setup of ShadowComb</span>
<a name="ln-4071"></a>
<a name="ln-4072"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxDim</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4073"></a>
<a name="ln-4074"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-4075"></a>  <span class="n">NumDetShadowCombs_Calls</span><span class="o">=</span><span class="n">NumDetShadowCombs_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4076"></a><span class="cp">#endif</span>
<a name="ln-4077"></a>
<a name="ln-4078"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-4079"></a>  <span class="n">ShadowComb</span><span class="p">%</span><span class="n">UseThisSurf</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4080"></a>  <span class="n">ShadowComb</span><span class="p">%</span><span class="n">NumGenSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4081"></a>  <span class="n">ShadowComb</span><span class="p">%</span><span class="n">NumSubSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4082"></a>  <span class="n">ShadowComb</span><span class="p">%</span><span class="n">NumBackSurf</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4083"></a>
<a name="ln-4084"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CastingSurface</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-4085"></a>  <span class="n">CastingSurface</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4086"></a>
<a name="ln-4087"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCA</span><span class="p">(</span><span class="n">MaxHCV</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4088"></a>  <span class="n">HCA</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4089"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCB</span><span class="p">(</span><span class="n">MaxHCV</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4090"></a>  <span class="n">HCB</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4091"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCC</span><span class="p">(</span><span class="n">MaxHCV</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4092"></a>  <span class="n">HCC</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4093"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCX</span><span class="p">(</span><span class="n">MaxHCV</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4094"></a>  <span class="n">HCX</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4095"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCY</span><span class="p">(</span><span class="n">MaxHCV</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4096"></a>  <span class="n">HCY</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4097"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4098"></a>  <span class="n">HCAREA</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-4099"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCNS</span><span class="p">(</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4100"></a>  <span class="n">HCNS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4101"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCNV</span><span class="p">(</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4102"></a>  <span class="n">HCNV</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4103"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">HCT</span><span class="p">(</span><span class="n">MaxHCS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4104"></a>  <span class="n">HCT</span><span class="o">=</span><span class="mf">0.0D0</span>
<a name="ln-4105"></a>
<a name="ln-4106"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">(</span><span class="n">MaxGSS</span><span class="p">))</span>
<a name="ln-4107"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">BKS</span><span class="p">(</span><span class="n">MaxGSS</span><span class="p">))</span>
<a name="ln-4108"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SBS</span><span class="p">(</span><span class="n">MaxGSS</span><span class="p">))</span>
<a name="ln-4109"></a>  <span class="n">GSS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4110"></a>  <span class="n">BKS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4111"></a>  <span class="n">SBS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4112"></a>
<a name="ln-4113"></a>  <span class="n">HTS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4114"></a>
<a name="ln-4115"></a>  <span class="c">! Check every surface as a possible shadow receiving surface (&quot;RS&quot; = receiving surface).</span>
<a name="ln-4116"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IgnoreSolarRadiation</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4117"></a><span class="k">    RETURN</span>
<a name="ln-4118"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-4119"></a>
<a name="ln-4120"></a>  <span class="k">DO </span><span class="n">GRSNR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span> <span class="c">! Loop through all surfaces (looking for potential receiving surfaces)...</span>
<a name="ln-4121"></a>
<a name="ln-4122"></a>    <span class="n">ShadowingSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">ShadowingSurf</span>
<a name="ln-4123"></a>    <span class="n">NGSS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4124"></a>    <span class="n">NSBS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4125"></a>    <span class="n">NBKS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4126"></a>
<a name="ln-4127"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4128"></a><span class="k">    </span><span class="n">HTS</span> <span class="o">=</span> <span class="n">GRSNR</span>
<a name="ln-4129"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">CYCLE</span>      <span class="c">! Skip surfaces with no external solar</span>
<a name="ln-4130"></a>
<a name="ln-4131"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Skip subsurfaces (SBS)</span>
<a name="ln-4132"></a>
<a name="ln-4133"></a>          <span class="c">! Get the lowest point of receiving surface</span>
<a name="ln-4134"></a>    <span class="n">ZMIN</span><span class="o">=</span><span class="nb">MINVAL</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Vertex</span><span class="p">(:)%</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-4135"></a>
<a name="ln-4136"></a>          <span class="c">! Check every surface as a possible shadow casting surface (&quot;SS&quot; = shadow sending)</span>
<a name="ln-4137"></a>    <span class="n">NGSS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4138"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Except when doing simplified exterior shadowing.</span>
<a name="ln-4139"></a>
<a name="ln-4140"></a>      <span class="k">DO </span><span class="n">GSSNR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span> <span class="c">! Loop through all surfaces, looking for ones that could shade GRSNR</span>
<a name="ln-4141"></a>
<a name="ln-4142"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GSSNR</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Receiving surface cannot shade itself</span>
<a name="ln-4143"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4144"></a>            <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">))</span> <span class="k">CYCLE</span> <span class="c">! A heat transfer subsurface of a receiving surface</span>
<a name="ln-4145"></a>                                                      <span class="c">! cannot shade the receiving surface</span>
<a name="ln-4146"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4147"></a>          <span class="c">! If receiving surf is a shadowing surface exclude matching shadow surface as sending surface</span>
<a name="ln-4148"></a>          <span class="c">!IF((GSSNR == GRSNR+1 .AND. Surface(GSSNR)%Name(1:3) == &#39;Mir&#39;).OR. &amp;</span>
<a name="ln-4149"></a>          <span class="c">!   (GSSNR == GRSNR-1 .AND. Surface(GRSNR)%Name(1:3) == &#39;Mir&#39;)) CYCLE</span>
<a name="ln-4150"></a>          <span class="k">IF</span><span class="p">(((</span><span class="n">GSSNR</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4151"></a>             <span class="p">((</span><span class="n">GSSNR</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">MirroredSurf</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-4152"></a><span class="k">        END IF</span>
<a name="ln-4153"></a>
<a name="ln-4154"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Shadowing subsurface of receiving surface</span>
<a name="ln-4155"></a>
<a name="ln-4156"></a>          <span class="n">NGSS</span><span class="o">=</span><span class="n">NGSS</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4157"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NGSS</span> <span class="o">&gt;</span> <span class="n">MaxGSS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4158"></a><span class="k">            ALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">(</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4159"></a>            <span class="n">ListTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4160"></a>            <span class="n">ListTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxGSS</span><span class="p">)</span><span class="o">=</span><span class="n">GSS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxGSS</span><span class="p">)</span>
<a name="ln-4161"></a>            <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">)</span>
<a name="ln-4162"></a>            <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">(</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4163"></a>            <span class="n">GSS</span><span class="o">=</span><span class="n">ListTemp</span>
<a name="ln-4164"></a>            <span class="n">MaxGSS</span><span class="o">=</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-4165"></a>            <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">)</span>
<a name="ln-4166"></a>          <span class="n">ENDIF</span>
<a name="ln-4167"></a>          <span class="n">GSS</span><span class="p">(</span><span class="n">NGSS</span><span class="p">)</span><span class="o">=</span><span class="n">GSSNR</span>
<a name="ln-4168"></a>
<a name="ln-4169"></a>        <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>       <span class="c">! Detached shadowing surface or</span>
<a name="ln-4170"></a>                <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">GSSNR</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span> <span class="c">! any other base surface exposed to outside environment</span>
<a name="ln-4171"></a>                <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4172"></a>                 <span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span> <span class="p">)</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4173"></a>
<a name="ln-4174"></a><span class="k">          CALL </span><span class="n">CHKGSS</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">GSSNR</span><span class="p">,</span><span class="n">ZMIN</span><span class="p">,</span><span class="n">CannotShade</span><span class="p">)</span>  <span class="c">! Check to see if this can shade the receiving surface</span>
<a name="ln-4175"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CannotShade</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Update the shadowing surface data if shading is possible</span>
<a name="ln-4176"></a>            <span class="n">NGSS</span><span class="o">=</span><span class="n">NGSS</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4177"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">NGSS</span> <span class="o">&gt;</span> <span class="n">MaxGSS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4178"></a><span class="k">              ALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">(</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4179"></a>              <span class="n">ListTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4180"></a>              <span class="n">ListTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxGSS</span><span class="p">)</span><span class="o">=</span><span class="n">GSS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxGSS</span><span class="p">)</span>
<a name="ln-4181"></a>              <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">)</span>
<a name="ln-4182"></a>              <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">(</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4183"></a>              <span class="n">GSS</span><span class="o">=</span><span class="n">ListTemp</span>
<a name="ln-4184"></a>              <span class="n">MaxGSS</span><span class="o">=</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-4185"></a>              <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">)</span>
<a name="ln-4186"></a>            <span class="n">ENDIF</span>
<a name="ln-4187"></a>            <span class="n">GSS</span><span class="p">(</span><span class="n">NGSS</span><span class="p">)</span><span class="o">=</span><span class="n">GSSNR</span>
<a name="ln-4188"></a>          <span class="k">END IF</span>
<a name="ln-4189"></a>
<a name="ln-4190"></a><span class="k">        END IF</span>
<a name="ln-4191"></a>
<a name="ln-4192"></a><span class="k">      END DO</span>    <span class="c">! ...end of surfaces DO loop (GSSNR)</span>
<a name="ln-4193"></a>    <span class="k">ELSE</span>  <span class="c">! Simplified Distribution -- still check for Shading Subsurfaces</span>
<a name="ln-4194"></a>
<a name="ln-4195"></a>      <span class="k">DO </span><span class="n">GSSNR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span> <span class="c">! Loop through all surfaces (looking for surfaces which could shade GRSNR) ...</span>
<a name="ln-4196"></a>
<a name="ln-4197"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GSSNR</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Receiving surface cannot shade itself</span>
<a name="ln-4198"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4199"></a>            <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">))</span> <span class="k">CYCLE</span> <span class="c">! Skip heat transfer subsurfaces of receiving surface</span>
<a name="ln-4200"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Shadowing subsurface of receiving surface</span>
<a name="ln-4201"></a>          <span class="n">NGSS</span><span class="o">=</span><span class="n">NGSS</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4202"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NGSS</span> <span class="o">&gt;</span> <span class="n">MaxGSS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4203"></a><span class="k">            ALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">(</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4204"></a>            <span class="n">ListTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4205"></a>            <span class="n">ListTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxGSS</span><span class="p">)</span><span class="o">=</span><span class="n">GSS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxGSS</span><span class="p">)</span>
<a name="ln-4206"></a>            <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">)</span>
<a name="ln-4207"></a>            <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">(</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4208"></a>            <span class="n">GSS</span><span class="o">=</span><span class="n">ListTemp</span>
<a name="ln-4209"></a>            <span class="n">MaxGSS</span><span class="o">=</span><span class="n">MaxGSS</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-4210"></a>            <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">)</span>
<a name="ln-4211"></a>          <span class="n">ENDIF</span>
<a name="ln-4212"></a>          <span class="n">GSS</span><span class="p">(</span><span class="n">NGSS</span><span class="p">)</span><span class="o">=</span><span class="n">GSSNR</span>
<a name="ln-4213"></a>        <span class="n">ENDIF</span>
<a name="ln-4214"></a>      <span class="n">ENDDO</span>
<a name="ln-4215"></a>
<a name="ln-4216"></a>    <span class="k">END IF</span>  <span class="c">! ...end of check for simplified solar distribution</span>
<a name="ln-4217"></a>
<a name="ln-4218"></a>          <span class="c">! Check every surface as a receiving subsurface of the receiving surface</span>
<a name="ln-4219"></a>    <span class="n">NSBS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4220"></a>    <span class="n">HasWindow</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4221"></a>    <span class="c">!legacy: IF (OSENV(HTS) &gt; 10) WINDOW=.TRUE. --&gt;Note: WINDOW was set true for roof ponds, solar walls, or other zones</span>
<a name="ln-4222"></a>    <span class="k">DO </span><span class="n">SBSNR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>   <span class="c">! Loop through the surfaces yet again (looking for subsurfaces of GRSNR)...</span>
<a name="ln-4223"></a>
<a name="ln-4224"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Skip non heat transfer subsurfaces</span>
<a name="ln-4225"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SBSNR</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>                     <span class="c">! Surface itself cannot be its own subsurface</span>
<a name="ln-4226"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Ignore subsurfaces of other surfaces and other surfaces</span>
<a name="ln-4227"></a>
<a name="ln-4228"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">HasWindow</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Check for window</span>
<a name="ln-4229"></a>      <span class="k">CALL </span><span class="n">CHKSBS</span><span class="p">(</span><span class="n">HTS</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">SBSNR</span><span class="p">)</span>   <span class="c">! Check that the receiving surface completely encloses the subsurface;</span>
<a name="ln-4230"></a>                                     <span class="c">! severe error if not</span>
<a name="ln-4231"></a>      <span class="n">NSBS</span><span class="o">=</span><span class="n">NSBS</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4232"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NSBS</span> <span class="o">&gt;</span> <span class="n">MaxSBS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4233"></a><span class="k">        ALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">(</span><span class="n">MaxSBS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4234"></a>        <span class="n">ListTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4235"></a>        <span class="n">ListTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSBS</span><span class="p">)</span><span class="o">=</span><span class="n">SBS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSBS</span><span class="p">)</span>
<a name="ln-4236"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SBS</span><span class="p">)</span>
<a name="ln-4237"></a>        <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SBS</span><span class="p">(</span><span class="n">MaxSBS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4238"></a>        <span class="n">SBS</span><span class="o">=</span><span class="n">ListTemp</span>
<a name="ln-4239"></a>        <span class="n">MaxSBS</span><span class="o">=</span><span class="n">MaxSBS</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-4240"></a>        <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">)</span>
<a name="ln-4241"></a>      <span class="n">ENDIF</span>
<a name="ln-4242"></a>      <span class="n">SBS</span><span class="p">(</span><span class="n">NSBS</span><span class="p">)</span><span class="o">=</span><span class="n">SBSNR</span>
<a name="ln-4243"></a>
<a name="ln-4244"></a>    <span class="k">END DO</span>  <span class="c">! ...end of surfaces DO loop (SBSNR)</span>
<a name="ln-4245"></a>
<a name="ln-4246"></a>          <span class="c">! Check every surface as a back surface</span>
<a name="ln-4247"></a>    <span class="n">NBKS</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4248"></a><span class="c">!                                        Except for simplified</span>
<a name="ln-4249"></a><span class="c">!                                        interior solar distribution,</span>
<a name="ln-4250"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">FullInteriorExterior</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span> <span class="c">! For full interior solar distribution</span>
<a name="ln-4251"></a>                                           <span class="p">(</span><span class="n">HasWindow</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! and a window present on base surface (GRSNR)</span>
<a name="ln-4252"></a>
<a name="ln-4253"></a>      <span class="k">DO </span><span class="n">BackSurfaceNumber</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span> <span class="c">! Loop through surfaces yet again, looking for back surfaces to GRSNR</span>
<a name="ln-4254"></a>
<a name="ln-4255"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Skip non-heat transfer surfaces</span>
<a name="ln-4256"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Skip subsurfaces of this GRSNR</span>
<a name="ln-4257"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">BackSurfaceNumber</span> <span class="o">==</span> <span class="n">GRSNR</span><span class="p">)</span> <span class="k">CYCLE</span>                     <span class="c">! A back surface cannot be GRSNR itself</span>
<a name="ln-4258"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">/=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Zone</span><span class="p">)</span> <span class="k">CYCLE</span>   <span class="c">! Skip if back surface not in zone</span>
<a name="ln-4259"></a>
<a name="ln-4260"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_IntMass</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4261"></a>
<a name="ln-4262"></a>        <span class="c">! Following line removed 1/27/03 by FCW. Was in original code that didn&#39;t do beam solar transmitted through</span>
<a name="ln-4263"></a>        <span class="c">! interior windows. Was removed to allow such beam solar but then somehow was put back in.</span>
<a name="ln-4264"></a>        <span class="c">!IF (Surface(BackSurfaceNumber)%BaseSurf /= BackSurfaceNumber) CYCLE ! Not for subsurfaces of Back Surface</span>
<a name="ln-4265"></a>
<a name="ln-4266"></a>        <span class="k">CALL </span><span class="n">CHKBKS</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">)</span>    <span class="c">! CHECK FOR CONVEX ZONE; severe error if not</span>
<a name="ln-4267"></a>        <span class="n">NBKS</span><span class="o">=</span><span class="n">NBKS</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4268"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NBKS</span> <span class="o">&gt;</span> <span class="n">MaxBKS</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4269"></a><span class="k">          ALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">(</span><span class="n">MaxBKS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4270"></a>          <span class="n">ListTemp</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4271"></a>          <span class="n">ListTemp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxBKS</span><span class="p">)</span><span class="o">=</span><span class="n">BKS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxBKS</span><span class="p">)</span>
<a name="ln-4272"></a>          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">BKS</span><span class="p">)</span>
<a name="ln-4273"></a>          <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">BKS</span><span class="p">(</span><span class="n">MaxBKS</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-4274"></a>          <span class="n">BKS</span><span class="o">=</span><span class="n">ListTemp</span>
<a name="ln-4275"></a>          <span class="n">MaxBKS</span><span class="o">=</span><span class="n">MaxBKS</span><span class="o">*</span><span class="mi">2</span>
<a name="ln-4276"></a>          <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ListTemp</span><span class="p">)</span>
<a name="ln-4277"></a>        <span class="n">ENDIF</span>
<a name="ln-4278"></a>        <span class="n">BKS</span><span class="p">(</span><span class="n">NBKS</span><span class="p">)</span><span class="o">=</span><span class="n">BackSurfaceNumber</span>
<a name="ln-4279"></a>
<a name="ln-4280"></a>      <span class="k">END DO</span>    <span class="c">! ...end of surfaces DO loop (BackSurfaceNumber)</span>
<a name="ln-4281"></a>
<a name="ln-4282"></a>    <span class="k">END IF</span>
<a name="ln-4283"></a>
<a name="ln-4284"></a>    <span class="c">! Put this into the ShadowComb data structure</span>
<a name="ln-4285"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">UseThisSurf</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4286"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumGenSurf</span><span class="o">=</span><span class="n">NGSS</span>
<a name="ln-4287"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumBackSurf</span><span class="o">=</span><span class="n">NBKS</span>
<a name="ln-4288"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumSubSurf</span><span class="o">=</span><span class="n">NSBS</span>
<a name="ln-4289"></a>    <span class="n">MaxDim</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxDim</span><span class="p">,</span><span class="n">NGSS</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">NSBS</span><span class="p">)</span>
<a name="ln-4290"></a>
<a name="ln-4291"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">GenSurf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumGenSurf</span><span class="p">))</span>
<a name="ln-4292"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">GenSurf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4293"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumGenSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4294"></a><span class="k">      </span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">GenSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumGenSurf</span><span class="p">)</span><span class="o">=</span><span class="n">GSS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NGSS</span><span class="p">)</span>
<a name="ln-4295"></a>    <span class="n">ENDIF</span>
<a name="ln-4296"></a>
<a name="ln-4297"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumBackSurf</span><span class="p">))</span>
<a name="ln-4298"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4299"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumBackSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4300"></a><span class="k">      </span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumBackSurf</span><span class="p">)</span><span class="o">=</span><span class="n">BKS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NBKS</span><span class="p">)</span>
<a name="ln-4301"></a>    <span class="n">ENDIF</span>
<a name="ln-4302"></a>
<a name="ln-4303"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">SubSurf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumSubSurf</span><span class="p">))</span>
<a name="ln-4304"></a>    <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">SubSurf</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-4305"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumSubSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4306"></a><span class="k">      </span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">SubSurf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumSubSurf</span><span class="p">)</span><span class="o">=</span><span class="n">SBS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NSBS</span><span class="p">)</span>
<a name="ln-4307"></a>    <span class="n">ENDIF</span>
<a name="ln-4308"></a>
<a name="ln-4309"></a>  <span class="k">END DO</span> <span class="c">! ...end of surfaces (GRSNR) DO loop</span>
<a name="ln-4310"></a>
<a name="ln-4311"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">GSS</span><span class="p">)</span>
<a name="ln-4312"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SBS</span><span class="p">)</span>
<a name="ln-4313"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">BKS</span><span class="p">)</span>
<a name="ln-4314"></a>
<a name="ln-4315"></a>  <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; Shadowing Combinations&#39;</span>
<a name="ln-4316"></a>  <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">SolarDistribution</span><span class="p">)</span>
<a name="ln-4317"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">MinimalShadowing</span><span class="p">)</span>
<a name="ln-4318"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; ..Solar Distribution=Minimal Shadowing, Detached Shading will not be used&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4319"></a>                                      <span class="s1">&#39; in shadowing calculations&#39;</span>
<a name="ln-4320"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">FullExterior</span><span class="p">)</span>
<a name="ln-4321"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4322"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;..Solar Distribution=FullExteriorWithReflectionsFromExteriorSurfaces&#39;</span>
<a name="ln-4323"></a>      <span class="k">ELSE</span>
<a name="ln-4324"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;..Solar Distribution=FullExterior&#39;</span>
<a name="ln-4325"></a>      <span class="n">ENDIF</span>
<a name="ln-4326"></a>    <span class="k">CASE</span> <span class="p">(</span><span class="n">FullInteriorExterior</span><span class="p">)</span>
<a name="ln-4327"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4328"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;..Solar Distribution=FullInteriorAndExteriorWithReflectionsFromExteriorSurfaces&#39;</span>
<a name="ln-4329"></a>      <span class="k">ELSE</span>
<a name="ln-4330"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;..Solar Distribution=FullInteriorAndExterior&#39;</span>
<a name="ln-4331"></a>      <span class="n">ENDIF</span>
<a name="ln-4332"></a>    <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4333"></a>   <span class="k">END SELECT</span>
<a name="ln-4334"></a>
<a name="ln-4335"></a><span class="k">   WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;..In the following, only the first 10 reference surfaces will be shown.&#39;</span>
<a name="ln-4336"></a>   <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39;..But all surfaces are used in the calculations.&#39;</span>
<a name="ln-4337"></a>
<a name="ln-4338"></a>   <span class="k">DO </span><span class="n">HTS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-4339"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; ==================================&#39;</span>
<a name="ln-4340"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">UseThisSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4341"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">IsConvex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4342"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4343"></a>             <span class="s1">&#39; is used as Receiving Surface in calculations and is convex.&#39;</span>
<a name="ln-4344"></a>      <span class="k">ELSE</span>
<a name="ln-4345"></a><span class="k">        WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4346"></a>             <span class="s1">&#39; is used as Receiving Surface in calculations and is non-convex.&#39;</span>
<a name="ln-4347"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumGenSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4348"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4349"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;DetermineShadowingCombinations: Surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4350"></a>               <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; is a receiving surface and is non-convex.&#39;</span><span class="p">)</span>
<a name="ln-4351"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Shadowing values may be inaccurate. Check .shd report file for more surface shading details&#39;</span><span class="p">)</span>
<a name="ln-4352"></a>          <span class="k">ELSE</span>
<a name="ln-4353"></a><span class="k">            </span><span class="n">TotalReceivingNonConvexSurfaces</span><span class="o">=</span><span class="n">TotalReceivingNonConvexSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4354"></a>          <span class="n">ENDIF</span>
<a name="ln-4355"></a>        <span class="n">ENDIF</span>
<a name="ln-4356"></a>      <span class="n">ENDIF</span>
<a name="ln-4357"></a>    <span class="k">ELSE</span>
<a name="ln-4358"></a><span class="k">      WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4359"></a>           <span class="s1">&#39; is not used as Receiving Surface in calculations.&#39;</span>
<a name="ln-4360"></a>    <span class="n">ENDIF</span>
<a name="ln-4361"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Number of general casting surfaces=&#39;</span><span class="p">,</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumGenSurf</span>
<a name="ln-4362"></a>    <span class="k">DO </span><span class="n">NGSS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumGenSurf</span>
<a name="ln-4363"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NGSS</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4364"></a>        <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; ..Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">GenSurf</span><span class="p">(</span><span class="n">NGSS</span><span class="p">))%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4365"></a>      <span class="n">CastingSurface</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">GenSurf</span><span class="p">(</span><span class="n">NGSS</span><span class="p">))</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4366"></a>    <span class="n">ENDDO</span>
<a name="ln-4367"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Number of back surfaces=&#39;</span><span class="p">,</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumBackSurf</span>
<a name="ln-4368"></a>    <span class="k">DO </span><span class="n">NGSS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumBackSurf</span><span class="p">)</span>
<a name="ln-4369"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; ...Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">NGSS</span><span class="p">))%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4370"></a>    <span class="n">ENDDO</span>
<a name="ln-4371"></a>    <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Number of receiving sub surfaces=&#39;</span><span class="p">,</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumSubSurf</span>
<a name="ln-4372"></a>    <span class="k">DO </span><span class="n">NGSS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">NumSubSurf</span><span class="p">)</span>
<a name="ln-4373"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">OutputFileShading</span><span class="p">,</span><span class="n">fmta</span><span class="p">)</span> <span class="s1">&#39; ....Surface=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">SubSurf</span><span class="p">(</span><span class="n">NGSS</span><span class="p">))%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4374"></a>    <span class="n">ENDDO</span>
<a name="ln-4375"></a>  <span class="n">ENDDO</span>
<a name="ln-4376"></a>
<a name="ln-4377"></a>  <span class="k">DO </span><span class="n">HTS</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-4378"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CastingSurface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">IsConvex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4379"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">DisplayExtraWarnings</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4380"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;DetermineShadowingCombinations: Surface=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4381"></a>           <span class="nb">trim</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTS</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; is a casting surface and is non-convex.&#39;</span><span class="p">)</span>
<a name="ln-4382"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Shadowing values may be inaccurate. Check .shd report file for more surface shading details&#39;</span><span class="p">)</span>
<a name="ln-4383"></a>      <span class="k">ELSE</span>
<a name="ln-4384"></a><span class="k">        </span><span class="n">TotalCastingNonConvexSurfaces</span><span class="o">=</span><span class="n">TotalCastingNonConvexSurfaces</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4385"></a>      <span class="n">ENDIF</span>
<a name="ln-4386"></a>    <span class="n">ENDIF</span>
<a name="ln-4387"></a>  <span class="n">ENDDO</span>
<a name="ln-4388"></a>
<a name="ln-4389"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">CastingSurface</span><span class="p">)</span>
<a name="ln-4390"></a>
<a name="ln-4391"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotalReceivingNonConvexSurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4392"></a><span class="k">    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;DetermineShadowingCombinations: There are &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalReceivingNonConvexSurfaces</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4393"></a>       <span class="s1">&#39; surfaces which are receiving surfaces and are non-convex.&#39;</span><span class="p">)</span>
<a name="ln-4394"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Shadowing values may be inaccurate. Check .shd report file for more surface shading details&#39;</span><span class="p">)</span>
<a name="ln-4395"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Add Output:Diagnostics,DisplayExtraWarnings; to see individual warnings for each surface.&#39;</span><span class="p">)</span>
<a name="ln-4396"></a>    <span class="n">TotalWarningErrors</span><span class="o">=</span><span class="n">TotalWarningErrors</span><span class="o">+</span><span class="n">TotalReceivingNonConvexSurfaces</span>
<a name="ln-4397"></a>  <span class="n">ENDIF</span>
<a name="ln-4398"></a>
<a name="ln-4399"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">TotalCastingNonConvexSurfaces</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4400"></a><span class="k">    CALL </span><span class="n">ShowSevereMessage</span><span class="p">(</span><span class="s1">&#39;DetermineShadowingCombinations: There are &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalCastingNonConvexSurfaces</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4401"></a>       <span class="s1">&#39; surfaces which are casting surfaces and are non-convex.&#39;</span><span class="p">)</span>
<a name="ln-4402"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Shadowing values may be inaccurate. Check .shd report file for more surface shading details&#39;</span><span class="p">)</span>
<a name="ln-4403"></a>    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Add Output:Diagnostics,DisplayExtraWarnings; to see individual severes for each surface.&#39;</span><span class="p">)</span>
<a name="ln-4404"></a>    <span class="n">TotalSevereErrors</span><span class="o">=</span><span class="n">TotalSevereErrors</span><span class="o">+</span><span class="n">TotalCastingNonConvexSurfaces</span>
<a name="ln-4405"></a>  <span class="n">ENDIF</span>
<a name="ln-4406"></a>
<a name="ln-4407"></a>  <span class="k">RETURN</span>
<a name="ln-4408"></a>
<a name="ln-4409"></a><span class="k">END SUBROUTINE </span><span class="n">DetermineShadowingCombinations</span>
<a name="ln-4410"></a>
<a name="ln-4411"></a><span class="k">SUBROUTINE </span><span class="n">SHADOW</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4412"></a>
<a name="ln-4413"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4414"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-4415"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-4416"></a>          <span class="c">!       MODIFIED       Nov 2003, FCW: modify to do shadowing on shadowing surfaces</span>
<a name="ln-4417"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-4418"></a>
<a name="ln-4419"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4420"></a>          <span class="c">! This subroutine is a driving routine for calculations of shadows</span>
<a name="ln-4421"></a>          <span class="c">! and sunlit areas used in computing the solar beam flux multipliers.</span>
<a name="ln-4422"></a>
<a name="ln-4423"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4424"></a>          <span class="c">! na</span>
<a name="ln-4425"></a>
<a name="ln-4426"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4427"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-4428"></a>
<a name="ln-4429"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4430"></a>          <span class="c">! na</span>
<a name="ln-4431"></a>
<a name="ln-4432"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4433"></a>
<a name="ln-4434"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4435"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHOUR</span>  <span class="c">! Hour index</span>
<a name="ln-4436"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TS</span>     <span class="c">! Time Step</span>
<a name="ln-4437"></a>
<a name="ln-4438"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4439"></a>          <span class="c">! na</span>
<a name="ln-4440"></a>
<a name="ln-4441"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-4442"></a>          <span class="c">! na</span>
<a name="ln-4443"></a>
<a name="ln-4444"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-4445"></a>          <span class="c">! na</span>
<a name="ln-4446"></a>
<a name="ln-4447"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4448"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">XS</span>  <span class="c">! Intermediate result</span>
<a name="ln-4449"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">YS</span>  <span class="c">! Intermediate result</span>
<a name="ln-4450"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">ZS</span>  <span class="c">! Intermediate result</span>
<a name="ln-4451"></a>  <span class="kt">INTEGER </span><span class="n">N</span>     <span class="c">! Vertex number</span>
<a name="ln-4452"></a>  <span class="kt">INTEGER </span><span class="n">NGRS</span>  <span class="c">! Coordinate transformation index</span>
<a name="ln-4453"></a>  <span class="kt">INTEGER </span><span class="n">NZ</span>    <span class="c">! Zone Number of surface</span>
<a name="ln-4454"></a>  <span class="kt">INTEGER </span><span class="n">NVT</span>
<a name="ln-4455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XVT</span>      <span class="c">! X Vertices of Shadows</span>
<a name="ln-4456"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YVT</span>      <span class="c">! Y vertices of Shadows</span>
<a name="ln-4457"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ZVT</span>      <span class="c">! Z vertices of Shadows</span>
<a name="ln-4458"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4459"></a>  <span class="kt">INTEGER </span><span class="n">HTS</span>      <span class="c">! Heat transfer surface number of the general receiving surface</span>
<a name="ln-4460"></a>  <span class="kt">INTEGER </span><span class="n">GRSNR</span>    <span class="c">! Surface number of general receiving surface</span>
<a name="ln-4461"></a>  <span class="kt">INTEGER </span><span class="n">NBKS</span>     <span class="c">! Number of back surfaces</span>
<a name="ln-4462"></a>  <span class="kt">INTEGER </span><span class="n">NGSS</span>     <span class="c">! Number of general shadowing surfaces</span>
<a name="ln-4463"></a>  <span class="kt">INTEGER </span><span class="n">NSBS</span>     <span class="c">! Number of subsurfaces (windows and doors)</span>
<a name="ln-4464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfArea</span>    <span class="c">! Surface area. For walls, includes all window frame areas.</span>
<a name="ln-4465"></a>                   <span class="c">! For windows, includes divider area</span>
<a name="ln-4466"></a>
<a name="ln-4467"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4468"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">XVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4469"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4470"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4471"></a>    <span class="n">XVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4472"></a>    <span class="n">YVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4473"></a>    <span class="n">ZVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4474"></a>    <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4475"></a>  <span class="n">ENDIF</span>
<a name="ln-4476"></a>
<a name="ln-4477"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-4478"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">IHOUR</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4479"></a><span class="k">    </span><span class="n">NumShadow_Calls</span><span class="o">=</span><span class="n">NumShadow_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4480"></a>  <span class="k">ELSE</span>
<a name="ln-4481"></a><span class="k">    </span><span class="n">NumShadowAtTS_Calls</span><span class="o">=</span><span class="n">NumShadowAtTS_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4482"></a>  <span class="n">ENDIF</span>
<a name="ln-4483"></a><span class="cp">#endif</span>
<a name="ln-4484"></a>
<a name="ln-4485"></a>  <span class="n">SAREA</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4486"></a>
<a name="ln-4487"></a>  <span class="k">DO </span><span class="n">GRSNR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-4488"></a>
<a name="ln-4489"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">UseThisSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4490"></a>
<a name="ln-4491"></a><span class="k">    </span><span class="n">SAREA</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4492"></a>
<a name="ln-4493"></a>    <span class="n">NZ</span>     <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-4494"></a>    <span class="n">NGSS</span>   <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumGenSurf</span>
<a name="ln-4495"></a>    <span class="n">NGSSHC</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4496"></a>    <span class="n">NBKS</span>   <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumBackSurf</span>
<a name="ln-4497"></a>    <span class="n">NBKSHC</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4498"></a>    <span class="n">NSBS</span>   <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NumSubSurf</span>
<a name="ln-4499"></a>    <span class="n">NRVLHC</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4500"></a>    <span class="n">NSBSHC</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4501"></a>    <span class="n">LOCHCA</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4502"></a>          <span class="c">! Temporarily determine the old heat transfer surface number (HTS)</span>
<a name="ln-4503"></a>    <span class="n">HTS</span><span class="o">=</span><span class="n">GRSNR</span>
<a name="ln-4504"></a>
<a name="ln-4505"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTHETA</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!.001) THEN ! Receiving surface is not in the sun</span>
<a name="ln-4506"></a>
<a name="ln-4507"></a>      <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4508"></a>      <span class="k">CALL </span><span class="n">SHDSBS</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">NSBS</span><span class="p">,</span><span class="n">HTS</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4509"></a>
<a name="ln-4510"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NGSS</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(</span><span class="n">NSBS</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>   <span class="c">! Simple surface--no shaders or subsurfaces</span>
<a name="ln-4511"></a>
<a name="ln-4512"></a>      <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-4513"></a>    <span class="k">ELSE</span>    <span class="c">! Surface in sun and either shading surfaces or subsurfaces present (or both)</span>
<a name="ln-4514"></a>
<a name="ln-4515"></a>      <span class="n">NGRS</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-4516"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">ShadowingSurf</span><span class="p">)</span> <span class="n">NGRS</span> <span class="o">=</span> <span class="n">GRSNR</span>
<a name="ln-4517"></a>
<a name="ln-4518"></a>          <span class="c">! Compute the X and Y displacements of a shadow.</span>
<a name="ln-4519"></a>      <span class="n">XS</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4520"></a>      <span class="n">YS</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4521"></a>      <span class="n">ZS</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">%</span><span class="n">x</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">%</span><span class="n">y</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Surface</span><span class="p">(</span><span class="n">NGRS</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">%</span><span class="n">z</span><span class="o">*</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4522"></a>
<a name="ln-4523"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ZS</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4524"></a><span class="k">        </span><span class="n">XShadowProjection</span> <span class="o">=</span> <span class="n">XS</span><span class="o">/</span><span class="n">ZS</span>
<a name="ln-4525"></a>        <span class="n">YShadowProjection</span> <span class="o">=</span> <span class="n">YS</span><span class="o">/</span><span class="n">ZS</span>
<a name="ln-4526"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">XShadowProjection</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-8</span><span class="p">)</span> <span class="n">XShadowProjection</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4527"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">YShadowProjection</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-8</span><span class="p">)</span> <span class="n">YShadowProjection</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4528"></a>      <span class="k">ELSE</span>
<a name="ln-4529"></a><span class="k">        </span><span class="n">XShadowProjection</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4530"></a>        <span class="n">YShadowProjection</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4531"></a>      <span class="k">END IF</span>
<a name="ln-4532"></a>
<a name="ln-4533"></a><span class="k">      CALL </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">NGRS</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>   <span class="c">! Transform coordinates of the receiving surface to 2-D form</span>
<a name="ln-4534"></a>
<a name="ln-4535"></a>          <span class="c">! Re-order its vertices to clockwise sequential.</span>
<a name="ln-4536"></a>      <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-4537"></a>        <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4538"></a>        <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">NVT</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4539"></a>      <span class="k">END DO</span>
<a name="ln-4540"></a>
<a name="ln-4541"></a><span class="k">      CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">NVT</span><span class="p">)</span>  <span class="c">! Transform to homogeneous coordinates.</span>
<a name="ln-4542"></a>
<a name="ln-4543"></a>      <span class="n">HCAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=-</span><span class="n">HCAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Compute (+) gross surface area.</span>
<a name="ln-4544"></a>      <span class="n">HCT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-4545"></a>
<a name="ln-4546"></a>      <span class="k">CALL </span><span class="n">SHDGSS</span><span class="p">(</span><span class="n">NGRS</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">NGSS</span><span class="p">,</span><span class="n">HTS</span><span class="p">)</span>   <span class="c">! Determine shadowing on surface.</span>
<a name="ln-4547"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CalcSkyDifShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4548"></a><span class="k">        CALL </span><span class="n">SHDBKS</span><span class="p">(</span><span class="n">NGRS</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">HTS</span><span class="p">)</span> <span class="c">! Determine possible back surfaces.</span>
<a name="ln-4549"></a>      <span class="k">END IF</span>
<a name="ln-4550"></a>
<a name="ln-4551"></a><span class="k">      CALL </span><span class="n">SHDSBS</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">NSBS</span><span class="p">,</span><span class="n">HTS</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="c">! Subtract subsurf areas from total</span>
<a name="ln-4552"></a>
<a name="ln-4553"></a>          <span class="c">! Error checking:  require that 0 &lt;= SAREA &lt;= AREA.  + or - .01*AREA added for round-off errors</span>
<a name="ln-4554"></a>      <span class="n">SurfArea</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-4555"></a>      <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">))</span>
<a name="ln-4556"></a>
<a name="ln-4557"></a>      <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">),</span><span class="n">SurfArea</span><span class="p">)</span>
<a name="ln-4558"></a>
<a name="ln-4559"></a>    <span class="k">END IF</span>  <span class="c">! ...end of surface in sun/surface with shaders and/or subsurfaces IF-THEN block</span>
<a name="ln-4560"></a>
<a name="ln-4561"></a>          <span class="c">! NOTE:</span>
<a name="ln-4562"></a>          <span class="c">! There used to be a call to legacy subroutine SHDCVR here when the</span>
<a name="ln-4563"></a>          <span class="c">! zone type was not a standard zone.</span>
<a name="ln-4564"></a>
<a name="ln-4565"></a>  <span class="k">END DO</span>
<a name="ln-4566"></a>
<a name="ln-4567"></a><span class="k">  RETURN</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a><span class="k">END SUBROUTINE </span><span class="n">SHADOW</span>
<a name="ln-4570"></a>
<a name="ln-4571"></a><span class="k">SUBROUTINE </span><span class="n">SHDBKS</span><span class="p">(</span><span class="n">NGRS</span><span class="p">,</span><span class="n">CurSurf</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">HTS</span><span class="p">)</span>
<a name="ln-4572"></a>
<a name="ln-4573"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4574"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-4575"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-4576"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4577"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-4578"></a>
<a name="ln-4579"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4580"></a>          <span class="c">! This is the driving subroutine for computing</span>
<a name="ln-4581"></a>          <span class="c">! the sunlit areas for back surfaces.</span>
<a name="ln-4582"></a>
<a name="ln-4583"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4584"></a>          <span class="c">! na</span>
<a name="ln-4585"></a>
<a name="ln-4586"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4587"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-4588"></a>
<a name="ln-4589"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4590"></a>          <span class="c">! na</span>
<a name="ln-4591"></a>
<a name="ln-4592"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4593"></a>
<a name="ln-4594"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4595"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NGRS</span>     <span class="c">! Number of the general receiving surface</span>
<a name="ln-4596"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurSurf</span>
<a name="ln-4597"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTS</span>      <span class="c">! Heat transfer surface number of the general receiving surf</span>
<a name="ln-4598"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBKS</span>     <span class="c">! Number of back surfaces</span>
<a name="ln-4599"></a>
<a name="ln-4600"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4601"></a>          <span class="c">! na</span>
<a name="ln-4602"></a>
<a name="ln-4603"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4604"></a>          <span class="c">! na</span>
<a name="ln-4605"></a>
<a name="ln-4606"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4607"></a>          <span class="c">! na</span>
<a name="ln-4608"></a>
<a name="ln-4609"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4610"></a>  <span class="kt">INTEGER </span><span class="n">I</span>
<a name="ln-4611"></a>  <span class="kt">INTEGER </span><span class="n">M</span>
<a name="ln-4612"></a>  <span class="kt">INTEGER </span><span class="n">N</span>
<a name="ln-4613"></a>  <span class="kt">INTEGER </span><span class="n">NVR</span>
<a name="ln-4614"></a>  <span class="kt">INTEGER </span><span class="n">NVT</span>  <span class="c">! Number of vertices of back surface</span>
<a name="ln-4615"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XVT</span>    <span class="c">! X,Y,Z coordinates of vertices of</span>
<a name="ln-4616"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YVT</span>    <span class="c">! back surfaces projected into system</span>
<a name="ln-4617"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ZVT</span>    <span class="c">! relative to receiving surface</span>
<a name="ln-4618"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4619"></a>  <span class="kt">INTEGER </span><span class="n">BackSurfaceNumber</span>
<a name="ln-4620"></a>  <span class="kt">INTEGER </span><span class="n">NS1</span>      <span class="c">! Number of the figure being overlapped</span>
<a name="ln-4621"></a>  <span class="kt">INTEGER </span><span class="n">NS2</span>      <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-4622"></a>  <span class="kt">INTEGER </span><span class="n">NS3</span>      <span class="c">! Location to place results of overlap</span>
<a name="ln-4623"></a>
<a name="ln-4624"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4625"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">XVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4626"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4627"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4628"></a>    <span class="n">XVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4629"></a>    <span class="n">YVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4630"></a>    <span class="n">ZVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4631"></a>    <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4632"></a>  <span class="n">ENDIF</span>
<a name="ln-4633"></a>
<a name="ln-4634"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">NBKS</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4635"></a>       <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4636"></a>       <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-4637"></a>
<a name="ln-4638"></a><span class="k">  </span><span class="n">FBKSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4639"></a>
<a name="ln-4640"></a>  <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NBKS</span> <span class="c">! Loop through all back surfaces associated with the receiving surface</span>
<a name="ln-4641"></a>
<a name="ln-4642"></a>    <span class="n">BackSurfaceNumber</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">CurSurf</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-4643"></a>
<a name="ln-4644"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CTHETA</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">!-0.001) CYCLE ! go to next back surface since inside of this surface</span>
<a name="ln-4645"></a>                                                  <span class="c">! cannot be in sun if the outside can be</span>
<a name="ln-4646"></a>
<a name="ln-4647"></a>          <span class="c">! Transform coordinates of back surface from general system to the</span>
<a name="ln-4648"></a>          <span class="c">! plane of the receiving surface</span>
<a name="ln-4649"></a>
<a name="ln-4650"></a>    <span class="k">CALL </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span><span class="n">NGRS</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-4651"></a>
<a name="ln-4652"></a>          <span class="c">! Project &quot;shadow&quot; from back surface along sun&#39;s rays to receiving surface.  Back surface vertices</span>
<a name="ln-4653"></a>          <span class="c">! become clockwise sequential.</span>
<a name="ln-4654"></a>
<a name="ln-4655"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-4656"></a>      <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">XShadowProjection</span><span class="o">*</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4657"></a>      <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">YShadowProjection</span><span class="o">*</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4658"></a>    <span class="k">END DO</span>
<a name="ln-4659"></a>
<a name="ln-4660"></a>          <span class="c">! Transform to the homogeneous coordinate system.</span>
<a name="ln-4661"></a>
<a name="ln-4662"></a>    <span class="n">NS3</span>      <span class="o">=</span> <span class="n">LOCHCA</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-4663"></a>    <span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4664"></a>    <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS3</span><span class="p">,</span><span class="n">NVT</span><span class="p">)</span>
<a name="ln-4665"></a>
<a name="ln-4666"></a>          <span class="c">! Adjust near-duplicate points.</span>
<a name="ln-4667"></a>
<a name="ln-4668"></a>    <span class="n">NVR</span> <span class="o">=</span> <span class="n">HCNV</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4669"></a>    <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-4670"></a>      <span class="k">DO </span><span class="n">M</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVR</span>
<a name="ln-4671"></a>        <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HCX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4672"></a><span class="k">        IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HCY</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4673"></a><span class="k">        </span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4674"></a>        <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4675"></a>      <span class="k">END DO</span>
<a name="ln-4676"></a><span class="k">    END DO</span>
<a name="ln-4677"></a>
<a name="ln-4678"></a><span class="k">    CALL </span><span class="n">HTRANS0</span><span class="p">(</span><span class="n">NS3</span><span class="p">,</span><span class="n">NVT</span><span class="p">)</span>
<a name="ln-4679"></a>
<a name="ln-4680"></a>          <span class="c">! Determine area of overlap of projected back surface and receiving surface.</span>
<a name="ln-4681"></a>
<a name="ln-4682"></a>    <span class="n">NS1</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4683"></a>    <span class="n">NS2</span>      <span class="o">=</span> <span class="n">NS3</span>
<a name="ln-4684"></a>    <span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4685"></a>    <span class="k">CALL </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-4686"></a>
<a name="ln-4687"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">NoOverlap</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! to next back surface</span>
<a name="ln-4688"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4689"></a>         <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="k">EXIT</span> <span class="c">! back surfaces DO loop</span>
<a name="ln-4690"></a>
<a name="ln-4691"></a>          <span class="c">! Increment back surface count.</span>
<a name="ln-4692"></a>
<a name="ln-4693"></a>    <span class="n">LOCHCA</span>         <span class="o">=</span> <span class="n">NS3</span>
<a name="ln-4694"></a>    <span class="n">HCNS</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>   <span class="o">=</span> <span class="n">BackSurfaceNumber</span>
<a name="ln-4695"></a>    <span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>
<a name="ln-4696"></a>    <span class="n">NBKSHC</span>         <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FBKSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4697"></a>
<a name="ln-4698"></a>  <span class="k">END DO</span>
<a name="ln-4699"></a>
<a name="ln-4700"></a><span class="k">  RETURN</span>
<a name="ln-4701"></a>
<a name="ln-4702"></a><span class="k">END SUBROUTINE </span><span class="n">SHDBKS</span>
<a name="ln-4703"></a>
<a name="ln-4704"></a><span class="k">SUBROUTINE </span><span class="n">SHDGSS</span><span class="p">(</span><span class="n">NGRS</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">,</span><span class="n">CurSurf</span><span class="p">,</span><span class="n">NGSS</span><span class="p">,</span><span class="n">HTS</span><span class="p">)</span>
<a name="ln-4705"></a>
<a name="ln-4706"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4707"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-4708"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-4709"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-4710"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-4711"></a>
<a name="ln-4712"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4713"></a>          <span class="c">! This subroutine determines the shadows on a general receiving surface.</span>
<a name="ln-4714"></a>
<a name="ln-4715"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4716"></a>          <span class="c">! na</span>
<a name="ln-4717"></a>
<a name="ln-4718"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4719"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-4720"></a>
<a name="ln-4721"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4722"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">LookUpScheduleValue</span><span class="p">,</span> <span class="n">GetCurrentScheduleValue</span><span class="p">,</span> <span class="n">GetScheduleMinValue</span><span class="p">,</span> <span class="n">GetScheduleName</span>
<a name="ln-4723"></a>
<a name="ln-4724"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4725"></a>
<a name="ln-4726"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4727"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NGRS</span>
<a name="ln-4728"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHOUR</span>    <span class="c">! Hour Counter</span>
<a name="ln-4729"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TS</span>       <span class="c">! TimeStep</span>
<a name="ln-4730"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurSurf</span>  <span class="c">! Current Surface</span>
<a name="ln-4731"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTS</span>      <span class="c">! Heat transfer surface number of the general receiving surf</span>
<a name="ln-4732"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NGSS</span>     <span class="c">! Number of general shadowing surfaces</span>
<a name="ln-4733"></a>
<a name="ln-4734"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4735"></a>          <span class="c">! na</span>
<a name="ln-4736"></a>
<a name="ln-4737"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4738"></a>          <span class="c">! na</span>
<a name="ln-4739"></a>
<a name="ln-4740"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4741"></a>          <span class="c">! na</span>
<a name="ln-4742"></a>
<a name="ln-4743"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4744"></a>  <span class="kt">INTEGER </span><span class="n">I</span>
<a name="ln-4745"></a>  <span class="kt">INTEGER </span><span class="n">N</span>
<a name="ln-4746"></a>  <span class="kt">INTEGER </span><span class="n">M</span>
<a name="ln-4747"></a>  <span class="kt">INTEGER </span><span class="n">NVR</span>
<a name="ln-4748"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">A</span>  <span class="c">! Area</span>
<a name="ln-4749"></a>  <span class="kt">INTEGER </span><span class="n">GSSNR</span>    <span class="c">! General shadowing surface number</span>
<a name="ln-4750"></a>  <span class="kt">INTEGER </span><span class="n">MainOverlapStatus</span> <span class="c">! Overlap status of the main overlap calculation not the check for</span>
<a name="ln-4751"></a>                            <span class="c">! multiple overlaps (unless there was an error)</span>
<a name="ln-4752"></a>  <span class="kt">INTEGER </span><span class="n">NVT</span>
<a name="ln-4753"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XVT</span>
<a name="ln-4754"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YVT</span>
<a name="ln-4755"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ZVT</span>
<a name="ln-4756"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-4757"></a>  <span class="kt">INTEGER </span><span class="n">NS1</span>      <span class="c">! Number of the figure being overlapped</span>
<a name="ln-4758"></a>  <span class="kt">INTEGER </span><span class="n">NS2</span>      <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-4759"></a>  <span class="kt">INTEGER </span><span class="n">NS3</span>      <span class="c">! Location to place results of overlap</span>
<a name="ln-4760"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SchValue</span>    <span class="c">! Value for Schedule of shading transmittence</span>
<a name="ln-4761"></a>  <span class="kt">INTEGER </span><span class="n">ExitLoopStatus</span>
<a name="ln-4762"></a>
<a name="ln-4763"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">OneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4764"></a><span class="k">    ALLOCATE</span><span class="p">(</span><span class="n">XVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4765"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4766"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-4767"></a>    <span class="n">XVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4768"></a>    <span class="n">YVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4769"></a>    <span class="n">ZVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4770"></a>    <span class="n">OneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4771"></a>  <span class="n">ENDIF</span>
<a name="ln-4772"></a>
<a name="ln-4773"></a>  <span class="n">FGSSHC</span>        <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4774"></a>  <span class="n">MainOverlapStatus</span> <span class="o">=</span> <span class="n">NoOverlap</span> <span class="c">! Set to ensure that the value from the last surface is not saved</span>
<a name="ln-4775"></a>  <span class="n">OverlapStatus</span><span class="o">=</span> <span class="n">NoOverlap</span>
<a name="ln-4776"></a>
<a name="ln-4777"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NGSS</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! IF NO S.S., receiving surface FULLY SUNLIT.</span>
<a name="ln-4778"></a>
<a name="ln-4779"></a>    <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Surface fully sunlit</span>
<a name="ln-4780"></a>
<a name="ln-4781"></a>  <span class="k">ELSE</span>
<a name="ln-4782"></a>
<a name="ln-4783"></a><span class="k">  </span><span class="n">ShadowingSurfaces</span><span class="p">:</span>  <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NGSS</span>    <span class="c">! Loop through all shadowing surfaces...</span>
<a name="ln-4784"></a>
<a name="ln-4785"></a>      <span class="n">GSSNR</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">CurSurf</span><span class="p">)%</span><span class="n">GenSurf</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-4786"></a>      <span class="n">CurrentSurfaceBeingShadowed</span><span class="o">=</span><span class="n">GSSNR</span>
<a name="ln-4787"></a>      <span class="n">CurrentShadowingSurface</span><span class="o">=</span><span class="n">I</span>
<a name="ln-4788"></a>
<a name="ln-4789"></a>      <span class="n">ExitLoopStatus</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-4790"></a>
<a name="ln-4791"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CTHETA</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">!.001) CYCLE ! NO SHADOW IF GSS IN SUNLIGHT.</span>
<a name="ln-4792"></a>
<a name="ln-4793"></a><span class="c">!     This used to check to see if the shadowing surface was not opaque (within the scheduled dates of</span>
<a name="ln-4794"></a><span class="c">!            transmittance value.  Perhaps it ignored it if it were outside the range.  (if so, was an error)</span>
<a name="ln-4795"></a><span class="c">!     The proper action seems to be delete this statement all together, but there would also be no shading if</span>
<a name="ln-4796"></a><span class="c">!            the shading surface were transparent...</span>
<a name="ln-4797"></a><span class="c">!---former stmt      IF ((.NOT.Surface(GSSNR)%HeatTransSurf) .AND. &amp;</span>
<a name="ln-4798"></a><span class="c">!---former stmt            GetCurrentScheduleValue(Surface(GSSNR)%SchedShadowSurfIndex,IHOUR) == 0.0) CYCLE</span>
<a name="ln-4799"></a>
<a name="ln-4800"></a>     <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4801"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">IsTransparent</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4802"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4803"></a><span class="k">         IF</span> <span class="p">(</span><span class="n">LookUpScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4804"></a><span class="k">       </span><span class="n">ENDIF</span>
<a name="ln-4805"></a>     <span class="n">ENDIF</span>
<a name="ln-4806"></a>
<a name="ln-4807"></a><span class="c">!      No shadow if shading surface is transparent</span>
<a name="ln-4808"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CalcSkyDifShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4809"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4810"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">IsTransparent</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4811"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4812"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">LookUpScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">==</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4813"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4814"></a>        <span class="n">ENDIF</span>
<a name="ln-4815"></a>      <span class="k">ELSE</span>
<a name="ln-4816"></a><span class="k">        IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4817"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4818"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">IsTransparent</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4819"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-4820"></a>        <span class="n">ENDIF</span>
<a name="ln-4821"></a>      <span class="n">ENDIF</span>
<a name="ln-4822"></a>
<a name="ln-4823"></a><span class="c">!      IF ((.NOT.Surface(GSSNR)%HeatTransSurf) .AND. &amp;</span>
<a name="ln-4824"></a><span class="c">!            GetCurrentScheduleValue(Surface(GSSNR)%SchedShadowSurfIndex) == 1.0) CYCLE</span>
<a name="ln-4825"></a>
<a name="ln-4826"></a>          <span class="c">! Transform shadow casting surface from cartesian to homogeneous coordinates according to surface type.</span>
<a name="ln-4827"></a>
<a name="ln-4828"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">).</span><span class="nb">AND</span><span class="p">.(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4829"></a>
<a name="ln-4830"></a>          <span class="c">! For shadowing subsurface coordinates of shadow casting surface are relative to the receiving surface</span>
<a name="ln-4831"></a>          <span class="c">! project shadow to the receiving surface</span>
<a name="ln-4832"></a>
<a name="ln-4833"></a>        <span class="n">NVS</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-4834"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVS</span>
<a name="ln-4835"></a>          <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">XShadowProjection</span><span class="o">*</span><span class="n">ShadeV</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">ZV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4836"></a>          <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">YShadowProjection</span><span class="o">*</span><span class="n">ShadeV</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">ZV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4837"></a>        <span class="k">END DO</span>
<a name="ln-4838"></a>
<a name="ln-4839"></a><span class="k">      ELSE</span>
<a name="ln-4840"></a>        <span class="c">! Transform coordinates of shadow casting surface from general system to the system relative to the receiving surface</span>
<a name="ln-4841"></a>        <span class="k">CALL </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">,</span><span class="n">NGRS</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-4842"></a>        <span class="k">CALL </span><span class="n">CLIP</span><span class="p">(</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span> <span class="c">! Clip portions of the shadow casting surface which are behind the receiving surface</span>
<a name="ln-4843"></a>
<a name="ln-4844"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NumVertInShadowOrClippedSurface</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4845"></a>
<a name="ln-4846"></a>          <span class="c">! Project shadow from shadow casting surface along sun&#39;s rays to receiving surface  Shadow vertices</span>
<a name="ln-4847"></a>          <span class="c">! become clockwise sequential</span>
<a name="ln-4848"></a>
<a name="ln-4849"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertInShadowOrClippedSurface</span>
<a name="ln-4850"></a>          <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">XShadowProjection</span><span class="o">*</span><span class="n">ZVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4851"></a>          <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">YShadowProjection</span><span class="o">*</span><span class="n">ZVC</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-4852"></a>        <span class="k">END DO</span>
<a name="ln-4853"></a>
<a name="ln-4854"></a><span class="k">      END IF</span>
<a name="ln-4855"></a>
<a name="ln-4856"></a>          <span class="c">! Transform to the homogeneous coordinate system.</span>
<a name="ln-4857"></a>
<a name="ln-4858"></a>      <span class="n">NS3</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4859"></a>      <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS3</span><span class="p">,</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-4860"></a>
<a name="ln-4861"></a>          <span class="c">! Adjust near-duplicate points.</span>
<a name="ln-4862"></a>
<a name="ln-4863"></a>      <span class="n">NVR</span> <span class="o">=</span> <span class="n">HCNV</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4864"></a>      <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumVertInShadowOrClippedSurface</span>
<a name="ln-4865"></a>        <span class="k">DO </span><span class="n">M</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVR</span>
<a name="ln-4866"></a>          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HCX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4867"></a><span class="k">          IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HCY</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4868"></a><span class="k">          </span><span class="n">HCX</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4869"></a>          <span class="n">HCY</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4870"></a>        <span class="k">END DO</span>
<a name="ln-4871"></a><span class="k">      END DO</span>
<a name="ln-4872"></a><span class="k">      CALL </span><span class="n">HTRANS0</span><span class="p">(</span><span class="n">NS3</span><span class="p">,</span><span class="n">NumVertInShadowOrClippedSurface</span><span class="p">)</span>
<a name="ln-4873"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CalcSkyDifShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4874"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">IHOUR</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4875"></a><span class="k">          </span><span class="n">SchValue</span><span class="o">=</span><span class="n">LookUpScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedShadowSurfIndex</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4876"></a>        <span class="k">ELSE</span>
<a name="ln-4877"></a><span class="k">          </span><span class="n">SchValue</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedMinValue</span>
<a name="ln-4878"></a>        <span class="n">ENDIF</span>
<a name="ln-4879"></a>      <span class="k">ELSE</span>
<a name="ln-4880"></a><span class="k">        </span><span class="n">SchValue</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">GSSNR</span><span class="p">)%</span><span class="n">SchedMinValue</span>
<a name="ln-4881"></a>      <span class="n">ENDIF</span>
<a name="ln-4882"></a>
<a name="ln-4883"></a>      <span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span><span class="o">=</span><span class="n">SchValue</span>
<a name="ln-4884"></a>
<a name="ln-4885"></a>          <span class="c">! Determine overlap of shadow with receiving surface</span>
<a name="ln-4886"></a>
<a name="ln-4887"></a>      <span class="n">NS1</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4888"></a>      <span class="n">NS2</span> <span class="o">=</span> <span class="n">NS3</span>
<a name="ln-4889"></a>      <span class="k">CALL </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-4890"></a>      <span class="c">!  Next statement is special to deal with transmitting shading devices</span>
<a name="ln-4891"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">FirstSurfWithinSecond</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SchValue</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">OverlapStatus</span><span class="o">=</span><span class="n">PartialOverlap</span>
<a name="ln-4892"></a>      <span class="n">MainOverlapStatus</span> <span class="o">=</span> <span class="n">OverlapStatus</span>
<a name="ln-4893"></a>      <span class="n">ExitLoopStatus</span><span class="o">=</span><span class="n">MainOverlapStatus</span>
<a name="ln-4894"></a>
<a name="ln-4895"></a>      <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">MainOverlapStatus</span><span class="p">)</span>
<a name="ln-4896"></a>
<a name="ln-4897"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">NoOverlap</span><span class="p">)</span>  <span class="c">! No overlap of general surface shadow and receiving surface</span>
<a name="ln-4898"></a>          <span class="k">CYCLE</span>
<a name="ln-4899"></a>
<a name="ln-4900"></a><span class="k">        CASE</span> <span class="p">(</span><span class="n">FirstSurfWithinSecond</span><span class="p">,</span><span class="n">TooManyVertices</span><span class="p">,</span><span class="n">TooManyFigures</span><span class="p">)</span>
<a name="ln-4901"></a>          <span class="k">EXIT </span><span class="n">ShadowingSurfaces</span>
<a name="ln-4902"></a>
<a name="ln-4903"></a>        <span class="k">CASE</span> <span class="p">(</span><span class="n">SecondSurfWithinFirst</span><span class="p">,</span><span class="n">PartialOverlap</span><span class="p">)</span>
<a name="ln-4904"></a>          <span class="c">! Determine overlaps with previous shadows.</span>
<a name="ln-4905"></a>          <span class="n">LOCHCA</span> <span class="o">=</span> <span class="n">NS3</span>
<a name="ln-4906"></a>          <span class="n">NGSSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FGSSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4907"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">NGSSHC</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-4908"></a><span class="k">          CALL </span><span class="n">MULTOL</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">,</span><span class="n">FGSSHC</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">NGSSHC</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! HOYT - Remove this call</span>
<a name="ln-4909"></a>
<a name="ln-4910"></a>        <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4911"></a>          <span class="k">EXIT </span><span class="n">ShadowingSurfaces</span>
<a name="ln-4912"></a>
<a name="ln-4913"></a>      <span class="k">END SELECT</span>
<a name="ln-4914"></a>
<a name="ln-4915"></a><span class="k">      </span><span class="n">ExitLoopStatus</span><span class="o">=-</span><span class="mi">1</span>
<a name="ln-4916"></a>
<a name="ln-4917"></a>    <span class="k">END DO </span><span class="n">ShadowingSurfaces</span>
<a name="ln-4918"></a>
<a name="ln-4919"></a>          <span class="c">! Compute sunlit area of surface (excluding effects of subsurfs).</span>
<a name="ln-4920"></a>
<a name="ln-4921"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">ExitLoopStatus</span><span class="p">)</span>
<a name="ln-4922"></a>
<a name="ln-4923"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">FirstSurfWithinSecond</span><span class="p">)</span>    <span class="c">! Surface fully shaded</span>
<a name="ln-4924"></a>        <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-4925"></a>        <span class="n">LOCHCA</span>     <span class="o">=</span> <span class="n">FGSSHC</span>
<a name="ln-4926"></a>
<a name="ln-4927"></a>      <span class="k">CASE</span> <span class="p">(</span><span class="n">TooManyVertices</span><span class="p">,</span><span class="n">TooManyFigures</span><span class="p">)</span>   <span class="c">! Array limits exceeded, estimate</span>
<a name="ln-4928"></a>        <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.25d0</span><span class="o">*</span><span class="n">HCAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4929"></a>
<a name="ln-4930"></a>      <span class="k">CASE </span><span class="n">DEFAULT</span>
<a name="ln-4931"></a>
<a name="ln-4932"></a>        <span class="c">! Compute the sunlit area here.</span>
<a name="ln-4933"></a>        <span class="c">! Call UnionShadow(FGSSHC,LOCHCA)</span>
<a name="ln-4934"></a>
<a name="ln-4935"></a>        <span class="n">NGSSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FGSSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4936"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NGSSHC</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4937"></a><span class="k">          </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c">! Surface fully sunlit</span>
<a name="ln-4938"></a>        <span class="k">ELSE</span>
<a name="ln-4939"></a><span class="k">          </span><span class="n">A</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4940"></a>          <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NGSSHC</span>
<a name="ln-4941"></a>            <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FGSSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HCT</span><span class="p">(</span><span class="n">FGSSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">))</span>
<a name="ln-4942"></a>          <span class="k">END DO</span>
<a name="ln-4943"></a><span class="k">          </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span>
<a name="ln-4944"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Surface fully shaded</span>
<a name="ln-4945"></a>            <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-4946"></a>            <span class="n">LOCHCA</span><span class="o">=</span><span class="n">FGSSHC</span>
<a name="ln-4947"></a>          <span class="k">END IF</span>
<a name="ln-4948"></a><span class="k">        END IF</span>
<a name="ln-4949"></a>
<a name="ln-4950"></a><span class="k">    END SELECT</span>
<a name="ln-4951"></a>
<a name="ln-4952"></a><span class="k">  END IF</span>
<a name="ln-4953"></a>
<a name="ln-4954"></a><span class="k">  </span><span class="n">NGSSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FGSSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4955"></a>
<a name="ln-4956"></a>  <span class="k">RETURN</span>
<a name="ln-4957"></a>
<a name="ln-4958"></a><span class="k">END SUBROUTINE </span><span class="n">SHDGSS</span>
<a name="ln-4959"></a>
<a name="ln-4960"></a><span class="k">SUBROUTINE </span><span class="n">CalcInteriorSolarOverlaps</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">HTSS</span><span class="p">,</span><span class="n">GRSNR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-4961"></a>
<a name="ln-4962"></a>        <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4963"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-4964"></a>          <span class="c">!       DATE WRITTEN   January 1999</span>
<a name="ln-4965"></a>          <span class="c">!       MODIFIED       Nov 2001, FW: include beam radiation overlaps with</span>
<a name="ln-4966"></a>          <span class="c">!                       back windows and doors; previously these subsurfaces ignored.</span>
<a name="ln-4967"></a>          <span class="c">!                      May 2002, FW: fix problem where reveal was not being considered</span>
<a name="ln-4968"></a>          <span class="c">!                       in calculating overlap areas if window is shaded only by reveal.</span>
<a name="ln-4969"></a>          <span class="c">!                      June 2002, FW: fix problem that gave incorrect calculation when</span>
<a name="ln-4970"></a>          <span class="c">!                       window is not shaded only by reveal</span>
<a name="ln-4971"></a>          <span class="c">!                      June 2002, FW: remove incorrect multiplication of overlap areas</span>
<a name="ln-4972"></a>          <span class="c">!                       by sunlit fraction when window is shaded only by reveal</span>
<a name="ln-4973"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4974"></a>
<a name="ln-4975"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4976"></a>          <span class="c">! For an exterior window with surface number HTSS, determines (1) the surface numbers of back</span>
<a name="ln-4977"></a>          <span class="c">! surfaces receiving beam radiation from the window and (2) for each such back surface, the area</span>
<a name="ln-4978"></a>          <span class="c">! of the portion of the window sending beam radiation to the back surface; this is called the</span>
<a name="ln-4979"></a>          <span class="c">! &quot;overlap area.&quot;</span>
<a name="ln-4980"></a>
<a name="ln-4981"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4982"></a>          <span class="c">! na</span>
<a name="ln-4983"></a>
<a name="ln-4984"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4985"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-4986"></a>
<a name="ln-4987"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4988"></a>          <span class="c">! na</span>
<a name="ln-4989"></a>
<a name="ln-4990"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4991"></a>
<a name="ln-4992"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4993"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHOUR</span>  <span class="c">! Hour Index</span>
<a name="ln-4994"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TS</span>     <span class="c">! Time step Index</span>
<a name="ln-4995"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTSS</span>   <span class="c">! Surface number of the subsurface (exterior window)</span>
<a name="ln-4996"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">GRSNR</span>  <span class="c">! General receiving surface number (base surface of the exterior window)</span>
<a name="ln-4997"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBKS</span>   <span class="c">! Number of back surfaces associated with this GRSNR (in general, only</span>
<a name="ln-4998"></a>                                <span class="c">!  some of these will receive beam radiation from HTSS this hour)</span>
<a name="ln-4999"></a>
<a name="ln-5000"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5001"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="k">None</span>                       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! for use with RevealStatus</span>
<a name="ln-5002"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EntireWindowShadedByReveal</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! for use with RevealStatus</span>
<a name="ln-5003"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WindowShadedOnlyByReveal</span>   <span class="o">=</span> <span class="mi">2</span>  <span class="c">! for use with RevealStatus</span>
<a name="ln-5004"></a>
<a name="ln-5005"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5006"></a>          <span class="c">! na</span>
<a name="ln-5007"></a>
<a name="ln-5008"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5009"></a>          <span class="c">! na</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5012"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">I</span><span class="p">,</span><span class="n">J</span>             <span class="c">! DO loop index</span>
<a name="ln-5013"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">IBKS</span>            <span class="c">! Back surface DO loop index</span>
<a name="ln-5014"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">JBKS</span>            <span class="c">! Counter of back surfaces with non-zero overlap with HTSS</span>
<a name="ln-5015"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">JBKSbase</span>        <span class="c">! Back base surface counter</span>
<a name="ln-5016"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">BackSurfNum</span>     <span class="c">! Back surface number</span>
<a name="ln-5017"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OverlapArea</span>     <span class="c">! Overlap area (m2)</span>
<a name="ln-5018"></a>
<a name="ln-5019"></a>  <span class="kt">LOGICAL</span>        <span class="kd">::</span> <span class="n">UseSimpleDistribution</span> <span class="c">! TRUE means simple interior solar distribution</span>
<a name="ln-5020"></a>                                          <span class="c">! (all incoming beam assumed to strike floor),</span>
<a name="ln-5021"></a>                                          <span class="c">! FALSE means exact interior solar distribution</span>
<a name="ln-5022"></a>                                          <span class="c">! (track which back surfaces beam illuminates)</span>
<a name="ln-5023"></a>
<a name="ln-5024"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5025"></a>
<a name="ln-5026"></a><span class="k">    </span><span class="n">UseSimpleDistribution</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5027"></a>
<a name="ln-5028"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">NBKS</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">Surface</span><span class="p">(</span><span class="n">GRSNR</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5029"></a>
<a name="ln-5030"></a><span class="k">      </span><span class="n">UseSimpleDistribution</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5031"></a>
<a name="ln-5032"></a>    <span class="k">ELSE</span>
<a name="ln-5033"></a>          <span class="c">! Using &#39;exact&#39; distribution, replace subsurface HC entries with reveal HC entries</span>
<a name="ln-5034"></a>          <span class="c">! so that the reveal HC is used in calculating interior solar overlap areas</span>
<a name="ln-5035"></a>
<a name="ln-5036"></a>      <span class="c">! Adding the following line fixes a problem where, if the window was shaded only</span>
<a name="ln-5037"></a>      <span class="c">! by reveal, then the reveal was not considered in calculating interior solar</span>
<a name="ln-5038"></a>      <span class="c">! overlap areas (FCW 5/3/02).</span>
<a name="ln-5039"></a>        <span class="c">!IF(Surface(HTSS)%Reveal &gt; 0.0) NRVLHC = 1</span>
<a name="ln-5040"></a>      <span class="c">! Changing the line to the following avoids incorrect calculation when window is not shaded</span>
<a name="ln-5041"></a>      <span class="c">! only by reveal (FCW 6/28/02).</span>
<a name="ln-5042"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WindowRevealStatus</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">==</span> <span class="n">WindowShadedOnlyByReveal</span><span class="p">)</span> <span class="n">NRVLHC</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-5043"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">NRVLHC</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5044"></a><span class="k">        DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NRVLHC</span>
<a name="ln-5045"></a>          <span class="n">HCT</span><span class="p">(</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>    <span class="o">=</span> <span class="n">HCT</span><span class="p">(</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5046"></a>          <span class="n">HCNV</span><span class="p">(</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>   <span class="o">=</span> <span class="n">HCNV</span><span class="p">(</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5047"></a>          <span class="n">HCAREA</span><span class="p">(</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5048"></a>          <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MAXHCV</span>
<a name="ln-5049"></a>            <span class="n">HCX</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCX</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5050"></a>            <span class="n">HCY</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCY</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5051"></a>            <span class="n">HCA</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCA</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5052"></a>            <span class="n">HCB</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCB</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5053"></a>            <span class="n">HCC</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCC</span><span class="p">(</span><span class="n">J</span><span class="p">,</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<a name="ln-5054"></a>          <span class="k">END DO</span>
<a name="ln-5055"></a><span class="k">        END DO</span>
<a name="ln-5056"></a><span class="k">        </span><span class="n">NSBSHC</span><span class="o">=</span><span class="n">NRVLHC</span>
<a name="ln-5057"></a>      <span class="k">END IF</span>
<a name="ln-5058"></a>
<a name="ln-5059"></a><span class="k">    END IF</span>
<a name="ln-5060"></a>
<a name="ln-5061"></a>          <span class="c">! Check for array space.</span>
<a name="ln-5062"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FSBSHC</span><span class="o">+</span><span class="n">NBKSHC</span> <span class="o">&gt;</span> <span class="n">MAXHCS</span><span class="p">)</span> <span class="n">UseSimpleDistribution</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5063"></a>
<a name="ln-5064"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">UseSimpleDistribution</span><span class="p">)</span> <span class="k">THEN</span>    <span class="c">! Compute overlaps</span>
<a name="ln-5065"></a>
<a name="ln-5066"></a>      <span class="n">FINSHC</span> <span class="o">=</span> <span class="n">FSBSHC</span> <span class="o">+</span> <span class="n">NSBSHC</span>
<a name="ln-5067"></a>
<a name="ln-5068"></a>      <span class="n">JBKS</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5069"></a>      <span class="n">JBKSbase</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5070"></a>
<a name="ln-5071"></a>      <span class="k">DO </span><span class="n">IBKS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NBKSHC</span>  <span class="c">! Loop over back surfaces to GRSNR this hour. NBKSHC is the number of</span>
<a name="ln-5072"></a>                           <span class="c">! back surfaces that would receive beam radiation from the base surface, GRSNR,</span>
<a name="ln-5073"></a>                           <span class="c">! if the base surface was transparent. In general, some (at least one) or all of these</span>
<a name="ln-5074"></a>                           <span class="c">! will receive beam radiation from the exterior window subsurface, HTSS, of GRSNR,</span>
<a name="ln-5075"></a>                           <span class="c">! depending on the size of HTSS and its location on GRSNR</span>
<a name="ln-5076"></a>
<a name="ln-5077"></a>        <span class="n">BackSurfNum</span> <span class="o">=</span> <span class="n">HCNS</span><span class="p">(</span><span class="n">FBKSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">IBKS</span><span class="p">)</span>
<a name="ln-5078"></a>
<a name="ln-5079"></a>        <span class="c">! Determine if this back surface number can receive beam radiation from the</span>
<a name="ln-5080"></a>        <span class="c">! exterior window, HTSS, this hour, i.e., overlap area is positive</span>
<a name="ln-5081"></a>
<a name="ln-5082"></a>        <span class="n">LOCHCA</span>  <span class="o">=</span> <span class="n">FINSHC</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-5083"></a>
<a name="ln-5084"></a>        <span class="k">CALL </span><span class="n">MULTOL</span><span class="p">(</span><span class="n">FBKSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">IBKS</span><span class="p">,</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">NSBSHC</span><span class="p">)</span>
<a name="ln-5085"></a>
<a name="ln-5086"></a>          <span class="c">! Compute overlap area for this back surface</span>
<a name="ln-5087"></a>
<a name="ln-5088"></a>        <span class="n">NINSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FINSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5089"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NINSHC</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5090"></a><span class="k">        </span><span class="n">OverlapArea</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FINSHC</span><span class="p">)</span>
<a name="ln-5091"></a>        <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NINSHC</span>
<a name="ln-5092"></a>          <span class="n">OverlapArea</span> <span class="o">=</span> <span class="n">OverlapArea</span> <span class="o">+</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FINSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">J</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HCT</span><span class="p">(</span><span class="n">FINSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">J</span><span class="p">))</span>
<a name="ln-5093"></a>        <span class="k">END DO</span>
<a name="ln-5094"></a>
<a name="ln-5095"></a><span class="k">        IF</span><span class="p">(</span><span class="n">OverlapArea</span> <span class="o">&gt;</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5096"></a><span class="k">          </span><span class="n">JBKS</span> <span class="o">=</span> <span class="n">JBKS</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-5097"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">==</span> <span class="n">BackSurfNum</span><span class="p">)</span> <span class="n">JBKSbase</span> <span class="o">=</span> <span class="n">JBKS</span>
<a name="ln-5098"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">JBKS</span> <span class="o">&lt;=</span> <span class="n">MaxBkSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5099"></a><span class="k">            </span><span class="n">BackSurfaces</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">JBKS</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="n">BackSurfNum</span>
<a name="ln-5100"></a>            <span class="c">! Remove following IF check: multiplying by sunlit fraction in the following is incorrect</span>
<a name="ln-5101"></a>            <span class="c">! (FCW, 6/28/02)</span>
<a name="ln-5102"></a>              <span class="c">!IF (WindowRevealStatus(HTSS,IHOUR,TS) == WindowShadedOnlyByReveal) THEN</span>
<a name="ln-5103"></a>              <span class="c">!  OverlapArea = OverlapArea*(SAREA(HTSS)/Surface(HTSS)%Area)</span>
<a name="ln-5104"></a>              <span class="c">!ENDIF</span>
<a name="ln-5105"></a>            <span class="n">OverlapAreas</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">JBKS</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="n">OverlapArea</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-5106"></a>            <span class="c">! If this is a subsurface, subtract its overlap area from the base surface</span>
<a name="ln-5107"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span> <span class="o">/=</span> <span class="n">BackSurfNum</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">JBKSbase</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5108"></a><span class="k">              </span><span class="n">OverlapAreas</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">JBKSbase</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5109"></a>              <span class="n">OverlapAreas</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">JBKSbase</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">-</span> <span class="n">OverlapAreas</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">JBKS</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">))</span>
<a name="ln-5110"></a>            <span class="k">END IF</span>
<a name="ln-5111"></a><span class="k">          END IF</span>
<a name="ln-5112"></a><span class="k">        END IF</span>
<a name="ln-5113"></a>
<a name="ln-5114"></a><span class="k">      END DO</span>  <span class="c">! End of loop over back surfaces</span>
<a name="ln-5115"></a>
<a name="ln-5116"></a>    <span class="k">END IF</span>
<a name="ln-5117"></a>
<a name="ln-5118"></a><span class="k">  END IF</span>  <span class="c">! End of check that sunlit area &gt; 0.</span>
<a name="ln-5119"></a>
<a name="ln-5120"></a>  <span class="k">RETURN</span>
<a name="ln-5121"></a>
<a name="ln-5122"></a><span class="k">END SUBROUTINE </span><span class="n">CalcInteriorSolarOverlaps</span>
<a name="ln-5123"></a>
<a name="ln-5124"></a><span class="k">SUBROUTINE </span><span class="n">CalcInteriorSolarDistribution</span>
<a name="ln-5125"></a>
<a name="ln-5126"></a>        <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5127"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-5128"></a>          <span class="c">!       DATE WRITTEN   January 1999</span>
<a name="ln-5129"></a>          <span class="c">!       MODIFIED       Nov 1999, FW, for Window5 calculation method</span>
<a name="ln-5130"></a>          <span class="c">!                      Oct 2000, FW: add transmitted solar variables for reporting</span>
<a name="ln-5131"></a>          <span class="c">!                      Mar 2001, FW: add new calc of solar absorbed by window shades</span>
<a name="ln-5132"></a>          <span class="c">!                      May 2001, FW: add calc of solar transmitted and absorbed by window blinds</span>
<a name="ln-5133"></a>          <span class="c">!                      Oct 2001, LL: remove interpolation, solar now at time step</span>
<a name="ln-5134"></a>          <span class="c">!                      Oct 2001, FW: add solar transmitted through interior windows</span>
<a name="ln-5135"></a>          <span class="c">!                      Mar 24, 2001, FW: remove incorrect multiplication of Boverlap by sunlit fraction</span>
<a name="ln-5136"></a>          <span class="c">!                                        since effect of shadowing is already included in Aoverlap</span>
<a name="ln-5137"></a>          <span class="c">!                      Apr 2001, FW: add effects of beam solar reflection from outside and inside reveals</span>
<a name="ln-5138"></a>          <span class="c">!                      Jan 2003, FW: add between-glass shades and blinds</span>
<a name="ln-5139"></a>          <span class="c">!                      Dec 2003, FW: report beam incident on inside of surface</span>
<a name="ln-5140"></a>          <span class="c">!                      Jan 2004, FW: for blinds with horizontal slats, allow different diffuse/diffuse</span>
<a name="ln-5141"></a>          <span class="c">!                                    transmittance for ground and sky solar</span>
<a name="ln-5142"></a>          <span class="c">!                      Apr 2004, FW: allow diffusing glazing</span>
<a name="ln-5143"></a>          <span class="c">!                      May 2006, RR: allow external window screen</span>
<a name="ln-5144"></a>          <span class="c">!                      Jan 2010, TH: add calculating and reporting of WinBmBmSolar, WinBmDifSolar,</span>
<a name="ln-5145"></a>          <span class="c">!                                    WinBmBmSolarEnergy, and WinBmDifSolarEnergy</span>
<a name="ln-5146"></a>          <span class="c">!                      Jun 2013, SV: scheduled surface gains for walls and windows</span>
<a name="ln-5147"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5148"></a>
<a name="ln-5149"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5150"></a>          <span class="c">! For a time step, calculates solar radiation absorbed by exterior</span>
<a name="ln-5151"></a>          <span class="c">! surfaces and interior solar radiation distribution</span>
<a name="ln-5152"></a>
<a name="ln-5153"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5154"></a>          <span class="c">! na</span>
<a name="ln-5155"></a>
<a name="ln-5156"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5157"></a>          <span class="c">! na</span>
<a name="ln-5158"></a>
<a name="ln-5159"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5160"></a><span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-5161"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span> <span class="n">InterpSw</span><span class="p">,</span> <span class="n">InterpBlind</span><span class="p">,</span> <span class="n">InterpSlatAng</span><span class="p">,</span> <span class="n">InterpProfSlatAng</span><span class="p">,</span> <span class="n">BlindBeamBeamTrans</span><span class="p">,</span> <span class="n">InterpProfAng</span>
<a name="ln-5162"></a><span class="k">USE </span><span class="n">DataDaylightingDevices</span>
<a name="ln-5163"></a><span class="k">USE </span><span class="n">DaylightingDevices</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindTDDPipe</span><span class="p">,</span> <span class="n">TransTDD</span>
<a name="ln-5164"></a><span class="k">USE </span><span class="n">WindowEquivalentLayer</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcEQLOpticalProperty</span><span class="p">,</span> <span class="n">CFSDiffAbsTrans</span>
<a name="ln-5165"></a><span class="k">USE </span><span class="n">DataWindowEquivalentLayer</span>
<a name="ln-5166"></a>
<a name="ln-5167"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5168"></a>
<a name="ln-5169"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5170"></a>          <span class="c">! na</span>
<a name="ln-5171"></a>
<a name="ln-5172"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5173"></a>          <span class="c">! na</span>
<a name="ln-5174"></a>
<a name="ln-5175"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5176"></a>          <span class="c">! na</span>
<a name="ln-5177"></a>
<a name="ln-5178"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5179"></a>          <span class="c">! na</span>
<a name="ln-5180"></a>
<a name="ln-5181"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5182"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! Zone number</span>
<a name="ln-5183"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-5184"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">SurfNum2</span>          <span class="c">! Secondary surface number for tubular daylighting device diffuser (TDD:DIFFUSER)</span>
<a name="ln-5185"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">PipeNum</span>           <span class="c">! TDD pipe object number</span>
<a name="ln-5186"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ShelfNum</span>          <span class="c">! Daylighting shelf object number</span>
<a name="ln-5187"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">InShelfSurf</span>       <span class="c">! Inside daylighting shelf surface number</span>
<a name="ln-5188"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">OutShelfSurf</span>      <span class="c">! Outside daylighting shelf surface number</span>
<a name="ln-5189"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ShelfSolarRad</span>     <span class="c">! Shelf diffuse solar radiation</span>
<a name="ln-5190"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">BackSurfNum</span>       <span class="c">! Back surface number</span>
<a name="ln-5191"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">IBack</span>             <span class="c">! Back surface counter</span>
<a name="ln-5192"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">RevSurfInd</span>        <span class="c">!Back surface counter value for reversed surfaces</span>
<a name="ln-5193"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">KRevSurf</span>          <span class="c">!Additional Back surface counter for reversed surfaces</span>
<a name="ln-5194"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">FloorNum</span>          <span class="c">! Floor surface number</span>
<a name="ln-5195"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">AdjSurfNum</span>        <span class="c">! Adjacent surface number</span>
<a name="ln-5196"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">AdjZoneNum</span>        <span class="c">! Adjacent zone number</span>
<a name="ln-5197"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CosTlt</span>            <span class="c">! Cosine of surface tilt angle</span>
<a name="ln-5198"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ConstrNum</span>         <span class="c">! Construction number</span>
<a name="ln-5199"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ConstrNumSh</span>       <span class="c">! Shaded construction number</span>
<a name="ln-5200"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ConstrNumBack</span>     <span class="c">! Construction number of back surface</span>
<a name="ln-5201"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ConstrNumBackSh</span>   <span class="c">! Shaded construction number of back surface</span>
<a name="ln-5202"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">FlConstrNum</span>       <span class="c">! Construction number of floor surface</span>
<a name="ln-5203"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ShadeFlag</span>         <span class="c">! Shading flag for a window</span>
<a name="ln-5204"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ShadeFlagBack</span>     <span class="c">! Shading flag for a window that is a back surface</span>
<a name="ln-5205"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">Lay</span>               <span class="c">! Glass layer number</span>
<a name="ln-5206"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SwitchFac</span>         <span class="c">! Switching factor for a window</span>
<a name="ln-5207"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SwitchFacBack</span>     <span class="c">! Switching factor for a window that is a back surface</span>
<a name="ln-5208"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TransBeamWin</span>      <span class="c">! Beam solar transmittance of a window</span>
<a name="ln-5209"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TransBeamWinSh</span>    <span class="c">! Beam solar transmittance of a shaded window</span>
<a name="ln-5210"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">MaxSolidWinLayers</span><span class="p">)</span> <span class="c">! Glass layer beam solar absorptance of a window</span>
<a name="ln-5211"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBeamWinSh</span><span class="p">(</span><span class="n">MaxSolidWinLayers</span><span class="p">)</span> <span class="c">! Glass layer beam solar absorptance of a shaded window</span>
<a name="ln-5212"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBeamWinEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c">! layers beam solar absorptance of a window</span>
<a name="ln-5213"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBeamTotWin</span>     <span class="c">! Sum of window glass layer beam solar absorptances</span>
<a name="ln-5214"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ProfAng</span>           <span class="c">! Window solar profile angle (radians)</span>
<a name="ln-5215"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ProfAngBack</span>       <span class="c">! Back window solar profile angle (radians)</span>
<a name="ln-5216"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">BlNum</span>             <span class="c">! Blind number</span>
<a name="ln-5217"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ScNum</span>             <span class="c">! Screen number</span>
<a name="ln-5218"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">BlNumBack</span>         <span class="c">! Back surface blind number</span>
<a name="ln-5219"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ScNumBack</span>         <span class="c">! Back surface screen number</span>
<a name="ln-5220"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBmBm</span>             <span class="c">! Beam-beam solar transmittance for bare window or window with switchable glazing</span>
<a name="ln-5221"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBmDif</span>            <span class="c">! Beam-diffuse solar transmittance for bare window with diffusing glass</span>
<a name="ln-5222"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBlBmDif</span>          <span class="c">! Beam-diffuse solar transmittance of blind</span>
<a name="ln-5223"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TScBmDif</span>          <span class="c">! Beam-diffuse solar transmittance of screen</span>
<a name="ln-5224"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBlDifDif</span>         <span class="c">! Diffuse-diffuse solar transmittance of blind</span>
<a name="ln-5225"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TScDifDif</span>         <span class="c">! Diffuse-diffuse solar transmittance of screen</span>
<a name="ln-5226"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlBmDifFr</span>      <span class="c">! Beam-diffuse front reflectance of blind</span>
<a name="ln-5227"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlBmDifBk</span>      <span class="c">! Beam-diffuse back reflectance of blind</span>
<a name="ln-5228"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RScBmDifBk</span>        <span class="c">! Beam-diffuse back reflectance of blind</span>
<a name="ln-5229"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlDifDifFr</span>     <span class="c">! Diffuse-diffuse front refectance of blind</span>
<a name="ln-5230"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlDifDifBk</span>     <span class="c">! Diffuse-diffuse back refectance of blind</span>
<a name="ln-5231"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RScDifDifBk</span>       <span class="c">! Diffuse-diffuse back refectance of screen</span>
<a name="ln-5232"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlBmFr</span>           <span class="c">! Beam front reflectance of glass</span>
<a name="ln-5233"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlDifFr</span>          <span class="c">! Diffuse front reflectance of glass</span>
<a name="ln-5234"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlDifBk</span>          <span class="c">! Diffuse back reflectance of glass</span>
<a name="ln-5235"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBmBmBl</span>           <span class="c">! Beam-beam transmittance for window with blind</span>
<a name="ln-5236"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBmBmSc</span>           <span class="c">! Beam-beam transmittance for window with screen</span>
<a name="ln-5237"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBmAllShBlSc</span>      <span class="c">! Beam-beam + beam-diffuse transmittance for window with shade, blind, screen,</span>
<a name="ln-5238"></a>                                    <span class="c">! or switchable glazing</span>
<a name="ln-5239"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBmAll</span>            <span class="c">! Window beam-to-(beam+diffuse) transmittance</span>
<a name="ln-5240"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBm</span>               <span class="c">! Window beam-beam transmittance</span>
<a name="ln-5241"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DifSolarInc</span>       <span class="c">! Exterior diffuse solar incident on window (W/m2)</span>
<a name="ln-5242"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SkySolarTrans</span>     <span class="c">! Exterior diffuse sky solar transmitted by TDD (W/m2)</span>
<a name="ln-5243"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GndSolarTrans</span>     <span class="c">! Exterior diffuse ground solar transmitted by TDD (W/m2)</span>
<a name="ln-5244"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TDifBare</span>          <span class="c">! Bare diffuse transmittance of exterior window</span>
<a name="ln-5245"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TGlDif</span>            <span class="c">! Bare diffuse transmittance of back window</span>
<a name="ln-5246"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TGlBm</span>             <span class="c">! Glazing system front solar beam transmittance</span>
<a name="ln-5247"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TGlBmBack</span>         <span class="c">! Glazing system back solar beam transmittance</span>
<a name="ln-5248"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AGlDiffBack</span>       <span class="c">! Glass layer back diffuse solar absorptance</span>
<a name="ln-5249"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlDiffBack</span>       <span class="c">! Glazing system back diffuse solar reflectance</span>
<a name="ln-5250"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AGlDiffFront</span>      <span class="c">! Glass layer front diffuse solar absorptance</span>
<a name="ln-5251"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlDiffFront</span>      <span class="c">! Glazing system front diffuse solar reflectance</span>
<a name="ln-5252"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TotReflect</span>        <span class="c">!Total directional-hemispherical solar reflectance of a back surface window</span>
<a name="ln-5253"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlFront</span>        <span class="c">! Blind solar front beam reflectance</span>
<a name="ln-5254"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlBack</span>         <span class="c">! Blind solar back beam-diffuse reflectance</span>
<a name="ln-5255"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RScBack</span>           <span class="c">! Screen solar back beam-diffuse reflectance</span>
<a name="ln-5256"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RScDifBack</span>        <span class="c">! Screen solar back diffuse-diffuse reflectance</span>
<a name="ln-5257"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBlFront</span>        <span class="c">! Blind solar front beam absorptance</span>
<a name="ln-5258"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsScBeam</span>         <span class="c">! Screen solar beam absorptance</span>
<a name="ln-5259"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBlBack</span>         <span class="c">! Blind solar back beam absorptance</span>
<a name="ln-5260"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsScBack</span>         <span class="c">! Screen solar back beam absorptance</span>
<a name="ln-5261"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBlDiffFront</span>    <span class="c">! Blind solar front diffuse absorptance</span>
<a name="ln-5262"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsBlDiffBack</span>     <span class="c">! Blind solar back diffuse absorptance</span>
<a name="ln-5263"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsScDiffBack</span>     <span class="c">! Screen solar back diffuse absorptance</span>
<a name="ln-5264"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ABlBack</span>           <span class="c">! Blind solar back absorptance for interior solar</span>
<a name="ln-5265"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AScBack</span>           <span class="c">! Screen solar back absorptance for interior solar</span>
<a name="ln-5266"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TrSh</span>              <span class="c">! Shade material solar transmittance</span>
<a name="ln-5267"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsSh</span>             <span class="c">! Shade material solar absorptance</span>
<a name="ln-5268"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoSh</span>             <span class="c">! Shade material solar reflectance</span>
<a name="ln-5269"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AShBack</span>           <span class="c">! System shade absorptance for interior beam solar</span>
<a name="ln-5270"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBlBmBm</span>           <span class="c">! Blind solar front beam-beam transmittance</span>
<a name="ln-5271"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TScBmBm</span>           <span class="c">! Screen solar front beam-beam transmittance</span>
<a name="ln-5272"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBlBmBmBack</span>       <span class="c">! Blind solar back beam-beam transmittance</span>
<a name="ln-5273"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TScBmBmBack</span>       <span class="c">! Screen solar back beam-beam transmittance</span>
<a name="ln-5274"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBlBmDiff</span>         <span class="c">! Blind solar front beam-diffuse transmittance</span>
<a name="ln-5275"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TScBmDiff</span>         <span class="c">! Screen solar front beam-diffuse transmittance</span>
<a name="ln-5276"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TBlBmDiffBack</span>     <span class="c">! Blind solar back beam-diffuse transmittance</span>
<a name="ln-5277"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TScBmDiffBack</span>     <span class="c">! Screen solar back beam-diffuse transmittance</span>
<a name="ln-5278"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlDiffFront</span>    <span class="c">! Blind solar front diffuse reflectance</span>
<a name="ln-5279"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RhoBlDiffBack</span>     <span class="c">! Blind solar back diffuse reflectance</span>
<a name="ln-5280"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RScDiffBack</span>       <span class="c">! Screen solar back diffuse reflectance</span>
<a name="ln-5281"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlFront</span>          <span class="c">! Glazing system solar front beam-beam reflectance</span>
<a name="ln-5282"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">RGlBack</span>           <span class="c">! Glazing system solar back beam-beam reflectance</span>
<a name="ln-5283"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BTOTWinZone</span>       <span class="c">! Transmitted beam solar factor for a window</span>
<a name="ln-5284"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BTOTZone</span>          <span class="c">! (Solar entering a zone as beam or diffuse radiation, originating as beam solar</span>
<a name="ln-5285"></a>                                    <span class="c">!  incident on exterior windows)/(Beam normal solar) [W/(W/m2)]</span>
<a name="ln-5286"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BTOTZoneSSG</span>       <span class="c">! Solar entering a zone in case of scheduled surface gains</span>
<a name="ln-5287"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbWin</span><span class="p">(</span><span class="n">MaxSolidWinLayers</span><span class="p">)</span> <span class="c">! Factor for front beam radiation absorbed in window glass layers</span>
<a name="ln-5288"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbWinBack</span>         <span class="c">! Factor for back beam radiation absorbed in window glass layers</span>
<a name="ln-5289"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbWinSh</span><span class="p">(</span><span class="n">MaxSolidWinLayers</span><span class="p">)</span> <span class="c">! Like AbWin, but for shaded window</span>
<a name="ln-5290"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbWinEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Factor for front beam radiation absorbed for equivalent layer window model</span>
<a name="ln-5291"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AdWinEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c">! Factor for front diffuse radiation absorbed for equivalent layer window model</span>
<a name="ln-5292"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BABSZone</span>          <span class="c">! Beam radiation from exterior windows absorbed in a zone or transmitted through</span>
<a name="ln-5293"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BABSZoneSSG</span>       <span class="c">! Beam radiation from exterior windows absorbed in a zone (only for scheduled surface gains)</span>
<a name="ln-5294"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AOverlap</span>          <span class="c">! Back surface area irradiated by beam solar from an exterior window,</span>
<a name="ln-5295"></a>                                    <span class="c">!   projected onto window plane</span>
<a name="ln-5296"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BOverlap</span>          <span class="c">! AOverlap multiplied by exterior window beam transmittance</span>
<a name="ln-5297"></a>                                    <span class="c">! and cosine of incidence angle</span>
<a name="ln-5298"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsScreen</span>         <span class="c">! Exterior screen beam solar absorptance</span>
<a name="ln-5299"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsShade</span>          <span class="c">! Interior shade or blind beam solar absorptance</span>
<a name="ln-5300"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsShadeDiff</span>      <span class="c">! Interior shade or blind diffuse solar absorptance</span>
<a name="ln-5301"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DSZoneWin</span>         <span class="c">! Factor for sky diffuse solar gain into a zone from an exterior window</span>
<a name="ln-5302"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DSZoneWinSh</span>       <span class="c">! Factor for sky diffuse solar gain into a zone from a shaded exterior window</span>
<a name="ln-5303"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DGZoneWin</span>         <span class="c">! Factor for ground diffuse solar gain into a zone</span>
<a name="ln-5304"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DGZoneWinSh</span>       <span class="c">! Factor for ground diffuse solar gain into a zone from a shaded exterior window</span>
<a name="ln-5305"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">HMovInsul</span>         <span class="c">! Conductance of movable wall insulation</span>
<a name="ln-5306"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">AbsIntSurf</span><span class="p">,</span> <span class="n">AbsInt</span> <span class="c">! Interior solar absorptance of opaque surface</span>
<a name="ln-5307"></a>
<a name="ln-5308"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MovInsulSchedVal</span>  <span class="c">! Value of the movable insulation schedule for current time</span>
<a name="ln-5309"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FracSunLit</span>        <span class="c">! Effective fraction of window that is sunlit;</span>
<a name="ln-5310"></a>                                    <span class="c">!  takes shadowing effects of frame and divider into account</span>
<a name="ln-5311"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SunLitFract</span>       <span class="c">! Sunlit fraction w/o shadowing effects of frame and divider</span>
<a name="ln-5312"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">InOutProjSLFracMult</span> <span class="c">! = SurfaceWindow(SurfNum)%InOutProjSLFracMult(HourOfDay)</span>
<a name="ln-5313"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CosInc</span><span class="p">,</span><span class="n">CosIncBack</span> <span class="c">! Incidence angle of beam solar radiation on window</span>
<a name="ln-5314"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SlatAng</span><span class="p">,</span><span class="n">SlatAngBack</span>   <span class="c">! Slat angle this time step for window with blind on (deg)</span>
<a name="ln-5315"></a><span class="kt">LOGICAL</span>        <span class="kd">::</span> <span class="n">VarSlats</span><span class="p">,</span><span class="n">VarSlatsBack</span> <span class="c">! True if variable slat angle</span>
<a name="ln-5316"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ADiffWin</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>       <span class="c">! Diffuse solar absorptance of glass layers, bare window</span>
<a name="ln-5317"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ADiffWinSh</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>     <span class="c">! Diffuse solar absorptance of glass layers, window with shading device</span>
<a name="ln-5318"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DiffTrans</span>         <span class="c">! Glazing diffuse solar transmittance (including shade/blind/switching, if present)</span>
<a name="ln-5319"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DiffTransGnd</span>      <span class="c">! Ground diffuse solar transmittance for glazing with blind with horiz. slats or complex fen</span>
<a name="ln-5320"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DiffTransBmGnd</span>   <span class="c">!Complex fen: diffuse solar transmittance for ground-reflected beam radiation</span>
<a name="ln-5321"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DiffTransSky</span>      <span class="c">! Sky diffuse solar transmittance for glazing with blind with horiz. slats or complex fen</span>
<a name="ln-5322"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">NomDiffTrans</span>     <span class="c">!</span>
<a name="ln-5323"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">BaseSurfNum</span>       <span class="c">! Base surface number</span>
<a name="ln-5324"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">t3</span>          <span class="c">! Bare-glass beam solar transmittance for glass layers 1,2 and 3</span>
<a name="ln-5325"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">t1t2</span>              <span class="c">! t1*t2</span>
<a name="ln-5326"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">af1</span><span class="p">,</span><span class="n">af2</span><span class="p">,</span><span class="n">af3</span>       <span class="c">! Bare-glass beam solar front absorptance for glass layers 1,2 and 3</span>
<a name="ln-5327"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ab1</span><span class="p">,</span><span class="n">ab2</span><span class="p">,</span><span class="n">ab3</span>       <span class="c">! Bare-glass beam solar back absorptance for glass layers 1,2 and 3</span>
<a name="ln-5328"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rf1</span><span class="p">,</span><span class="n">rf2</span><span class="p">,</span><span class="n">rf3</span>       <span class="c">! Bare-glass beam solar front reflectance for glass layers 1,2 and 3</span>
<a name="ln-5329"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rb1</span><span class="p">,</span><span class="n">rb2</span><span class="p">,</span><span class="n">rb3</span>       <span class="c">! Bare-glass beam solar back reflectance for glass layers 1,2 and 3</span>
<a name="ln-5330"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">td1</span><span class="p">,</span><span class="n">td2</span><span class="p">,</span><span class="n">td3</span>       <span class="c">! Bare-glass diffuse solar transmittance for glass layers 1,2 and 3</span>
<a name="ln-5331"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">td1td2</span>            <span class="c">! td1*td2</span>
<a name="ln-5332"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">afd1</span><span class="p">,</span><span class="n">afd2</span><span class="p">,</span><span class="n">afd3</span>    <span class="c">! Bare-glass diffuse solar front absorptance for glass layers 1,2 and 3</span>
<a name="ln-5333"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">abd1</span><span class="p">,</span><span class="n">abd2</span><span class="p">,</span><span class="n">abd3</span>    <span class="c">! Bare-glass diffuse solar back absorptance for glass layers 1,2 and 3</span>
<a name="ln-5334"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rfd1</span><span class="p">,</span><span class="n">rfd2</span><span class="p">,</span><span class="n">rfd3</span>    <span class="c">! Bare-glass diffuse solar front reflectance for glass layers 1,2 and 3</span>
<a name="ln-5335"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rbd1</span><span class="p">,</span><span class="n">rbd2</span><span class="p">,</span><span class="n">rbd3</span>    <span class="c">! Bare-glass diffuse solar back reflectance for glass layers 1,2 and 3</span>
<a name="ln-5336"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tfshBB</span><span class="p">,</span><span class="n">tbshBB</span>     <span class="c">! Bare-blind front and back beam-beam solar transmittance</span>
<a name="ln-5337"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tfshBd</span><span class="p">,</span><span class="n">tbshBd</span>     <span class="c">! Bare-blind front and back beam-diffuse solar transmittance</span>
<a name="ln-5338"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tfshd</span><span class="p">,</span><span class="n">tbshd</span>       <span class="c">! Bare-blind front and back diffuse-diffuse solar transmittance</span>
<a name="ln-5339"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">afshB</span><span class="p">,</span><span class="n">abshB</span>       <span class="c">! Bare-blind front and back beam solar absorptance</span>
<a name="ln-5340"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">afshd</span><span class="p">,</span><span class="n">abshd</span>       <span class="c">! Bare-blind front and back diffuse solar absorptance</span>
<a name="ln-5341"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rfshB</span><span class="p">,</span><span class="n">rbshB</span>       <span class="c">! Bare-blind front and back beam solar reflectance</span>
<a name="ln-5342"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rfshd</span><span class="p">,</span><span class="n">rbshd</span>       <span class="c">! Bare-blind front and back diffuse solar reflectance</span>
<a name="ln-5343"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">t1k</span><span class="p">,</span><span class="n">t2k</span><span class="p">,</span><span class="n">t3k</span>       <span class="c">! Back surface bare-glass beam solar transmittance for glass layers 1,2,3</span>
<a name="ln-5344"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">af2k</span><span class="p">,</span><span class="n">af3k</span>         <span class="c">! Back surface bare-glass beam solar front absorptance for glass layers 2 and 3</span>
<a name="ln-5345"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">ab1k</span><span class="p">,</span><span class="n">ab2k</span><span class="p">,</span><span class="n">ab3k</span>    <span class="c">! Back surface bare-glass beam solar back absorptance for glass layers 1,2 and 3</span>
<a name="ln-5346"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rb1k</span><span class="p">,</span><span class="n">rb2k</span>         <span class="c">! Back surface bare-glass beam solar back reflectance for glass layers 1,2</span>
<a name="ln-5347"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">td1k</span><span class="p">,</span><span class="n">td2k</span>         <span class="c">! Back surface bare-glass beam diffuse solar transmittance for glass layers 1,2</span>
<a name="ln-5348"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">afd2k</span><span class="p">,</span><span class="n">afd3k</span>       <span class="c">! Back surface bare-glass diffuse solar front absorptance for glass layer 2 and 3</span>
<a name="ln-5349"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">abd1k</span><span class="p">,</span><span class="n">abd2k</span>       <span class="c">! Back surface bare-glass diffuse solar back absorptance for glass layer 1 and 2</span>
<a name="ln-5350"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rfd2k</span><span class="p">,</span><span class="n">rfd3k</span>       <span class="c">! Back surface bare-glass diffuse solar front reflectance for glass layer 2 and 3</span>
<a name="ln-5351"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rbd1k</span><span class="p">,</span><span class="n">rbd2k</span>       <span class="c">! Back surface bare-glass diffuse solar back reflectance for glass layer 1 and 2</span>
<a name="ln-5352"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tfshBBk</span><span class="p">,</span><span class="n">tbshBBk</span>   <span class="c">! Back surface bare-blind beam-beam solar front and back transmittance</span>
<a name="ln-5353"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tfshBdk</span><span class="p">,</span><span class="n">tbshBdk</span>   <span class="c">! Back surface bare-blind beam-diffuse solar front and back transmittance</span>
<a name="ln-5354"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tfshdk</span><span class="p">,</span><span class="n">tbshdk</span>     <span class="c">! Back surface bare-blind diffuse-diffuse solar front and back transmittance</span>
<a name="ln-5355"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rfshBk</span><span class="p">,</span><span class="n">rbshBk</span>     <span class="c">! Back surface bare-blind beam solar front, back reflectance</span>
<a name="ln-5356"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">rfshdk</span><span class="p">,</span><span class="n">rbshdk</span>     <span class="c">! Back surface bare-blind diffuse solar front, back reflectance</span>
<a name="ln-5357"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">afshBk</span><span class="p">,</span><span class="n">abshBk</span>     <span class="c">! Back surface bare-blind beam solar front, back absorptance</span>
<a name="ln-5358"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">afshdk</span><span class="p">,</span><span class="n">abshdk</span>     <span class="c">! Back surface bare-blind diffuse solar front, back absorptance</span>
<a name="ln-5359"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">NGlass</span>            <span class="c">! Number of glass layers in a construction</span>
<a name="ln-5360"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">NBackGlass</span>        <span class="c">! Number of glass layers in the &quot;back&quot; construction</span>
<a name="ln-5361"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SkySolarInc</span>       <span class="c">! Incident solar radiation on a window: sky diffuse plus beam</span>
<a name="ln-5362"></a>                                    <span class="c">!   reflected from obstruction (W/m2)</span>
<a name="ln-5363"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GndSolarInc</span>       <span class="c">! Incident solar radiation on a window from the ground (W/m2)</span>
<a name="ln-5364"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SkyGndTrans</span>       <span class="c">! complex fen: transmitted ground-reflected sky radiation (W/m2)</span>
<a name="ln-5365"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BmGndTrans</span>        <span class="c">! complex fen: transmitted ground-reflected beam radiation (W/m2)</span>
<a name="ln-5366"></a>
<a name="ln-5367"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">ExtBeamAbsByShadFac</span>  <span class="c">! Factor for exterior beam radiation absorbed by shade</span>
<a name="ln-5368"></a>                                                             <span class="c">! (1/m2) (absorbed radation = beam incident * ExtBeamAbsByShad</span>
<a name="ln-5369"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">IntBeamAbsByShadFac</span>  <span class="c">! Like ExtBeamAbsByShadFac, but for interior beam radiation.</span>
<a name="ln-5370"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WinTransBmSolar</span>   <span class="c">! Factor for exterior beam solar transmitted through window,</span>
<a name="ln-5371"></a>                                                          <span class="c">! or window plus shade, into zone at current time (m2)</span>
<a name="ln-5372"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WinTransDifSolar</span>  <span class="c">! Factor for exterior diffuse solar transmitted through window,</span>
<a name="ln-5373"></a>                                                          <span class="c">! or window plus shade, into zone at current time (m2)</span>
<a name="ln-5374"></a>
<a name="ln-5375"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WinTransDifSolarGnd</span>  <span class="c">! Factor for exterior ground diffuse solar transmitted through</span>
<a name="ln-5376"></a>                                                          <span class="c">! window with horizontally-slatted blind into zone at current time (m2)</span>
<a name="ln-5377"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span><span class="p">,</span><span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">WinTransDifSolarSky</span>  <span class="c">! Factor for exterior sky diffuse solar transmitted through</span>
<a name="ln-5378"></a>                                                          <span class="c">! window with horizontally-slatted blind into zone at current time (m2)</span>
<a name="ln-5379"></a><span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span> <span class="kd">::</span> <span class="n">MustAlloc</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>  <span class="c">! True when local arrays must be allocated</span>
<a name="ln-5380"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TBmDenom</span>  <span class="c">! TBmDenominator</span>
<a name="ln-5381"></a>
<a name="ln-5382"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TBmBmShBlSc</span>            <span class="c">! Beam-beam transmittance for window with shade, blind, screen, or switchable glazing</span>
<a name="ln-5383"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TBmDifShBlSc</span>           <span class="c">! Beam-diffuse transmittance for window with shade, blind, screen, or switchable glazing</span>
<a name="ln-5384"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinTransBmBmSolar</span>      <span class="c">! Factor for exterior beam to beam solar transmitted through window,</span>
<a name="ln-5385"></a>                                    <span class="c">!  or window plus shade, into zone at current time (m2)</span>
<a name="ln-5386"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">WinTransBmDifSolar</span>     <span class="c">! Factor for exterior beam to diffuse solar transmitted through window,</span>
<a name="ln-5387"></a>                                    <span class="c">!  or window plus shade, into zone at current time (m2)</span>
<a name="ln-5388"></a>
<a name="ln-5389"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TBmBmEQL</span>               <span class="c">! Beam-beam solar transmittance for equivalent layer model window W/WO shade</span>
<a name="ln-5390"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TBmDiffEQL</span>             <span class="c">! Beam-diffuse solar transmittance for equivalent layer model window W/WO shade</span>
<a name="ln-5391"></a>
<a name="ln-5392"></a><span class="c">! Variables for complex fenestration</span>
<a name="ln-5393"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurCplxFenState</span>  <span class="c">! Current state for complex fenestration</span>
<a name="ln-5394"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurBackState</span> <span class="c">! Current state for back surface if that surface is complex fenestration</span>
<a name="ln-5395"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurTrnDir</span>  <span class="c">! Current back window surface BSDF direction</span>
<a name="ln-5396"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CurBackDir</span> <span class="c">! current hit direction to complex fenestration</span>
<a name="ln-5397"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IBm</span>  <span class="c">! Incoming direction of the Sun (for window BSDF)</span>
<a name="ln-5398"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IConst</span> <span class="c">! Current surface construction number (it depends of state too)</span>
<a name="ln-5399"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NBkSurf</span> <span class="c">! Number of back surfaces</span>
<a name="ln-5400"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BaseSurf</span> <span class="c">! Base surface number for current complex window</span>
<a name="ln-5401"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BackSurfaceNumber</span> <span class="c">! Back surface number</span>
<a name="ln-5402"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CFBoverlap</span>  <span class="c">! Sum of boverlap for each back surface</span>
<a name="ln-5403"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,</span> <span class="p">:)</span> <span class="kd">::</span> <span class="n">CFDirBoverlap</span> <span class="c">! Directional boverlap (Direction, IBack)</span>
<a name="ln-5404"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurLambda</span> <span class="c">! Current lambda value in BSDF outgoing directions</span>
<a name="ln-5405"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">DirTrans</span> <span class="c">! Current BSDF directional transmittance</span>
<a name="ln-5406"></a>                      <span class="c">! (for incoming I and outgoing J directions)</span>
<a name="ln-5407"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">bestDot</span>  <span class="c">! complex fenestration hits other complex fenestration, it is important to find</span>
<a name="ln-5408"></a>                      <span class="c">! matching beam directions.  Beam leving one window will have certaing number for it&#39;s basis</span>
<a name="ln-5409"></a>                      <span class="c">! while same beam reaching back surface will have different beam number.  This value is used</span>
<a name="ln-5410"></a>                      <span class="c">! to keep best matching dot product for those directions</span>
<a name="ln-5411"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">curDot</span>   <span class="c">! temporary variable for current dot product</span>
<a name="ln-5412"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">bestTrn</span>    <span class="c">! Direction corresponding best dot product for master window</span>
<a name="ln-5413"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">bestBackTrn</span> <span class="c">! Direction corresponding best dot product for back surface window</span>
<a name="ln-5414"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotSolidLay</span> <span class="c">! Number of window solid layers</span>
<a name="ln-5415"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tempVec1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! temporary vector for performing dot_product</span>
<a name="ln-5416"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tempVec2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! temporary vector for performing dot_product</span>
<a name="ln-5417"></a>
<a name="ln-5418"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>     <span class="c">! absorbed exterior beam radiation by layers fraction</span>
<a name="ln-5419"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolDiffEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>     <span class="c">! absorbed exterior diffuse radiation by layers fraction</span>
<a name="ln-5420"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EQLNum</span>                          <span class="c">! equivalent layer fenestration index</span>
<a name="ln-5421"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c">! absorbed interior beam radiation by layers fraction from back</span>
<a name="ln-5422"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolDiffBackEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c">! absorbed exterior diffuse radiation by layers fraction from back</span>
<a name="ln-5423"></a>
<a name="ln-5424"></a><span class="c">! scheduled surface gains local variables</span>
<a name="ln-5425"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FenSolAbsPtr</span>
<a name="ln-5426"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SurfSolIncPtr</span>
<a name="ln-5427"></a><span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">iSSG</span>  <span class="c">! scheduled surface gains counter</span>
<a name="ln-5428"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SolarIntoZone</span> <span class="c">! Solar radiation into zone to current surface</span>
<a name="ln-5429"></a>
<a name="ln-5430"></a><span class="k">IF</span> <span class="p">(</span><span class="n">MustAlloc</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5431"></a><span class="k">  ALLOCATE</span> <span class="p">(</span><span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">NumOfZones</span><span class="p">))</span>
<a name="ln-5432"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-5433"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-5434"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-5435"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinTransDifSolar</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-5436"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinTransDifSolarGnd</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-5437"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WinTransDifSolarSky</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-5438"></a>  <span class="n">MustAlloc</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5439"></a><span class="n">ENDIF</span>
<a name="ln-5440"></a>
<a name="ln-5441"></a><span class="cp">#ifdef EP_Count_Calls</span>
<a name="ln-5442"></a><span class="n">NumIntSolarDist_Calls</span><span class="o">=</span><span class="n">NumIntSolarDist_Calls</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5443"></a><span class="cp">#endif</span>
<a name="ln-5444"></a>
<a name="ln-5445"></a><span class="n">DSZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5446"></a><span class="n">DGZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5447"></a><span class="n">DBZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5448"></a><span class="n">DBZoneSSG</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5449"></a><span class="n">DBZoneIntWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5450"></a><span class="n">AISurf</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5451"></a><span class="n">AOSurf</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5452"></a><span class="n">ABWin</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5453"></a><span class="n">ABWinSh</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5454"></a><span class="n">AWinSurf</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5455"></a><span class="n">WinTransBmSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5456"></a><span class="n">WinTransDifSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5457"></a><span class="n">WinTransDifSolarGnd</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5458"></a><span class="n">WinTransDifSolarSky</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5459"></a><span class="n">WinBmSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5460"></a><span class="n">WinBmBmSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5461"></a><span class="n">WinBmDifSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5462"></a><span class="n">WinTransBmBmSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5463"></a><span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5464"></a><span class="n">TBmBm</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5465"></a><span class="n">TBmDif</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5466"></a><span class="n">TBmBmEQL</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5467"></a><span class="n">TBmDiffEQL</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5468"></a>
<a name="ln-5469"></a><span class="n">WinDifSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5470"></a><span class="n">ZoneTransSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5471"></a><span class="n">ZoneBmSolFrExtWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5472"></a><span class="n">ZoneBmSolFrIntWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5473"></a><span class="n">ZoneDifSolFrExtWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5474"></a><span class="n">ZoneDifSolFrIntWinsRep</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5475"></a><span class="n">IntBeamAbsByShadFac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5476"></a><span class="n">ExtBeamAbsByShadFac</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5477"></a><span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolTransThruIntWinRep</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5478"></a><span class="c">!energy</span>
<a name="ln-5479"></a><span class="n">WinBmSolarEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5480"></a><span class="n">WinBmBmSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5481"></a><span class="n">WinBmDifSolarEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5482"></a>
<a name="ln-5483"></a><span class="n">WinDifSolarEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5484"></a><span class="n">ZoneTransSolarEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5485"></a><span class="n">ZoneBmSolFrExtWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5486"></a><span class="n">ZoneBmSolFrIntWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5487"></a><span class="n">ZoneDifSolFrExtWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5488"></a><span class="n">ZoneDifSolFrIntWinsRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5489"></a><span class="n">SurfaceWindow</span><span class="p">%</span><span class="n">BmSolTransThruIntWinRepEnergy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-5490"></a>
<a name="ln-5491"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-5492"></a>
<a name="ln-5493"></a>  <span class="n">BTOTZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5494"></a>  <span class="n">BABSZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5495"></a>
<a name="ln-5496"></a>        <span class="c">! Loop over exterior surfaces in this zone</span>
<a name="ln-5497"></a>
<a name="ln-5498"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-5499"></a>    <span class="k">IF</span> <span class="p">(</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5500"></a>          <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5501"></a>         <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5502"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5503"></a>    <span class="c">! TH added 3/24/2010 while debugging CR 7872</span>
<a name="ln-5504"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5505"></a><span class="k">    </span><span class="n">ConstrNum</span>   <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-5506"></a>    <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-5507"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5508"></a><span class="k">      </span><span class="n">ConstrNum</span>   <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-5509"></a>      <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span>
<a name="ln-5510"></a>    <span class="k">END IF</span>
<a name="ln-5511"></a><span class="k">    </span><span class="n">BlNum</span>       <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-5512"></a>    <span class="n">ScNum</span>       <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScreenNumber</span>
<a name="ln-5513"></a>    <span class="n">ShadeFlag</span>   <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span>  <span class="c">! Set in subr. WindowShadingManager</span>
<a name="ln-5514"></a>    <span class="n">ProfAng</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5515"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">ExtScreenOn</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">BlNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SOLCOS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-5516"></a>    <span class="n">SlatAng</span>     <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span>
<a name="ln-5517"></a>    <span class="n">VarSlats</span>    <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span>
<a name="ln-5518"></a>
<a name="ln-5519"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5520"></a><span class="k">      </span><span class="n">PipeNum</span> <span class="o">=</span> <span class="n">FindTDDPipe</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-5521"></a>      <span class="n">SurfNum2</span> <span class="o">=</span> <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">Dome</span>
<a name="ln-5522"></a>    <span class="k">ELSE</span>
<a name="ln-5523"></a><span class="k">      </span><span class="n">SurfNum2</span> <span class="o">=</span> <span class="n">SurfNum</span>
<a name="ln-5524"></a>    <span class="k">END IF</span>
<a name="ln-5525"></a>
<a name="ln-5526"></a><span class="k">    </span><span class="n">ShelfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Shelf</span>
<a name="ln-5527"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ShelfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Daylighting shelf</span>
<a name="ln-5528"></a>      <span class="n">InShelfSurf</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">InSurf</span>
<a name="ln-5529"></a>      <span class="n">OutShelfSurf</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutSurf</span>
<a name="ln-5530"></a>    <span class="k">ELSE</span>
<a name="ln-5531"></a><span class="k">      </span><span class="n">InShelfSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5532"></a>      <span class="n">OutShelfSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5533"></a>    <span class="k">END IF</span>
<a name="ln-5534"></a>
<a name="ln-5535"></a><span class="k">    </span><span class="n">CosInc</span> <span class="o">=</span> <span class="n">CosIncAng</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-5536"></a>    <span class="n">SunLitFract</span> <span class="o">=</span> <span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-5537"></a>
<a name="ln-5538"></a>        <span class="c">!-------------------------------------------------------------------------</span>
<a name="ln-5539"></a>        <span class="c">! EXTERIOR BEAM SOLAR RADIATION ABSORBED ON THE OUTSIDE OF OPAQUE SURFACES</span>
<a name="ln-5540"></a>        <span class="c">!-------------------------------------------------------------------------</span>
<a name="ln-5541"></a>
<a name="ln-5542"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunLitFract</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5543"></a><span class="k">      </span><span class="n">AOSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">OutsideAbsorpSolar</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span>
<a name="ln-5544"></a>
<a name="ln-5545"></a>      <span class="c">! Note: movable insulation, if present, is accounted for in subr. InitIntSolarDistribution,</span>
<a name="ln-5546"></a>      <span class="c">! where QRadSWOutMvIns is calculated from QRadSWOutAbs and insulation solar absorptance</span>
<a name="ln-5547"></a>
<a name="ln-5548"></a>    <span class="k">END IF</span>
<a name="ln-5549"></a>
<a name="ln-5550"></a>        <span class="c">!-------------------------------------------------------------------------------------------</span>
<a name="ln-5551"></a>        <span class="c">! EXTERIOR BEAM AND DIFFUSE SOLAR RADIATION ABSORBED IN THE GLASS LAYERS OF EXTERIOR WINDOWS</span>
<a name="ln-5552"></a>        <span class="c">!-------------------------------------------------------------------------------------------</span>
<a name="ln-5553"></a>
<a name="ln-5554"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5555"></a>
<a name="ln-5556"></a>    <span class="c">! Somewhat of a kludge</span>
<a name="ln-5557"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5558"></a>      <span class="n">SunlitFracWithoutReveal</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">=</span> <span class="n">SunLitFract</span> <span class="c">! Frames/dividers not allowed</span>
<a name="ln-5559"></a>
<a name="ln-5560"></a>    <span class="n">WinTransBmBmSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5561"></a>    <span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5562"></a>
<a name="ln-5563"></a>    <span class="n">InOutProjSLFracMult</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InOutProjSLFracMult</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-5564"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunlitFracWithoutReveal</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5565"></a>
<a name="ln-5566"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowBSDFModel</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5567"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5568"></a>
<a name="ln-5569"></a>        <span class="c">! For bare glazing or switchable glazing, the following includes the effects of</span>
<a name="ln-5570"></a>        <span class="c">! (1) diffuse solar produced by beam solar incident on the outside and inside reveal</span>
<a name="ln-5571"></a>        <span class="c">! surfaces, and (2) absorption of beam solar by outside and inside reveal surfaces.</span>
<a name="ln-5572"></a>        <span class="c">! If there is an exterior shade/blind both of these effects are ignored. If there</span>
<a name="ln-5573"></a>        <span class="c">! is an interior or between-glass shade/blind the effects of beam incident on</span>
<a name="ln-5574"></a>        <span class="c">! inside reveal surfaces is ignored.</span>
<a name="ln-5575"></a>
<a name="ln-5576"></a>        <span class="n">NGlass</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-5577"></a>
<a name="ln-5578"></a>        <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NGlass</span>
<a name="ln-5579"></a>          <span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsBeamCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5580"></a>                            <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutProjSLFracMult</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-5581"></a>          <span class="n">ADiffWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5582"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5583"></a>
<a name="ln-5584"></a>                                   <span class="c">! Bare window (ShadeFlag = -1 or 0 or shading device of off)</span>
<a name="ln-5585"></a>
<a name="ln-5586"></a>            <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5587"></a>               <span class="c">! Add contribution of beam reflected from outside and inside reveal</span>
<a name="ln-5588"></a>              <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5589"></a>              <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5590"></a>
<a name="ln-5591"></a>          <span class="k">ELSE</span>
<a name="ln-5592"></a>
<a name="ln-5593"></a>                                   <span class="c">! Shade, screen, blind or switchable glazing on (ShadeFlag &gt; 0)</span>
<a name="ln-5594"></a>
<a name="ln-5595"></a>            <span class="n">FracSunLit</span> <span class="o">=</span> <span class="n">SunLitFract</span><span class="o">*</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutProjSLFracMult</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-5596"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="n">FracSunLit</span> <span class="o">=</span> <span class="n">SunLitFract</span>
<a name="ln-5597"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5598"></a>
<a name="ln-5599"></a>                                   <span class="c">! Shade or switchable glazing on</span>
<a name="ln-5600"></a>
<a name="ln-5601"></a>              <span class="n">ABWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsBeamCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span>
<a name="ln-5602"></a>
<a name="ln-5603"></a>              <span class="n">ADiffWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5604"></a>
<a name="ln-5605"></a>            <span class="k">ELSE</span>
<a name="ln-5606"></a>                                   <span class="c">! Blind or screen on</span>
<a name="ln-5607"></a>
<a name="ln-5608"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">Lay</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">/=</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">SOLCOS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-5609"></a>
<a name="ln-5610"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5611"></a>
<a name="ln-5612"></a>                                   <span class="c">! Interior blind on</span>
<a name="ln-5613"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5614"></a><span class="k">                  </span><span class="n">TGlBm</span>          <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5615"></a>                  <span class="n">RGlDiffBack</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-5616"></a>                  <span class="n">RhoBlFront</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffRefl</span><span class="p">)</span>
<a name="ln-5617"></a>                  <span class="n">RhoBlDiffFront</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5618"></a>                <span class="k">END IF</span>
<a name="ln-5619"></a><span class="k">                </span><span class="n">AGlDiffBack</span>     <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5620"></a>                <span class="n">ABWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>    <span class="o">=</span> <span class="n">AbWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">TGlBm</span><span class="o">*</span><span class="n">AGlDiffBack</span><span class="o">*</span><span class="n">RhoBlFront</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RhoBlFront</span><span class="o">*</span><span class="n">RGlDiffBack</span><span class="p">))</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5621"></a>                  <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span>
<a name="ln-5622"></a>                <span class="n">ADiffWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ADiffWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span><span class="o">*</span><span class="n">AGlDiffBack</span><span class="o">*</span><span class="n">RhoBlDiffFront</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5623"></a>                                                      <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RhoBlDiffFront</span><span class="o">*</span><span class="n">RGlDiffBack</span><span class="p">)</span>
<a name="ln-5624"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5625"></a>
<a name="ln-5626"></a>                                   <span class="c">! Exterior blind on</span>
<a name="ln-5627"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5628"></a><span class="k">                  </span><span class="n">TBlBmBm</span>       <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5629"></a>                                               <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-5630"></a>                  <span class="n">TBlBmDiff</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffTrans</span><span class="p">)</span>
<a name="ln-5631"></a>                  <span class="n">RhoBlBack</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-5632"></a>                  <span class="n">RhoBlDiffBack</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5633"></a>                  <span class="n">RGlFront</span>      <span class="o">=</span>  <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5634"></a>                  <span class="n">RGlDiffFront</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-5635"></a>                  <span class="n">TBlDifDif</span>     <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffTrans</span><span class="p">)</span>
<a name="ln-5636"></a>                  <span class="n">RGlDifFr</span>      <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-5637"></a>                  <span class="n">RhoBlDifDifBk</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5638"></a>                <span class="k">END IF</span>
<a name="ln-5639"></a><span class="k">                </span><span class="n">AGlDiffFront</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5640"></a>                <span class="n">ABWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">TBlBmBm</span><span class="o">*</span><span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">TBlBmBm</span><span class="o">*</span><span class="n">RGlFront</span><span class="o">*</span><span class="n">RhoBlBack</span> <span class="o">+</span> <span class="n">TBlBmDiff</span><span class="p">)</span> <span class="o">*</span> <span class="n">AGlDiffFront</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5641"></a>                  <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">RGlDiffFront</span><span class="o">*</span><span class="n">RhoBlDiffBack</span><span class="p">))</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span>
<a name="ln-5642"></a>                <span class="c">!ADiffWinSh(Lay) = 0.0  ! Assumes no contribution from reveal reflection when exterior blind in place</span>
<a name="ln-5643"></a>                <span class="c">!  Replaced above line with (FCW, 2/10/03):</span>
<a name="ln-5644"></a>                <span class="n">ADiffWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ADiffWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">*</span> <span class="n">TBlDifDif</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RGlDifFr</span><span class="o">*</span><span class="n">RhoBlDifDifBk</span><span class="p">)</span>
<a name="ln-5645"></a>
<a name="ln-5646"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5647"></a>
<a name="ln-5648"></a>                                   <span class="c">! Exterior screen on</span>
<a name="ln-5649"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5650"></a><span class="k">                  </span><span class="n">TScBmBm</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">BmBmTrans</span>
<a name="ln-5651"></a>                  <span class="n">TScBmDiff</span>     <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">BmDifTrans</span>
<a name="ln-5652"></a>                  <span class="n">RScBack</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">ReflectSolBeamFront</span>
<a name="ln-5653"></a>                  <span class="n">RScDifBack</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">DifReflect</span>
<a name="ln-5654"></a>                  <span class="n">RGlFront</span>      <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5655"></a>                  <span class="n">RGlDiffFront</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-5656"></a>                  <span class="n">TScDifDif</span>     <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">DifDifTrans</span>
<a name="ln-5657"></a>                  <span class="n">RGlDifFr</span>      <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-5658"></a>                <span class="k">END IF</span>
<a name="ln-5659"></a><span class="k">                </span><span class="n">AGlDiffFront</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5660"></a>
<a name="ln-5661"></a>  <span class="c">!             Reduce the bare window absorbed beam by the screen beam transmittance and then account for interreflections</span>
<a name="ln-5662"></a>                <span class="n">ABWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">TScBmBm</span><span class="o">*</span><span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">TScBmBm</span><span class="o">*</span><span class="n">RGlFront</span><span class="o">*</span><span class="n">RScBack</span> <span class="o">+</span> <span class="n">TScBmDiff</span><span class="p">)</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-5663"></a>                                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RGlDiffFront</span><span class="o">*</span><span class="n">RScDifBack</span><span class="p">)</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span>
<a name="ln-5664"></a>
<a name="ln-5665"></a>                <span class="n">ADiffWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ADiffWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">*</span> <span class="n">TScDifDif</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RGlDifFr</span><span class="o">*</span><span class="n">RScDifBack</span><span class="p">)</span>
<a name="ln-5666"></a>
<a name="ln-5667"></a>              <span class="k">ELSE</span>
<a name="ln-5668"></a>                                   <span class="c">! Between-glass blind on</span>
<a name="ln-5669"></a>
<a name="ln-5670"></a>                <span class="c">! Isolated glass and blind properties at current incidence angle, profile angle and slat angle</span>
<a name="ln-5671"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5672"></a><span class="k">                  </span><span class="n">t1</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5673"></a>                  <span class="n">t2</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5674"></a>                  <span class="n">af1</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">afBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5675"></a>                  <span class="n">af2</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">afBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5676"></a>                  <span class="n">ab1</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">abBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5677"></a>                  <span class="n">ab2</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">abBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5678"></a>                  <span class="n">rf1</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rfBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5679"></a>                  <span class="n">rf2</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rfBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5680"></a>                  <span class="n">rb1</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rbBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5681"></a>                  <span class="n">rb2</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rbBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5682"></a>                  <span class="n">td1</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">tBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5683"></a>                  <span class="n">td2</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">tBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5684"></a>                  <span class="n">afd1</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">afBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5685"></a>                  <span class="n">afd2</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">afBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5686"></a>                  <span class="n">abd1</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">abBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5687"></a>                  <span class="n">abd2</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">abBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5688"></a>                  <span class="n">rfd1</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rfBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5689"></a>                  <span class="n">rfd2</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rfBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5690"></a>                  <span class="n">rbd1</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rbBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5691"></a>                  <span class="n">rbd2</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rbBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5692"></a>                  <span class="n">tfshBB</span> <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5693"></a>                                    <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-5694"></a>                  <span class="n">tfshBd</span> <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffTrans</span><span class="p">)</span>
<a name="ln-5695"></a>                  <span class="n">tfshd</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffTrans</span><span class="p">)</span>
<a name="ln-5696"></a>                  <span class="n">tbshBB</span> <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">PI</span><span class="o">-</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5697"></a>                                    <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-5698"></a>                  <span class="n">tbshBd</span> <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamDiffTrans</span><span class="p">)</span>
<a name="ln-5699"></a>                  <span class="n">tbshd</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffDiffTrans</span><span class="p">)</span>
<a name="ln-5700"></a>                  <span class="n">afshB</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamAbs</span><span class="p">)</span>
<a name="ln-5701"></a>                  <span class="n">abshB</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamAbs</span><span class="p">)</span>
<a name="ln-5702"></a>                  <span class="n">afshd</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffAbs</span><span class="p">)</span>
<a name="ln-5703"></a>                  <span class="n">abshd</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffAbs</span><span class="p">)</span>
<a name="ln-5704"></a>                  <span class="n">rfshB</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffRefl</span><span class="p">)</span>
<a name="ln-5705"></a>                  <span class="n">rbshB</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-5706"></a>                  <span class="n">rfshd</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5707"></a>                  <span class="n">rbshd</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5708"></a>                <span class="k">END IF</span>
<a name="ln-5709"></a>
<a name="ln-5710"></a><span class="k">                IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mf">1.</span><span class="nb">AND</span><span class="p">.</span><span class="n">NGlass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5711"></a><span class="k">                  </span><span class="n">t1t2</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span>
<a name="ln-5712"></a>                  <span class="n">td1td2</span> <span class="o">=</span> <span class="n">td1</span><span class="o">*</span><span class="n">td2</span>
<a name="ln-5713"></a>                  <span class="n">t3</span>   <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5714"></a>                  <span class="n">af3</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">afBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5715"></a>                  <span class="n">ab3</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">abBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5716"></a>                  <span class="n">rf3</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rfBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5717"></a>                  <span class="n">rb3</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rbBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5718"></a>                  <span class="n">td3</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">tBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5719"></a>                  <span class="n">afd3</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">afBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5720"></a>                  <span class="n">abd3</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">abBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5721"></a>                  <span class="n">rfd3</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rfBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5722"></a>                  <span class="n">rbd3</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">rbBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-5723"></a>                <span class="k">END IF</span>
<a name="ln-5724"></a>
<a name="ln-5725"></a><span class="k">                IF</span><span class="p">(</span><span class="n">NGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5726"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5727"></a><span class="k">                    </span><span class="n">ABWinSh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span> <span class="o">*</span> <span class="p">(</span><span class="n">af1</span> <span class="o">+</span> <span class="n">t1</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">rf2</span><span class="o">*</span><span class="n">tbshBB</span><span class="o">*</span><span class="n">ab1</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5728"></a>                         <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">rfshB</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">rfshd</span> <span class="o">+</span> <span class="n">tfshBB</span><span class="o">*</span><span class="n">rf2</span><span class="o">*</span><span class="n">tbshBd</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="n">rfd2</span><span class="o">*</span><span class="n">tbshd</span><span class="p">)</span><span class="o">*</span><span class="n">abd1</span><span class="p">)</span>
<a name="ln-5729"></a>                    <span class="n">ADiffWinSh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">afd1</span> <span class="o">+</span> <span class="n">td1</span><span class="o">*</span><span class="p">(</span><span class="n">rfshd</span> <span class="o">+</span> <span class="n">rfshd</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">rfshd</span> <span class="o">+</span> <span class="n">tfshd</span><span class="o">*</span><span class="n">rfd2</span><span class="o">*</span><span class="n">tbshd</span><span class="p">)</span><span class="o">*</span><span class="n">abd1</span>
<a name="ln-5730"></a>                  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5731"></a><span class="k">                    </span><span class="n">ABWinSh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>    <span class="o">=</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="n">rfshB</span><span class="o">*</span><span class="n">af2</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5732"></a>                         <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">rfshB</span><span class="o">*</span><span class="n">rf2</span><span class="o">*</span><span class="n">rbshd</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rfd2</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">tfshd</span><span class="p">)</span><span class="o">*</span><span class="n">afd2</span><span class="p">)</span>
<a name="ln-5733"></a>                    <span class="n">ADiffWinSh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">td1</span><span class="o">*</span><span class="p">(</span><span class="n">tfshd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rfd2</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshd</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">tfshd</span><span class="p">)</span><span class="o">*</span><span class="n">afd2</span>
<a name="ln-5734"></a>                  <span class="k">END IF</span>
<a name="ln-5735"></a><span class="k">                END IF</span>  <span class="c">! End of check if NGlass = 2</span>
<a name="ln-5736"></a>
<a name="ln-5737"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NGlass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5738"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5739"></a><span class="k">                    </span><span class="n">ABWinSh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="o">=</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span> <span class="o">*</span> <span class="p">(</span><span class="n">af1</span> <span class="o">+</span> <span class="n">t1</span><span class="o">*</span><span class="n">rf2</span><span class="o">*</span><span class="n">ab1</span> <span class="o">+</span> <span class="n">t1t2</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">rf3</span><span class="o">*</span><span class="n">tbshBB</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="n">ab1</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5740"></a>                           <span class="n">t1t2</span><span class="o">*</span><span class="p">(</span><span class="n">rfshB</span><span class="o">*</span><span class="n">td2</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd2</span><span class="o">*</span><span class="n">rfshd</span><span class="o">*</span><span class="n">td2</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="n">rfd3</span><span class="o">*</span><span class="n">tbshd</span><span class="o">*</span><span class="n">td2</span><span class="p">)</span><span class="o">*</span><span class="n">abd1</span><span class="p">)</span>
<a name="ln-5741"></a>                    <span class="n">ADiffWinSh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">afd1</span> <span class="o">+</span> <span class="n">td1</span><span class="o">*</span><span class="n">rbd2</span><span class="o">*</span><span class="n">abd1</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5742"></a>                           <span class="n">td1td2</span><span class="o">*</span><span class="p">(</span><span class="n">rfshd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rbd2</span><span class="o">*</span><span class="n">rfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">rfshd</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5743"></a>                           <span class="n">tfshd</span><span class="o">*</span><span class="p">(</span><span class="n">rfd3</span><span class="o">*</span><span class="n">tbshd</span> <span class="o">+</span> <span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="o">*</span><span class="n">rfd3</span><span class="o">*</span><span class="n">tbshd</span><span class="p">))</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">abd1</span>
<a name="ln-5744"></a>                  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5745"></a><span class="k">                    </span><span class="n">ABWinSh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>    <span class="o">=</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="n">af2</span> <span class="o">+</span> <span class="n">t1t2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">rf3</span><span class="o">*</span><span class="n">tbshBB</span><span class="o">*</span><span class="n">ab2</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">afd2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5746"></a>                           <span class="n">t1t2</span><span class="o">*</span><span class="p">(</span><span class="n">rfshB</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rbd2</span><span class="o">*</span><span class="n">rfshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">tfshBB</span><span class="o">*</span><span class="n">rf3</span><span class="o">*</span><span class="n">tbshBd</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="n">rfd3</span><span class="o">*</span><span class="n">tbshd</span><span class="p">)</span><span class="o">*</span><span class="n">abd2</span><span class="p">)</span>
<a name="ln-5747"></a>                    <span class="n">ADiffWinSh</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">td1</span><span class="o">*</span><span class="n">afd2</span> <span class="o">+</span> <span class="n">td1td2</span><span class="o">*</span><span class="n">rfshd</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">afd2</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5748"></a>                           <span class="n">td1td2</span><span class="o">*</span><span class="p">(</span><span class="n">rfshd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rbd2</span><span class="o">*</span><span class="n">rfshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">tfshd</span><span class="o">*</span><span class="n">rfd3</span><span class="o">*</span><span class="n">tbshd</span><span class="p">)</span><span class="o">*</span><span class="n">abd2</span>
<a name="ln-5749"></a>                  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Lay</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5750"></a><span class="k">                    </span><span class="n">ABWinSh</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">FracSunLit</span> <span class="o">*</span> <span class="p">(</span><span class="n">t1t2</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">af3</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5751"></a>                           <span class="n">t1t2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">rf3</span><span class="o">*</span><span class="n">rbshB</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span><span class="o">*</span><span class="n">tfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">tfshd</span><span class="p">))</span><span class="o">*</span><span class="n">afd3</span><span class="p">)</span>
<a name="ln-5752"></a>                    <span class="n">ADiffWinSh</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">td1td2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshd</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span><span class="o">*</span><span class="n">tfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">tfshd</span><span class="p">))</span><span class="o">*</span><span class="n">afd3</span>
<a name="ln-5753"></a>                  <span class="k">END IF</span>
<a name="ln-5754"></a><span class="k">                END IF</span>  <span class="c">! End of check if NGlass = 3</span>
<a name="ln-5755"></a>
<a name="ln-5756"></a>              <span class="k">END IF</span>  <span class="c">! End of check if blind is interior, exterior or between-glass</span>
<a name="ln-5757"></a>            <span class="k">END IF</span>  <span class="c">! End of check if a blind is on</span>
<a name="ln-5758"></a>
<a name="ln-5759"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5760"></a>
<a name="ln-5761"></a>                                    <span class="c">! Interior or between glass shade or blind on</span>
<a name="ln-5762"></a>
<a name="ln-5763"></a>              <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ABWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5764"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5765"></a>                  <span class="c">! Add contribution of diffuse from beam on outside reveal</span>
<a name="ln-5766"></a>                 <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-5767"></a>                      <span class="n">ADiffWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span>
<a name="ln-5768"></a>
<a name="ln-5769"></a>            <span class="k">ELSE</span>
<a name="ln-5770"></a>                                    <span class="c">! Switchable glazing</span>
<a name="ln-5771"></a>
<a name="ln-5772"></a>              <span class="n">SwitchFac</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span>
<a name="ln-5773"></a>              <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">),</span><span class="n">ABWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">))</span>
<a name="ln-5774"></a>                 <span class="c">! Add contribution of diffuse from beam on outside and inside reveal</span>
<a name="ln-5775"></a>              <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5776"></a>                  <span class="n">InterpSW</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">ADiffWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">),</span><span class="n">ADiffWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5777"></a>                    <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5778"></a>                  <span class="n">InterpSW</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5779"></a>                    <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span>
<a name="ln-5780"></a>            <span class="k">END IF</span>
<a name="ln-5781"></a><span class="k">          END IF</span>  <span class="c">! End of check if window has shading device</span>
<a name="ln-5782"></a>        <span class="k">END DO</span>  <span class="c">! End of loop over window glass layers</span>
<a name="ln-5783"></a>
<a name="ln-5784"></a>            <span class="c">!-----------------------------------------</span>
<a name="ln-5785"></a>            <span class="c">! EXTERIOR BEAM ABSORBED BY SHADING DEVICE</span>
<a name="ln-5786"></a>            <span class="c">!-----------------------------------------</span>
<a name="ln-5787"></a>
<a name="ln-5788"></a>            <span class="c">! Exterior beam absorbed by INTERIOR SHADE</span>
<a name="ln-5789"></a>
<a name="ln-5790"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5791"></a>          <span class="c">! Note that AbsBeamShadeCoef includes effect of shade/glazing inter-reflection</span>
<a name="ln-5792"></a>          <span class="n">AbsShade</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsBeamShadeCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5793"></a>          <span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="n">AbsShade</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span> <span class="p">&amp;</span>
<a name="ln-5794"></a>
<a name="ln-5795"></a>             <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffShade</span> <span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5796"></a>                  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-5797"></a>          <span class="c">! In the above, GlazedFrac corrects for shadowing of divider onto interior shade</span>
<a name="ln-5798"></a>        <span class="k">END IF</span>
<a name="ln-5799"></a>
<a name="ln-5800"></a>            <span class="c">! Exterior beam absorbed by EXTERIOR SHADE</span>
<a name="ln-5801"></a>
<a name="ln-5802"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5803"></a><span class="k">          </span><span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5804"></a>                <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffShade</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span>
<a name="ln-5805"></a>
<a name="ln-5806"></a>        <span class="k">END IF</span>
<a name="ln-5807"></a>
<a name="ln-5808"></a>            <span class="c">! Exterior beam absorbed by BETWEEN-GLASS SHADE</span>
<a name="ln-5809"></a>
<a name="ln-5810"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">BGShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5811"></a><span class="k">          </span><span class="n">AbsShade</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsBeamShadeCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5812"></a>          <span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbsShade</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5813"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffShade</span>
<a name="ln-5814"></a>        <span class="k">END IF</span>
<a name="ln-5815"></a>
<a name="ln-5816"></a>            <span class="c">! Exterior beam absorbed by INTERIOR BLIND</span>
<a name="ln-5817"></a>
<a name="ln-5818"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5819"></a><span class="k">          </span><span class="n">TBmBm</span>          <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5820"></a>          <span class="n">RGlDiffBack</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-5821"></a>          <span class="n">RhoBlFront</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffRefl</span><span class="p">)</span>
<a name="ln-5822"></a>          <span class="n">AbsBlFront</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamAbs</span><span class="p">)</span>
<a name="ln-5823"></a>          <span class="n">RhoBlDiffFront</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5824"></a>          <span class="n">AbsBlDiffFront</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffAbs</span><span class="p">)</span>
<a name="ln-5825"></a>          <span class="n">AbsShade</span>       <span class="o">=</span> <span class="n">TBmBm</span> <span class="o">*</span> <span class="p">(</span><span class="n">AbsBlFront</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5826"></a>            <span class="n">RhoBlFront</span><span class="o">*</span><span class="n">RGlDiffBAck</span><span class="o">*</span><span class="n">AbsBlDiffFront</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RhoBlDiffFront</span><span class="o">*</span><span class="n">RGlDiffBack</span><span class="p">))</span>
<a name="ln-5827"></a>          <span class="n">AbsShadeDiff</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">*</span> <span class="p">(</span><span class="n">AbsBlDiffFront</span> <span class="o">+</span> <span class="n">RhoBlDiffFront</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5828"></a>            <span class="n">RGlDiffBAck</span><span class="o">*</span><span class="n">AbsBlDiffFront</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RhoBlDiffFront</span><span class="o">*</span><span class="n">RGlDiffBack</span><span class="p">))</span>
<a name="ln-5829"></a>          <span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="n">AbsShade</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span> <span class="p">&amp;</span>
<a name="ln-5830"></a>
<a name="ln-5831"></a>            <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">AbsShadeDiff</span> <span class="p">)</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-5832"></a>                <span class="c">! In the above, GlazedFrac corrects for shadowing of divider onto interior blind</span>
<a name="ln-5833"></a>        <span class="k">END IF</span>
<a name="ln-5834"></a>
<a name="ln-5835"></a>          <span class="c">! Exterior beam absorbed by EXTERIOR BLIND</span>
<a name="ln-5836"></a>
<a name="ln-5837"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5838"></a><span class="k">          </span><span class="n">TBlBmBm</span>       <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5839"></a>                                       <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-5840"></a>          <span class="n">RGlFront</span>      <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5841"></a>          <span class="n">AbsBlFront</span>    <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamAbs</span><span class="p">)</span>
<a name="ln-5842"></a>          <span class="n">AbsBlBack</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamAbs</span><span class="p">)</span>
<a name="ln-5843"></a>          <span class="n">AbsBlDiffBack</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffAbs</span><span class="p">)</span>
<a name="ln-5844"></a>          <span class="n">RGlDiffFront</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-5845"></a>          <span class="n">RhoBlDiffBack</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-5846"></a>          <span class="n">RhoBlBack</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-5847"></a>          <span class="n">TBlBmDiff</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffTrans</span><span class="p">)</span>
<a name="ln-5848"></a>          <span class="n">AbsShade</span>      <span class="o">=</span> <span class="n">AbsBlFront</span> <span class="o">+</span> <span class="n">AbsBlBack</span> <span class="o">*</span> <span class="n">RGlFront</span> <span class="o">*</span> <span class="n">TBlBmBm</span> <span class="p">&amp;</span>
<a name="ln-5849"></a>                            <span class="o">+</span> <span class="p">(</span><span class="n">AbsBlDiffBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RhoBlDiffBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="p">))</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5850"></a>                              <span class="p">(</span><span class="n">RGlFront</span><span class="o">*</span><span class="n">TBlBmBm</span><span class="o">*</span><span class="n">RhoBlBack</span> <span class="o">+</span> <span class="n">TBlBmDiff</span><span class="p">)</span>
<a name="ln-5851"></a>          <span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbsShade</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-5852"></a>
<a name="ln-5853"></a>        <span class="k">END IF</span>
<a name="ln-5854"></a>
<a name="ln-5855"></a>          <span class="c">! Exterior beam absorbed by EXTERIOR SCREEN</span>
<a name="ln-5856"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5857"></a><span class="k">          </span><span class="n">TScBmBm</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScreenNumber</span><span class="p">)%</span><span class="n">BmBmTrans</span>
<a name="ln-5858"></a>  <span class="c">!        TScBmDiff     = SurfaceScreens(SurfaceWindow(SurfNum)%ScreenNumber)%BmDifTrans</span>
<a name="ln-5859"></a>          <span class="n">RGlFront</span>      <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-5860"></a>          <span class="n">RGlDiffFront</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-5861"></a>
<a name="ln-5862"></a>          <span class="n">AbsScBeam</span>     <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">AbsorpSolarBeamFront</span>
<a name="ln-5863"></a>          <span class="n">AbsScDiffBack</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">DifScreenAbsorp</span>
<a name="ln-5864"></a>          <span class="n">RScDifBack</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">DifReflect</span>
<a name="ln-5865"></a>          <span class="n">RScBack</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">ReflectSolBeamFront</span>
<a name="ln-5866"></a>
<a name="ln-5867"></a>          <span class="n">AbsScreen</span>      <span class="o">=</span> <span class="n">AbsScBeam</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">TScBmBm</span> <span class="o">*</span> <span class="n">RGlFront</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-5868"></a>                         <span class="p">(</span><span class="n">AbsScDiffBack</span><span class="o">*</span><span class="n">TScBmBm</span><span class="o">*</span><span class="n">RGlFront</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="o">*</span><span class="n">RScBack</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RScDifBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="p">))</span>
<a name="ln-5869"></a>
<a name="ln-5870"></a>          <span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbsScreen</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-5871"></a>
<a name="ln-5872"></a>        <span class="k">END IF</span>
<a name="ln-5873"></a>
<a name="ln-5874"></a>          <span class="c">! Exterior beam absorbed by BETWEEN-GLASS BLIND</span>
<a name="ln-5875"></a>
<a name="ln-5876"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5877"></a><span class="k">          IF</span><span class="p">(</span><span class="n">NGlass</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5878"></a><span class="k">            </span><span class="n">AbsShade</span>     <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">afshB</span> <span class="o">+</span> <span class="n">tfshBB</span><span class="o">*</span><span class="n">rf2</span><span class="o">*</span><span class="n">abshB</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="n">rfd2</span><span class="o">*</span><span class="n">abshd</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">afshd</span><span class="p">)</span>
<a name="ln-5879"></a>            <span class="n">AbsShadeDiff</span> <span class="o">=</span> <span class="n">td1</span><span class="o">*</span><span class="p">(</span><span class="n">afshd</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rfshd</span><span class="o">*</span><span class="n">rbd1</span><span class="p">)</span> <span class="o">+</span> <span class="n">tfshd</span><span class="o">*</span><span class="n">rfd2</span><span class="o">*</span><span class="n">abshd</span><span class="p">)</span>
<a name="ln-5880"></a>          <span class="k">ELSE IF</span><span class="p">(</span><span class="n">NGlass</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5881"></a><span class="k">            </span><span class="n">AbsShade</span>     <span class="o">=</span> <span class="n">t1t2</span><span class="o">*</span><span class="p">(</span><span class="n">afshB</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tfshBB</span><span class="o">*</span><span class="n">rf3</span><span class="p">)</span> <span class="o">+</span> <span class="n">afshd</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBd</span><span class="o">*</span><span class="n">rfd3</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="p">)))</span>
<a name="ln-5882"></a>            <span class="n">AbsShadeDiff</span> <span class="o">=</span> <span class="n">td1td2</span><span class="o">*</span><span class="p">(</span><span class="n">afshd</span> <span class="o">+</span> <span class="n">tfshd</span><span class="o">*</span><span class="n">rfd3</span><span class="o">*</span><span class="n">abshd</span> <span class="o">+</span> <span class="n">rfshd</span><span class="o">*</span><span class="p">(</span><span class="n">rfd2</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd2</span><span class="o">*</span><span class="n">td2</span><span class="p">)</span><span class="o">*</span><span class="n">afshd</span><span class="p">)</span>
<a name="ln-5883"></a>          <span class="k">END IF</span>
<a name="ln-5884"></a><span class="k">          </span><span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span>  <span class="n">AbsShade</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span> <span class="p">&amp;</span>
<a name="ln-5885"></a>                                            <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">AbsShadeDiff</span>
<a name="ln-5886"></a>        <span class="k">END IF</span>  <span class="c">! End of check if between-glass blind</span>
<a name="ln-5887"></a>
<a name="ln-5888"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5889"></a>
<a name="ln-5890"></a><span class="k">        </span><span class="n">FenSolAbsPtr</span> <span class="o">=</span> <span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-5891"></a>
<a name="ln-5892"></a>        <span class="c">! Do not read from schedule file here since this will be called only if direct beam is hitting the window and schedule</span>
<a name="ln-5893"></a>        <span class="c">! will not be loaded in that case even if diffuse part of solar radiation is entering through the window</span>
<a name="ln-5894"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FenSolAbsPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5895"></a>          <span class="c">! Put in the equivalent layer absorptions</span>
<a name="ln-5896"></a>          <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5897"></a>               <span class="p">%</span><span class="n">NLayers</span>
<a name="ln-5898"></a>            <span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>    <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span> <span class="p">&amp;</span>
<a name="ln-5899"></a>                  <span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span><span class="p">)%</span><span class="n">WinBmFtAbs</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5900"></a>                           <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutProjSLFracMult</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">)</span>
<a name="ln-5901"></a>
<a name="ln-5902"></a>              <span class="c">! Add contribution of beam reflected from outside and inside reveal</span>
<a name="ln-5903"></a>            <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">ABWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5904"></a>                  <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5905"></a>                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span> <span class="p">&amp;</span>
<a name="ln-5906"></a>                          <span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span><span class="p">)%</span><span class="n">WinFtHemAbs</span><span class="p">(</span><span class="n">Lay</span><span class="p">)&amp;</span>
<a name="ln-5907"></a>                  <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5908"></a>                      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span> <span class="p">&amp;</span>
<a name="ln-5909"></a>                          <span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span><span class="p">)%</span><span class="n">WinBkHemAbs</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5910"></a>          <span class="k">END DO</span>
<a name="ln-5911"></a><span class="k">        END IF</span>
<a name="ln-5912"></a>
<a name="ln-5913"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5914"></a>        <span class="c">! call the ASHWAT fenestration model for optical properties</span>
<a name="ln-5915"></a>        <span class="c">! determine the beam radiation absorptance and tranmittance of the</span>
<a name="ln-5916"></a>        <span class="c">! the equivalent layer window model</span>
<a name="ln-5917"></a>        <span class="k">CALL </span><span class="n">CalcEQLOpticalProperty</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">isBEAM</span><span class="p">,</span> <span class="n">AbsSolBeamEQL</span><span class="p">)</span>
<a name="ln-5918"></a>
<a name="ln-5919"></a>        <span class="c">! recalcuate the diffuse absorptance and transmittance of the</span>
<a name="ln-5920"></a>        <span class="c">! the equivalent layer window model if there is shade control</span>
<a name="ln-5921"></a>        <span class="n">EQLNum</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">EQLConsPtr</span>
<a name="ln-5922"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">ISControlled</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5923"></a><span class="k">          CALL </span><span class="n">CalcEQLOpticalProperty</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">isDIFF</span><span class="p">,</span> <span class="n">AbsSolDiffEQL</span><span class="p">)</span>
<a name="ln-5924"></a>        <span class="k">ELSE</span>
<a name="ln-5925"></a><span class="k">          </span><span class="n">AbsSolDiffEQL</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,:)</span> <span class="o">=</span> <span class="n">CFSDiffAbsTrans</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,:)</span>
<a name="ln-5926"></a>        <span class="n">ENDIF</span>
<a name="ln-5927"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">=</span> <span class="n">AbsSolDiffEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5928"></a>
<a name="ln-5929"></a>        <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-5930"></a>           <span class="n">AbWinEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-5931"></a>           <span class="k">IF</span> <span class="p">(</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">LTYPE</span> <span class="o">/=</span> <span class="n">ltyGLAZE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5932"></a>               <span class="c">! if the first layer is not glazing (or it is a shade) do not</span>
<a name="ln-5933"></a>               <span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbWinEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-5934"></a>           <span class="k">ELSE</span>
<a name="ln-5935"></a>               <span class="c">! the first layer is a glazing, include the outside reveal reflection</span>
<a name="ln-5936"></a>               <span class="c">! and the inside reveal reflection until indoor shade layer is encountered.</span>
<a name="ln-5937"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">L</span><span class="p">(</span><span class="n">Lay</span><span class="p">)%</span><span class="n">LTYPE</span> <span class="o">==</span> <span class="n">ltyGLAZE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5938"></a><span class="k">                   </span><span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbWinEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5939"></a>                   <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5940"></a>                   <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">AbsSolDiffEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-5941"></a>               <span class="k">ELSE</span>
<a name="ln-5942"></a><span class="k">                    </span><span class="n">AWinSurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbWinEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5943"></a>                    <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5944"></a>               <span class="n">ENDIF</span>
<a name="ln-5945"></a>           <span class="n">ENDIF</span>
<a name="ln-5946"></a>        <span class="k">END DO</span>
<a name="ln-5947"></a><span class="k">        </span><span class="n">TBmBmEQL</span> <span class="o">=</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5948"></a>        <span class="c">! Beam-diffuse transmittance</span>
<a name="ln-5949"></a>        <span class="n">TBmDiffEQL</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-5950"></a>        <span class="c">! Beam-beam transmittance: difference between beam-total and beam-diffuse transmittance</span>
<a name="ln-5951"></a>        <span class="n">TBmBmEQL</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">(</span><span class="n">TBmBmEQL</span><span class="o">-</span><span class="n">TBmDiffEQL</span><span class="p">))</span>
<a name="ln-5952"></a>      <span class="n">ENDIF</span>
<a name="ln-5953"></a>
<a name="ln-5954"></a>    <span class="k">END IF</span> <span class="c">! End of SunLitFrac check</span>
<a name="ln-5955"></a>
<a name="ln-5956"></a>
<a name="ln-5957"></a>      <span class="c">!-----------------------------------------------------------------</span>
<a name="ln-5958"></a>      <span class="c">! SKY AND GROUND DIFFUSE SOLAR GAIN INTO ZONE FROM EXTERIOR WINDOW</span>
<a name="ln-5959"></a>      <span class="c">!-----------------------------------------------------------------</span>
<a name="ln-5960"></a>
<a name="ln-5961"></a>    <span class="n">SkySolarInc</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkySolarInc</span>
<a name="ln-5962"></a>    <span class="n">GndSolarInc</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GndSolarInc</span>
<a name="ln-5963"></a>
<a name="ln-5964"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">/=</span> <span class="n">WindowBSDFModel</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span> <span class="c">! Regular window</span>
<a name="ln-5965"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5966"></a>
<a name="ln-5967"></a><span class="k">      </span><span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-5968"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5969"></a><span class="k">        </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span><span class="p">)</span>
<a name="ln-5970"></a>      <span class="k">ELSE</span>
<a name="ln-5971"></a><span class="k">        </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-5972"></a>      <span class="n">ENDIF</span>
<a name="ln-5973"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5974"></a><span class="k">        </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span><span class="p">)</span>
<a name="ln-5975"></a>      <span class="k">ELSE</span>
<a name="ln-5976"></a><span class="k">        </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-5977"></a>      <span class="n">ENDIF</span>
<a name="ln-5978"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5979"></a><span class="k">      </span><span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">CosInc</span><span class="p">,</span> <span class="n">SolarAniso</span><span class="p">)</span>
<a name="ln-5980"></a>
<a name="ln-5981"></a>      <span class="n">DSZoneWin</span> <span class="o">=</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">)</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5982"></a>      <span class="n">DGZoneWin</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">*</span> <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransSolIso</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5983"></a>
<a name="ln-5984"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5985"></a><span class="k">      </span><span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-5986"></a>
<a name="ln-5987"></a>      <span class="n">DSZoneWin</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Solar not added by TDD:DOME; added to zone via TDD:DIFFUSER</span>
<a name="ln-5988"></a>      <span class="n">DGZoneWin</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Solar not added by TDD:DOME; added to zone via TDD:DIFFUSER</span>
<a name="ln-5989"></a>
<a name="ln-5990"></a>    <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">OutShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Outside daylighting shelf</span>
<a name="ln-5991"></a>      <span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-5992"></a>
<a name="ln-5993"></a>      <span class="n">DSZoneWin</span> <span class="o">=</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-5994"></a>
<a name="ln-5995"></a>      <span class="n">ShelfSolarRad</span> <span class="o">=</span> <span class="p">(</span><span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">SunlitFrac</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5996"></a>        <span class="o">*</span> <span class="n">CosIncAng</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">+</span> <span class="n">DifSolarRad</span> <span class="o">*</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-5997"></a>        <span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutReflectSol</span>
<a name="ln-5998"></a>
<a name="ln-5999"></a>      <span class="c">! Add all reflected solar from the outside shelf to the ground solar</span>
<a name="ln-6000"></a>      <span class="c">! NOTE:  If the shelf blocks part of the view to the ground, the user must reduce the ground view factor!!</span>
<a name="ln-6001"></a>
<a name="ln-6002"></a>      <span class="c">! In order to get the effect of the daylighting shelf in here, must take into account the fact that this</span>
<a name="ln-6003"></a>      <span class="c">! is ultimately multiplied by GndSolarRad to get QD and QDV in InitSolarHeatGains.</span>
<a name="ln-6004"></a>      <span class="c">!</span>
<a name="ln-6005"></a>      <span class="c">! DGZoneWin = (GndVF*Trans*Area*GndSolarRad + ShelfVF*Trans*Area*ShelfSolarRad) / GndSolarRad</span>
<a name="ln-6006"></a>      <span class="c">!</span>
<a name="ln-6007"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6008"></a><span class="k">        </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">GndSolarRad</span> <span class="p">&amp;</span>
<a name="ln-6009"></a>          <span class="o">+</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">ShelfSolarRad</span><span class="p">)</span> <span class="o">/</span> <span class="n">GndSolarRad</span>
<a name="ln-6010"></a>      <span class="k">ELSE</span>
<a name="ln-6011"></a><span class="k">        </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6012"></a>      <span class="n">ENDIF</span>
<a name="ln-6013"></a>
<a name="ln-6014"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! complex fenestration</span>
<a name="ln-6015"></a>      <span class="n">FenSolAbsPtr</span> <span class="o">=</span> <span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-6016"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FenSolAbsPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6017"></a>        <span class="c">!Sky Diffuse transmitted by Complex Fen</span>
<a name="ln-6018"></a>        <span class="n">DiffTransSky</span>  <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span> <span class="p">)%</span><span class="n">WinSkyTrans</span>
<a name="ln-6019"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6020"></a><span class="k">          </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTransSky</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span><span class="p">)</span>
<a name="ln-6021"></a>        <span class="k">ELSE</span>
<a name="ln-6022"></a><span class="k">          </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTransSky</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6023"></a>        <span class="k">END IF</span>
<a name="ln-6024"></a>          <span class="c">!Ground Diffuse transmitted by Complex Fen</span>
<a name="ln-6025"></a>        <span class="n">DiffTransGnd</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span><span class="p">)%</span><span class="n">WinSkyGndTrans</span>
<a name="ln-6026"></a>        <span class="n">DiffTransBmGnd</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span> <span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6027"></a>               <span class="p">%</span><span class="n">WinBmGndTrans</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-6028"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6029"></a><span class="k">          </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmGndSolarInc</span> <span class="o">*</span> <span class="n">DiffTransBmGnd</span> <span class="p">&amp;</span>
<a name="ln-6030"></a>               <span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkyGndSolarInc</span> <span class="o">*</span> <span class="n">DiffTransGnd</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span><span class="p">)</span>
<a name="ln-6031"></a>        <span class="k">ELSE</span>
<a name="ln-6032"></a><span class="k">          </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmGndSolarInc</span> <span class="o">*</span> <span class="n">DiffTransBmGnd</span> <span class="p">&amp;</span>
<a name="ln-6033"></a>               <span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkyGndSolarInc</span> <span class="o">*</span> <span class="n">DiffTransGnd</span> <span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6034"></a>        <span class="k">END IF</span>
<a name="ln-6035"></a>
<a name="ln-6036"></a>        <span class="c">!Define the effective transmittance for total sky and ground radiation</span>
<a name="ln-6037"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">SkySolarInc</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmGndSolarInc</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkyGndSolarInc</span> <span class="p">)</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6038"></a><span class="k">          </span><span class="n">DiffTrans</span> <span class="o">=</span> <span class="p">(</span> <span class="n">SkySolarInc</span><span class="o">*</span><span class="n">DiffTransSky</span> <span class="o">+</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmGndSolarInc</span> <span class="o">*</span> <span class="n">DiffTransBmGnd</span> <span class="p">&amp;</span>
<a name="ln-6039"></a>               <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkyGndSolarInc</span> <span class="o">*</span> <span class="n">DiffTransGnd</span> <span class="p">)</span><span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-6040"></a>                  <span class="p">(</span><span class="n">SkySolarInc</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmGndSolarInc</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkyGndSolarInc</span> <span class="p">)</span>
<a name="ln-6041"></a>        <span class="k">ELSE</span>
<a name="ln-6042"></a><span class="k">          </span><span class="n">DiffTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6043"></a>        <span class="k">END IF</span>
<a name="ln-6044"></a>
<a name="ln-6045"></a>        <span class="c">!Also update the nominal diffuse transmittance</span>
<a name="ln-6046"></a>        <span class="n">NomDiffTrans</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span> <span class="p">)%</span><span class="n">WinDiffTrans</span>
<a name="ln-6047"></a>        <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">=</span> <span class="n">NomDiffTrans</span>
<a name="ln-6048"></a>      <span class="k">ELSE</span>
<a name="ln-6049"></a><span class="k">        </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6050"></a>        <span class="n">DGZoneWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6051"></a>        <span class="n">DiffTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6052"></a>        <span class="n">TBmBm</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6053"></a>        <span class="n">TBmDif</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6054"></a>        <span class="n">NomDiffTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6055"></a>      <span class="k">END IF</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6058"></a>
<a name="ln-6059"></a><span class="k">        </span><span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-6060"></a>
<a name="ln-6061"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6062"></a><span class="k">          </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span><span class="p">)</span>
<a name="ln-6063"></a>        <span class="k">ELSE</span>
<a name="ln-6064"></a><span class="k">          </span><span class="n">DSZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6065"></a>        <span class="n">ENDIF</span>
<a name="ln-6066"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6067"></a><span class="k">          </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span><span class="p">)</span>
<a name="ln-6068"></a>        <span class="k">ELSE</span>
<a name="ln-6069"></a><span class="k">          </span><span class="n">DGZoneWin</span> <span class="o">=</span> <span class="p">(</span><span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6070"></a>        <span class="n">ENDIF</span>
<a name="ln-6071"></a>
<a name="ln-6072"></a>    <span class="k">END IF</span>
<a name="ln-6073"></a>
<a name="ln-6074"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">/=</span> <span class="n">WindowBSDFModel</span><span class="p">).</span><span class="nb">AND</span><span class="p">.&amp;</span>
<a name="ln-6075"></a>        <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6076"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6077"></a>                 <span class="c">! Unshaded window</span>
<a name="ln-6078"></a>          <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DSZoneWin</span>
<a name="ln-6079"></a>          <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DGZoneWin</span>
<a name="ln-6080"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6081"></a>                 <span class="c">! Shade or blind</span>
<a name="ln-6082"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6083"></a>                 <span class="c">! Shade or screen</span>
<a name="ln-6084"></a>            <span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-6085"></a>          <span class="k">ELSE</span>
<a name="ln-6086"></a>                 <span class="c">! Blind</span>
<a name="ln-6087"></a>            <span class="n">DiffTrans</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">BlTransDiff</span><span class="p">)</span>
<a name="ln-6088"></a>            <span class="c">! For blinds with horizontal slats, allow different diffuse/diffuse transmittance for</span>
<a name="ln-6089"></a>            <span class="c">! ground and sky solar</span>
<a name="ln-6090"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span><span class="p">)%</span><span class="n">SlatOrientation</span> <span class="o">==</span> <span class="n">Horizontal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6091"></a><span class="k">              </span><span class="n">DiffTransGnd</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">BlTransDiffGnd</span><span class="p">)</span>
<a name="ln-6092"></a>              <span class="n">DiffTransSky</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">BlTransDiffSky</span><span class="p">)</span>
<a name="ln-6093"></a>            <span class="k">END IF</span>
<a name="ln-6094"></a><span class="k">          END IF</span>
<a name="ln-6095"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6096"></a><span class="k">             </span><span class="n">DSZoneWinSh</span>     <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span><span class="p">)</span>
<a name="ln-6097"></a>          <span class="k">ELSE</span>
<a name="ln-6098"></a><span class="k">             </span><span class="n">DSZoneWinSh</span>     <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6099"></a>          <span class="k">END IF</span>
<a name="ln-6100"></a>
<a name="ln-6101"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6102"></a><span class="k">             </span><span class="n">DGZoneWinSh</span>     <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span><span class="p">)</span>
<a name="ln-6103"></a>          <span class="k">ELSE</span>
<a name="ln-6104"></a><span class="k">             </span><span class="n">DGZoneWinSh</span>     <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6105"></a>          <span class="k">END IF</span>
<a name="ln-6106"></a>
<a name="ln-6107"></a><span class="k">          IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6108"></a><span class="k">             IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span><span class="p">)%</span><span class="n">SlatOrientation</span> <span class="o">==</span> <span class="n">Horizontal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6109"></a><span class="k">               </span><span class="n">CosTlt</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span>
<a name="ln-6110"></a>
<a name="ln-6111"></a>               <span class="k">IF</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6112"></a><span class="k">                 </span><span class="n">DSZoneWinSh</span>   <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6113"></a>                          <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">)</span><span class="o">*</span><span class="n">DiffTransGnd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">))</span><span class="o">*</span><span class="n">DiffTransSky</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span><span class="p">)</span>
<a name="ln-6114"></a>               <span class="k">ELSE</span>
<a name="ln-6115"></a><span class="k">                 </span><span class="n">DSZoneWinSh</span>   <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6116"></a>                          <span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">)</span><span class="o">*</span><span class="n">DiffTransGnd</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">))</span><span class="o">*</span><span class="n">DiffTransSky</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6117"></a>               <span class="k">END IF</span>
<a name="ln-6118"></a>
<a name="ln-6119"></a><span class="k">               IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6120"></a><span class="k">                 </span><span class="n">DGZoneWinSh</span>   <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6121"></a>                          <span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">))</span><span class="o">*</span><span class="n">DiffTransGnd</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">)</span><span class="o">*</span><span class="n">DiffTransSky</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span><span class="p">)</span>
<a name="ln-6122"></a>               <span class="k">ELSE</span>
<a name="ln-6123"></a><span class="k">                 </span><span class="n">DGZoneWinSh</span>   <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6124"></a>                          <span class="p">((</span><span class="mf">1.d0</span><span class="o">-</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">))</span><span class="o">*</span><span class="n">DiffTransGnd</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CosTlt</span><span class="p">)</span><span class="o">*</span><span class="n">DiffTransSky</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6125"></a>               <span class="k">END IF</span>
<a name="ln-6126"></a><span class="k">             END IF</span>
<a name="ln-6127"></a><span class="k">          END IF</span>
<a name="ln-6128"></a><span class="k">          </span><span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DSZoneWinSh</span>
<a name="ln-6129"></a>          <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DGZoneWinSh</span>
<a name="ln-6130"></a>        <span class="k">ELSE</span>
<a name="ln-6131"></a>                 <span class="c">! Switchable glazing</span>
<a name="ln-6132"></a>          <span class="n">SwitchFac</span>       <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span>
<a name="ln-6133"></a>          <span class="n">DiffTrans</span>       <span class="o">=</span> <span class="n">InterpSW</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TransDiff</span><span class="p">)</span>
<a name="ln-6134"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6135"></a><span class="k">        </span><span class="n">DSZoneWinSh</span>     <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span><span class="p">)</span>
<a name="ln-6136"></a>      <span class="k">ELSE</span>
<a name="ln-6137"></a><span class="k">        </span><span class="n">DSZoneWinSh</span>     <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6138"></a>      <span class="k">END IF</span>
<a name="ln-6139"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6140"></a><span class="k">        </span><span class="n">DGZoneWinSh</span>     <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span><span class="p">)</span>
<a name="ln-6141"></a>      <span class="k">ELSE</span>
<a name="ln-6142"></a><span class="k">        </span><span class="n">DGZoneWinSh</span>     <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6143"></a>      <span class="k">END IF</span>
<a name="ln-6144"></a><span class="k">          </span><span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">DSZoneWin</span><span class="p">,</span><span class="n">DSZoneWinSh</span><span class="p">)</span>
<a name="ln-6145"></a>          <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">DGZoneWin</span><span class="p">,</span><span class="n">DGZoneWinSh</span><span class="p">)</span>
<a name="ln-6146"></a>        <span class="k">END IF</span>
<a name="ln-6147"></a><span class="k">    </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6148"></a><span class="k">        </span><span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DSZoneWin</span>
<a name="ln-6149"></a>        <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DGZoneWin</span>
<a name="ln-6150"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6151"></a>        <span class="c">! For equivalent layer model the zone total diffuse solar heat gain</span>
<a name="ln-6152"></a>        <span class="c">! through exterior fenestrations are reported as single value.</span>
<a name="ln-6153"></a>        <span class="n">DSZoneWin</span>     <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">DifSolarRad</span> <span class="o">+</span> <span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6154"></a>        <span class="n">DGZoneWin</span>     <span class="o">=</span> <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">/</span> <span class="p">(</span><span class="n">GndSolarRad</span> <span class="o">+</span> <span class="mf">1.d-8</span><span class="p">)</span>
<a name="ln-6155"></a>
<a name="ln-6156"></a>        <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DSZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DSZoneWin</span>
<a name="ln-6157"></a>        <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DGZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DGZoneWin</span>
<a name="ln-6158"></a>    <span class="n">ENDIF</span>
<a name="ln-6159"></a>        <span class="c">!-----------------------------------------------------------------</span>
<a name="ln-6160"></a>        <span class="c">! BEAM SOLAR ON EXTERIOR WINDOW TRANSMITTED AS BEAM AND/OR DIFFUSE</span>
<a name="ln-6161"></a>        <span class="c">!-----------------------------------------------------------------</span>
<a name="ln-6162"></a>
<a name="ln-6163"></a>    <span class="n">TBmBm</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6164"></a>    <span class="n">TBmDif</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6165"></a>    <span class="n">TBmAllShBlSc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6166"></a>    <span class="n">TBmBmShBlSc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6167"></a>    <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6168"></a>
<a name="ln-6169"></a>    <span class="c">! Beam-beam transmittance for bare exterior window</span>
<a name="ln-6170"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SunlitFract</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6171"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6172"></a><span class="k">        </span><span class="n">TBmDif</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">CosInc</span><span class="p">,</span> <span class="n">SolarBeam</span><span class="p">)</span>
<a name="ln-6173"></a>        <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransSolBeam</span> <span class="o">=</span> <span class="n">TBmDif</span> <span class="c">! Report variable</span>
<a name="ln-6174"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">/=</span> <span class="n">WindowBSDFModel</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6175"></a>             <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Regular window</span>
<a name="ln-6176"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Clear glazing</span>
<a name="ln-6177"></a>          <span class="n">TBmBm</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span> <span class="c">![-]</span>
<a name="ln-6178"></a>        <span class="k">ELSE</span>                                                  <span class="c">! Diffusing glazing</span>
<a name="ln-6179"></a>          <span class="n">TBmDif</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span> <span class="c">![-]</span>
<a name="ln-6180"></a>        <span class="k">END IF</span>
<a name="ln-6181"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6182"></a>        <span class="c">! Need to check what effect, if any, defining these here has</span>
<a name="ln-6183"></a>        <span class="n">TBmBm</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span> <span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-6184"></a>                 <span class="p">%</span><span class="n">WinDirSpecTrans</span><span class="p">(</span> <span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span> <span class="p">)</span>
<a name="ln-6185"></a>        <span class="n">TBmDif</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6186"></a>                 <span class="p">%</span><span class="n">WinDirHemiTrans</span><span class="p">(</span> <span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span> <span class="p">)</span>  <span class="o">-</span> <span class="n">TBmBm</span>
<a name="ln-6187"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6188"></a>        <span class="c">! get ASHWAT fenestration model beam-beam and beam-diffuse properties</span>
<a name="ln-6189"></a>        <span class="n">TBmBm</span> <span class="o">=</span> <span class="n">TBmBmEQL</span>
<a name="ln-6190"></a>        <span class="n">TBmDif</span> <span class="o">=</span> <span class="n">TBmDiffEQL</span>
<a name="ln-6191"></a>      <span class="k">END IF</span>
<a name="ln-6192"></a><span class="k">    END IF</span>
<a name="ln-6193"></a>
<a name="ln-6194"></a>    <span class="c">! Report variables</span>
<a name="ln-6195"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GlTsolBmBm</span>  <span class="o">=</span> <span class="n">TBmBm</span>
<a name="ln-6196"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GlTsolBmDif</span> <span class="o">=</span> <span class="n">TBmDif</span>
<a name="ln-6197"></a>
<a name="ln-6198"></a>    <span class="c">! Diffuse-diffuse transmittance for bare exterior window</span>
<a name="ln-6199"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6200"></a><span class="k">      </span><span class="n">TDifBare</span> <span class="o">=</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">CosInc</span><span class="p">,</span> <span class="n">SolarAniso</span><span class="p">)</span>
<a name="ln-6201"></a>    <span class="k">ELSE</span>
<a name="ln-6202"></a><span class="k">      IF</span> <span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6203"></a>            <span class="c">!Complex Fenestration: use hemispherical ave of directional-hemispherical transmittance</span>
<a name="ln-6204"></a>            <span class="c">!Note: this is not quite the same as the effective transmittance for total of sky and ground radiation</span>
<a name="ln-6205"></a>        <span class="n">TDifBare</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span> <span class="p">)%</span><span class="n">WinDiffTrans</span>
<a name="ln-6206"></a>      <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6207"></a>            <span class="c">!get ASHWAT fenestration model diffuse-diffuse properties includes shade if present</span>
<a name="ln-6208"></a>        <span class="n">TDifBare</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-6209"></a>      <span class="k">ELSE</span>  <span class="c">! Regular window</span>
<a name="ln-6210"></a>        <span class="n">TDifBare</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-6211"></a>      <span class="k">END IF</span>
<a name="ln-6212"></a><span class="k">    END IF</span>
<a name="ln-6213"></a><span class="k">    </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GlTsolDifDif</span> <span class="o">=</span> <span class="n">TDifBare</span>
<a name="ln-6214"></a>
<a name="ln-6215"></a>
<a name="ln-6216"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6217"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6218"></a>
<a name="ln-6219"></a>                            <span class="c">! Shade or screen or blind on, or switchable glazing</span>
<a name="ln-6220"></a>                            <span class="c">! (note in the following that diffusing glass is not allowed in a window with</span>
<a name="ln-6221"></a>                            <span class="c">! shade, blind or switchable glazing)</span>
<a name="ln-6222"></a>
<a name="ln-6223"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">BGBlindOn</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">/=</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6224"></a>
<a name="ln-6225"></a>                            <span class="c">! Shade on or switchable glazing</span>
<a name="ln-6226"></a>
<a name="ln-6227"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SunlitFract</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">TBmAllShBlSc</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6228"></a>
<a name="ln-6229"></a>          <span class="k">ELSE</span>
<a name="ln-6230"></a>
<a name="ln-6231"></a>                            <span class="c">! Blind or Screen on</span>
<a name="ln-6232"></a>
<a name="ln-6233"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlGlSysTsolDifDif</span> <span class="o">=</span> <span class="n">DiffTrans</span>
<a name="ln-6234"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScGlSysTsolDifDif</span> <span class="o">=</span> <span class="n">DiffTrans</span>
<a name="ln-6235"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">BGBlindOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6236"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlTsolDifDif</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffTrans</span><span class="p">)</span>
<a name="ln-6237"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6238"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScTsolDifDif</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">DifDifTrans</span>
<a name="ln-6239"></a>            <span class="k">END IF</span>
<a name="ln-6240"></a>
<a name="ln-6241"></a><span class="k">            IF</span><span class="p">(</span><span class="n">SunlitFract</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6242"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6243"></a>    <span class="c">!           beam transmittance (written in subroutine CalcScreenTransmittance each time step)</span>
<a name="ln-6244"></a>                <span class="n">TScBmBm</span>  <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">BmBmTrans</span>
<a name="ln-6245"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScTsolBmBm</span> <span class="o">=</span> <span class="n">TScBmBm</span>
<a name="ln-6246"></a>              <span class="k">ELSE</span>
<a name="ln-6247"></a><span class="k">                </span><span class="n">TBlBmBm</span>  <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6248"></a>                                           <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-6249"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlTsolBmBm</span> <span class="o">=</span> <span class="n">TBlBmBm</span>
<a name="ln-6250"></a>              <span class="k">END IF</span>
<a name="ln-6251"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6252"></a>                <span class="c">! Interior or exterior blind</span>
<a name="ln-6253"></a>                <span class="n">TBmBmBl</span>  <span class="o">=</span> <span class="n">TBmBm</span> <span class="o">*</span> <span class="n">TBlBmBm</span>
<a name="ln-6254"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6255"></a>                <span class="c">! Exterior screen</span>
<a name="ln-6256"></a>                <span class="n">TBmBmSc</span>  <span class="o">=</span> <span class="n">TBmBm</span> <span class="o">*</span> <span class="n">TScBmBm</span>
<a name="ln-6257"></a>              <span class="k">ELSE</span>
<a name="ln-6258"></a>                            <span class="c">! Between-glass blind</span>
<a name="ln-6259"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6260"></a><span class="k">                  </span><span class="n">TBmBmBl</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">t2</span>
<a name="ln-6261"></a>                <span class="k">ELSE</span>  <span class="c">! NGlass = 3</span>
<a name="ln-6262"></a>                  <span class="n">TBmBmBl</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">t3</span>
<a name="ln-6263"></a>                <span class="k">END IF</span>
<a name="ln-6264"></a><span class="k">              END IF</span>
<a name="ln-6265"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6266"></a>    <span class="c">!           Report variable for Beam-to-Beam transmittance</span>
<a name="ln-6267"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScGlSysTsolBmBm</span> <span class="o">=</span> <span class="n">TBmBmSc</span>
<a name="ln-6268"></a>              <span class="k">ELSE</span>
<a name="ln-6269"></a><span class="k">                </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlGlSysTsolBmBm</span> <span class="o">=</span> <span class="n">TBmBmBl</span>
<a name="ln-6270"></a>              <span class="k">END IF</span>
<a name="ln-6271"></a>
<a name="ln-6272"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6273"></a><span class="k">                </span><span class="n">TScBmDif</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">BmDifTrans</span>
<a name="ln-6274"></a>    <span class="c">!           Report variable for Beam-to-Diffuse transmittance (scattered transmittance)</span>
<a name="ln-6275"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ScTsolBmDif</span>  <span class="o">=</span> <span class="n">TScBmDif</span>
<a name="ln-6276"></a>              <span class="k">ELSE</span>
<a name="ln-6277"></a><span class="k">                </span><span class="n">TBlBmDif</span> <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffTrans</span><span class="p">)</span>
<a name="ln-6278"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlTsolBmDif</span>  <span class="o">=</span> <span class="n">TBlBmDif</span>
<a name="ln-6279"></a>    <span class="c">!CR6913     SurfaceWindow(SurfNum)%BlTsolDifDif = InterpSlatAng(SlatAng,VarSlats,Blind(BlNum)%SolFrontDiffDiffTrans)</span>
<a name="ln-6280"></a>              <span class="k">END IF</span>
<a name="ln-6281"></a>
<a name="ln-6282"></a>              <span class="c">!added TH 12/9/2009</span>
<a name="ln-6283"></a>              <span class="n">TBmBmShBlSc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6284"></a>              <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6285"></a>
<a name="ln-6286"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6287"></a>
<a name="ln-6288"></a>                            <span class="c">! Interior blind on: beam-beam and diffuse transmittance of exterior beam</span>
<a name="ln-6289"></a>
<a name="ln-6290"></a>                <span class="n">TBlDifDif</span>     <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffTrans</span><span class="p">)</span>
<a name="ln-6291"></a>                <span class="n">RhoBlBmDifFr</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6292"></a>                <span class="n">RGlDifBk</span>      <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-6293"></a>                <span class="n">RhoBlDifDifFr</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolFrontDiffDiffRefl</span><span class="p">)</span>
<a name="ln-6294"></a>                <span class="n">TBmAllShBlSc</span>  <span class="o">=</span> <span class="n">TBmBm</span><span class="o">*</span><span class="p">(</span> <span class="n">TBlBmBm</span> <span class="o">+</span> <span class="n">TBlBmDif</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6295"></a>                                  <span class="n">TBlDifDif</span><span class="o">*</span><span class="n">RhoBlBmDifFr</span><span class="o">*</span><span class="n">RGlDifBk</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RhoBlDifDifFr</span><span class="o">*</span><span class="n">RGlDifBk</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6296"></a>
<a name="ln-6297"></a>                <span class="c">!added TH 12/9/2009</span>
<a name="ln-6298"></a>                <span class="n">TBmBmShBlSc</span> <span class="o">=</span> <span class="n">TBmBmBl</span>    <span class="c">!TBmBm * TBlBmBm</span>
<a name="ln-6299"></a>                <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="n">TBmAllShBlSc</span> <span class="o">-</span> <span class="n">TBmBmShBlSc</span>
<a name="ln-6300"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">TBmDifShBlSc</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6301"></a>
<a name="ln-6302"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6303"></a>
<a name="ln-6304"></a>                            <span class="c">! Exterior blind on: beam-beam and diffuse transmittance of exterior beam</span>
<a name="ln-6305"></a>
<a name="ln-6306"></a>                <span class="n">RhoBlBmDifBk</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">,</span><span class="n">SlatAng</span><span class="p">,</span><span class="n">VarSlats</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6307"></a>                <span class="n">RGlBmFr</span>       <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6308"></a>                <span class="n">TBmAllShBlSc</span>  <span class="o">=</span> <span class="n">TBlBmBm</span> <span class="o">*</span> <span class="p">(</span><span class="n">TBmBm</span> <span class="o">+</span> <span class="n">TDifBare</span><span class="o">*</span><span class="n">RGlBmFr</span><span class="o">*</span><span class="n">RhoBlBmDifBk</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RGlDifFr</span><span class="o">*</span><span class="n">RhoBlDifDifBk</span><span class="p">))</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-6309"></a>                                  <span class="n">TBlBmDif</span><span class="o">*</span><span class="n">TDifBare</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RGlDifFr</span><span class="o">*</span><span class="n">RhoBlDifDifBk</span><span class="p">)</span>
<a name="ln-6310"></a>
<a name="ln-6311"></a>                <span class="c">!added TH 12/9/2009</span>
<a name="ln-6312"></a>                <span class="n">TBmBmShBlSc</span> <span class="o">=</span> <span class="n">TBmBmBl</span>    <span class="c">!TBmBm * TBlBmBm</span>
<a name="ln-6313"></a>                <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="n">TBmAllShBlSc</span> <span class="o">-</span> <span class="n">TBmBmShBlSc</span>
<a name="ln-6314"></a>
<a name="ln-6315"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6316"></a>
<a name="ln-6317"></a>                            <span class="c">! Exterior screen on: beam-beam and diffuse transmittance of exterior beam</span>
<a name="ln-6318"></a>
<a name="ln-6319"></a>                <span class="n">RScBack</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">ReflectSolBeamFront</span>
<a name="ln-6320"></a>                <span class="n">RScDifDifBk</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNum</span><span class="p">)%</span><span class="n">DifReflect</span>
<a name="ln-6321"></a>                <span class="n">RGlBmFr</span>       <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosInc</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflSolBeamFrontCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6322"></a>                <span class="n">TBmAllShBlSc</span>  <span class="o">=</span> <span class="n">TScBmBm</span> <span class="o">*</span> <span class="p">(</span><span class="n">TBmBm</span> <span class="o">+</span> <span class="n">RGlBmFr</span><span class="o">*</span><span class="n">RScBack</span><span class="o">*</span><span class="n">TDifBare</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RGlDifFr</span><span class="o">*</span><span class="n">RScDifDifBk</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6323"></a>                                           <span class="n">TScBmDif</span><span class="o">*</span><span class="n">TDifBare</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RGlDifFr</span><span class="o">*</span><span class="n">RScDifDifBk</span><span class="p">)</span>
<a name="ln-6324"></a>
<a name="ln-6325"></a>                <span class="c">!added TH 12/9/2009</span>
<a name="ln-6326"></a>                <span class="n">TBmBmShBlSc</span> <span class="o">=</span> <span class="n">TBmBmSc</span>    <span class="c">!</span>
<a name="ln-6327"></a>                <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="n">TBmAllShBlSc</span> <span class="o">-</span> <span class="n">TBmBmShBlSc</span>
<a name="ln-6328"></a>
<a name="ln-6329"></a>              <span class="k">ELSE</span>
<a name="ln-6330"></a>                            <span class="c">! Between-glass blind on: beam-beam and diffuse transmittance of exterior beam</span>
<a name="ln-6331"></a>
<a name="ln-6332"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6333"></a><span class="k">                  </span><span class="n">TBmAllShBlSc</span> <span class="o">=</span> <span class="n">t1</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">t2</span> <span class="o">+</span> <span class="n">t1</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">rf2</span><span class="o">*</span><span class="n">rbshB</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rfd2</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rfshB</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">rfshd</span><span class="p">)</span><span class="o">*</span><span class="n">td2</span>
<a name="ln-6334"></a>                <span class="k">ELSE</span>   <span class="c">! NGlass = 3</span>
<a name="ln-6335"></a>                  <span class="n">TBmAllShBlSc</span> <span class="o">=</span> <span class="n">t1t2</span><span class="o">*</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">t3</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6336"></a>                     <span class="n">t1t2</span><span class="o">*</span><span class="p">(</span><span class="n">tfshBB</span><span class="o">*</span><span class="n">rf3</span><span class="o">*</span><span class="n">rbshB</span> <span class="o">+</span> <span class="n">tfshBd</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rfd3</span><span class="o">*</span><span class="n">rbshd</span><span class="p">)</span> <span class="o">+</span> <span class="n">rbshB</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2</span><span class="o">*</span><span class="n">tfshd</span> <span class="o">+</span> <span class="n">td2</span><span class="o">*</span><span class="n">rbd1</span><span class="o">*</span><span class="n">td2</span><span class="o">*</span><span class="n">tfshd</span><span class="p">))</span><span class="o">*</span><span class="n">td3</span>
<a name="ln-6337"></a>                <span class="k">END IF</span>
<a name="ln-6338"></a>
<a name="ln-6339"></a>                  <span class="c">!added TH 12/9/2009</span>
<a name="ln-6340"></a>                  <span class="n">TBmBmShBlSc</span> <span class="o">=</span> <span class="n">TBmBmBl</span>
<a name="ln-6341"></a>                  <span class="n">TBmDifShBlSc</span> <span class="o">=</span> <span class="n">TBmAllShBlSc</span> <span class="o">-</span> <span class="n">TBmBmShBlSc</span>
<a name="ln-6342"></a>
<a name="ln-6343"></a>              <span class="k">END IF</span>
<a name="ln-6344"></a><span class="k">            END IF</span>
<a name="ln-6345"></a>
<a name="ln-6346"></a><span class="k">          END IF</span>
<a name="ln-6347"></a>
<a name="ln-6348"></a><span class="k">        END IF</span>  <span class="c">! End of check if ShadeFlag &gt; 0 and ShadeFlag &lt; 10</span>
<a name="ln-6349"></a>    <span class="n">ENDIF</span>
<a name="ln-6350"></a>
<a name="ln-6351"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6352"></a>
<a name="ln-6353"></a>                        <span class="c">! Switchable glazing</span>
<a name="ln-6354"></a>
<a name="ln-6355"></a>      <span class="n">SwitchFac</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span>
<a name="ln-6356"></a>      <span class="k">IF</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolarDiffusing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6357"></a><span class="k">        </span><span class="n">TBmBm</span>     <span class="o">=</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">TBmBm</span><span class="p">,</span><span class="n">TBmAllShBlSc</span><span class="p">)</span>
<a name="ln-6358"></a>      <span class="k">ELSE</span>
<a name="ln-6359"></a><span class="k">        </span><span class="n">TBmDif</span>    <span class="o">=</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">TBmDif</span><span class="p">,</span><span class="n">TBmAllShBlSc</span><span class="p">)</span>
<a name="ln-6360"></a>      <span class="n">ENDIF</span>
<a name="ln-6361"></a>    <span class="k">END IF</span>
<a name="ln-6362"></a>
<a name="ln-6363"></a>    <span class="c">! The following WinTransBmSolar and WinTransDifSolar will be combined later to give</span>
<a name="ln-6364"></a>    <span class="c">! WinTransSolar for reporting</span>
<a name="ln-6365"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6366"></a><span class="k">        </span><span class="n">WinTransDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6367"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6368"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="o">==</span><span class="n">Horizontal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6369"></a><span class="k">            </span><span class="n">WinTransDifSolarGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DiffTransGnd</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6370"></a>            <span class="n">WinTransDifSolarSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DiffTransSky</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6371"></a>          <span class="k">END IF</span>
<a name="ln-6372"></a><span class="k">        END IF</span>
<a name="ln-6373"></a><span class="k">    ELSE</span>
<a name="ln-6374"></a>        <span class="c">! In equivalent layer window model system diffuse transmittance is based on unit</span>
<a name="ln-6375"></a>        <span class="c">! diffuse radiation flux, and hence doesn&#39;t distinguish between sky and</span>
<a name="ln-6376"></a>        <span class="c">! ground reflected diffuse radiations</span>
<a name="ln-6377"></a>        <span class="n">WinTransDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6378"></a>        <span class="n">WinTransDifSolarGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6379"></a>        <span class="n">WinTransDifSolarSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6380"></a>    <span class="n">ENDIF</span>
<a name="ln-6381"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Unshaded or switchable glazing</span>
<a name="ln-6382"></a>      <span class="c">!Note: with previous defs of TBmBm &amp; TBmDif, these come out right for Complex Fenestration</span>
<a name="ln-6383"></a>      <span class="c">! WinTransBmSolar uses the directional-hemispherical transmittance</span>
<a name="ln-6384"></a>      <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="p">(</span><span class="n">TBmBm</span> <span class="o">+</span> <span class="n">TBmDif</span><span class="p">)</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-6385"></a>
<a name="ln-6386"></a>
<a name="ln-6387"></a>      <span class="c">!added TH 12/9/2009</span>
<a name="ln-6388"></a>      <span class="n">WinTransBmBmSolar</span>  <span class="o">=</span> <span class="n">TBmBm</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>          <span class="c">! m2</span>
<a name="ln-6389"></a>      <span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="n">TBmDif</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>         <span class="c">! m2</span>
<a name="ln-6390"></a>
<a name="ln-6391"></a>    <span class="k">ELSE</span>
<a name="ln-6392"></a><span class="k">      </span><span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">TBmAllShBlSc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-6393"></a>
<a name="ln-6394"></a>      <span class="c">!added TH 12/9/2009</span>
<a name="ln-6395"></a>      <span class="n">WinTransBmBmSolar</span>  <span class="o">=</span> <span class="n">TBmBmShBlSc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-6396"></a>      <span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="n">TBmDifShBlSc</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>
<a name="ln-6397"></a>    <span class="k">END IF</span>
<a name="ln-6398"></a>
<a name="ln-6399"></a>    <span class="c">! Add diffuse transmitted by window from beam reflected from outside reveal</span>
<a name="ln-6400"></a>
<a name="ln-6401"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Complex Fenestration</span>
<a name="ln-6402"></a>      <span class="n">FenSolAbsPtr</span> <span class="o">=</span> <span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-6403"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FenSolAbsPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6404"></a><span class="k">          </span><span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6405"></a>            <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">NomDiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6406"></a>
<a name="ln-6407"></a>          <span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="n">WinTransBmDifSolar</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">NomDiffTrans</span> <span class="p">&amp;</span>
<a name="ln-6408"></a>                            <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6409"></a>        <span class="k">ELSE</span>
<a name="ln-6410"></a><span class="k">          </span><span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6411"></a>          <span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6412"></a>        <span class="k">END IF</span>
<a name="ln-6413"></a><span class="k">    ELSE</span>  <span class="c">!Regular window</span>
<a name="ln-6414"></a>          <span class="c">! this is also valid for equivalent layer window</span>
<a name="ln-6415"></a>      <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6416"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6417"></a>
<a name="ln-6418"></a>      <span class="c">!added TH 12/9/2009</span>
<a name="ln-6419"></a>      <span class="n">WinTransBmDifSolar</span> <span class="o">=</span> <span class="n">WinTransBmDifSolar</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="p">&amp;</span>
<a name="ln-6420"></a>        <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6421"></a>    <span class="k">END IF</span>
<a name="ln-6422"></a>
<a name="ln-6423"></a>    <span class="c">! Increment factor for total exterior beam solar entering zone through window as beam or diffuse</span>
<a name="ln-6424"></a>
<a name="ln-6425"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunLitFract</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6426"></a>
<a name="ln-6427"></a><span class="k">      IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.&amp;</span>
<a name="ln-6428"></a>         <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6429"></a><span class="k">        </span><span class="n">TBmAll</span> <span class="o">=</span> <span class="n">TBmAllShBlSc</span>
<a name="ln-6430"></a>      <span class="k">ELSE</span>
<a name="ln-6431"></a><span class="k">        </span><span class="n">TBmAll</span> <span class="o">=</span> <span class="n">TBmBm</span> <span class="o">+</span> <span class="n">TBmDif</span>
<a name="ln-6432"></a>      <span class="k">END IF</span>
<a name="ln-6433"></a>
<a name="ln-6434"></a><span class="k">      </span><span class="n">FenSolAbsPtr</span> <span class="o">=</span> <span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConstrNum</span><span class="p">)</span>
<a name="ln-6435"></a>
<a name="ln-6436"></a>      <span class="c">! Window is schedule surface gained. Do not make addition to what enters into zone since that information is not</span>
<a name="ln-6437"></a>      <span class="c">! available</span>
<a name="ln-6438"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FenSolAbsPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6439"></a><span class="k">        </span><span class="n">BTOTZone</span> <span class="o">=</span> <span class="n">BTOTZone</span> <span class="o">+</span> <span class="n">TBmAll</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span> <span class="c">! [m2]</span>
<a name="ln-6440"></a>      <span class="k">END IF</span>
<a name="ln-6441"></a>
<a name="ln-6442"></a><span class="k">    END IF</span>
<a name="ln-6443"></a>
<a name="ln-6444"></a>    <span class="c">! Correct for effect of (1) beam absorbed by inside reveal, (2) diffuse entering zone from beam</span>
<a name="ln-6445"></a>    <span class="c">! reflected by inside reveal and (3) diffuse transmitted by window from beam reflected from</span>
<a name="ln-6446"></a>    <span class="c">! outside reveal.</span>
<a name="ln-6447"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CosInc</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6448"></a>      <span class="c">! old code</span>
<a name="ln-6449"></a>      <span class="c">! BTOTZone = BTOTZone + (SurfaceWindow(SurfNum)%InsRevealDiffIntoZone &amp;</span>
<a name="ln-6450"></a>      <span class="c">!                       - SurfaceWindow(SurfNum)%BmSolAbsdInsReveal &amp;</span>
<a name="ln-6451"></a>      <span class="c">!                       + SurfaceWindow(SurfNum)%OutsRevealDiffOntoGlazing * DiffTrans) * Surface(SurfNum)%Area</span>
<a name="ln-6452"></a>
<a name="ln-6453"></a>      <span class="c">! CR 7596. TH 5/27/2009</span>
<a name="ln-6454"></a>      <span class="c">! The BTOTZone is the solar into zone assuming no inside or outside reveals</span>
<a name="ln-6455"></a>      <span class="c">! The inside reveals receive solar (reflected part + absorbed part) from the window, this amount should be</span>
<a name="ln-6456"></a>      <span class="c">! deducted from the BTOTZone, then adds the InsRevealDiffIntoZone</span>
<a name="ln-6457"></a>      <span class="k">IF</span><span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span>  <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Complex Fenestration</span>
<a name="ln-6458"></a>        <span class="n">SurfSolIncPtr</span> <span class="o">=</span> <span class="n">SurfaceScheduledSolarInc</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span> <span class="n">ConstrNumBack</span><span class="p">)</span>
<a name="ln-6459"></a>
<a name="ln-6460"></a>        <span class="c">! Do not add total into zone from scheduled surface gains.  That will be added later</span>
<a name="ln-6461"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfSolIncPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6462"></a><span class="k">          </span><span class="n">BTOTZone</span> <span class="o">=</span> <span class="n">BTOTZone</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsReveal</span> <span class="p">&amp;</span>
<a name="ln-6463"></a>                            <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span> <span class="p">&amp;</span>
<a name="ln-6464"></a>                            <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZone</span> <span class="p">&amp;</span>
<a name="ln-6465"></a>                            <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">NomDiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6466"></a>        <span class="k">END IF</span>
<a name="ln-6467"></a><span class="k">      ELSE</span>  <span class="c">!Regular window</span>
<a name="ln-6468"></a>        <span class="n">BTOTZone</span> <span class="o">=</span> <span class="n">BTOTZone</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsReveal</span> <span class="p">&amp;</span>
<a name="ln-6469"></a>                          <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span> <span class="p">&amp;</span>
<a name="ln-6470"></a>                          <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZone</span> <span class="p">&amp;</span>
<a name="ln-6471"></a>                          <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">*</span> <span class="n">DiffTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6472"></a>      <span class="k">END IF</span>
<a name="ln-6473"></a>      <span class="c">! Add beam solar absorbed by outside reveal to outside of window&#39;s base surface.</span>
<a name="ln-6474"></a>      <span class="c">! Add beam solar absorbed by inside reveal to inside of window&#39;s base surface.</span>
<a name="ln-6475"></a>      <span class="c">! This ignores 2-D heat transfer effects.</span>
<a name="ln-6476"></a>      <span class="n">BaseSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-6477"></a>      <span class="n">AISurf</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AISurf</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6478"></a>      <span class="n">AOSurf</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AOSurf</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdOutsReveal</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">BaseSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6479"></a>    <span class="k">END IF</span>
<a name="ln-6480"></a>
<a name="ln-6481"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SunLitFract</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6482"></a>
<a name="ln-6483"></a>      <span class="c">!---------------------------------------------------------------------------------</span>
<a name="ln-6484"></a>      <span class="c">! INTERIOR BEAM FROM EXTERIOR WINDOW THAT IS ABSORBED/TRANSMITTED BY BACK SURFACES</span>
<a name="ln-6485"></a>      <span class="c">!---------------------------------------------------------------------------------</span>
<a name="ln-6486"></a>
<a name="ln-6487"></a>      <span class="c">! If shade is in place or there is a diffusing glass layer there is no interior beam</span>
<a name="ln-6488"></a>      <span class="c">! from this exterior window since the beam-beam transmittance of shades and diffusing glass</span>
<a name="ln-6489"></a>      <span class="c">! is assumed to be zero. The beam-beam transmittance of tubular daylighting devices is also</span>
<a name="ln-6490"></a>      <span class="c">! assumed to be zero.</span>
<a name="ln-6491"></a>
<a name="ln-6492"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span> <span class="p">&amp;</span>
<a name="ln-6493"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SolarDiffusing</span>  <span class="p">&amp;</span>
<a name="ln-6494"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span> <span class="p">&amp;</span>
<a name="ln-6495"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6496"></a>
<a name="ln-6497"></a>      <span class="c">! Find interior beam radiation that is:</span>
<a name="ln-6498"></a>      <span class="c">! (1) absorbed by opaque back surfaces;</span>
<a name="ln-6499"></a>      <span class="c">! (2) absorbed by glass layers of back surfaces that are interior or exterior windows;</span>
<a name="ln-6500"></a>      <span class="c">! (3) absorbed by interior, exterior or between-glass shades or blinds of back surfaces</span>
<a name="ln-6501"></a>      <span class="c">!       that are exterior windows; and</span>
<a name="ln-6502"></a>      <span class="c">! (4) transmitted through back surfaces that are interior or exterior windows.</span>
<a name="ln-6503"></a>
<a name="ln-6504"></a>      <span class="c">! Beam-beam transmittance of exterior window</span>
<a name="ln-6505"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6506"></a><span class="k">        </span><span class="n">TBm</span> <span class="o">=</span> <span class="n">TBmBmBl</span>    <span class="c">! Interior, exterior or between-glass blind on</span>
<a name="ln-6507"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6508"></a><span class="k">        </span><span class="n">TBm</span> <span class="o">=</span> <span class="n">TBmBmSc</span>    <span class="c">! Exterior screen on</span>
<a name="ln-6509"></a>      <span class="k">ELSE</span>
<a name="ln-6510"></a><span class="k">        </span><span class="n">TBm</span> <span class="o">=</span> <span class="n">TBmBm</span>      <span class="c">! Bare glass or switchable glazing</span>
<a name="ln-6511"></a>
<a name="ln-6512"></a>                         <span class="c">! Correction for beam absorbed by inside reveal</span>
<a name="ln-6513"></a>        <span class="n">TBmDenom</span><span class="o">=</span><span class="p">(</span><span class="n">SunLitFract</span> <span class="o">*</span>  <span class="n">CosInc</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span><span class="p">)</span>
<a name="ln-6514"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TBmDenom</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! when =0.0, no correction</span>
<a name="ln-6515"></a>          <span class="n">TBm</span> <span class="o">=</span> <span class="n">TBm</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span> <span class="o">/</span> <span class="n">TBmDenom</span>
<a name="ln-6516"></a>        <span class="n">ENDIF</span>
<a name="ln-6517"></a>
<a name="ln-6518"></a>        <span class="n">TBm</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">TBm</span><span class="p">)</span>
<a name="ln-6519"></a>      <span class="k">END IF</span>
<a name="ln-6520"></a>
<a name="ln-6521"></a><span class="k">      IF</span><span class="p">(</span><span class="n">TBm</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-6522"></a>
<a name="ln-6523"></a><span class="k">      IF</span><span class="p">(</span><span class="n">InShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Inside daylighting shelf</span>
<a name="ln-6524"></a>        <span class="c">! Inside daylighting shelves assume that no beam will pass the end of the shelf.</span>
<a name="ln-6525"></a>        <span class="c">! Since all beam is absorbed on the shelf, this might cause them to get unrealistically hot at times.</span>
<a name="ln-6526"></a>
<a name="ln-6527"></a>        <span class="n">BTOTWinZone</span> <span class="o">=</span> <span class="n">TBm</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span> <span class="c">![m2]</span>
<a name="ln-6528"></a>
<a name="ln-6529"></a>        <span class="c">! Shelf surface area is divided by 2 because only one side sees beam (Area was multiplied by 2 during init)</span>
<a name="ln-6530"></a>        <span class="n">AISurf</span><span class="p">(</span><span class="n">InShelfSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">AISurf</span><span class="p">(</span><span class="n">InShelfSurf</span><span class="p">)</span> <span class="o">+</span> <span class="n">BTOTWinZone</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5d0</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">InShelfSurf</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span> <span class="c">![-]</span>
<a name="ln-6531"></a>        <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">BTOTWinZone</span> <span class="c">![m2]</span>
<a name="ln-6532"></a>
<a name="ln-6533"></a>        <span class="k">CYCLE</span>
<a name="ln-6534"></a><span class="k">      END IF</span>
<a name="ln-6535"></a>
<a name="ln-6536"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SolarDistribution</span> <span class="o">==</span>  <span class="n">FullInteriorExterior</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Full interior solar distribution</span>
<a name="ln-6537"></a>
<a name="ln-6538"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowBSDFModel</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6539"></a>           <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6540"></a>        <span class="c">! Loop over back surfaces irradiated by beam from this exterior window</span>
<a name="ln-6541"></a>
<a name="ln-6542"></a>        <span class="k">DO </span><span class="n">IBack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxBkSurf</span>
<a name="ln-6543"></a>
<a name="ln-6544"></a>          <span class="n">BackSurfNum</span> <span class="o">=</span> <span class="n">BackSurfaces</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">IBack</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-6545"></a>
<a name="ln-6546"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">BackSurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>   <span class="c">! No more irradiated back surfaces for this exterior window</span>
<a name="ln-6547"></a>          <span class="n">ConstrNumBack</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6548"></a>          <span class="n">NBackGlass</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-6549"></a>             <span class="c">! Irradiated (overlap) area for this back surface, projected onto window plane</span>
<a name="ln-6550"></a>             <span class="c">! (includes effect of shadowing on exterior window)</span>
<a name="ln-6551"></a>          <span class="n">Aoverlap</span> <span class="o">=</span> <span class="n">OverlapAreas</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">IBack</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-6552"></a>          <span class="n">Boverlap</span> <span class="o">=</span> <span class="n">TBm</span> <span class="o">*</span> <span class="n">Aoverlap</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="c">![m2]</span>
<a name="ln-6553"></a>
<a name="ln-6554"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6555"></a>
<a name="ln-6556"></a>            <span class="c">! Back surface is opaque interior or exterior wall</span>
<a name="ln-6557"></a>
<a name="ln-6558"></a>            <span class="n">AbsIntSurf</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>
<a name="ln-6559"></a>
<a name="ln-6560"></a>            <span class="c">! Check for movable insulation; reproduce code from subr. EvalInsideMovableInsulation;</span>
<a name="ln-6561"></a>            <span class="c">! Can&#39;t call that routine here since cycle prevents SolarShadingGeometry from USEing</span>
<a name="ln-6562"></a>            <span class="c">! HeatBalanceSurfaceManager, which contains EvalInsideMovableInsulation</span>
<a name="ln-6563"></a>            <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6564"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6565"></a><span class="k">              </span><span class="n">MovInsulSchedVal</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span><span class="p">)</span>
<a name="ln-6566"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Movable insulation not present at current time</span>
<a name="ln-6567"></a>                <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6568"></a>              <span class="k">ELSE</span>  <span class="c">! Movable insulation present</span>
<a name="ln-6569"></a>                <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">Resistance</span><span class="p">)</span>
<a name="ln-6570"></a>                <span class="n">AbsInt</span>    <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">AbsorpSolar</span>
<a name="ln-6571"></a>              <span class="k">END IF</span>
<a name="ln-6572"></a><span class="k">            END IF</span>
<a name="ln-6573"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">AbsIntSurf</span> <span class="o">=</span> <span class="n">AbsInt</span>  <span class="c">! Movable inside insulation present</span>
<a name="ln-6574"></a>
<a name="ln-6575"></a>            <span class="n">AISurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AISurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>     <span class="c">![-]</span>
<a name="ln-6576"></a>              <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsIntSurf</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6577"></a>            <span class="n">BABSZone</span>            <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsIntSurf</span>       <span class="c">![m2]</span>
<a name="ln-6578"></a>
<a name="ln-6579"></a>          <span class="k">ELSE</span>
<a name="ln-6580"></a>
<a name="ln-6581"></a>            <span class="c">! Back surface is an interior or exterior window</span>
<a name="ln-6582"></a>
<a name="ln-6583"></a>            <span class="c">! Note that exterior back windows can have a shading device but interior back windows</span>
<a name="ln-6584"></a>            <span class="c">! are assumed to be bare, i.e., they have no shading device and are non-switchable.</span>
<a name="ln-6585"></a>            <span class="c">! The layer order for interior windows is &quot;outside&quot; to &quot;inside,&quot; where &quot;outside&quot; refers to</span>
<a name="ln-6586"></a>            <span class="c">! the adjacent zone and &quot;inside&quot; refers to the current zone.</span>
<a name="ln-6587"></a>
<a name="ln-6588"></a>            <span class="n">ShadeFlagBack</span>   <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span>
<a name="ln-6589"></a>            <span class="n">SlatAngBack</span>     <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span>
<a name="ln-6590"></a>            <span class="n">VarSlatsBack</span>    <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span>
<a name="ln-6591"></a>            <span class="n">CosIncBack</span>      <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">))</span>
<a name="ln-6592"></a>            <span class="c">!</span>
<a name="ln-6593"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6594"></a>                <span class="c">!Transmitting window is complex fen, change the incident angle to one for ray joining</span>
<a name="ln-6595"></a>                <span class="c">! transmitting and back window centers</span>
<a name="ln-6596"></a>              <span class="n">CosIncBack</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">sdotN</span><span class="p">(</span><span class="n">IBack</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6597"></a>            <span class="n">ENDIF</span>
<a name="ln-6598"></a>              <span class="c">!</span>
<a name="ln-6599"></a>            <span class="n">ConstrNumBackSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-6600"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6601"></a><span class="k">              </span><span class="n">ConstrNum</span>   <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-6602"></a>              <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span>
<a name="ln-6603"></a>            <span class="k">END IF</span>
<a name="ln-6604"></a><span class="k">            </span><span class="n">AbsBeamWin</span>      <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6605"></a>            <span class="n">TransBeamWin</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-6606"></a>
<a name="ln-6607"></a>                 <span class="c">! Interior beam absorptance of glass layers and beam transmittance of back exterior  &amp;</span>
<a name="ln-6608"></a>                 <span class="c">! or interior window WITHOUT SHADING this timestep</span>
<a name="ln-6609"></a>
<a name="ln-6610"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6611"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6612"></a>                <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6613"></a>              <span class="k">END DO</span>
<a name="ln-6614"></a><span class="k">              </span><span class="n">TransBeamWin</span>      <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6615"></a>            <span class="k">END IF</span>
<a name="ln-6616"></a>
<a name="ln-6617"></a>                 <span class="c">! Interior beam absorptance of glass layers and beam transmittance</span>
<a name="ln-6618"></a>                 <span class="c">! of back exterior window with SHADE</span>
<a name="ln-6619"></a>
<a name="ln-6620"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span><span class="o">==</span><span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlagBack</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlagBack</span><span class="o">==</span><span class="n">BGShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6621"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-6622"></a>                <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6623"></a>              <span class="k">END DO</span>
<a name="ln-6624"></a><span class="k">              </span><span class="n">TransBeamWin</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6625"></a>
<a name="ln-6626"></a>            <span class="k">END IF</span>
<a name="ln-6627"></a>
<a name="ln-6628"></a>                 <span class="c">! Interior beam absorbed by INTERIOR SHADE of back exterior window</span>
<a name="ln-6629"></a>
<a name="ln-6630"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">IntShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6631"></a><span class="k">              </span><span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">AbsDiffBackShade</span> <span class="p">&amp;</span>
<a name="ln-6632"></a>                <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-6633"></a>              <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">AbsDiffBackShade</span>
<a name="ln-6634"></a>            <span class="k">END IF</span>
<a name="ln-6635"></a>
<a name="ln-6636"></a>                 <span class="c">! Interior beam absorbed by EXTERIOR SHADE of back exterior window</span>
<a name="ln-6637"></a>
<a name="ln-6638"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6639"></a><span class="k">              </span><span class="n">RGlFront</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-6640"></a>              <span class="n">AbsSh</span>    <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">AbsorpSolar</span>
<a name="ln-6641"></a>              <span class="n">RhoSh</span>    <span class="o">=</span> <span class="mf">1.d0</span><span class="o">-</span><span class="n">AbsSh</span><span class="o">-</span><span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">))%</span><span class="n">Trans</span>
<a name="ln-6642"></a>              <span class="n">AShBack</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6643"></a>                <span class="n">AbsSh</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RGlFront</span><span class="o">*</span><span class="n">RhoSh</span><span class="p">)</span>
<a name="ln-6644"></a>              <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AshBack</span>
<a name="ln-6645"></a>              <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AShBack</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6646"></a>                    <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-6647"></a>            <span class="k">END IF</span>
<a name="ln-6648"></a>
<a name="ln-6649"></a>                 <span class="c">! Interior beam absorbed by BETWEEN-GLASS SHADE of back exterior window</span>
<a name="ln-6650"></a>
<a name="ln-6651"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">BGShadeOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6652"></a><span class="k">              </span><span class="n">rbd1k</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rbBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6653"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">NBackGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6654"></a><span class="k">                </span><span class="n">t2k</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6655"></a>                <span class="n">rfd2k</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rfBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6656"></a>                <span class="n">TrSh</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">))%</span><span class="n">Trans</span>
<a name="ln-6657"></a>                <span class="n">RhoSh</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">))%</span><span class="n">ReflectShade</span>
<a name="ln-6658"></a>                <span class="n">AbsSh</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">TrSh</span><span class="o">-</span><span class="n">RhoSh</span><span class="p">))</span>
<a name="ln-6659"></a>                <span class="n">AShBack</span> <span class="o">=</span> <span class="n">t2k</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RhoSh</span><span class="o">*</span><span class="n">rfd2k</span> <span class="o">+</span> <span class="n">TrSh</span><span class="o">*</span><span class="n">rbd1k</span><span class="p">)</span><span class="o">*</span><span class="n">AbsSh</span>
<a name="ln-6660"></a>              <span class="k">ELSE</span>  <span class="c">! NBackGlass = 3</span>
<a name="ln-6661"></a>                <span class="n">t3k</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6662"></a>                <span class="n">TrSh</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">5</span><span class="p">))%</span><span class="n">Trans</span>
<a name="ln-6663"></a>                <span class="n">RhoSh</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">5</span><span class="p">))%</span><span class="n">ReflectShade</span>
<a name="ln-6664"></a>                <span class="n">AbsSh</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">TrSh</span><span class="o">-</span><span class="n">RhoSh</span><span class="p">))</span>
<a name="ln-6665"></a>                <span class="n">AShBack</span> <span class="o">=</span> <span class="n">t3k</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RhoSh</span><span class="o">*</span><span class="n">rfd3k</span> <span class="o">+</span> <span class="n">TrSh</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2k</span> <span class="o">+</span> <span class="n">td2k</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">td2k</span><span class="p">))</span><span class="o">*</span><span class="n">AbsSh</span>
<a name="ln-6666"></a>              <span class="k">END IF</span>
<a name="ln-6667"></a><span class="k">              </span><span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AShBack</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6668"></a>              <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AShBack</span>
<a name="ln-6669"></a>            <span class="k">END IF</span>
<a name="ln-6670"></a>
<a name="ln-6671"></a>                 <span class="c">! Interior beam absorptance of glass layers and beam absorbed in blind</span>
<a name="ln-6672"></a>                 <span class="c">! of back exterior window with BLIND</span>
<a name="ln-6673"></a>
<a name="ln-6674"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span><span class="o">==</span><span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlagBack</span><span class="o">==</span><span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlagBack</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6675"></a><span class="k">              </span><span class="n">BlNumBack</span>     <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-6676"></a>              <span class="k">CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">SOLCOS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAngBack</span><span class="p">)</span>
<a name="ln-6677"></a>              <span class="n">TGlBmBack</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6678"></a>              <span class="n">TBlBmBmBack</span>   <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">PI</span><span class="o">-</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6679"></a>                                       <span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-6680"></a>              <span class="n">TBlBmDiffBack</span> <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamDiffTrans</span><span class="p">)</span>
<a name="ln-6681"></a>
<a name="ln-6682"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">IntBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6683"></a>
<a name="ln-6684"></a>                 <span class="c">! Interior beam absorptance of GLASS LAYERS of exterior back window with INTERIOR BLIND</span>
<a name="ln-6685"></a>
<a name="ln-6686"></a>                <span class="n">RhoBlFront</span>    <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6687"></a>                <span class="n">RhoBlDiffFront</span><span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontDiffDiffRefl</span><span class="p">)</span>
<a name="ln-6688"></a>                <span class="n">RGlBack</span>       <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">ReflSolBeamBackCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6689"></a>                <span class="n">RGlDiffBack</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-6690"></a>                <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6691"></a>                  <span class="n">AbWinBack</span>   <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6692"></a>                  <span class="n">AGlDiffBack</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-6693"></a>                  <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">TBlBmBmBack</span><span class="o">*</span><span class="n">AbWinBack</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6694"></a>                    <span class="p">((</span><span class="n">TBlBmBmBack</span><span class="o">*</span><span class="n">RGlBack</span><span class="o">*</span><span class="n">RhoBlFront</span> <span class="o">+</span> <span class="n">TBlBmDiffBack</span><span class="p">)</span> <span class="o">*</span> <span class="n">AGlDiffBack</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6695"></a>                    <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RGlDiffBack</span><span class="o">*</span><span class="n">RhoBlDiffFront</span><span class="p">))</span>
<a name="ln-6696"></a>                <span class="k">END DO</span>
<a name="ln-6697"></a>
<a name="ln-6698"></a>                 <span class="c">! Interior beam transmitted by exterior back window with INTERIOR BLIND</span>
<a name="ln-6699"></a>
<a name="ln-6700"></a>                <span class="n">TGlDif</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransDiff</span>
<a name="ln-6701"></a>                <span class="n">TransBeamWin</span>  <span class="o">=</span> <span class="n">TBlBmBmBack</span> <span class="o">*</span> <span class="p">(</span><span class="n">TGlBmBack</span> <span class="o">+</span> <span class="n">TGlDif</span><span class="o">*</span><span class="n">RGlBack</span><span class="o">*</span><span class="n">RhoBlFront</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6702"></a>                                 <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RGlDiffBack</span><span class="o">*</span><span class="n">RhoBlDiffFront</span><span class="p">))</span> <span class="o">+</span> <span class="n">TBlBmDiffBack</span><span class="o">*</span><span class="n">TGlDif</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RGlDiffBack</span><span class="o">*</span><span class="n">RhoBlDiffFront</span><span class="p">)</span>
<a name="ln-6703"></a>
<a name="ln-6704"></a>                 <span class="c">! Interior beam absorbed by BLIND on exterior back window with INTERIOR BLIND</span>
<a name="ln-6705"></a>
<a name="ln-6706"></a>                <span class="n">AbsBlFront</span>    <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontBeamAbs</span><span class="p">)</span>
<a name="ln-6707"></a>                <span class="n">AbsBlBack</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamAbs</span><span class="p">)</span>
<a name="ln-6708"></a>                <span class="n">AbsBlDiffFront</span><span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontDiffAbs</span><span class="p">)</span>
<a name="ln-6709"></a>                <span class="n">ABlBack</span>       <span class="o">=</span> <span class="n">AbsBlBack</span> <span class="o">+</span> <span class="n">TBlBmBmBack</span> <span class="o">*</span> <span class="n">RGlBack</span> <span class="o">*</span> <span class="n">AbsBlFront</span> <span class="p">&amp;</span>
<a name="ln-6710"></a>                  <span class="o">+</span> <span class="p">(</span><span class="n">AbsBlDiffFront</span><span class="o">*</span><span class="n">RGlDiffBack</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RhoBlDiffFront</span><span class="o">*</span><span class="n">RGlDiffBack</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-6711"></a>                  <span class="o">*</span> <span class="p">(</span><span class="n">RGlBack</span><span class="o">*</span><span class="n">TBlBmBmBack</span><span class="o">*</span><span class="n">RhoBlFront</span> <span class="o">+</span> <span class="n">TBlBmDiffBack</span><span class="p">)</span>
<a name="ln-6712"></a>                <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6713"></a>                  <span class="n">ABlBack</span> <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-6714"></a>                <span class="n">BABSZone</span>      <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">ABlBack</span>
<a name="ln-6715"></a>              <span class="n">ENDIF</span>
<a name="ln-6716"></a>
<a name="ln-6717"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6718"></a>
<a name="ln-6719"></a>                 <span class="c">! Interior beam absorptance of GLASS LAYERS of exterior back window with EXTERIOR BLIND</span>
<a name="ln-6720"></a>
<a name="ln-6721"></a>                <span class="n">RGlDiffFront</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-6722"></a>                <span class="n">RhoBlBack</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6723"></a>                <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6724"></a>                  <span class="n">AbWinBack</span>   <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6725"></a>                  <span class="n">AGlDiffFront</span><span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-6726"></a>                  <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbWinBack</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6727"></a>                    <span class="p">(</span><span class="n">TGlBmBack</span><span class="o">*</span><span class="n">AGlDiffFront</span><span class="o">*</span><span class="n">RhoBlBack</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RhoBlBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="p">))</span>
<a name="ln-6728"></a>                <span class="k">END DO</span>
<a name="ln-6729"></a>
<a name="ln-6730"></a>                 <span class="c">! Interior beam transmitted by exterior back window with EXTERIOR BLIND</span>
<a name="ln-6731"></a>
<a name="ln-6732"></a>                <span class="n">TBlDifDif</span>     <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffDiffTrans</span><span class="p">)</span>
<a name="ln-6733"></a>                <span class="n">RhoBlBmDifBk</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6734"></a>                <span class="n">RGlDifFr</span>      <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-6735"></a>                <span class="n">RhoBlDifDifBk</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-6736"></a>                <span class="n">TransBeamWin</span>  <span class="o">=</span> <span class="n">TGlBmBack</span> <span class="o">*</span> <span class="p">(</span> <span class="n">TBlBmBmBack</span> <span class="o">+</span> <span class="n">TBlBmDiffBack</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6737"></a>                                  <span class="n">TBlDifDif</span><span class="o">*</span><span class="n">RhoBlBmDifBk</span><span class="o">*</span><span class="n">RGlDifFr</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RhoBlDifDifBk</span><span class="o">*</span><span class="n">RGlDifFr</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6738"></a>
<a name="ln-6739"></a>                 <span class="c">! Interior beam absorbed by EXTERIOR BLIND on exterior back window</span>
<a name="ln-6740"></a>
<a name="ln-6741"></a>                <span class="n">AbsBlBack</span>     <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamAbs</span><span class="p">)</span>
<a name="ln-6742"></a>                <span class="n">AbsBlDiffBack</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffAbs</span><span class="p">)</span>
<a name="ln-6743"></a>                <span class="n">RhoBlDiffBack</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-6744"></a>                <span class="n">ABlBack</span> <span class="o">=</span> <span class="n">TGlBmBack</span><span class="o">*</span><span class="p">(</span><span class="n">AbsBlBack</span> <span class="o">+</span> <span class="n">RhoBlBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="o">*</span><span class="n">AbsBlDiffBack</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">RhoBlDiffBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="p">))</span>
<a name="ln-6745"></a>                <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">ABlBack</span>
<a name="ln-6746"></a>                <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6747"></a>                  <span class="n">ABlBack</span> <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-6748"></a>              <span class="k">END IF</span>  <span class="c">! End of check if exterior blind on back window</span>
<a name="ln-6749"></a>
<a name="ln-6750"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6751"></a>
<a name="ln-6752"></a><span class="k">                </span><span class="n">t1k</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6753"></a>                <span class="n">t2k</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6754"></a>                <span class="n">af2k</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">afBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6755"></a>                <span class="n">ab1k</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">abBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6756"></a>                <span class="n">ab2k</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">abBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6757"></a>                <span class="n">rb1k</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rbBareSolCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6758"></a>                <span class="n">rb2k</span>    <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rbBareSolCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6759"></a>                <span class="n">td1k</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6760"></a>                <span class="n">td2k</span>    <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6761"></a>                <span class="n">afd2k</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">afBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6762"></a>                <span class="n">abd1k</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">abBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6763"></a>                <span class="n">abd2k</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">abBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6764"></a>                <span class="n">rfd2k</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rfBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6765"></a>                <span class="n">rbd1k</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rbBareSolDiff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6766"></a>                <span class="n">rbd2k</span>   <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rbBareSolDiff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-6767"></a>                <span class="n">tfshBBk</span> <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6768"></a>                                  <span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-6769"></a>                <span class="n">tfshBdk</span> <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontBeamDiffTrans</span><span class="p">)</span>
<a name="ln-6770"></a>                <span class="n">tfshdk</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontDiffDiffTrans</span><span class="p">)</span>
<a name="ln-6771"></a>                <span class="n">tbshBBk</span> <span class="o">=</span> <span class="n">BlindBeamBeamTrans</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">PI</span><span class="o">-</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6772"></a>                                  <span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="p">)</span>
<a name="ln-6773"></a>                <span class="n">tbshBdk</span> <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamDiffTrans</span><span class="p">)</span>
<a name="ln-6774"></a>                <span class="n">tbshdk</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffDiffTrans</span><span class="p">)</span>
<a name="ln-6775"></a>                <span class="n">rfshBk</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6776"></a>                <span class="n">rbshBk</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamDiffRefl</span><span class="p">)</span>
<a name="ln-6777"></a>                <span class="n">rfshdk</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontDiffDiffRefl</span><span class="p">)</span>
<a name="ln-6778"></a>                <span class="n">rbshdk</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffDiffRefl</span><span class="p">)</span>
<a name="ln-6779"></a>                <span class="n">afshdk</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontDiffAbs</span><span class="p">)</span>
<a name="ln-6780"></a>                <span class="n">abshdk</span>  <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackDiffAbs</span><span class="p">)</span>
<a name="ln-6781"></a>                <span class="n">afshBk</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolFrontBeamAbs</span><span class="p">)</span>
<a name="ln-6782"></a>                <span class="n">abshBk</span>  <span class="o">=</span> <span class="n">InterpProfSlatAng</span><span class="p">(</span><span class="n">ProfAngBack</span><span class="p">,</span><span class="n">SlatAngBack</span><span class="p">,</span><span class="n">VarSlatsBack</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNumBack</span><span class="p">)%</span><span class="n">SolBackBeamAbs</span><span class="p">)</span>
<a name="ln-6783"></a>
<a name="ln-6784"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NBackGlass</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6785"></a><span class="k">                  </span><span class="n">t3k</span>   <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">tBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6786"></a>                  <span class="n">af3k</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">afBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6787"></a>                  <span class="n">ab3k</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">abBareSolCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6788"></a>                  <span class="n">afd3k</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">afBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6789"></a>                  <span class="n">rfd3k</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">rfBareSolDiff</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-6790"></a>                <span class="k">END IF</span>
<a name="ln-6791"></a>
<a name="ln-6792"></a>                 <span class="c">! Interior beam absorptance of GLASS LAYERS of exterior back window with BETWEEN-GLASS BLIND</span>
<a name="ln-6793"></a>
<a name="ln-6794"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NBackGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6795"></a><span class="k">                  </span><span class="n">AbsBeamWin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ab2k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">tfshBBk</span><span class="o">*</span><span class="n">af2k</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6796"></a>                     <span class="n">t2k</span><span class="o">*</span><span class="p">(</span><span class="n">tbshBBk</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">tfshBdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">tfshdk</span> <span class="o">+</span> <span class="n">rbshBk</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rfd2k</span><span class="o">*</span><span class="n">rbshdk</span><span class="p">))</span><span class="o">*</span><span class="n">afd2k</span>
<a name="ln-6797"></a>                  <span class="n">AbsBeamWin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">t2k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="n">ab1k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="p">(</span><span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd2k</span><span class="o">*</span><span class="n">tbshdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rbd1k</span><span class="o">*</span><span class="n">rfshdk</span><span class="p">))</span><span class="o">*</span><span class="n">abd1k</span>
<a name="ln-6798"></a>                <span class="k">ELSE</span>  <span class="c">! NBackGlass = 3</span>
<a name="ln-6799"></a>                  <span class="n">AbsBeamWin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ab3k</span> <span class="o">+</span> <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="p">(</span><span class="n">rb2k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">t2k</span><span class="p">)</span><span class="o">*</span><span class="n">tfshBBk</span><span class="o">*</span><span class="n">af3k</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6800"></a>                     <span class="n">t3k</span><span class="o">*</span><span class="p">(</span><span class="n">tbshBdk</span><span class="o">*</span><span class="n">rbd2k</span><span class="o">*</span><span class="n">tfshdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">tfshdk</span> <span class="o">+</span> <span class="n">rbshBk</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rfd3k</span><span class="o">*</span><span class="n">rbshdk</span><span class="p">))</span><span class="o">*</span><span class="n">afd3k</span>
<a name="ln-6801"></a>                  <span class="n">AbsBeamWin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="p">(</span><span class="n">ab2k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="p">(</span><span class="n">af2k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">rfshBk</span><span class="o">*</span><span class="n">abd2k</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6802"></a>                     <span class="n">t3k</span><span class="o">*</span><span class="p">(</span><span class="n">tbshBdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2k</span> <span class="o">+</span> <span class="n">td2k</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">td2k</span><span class="p">)</span><span class="o">*</span><span class="n">rfshdk</span> <span class="o">+</span> <span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd3k</span><span class="o">*</span><span class="n">tbshdk</span><span class="p">)</span><span class="o">*</span><span class="n">abd2k</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6803"></a>                     <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBdk</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">afd2k</span>
<a name="ln-6804"></a>                  <span class="n">AbsBeamWin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="p">(</span><span class="n">t2k</span><span class="o">*</span><span class="n">ab1k</span> <span class="o">+</span> <span class="p">(</span><span class="n">rb2k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">t2k</span><span class="p">)</span><span class="o">*</span><span class="n">rfshBk</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">abd1k</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6805"></a>                     <span class="n">t3k</span><span class="o">*</span><span class="p">(</span><span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd3k</span><span class="o">*</span><span class="n">tbshdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rbd2k</span><span class="o">*</span><span class="n">rfshdk</span> <span class="o">+</span> <span class="n">td2k</span><span class="o">*</span><span class="n">rbd2k</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">rfshdk</span><span class="p">))</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">abd1k</span>
<a name="ln-6806"></a>                <span class="k">END IF</span>
<a name="ln-6807"></a>
<a name="ln-6808"></a>                 <span class="c">! Interior beam transmitted by exterior back window with BETWEEN-GLASS BLIND</span>
<a name="ln-6809"></a>
<a name="ln-6810"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NBackGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6811"></a><span class="k">                  </span><span class="n">TransBeamWin</span> <span class="o">=</span> <span class="n">t2k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="n">t1k</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6812"></a>                     <span class="n">t2k</span><span class="o">*</span><span class="p">(</span><span class="n">tbshBBk</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">rfshBk</span> <span class="o">+</span> <span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd2k</span><span class="o">*</span><span class="n">tbshdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">+</span> <span class="n">rbd1k</span><span class="o">*</span><span class="n">rfshdk</span><span class="p">))</span><span class="o">*</span><span class="n">td1k</span>
<a name="ln-6813"></a>                <span class="k">ELSE</span>  <span class="c">! NGlass = 3</span>
<a name="ln-6814"></a>                  <span class="n">TransBeamWin</span> <span class="o">=</span> <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="n">t2k</span><span class="o">*</span><span class="n">t1k</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6815"></a>                     <span class="n">t3k</span><span class="o">*</span><span class="p">(</span><span class="n">tbshBBk</span><span class="o">*</span><span class="p">(</span><span class="n">rb2k</span><span class="o">*</span><span class="n">rfshBk</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">t2k</span><span class="o">*</span><span class="n">rfshBk</span><span class="p">)</span> <span class="o">+</span> <span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd3k</span><span class="o">*</span><span class="n">tbshdk</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6816"></a>                        <span class="n">tbshBdk</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">+</span> <span class="n">rbd2k</span><span class="o">*</span><span class="n">rfshdk</span> <span class="o">+</span> <span class="n">td2k</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">rfshdk</span><span class="p">))</span><span class="o">*</span><span class="n">td2k</span><span class="o">*</span><span class="n">td1k</span>
<a name="ln-6817"></a>                <span class="k">END IF</span>
<a name="ln-6818"></a>
<a name="ln-6819"></a>                 <span class="c">! Interior beam absorbed by BLIND on exterior back window with BETWEEN-GLASS BLIND</span>
<a name="ln-6820"></a>
<a name="ln-6821"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">NBackGlass</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6822"></a><span class="k">                  </span><span class="n">ABlBack</span> <span class="o">=</span> <span class="n">t2k</span><span class="o">*</span><span class="p">(</span><span class="n">abshBk</span> <span class="o">+</span> <span class="n">tbshBBk</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">afshBk</span> <span class="o">+</span> <span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd2k</span><span class="o">*</span><span class="n">abshdk</span> <span class="o">+</span> <span class="n">tbshBdk</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">afshdk</span><span class="p">)</span>
<a name="ln-6823"></a>                <span class="k">ELSE</span>  <span class="c">! NBackGlass = 3</span>
<a name="ln-6824"></a>                  <span class="n">ABlBack</span> <span class="o">=</span> <span class="n">t3k</span><span class="o">*</span><span class="n">abshBk</span> <span class="o">+</span> <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBBk</span><span class="o">*</span><span class="p">(</span><span class="n">rb2k</span> <span class="o">+</span> <span class="n">t2k</span><span class="o">*</span><span class="n">rb1k</span><span class="o">*</span><span class="n">t2k</span><span class="p">)</span><span class="o">*</span><span class="n">afshBk</span> <span class="o">+</span> <span class="n">t3k</span><span class="o">*</span><span class="n">rbshBk</span><span class="o">*</span><span class="n">rfd3k</span><span class="o">*</span><span class="n">abshdk</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6825"></a>                     <span class="n">t3k</span><span class="o">*</span><span class="n">tbshBdk</span><span class="o">*</span><span class="p">(</span><span class="n">rbd2k</span> <span class="o">+</span> <span class="n">td2k</span><span class="o">*</span><span class="n">rbd1k</span><span class="o">*</span><span class="n">td2k</span><span class="p">)</span><span class="o">*</span><span class="n">afshdk</span>
<a name="ln-6826"></a>                <span class="k">END IF</span>
<a name="ln-6827"></a>
<a name="ln-6828"></a><span class="k">                </span><span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">ABlBack</span>
<a name="ln-6829"></a>                <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">ABlBack</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-6830"></a>
<a name="ln-6831"></a>              <span class="k">END IF</span>  <span class="c">! End of check if between-glass blind is on back window</span>
<a name="ln-6832"></a>
<a name="ln-6833"></a>            <span class="k">END IF</span>  <span class="c">! End of check if blind is on back window</span>
<a name="ln-6834"></a>
<a name="ln-6835"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6836"></a>
<a name="ln-6837"></a>              <span class="c">! Interior beam absorptance of GLASS LAYERS of exterior back window with EXTERIOR SCREEN</span>
<a name="ln-6838"></a>              <span class="n">ScNumBack</span>     <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">ScreenNumber</span>
<a name="ln-6839"></a>              <span class="n">TGlBmBack</span>     <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6840"></a>              <span class="n">RGlDiffFront</span>  <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-6841"></a>              <span class="n">TScBmBmBack</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">BmBmTransBack</span>
<a name="ln-6842"></a>              <span class="n">TScBmDiffBack</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">BmDifTransBack</span>
<a name="ln-6843"></a>              <span class="n">RScBack</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">ReflectSolBeamFront</span>
<a name="ln-6844"></a>              <span class="n">RScDifBack</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">DifReflect</span>
<a name="ln-6845"></a>              <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6846"></a>                <span class="n">AbWinBack</span>   <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6847"></a>                <span class="n">AGlDiffFront</span><span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">AbsDiff</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-6848"></a>                <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbWinBack</span> <span class="o">+</span> <span class="p">(</span><span class="n">TGlBmBack</span><span class="o">*</span><span class="n">AGlDiffFront</span><span class="o">*</span><span class="n">RScBack</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.d0</span> <span class="o">-</span> <span class="n">RScDifBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="p">))</span>
<a name="ln-6849"></a>              <span class="k">END DO</span>
<a name="ln-6850"></a>
<a name="ln-6851"></a>               <span class="c">! Interior beam transmitted by exterior back window with EXTERIOR SCREEN</span>
<a name="ln-6852"></a>
<a name="ln-6853"></a>              <span class="n">TScDifDif</span>     <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">DifDifTrans</span>
<a name="ln-6854"></a>              <span class="n">RScBmDifBk</span>       <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">ReflectSolBeamBack</span>
<a name="ln-6855"></a>              <span class="n">RGlDifFr</span>      <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffFront</span>
<a name="ln-6856"></a>              <span class="n">RScDifDifBk</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">DifReflect</span>
<a name="ln-6857"></a>              <span class="n">TransBeamWin</span>  <span class="o">=</span> <span class="n">TGlBmBack</span> <span class="o">*</span> <span class="p">(</span> <span class="n">TScBmBmBack</span> <span class="o">+</span> <span class="n">TScBmDiffBack</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6858"></a>                                <span class="n">TScDifDif</span><span class="o">*</span><span class="n">RScBmDifBk</span><span class="o">*</span><span class="n">RGlDifFr</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RScDifDifBk</span><span class="o">*</span><span class="n">RGlDifFr</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-6859"></a>
<a name="ln-6860"></a>               <span class="c">! Interior beam absorbed by EXTERIOR SCREEN on exterior back window</span>
<a name="ln-6861"></a>
<a name="ln-6862"></a>              <span class="n">AbsScBack</span>     <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">AbsorpSolarBeamBack</span>
<a name="ln-6863"></a>              <span class="n">AbsScDiffBack</span> <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">DifScreenAbsorp</span>
<a name="ln-6864"></a>              <span class="n">RScDiffBack</span>   <span class="o">=</span> <span class="n">SurfaceScreens</span><span class="p">(</span><span class="n">ScNumBack</span><span class="p">)%</span><span class="n">ReflectSolBeamFront</span>
<a name="ln-6865"></a>              <span class="n">AScBack</span> <span class="o">=</span> <span class="n">TGlBmBack</span><span class="o">*</span><span class="p">(</span><span class="n">AbsScBack</span> <span class="o">+</span> <span class="n">RScBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="o">*</span><span class="n">AbsScDiffBack</span><span class="o">/</span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">RScDiffBack</span><span class="o">*</span><span class="n">RGlDiffFront</span><span class="p">))</span>
<a name="ln-6866"></a>              <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AScBack</span>
<a name="ln-6867"></a>              <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6868"></a>                <span class="n">AScBack</span> <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-6869"></a>            <span class="k">END IF</span>  <span class="c">! End of check if exterior screen on back window</span>
<a name="ln-6870"></a>
<a name="ln-6871"></a>                 <span class="c">! Interior beam absorptance of glass layers of back exterior window with SWITCHABLE GLAZING</span>
<a name="ln-6872"></a>
<a name="ln-6873"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlagBack</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6874"></a>
<a name="ln-6875"></a><span class="k">              </span><span class="n">SwitchFacBack</span>   <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span>
<a name="ln-6876"></a>              <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6877"></a>                <span class="n">AbsBeamWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">AbsBeamBackCoef</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6878"></a>              <span class="k">END DO</span>
<a name="ln-6879"></a><span class="k">              DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6880"></a>                <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>    <span class="o">=</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">),</span><span class="n">AbsBeamWinSh</span><span class="p">(</span><span class="n">Lay</span><span class="p">))</span>
<a name="ln-6881"></a>              <span class="k">END DO</span>
<a name="ln-6882"></a><span class="k">              </span><span class="n">TransBeamWinSh</span>  <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncBack</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBackSh</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-6883"></a>              <span class="n">TransBeamWin</span>    <span class="o">=</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SwitchFac</span><span class="p">,</span><span class="n">TransBeamWin</span><span class="p">,</span><span class="n">TransBeamWinSh</span><span class="p">)</span>
<a name="ln-6884"></a>            <span class="k">END IF</span>
<a name="ln-6885"></a>
<a name="ln-6886"></a>                 <span class="c">! Sum of interior beam absorbed by all glass layers of back window</span>
<a name="ln-6887"></a>
<a name="ln-6888"></a>            <span class="n">AbsBeamTotWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6889"></a>            <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NBackGlass</span>
<a name="ln-6890"></a>              <span class="n">AbsBeamTotWin</span> <span class="o">=</span> <span class="n">AbsBeamTotWin</span> <span class="o">+</span> <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-6891"></a>              <span class="n">AWinSurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AWinSurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>    <span class="c">![-]</span>
<a name="ln-6892"></a>                <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsBeamWin</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-6893"></a>            <span class="k">END DO</span>
<a name="ln-6894"></a>
<a name="ln-6895"></a>                 <span class="c">! To BABSZon, add interior beam glass absorption and overall beam transmission for this back window</span>
<a name="ln-6896"></a>
<a name="ln-6897"></a>            <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="p">(</span><span class="n">AbsBeamTotWin</span> <span class="o">+</span> <span class="n">TransBeamWin</span><span class="p">)</span>
<a name="ln-6898"></a>
<a name="ln-6899"></a>                 <span class="c">! Interior beam transmitted to adjacent zone through an interior back window (assumed unshaded);</span>
<a name="ln-6900"></a>                 <span class="c">! this beam radiation is categorized as diffuse radiation in the adjacent zone.</span>
<a name="ln-6901"></a>
<a name="ln-6902"></a>            <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-6903"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6904"></a><span class="k">              </span><span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-6905"></a>              <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">TransBeamWin</span>  <span class="c">![m2]</span>
<a name="ln-6906"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-6907"></a>                    <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">TransBeamWin</span> <span class="o">*</span> <span class="n">BeamSolarRad</span>   <span class="c">![W]</span>
<a name="ln-6908"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRepEnergy</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="p">&amp;</span>
<a name="ln-6909"></a>                    <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-6910"></a>            <span class="k">END IF</span>
<a name="ln-6911"></a><span class="k">          END IF</span>  <span class="c">! End of check if back surface is opaque or window</span>
<a name="ln-6912"></a>          <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Boverlap</span>
<a name="ln-6913"></a>          <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-6914"></a>        <span class="k">END DO</span>  <span class="c">! End of loop over back surfaces</span>
<a name="ln-6915"></a>       <span class="k">ELSE IF</span>  <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6916"></a>         <span class="c">! For complex window calculation goes over outgoing basis directions</span>
<a name="ln-6917"></a>         <span class="c">! for current state</span>
<a name="ln-6918"></a>         <span class="n">CurCplxFenState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-6919"></a>
<a name="ln-6920"></a>         <span class="c">! Get construction number which keeps transmittance properties</span>
<a name="ln-6921"></a>         <span class="n">IConst</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Konst</span>
<a name="ln-6922"></a>
<a name="ln-6923"></a>         <span class="n">FenSolAbsPtr</span> <span class="o">=</span> <span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">IConst</span><span class="p">)</span>
<a name="ln-6924"></a>
<a name="ln-6925"></a>         <span class="c">! Solar radiation from this window will be calculated only in case when this window is not scheduled surface gained</span>
<a name="ln-6926"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">FenSolAbsPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6927"></a>           <span class="c">! Current incoming direction number (Sun direction)</span>
<a name="ln-6928"></a>           <span class="n">IBm</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">SolBmIndex</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-6929"></a>
<a name="ln-6930"></a>           <span class="c">! Report variables for complex fenestration here</span>
<a name="ln-6931"></a>           <span class="n">BSDFBeamDirectionRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">IBm</span>
<a name="ln-6932"></a>           <span class="n">BSDFBeamThetaRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">ThetaBm</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-6933"></a>           <span class="n">BSDFBeamPhiRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">PhiBm</span><span class="p">(</span><span class="n">HourOfDay</span><span class="p">,</span> <span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-6934"></a>
<a name="ln-6935"></a>           <span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-6936"></a>           <span class="c">! Get total number of back surfaces for current window (surface)</span>
<a name="ln-6937"></a>           <span class="c">! Note that it is organized by base surface</span>
<a name="ln-6938"></a>           <span class="n">NBkSurf</span>   <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">NumBackSurf</span>
<a name="ln-6939"></a>
<a name="ln-6940"></a>           <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">CFBoverlap</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6941"></a><span class="k">             ALLOCATE</span><span class="p">(</span><span class="n">CFBoverlap</span><span class="p">(</span><span class="n">NBkSurf</span><span class="p">))</span>
<a name="ln-6942"></a>           <span class="k">END IF</span>
<a name="ln-6943"></a>
<a name="ln-6944"></a><span class="k">           IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">CFDirBoverlap</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6945"></a><span class="k">             ALLOCATE</span><span class="p">(</span><span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span><span class="p">,</span> <span class="n">NBkSurf</span><span class="p">))</span>
<a name="ln-6946"></a>           <span class="k">END IF</span>
<a name="ln-6947"></a>
<a name="ln-6948"></a><span class="k">           </span><span class="n">CFBoverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6949"></a>           <span class="c">! delete values from previous timestep</span>
<a name="ln-6950"></a>           <span class="n">AWinCFOverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6951"></a>
<a name="ln-6952"></a>           <span class="c">! Calculate effects on all back surfaces for each of basis directions.  Each of basis directions from the back of the</span>
<a name="ln-6953"></a>           <span class="c">! window has to be considered as beam and therefore calcualte CFBoverlap for each of them</span>
<a name="ln-6954"></a>           <span class="k">DO </span><span class="n">CurTrnDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-6955"></a>             <span class="n">CurLambda</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">Lamda</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">)</span>
<a name="ln-6956"></a>             <span class="n">DirTrans</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">BSDFInput</span><span class="p">%</span><span class="n">SolFrtTrans</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBm</span><span class="p">)</span>
<a name="ln-6957"></a>             <span class="c">! Now calculate effect of this direction on all back surfaces</span>
<a name="ln-6958"></a>             <span class="k">DO </span><span class="n">IBack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NBkSurf</span>
<a name="ln-6959"></a>              <span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-6960"></a>                <span class="n">Aoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span> <span class="o">*</span> <span class="n">DirTrans</span> <span class="o">*</span> <span class="n">CurLambda</span> <span class="o">*</span> <span class="n">CosInc</span>
<a name="ln-6961"></a>              <span class="n">CFBoverlap</span><span class="p">(</span><span class="n">IBack</span><span class="p">)</span> <span class="o">=</span> <span class="n">CFBoverlap</span><span class="p">(</span><span class="n">IBack</span><span class="p">)</span> <span class="o">+</span> <span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span>
<a name="ln-6962"></a>             <span class="k">END DO</span> <span class="c">! DO IBack = 1,MaxBkSurf</span>
<a name="ln-6963"></a>           <span class="k">END DO</span>
<a name="ln-6964"></a>
<a name="ln-6965"></a>           <span class="c">! Summarizing results</span>
<a name="ln-6966"></a>           <span class="k">DO </span><span class="n">IBack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NBkSurf</span>
<a name="ln-6967"></a>             <span class="n">BackSurfaceNumber</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">IBack</span><span class="p">)</span>
<a name="ln-6968"></a>             <span class="n">ConstrNumBack</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-6969"></a>
<a name="ln-6970"></a>             <span class="c">! Do not perform any calculation if surface is scheduled for incoming solar radiation</span>
<a name="ln-6971"></a>             <span class="n">SurfSolIncPtr</span> <span class="o">=</span> <span class="n">SurfaceScheduledSolarInc</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span> <span class="n">ConstrNumBack</span><span class="p">)</span>
<a name="ln-6972"></a>
<a name="ln-6973"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">SurfSolIncPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6974"></a>                <span class="c">! Surface hit is another complex fenestration</span>
<a name="ln-6975"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6976"></a><span class="k">                  </span><span class="n">CurBackState</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">CurrentState</span>
<a name="ln-6977"></a>
<a name="ln-6978"></a>                  <span class="c">! Do not take into account this window if it is scheduled for surface gains</span>
<a name="ln-6979"></a>                  <span class="n">FenSolAbsPtr</span> <span class="o">=</span> <span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span> <span class="n">ConstrNumBack</span><span class="p">)</span>
<a name="ln-6980"></a>
<a name="ln-6981"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">FenSolAbsPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6982"></a>                    <span class="c">! Calculate energy loss per each outgoing orientation</span>
<a name="ln-6983"></a>                    <span class="k">DO </span><span class="n">CurTrnDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-6984"></a>                      <span class="k">DO </span><span class="n">CurBackDir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span>
<a name="ln-6985"></a>                         <span class="c">! Purpose of this part is to find best match for outgoing beam number of window back surface and incoming beam</span>
<a name="ln-6986"></a>                         <span class="c">! number of complex fenestration which this beam will hit on (back surface again)</span>
<a name="ln-6987"></a>                         <span class="n">tempVec1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-6988"></a>                         <span class="n">tempVec1</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-6989"></a>                         <span class="n">tempVec1</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurCplxFenState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-6990"></a>                         <span class="n">tempVec2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">CurBackDir</span><span class="p">)%</span><span class="n">X</span>
<a name="ln-6991"></a>                         <span class="n">tempVec2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">CurBackDir</span><span class="p">)%</span><span class="n">Y</span>
<a name="ln-6992"></a>                         <span class="n">tempVec2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">CurBackDir</span><span class="p">)%</span><span class="n">Z</span>
<a name="ln-6993"></a>                         <span class="n">curDot</span> <span class="o">=</span> <span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">tempVec1</span><span class="p">,</span> <span class="n">tempVec2</span><span class="p">)</span>
<a name="ln-6994"></a>                         <span class="k">IF</span> <span class="p">(</span><span class="n">CurBackDir</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6995"></a><span class="k">                           </span><span class="n">bestDot</span> <span class="o">=</span> <span class="n">curDot</span>
<a name="ln-6996"></a>                           <span class="n">bestTrn</span> <span class="o">=</span> <span class="n">CurTrnDir</span>
<a name="ln-6997"></a>                           <span class="n">bestBackTrn</span> <span class="o">=</span> <span class="n">CurBackDir</span>
<a name="ln-6998"></a>                         <span class="k">ELSE</span>
<a name="ln-6999"></a><span class="k">                           IF</span> <span class="p">(</span><span class="n">curDot</span> <span class="o">&lt;</span> <span class="n">bestDot</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7000"></a><span class="k">                             </span><span class="n">bestDot</span> <span class="o">=</span> <span class="n">curDot</span>
<a name="ln-7001"></a>                             <span class="n">bestTrn</span> <span class="o">=</span> <span class="n">CurTrnDir</span>
<a name="ln-7002"></a>                             <span class="n">bestBackTrn</span> <span class="o">=</span> <span class="n">CurBackDir</span>
<a name="ln-7003"></a>                           <span class="k">END IF</span>
<a name="ln-7004"></a><span class="k">                         END IF</span>
<a name="ln-7005"></a><span class="k">                      END DO</span>
<a name="ln-7006"></a>                      <span class="c">! CurLambda = ComplexWind(BackSurfaceNumber)%Geom(CurBackState)%Trn%Lamda(CurTrnDir)</span>
<a name="ln-7007"></a>                      <span class="c">! Add influence of this exact direction to what stays in the zone.  It is important to note that</span>
<a name="ln-7008"></a>                      <span class="c">! this needs to be done for each outgoing direction</span>
<a name="ln-7009"></a>                      <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7010"></a>                         <span class="p">&amp;</span>     <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">IntegratedBkRefl</span><span class="p">(</span><span class="n">bestBackTrn</span><span class="p">))</span>
<a name="ln-7011"></a>
<a name="ln-7012"></a>                      <span class="c">! Absorptance from current back direction</span>
<a name="ln-7013"></a>                      <span class="n">TotSolidLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TotSolidLayers</span>
<a name="ln-7014"></a>                      <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSolidLay</span>
<a name="ln-7015"></a>                       <span class="c">!IF (ALLOCATED(Construct(ConstrNumBack)%BSDFInput)) THEN</span>
<a name="ln-7016"></a>                         <span class="c">! CFDirBoverlap is energy transmitted for current basis beam.  It is important to note that AWinOverlap array</span>
<a name="ln-7017"></a>                         <span class="c">! needs to contain flux and not absorbed energy because later in the code this will be multiplied with window</span>
<a name="ln-7018"></a>                         <span class="c">! area</span>
<a name="ln-7019"></a>                         <span class="n">AWinCFOverlap</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span> <span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AWinCFOverlap</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span> <span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7020"></a>                           <span class="p">&amp;</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">BSDFInput</span><span class="p">%</span><span class="n">Layer</span><span class="p">(</span><span class="n">Lay</span><span class="p">)%</span><span class="n">BkAbs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bestBackTrn</span><span class="p">)</span> <span class="o">*</span> <span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7021"></a>                           <span class="p">&amp;</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7022"></a>                       <span class="c">!END IF</span>
<a name="ln-7023"></a>                      <span class="k">END DO</span>
<a name="ln-7024"></a>
<a name="ln-7025"></a>                      <span class="c">! Interior beam transmitted to adjacent zone through an interior back window;</span>
<a name="ln-7026"></a>                      <span class="c">! This beam radiation is categorized as diffuse radiation in the adjacent zone.</span>
<a name="ln-7027"></a>                      <span class="c">! Note that this is done for each outgoing direction of exterior window</span>
<a name="ln-7028"></a>
<a name="ln-7029"></a>                      <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-7030"></a>                      <span class="k">IF</span><span class="p">(</span><span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7031"></a><span class="k">                         </span><span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7032"></a>                         <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7033"></a>                           <span class="p">&amp;</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">IntegratedBkTrans</span><span class="p">(</span><span class="n">bestBackTrn</span><span class="p">)</span>
<a name="ln-7034"></a>                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7035"></a>                           <span class="p">&amp;</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7036"></a>                           <span class="p">&amp;</span> <span class="n">CFDirBoverlap</span><span class="p">(</span><span class="n">CurTrnDir</span><span class="p">,</span> <span class="n">IBack</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7037"></a>                           <span class="p">&amp;</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">ComplexFen</span><span class="p">%</span><span class="n">State</span><span class="p">(</span><span class="n">CurBackState</span><span class="p">)%</span><span class="n">IntegratedBkTrans</span><span class="p">(</span><span class="n">bestBackTrn</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7038"></a>                           <span class="p">&amp;</span> <span class="n">BeamSolarRad</span>   <span class="c">![W]</span>
<a name="ln-7039"></a>                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRepEnergy</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-7040"></a>                           <span class="p">&amp;</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="p">&amp;</span>
<a name="ln-7041"></a>                           <span class="p">&amp;</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7042"></a>                      <span class="k">END IF</span>
<a name="ln-7043"></a><span class="k">                    END DO</span>
<a name="ln-7044"></a><span class="k">                  END IF</span>
<a name="ln-7045"></a><span class="k">                ELSE</span>
<a name="ln-7046"></a><span class="k">                   IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7047"></a>                     <span class="c">! Do not take into account this window if it is scheduled for surface gains</span>
<a name="ln-7048"></a>                     <span class="n">SurfSolIncPtr</span> <span class="o">=</span> <span class="n">SurfaceScheduledSolarInc</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span> <span class="n">ConstrNumBack</span><span class="p">)</span>
<a name="ln-7049"></a>
<a name="ln-7050"></a>                     <span class="k">IF</span> <span class="p">(</span><span class="n">SurfSolIncPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7051"></a><span class="k">                      </span><span class="n">AbsIntSurf</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>
<a name="ln-7052"></a>                      <span class="n">AISurf</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)</span> <span class="o">=</span> <span class="n">AISurf</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)</span> <span class="o">+</span> <span class="n">CFBoverlap</span><span class="p">(</span><span class="n">IBack</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7053"></a>                         <span class="n">AbsIntSurf</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7054"></a>                      <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">CFBoverlap</span><span class="p">(</span><span class="n">IBack</span><span class="p">)</span> <span class="o">*</span> <span class="n">AbsIntSurf</span>
<a name="ln-7055"></a>                     <span class="k">END IF</span>
<a name="ln-7056"></a><span class="k">                   ELSE</span>
<a name="ln-7057"></a>                     <span class="c">! Code for mixed windows goes here.  It is same as above code for &quot;ordinary&quot; windows.</span>
<a name="ln-7058"></a>                     <span class="c">! Try to do something which will not produce duplicate code.</span>
<a name="ln-7059"></a>                   <span class="n">ENDIF</span>
<a name="ln-7060"></a>                <span class="n">ENDIF</span>
<a name="ln-7061"></a>             <span class="n">ENDIF</span>
<a name="ln-7062"></a>           <span class="k">END DO</span>
<a name="ln-7063"></a>
<a name="ln-7064"></a><span class="k">           IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">CFBoverlap</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">CFBoverlap</span><span class="p">)</span>
<a name="ln-7065"></a>           <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">CFDirBoverlap</span><span class="p">))</span> <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">CFDirBoverlap</span><span class="p">)</span>
<a name="ln-7066"></a>         <span class="k">END IF</span>
<a name="ln-7067"></a>
<a name="ln-7068"></a><span class="k">       ELSE IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7069"></a>
<a name="ln-7070"></a><span class="k">         DO </span><span class="n">IBack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">MaxBkSurf</span>
<a name="ln-7071"></a>
<a name="ln-7072"></a>            <span class="n">BackSurfNum</span> <span class="o">=</span> <span class="n">BackSurfaces</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">IBack</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-7073"></a>
<a name="ln-7074"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">BackSurfNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">EXIT</span>   <span class="c">! No more irradiated back surfaces for this exterior window</span>
<a name="ln-7075"></a>            <span class="k">IF</span> <span class="p">(</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">IBack</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! only EQL back window is allowed</span>
<a name="ln-7076"></a>
<a name="ln-7077"></a>            <span class="n">ConstrNumBack</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7078"></a>            <span class="n">NBackGlass</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-7079"></a>                <span class="c">! Irradiated (overlap) area for this back surface, projected onto window plane</span>
<a name="ln-7080"></a>                <span class="c">! (includes effect of shadowing on exterior window)</span>
<a name="ln-7081"></a>            <span class="n">Aoverlap</span> <span class="o">=</span> <span class="n">OverlapAreas</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">IBack</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-7082"></a>            <span class="n">Boverlap</span> <span class="o">=</span> <span class="n">TBm</span> <span class="o">*</span> <span class="n">Aoverlap</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="c">![m2]</span>
<a name="ln-7083"></a>
<a name="ln-7084"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7085"></a>
<a name="ln-7086"></a>                <span class="c">! Back surface is opaque interior or exterior wall</span>
<a name="ln-7087"></a>
<a name="ln-7088"></a>                <span class="n">AbsIntSurf</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>
<a name="ln-7089"></a>
<a name="ln-7090"></a>                <span class="c">! Check for movable insulation; reproduce code from subr. EvalInsideMovableInsulation;</span>
<a name="ln-7091"></a>                <span class="c">! Can&#39;t call that routine here since cycle prevents SolarShadingGeometry from USEing</span>
<a name="ln-7092"></a>                <span class="c">! HeatBalanceSurfaceManager, which contains EvalInsideMovableInsulation</span>
<a name="ln-7093"></a>                <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7094"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7095"></a><span class="k">                    </span><span class="n">MovInsulSchedVal</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span><span class="p">)</span>
<a name="ln-7096"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Movable insulation not present at current time</span>
<a name="ln-7097"></a>                    <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7098"></a>                    <span class="k">ELSE</span>  <span class="c">! Movable insulation present</span>
<a name="ln-7099"></a>                    <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">Resistance</span><span class="p">)</span>
<a name="ln-7100"></a>                    <span class="n">AbsInt</span>    <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">AbsorpSolar</span>
<a name="ln-7101"></a>                    <span class="k">END IF</span>
<a name="ln-7102"></a><span class="k">                END IF</span>
<a name="ln-7103"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">AbsIntSurf</span> <span class="o">=</span> <span class="n">AbsInt</span>  <span class="c">! Movable inside insulation present</span>
<a name="ln-7104"></a>
<a name="ln-7105"></a>                <span class="n">AISurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AISurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>     <span class="c">![-]</span>
<a name="ln-7106"></a>                    <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsIntSurf</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7107"></a>                <span class="n">BABSZone</span>            <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsIntSurf</span>       <span class="c">![m2]</span>
<a name="ln-7108"></a>
<a name="ln-7109"></a>            <span class="k">ELSE</span>
<a name="ln-7110"></a>
<a name="ln-7111"></a>                <span class="c">! Back surface is an interior or exterior window</span>
<a name="ln-7112"></a>                <span class="c">! Note that exterior back windows with and without shades are treated as defined.</span>
<a name="ln-7113"></a>                <span class="c">! Equivalent Layer window model has no distinction when treating windows with and</span>
<a name="ln-7114"></a>                <span class="c">! without shades (interior, inbetween and exterior shades)</span>
<a name="ln-7115"></a>
<a name="ln-7116"></a>                <span class="n">CosIncBack</span>      <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">))</span>
<a name="ln-7117"></a>                <span class="c">!</span>
<a name="ln-7118"></a>                <span class="c">!  Note in equivalent layer window model if storm window exists it is defined as part of</span>
<a name="ln-7119"></a>                <span class="c">!  window construction, hence it does not require a separate treatment</span>
<a name="ln-7120"></a>                <span class="n">AbsBeamWinEQL</span>   <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7121"></a>                <span class="n">TransBeamWin</span>    <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7122"></a>
<a name="ln-7123"></a>                <span class="c">! Interior beam absorptance of glass layers and beam transmittance of back exterior  &amp;</span>
<a name="ln-7124"></a>                <span class="c">! or interior window (treates windows with/without shades as defined) for this timestep</span>
<a name="ln-7125"></a>
<a name="ln-7126"></a>                <span class="c">! call the ASHWAT fenestration model for beam radiation here</span>
<a name="ln-7127"></a>                <span class="k">CALL </span><span class="n">CalcEQLOpticalProperty</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span> <span class="n">isBEAM</span><span class="p">,</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">)</span>
<a name="ln-7128"></a>
<a name="ln-7129"></a>                <span class="n">EQLNum</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumBack</span><span class="p">)%</span><span class="n">EQLConsPtr</span>
<a name="ln-7130"></a>                <span class="n">AbsBeamWinEQL</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="p">)</span> <span class="o">=</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7131"></a>                <span class="c">! get the interior beam transmitted through back exterior or interior EQL window</span>
<a name="ln-7132"></a>                <span class="n">TransBeamWin</span> <span class="o">=</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7133"></a>                <span class="c">!   Absorbed by the interior shade layer of back exterior window</span>
<a name="ln-7134"></a>                <span class="k">IF</span> <span class="p">(</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">L</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="p">)%</span><span class="n">LTYPE</span> <span class="o">/=</span> <span class="n">ltyGLAZE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7135"></a><span class="k">                    </span><span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7136"></a>                           <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-7137"></a>                    <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7138"></a>                <span class="n">ENDIF</span>
<a name="ln-7139"></a>                <span class="c">!   Absorbed by the exterior shade layer of back exterior window</span>
<a name="ln-7140"></a>                <span class="k">IF</span> <span class="p">(</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">LTYPE</span> <span class="o">/=</span> <span class="n">ltyGLAZE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7141"></a><span class="k">                    </span><span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7142"></a>                           <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-7143"></a>                    <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7144"></a>                <span class="n">ENDIF</span>
<a name="ln-7145"></a>
<a name="ln-7146"></a>                <span class="c">! determine the number of glass layers</span>
<a name="ln-7147"></a>                <span class="n">NBackGlass</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7148"></a>                <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span>
<a name="ln-7149"></a>                 <span class="k">IF</span> <span class="p">(</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">L</span><span class="p">(</span><span class="n">Lay</span><span class="p">)%</span><span class="n">LTYPE</span> <span class="o">/=</span> <span class="n">ltyGLAZE</span> <span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7150"></a><span class="k">                 </span><span class="n">NBackGlass</span> <span class="o">=</span> <span class="n">NBackGlass</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7151"></a>                <span class="k">END DO</span>
<a name="ln-7152"></a><span class="k">                IF</span> <span class="p">(</span><span class="n">NBackGlass</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7153"></a>                 <span class="c">! If the number of glass is greater than 2, in between glass shade can be present</span>
<a name="ln-7154"></a>                 <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7155"></a>                    <span class="k">IF</span> <span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">L</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="p">)%</span><span class="n">LTYPE</span> <span class="o">/=</span> <span class="n">ltyGLAZE</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7156"></a>                       <span class="c">! if there is in between shade glass determine the shade absorptance</span>
<a name="ln-7157"></a>                       <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7158"></a>                         <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7159"></a>                       <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7160"></a>                    <span class="k">END IF</span>
<a name="ln-7161"></a><span class="k">                 END DO</span>
<a name="ln-7162"></a><span class="k">                </span><span class="n">ENDIF</span>
<a name="ln-7163"></a>                <span class="c">! Sum of interior beam absorbed by all glass layers of back window</span>
<a name="ln-7164"></a>                <span class="n">AbsBeamTotWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7165"></a>                <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span>
<a name="ln-7166"></a>                    <span class="n">AbsBeamTotWin</span> <span class="o">=</span> <span class="n">AbsBeamTotWin</span> <span class="o">+</span> <span class="n">AbsBeamWinEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-7167"></a>                    <span class="n">AWinSurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AWinSurf</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>    <span class="c">![-]</span>
<a name="ln-7168"></a>                    <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">AbsBeamWinEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-7169"></a>                <span class="k">END DO</span>
<a name="ln-7170"></a>
<a name="ln-7171"></a>                <span class="c">! To BABSZon, add interior beam glass absorption and overall beam transmission for this back window</span>
<a name="ln-7172"></a>
<a name="ln-7173"></a>                <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="p">(</span><span class="n">AbsBeamTotWin</span> <span class="o">+</span> <span class="n">TransBeamWin</span><span class="p">)</span>
<a name="ln-7174"></a>
<a name="ln-7175"></a>                <span class="c">! Interior beam transmitted to adjacent zone through an interior back window (assumed unshaded);</span>
<a name="ln-7176"></a>                <span class="c">! this beam radiation is categorized as diffuse radiation in the adjacent zone.</span>
<a name="ln-7177"></a>
<a name="ln-7178"></a>                <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-7179"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7180"></a><span class="k">                    </span><span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7181"></a>                    <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">TransBeamWin</span>  <span class="c">![m2]</span>
<a name="ln-7182"></a>                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7183"></a>                        <span class="n">Boverlap</span> <span class="o">*</span> <span class="n">TransBeamWin</span> <span class="o">*</span> <span class="n">BeamSolarRad</span>   <span class="c">![W]</span>
<a name="ln-7184"></a>                    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRepEnergy</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)%</span><span class="n">BmSolTransThruIntWinRep</span> <span class="p">&amp;</span>
<a name="ln-7185"></a>                        <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7186"></a>                <span class="k">END IF</span>
<a name="ln-7187"></a><span class="k">            END IF</span>  <span class="c">! End of check if back surface is opaque or window</span>
<a name="ln-7188"></a>            <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Boverlap</span>
<a name="ln-7189"></a>            <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">BackSurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7190"></a>         <span class="k">END DO</span>  <span class="c">! End of loop over back surfaces</span>
<a name="ln-7191"></a>
<a name="ln-7192"></a>         <span class="c">!  *****************************</span>
<a name="ln-7193"></a>
<a name="ln-7194"></a>       <span class="k">END IF</span> <span class="c">! IF (SurfaceWindow(SurfNum)%WindowModelType /= WindowBSDFModel) THEN</span>
<a name="ln-7195"></a>      <span class="k">ELSE</span>  <span class="c">! Simple interior solar distribution. All beam from exterior windows falls on floor;</span>
<a name="ln-7196"></a>            <span class="c">! some of this is absorbed/transmitted, rest is reflected to other surfaces.</span>
<a name="ln-7197"></a>
<a name="ln-7198"></a>        <span class="k">DO </span><span class="n">FloorNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-7199"></a>          <span class="c">! In following, ISABSF is zero except for nominal floor surfaces</span>
<a name="ln-7200"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7201"></a><span class="k">          IF</span><span class="p">(</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FloorNum</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="k">CYCLE</span>  <span class="c">! Keep only floor surfaces</span>
<a name="ln-7202"></a>          <span class="n">FlConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7203"></a>
<a name="ln-7204"></a>          <span class="n">BTOTWinZone</span> <span class="o">=</span> <span class="n">TBm</span> <span class="o">*</span> <span class="n">SunLitFract</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">CosInc</span> <span class="o">*</span> <span class="n">InOutProjSLFracMult</span>  <span class="c">![m2]</span>
<a name="ln-7205"></a>
<a name="ln-7206"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7207"></a>              <span class="c">! Opaque surface</span>
<a name="ln-7208"></a>
<a name="ln-7209"></a>            <span class="n">AISurf</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">AISurf</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">BTOTWinZone</span><span class="o">*</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">Area</span>  <span class="c">![-]</span>
<a name="ln-7210"></a>          <span class="k">ELSE</span>
<a name="ln-7211"></a>              <span class="c">! Window</span>
<a name="ln-7212"></a>
<a name="ln-7213"></a>              <span class="c">! Note that diffuse solar absorptance is used here for floor windows even though we&#39;re</span>
<a name="ln-7214"></a>              <span class="c">! dealing with incident beam radiation. This is because, for this simple interior distribution,</span>
<a name="ln-7215"></a>              <span class="c">! the beam radiation from exterior windows is assumed to be uniformly distributed over the</span>
<a name="ln-7216"></a>              <span class="c">! floor and so it makes no sense to use directional absorptances. Note also that floor windows</span>
<a name="ln-7217"></a>              <span class="c">! are assumed to not have blinds or shades in this calculation.</span>
<a name="ln-7218"></a>              <span class="c">! For the case of the floor window a complex fenestration (strange situation) the correct back</span>
<a name="ln-7219"></a>              <span class="c">! diffuse layer absorptions have already been put into the construction</span>
<a name="ln-7220"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="n">FlConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-7221"></a>            <span class="n">AbsBeamTotWin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7222"></a>            <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-7223"></a>              <span class="n">AbsBeamTotWin</span> <span class="o">=</span> <span class="n">AbsBeamTotWin</span> <span class="o">+</span> <span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span>
<a name="ln-7224"></a>            <span class="k">END DO</span>
<a name="ln-7225"></a>              <span class="c">! In the following we have to multiply by the AbsDiffBack(Lay)/AbsBeamTotWin ratio to get the</span>
<a name="ln-7226"></a>              <span class="c">! layer by layer absorbed beam since ISABSF(FloorNum) is proportional to AbsBeamTotWin</span>
<a name="ln-7227"></a>              <span class="c">! (see ComputeIntSolarAbsorpFactors).</span>
<a name="ln-7228"></a>            <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-7229"></a>              <span class="n">AWinSurf</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">AWinSurf</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>    <span class="c">![-]</span>
<a name="ln-7230"></a>                <span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">Lay</span><span class="p">)</span><span class="o">/</span><span class="n">AbsBeamTotWin</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-7231"></a>                <span class="n">BTOTWinZone</span><span class="o">*</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7232"></a>            <span class="k">END DO</span>
<a name="ln-7233"></a><span class="k">          END IF</span>
<a name="ln-7234"></a>
<a name="ln-7235"></a><span class="k">          </span><span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="n">BTOTWinZone</span><span class="o">*</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span>  <span class="c">![m2]</span>
<a name="ln-7236"></a>
<a name="ln-7237"></a>          <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-7238"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7239"></a>
<a name="ln-7240"></a>            <span class="c">! Window in an interior floor</span>
<a name="ln-7241"></a>
<a name="ln-7242"></a>            <span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-7243"></a>
<a name="ln-7244"></a>            <span class="c">! Contribution (assumed diffuse) to adjacent zone of beam radiation passing</span>
<a name="ln-7245"></a>            <span class="c">! through this window</span>
<a name="ln-7246"></a>            <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7247"></a>              <span class="n">BTOTWinZone</span> <span class="o">*</span> <span class="n">ISABSF</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">/</span> <span class="n">AbsBeamTotWin</span>
<a name="ln-7248"></a>
<a name="ln-7249"></a>            <span class="n">BABSZone</span> <span class="o">=</span> <span class="n">BABSZone</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-7250"></a>              <span class="n">BTOTWinZone</span> <span class="o">*</span> <span class="n">ISABSF</span><span class="p">(</span><span class="n">FloorNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">FlConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">/</span> <span class="n">AbsBeamTotWin</span>
<a name="ln-7251"></a>          <span class="k">END IF</span>
<a name="ln-7252"></a>
<a name="ln-7253"></a><span class="k">        END DO</span>  <span class="c">! End of loop over floor sections</span>
<a name="ln-7254"></a>      <span class="k">END IF</span>  <span class="c">! End of check on complex vs. simple interior solar distribution</span>
<a name="ln-7255"></a>
<a name="ln-7256"></a>    <span class="k">END IF</span>  <span class="c">! End of sunlit fraction &gt; 0 test</span>
<a name="ln-7257"></a>
<a name="ln-7258"></a>  <span class="k">END DO</span>  <span class="c">! End of first loop over surfaces in zone</span>
<a name="ln-7259"></a>
<a name="ln-7260"></a>  <span class="c">! It is importatnt to do this only one time</span>
<a name="ln-7261"></a>  <span class="c">!IF (ZoneNum == 1) THEN</span>
<a name="ln-7262"></a>  <span class="n">BABSZoneSSG</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7263"></a>  <span class="n">BTOTZoneSSG</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7264"></a>  <span class="k">DO </span><span class="n">iSSG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfIncSolSSG</span>
<a name="ln-7265"></a>    <span class="n">SurfNum</span> <span class="o">=</span> <span class="n">SurfIncSolSSG</span><span class="p">(</span><span class="n">iSSG</span><span class="p">)%</span><span class="n">SurfPtr</span>
<a name="ln-7266"></a>    <span class="c">! do calculation only if construction number match.</span>
<a name="ln-7267"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfIncSolSSG</span><span class="p">(</span><span class="n">iSSG</span><span class="p">)%</span><span class="n">ConstrPtr</span> <span class="o">==</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7268"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Zone</span> <span class="o">==</span> <span class="n">ZoneNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7269"></a><span class="k">        </span><span class="n">AbsIntSurf</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>
<a name="ln-7270"></a>        <span class="c">!SolarIntoZone = GetCurrentScheduleValue(SurfIncSolSSG(iSSG)%SchedPtr) * Surface(SurfNum)%Area</span>
<a name="ln-7271"></a>        <span class="n">SolarIntoZone</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SurfIncSolSSG</span><span class="p">(</span><span class="n">iSSG</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span>
<a name="ln-7272"></a>        <span class="n">AISurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SolarIntoZone</span> <span class="o">*</span> <span class="n">AbsIntSurf</span>
<a name="ln-7273"></a>        <span class="n">BABSZoneSSG</span> <span class="o">=</span> <span class="n">BABSZoneSSG</span> <span class="o">+</span>  <span class="n">AISurf</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7274"></a>        <span class="n">BTOTZoneSSG</span> <span class="o">=</span> <span class="n">BTotZoneSSG</span> <span class="o">+</span> <span class="n">SolarIntoZone</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7275"></a>      <span class="k">END IF</span>
<a name="ln-7276"></a><span class="k">    END IF</span>
<a name="ln-7277"></a><span class="k">  END DO</span>
<a name="ln-7278"></a><span class="k">  </span><span class="n">DBZoneSSG</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BTotZoneSSG</span> <span class="o">-</span> <span class="n">BABSZoneSSG</span>
<a name="ln-7279"></a>  <span class="c">!END IF</span>
<a name="ln-7280"></a>
<a name="ln-7281"></a>  <span class="n">DBZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BTOTZone</span> <span class="o">-</span> <span class="n">BABSZone</span>
<a name="ln-7282"></a>
<a name="ln-7283"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DBZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7284"></a><span class="k">    </span><span class="n">DBZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7285"></a>  <span class="k">END IF</span>
<a name="ln-7286"></a>
<a name="ln-7287"></a>  <span class="c">! Variables for reporting</span>
<a name="ln-7288"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-7289"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-7290"></a><span class="k">    IF</span><span class="p">(</span><span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">FullInteriorExterior</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7291"></a><span class="k">      </span><span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7292"></a>      <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7293"></a>      <span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">/</span>  <span class="p">&amp;</span>
<a name="ln-7294"></a>          <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">DividerArea</span><span class="p">)</span>
<a name="ln-7295"></a>    <span class="k">ELSE</span>  <span class="c">! Simple interior solar distribution. All beam falls on floor.</span>
<a name="ln-7296"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ISABSF</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7297"></a>
<a name="ln-7298"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7299"></a>          <span class="c">! spread onto all floor surfaces, these may or may not be called &quot;floor&quot;</span>
<a name="ln-7300"></a>          <span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">BTOTZone</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">FloorArea</span>
<a name="ln-7301"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalSurfArea</span> <span class="o">&gt;</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7302"></a>          <span class="c">! spread onto all interior surfaces</span>
<a name="ln-7303"></a>          <span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span><span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">BTOTZone</span><span class="o">/</span><span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">TotalSurfArea</span>
<a name="ln-7304"></a>        <span class="k">ELSE</span> <span class="c">!divide be zero otherwise</span>
<a name="ln-7305"></a>          <span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-7306"></a>        <span class="n">ENDIF</span>
<a name="ln-7307"></a>      <span class="n">ENDIF</span>
<a name="ln-7308"></a>      <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">*</span> <span class="n">BmIncInsSurfIntensRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7309"></a>      <span class="n">BmIncInsSurfAmountRepEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">BmIncInsSurfAmountRep</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7310"></a>    <span class="k">END IF</span>
<a name="ln-7311"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7312"></a>
<a name="ln-7313"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">IntBeamAbsByShade</span> <span class="o">=</span> <span class="n">IntBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7314"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBeamAbsByShade</span> <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">ExtBeamAbsByShadFac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7315"></a>
<a name="ln-7316"></a>      <span class="k">IF</span> <span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7317"></a>          <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">==</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-7318"></a>
<a name="ln-7319"></a><span class="k">        </span><span class="n">ShadeFlag</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span>
<a name="ln-7320"></a>        <span class="n">BlNum</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-7321"></a>        <span class="n">ShelfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Shelf</span>
<a name="ln-7322"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ShelfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Outside daylighting shelf</span>
<a name="ln-7323"></a>          <span class="n">OutShelfSurf</span> <span class="o">=</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutSurf</span>
<a name="ln-7324"></a>        <span class="k">ELSE</span>
<a name="ln-7325"></a><span class="k">          </span><span class="n">OutShelfSurf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7326"></a>        <span class="k">END IF</span>
<a name="ln-7327"></a>
<a name="ln-7328"></a>        <span class="c">! This lookup may be avoid if this 2nd surf loop can be combined with the 1st</span>
<a name="ln-7329"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7330"></a><span class="k">          </span><span class="n">PipeNum</span> <span class="o">=</span> <span class="n">FindTDDPipe</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7331"></a>          <span class="n">SurfNum2</span> <span class="o">=</span> <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">Dome</span>
<a name="ln-7332"></a>
<a name="ln-7333"></a>          <span class="n">DifSolarInc</span> <span class="o">=</span> <span class="n">DifSolarRad</span> <span class="o">*</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">)</span> <span class="o">+</span> <span class="n">GndSolarRad</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">)%</span><span class="n">ViewFactorGround</span>
<a name="ln-7334"></a>
<a name="ln-7335"></a>          <span class="n">SkySolarTrans</span> <span class="o">=</span> <span class="n">DifSolarRad</span> <span class="o">*</span> <span class="n">TransTDD</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">,</span> <span class="n">CosInc</span><span class="p">,</span> <span class="n">SolarAniso</span><span class="p">)</span> <span class="o">*</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">)</span>
<a name="ln-7336"></a>          <span class="n">GndSolarTrans</span> <span class="o">=</span> <span class="n">GndSolarRad</span> <span class="o">*</span> <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransSolIso</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum2</span><span class="p">)%</span><span class="n">ViewFactorGround</span>
<a name="ln-7337"></a>
<a name="ln-7338"></a>          <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7339"></a>          <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SkySolarTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span> <span class="o">+</span> <span class="n">GndSolarTrans</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-7340"></a>          <span class="n">WinBmSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7341"></a>          <span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7342"></a>
<a name="ln-7343"></a>          <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="c">![W]</span>
<a name="ln-7344"></a>          <span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7345"></a>
<a name="ln-7346"></a>          <span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransmittedSolar</span> <span class="o">=</span> <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7347"></a>          <span class="c">!TDDPipe(PipeNum)%TransSolBeam = TBmBm ! Reported above</span>
<a name="ln-7348"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">DifSolarInc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7349"></a><span class="k">            </span><span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransSolDiff</span> <span class="o">=</span> <span class="p">(</span><span class="n">SkySolarTrans</span> <span class="o">+</span> <span class="n">GndSolarTrans</span><span class="p">)</span> <span class="o">/</span> <span class="n">DifSolarInc</span>
<a name="ln-7350"></a>          <span class="k">ELSE</span>
<a name="ln-7351"></a><span class="k">            </span><span class="n">TDDPipe</span><span class="p">(</span><span class="n">PipeNum</span><span class="p">)%</span><span class="n">TransSolDiff</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7352"></a>          <span class="k">END IF</span>
<a name="ln-7353"></a>
<a name="ln-7354"></a><span class="k">        ELSE IF</span> <span class="p">(</span><span class="n">OutShelfSurf</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Outside daylighting shelf</span>
<a name="ln-7355"></a>          <span class="n">ShelfSolarRad</span> <span class="o">=</span> <span class="p">(</span><span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">SunlitFrac</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-7356"></a>            <span class="o">*</span> <span class="n">CosIncAng</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">+</span> <span class="n">DifSolarRad</span> <span class="o">*</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">OutShelfSurf</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-7357"></a>            <span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">OutReflectSol</span>
<a name="ln-7358"></a>
<a name="ln-7359"></a>          <span class="n">DifSolarInc</span> <span class="o">=</span> <span class="n">DifSolarRad</span> <span class="o">*</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">GndSolarRad</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGround</span> <span class="p">&amp;</span>
<a name="ln-7360"></a>            <span class="o">+</span> <span class="n">ShelfSolarRad</span> <span class="o">*</span> <span class="n">Shelf</span><span class="p">(</span><span class="n">ShelfNum</span><span class="p">)%</span><span class="n">ViewFactor</span>
<a name="ln-7361"></a>
<a name="ln-7362"></a>          <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7363"></a>          <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DifSolarInc</span> <span class="o">*</span> <span class="n">WinTransDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7364"></a>          <span class="n">WinBmSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7365"></a>          <span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7366"></a>
<a name="ln-7367"></a>          <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="c">![W]</span>
<a name="ln-7368"></a>          <span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7369"></a>
<a name="ln-7370"></a>        <span class="k">ELSE</span> <span class="c">! Regular window</span>
<a name="ln-7371"></a>          <span class="n">SkySolarInc</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SkySolarInc</span>
<a name="ln-7372"></a>          <span class="n">GndSolarInc</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">GndSolarInc</span>
<a name="ln-7373"></a>          <span class="n">DifSolarInc</span> <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">+</span> <span class="n">GndSolarInc</span>
<a name="ln-7374"></a>          <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">WinTransBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7375"></a>          <span class="c">!Note: for complex fenestration, WinTransDifSolar has previously been defined using the effective</span>
<a name="ln-7376"></a>          <span class="c">! transmittance for sky and ground diffuse radiation (including beam radiation reflected from the ground)</span>
<a name="ln-7377"></a>          <span class="c">! so these calculations should be correct</span>
<a name="ln-7378"></a>          <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DifSolarInc</span> <span class="o">*</span> <span class="n">WinTransDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7379"></a>          <span class="n">WinBmSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7380"></a>          <span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7381"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7382"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span><span class="p">)%</span><span class="n">SlatOrientation</span> <span class="o">==</span> <span class="n">Horizontal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7383"></a><span class="k">              </span><span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SkySolarInc</span> <span class="o">*</span> <span class="n">WinTransDifSolarSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-7384"></a>                                     <span class="n">GndSolarInc</span> <span class="o">*</span> <span class="n">WinTransDifSolarGnd</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7385"></a>              <span class="n">WinDifSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7386"></a>            <span class="k">END IF</span>
<a name="ln-7387"></a><span class="k">          END IF</span>
<a name="ln-7388"></a>
<a name="ln-7389"></a><span class="k">          </span><span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="c">![W]</span>
<a name="ln-7390"></a>          <span class="n">WinTransSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7391"></a>
<a name="ln-7392"></a>        <span class="k">END IF</span>
<a name="ln-7393"></a>
<a name="ln-7394"></a>        <span class="c">!added TH 12/9/2009, CR 7907 &amp; 7809</span>
<a name="ln-7395"></a>        <span class="n">WinBmBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">WinTransBmBmSolar</span>
<a name="ln-7396"></a>
<a name="ln-7397"></a>        <span class="n">WinBmDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">WinTransBmDifSolar</span>
<a name="ln-7398"></a>        <span class="n">WinBmBmSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">WinBmBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7399"></a>        <span class="n">WinBmDifSolarEnergy</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">WinBmDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-7400"></a>
<a name="ln-7401"></a>        <span class="n">WinDirSolTransAtIncAngle</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">TBmBm</span> <span class="o">+</span> <span class="n">TBmDif</span> <span class="c">! For TDD:DIFFUSER this is the TDD transmittance</span>
<a name="ln-7402"></a>
<a name="ln-7403"></a>        <span class="c">! Solar not added by TDD:DOME; added to zone via TDD:DIFFUSER</span>
<a name="ln-7404"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7405"></a><span class="k">          </span><span class="n">ZoneTransSolar</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>      <span class="o">=</span> <span class="n">ZoneTransSolar</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinTransSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="c">![W]</span>
<a name="ln-7406"></a>          <span class="n">ZoneTransSolarEnergy</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneTransSolar</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="c">![J]</span>
<a name="ln-7407"></a>          <span class="n">ZoneBmSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneBmSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">WinBmSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7408"></a>          <span class="n">ZoneDifSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDifSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span>  <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-7409"></a>          <span class="n">ZoneBmSolFrExtWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneBmSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="c">![J]</span>
<a name="ln-7410"></a>          <span class="n">ZoneDifSolFrExtWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneDifSolFrExtWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="c">![J]</span>
<a name="ln-7411"></a>        <span class="k">END IF</span>
<a name="ln-7412"></a>
<a name="ln-7413"></a><span class="k">      END IF</span>
<a name="ln-7414"></a><span class="k">    END IF</span>
<a name="ln-7415"></a><span class="k">  END DO</span>  <span class="c">! End of second loop over surfaces in zone</span>
<a name="ln-7416"></a>
<a name="ln-7417"></a><span class="k">END DO</span>  <span class="c">! End of first zone loop</span>
<a name="ln-7418"></a>
<a name="ln-7419"></a>          <span class="c">! Add interior window contribution to DBZone</span>
<a name="ln-7420"></a>
<a name="ln-7421"></a><span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-7422"></a>  <span class="n">DBZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DBZone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span>
<a name="ln-7423"></a>  <span class="n">ZoneBmSolFrIntWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">DBZoneIntWin</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">BeamSolarRad</span>
<a name="ln-7424"></a>  <span class="n">ZoneBmSolFrIntWinsRepEnergy</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneBmSolFrIntWinsRep</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span> <span class="c">![J]</span>
<a name="ln-7425"></a><span class="k">END DO</span>
<a name="ln-7426"></a>
<a name="ln-7427"></a><span class="c">! RJH - Calculate initial distribution of diffuse solar transmitted by exterior windows into each zone</span>
<a name="ln-7428"></a><span class="c">!       to all interior surfaces in the zone</span>
<a name="ln-7429"></a><span class="c">!       Includes subsequent transmittance of diffuse solar to adjacent zones through interior windows</span>
<a name="ln-7430"></a><span class="k">CALL </span><span class="n">CalcWinTransDifSolInitialDistribution</span>
<a name="ln-7431"></a>
<a name="ln-7432"></a><span class="k">RETURN</span>
<a name="ln-7433"></a>
<a name="ln-7434"></a><span class="k">END SUBROUTINE </span><span class="n">CalcInteriorSolarDistribution</span>
<a name="ln-7435"></a>
<a name="ln-7436"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">WindowScheduledSolarAbs</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConstNum</span><span class="p">)</span>
<a name="ln-7437"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7438"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-7439"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-7440"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7441"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7442"></a>
<a name="ln-7443"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7444"></a>          <span class="c">! Returns scheduled surface gain object for given surface-construction combination</span>
<a name="ln-7445"></a>
<a name="ln-7446"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7447"></a>          <span class="c">! na</span>
<a name="ln-7448"></a>
<a name="ln-7449"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7450"></a>          <span class="c">! na</span>
<a name="ln-7451"></a>
<a name="ln-7452"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7453"></a>
<a name="ln-7454"></a>  <span class="k">implicit none</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7455"></a>
<a name="ln-7456"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7457"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! Surface number</span>
<a name="ln-7458"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstNum</span> <span class="c">! Construction number</span>
<a name="ln-7459"></a>
<a name="ln-7460"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7461"></a>          <span class="c">! na</span>
<a name="ln-7462"></a>
<a name="ln-7463"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7464"></a>          <span class="c">! na</span>
<a name="ln-7465"></a>
<a name="ln-7466"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7467"></a>          <span class="c">! na</span>
<a name="ln-7468"></a>
<a name="ln-7469"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7470"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-7471"></a>
<a name="ln-7472"></a>  <span class="n">WindowScheduledSolarAbs</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7473"></a>
<a name="ln-7474"></a>  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotFenLayAbsSSG</span>
<a name="ln-7475"></a>    <span class="k">if</span> <span class="p">((</span><span class="n">FenLayAbsSSG</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">SurfPtr</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">FenLayAbsSSG</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">ConstrPtr</span> <span class="o">==</span> <span class="n">ConstNum</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-7476"></a><span class="k">      </span><span class="n">WindowScheduledSolarAbs</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-7477"></a>      <span class="k">return</span>
<a name="ln-7478"></a><span class="k">    end if</span>
<a name="ln-7479"></a><span class="k">  end do</span>
<a name="ln-7480"></a>
<a name="ln-7481"></a><span class="k">  return</span>
<a name="ln-7482"></a><span class="k">END FUNCTION </span><span class="n">WindowScheduledSolarAbs</span>
<a name="ln-7483"></a>
<a name="ln-7484"></a><span class="kt">INTEGER </span><span class="k">FUNCTION </span><span class="n">SurfaceScheduledSolarInc</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span> <span class="n">ConstNum</span><span class="p">)</span>
<a name="ln-7485"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7486"></a>          <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-7487"></a>          <span class="c">!       DATE WRITTEN   June 2013</span>
<a name="ln-7488"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-7489"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7490"></a>
<a name="ln-7491"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7492"></a>          <span class="c">! Returns scheduled surface gain pointer for given surface-construction combination</span>
<a name="ln-7493"></a>
<a name="ln-7494"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7495"></a>          <span class="c">! na</span>
<a name="ln-7496"></a>
<a name="ln-7497"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7498"></a>          <span class="c">! na</span>
<a name="ln-7499"></a>
<a name="ln-7500"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7501"></a>
<a name="ln-7502"></a>  <span class="k">implicit none</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7503"></a>
<a name="ln-7504"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7505"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span> <span class="c">! Surface number</span>
<a name="ln-7506"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ConstNum</span> <span class="c">! Construction number</span>
<a name="ln-7507"></a>
<a name="ln-7508"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7509"></a>          <span class="c">! na</span>
<a name="ln-7510"></a>
<a name="ln-7511"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7512"></a>          <span class="c">! na</span>
<a name="ln-7513"></a>
<a name="ln-7514"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7515"></a>          <span class="c">! na</span>
<a name="ln-7516"></a>
<a name="ln-7517"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7518"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-7519"></a>
<a name="ln-7520"></a>  <span class="n">SurfaceScheduledSolarInc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7521"></a>
<a name="ln-7522"></a>  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfIncSolSSG</span>
<a name="ln-7523"></a>    <span class="k">if</span> <span class="p">((</span><span class="n">SurfIncSolSSG</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">SurfPtr</span> <span class="o">==</span> <span class="n">SurfNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">SurfIncSolSSG</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">ConstrPtr</span> <span class="o">==</span> <span class="n">ConstNum</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-7524"></a><span class="k">      </span><span class="n">SurfaceScheduledSolarInc</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-7525"></a>      <span class="k">return</span>
<a name="ln-7526"></a><span class="k">    end if</span>
<a name="ln-7527"></a><span class="k">  end do</span>
<a name="ln-7528"></a>
<a name="ln-7529"></a><span class="k">  return</span>
<a name="ln-7530"></a><span class="k">END FUNCTION </span><span class="n">SurfaceScheduledSolarInc</span>
<a name="ln-7531"></a>
<a name="ln-7532"></a><span class="k">SUBROUTINE </span><span class="n">PerformSolarCalculations</span>
<a name="ln-7533"></a>
<a name="ln-7534"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7535"></a>          <span class="c">!       AUTHOR         Linda K. Lawrie</span>
<a name="ln-7536"></a>          <span class="c">!       DATE WRITTEN   July 1999</span>
<a name="ln-7537"></a>          <span class="c">!       MODIFIED       Sept 2003, FCW: add calls to CalcBeamSolDiffuseReflFactors and</span>
<a name="ln-7538"></a>          <span class="c">!                       CalcBeamSolSpecularReflFactors</span>
<a name="ln-7539"></a>          <span class="c">!                      Jan 2004, FCW: call CalcDayltgCoefficients if storm window status on</span>
<a name="ln-7540"></a>          <span class="c">!                       any window has changed</span>
<a name="ln-7541"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7542"></a>
<a name="ln-7543"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7544"></a>          <span class="c">! This subroutine determines if new solar/shading calculations need</span>
<a name="ln-7545"></a>          <span class="c">! to be performed and calls the proper routines to do the job.</span>
<a name="ln-7546"></a>
<a name="ln-7547"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7548"></a>          <span class="c">! Users are allowed to enter a value for number of days in each period that</span>
<a name="ln-7549"></a>          <span class="c">! will be used for calculating solar.  (Later, this could be more complicated as</span>
<a name="ln-7550"></a>          <span class="c">! in allowing a number of days in a month or something).  Using this value or the</span>
<a name="ln-7551"></a>          <span class="c">! default (20 days) if nothing is entered by the user, the routine will use the</span>
<a name="ln-7552"></a>          <span class="c">! number of days left to determine if a new set of calculations should be done.</span>
<a name="ln-7553"></a>          <span class="c">! The calculations use the average of &quot;equation of time&quot; and &quot;solar declination&quot;</span>
<a name="ln-7554"></a>          <span class="c">! to perform the calculations.</span>
<a name="ln-7555"></a>
<a name="ln-7556"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7557"></a>          <span class="c">! na</span>
<a name="ln-7558"></a>
<a name="ln-7559"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7560"></a>  <span class="k">USE </span><span class="n">DaylightingManager</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcDayltgCoefficients</span><span class="p">,</span> <span class="n">TotWindowsWithDayl</span>
<a name="ln-7561"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSolarTimestepIntegration</span>
<a name="ln-7562"></a>
<a name="ln-7563"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7564"></a>
<a name="ln-7565"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7566"></a>          <span class="c">! na</span>
<a name="ln-7567"></a>
<a name="ln-7568"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7569"></a>          <span class="c">! na</span>
<a name="ln-7570"></a>
<a name="ln-7571"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7572"></a>          <span class="c">! na</span>
<a name="ln-7573"></a>
<a name="ln-7574"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7575"></a>          <span class="c">! na</span>
<a name="ln-7576"></a>
<a name="ln-7577"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7578"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SumDec</span>
<a name="ln-7579"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SumET</span>
<a name="ln-7580"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">AvgEqOfTime</span>
<a name="ln-7581"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">AvgSinSolarDeclin</span>
<a name="ln-7582"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">AvgCosSolarDeclin</span>
<a name="ln-7583"></a>  <span class="kt">INTEGER </span><span class="n">PerDayOfYear</span>
<a name="ln-7584"></a>  <span class="kt">INTEGER </span><span class="nb">Count</span>
<a name="ln-7585"></a><span class="nb">  </span><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SinDec</span>
<a name="ln-7586"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">EqTime</span>
<a name="ln-7587"></a>  <span class="c">!not used INTEGER SurfNum</span>
<a name="ln-7588"></a>
<a name="ln-7589"></a>  <span class="c">! Calculate sky diffuse shading</span>
<a name="ln-7590"></a>
<a name="ln-7591"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7592"></a><span class="k">    </span><span class="n">CalcSkyDifShading</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7593"></a>    <span class="k">CALL </span><span class="n">SkyDifSolarShading</span> <span class="c">! Calculate factors for shading of sky diffuse solar</span>
<a name="ln-7594"></a>    <span class="n">CalcSkyDifShading</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7595"></a>  <span class="k">END IF</span>
<a name="ln-7596"></a>
<a name="ln-7597"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7598"></a><span class="k">    </span><span class="n">ShadowingDaysLeft</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-7599"></a>  <span class="n">ENDIF</span>
<a name="ln-7600"></a>
<a name="ln-7601"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowingDaysLeft</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7602"></a>
<a name="ln-7603"></a><span class="k">    IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">DetailedSolarTimestepIntegration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7604"></a>      <span class="c">!  Perform calculations.</span>
<a name="ln-7605"></a>      <span class="n">ShadowingDaysLeft</span><span class="o">=</span><span class="n">ShadowingCalcFrequency</span>
<a name="ln-7606"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DayOfSim</span> <span class="o">+</span> <span class="n">ShadowingDaysLeft</span> <span class="o">&gt;</span> <span class="n">NumOfDayInEnvrn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7607"></a><span class="k">        </span><span class="n">ShadowingDaysLeft</span><span class="o">=</span><span class="n">NumOfDayInEnvrn</span><span class="o">-</span><span class="n">DayOfSim</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7608"></a>      <span class="n">ENDIF</span>
<a name="ln-7609"></a>
<a name="ln-7610"></a>      <span class="c">!  Calculate average Equation of Time, Declination Angle for this period</span>
<a name="ln-7611"></a>
<a name="ln-7612"></a>      <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7613"></a><span class="k">        CALL </span><span class="n">DisplayString</span><span class="p">(</span><span class="s1">&#39;Updating Shadowing Calculations, Start Date=&#39;</span><span class="o">//</span><span class="n">CurMnDy</span><span class="p">)</span>
<a name="ln-7614"></a>        <span class="n">DisplayPerfSimulationFlag</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-7615"></a>      <span class="n">ENDIF</span>
<a name="ln-7616"></a>
<a name="ln-7617"></a>      <span class="n">PerDayOfYear</span><span class="o">=</span><span class="n">DayOfYear</span>
<a name="ln-7618"></a>      <span class="n">SumDec</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7619"></a>      <span class="n">SumET</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7620"></a>      <span class="k">DO </span><span class="nb">Count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ShadowingDaysLeft</span>
<a name="ln-7621"></a>        <span class="k">CALL </span><span class="n">Sun3</span><span class="p">(</span><span class="n">PerDayOfYear</span><span class="p">,</span><span class="n">SinDec</span><span class="p">,</span><span class="n">EqTime</span><span class="p">)</span>
<a name="ln-7622"></a>        <span class="n">SumDec</span><span class="o">=</span><span class="n">SumDec</span><span class="o">+</span><span class="n">SinDec</span>
<a name="ln-7623"></a>        <span class="n">SumET</span><span class="o">=</span><span class="n">SumET</span><span class="o">+</span><span class="n">EqTime</span>
<a name="ln-7624"></a>        <span class="n">PerDayOfYear</span><span class="o">=</span><span class="n">PerDayOfYear</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-7625"></a>      <span class="n">ENDDO</span>
<a name="ln-7626"></a>
<a name="ln-7627"></a>      <span class="c">!  Compute Period Values</span>
<a name="ln-7628"></a>      <span class="n">AvgSinSolarDeclin</span><span class="o">=</span><span class="n">SumDec</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ShadowingDaysLeft</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7629"></a>      <span class="n">AvgCosSolarDeclin</span><span class="o">=</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">AvgSinSolarDeclin</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7630"></a>      <span class="n">AvgEqOfTime</span><span class="o">=</span><span class="n">SumET</span><span class="o">/</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ShadowingDaysLeft</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7631"></a>    <span class="k">ELSE</span>
<a name="ln-7632"></a><span class="k">      CALL </span><span class="n">Sun3</span><span class="p">(</span><span class="n">DayOfYear</span><span class="p">,</span><span class="n">AvgSinSolarDeclin</span><span class="p">,</span><span class="n">AvgEqOfTime</span><span class="p">)</span>
<a name="ln-7633"></a>      <span class="n">AvgCosSolarDeclin</span><span class="o">=</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">AvgSinSolarDeclin</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-7634"></a>    <span class="n">ENDIF</span>
<a name="ln-7635"></a>
<a name="ln-7636"></a>    <span class="k">CALL </span><span class="n">CalcPerSolarBeam</span><span class="p">(</span><span class="n">AvgEqOfTime</span><span class="p">,</span><span class="n">AvgSinSolarDeclin</span><span class="p">,</span><span class="n">AvgCosSolarDeclin</span><span class="p">)</span>
<a name="ln-7637"></a>
<a name="ln-7638"></a>    <span class="c">! Calculate factors for solar reflection</span>
<a name="ln-7639"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">CalcSolRefl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7640"></a><span class="k">      CALL </span><span class="n">CalcBeamSolDiffuseReflFactors</span>
<a name="ln-7641"></a>      <span class="k">CALL </span><span class="n">CalcBeamSolSpecularReflFactors</span>
<a name="ln-7642"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">CALL </span><span class="n">CalcSkySolDiffuseReflFactors</span>
<a name="ln-7643"></a>    <span class="k">END IF</span>
<a name="ln-7644"></a>
<a name="ln-7645"></a>    <span class="c">!  Calculate daylighting coefficients</span>
<a name="ln-7646"></a>    <span class="k">CALL </span><span class="n">CalcDayltgCoefficients</span>
<a name="ln-7647"></a>
<a name="ln-7648"></a>  <span class="n">ENDIF</span>
<a name="ln-7649"></a>
<a name="ln-7650"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">WarmUpFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7651"></a><span class="k">    </span><span class="n">ShadowingDaysLeft</span><span class="o">=</span><span class="n">ShadowingDaysLeft</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-7652"></a>  <span class="n">ENDIF</span>
<a name="ln-7653"></a>
<a name="ln-7654"></a>  <span class="c">! Recalculate daylighting coefficients if storm window has been added</span>
<a name="ln-7655"></a>  <span class="c">! or removed from one or more windows at beginning of day</span>
<a name="ln-7656"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">TotWindowsWithDayl</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">BeginSimFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7657"></a>     <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TotStormWin</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">StormWinChangeThisDay</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7658"></a><span class="k">    CALL </span><span class="n">CalcDayltgCoefficients</span>
<a name="ln-7659"></a>  <span class="k">END IF</span>
<a name="ln-7660"></a>
<a name="ln-7661"></a><span class="k">  RETURN</span>
<a name="ln-7662"></a>
<a name="ln-7663"></a><span class="k">END SUBROUTINE </span><span class="n">PerformSolarCalculations</span>
<a name="ln-7664"></a>
<a name="ln-7665"></a><span class="k">SUBROUTINE </span><span class="n">SHDRVL</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">SBSNR</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-7666"></a>
<a name="ln-7667"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7668"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-7669"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-7670"></a>          <span class="c">!       MODIFIED       May 2002 (FCW): allow triangular windows to have reveal.</span>
<a name="ln-7671"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-7672"></a>
<a name="ln-7673"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7674"></a>          <span class="c">! This subroutine computes the shadowing from a reveal onto a subsurface.</span>
<a name="ln-7675"></a>
<a name="ln-7676"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7677"></a>          <span class="c">! na</span>
<a name="ln-7678"></a>
<a name="ln-7679"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7680"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-7681"></a>
<a name="ln-7682"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7683"></a>          <span class="c">! na</span>
<a name="ln-7684"></a>
<a name="ln-7685"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7686"></a>
<a name="ln-7687"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7688"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTSS</span>     <span class="c">! Heat transfer surface number of the subsurface</span>
<a name="ln-7689"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SBSNR</span>    <span class="c">! Subsurface number</span>
<a name="ln-7690"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Hour</span>
<a name="ln-7691"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TS</span>
<a name="ln-7692"></a>
<a name="ln-7693"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7694"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="k">None</span>                       <span class="o">=</span> <span class="mi">0</span>  <span class="c">! for use with RevealStatus</span>
<a name="ln-7695"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">EntireWindowShadedByReveal</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">! for use with RevealStatus</span>
<a name="ln-7696"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">WindowShadedOnlyByReveal</span>   <span class="o">=</span> <span class="mi">2</span>  <span class="c">! for use with RevealStatus</span>
<a name="ln-7697"></a>
<a name="ln-7698"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7699"></a>          <span class="c">! na</span>
<a name="ln-7700"></a>
<a name="ln-7701"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7702"></a>          <span class="c">! na</span>
<a name="ln-7703"></a>
<a name="ln-7704"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7705"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">A</span>            <span class="c">! Area</span>
<a name="ln-7706"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">R</span>            <span class="c">! Depth of the reveal (m)</span>
<a name="ln-7707"></a>  <span class="kt">INTEGER </span><span class="n">I</span>                     <span class="c">! Loop control</span>
<a name="ln-7708"></a>  <span class="kt">INTEGER </span><span class="n">N</span>                     <span class="c">! Vertex number</span>
<a name="ln-7709"></a>  <span class="kt">INTEGER </span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span>               <span class="c">! Locations in homogeneous coordinate array</span>
<a name="ln-7710"></a>  <span class="kt">INTEGER </span><span class="n">NVS</span>                   <span class="c">! Number of verticies</span>
<a name="ln-7711"></a>                                <span class="c">! note, below dimensions not changed because subsurface still max 4</span>
<a name="ln-7712"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">XVT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                   <span class="c">! Projected X coordinates of vertices</span>
<a name="ln-7713"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">YVT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                   <span class="c">! Projected Y coordinates of vertices</span>
<a name="ln-7714"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">RevealStatusSet</span>    <span class="c">! Used to control flow through this subroutine.</span>
<a name="ln-7715"></a>                                <span class="c">! Certain operations performed only if reveal status not yet set.</span>
<a name="ln-7716"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">RevealStatus</span>       <span class="c">! Status of the reveal, takes the parameter values above</span>
<a name="ln-7717"></a>
<a name="ln-7718"></a>          <span class="c">! FLOW:</span>
<a name="ln-7719"></a>  <span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="k">None</span>
<a name="ln-7720"></a><span class="k">  </span><span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7721"></a>
<a name="ln-7722"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CalcSkyDifShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7723"></a><span class="k">    </span><span class="n">WindowRevealStatus</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="k">None</span>
<a name="ln-7724"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-7725"></a>
<a name="ln-7726"></a>  <span class="n">R</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Reveal</span>
<a name="ln-7727"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">R</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7728"></a><span class="k">    </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="k">None</span>
<a name="ln-7729"></a><span class="k">    </span><span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7730"></a>  <span class="k">END IF</span>
<a name="ln-7731"></a>
<a name="ln-7732"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RevealStatusSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7733"></a>
<a name="ln-7734"></a><span class="k">    </span><span class="n">FRVLHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7735"></a>    <span class="n">LOCHCA</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7736"></a>    <span class="n">NVS</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-7737"></a>
<a name="ln-7738"></a>    <span class="c">! Currently (06May02) windows are either rectangles (NVS=4) or triangles (NVS=3)</span>
<a name="ln-7739"></a>
<a name="ln-7740"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-7741"></a>
<a name="ln-7742"></a>      <span class="k">CASE</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="c">! Rectangular subsurface</span>
<a name="ln-7743"></a>
<a name="ln-7744"></a>            <span class="c">! Determine vertices of reveal.</span>
<a name="ln-7745"></a>            <span class="c">! Project the subsurface up to the plane of the wall.</span>
<a name="ln-7746"></a>
<a name="ln-7747"></a>        <span class="n">XVT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">XShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7748"></a>        <span class="n">XVT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">XShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7749"></a>        <span class="n">XVT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MIN</span><span class="p">(</span><span class="n">XShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7750"></a>        <span class="n">XVT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MIN</span><span class="p">(</span><span class="n">XShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7751"></a>        <span class="n">YVT</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MIN</span><span class="p">(</span><span class="n">YShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7752"></a>        <span class="n">YVT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">YShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7753"></a>        <span class="n">YVT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MAX</span><span class="p">(</span><span class="n">YShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7754"></a>        <span class="n">YVT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="nb">MIN</span><span class="p">(</span><span class="n">YShadowProjection</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7755"></a>
<a name="ln-7756"></a>              <span class="c">! Check for complete shadowing.</span>
<a name="ln-7757"></a>
<a name="ln-7758"></a>        <span class="k">IF</span> <span class="p">((</span><span class="n">XVT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">XVT</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">YVT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">YVT</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-7759"></a>
<a name="ln-7760"></a><span class="k">          </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="n">EntireWindowShadedByReveal</span>
<a name="ln-7761"></a>          <span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7762"></a>
<a name="ln-7763"></a>        <span class="k">ELSE</span>
<a name="ln-7764"></a>              <span class="c">! Re-order vertices to clockwise.</span>
<a name="ln-7765"></a>
<a name="ln-7766"></a>          <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVS</span>
<a name="ln-7767"></a>            <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7768"></a>            <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7769"></a>          <span class="k">END DO</span>
<a name="ln-7770"></a>
<a name="ln-7771"></a>              <span class="c">! Transform to homogeneous coordinates</span>
<a name="ln-7772"></a>
<a name="ln-7773"></a>          <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">,</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-7774"></a>          <span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span>
<a name="ln-7775"></a>          <span class="n">HCT</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">1.0d0</span>
<a name="ln-7776"></a>
<a name="ln-7777"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7778"></a><span class="k">            </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="n">EntireWindowShadedByReveal</span>
<a name="ln-7779"></a>            <span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7780"></a>          <span class="k">END IF</span>
<a name="ln-7781"></a>
<a name="ln-7782"></a><span class="k">        END IF</span>
<a name="ln-7783"></a>
<a name="ln-7784"></a><span class="k">      CASE</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">! Triangular window</span>
<a name="ln-7785"></a>
<a name="ln-7786"></a>              <span class="c">! Project window to outside plane of parent surface</span>
<a name="ln-7787"></a>
<a name="ln-7788"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<a name="ln-7789"></a>          <span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">XShadowProjection</span>
<a name="ln-7790"></a>          <span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="o">*</span><span class="n">YShadowProjection</span>
<a name="ln-7791"></a>        <span class="k">END DO</span>
<a name="ln-7792"></a>
<a name="ln-7793"></a>              <span class="c">! Find the overlap between the original window and the projected window</span>
<a name="ln-7794"></a>              <span class="c">! Put XVT,YVT in clockwise order</span>
<a name="ln-7795"></a>
<a name="ln-7796"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVS</span>
<a name="ln-7797"></a>          <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7798"></a>          <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7799"></a>        <span class="k">END DO</span>
<a name="ln-7800"></a>
<a name="ln-7801"></a>             <span class="c">! Transform to homogeneous coordinates</span>
<a name="ln-7802"></a>
<a name="ln-7803"></a>        <span class="n">NS1</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7804"></a>        <span class="n">LOCHCA</span> <span class="o">=</span> <span class="n">NS1</span>
<a name="ln-7805"></a>        <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-7806"></a>
<a name="ln-7807"></a>             <span class="c">! Put XV,YV in clockwise order</span>
<a name="ln-7808"></a>
<a name="ln-7809"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVS</span>
<a name="ln-7810"></a>          <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7811"></a>          <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7812"></a>        <span class="k">END DO</span>
<a name="ln-7813"></a>
<a name="ln-7814"></a>             <span class="c">! Transform to homogenous coordinates</span>
<a name="ln-7815"></a>
<a name="ln-7816"></a>        <span class="n">NS2</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7817"></a>        <span class="n">LOCHCA</span> <span class="o">=</span> <span class="n">NS2</span>
<a name="ln-7818"></a>        <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS2</span><span class="p">,</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-7819"></a>        <span class="n">HCT</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7820"></a>
<a name="ln-7821"></a>             <span class="c">! Find overlap</span>
<a name="ln-7822"></a>
<a name="ln-7823"></a>        <span class="k">CALL </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">FRVLHC</span><span class="p">)</span>
<a name="ln-7824"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">NoOverlap</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7825"></a><span class="k">            </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="n">EntireWindowShadedByReveal</span>
<a name="ln-7826"></a>            <span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7827"></a>        <span class="k">END IF</span>
<a name="ln-7828"></a>
<a name="ln-7829"></a><span class="k">    END SELECT</span>
<a name="ln-7830"></a>
<a name="ln-7831"></a><span class="k">  END IF</span>
<a name="ln-7832"></a>
<a name="ln-7833"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RevealStatusSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7834"></a>
<a name="ln-7835"></a>          <span class="c">! Check for no shadows on window.</span>
<a name="ln-7836"></a>
<a name="ln-7837"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NSBSHC</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7838"></a><span class="k">      </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="n">WindowShadedOnlyByReveal</span>
<a name="ln-7839"></a>      <span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7840"></a>    <span class="k">ELSE</span>
<a name="ln-7841"></a>          <span class="c">! Reduce all previous shadows to size of reveal opening.</span>
<a name="ln-7842"></a>      <span class="n">LOCHCA</span> <span class="o">=</span> <span class="n">FRVLHC</span>
<a name="ln-7843"></a>      <span class="k">CALL </span><span class="n">MULTOL</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">,</span><span class="n">FSBSHC</span><span class="p">,</span><span class="n">NSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-7844"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7845"></a>           <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7846"></a><span class="k">        </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="k">None</span>
<a name="ln-7847"></a><span class="k">        </span><span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7848"></a>      <span class="k">ELSE</span>
<a name="ln-7849"></a><span class="k">        </span><span class="n">NRVLHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FRVLHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7850"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NRVLHC</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7851"></a><span class="k">          </span><span class="n">RevealStatus</span>    <span class="o">=</span>  <span class="n">WindowShadedOnlyByReveal</span>
<a name="ln-7852"></a>          <span class="n">RevealStatusSet</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7853"></a>        <span class="k">END IF</span>
<a name="ln-7854"></a><span class="k">      END IF</span>
<a name="ln-7855"></a><span class="k">    END IF</span>
<a name="ln-7856"></a><span class="k">  END IF</span>
<a name="ln-7857"></a>
<a name="ln-7858"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">RevealStatusSet</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7859"></a>          <span class="c">! Compute sunlit area.</span>
<a name="ln-7860"></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span>
<a name="ln-7861"></a>    <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NRVLHC</span>
<a name="ln-7862"></a>      <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HCT</span><span class="p">(</span><span class="n">FRVLHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">))</span>
<a name="ln-7863"></a>    <span class="k">END DO</span>
<a name="ln-7864"></a><span class="k">    </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span>
<a name="ln-7865"></a>  <span class="k">END IF</span>
<a name="ln-7866"></a>
<a name="ln-7867"></a><span class="k">  IF</span> <span class="p">((</span><span class="n">RevealStatus</span> <span class="o">==</span> <span class="n">EntireWindowShadedByReveal</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7868"></a><span class="k">    </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span><span class="o">=</span><span class="mf">0.0d0</span>   <span class="c">! Window entirely shaded by reveal.</span>
<a name="ln-7869"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">RevealStatus</span> <span class="o">==</span> <span class="n">WindowShadedOnlyByReveal</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7870"></a><span class="k">    </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span><span class="o">=</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">FRVLHC</span><span class="p">)</span>    <span class="c">! Window shaded only by reveal.</span>
<a name="ln-7871"></a>  <span class="k">END IF</span>
<a name="ln-7872"></a>
<a name="ln-7873"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CalcSkyDifShading</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7874"></a><span class="k">    </span><span class="n">WindowRevealStatus</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">,</span><span class="n">Hour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span><span class="o">=</span><span class="n">RevealStatus</span>
<a name="ln-7875"></a>  <span class="n">ENDIF</span>
<a name="ln-7876"></a>
<a name="ln-7877"></a>  <span class="k">RETURN</span>
<a name="ln-7878"></a>
<a name="ln-7879"></a><span class="k">END SUBROUTINE </span><span class="n">SHDRVL</span>
<a name="ln-7880"></a>
<a name="ln-7881"></a><span class="k">SUBROUTINE </span><span class="n">SHDSBS</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">CurSurf</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">NSBS</span><span class="p">,</span><span class="n">HTS</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-7882"></a>
<a name="ln-7883"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7884"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-7885"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-7886"></a>          <span class="c">!       MODIFIED       FCW, Oct 2002: Surface%Area --&gt; Surface%Area + SurfaceWindow%DividerArea</span>
<a name="ln-7887"></a>          <span class="c">!                       in calculation of SunlitFracWithoutReveal (i.e., use full window area, not</span>
<a name="ln-7888"></a>          <span class="c">!                       just glass area.</span>
<a name="ln-7889"></a>          <span class="c">!                      TH, May 2009: Bug fixed to address part of CR 7596 - inside reveals</span>
<a name="ln-7890"></a>          <span class="c">!                       causing high cooling loads</span>
<a name="ln-7891"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-7892"></a>
<a name="ln-7893"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7894"></a>          <span class="c">! This subroutine determines the shadowing on subsurfaces and</span>
<a name="ln-7895"></a>          <span class="c">! revises the base surface area accordingly.  It also computes</span>
<a name="ln-7896"></a>          <span class="c">! the effect of transparent subsurfaces.</span>
<a name="ln-7897"></a>
<a name="ln-7898"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7899"></a>          <span class="c">! na</span>
<a name="ln-7900"></a>
<a name="ln-7901"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7902"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-7903"></a>
<a name="ln-7904"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7905"></a>          <span class="c">! na</span>
<a name="ln-7906"></a>
<a name="ln-7907"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7908"></a>
<a name="ln-7909"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7910"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">IHOUR</span>  <span class="c">! Hour Index</span>
<a name="ln-7911"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TS</span>     <span class="c">! Time step Index</span>
<a name="ln-7912"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurSurf</span>
<a name="ln-7913"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NBKS</span>     <span class="c">! Number of back surfaces</span>
<a name="ln-7914"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">NSBS</span>     <span class="c">! Number of subsurfaces</span>
<a name="ln-7915"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HTS</span>      <span class="c">! Heat transfer surface number of the general receiving surf</span>
<a name="ln-7916"></a>
<a name="ln-7917"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7918"></a>          <span class="c">! na</span>
<a name="ln-7919"></a>
<a name="ln-7920"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7921"></a>          <span class="c">! na</span>
<a name="ln-7922"></a>
<a name="ln-7923"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7924"></a>          <span class="c">! na</span>
<a name="ln-7925"></a>
<a name="ln-7926"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7927"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">A</span>  <span class="c">! Area</span>
<a name="ln-7928"></a>  <span class="kt">INTEGER </span><span class="n">I</span>  <span class="c">! Loop control</span>
<a name="ln-7929"></a>  <span class="kt">INTEGER </span><span class="n">J</span>  <span class="c">! Loop control</span>
<a name="ln-7930"></a>  <span class="kt">INTEGER </span><span class="n">K</span>  <span class="c">! Window construction number</span>
<a name="ln-7931"></a>  <span class="kt">INTEGER </span><span class="n">N</span>  <span class="c">! Vertex number</span>
<a name="ln-7932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">SurfArea</span>         <span class="c">! Surface area. For walls, includes all window frame areas.</span>
<a name="ln-7933"></a>                             <span class="c">! For windows, includes divider area</span>
<a name="ln-7934"></a><span class="c">!  REAL(r64) FrameAreaAdd    ! Additional frame area sunlit</span>
<a name="ln-7935"></a><span class="c">!  REAL(r64) DividerAreaAdd  ! Additional frame area sunlit</span>
<a name="ln-7936"></a>  <span class="kt">INTEGER </span><span class="n">HTSS</span>     <span class="c">! Heat transfer surface number of the subsurface</span>
<a name="ln-7937"></a>  <span class="kt">INTEGER </span><span class="n">SBSNR</span>    <span class="c">! Subsurface number</span>
<a name="ln-7938"></a>
<a name="ln-7939"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NSBS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Action taken only if subsurfaces present</span>
<a name="ln-7940"></a>
<a name="ln-7941"></a>    <span class="n">FSBSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7942"></a>
<a name="ln-7943"></a>    <span class="k">DO </span><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NSBS</span>  <span class="c">! Do for all subsurfaces (sbs).</span>
<a name="ln-7944"></a>
<a name="ln-7945"></a>      <span class="n">SBSNR</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">CurSurf</span><span class="p">)%</span><span class="n">SubSurf</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-7946"></a>
<a name="ln-7947"></a>      <span class="n">HTSS</span><span class="o">=</span><span class="n">SBSNR</span>
<a name="ln-7948"></a>
<a name="ln-7949"></a>      <span class="n">K</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-7950"></a>
<a name="ln-7951"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">/=</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7952"></a>           <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">/=</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7953"></a>           <span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span>              <span class="k">THEN</span>
<a name="ln-7954"></a>
<a name="ln-7955"></a>          <span class="c">! Re-order vertices to clockwise sequential; compute homogeneous coordinates.</span>
<a name="ln-7956"></a>        <span class="n">NVS</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">Sides</span>
<a name="ln-7957"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVS</span>
<a name="ln-7958"></a>          <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">XV</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7959"></a>          <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">ShadeV</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">YV</span><span class="p">(</span><span class="n">NVS</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">N</span><span class="p">)</span>
<a name="ln-7960"></a>        <span class="k">END DO</span>
<a name="ln-7961"></a><span class="k">        </span><span class="n">LOCHCA</span> <span class="o">=</span> <span class="n">FSBSHC</span>
<a name="ln-7962"></a>        <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">,</span><span class="n">NVS</span><span class="p">)</span>
<a name="ln-7963"></a>        <span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>
<a name="ln-7964"></a>        <span class="n">HCT</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>    <span class="o">=</span>  <span class="mf">1.0d0</span>
<a name="ln-7965"></a>        <span class="n">NSBSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FSBSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7966"></a>
<a name="ln-7967"></a>          <span class="c">! Determine sunlit area of subsurface due to shadows on general receiving surface.</span>
<a name="ln-7968"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">NGSSHC</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7969"></a><span class="k">          CALL </span><span class="n">MULTOL</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">,</span><span class="n">FGSSHC</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">NGSSHC</span><span class="p">)</span>
<a name="ln-7970"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">/=</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7971"></a>               <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">/=</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="n">NSBSHC</span> <span class="o">=</span> <span class="n">LOCHCA</span> <span class="o">-</span> <span class="n">FSBSHC</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-7972"></a>        <span class="k">END IF</span>
<a name="ln-7973"></a>
<a name="ln-7974"></a><span class="k">      END IF</span>
<a name="ln-7975"></a>
<a name="ln-7976"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7977"></a>           <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7978"></a>           <span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span>              <span class="k">THEN</span>  <span class="c">! General receiving surface totally shaded.</span>
<a name="ln-7979"></a>
<a name="ln-7980"></a>        <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7981"></a>
<a name="ln-7982"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IHour</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SunLitFracWithoutReveal</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">IHour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7983"></a>
<a name="ln-7984"></a>      <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">NGSSHC</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">).</span><span class="nb">OR</span><span class="p">.(</span><span class="n">NSBSHC</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">! No shadows.</span>
<a name="ln-7985"></a>
<a name="ln-7986"></a>        <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FSBSHC</span><span class="p">)</span>
<a name="ln-7987"></a>        <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span>  <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">-</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span>    <span class="c">! Revise sunlit area of general receiving surface.</span>
<a name="ln-7988"></a>
<a name="ln-7989"></a>        <span class="c">! TH. This is a bug.  SunLitFracWithoutReveal should be a ratio of area</span>
<a name="ln-7990"></a>        <span class="c">!IF(IHour &gt; 0 .AND. TS &gt; 0) SunLitFracWithoutReveal(HTSS,IHour,TS) = &amp;</span>
<a name="ln-7991"></a>        <span class="c">!      Surface(HTSS)%NetAreaShadowCalc</span>
<a name="ln-7992"></a>
<a name="ln-7993"></a>        <span class="c">! new code fixed part of CR 7596. TH 5/29/2009</span>
<a name="ln-7994"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IHour</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SunLitFracWithoutReveal</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">IHour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-7995"></a>
<a name="ln-7996"></a>
<a name="ln-7997"></a>        <span class="k">CALL </span><span class="n">SHDRVL</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">SBSNR</span><span class="p">,</span><span class="n">IHour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>   <span class="c">! Determine shadowing from reveal.</span>
<a name="ln-7998"></a>
<a name="ln-7999"></a>        <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8000"></a>             <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8001"></a>
<a name="ln-8002"></a>      <span class="k">ELSE</span>    <span class="c">! Compute area.</span>
<a name="ln-8003"></a>
<a name="ln-8004"></a>        <span class="n">A</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FSBSHC</span><span class="p">)</span>
<a name="ln-8005"></a>        <span class="k">DO </span><span class="n">J</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NSBSHC</span>
<a name="ln-8006"></a>          <span class="n">A</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">J</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">HCT</span><span class="p">(</span><span class="n">FSBSHC</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">J</span><span class="p">))</span>
<a name="ln-8007"></a>        <span class="k">END DO</span>
<a name="ln-8008"></a><span class="k">        </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span>
<a name="ln-8009"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8010"></a>
<a name="ln-8011"></a><span class="k">          </span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTS</span><span class="p">)</span> <span class="o">-</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="c">! Revise sunlit area of general receiving surface.</span>
<a name="ln-8012"></a>
<a name="ln-8013"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">IHour</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TS</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SunLitFracWithoutReveal</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">IHour</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span><span class="o">/</span><span class="n">Surface</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-8014"></a>
<a name="ln-8015"></a>          <span class="k">CALL </span><span class="n">SHDRVL</span><span class="p">(</span><span class="n">HTSS</span><span class="p">,</span><span class="n">SBSNR</span><span class="p">,</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>   <span class="c">! Determine shadowing from reveal.</span>
<a name="ln-8016"></a>
<a name="ln-8017"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8018"></a>               <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8019"></a>
<a name="ln-8020"></a>        <span class="k">ELSE</span>    <span class="c">! General receiving surface totally shaded.</span>
<a name="ln-8021"></a>
<a name="ln-8022"></a>          <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8023"></a>
<a name="ln-8024"></a>        <span class="k">END IF</span>
<a name="ln-8025"></a>
<a name="ln-8026"></a><span class="k">      END IF</span>
<a name="ln-8027"></a>
<a name="ln-8028"></a>          <span class="c">! Determine transmittance and absorptances of sunlit window.</span>
<a name="ln-8029"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">K</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8030"></a>
<a name="ln-8031"></a><span class="k">        IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">CalcSkyDifShading</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!Overlaps calculation is only done for beam solar</span>
<a name="ln-8032"></a>                                         <span class="c">!shading, not for sky diffuse solar shading</span>
<a name="ln-8033"></a>
<a name="ln-8034"></a>          <span class="k">CALL </span><span class="n">CalcInteriorSolarOverlaps</span><span class="p">(</span><span class="n">IHOUR</span><span class="p">,</span><span class="n">NBKS</span><span class="p">,</span><span class="n">HTSS</span><span class="p">,</span><span class="n">CurSurf</span><span class="p">,</span><span class="n">TS</span><span class="p">)</span>
<a name="ln-8035"></a>
<a name="ln-8036"></a>        <span class="k">END IF</span>
<a name="ln-8037"></a>
<a name="ln-8038"></a><span class="k">      END IF</span>
<a name="ln-8039"></a>
<a name="ln-8040"></a>          <span class="c">! Error checking.</span>
<a name="ln-8041"></a>      <span class="n">SurfArea</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SBSNR</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-8042"></a>      <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">))</span>
<a name="ln-8043"></a>
<a name="ln-8044"></a>      <span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">)</span><span class="o">=</span><span class="nb">MIN</span><span class="p">(</span><span class="n">SAREA</span><span class="p">(</span><span class="n">HTSS</span><span class="p">),</span><span class="n">SurfArea</span><span class="p">)</span>
<a name="ln-8045"></a>
<a name="ln-8046"></a>    <span class="k">END DO</span>  <span class="c">! End of subsurface loop</span>
<a name="ln-8047"></a>
<a name="ln-8048"></a>  <span class="k">END IF</span>
<a name="ln-8049"></a>
<a name="ln-8050"></a><span class="k">  RETURN</span>
<a name="ln-8051"></a>
<a name="ln-8052"></a><span class="k">END SUBROUTINE </span><span class="n">SHDSBS</span>
<a name="ln-8053"></a>
<a name="ln-8054"></a><span class="k">SUBROUTINE </span><span class="n">SUN3</span><span class="p">(</span><span class="n">JulianDayOfYear</span><span class="p">,</span><span class="n">SineOfSolarDeclination</span><span class="p">,</span><span class="n">EquationOfTime</span><span class="p">)</span>
<a name="ln-8055"></a>
<a name="ln-8056"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8057"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-8058"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-8059"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8060"></a>          <span class="c">!       RE-ENGINEERED  Linda K. Lawrie</span>
<a name="ln-8061"></a>
<a name="ln-8062"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8063"></a>          <span class="c">! This subroutine computes the coefficients for determining</span>
<a name="ln-8064"></a>          <span class="c">! the solar position.</span>
<a name="ln-8065"></a>
<a name="ln-8066"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8067"></a>          <span class="c">! The expressions are based on least-squares fits of data on p.316 of &#39;Thermal</span>
<a name="ln-8068"></a>          <span class="c">! Environmental Engineering&#39; by Threlkeld and on p.387 of the ASHRAE Handbook</span>
<a name="ln-8069"></a>          <span class="c">! of Fundamentals (need date of ASHRAE HOF).</span>
<a name="ln-8070"></a>
<a name="ln-8071"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8072"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-8073"></a>
<a name="ln-8074"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8075"></a>          <span class="c">! na</span>
<a name="ln-8076"></a>
<a name="ln-8077"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8078"></a>
<a name="ln-8079"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8080"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">JulianDayOfYear</span>     <span class="c">! Julian Day Of Year</span>
<a name="ln-8081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SineOfSolarDeclination</span>    <span class="c">! Sine of Solar Declination</span>
<a name="ln-8082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">EquationOfTime</span>            <span class="c">! Equation of Time (Degrees)</span>
<a name="ln-8083"></a>
<a name="ln-8084"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SineSolDeclCoef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier series</span>
<a name="ln-8086"></a>        <span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">00561800</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">0657911</span><span class="n">d0</span><span class="p">,</span> <span class="o">-</span><span class="p">.</span><span class="mi">392779</span><span class="n">d0</span><span class="p">,</span>   <span class="p">.</span><span class="mi">00064440</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00618495</span><span class="n">d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">! SINE OF DECLINATION</span>
<a name="ln-8087"></a>          <span class="o">-</span><span class="p">.</span><span class="mi">00010101</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00007951</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00011691</span><span class="n">d0</span><span class="p">,</span> <span class="p">.</span><span class="mi">00002096</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>             <span class="c">! COEFFICIENTS</span>
<a name="ln-8088"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EqOfTimeCoef</span> <span class="o">=</span> <span class="p">&amp;</span>  <span class="c">!Fitted coefficients of Fourier Series</span>
<a name="ln-8089"></a>        <span class="p">(</span><span class="o">/</span> <span class="p">.</span><span class="mi">00021971</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">122649</span><span class="n">d0</span><span class="p">,</span>   <span class="p">.</span><span class="mi">00762856</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">156308</span><span class="n">d0</span><span class="p">,</span>  <span class="o">-</span><span class="p">.</span><span class="mi">0530028</span><span class="n">d0</span><span class="p">,</span>  <span class="p">&amp;</span> <span class="c">! EQUATION OF TIME</span>
<a name="ln-8090"></a>          <span class="o">-</span><span class="p">.</span><span class="mi">00388702</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00123978</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00270502</span><span class="n">d0</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">00167992</span><span class="n">d0</span><span class="o">/</span><span class="p">)</span>              <span class="c">! COEFFICIENTS</span>
<a name="ln-8091"></a>
<a name="ln-8092"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8093"></a>          <span class="c">! na</span>
<a name="ln-8094"></a>
<a name="ln-8095"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8096"></a>          <span class="c">! na</span>
<a name="ln-8097"></a>
<a name="ln-8098"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8099"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">X</span>     <span class="c">! Day of Year in Radians (Computed from Input JulianDayOfYear)</span>
<a name="ln-8100"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">COSX</span>  <span class="c">! COS(X)</span>
<a name="ln-8101"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="n">SineX</span> <span class="c">! SIN(X)</span>
<a name="ln-8102"></a>
<a name="ln-8103"></a>  <span class="n">X</span> <span class="o">=</span> <span class="p">.</span><span class="mi">017167</span><span class="n">d0</span> <span class="o">*</span> <span class="n">JulianDayOfYear</span>   <span class="c">! Convert julian date to angle X</span>
<a name="ln-8104"></a>
<a name="ln-8105"></a>          <span class="c">! Calculate sines and cosines of X</span>
<a name="ln-8106"></a>  <span class="n">SineX</span>  <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-8107"></a>  <span class="n">CosX</span>   <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-8108"></a>
<a name="ln-8109"></a>  <span class="n">SineOfSolarDeclination</span> <span class="o">=</span> <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8110"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SineX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-8111"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8112"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8113"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8114"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8115"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8116"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8117"></a>                           <span class="n">SineSolDeclCoef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8118"></a>
<a name="ln-8119"></a>  <span class="n">EquationOfTime</span> <span class="o">=</span> <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8120"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SineX</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-8121"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">CosX</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8122"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8123"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8124"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8125"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8126"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">2.d0</span><span class="o">*</span><span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-8127"></a>                   <span class="n">EqOfTimeCoef</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">CosX</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">SineX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">SineX</span><span class="o">*</span><span class="n">CosX</span><span class="o">*</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-8128"></a>
<a name="ln-8129"></a>  <span class="k">RETURN</span>
<a name="ln-8130"></a>
<a name="ln-8131"></a><span class="k">END SUBROUTINE </span><span class="n">SUN3</span>
<a name="ln-8132"></a>
<a name="ln-8133"></a><span class="k">SUBROUTINE </span><span class="n">SUN4</span><span class="p">(</span><span class="n">CurrentTime</span><span class="p">,</span><span class="n">EqOfTime</span><span class="p">,</span><span class="n">SinSolarDeclin</span><span class="p">,</span><span class="n">CosSolarDeclin</span><span class="p">)</span>
<a name="ln-8134"></a>
<a name="ln-8135"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8136"></a>          <span class="c">!       AUTHOR         Legacy Code</span>
<a name="ln-8137"></a>          <span class="c">!       DATE WRITTEN</span>
<a name="ln-8138"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8139"></a>          <span class="c">!       RE-ENGINEERED  Lawrie, Oct 2000</span>
<a name="ln-8140"></a>
<a name="ln-8141"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8142"></a>          <span class="c">! This subroutine computes solar direction cosines for a given hour.  These</span>
<a name="ln-8143"></a>          <span class="c">! cosines are used in the shadowing calculations.</span>
<a name="ln-8144"></a>
<a name="ln-8145"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8146"></a>          <span class="c">! na</span>
<a name="ln-8147"></a>
<a name="ln-8148"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8149"></a>          <span class="c">! BLAST/IBLAST code, original author George Walton</span>
<a name="ln-8150"></a>
<a name="ln-8151"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8152"></a>          <span class="c">! na</span>
<a name="ln-8153"></a>
<a name="ln-8154"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8155"></a>
<a name="ln-8156"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentTime</span> <span class="c">! Time to use in shadowing calculations</span>
<a name="ln-8158"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">EqOfTime</span>        <span class="c">! Equation of time for current day</span>
<a name="ln-8159"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SinSolarDeclin</span>  <span class="c">! Sine of the Solar declination (current day)</span>
<a name="ln-8160"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CosSolarDeclin</span>  <span class="c">! Cosine of the Solar declination (current day)</span>
<a name="ln-8161"></a>
<a name="ln-8162"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8163"></a>          <span class="c">! na</span>
<a name="ln-8164"></a>
<a name="ln-8165"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8166"></a>          <span class="c">! na</span>
<a name="ln-8167"></a>
<a name="ln-8168"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8169"></a>          <span class="c">! na</span>
<a name="ln-8170"></a>
<a name="ln-8171"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">H</span>        <span class="c">! Hour angle (before noon = +) (in radians)</span>
<a name="ln-8173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="n">HrAngle</span>  <span class="c">! Basic hour angle</span>
<a name="ln-8174"></a>
<a name="ln-8175"></a>          <span class="c">! Compute the hour angle</span>
<a name="ln-8176"></a>  <span class="n">HrAngle</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="mf">5.d0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="mf">2.d0</span><span class="o">-</span><span class="p">(</span><span class="n">CurrentTime</span><span class="o">+</span><span class="n">EqOfTime</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">TimeZoneMeridian</span><span class="o">-</span><span class="n">Longitude</span><span class="p">))</span>
<a name="ln-8177"></a>  <span class="n">H</span><span class="o">=</span><span class="n">HrAngle</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-8178"></a>
<a name="ln-8179"></a>          <span class="c">! Compute the cosine of the solar zenith angle.</span>
<a name="ln-8180"></a>  <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">SinSolarDeclin</span><span class="o">*</span><span class="n">SinLatitude</span> <span class="o">+</span> <span class="n">CosSolarDeclin</span><span class="o">*</span><span class="n">CosLatitude</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-8181"></a>  <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8182"></a>  <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8183"></a>
<a name="ln-8184"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SunIsUpValue</span><span class="p">)</span> <span class="k">RETURN</span>    <span class="c">! Return if sun not above horizon.</span>
<a name="ln-8185"></a>
<a name="ln-8186"></a>          <span class="c">! Compute other direction cosines.</span>
<a name="ln-8187"></a>  <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">SinSolarDeclin</span><span class="o">*</span><span class="n">CosLatitude</span> <span class="o">-</span> <span class="n">CosSolarDeclin</span><span class="o">*</span><span class="n">SinLatitude</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-8188"></a>  <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosSolarDeclin</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<a name="ln-8189"></a>
<a name="ln-8190"></a>  <span class="k">RETURN</span>
<a name="ln-8191"></a>
<a name="ln-8192"></a><span class="k">END SUBROUTINE </span><span class="n">SUN4</span>
<a name="ln-8193"></a>
<a name="ln-8194"></a><span class="k">SUBROUTINE </span><span class="n">WindowShadingManager</span>
<a name="ln-8195"></a>
<a name="ln-8196"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8197"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8198"></a>          <span class="c">!       DATE WRITTEN   December 1998</span>
<a name="ln-8199"></a>          <span class="c">!       MODIFIED       November 1999 (FW)</span>
<a name="ln-8200"></a>          <span class="c">!                      Aug 2001 (FW): change shading control names, change approach</span>
<a name="ln-8201"></a>          <span class="c">!                       to scheduling and glare control, add movable</span>
<a name="ln-8202"></a>          <span class="c">!                       insulation controls (mainly for heating reduction)</span>
<a name="ln-8203"></a>          <span class="c">!                      Dec 2001 (FW): add slat angle control for blinds</span>
<a name="ln-8204"></a>          <span class="c">!                      Aug 2002 (FW): add four new control types:</span>
<a name="ln-8205"></a>          <span class="c">!                        OnIfHighOutsideAirTempAndHighSolarOnWindow</span>
<a name="ln-8206"></a>          <span class="c">!                        OnIfHighOutsideAirTempAndHighHorizontalSolar</span>
<a name="ln-8207"></a>          <span class="c">!                        OnIfHighZoneAirTempAndHighSolarOnWindow</span>
<a name="ln-8208"></a>          <span class="c">!                        OnIfHighZoneAirTempAndHighHorizontalSolar</span>
<a name="ln-8209"></a>          <span class="c">!                      Dec 2002 (FW): add between-glass shade/blind</span>
<a name="ln-8210"></a>          <span class="c">!                      Mar 2003 (FW): allow GlareControlIsActive = .true. only for daylit zones</span>
<a name="ln-8211"></a>          <span class="c">!                      Apr 2003 (FW): use SNLoadCoolRate or SNLoadHeatRate only if not first time step</span>
<a name="ln-8212"></a>          <span class="c">!                                     (fixes problem when used first time thru and not allocated)</span>
<a name="ln-8213"></a>          <span class="c">!                      May 2006 (RR): add exterior window screen</span>
<a name="ln-8214"></a>          <span class="c">!                      May 2009 (BG): add EMS actuator override for shade flag and slat angle</span>
<a name="ln-8215"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8216"></a>
<a name="ln-8217"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8218"></a>          <span class="c">! For windows with shading, selects the shaded construction</span>
<a name="ln-8219"></a>          <span class="c">! that is used in the heat balance calculation, and sets</span>
<a name="ln-8220"></a>          <span class="c">! the window shading flag, which is:</span>
<a name="ln-8221"></a>          <span class="c">!  -1: if window has no shading device</span>
<a name="ln-8222"></a>          <span class="c">!   0: if shading device is off</span>
<a name="ln-8223"></a>          <span class="c">!   1: if interior shade is on</span>
<a name="ln-8224"></a>          <span class="c">!   2: if glazing is switched to darker state</span>
<a name="ln-8225"></a>          <span class="c">!   3: if exterior shade is on</span>
<a name="ln-8226"></a>          <span class="c">!   6: if interior blind is on</span>
<a name="ln-8227"></a>          <span class="c">!   7: if exterior blind is on</span>
<a name="ln-8228"></a>          <span class="c">!   8: if between-glass shade is on</span>
<a name="ln-8229"></a>          <span class="c">!   9: if between-glass blind is on</span>
<a name="ln-8230"></a>          <span class="c">!  10: window has interior shade that is off but may be triggered on later</span>
<a name="ln-8231"></a>          <span class="c">!       to control daylight glare</span>
<a name="ln-8232"></a>          <span class="c">!  20: window has switchable glazing that is unswitched but may be switched later</span>
<a name="ln-8233"></a>          <span class="c">!       to control daylight glare or daylight illuminance</span>
<a name="ln-8234"></a>          <span class="c">!  30: window has exterior shade that is off but may be triggered on later</span>
<a name="ln-8235"></a>          <span class="c">!       to control daylaight glare or daylight illuminance</span>
<a name="ln-8236"></a>          <span class="c">!  60: window has interior blind that is off but may be triggered on later</span>
<a name="ln-8237"></a>          <span class="c">!       to control daylaight glare or daylight illuminance</span>
<a name="ln-8238"></a>          <span class="c">!  70: window has exterior blind that is off but may be triggered on later</span>
<a name="ln-8239"></a>          <span class="c">!       to control daylaight glare or daylight illuminance</span>
<a name="ln-8240"></a>          <span class="c">!  80: window has between-glass shade that is off but may be triggered on later</span>
<a name="ln-8241"></a>          <span class="c">!       to control daylaight glare or daylight illuminance</span>
<a name="ln-8242"></a>          <span class="c">!  90: window has between-glass blind that is off but may be triggered on later</span>
<a name="ln-8243"></a>          <span class="c">!       to control daylaight glare or daylight illuminance</span>
<a name="ln-8244"></a>          <span class="c">! A &quot;shading device&quot; may be an exterior, interior or between-glass shade or blind,</span>
<a name="ln-8245"></a>          <span class="c">! or the lower-transmitting (dark) state of switchable glazing (e.g., electrochromic).</span>
<a name="ln-8246"></a>          <span class="c">! In all cases, the unshaded condition is represented</span>
<a name="ln-8247"></a>          <span class="c">! by the construction given by window&#39;s Surface()%Construction and</span>
<a name="ln-8248"></a>          <span class="c">! the shaded condition is represented by the construction given by</span>
<a name="ln-8249"></a>          <span class="c">! the window&#39;s Surface()%ShadedConstruction</span>
<a name="ln-8250"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8251"></a>          <span class="c">! na</span>
<a name="ln-8252"></a>
<a name="ln-8253"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8254"></a>          <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-8255"></a>          <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-8256"></a>          <span class="k">USE </span><span class="n">DataDaylighting</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneDaylight</span>
<a name="ln-8257"></a>          <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span>
<a name="ln-8258"></a>
<a name="ln-8259"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8260"></a>
<a name="ln-8261"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8262"></a>          <span class="c">! na</span>
<a name="ln-8263"></a>
<a name="ln-8264"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8265"></a>          <span class="c">! na</span>
<a name="ln-8266"></a>
<a name="ln-8267"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8268"></a>          <span class="c">! na</span>
<a name="ln-8269"></a>
<a name="ln-8270"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8271"></a>
<a name="ln-8272"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">ISurf</span>           <span class="c">! Surface counter</span>
<a name="ln-8273"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">IZone</span>           <span class="c">! Zone counter</span>
<a name="ln-8274"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">IShadingCtrl</span>    <span class="c">! Pointer to a window&#39;s shading control</span>
<a name="ln-8275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">BeamSolarOnWindow</span> <span class="c">! Direct solar intensity on window (W/m2)</span>
<a name="ln-8276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SolarOnWindow</span>   <span class="c">! Direct plus diffuse solar intensity on window (W/m2)</span>
<a name="ln-8277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SkySolarOnWindow</span> <span class="c">! Sky diffuse solar intensity on window (W/m2)</span>
<a name="ln-8278"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SchedulePtr</span>     <span class="c">! Schedule pointer</span>
<a name="ln-8279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">HorizSolar</span>      <span class="c">! Horizontal direct plus diffuse solar intensity</span>
<a name="ln-8280"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SetPoint</span>        <span class="c">! Control setpoint</span>
<a name="ln-8281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SetPoint2</span>       <span class="c">! Second control setpoint</span>
<a name="ln-8282"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">ShType</span>          <span class="c">! 1 = interior shade is on,</span>
<a name="ln-8283"></a>                                        <span class="c">! 2 = glass is switched to dark state,</span>
<a name="ln-8284"></a>                                        <span class="c">! 3 = exterior shade is on,</span>
<a name="ln-8285"></a>                                        <span class="c">! 4 = exterior screen is on,</span>
<a name="ln-8286"></a>                                        <span class="c">! 6 = interior blind is on,</span>
<a name="ln-8287"></a>                                        <span class="c">! 7 = exterior blind is on,</span>
<a name="ln-8288"></a>                                        <span class="c">! 8 = between-glass shade is on,</span>
<a name="ln-8289"></a>                                        <span class="c">! 9 = between-glass blind is on.</span>
<a name="ln-8290"></a><span class="c">!  CHARACTER(len=32)  :: ShadingType     ! Type of shading (interior shade, interior blind, etc.)</span>
<a name="ln-8291"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">ShadingType</span>     <span class="c">! Type of shading (interior shade, interior blind, etc.)</span>
<a name="ln-8292"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">SchedAllowsControl</span> <span class="c">! True if control schedule is not specified or is</span>
<a name="ln-8293"></a>                                           <span class="c">!  specified and schedule value = 1</span>
<a name="ln-8294"></a>  <span class="kt">LOGICAL</span>            <span class="kd">::</span> <span class="n">GlareControlIsActive</span> <span class="c">! True if glare control is active</span>
<a name="ln-8295"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">BlNum</span>           <span class="c">! Blind number</span>
<a name="ln-8296"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">InputSlatAngle</span>  <span class="c">! Slat angle of associated Material:WindowBlind (rad)</span>
<a name="ln-8297"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ProfAng</span>         <span class="c">! Solar profile angle (rad)</span>
<a name="ln-8298"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SlatAng</span>         <span class="c">! Slat angle this time step (rad)</span>
<a name="ln-8299"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">PermeabilityA</span><span class="p">,</span><span class="n">PermeabilityB</span> <span class="c">! Intermediate variables in blind permeability calc</span>
<a name="ln-8300"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ThetaBase</span>       <span class="c">! Intermediate slat angle variable (rad)</span>
<a name="ln-8301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ThetaBlock1</span><span class="p">,</span> <span class="n">ThetaBlock2</span> <span class="c">! Slat angles that just block beam solar (rad)</span>
<a name="ln-8302"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">ThetaBig</span><span class="p">,</span><span class="n">ThetaSmall</span> <span class="c">! Larger and smaller value of ThetaBlock1 and ThetaBlock2, resp.</span>
<a name="ln-8303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>     <span class="kd">::</span> <span class="n">ThetaMin</span><span class="p">,</span><span class="n">ThetaMax</span> <span class="c">! Minimum and maximum allowed slat angle, resp. (rad)</span>
<a name="ln-8304"></a>
<a name="ln-8305"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">IConst</span>          <span class="c">! Construction</span>
<a name="ln-8306"></a>
<a name="ln-8307"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-8308"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ExtIntShadePrevTS</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span>
<a name="ln-8309"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">NoShade</span>
<a name="ln-8310"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">FracTimeShadingDeviceOn</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8311"></a>
<a name="ln-8312"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8313"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8314"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8315"></a>
<a name="ln-8316"></a>            <span class="c">! Initialize switching factor (applicable only to switchable glazing) to unswitched</span>
<a name="ln-8317"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8318"></a>
<a name="ln-8319"></a>    <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-8320"></a>    <span class="c">! Vis trans at normal incidence of unswitched glass. Counting the GlazedFrac</span>
<a name="ln-8321"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">IConst</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-8322"></a>      <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-8323"></a>
<a name="ln-8324"></a>            <span class="c">! Window has shading control</span>
<a name="ln-8325"></a>    <span class="n">IShadingCtrl</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-8326"></a>    <span class="n">ShadingType</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">ShadingType</span>
<a name="ln-8327"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShadeOff</span>  <span class="c">! Initialize shading flag to off</span>
<a name="ln-8328"></a>    <span class="n">IZone</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-8329"></a>            <span class="c">! Setpoint for shading</span>
<a name="ln-8330"></a>    <span class="n">SetPoint</span>  <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">SetPoint</span>
<a name="ln-8331"></a>    <span class="n">SetPoint2</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">SetPoint2</span>
<a name="ln-8332"></a>
<a name="ln-8333"></a><span class="c">!                                           ShType = NoShade           ! =-1 (see DataHeatBalance)</span>
<a name="ln-8334"></a><span class="c">!                                           ShType = ShadeOff          ! =0</span>
<a name="ln-8335"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorShade</span><span class="p">)</span>      <span class="n">ShType</span> <span class="o">=</span> <span class="n">IntShadeOn</span>        <span class="c">! =1</span>
<a name="ln-8336"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_SwitchableGlazing</span><span class="p">)</span>  <span class="n">ShType</span> <span class="o">=</span> <span class="n">SwitchableGlazing</span> <span class="c">! =2</span>
<a name="ln-8337"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorShade</span><span class="p">)</span>      <span class="n">ShType</span> <span class="o">=</span> <span class="n">ExtShadeOn</span>        <span class="c">! =3</span>
<a name="ln-8338"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorScreen</span><span class="p">)</span>     <span class="n">ShType</span> <span class="o">=</span> <span class="n">ExtScreenOn</span>       <span class="c">! =4</span>
<a name="ln-8339"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorBlind</span><span class="p">)</span>      <span class="n">ShType</span> <span class="o">=</span> <span class="n">IntBlindOn</span>        <span class="c">! =6</span>
<a name="ln-8340"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorBlind</span><span class="p">)</span>      <span class="n">ShType</span> <span class="o">=</span> <span class="n">ExtBlindOn</span>        <span class="c">! =7</span>
<a name="ln-8341"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassShade</span><span class="p">)</span>  <span class="n">ShType</span> <span class="o">=</span> <span class="n">BGShadeOn</span>         <span class="c">! =8</span>
<a name="ln-8342"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassBlind</span><span class="p">)</span>  <span class="n">ShType</span> <span class="o">=</span> <span class="n">BGBlindOn</span>         <span class="c">! =9</span>
<a name="ln-8343"></a>
<a name="ln-8344"></a>    <span class="n">SchedAllowsControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8345"></a>    <span class="n">SchedulePtr</span> <span class="o">=</span> <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">Schedule</span>
<a name="ln-8346"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SchedulePtr</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8347"></a><span class="k">      IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">ShadingControlIsScheduled</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8348"></a>         <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchedulePtr</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">SchedAllowsControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8349"></a>    <span class="k">END IF</span>
<a name="ln-8350"></a>
<a name="ln-8351"></a><span class="k">    </span><span class="n">GlareControlIsActive</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneDaylight</span><span class="p">(</span><span class="n">IZone</span><span class="p">)%</span><span class="n">TotalDaylRefPoints</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8352"></a>                            <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">GlareControlIsActive</span><span class="p">)</span>
<a name="ln-8353"></a>
<a name="ln-8354"></a>    <span class="n">SolarOnWindow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8355"></a>    <span class="n">BeamSolarOnWindow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8356"></a>    <span class="n">HorizSolar</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8357"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8358"></a><span class="k">      </span><span class="n">SkySolarOnWindow</span> <span class="o">=</span> <span class="n">AnisoSkyMult</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)</span><span class="o">*</span><span class="n">DifSolarRad</span>
<a name="ln-8359"></a>      <span class="n">BeamSolarOnWindow</span> <span class="o">=</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">CosIncAng</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span><span class="o">*</span><span class="n">SunLitFrac</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-8360"></a>      <span class="n">SolarOnWindow</span> <span class="o">=</span> <span class="n">BeamSolarOnWindow</span> <span class="o">+</span> <span class="n">SkySolarOnWindow</span> <span class="o">+</span> <span class="n">GndSolarRad</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ViewFactorGround</span>
<a name="ln-8361"></a>      <span class="n">HorizSolar</span> <span class="o">=</span> <span class="n">BeamSolarRad</span><span class="o">*</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">DifSolarRad</span>
<a name="ln-8362"></a>    <span class="k">END IF</span>
<a name="ln-8363"></a>
<a name="ln-8364"></a>            <span class="c">! Determine whether to deploy shading depending on type of control</span>
<a name="ln-8365"></a>
<a name="ln-8366"></a>    <span class="k">SELECT CASE</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">ShadingControlType</span><span class="p">)</span>
<a name="ln-8367"></a>
<a name="ln-8368"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">WSCT_AlwaysOn</span><span class="p">)</span> <span class="c">! &#39;ALWAYSON&#39;</span>
<a name="ln-8369"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8370"></a>
<a name="ln-8371"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">WSCT_AlwaysOff</span><span class="p">)</span> <span class="c">! &#39;ALWAYSOFF&#39;</span>
<a name="ln-8372"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShadeOff</span>
<a name="ln-8373"></a>
<a name="ln-8374"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">WSCT_OnIfScheduled</span><span class="p">)</span> <span class="c">! &#39;ONIFSCHEDULEALLOWS&#39;</span>
<a name="ln-8375"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8376"></a>
<a name="ln-8377"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">WSCT_HiSolar</span><span class="p">)</span> <span class="c">! &#39;ONIFHIGHSOLARONWINDOW&#39;  ! Direct plus diffuse solar intensity on window</span>
<a name="ln-8378"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8379"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SolarOnWindow</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8380"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8381"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8382"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8383"></a>      <span class="k">END IF</span>
<a name="ln-8384"></a><span class="k">    END IF</span>
<a name="ln-8385"></a>
<a name="ln-8386"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_HiHorzSolar</span><span class="p">)</span> <span class="c">! &#39;ONIFHIGHHORIZONTALSOLAR&#39;  ! Direct plus diffuse exterior horizontal solar intensity</span>
<a name="ln-8387"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8388"></a><span class="k">      IF</span><span class="p">(</span><span class="n">HorizSolar</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8389"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8390"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8391"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8392"></a>      <span class="k">END IF</span>
<a name="ln-8393"></a><span class="k">    END IF</span>
<a name="ln-8394"></a>
<a name="ln-8395"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_HiOutAirTemp</span><span class="p">)</span> <span class="c">! &#39;OnIfHighOutdoorAirTemperature&#39;</span>
<a name="ln-8396"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8397"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8398"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8399"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8400"></a>    <span class="k">END IF</span>
<a name="ln-8401"></a>
<a name="ln-8402"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_HiZoneAirTemp</span><span class="p">)</span> <span class="c">! &#39;OnIfHighZoneAirTemperature&#39;  ! Previous time step zone air temperature</span>
<a name="ln-8403"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">MAT</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8404"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8405"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8406"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8407"></a>    <span class="k">END IF</span>
<a name="ln-8408"></a>
<a name="ln-8409"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnHiOutTemp_HiSolarWindow</span><span class="p">)</span> <span class="c">! &#39;OnIfHighOutdoorAirTempAndHighSolarOnWindow&#39;  ! Outside air temp and solar on window</span>
<a name="ln-8410"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8411"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SolarOnWindow</span> <span class="o">&gt;</span> <span class="n">Setpoint2</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8412"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8413"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8414"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8415"></a>      <span class="k">END IF</span>
<a name="ln-8416"></a><span class="k">    END IF</span>
<a name="ln-8417"></a>
<a name="ln-8418"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnHiOutTemp_HiHorzSolar</span><span class="p">)</span> <span class="c">! &#39;OnIfHighOutdoorAirTempAndHighHorizontalSolar&#39;  ! Outside air temp and horizontal solar</span>
<a name="ln-8419"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8420"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">HorizSolar</span> <span class="o">&gt;</span> <span class="n">Setpoint2</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8421"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8422"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8423"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8424"></a>      <span class="k">END IF</span>
<a name="ln-8425"></a><span class="k">    END IF</span>
<a name="ln-8426"></a>
<a name="ln-8427"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnHiZoneTemp_HiSolarWindow</span><span class="p">)</span> <span class="c">! &#39;ONIFHIGHZONEAIRTEMPANDHIGHSOLARONWINDOW&#39;  ! Zone air temp and solar on window</span>
<a name="ln-8428"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8429"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MAT</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SolarOnWindow</span> <span class="o">&gt;</span> <span class="n">Setpoint2</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8430"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8431"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8432"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8433"></a>      <span class="k">END IF</span>
<a name="ln-8434"></a><span class="k">    END IF</span>
<a name="ln-8435"></a>
<a name="ln-8436"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnHiZoneTemp_HiHorzSolar</span><span class="p">)</span> <span class="c">! &#39;ONIFHIGHZONEAIRTEMPANDHIGHHORIZONTALSOLAR&#39;  ! Zone air temp and horizontal solar</span>
<a name="ln-8437"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8438"></a><span class="k">      IF</span><span class="p">(</span><span class="n">MAT</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">HorizSolar</span> <span class="o">&gt;</span> <span class="n">Setpoint2</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8439"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8440"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8441"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8442"></a>      <span class="k">END IF</span>
<a name="ln-8443"></a><span class="k">    END IF</span>
<a name="ln-8444"></a>
<a name="ln-8445"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_HiZoneCooling</span><span class="p">)</span> <span class="c">! &#39;ONIFHIGHZONECOOLING&#39;  ! Previous time step zone sensible cooling rate [W]</span>
<a name="ln-8446"></a>    <span class="c">! In the following, the check on BeginSimFlag is needed since SNLoadCoolRate (and SNLoadHeatRate,</span>
<a name="ln-8447"></a>    <span class="c">! used in other CASEs) are not allocated at this point for the first time step of the simulation.</span>
<a name="ln-8448"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8449"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SNLoadCoolRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8450"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8451"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8452"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8453"></a>      <span class="k">END IF</span>
<a name="ln-8454"></a><span class="k">    END IF</span>
<a name="ln-8455"></a>
<a name="ln-8456"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_HiGlare</span><span class="p">)</span> <span class="c">! &#39;ONIFHIGHGLARE&#39;  ! Daylight glare index at first reference point in the zone.</span>
<a name="ln-8457"></a>    <span class="c">! This type of shading control is done in DayltgInteriorIllum. Glare control is not affected</span>
<a name="ln-8458"></a>    <span class="c">! by control schedule.</span>
<a name="ln-8459"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8460"></a>
<a name="ln-8461"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">WSCT_MeetDaylIlumSetp</span><span class="p">)</span> <span class="c">! &#39;MEETDAYLIGHTILLUMINANCESETPOINT&#39;)  !  Daylight illuminance test is done in DayltgInteriorIllum</span>
<a name="ln-8462"></a>    <span class="c">! Only switchable glazing does daylight illuminance control</span>
<a name="ln-8463"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SunIsUp</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">GlassConditionallyLightened</span>
<a name="ln-8464"></a>
<a name="ln-8465"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">WSCT_OnNightLoOutTemp_OffDay</span><span class="p">)</span> <span class="c">! &#39;OnNightIfLowOutdoorTempAndOffDay&#39;</span>
<a name="ln-8466"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">SetPoint</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8467"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8468"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8469"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8470"></a>    <span class="k">END IF</span>
<a name="ln-8471"></a>
<a name="ln-8472"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnNightLoInTemp_OffDay</span><span class="p">)</span> <span class="c">! &#39;OnNightIfLowInsideTempAndOffDay&#39;)</span>
<a name="ln-8473"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MAT</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SetPoint</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8474"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8475"></a>    <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8476"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8477"></a>    <span class="k">END IF</span>
<a name="ln-8478"></a>
<a name="ln-8479"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnNightIfHeating_OffDay</span><span class="p">)</span> <span class="c">! &#39;OnNightIfHeatingAndOffDay&#39;</span>
<a name="ln-8480"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8481"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SNLoadHeatRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SetPoint</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8482"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8483"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8484"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8485"></a>      <span class="k">END IF</span>
<a name="ln-8486"></a><span class="k">    END IF</span>
<a name="ln-8487"></a>
<a name="ln-8488"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnNightLoOutTemp_OnDayCooling</span><span class="p">)</span> <span class="c">! &#39;OnNightIfLowOutdoorTempAndOnDayIfCooling&#39;</span>
<a name="ln-8489"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8490"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Night</span>
<a name="ln-8491"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">OutDryBulbTemp</span> <span class="o">&lt;</span> <span class="n">SetPoint</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8492"></a>      <span class="k">ELSE</span>                   <span class="c">! Day</span>
<a name="ln-8493"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SNLoadCoolRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8494"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8495"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8496"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8497"></a>        <span class="k">END IF</span>
<a name="ln-8498"></a><span class="k">      END IF</span>
<a name="ln-8499"></a><span class="k">    END IF</span>
<a name="ln-8500"></a>
<a name="ln-8501"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnNightIfHeating_OnDayCooling</span><span class="p">)</span> <span class="c">! &#39;OnNightIfHeatingAndOnDayIfCooling&#39;</span>
<a name="ln-8502"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8503"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SunIsUp</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Night</span>
<a name="ln-8504"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SNLoadHeatRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">SetPoint</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8505"></a>      <span class="k">ELSE</span>                   <span class="c">! Day</span>
<a name="ln-8506"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">SNLoadCoolRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8507"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8508"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8509"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8510"></a>        <span class="k">END IF</span>
<a name="ln-8511"></a><span class="k">      END IF</span>
<a name="ln-8512"></a><span class="k">    END IF</span>
<a name="ln-8513"></a>
<a name="ln-8514"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OffNight_OnDay_HiSolarWindow</span><span class="p">)</span> <span class="c">! &#39;OffNightAndOnDayIfCoolingAndHighSolarOnWindow&#39;</span>
<a name="ln-8515"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8516"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SNLoadCoolRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8517"></a><span class="k">        IF</span><span class="p">(</span><span class="n">SolarOnWindow</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8518"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8519"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8520"></a>      <span class="k">END IF</span>
<a name="ln-8521"></a><span class="k">    END IF</span>
<a name="ln-8522"></a>
<a name="ln-8523"></a><span class="k">    CASE</span><span class="p">(</span><span class="n">WSCT_OnNight_OnDay_HiSolarWindow</span><span class="p">)</span> <span class="c">! &#39;OnNightAndOnDayIfCoolingAndHighSolarOnWindow&#39;</span>
<a name="ln-8524"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">BeginSimFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8525"></a><span class="k">      IF</span><span class="p">(</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SNLoadCoolRate</span><span class="p">(</span><span class="n">IZone</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8526"></a><span class="k">        IF</span><span class="p">(</span><span class="n">SolarOnWindow</span> <span class="o">&gt;</span> <span class="n">SetPoint</span><span class="p">)</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8527"></a>      <span class="k">ELSE IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">SunIsUp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SchedAllowsControl</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8528"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">ShType</span>
<a name="ln-8529"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">GlareControlIsActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8530"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">ShType</span>
<a name="ln-8531"></a>      <span class="k">END IF</span>
<a name="ln-8532"></a><span class="k">    END IF</span>
<a name="ln-8533"></a>
<a name="ln-8534"></a><span class="k">    END SELECT</span>
<a name="ln-8535"></a>
<a name="ln-8536"></a>          <span class="c">! Set switching factor to fully switched if ShadingFlag = 2</span>
<a name="ln-8537"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8538"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SwitchingFactor</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8539"></a>
<a name="ln-8540"></a>      <span class="c">! Added TH 1/20/2010</span>
<a name="ln-8541"></a>      <span class="c">! Vis trans at normal incidence of fully switched glass</span>
<a name="ln-8542"></a>      <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-8543"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">VisTransSelected</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TransVisBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-8544"></a>        <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-8545"></a>    <span class="n">ENDIF</span>
<a name="ln-8546"></a>
<a name="ln-8547"></a>    <span class="c">! Slat angle control for blinds</span>
<a name="ln-8548"></a>
<a name="ln-8549"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8550"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTSDeg</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8551"></a>    <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8552"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">==</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">==</span><span class="mi">10</span><span class="o">*</span><span class="n">IntBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8553"></a>       <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">==</span><span class="mi">10</span><span class="o">*</span><span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8554"></a>       <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span><span class="o">==</span><span class="mi">10</span><span class="o">*</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8555"></a>         <span class="c">! Blind in place or may be in place due to glare control</span>
<a name="ln-8556"></a>      <span class="n">BlNum</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-8557"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">BlNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8558"></a><span class="k">        </span><span class="n">InputSlatAngle</span> <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatAngle</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-8559"></a>
<a name="ln-8560"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span> <span class="o">&gt;</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">BeamSolarOnWindow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8561"></a><span class="k">          CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">SOLCOS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-8562"></a>          <span class="n">ThetaBase</span>   <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="nb">COS</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">)</span> <span class="o">*</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="o">/</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">)</span>
<a name="ln-8563"></a>          <span class="c">! There are two solutions for the slat angle that just blocks beam radiation</span>
<a name="ln-8564"></a>          <span class="n">ThetaBlock1</span> <span class="o">=</span> <span class="n">ProfAng</span> <span class="o">+</span> <span class="n">ThetaBase</span>
<a name="ln-8565"></a>          <span class="n">ThetaBlock2</span> <span class="o">=</span> <span class="n">ProfAng</span> <span class="o">+</span> <span class="n">PI</span> <span class="o">-</span> <span class="n">ThetaBase</span>
<a name="ln-8566"></a>          <span class="n">ThetaSmall</span>  <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ThetaBlock1</span><span class="p">,</span><span class="n">ThetaBlock2</span><span class="p">)</span>
<a name="ln-8567"></a>          <span class="n">ThetaBig</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ThetaBlock1</span><span class="p">,</span><span class="n">ThetaBlock2</span><span class="p">)</span>
<a name="ln-8568"></a>          <span class="n">ThetaMin</span>    <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">MinSlatAngle</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-8569"></a>          <span class="n">ThetaMax</span>    <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">MaxSlatAngle</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-8570"></a>        <span class="k">END IF</span>
<a name="ln-8571"></a>
<a name="ln-8572"></a>        <span class="c">! TH 5/20/2010, CR 8064: Slat Width &lt;= Slat Separation</span>
<a name="ln-8573"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span> <span class="o">&lt;=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">BeamSolarOnWindow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8574"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">SlatAngleControlForBlinds</span> <span class="o">==</span> <span class="n">WSC_SAC_BlockBeamSolar</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8575"></a>
<a name="ln-8576"></a><span class="k">            CALL </span><span class="n">ProfileAngle</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">SOLCOS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatOrientation</span><span class="p">,</span><span class="n">ProfAng</span><span class="p">)</span>
<a name="ln-8577"></a>
<a name="ln-8578"></a>            <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">COS</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">)</span><span class="o">*</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="o">/</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.0D0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8579"></a>              <span class="c">! set to block 100% of beam solar, not necessarily to block maximum solar (beam + diffuse)</span>
<a name="ln-8580"></a>              <span class="n">ThetaBase</span>   <span class="o">=</span> <span class="nb">ACOS</span><span class="p">(</span><span class="nb">COS</span><span class="p">(</span><span class="n">ProfAng</span><span class="p">)</span><span class="o">*</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="o">/</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">)</span>
<a name="ln-8581"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8582"></a>            <span class="k">ELSE</span>
<a name="ln-8583"></a>              <span class="c">! cannot block 100% of beam solar, turn slats to be perpendicular to sun beam to block maximal beam solar</span>
<a name="ln-8584"></a>              <span class="n">ThetaBase</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8585"></a>            <span class="n">ENDIF</span>
<a name="ln-8586"></a>
<a name="ln-8587"></a>            <span class="c">! There are two solutions for the slat angle that just blocks beam radiation</span>
<a name="ln-8588"></a>            <span class="n">ThetaBlock1</span> <span class="o">=</span> <span class="n">ProfAng</span> <span class="o">+</span> <span class="n">ThetaBase</span>
<a name="ln-8589"></a>            <span class="n">ThetaBlock2</span> <span class="o">=</span> <span class="n">ProfAng</span> <span class="o">-</span> <span class="n">ThetaBase</span> <span class="o">+</span> <span class="n">PI</span>
<a name="ln-8590"></a>
<a name="ln-8591"></a>            <span class="n">ThetaSmall</span>  <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">ThetaBlock1</span><span class="p">,</span><span class="n">ThetaBlock2</span><span class="p">)</span>
<a name="ln-8592"></a>            <span class="n">ThetaBig</span>    <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">ThetaBlock1</span><span class="p">,</span><span class="n">ThetaBlock2</span><span class="p">)</span>
<a name="ln-8593"></a>            <span class="n">ThetaMin</span>    <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">MinSlatAngle</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-8594"></a>            <span class="n">ThetaMax</span>    <span class="o">=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">MaxSlatAngle</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-8595"></a>         <span class="n">ENDIF</span>
<a name="ln-8596"></a>       <span class="k">END IF</span>
<a name="ln-8597"></a>
<a name="ln-8598"></a><span class="k">        SELECT CASE</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">SlatAngleControlForBlinds</span><span class="p">)</span>
<a name="ln-8599"></a>
<a name="ln-8600"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">WSC_SAC_FixedSlatAngle</span><span class="p">)</span> <span class="c">! &#39;FIXEDSLATANGLE&#39;</span>
<a name="ln-8601"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">InputSlatAngle</span>
<a name="ln-8602"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">&lt;=</span> <span class="n">ThetaSmall</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">&gt;=</span> <span class="n">ThetaBig</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8603"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span> <span class="o">&gt;</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8604"></a>             <span class="p">(</span><span class="n">BeamSolarOnWindow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8605"></a>
<a name="ln-8606"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">WSC_SAC_ScheduledSlatAngle</span><span class="p">)</span> <span class="c">! &#39;SCHEDULEDSLATANGLE&#39;</span>
<a name="ln-8607"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">IShadingCtrl</span><span class="p">)%</span><span class="n">SlatAngleSchedule</span><span class="p">)</span>
<a name="ln-8608"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">MinSlatAngle</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8609"></a>            <span class="nb">MIN</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">MaxSlatAngle</span><span class="p">))</span><span class="o">*</span><span class="n">DegToRadians</span>
<a name="ln-8610"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">&lt;=</span> <span class="n">ThetaSmall</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">&gt;=</span> <span class="n">ThetaBig</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8611"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span> <span class="o">&gt;</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8612"></a>              <span class="p">(</span><span class="n">BeamSolarOnWindow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8613"></a>
<a name="ln-8614"></a>        <span class="k">CASE</span><span class="p">(</span><span class="n">WSC_SAC_BlockBeamSolar</span><span class="p">)</span> <span class="c">! &#39;BLOCKBEAMSOLAR&#39;</span>
<a name="ln-8615"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">BeamSolarOnWindow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8616"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span> <span class="o">&gt;=</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8617"></a>            <span class="c">! TH 5/20/2010. CR 8064.</span>
<a name="ln-8618"></a>            <span class="c">! The following line of code assumes slats are always vertical/closed to minimize solar penetration</span>
<a name="ln-8619"></a>            <span class="c">! The slat angle can however change if the only goal is to block maximum amount of direct beam solar</span>
<a name="ln-8620"></a>            <span class="c">!SurfaceWindow(ISurf)%SlatAngThisTS = 0.0  ! Allows beam penetration but minimizes it</span>
<a name="ln-8621"></a>
<a name="ln-8622"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ThetaSmall</span> <span class="o">&gt;=</span> <span class="n">ThetaMin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaSmall</span> <span class="o">&lt;=</span> <span class="n">ThetaMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8623"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaSmall</span>
<a name="ln-8624"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ThetaBig</span> <span class="o">&gt;=</span> <span class="n">ThetaMin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaBig</span> <span class="o">&lt;=</span> <span class="n">ThetaMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8625"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaBig</span>
<a name="ln-8626"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ThetaSmall</span> <span class="o">&lt;</span> <span class="n">ThetaMin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaBig</span> <span class="o">&lt;</span> <span class="n">ThetaMin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8627"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaMin</span>
<a name="ln-8628"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ThetaSmall</span> <span class="o">&gt;</span> <span class="n">ThetaMax</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaBig</span> <span class="o">&gt;</span> <span class="n">ThetaMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8629"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaMax</span>
<a name="ln-8630"></a>            <span class="k">ELSE</span>  <span class="c">! ThetaBig &gt; ThetaMax and ThetaSmall &lt; ThetaMin (no-block condition)</span>
<a name="ln-8631"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaMin</span>
<a name="ln-8632"></a>            <span class="k">END IF</span>
<a name="ln-8633"></a>
<a name="ln-8634"></a><span class="k">          ELSE</span>  <span class="c">! Usual case -- slat width greater than slat separation</span>
<a name="ln-8635"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ThetaSmall</span> <span class="o">&gt;=</span> <span class="n">ThetaMin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaSmall</span> <span class="o">&lt;=</span> <span class="n">ThetaMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8636"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaSmall</span>
<a name="ln-8637"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8638"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ThetaBig</span> <span class="o">&gt;=</span> <span class="n">ThetaMin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaBig</span> <span class="o">&lt;=</span> <span class="n">ThetaMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8639"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaBig</span>
<a name="ln-8640"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8641"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ThetaSmall</span> <span class="o">&lt;</span> <span class="n">ThetaMin</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaBig</span> <span class="o">&lt;</span> <span class="n">ThetaMin</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8642"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaMin</span>
<a name="ln-8643"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8644"></a>            <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ThetaSmall</span> <span class="o">&gt;</span> <span class="n">ThetaMax</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ThetaBig</span> <span class="o">&gt;</span> <span class="n">ThetaMax</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8645"></a><span class="k">              </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaMax</span>
<a name="ln-8646"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatsBlockBeam</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8647"></a>            <span class="k">ELSE</span>  <span class="c">! ThetaBig &gt; ThetaMax and ThetaSmall &lt; ThetaMin (no-block condition)</span>
<a name="ln-8648"></a>              <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">ThetaMin</span>
<a name="ln-8649"></a>            <span class="k">END IF</span>
<a name="ln-8650"></a><span class="k">          END IF</span>
<a name="ln-8651"></a><span class="k">        ELSE</span>
<a name="ln-8652"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">InputSlatAngle</span>
<a name="ln-8653"></a>        <span class="k">END IF</span>
<a name="ln-8654"></a>
<a name="ln-8655"></a><span class="k">        END SELECT</span>
<a name="ln-8656"></a>
<a name="ln-8657"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTSDeg</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">/</span> <span class="n">DegToRadians</span>
<a name="ln-8658"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTSDegEMSon</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8659"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTSDeg</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTSDegEMSValue</span>
<a name="ln-8660"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span> <span class="o">=</span> <span class="n">DegToRadians</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTSDeg</span>
<a name="ln-8661"></a>       <span class="n">ENDIF</span>
<a name="ln-8662"></a>        <span class="c">! Air flow permeability for calculation of convective air flow between blind and glass</span>
<a name="ln-8663"></a>        <span class="n">SlatAng</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">SlatAngThisTS</span>
<a name="ln-8664"></a>        <span class="n">PermeabilityA</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">)</span> <span class="o">-</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="o">/</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span>
<a name="ln-8665"></a>        <span class="n">PermeabilityB</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatWidth</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">))</span> <span class="o">+</span> <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatThickness</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">SlatAng</span><span class="p">))</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-8666"></a>                            <span class="n">Blind</span><span class="p">(</span><span class="n">BlNum</span><span class="p">)%</span><span class="n">SlatSeparation</span>
<a name="ln-8667"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">BlindAirFlowPermeability</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PermeabilityA</span><span class="p">,</span><span class="n">PermeabilityB</span><span class="p">))</span>
<a name="ln-8668"></a>      <span class="k">END IF</span>
<a name="ln-8669"></a><span class="k">    END IF</span>  <span class="c">! End of check if interior or exterior blind in place</span>
<a name="ln-8670"></a>
<a name="ln-8671"></a><span class="c">!   CALL CalcScreenTransmittance to intialized all screens prior to HB calc&#39;s</span>
<a name="ln-8672"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SunIsUp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8673"></a><span class="k">      CALL </span><span class="n">CalcScreenTransmittance</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)</span>
<a name="ln-8674"></a>    <span class="k">END IF</span>
<a name="ln-8675"></a>
<a name="ln-8676"></a>    <span class="c">! EMS Actuator Point: override setting if ems flag on</span>
<a name="ln-8677"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlagEMSOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8678"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlag</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ShadingFlagEMSValue</span>
<a name="ln-8679"></a>    <span class="n">ENDIF</span>
<a name="ln-8680"></a>
<a name="ln-8681"></a>
<a name="ln-8682"></a>
<a name="ln-8683"></a>  <span class="k">END DO</span>  <span class="c">!End of surface loop</span>
<a name="ln-8684"></a><span class="k">Return</span>
<a name="ln-8685"></a><span class="k">END SUBROUTINE </span><span class="n">WindowShadingManager</span>
<a name="ln-8686"></a>
<a name="ln-8687"></a><span class="k">SUBROUTINE </span><span class="n">WindowGapAirflowControl</span>
<a name="ln-8688"></a>
<a name="ln-8689"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8690"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8691"></a>          <span class="c">!       DATE WRITTEN   February 2003</span>
<a name="ln-8692"></a>          <span class="c">!       MODIFIED       June 2003, FCW: add fatal error for illegal schedule value</span>
<a name="ln-8693"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8694"></a>
<a name="ln-8695"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8696"></a>          <span class="c">! For airflow windows, determines the airflow in the gap of</span>
<a name="ln-8697"></a>          <span class="c">! double glazing and in the inner gap of triple glazing.</span>
<a name="ln-8698"></a>
<a name="ln-8699"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8700"></a>          <span class="c">! na</span>
<a name="ln-8701"></a>
<a name="ln-8702"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8703"></a>          <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-8704"></a>
<a name="ln-8705"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8706"></a>
<a name="ln-8707"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8708"></a>          <span class="c">! na</span>
<a name="ln-8709"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8710"></a>          <span class="c">! na</span>
<a name="ln-8711"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8712"></a>          <span class="c">! na</span>
<a name="ln-8713"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8714"></a>
<a name="ln-8715"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">ISurf</span>           <span class="c">! Surface counter</span>
<a name="ln-8716"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SchedulePtr</span>     <span class="c">! Schedule pointer</span>
<a name="ln-8717"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ScheduleMult</span>    <span class="c">! Multiplier value from schedule</span>
<a name="ln-8718"></a>
<a name="ln-8719"></a>  <span class="k">DO </span><span class="n">ISurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-8720"></a>
<a name="ln-8721"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8722"></a>
<a name="ln-8723"></a><span class="k">    </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowThisTS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8724"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">MaxAirflow</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8725"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8726"></a>
<a name="ln-8727"></a><span class="k">    SELECT CASE</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowControlType</span><span class="p">)</span>
<a name="ln-8728"></a>
<a name="ln-8729"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">AirFlowWindow_ControlType_MaxFlow</span><span class="p">)</span>
<a name="ln-8730"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowThisTS</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">MaxAirflow</span>
<a name="ln-8731"></a>
<a name="ln-8732"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">AirFlowWindow_ControlType_AlwaysOff</span><span class="p">)</span>
<a name="ln-8733"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowThisTS</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8734"></a>
<a name="ln-8735"></a>    <span class="k">CASE</span><span class="p">(</span><span class="n">AirFlowWindow_ControlType_Schedule</span><span class="p">)</span>
<a name="ln-8736"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowHasSchedule</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8737"></a><span class="k">        </span><span class="n">SchedulePtr</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowSchedulePtr</span>
<a name="ln-8738"></a>        <span class="n">ScheduleMult</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">SchedulePtr</span><span class="p">)</span>
<a name="ln-8739"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ScheduleMult</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ScheduleMult</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8740"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Airflow schedule has a value outside the range 0.0 to 1.0 for window=&#39;</span> <span class="p">&amp;</span>
<a name="ln-8741"></a>             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8742"></a>        <span class="k">END IF</span>
<a name="ln-8743"></a><span class="k">        </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">AirflowThisTS</span> <span class="o">=</span> <span class="n">ScheduleMult</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">MaxAirflow</span>
<a name="ln-8744"></a>      <span class="k">END IF</span>
<a name="ln-8745"></a>
<a name="ln-8746"></a><span class="k">    END SELECT</span>
<a name="ln-8747"></a>
<a name="ln-8748"></a><span class="k">  END DO</span>  <span class="c">! End of surface loop</span>
<a name="ln-8749"></a>
<a name="ln-8750"></a>  <span class="k">RETURN</span>
<a name="ln-8751"></a><span class="k">  END SUBROUTINE </span><span class="n">WindowGapAirflowControl</span>
<a name="ln-8752"></a>
<a name="ln-8753"></a><span class="k">SUBROUTINE </span><span class="n">SkyDifSolarShading</span>
<a name="ln-8754"></a>
<a name="ln-8755"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8756"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-8757"></a>          <span class="c">!       DATE WRITTEN   May 1999</span>
<a name="ln-8758"></a>          <span class="c">!       MODIFIED       Sep 2000, FCW: add IR view factor calc</span>
<a name="ln-8759"></a>          <span class="c">!                      Sep 2002, FCW: correct error in expression for ground IR view factor.</span>
<a name="ln-8760"></a>          <span class="c">!                         Affects only non-vertical surfaces that are shadowed. For these surfaces</span>
<a name="ln-8761"></a>          <span class="c">!                         error caused underestimate of IR from ground and shadowing surfaces.</span>
<a name="ln-8762"></a>          <span class="c">!                      Dec 2002; LKL: Sky Radiance Distribution now only anisotropic</span>
<a name="ln-8763"></a>          <span class="c">!                      Nov 2003: FCW: modify to do sky solar shading of shadowing surfaces</span>
<a name="ln-8764"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8765"></a>
<a name="ln-8766"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8767"></a>          <span class="c">! Calculates factors that account for shading of sky diffuse</span>
<a name="ln-8768"></a>          <span class="c">! solar radiation by shadowing surfaces such as overhangs and detached</span>
<a name="ln-8769"></a>          <span class="c">! shades.</span>
<a name="ln-8770"></a>          <span class="c">! Called by PerformSolarCalculations</span>
<a name="ln-8771"></a>          <span class="c">!</span>
<a name="ln-8772"></a>          <span class="c">! For each exterior heat transfer surface calculates the following</span>
<a name="ln-8773"></a>          <span class="c">! ratio (called DifShdgRatioIsoSky in this subroutine):</span>
<a name="ln-8774"></a>          <span class="c">!</span>
<a name="ln-8775"></a>          <span class="c">!  R1 = (Diffuse solar from sky dome on surface, with shading)/</span>
<a name="ln-8776"></a>          <span class="c">!       (Diffuse solar from sky dome on surface, without shading)</span>
<a name="ln-8777"></a>          <span class="c">!</span>
<a name="ln-8778"></a>          <span class="c">! To calculate the incident diffuse radiation on a surface the sky</span>
<a name="ln-8779"></a>          <span class="c">! hemisphere is divided into source elements (&quot;patches&quot;). Each patch</span>
<a name="ln-8780"></a>          <span class="c">! is assumed to have the same radiance, i.e. the sky radiance is isotropic.</span>
<a name="ln-8781"></a>          <span class="c">! The irradiance from each patch on a surface is calculated. Then these</span>
<a name="ln-8782"></a>          <span class="c">! irradiances are summed to get the net irradiance on a surface, which</span>
<a name="ln-8783"></a>          <span class="c">! the denominator of R1.</span>
<a name="ln-8784"></a>          <span class="c">!</span>
<a name="ln-8785"></a>          <span class="c">! To get the numerator of R1 the same summation is done, but for each surface</span>
<a name="ln-8786"></a>          <span class="c">! and each patch the Shadow subroutine is called to determine how much</span>
<a name="ln-8787"></a>          <span class="c">! radiation from a patch is blocked by shading surfaces.</span>
<a name="ln-8788"></a>          <span class="c">!</span>
<a name="ln-8789"></a>          <span class="c">! Also calculated is the following ratio (called DifShdgRatioHoriz in this routine):</span>
<a name="ln-8790"></a>          <span class="c">!</span>
<a name="ln-8791"></a>          <span class="c">!  R2 = (Diffuse solar from sky horizon band on surface, with shading)/</span>
<a name="ln-8792"></a>          <span class="c">!       (Diffuse solar from sky horizon band on surface, without shading)</span>
<a name="ln-8793"></a>          <span class="c">!</span>
<a name="ln-8794"></a>          <span class="c">! For this ratio only a band of sky just above the horizon is considered.</span>
<a name="ln-8795"></a>          <span class="c">!</span>
<a name="ln-8796"></a>          <span class="c">! R1 and R2 are used in SUBROUTINE AnisoSkyViewFactors, which determines the</span>
<a name="ln-8797"></a>          <span class="c">! sky diffuse solar irradiance on each exterior heat transfer surface each</span>
<a name="ln-8798"></a>          <span class="c">! time step. In that routine the sky radiance distribution is a superposition</span>
<a name="ln-8799"></a>          <span class="c">! of an isotropic distribution,</span>
<a name="ln-8800"></a>          <span class="c">! a horizon brightening distribution and a circumsolar brightening distribution,</span>
<a name="ln-8801"></a>          <span class="c">! where the proportion of each distribution depends</span>
<a name="ln-8802"></a>          <span class="c">! on cloud cover, sun position and other factors. R1 multiplies the irradiance</span>
<a name="ln-8803"></a>          <span class="c">! due to the isotropic component and R2 multiplies the irradiance due to the</span>
<a name="ln-8804"></a>          <span class="c">! horizon brightening component.</span>
<a name="ln-8805"></a>          <span class="c">!</span>
<a name="ln-8806"></a>          <span class="c">! Calculates sky and ground IR view factors assuming sky IR is isotropic and</span>
<a name="ln-8807"></a>          <span class="c">! shadowing surfaces are opaque to IR.</span>
<a name="ln-8808"></a>          <span class="c">!</span>
<a name="ln-8809"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8810"></a>          <span class="c">! na</span>
<a name="ln-8811"></a>
<a name="ln-8812"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8813"></a>  <span class="k">USE </span><span class="n">DataSystemVariables</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">DetailedSkyDiffuseAlgorithm</span>
<a name="ln-8814"></a>
<a name="ln-8815"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8816"></a>
<a name="ln-8817"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8818"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">NPhi</span> <span class="o">=</span> <span class="mi">6</span>          <span class="c">! Number of altitude angle steps for sky integration</span>
<a name="ln-8819"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">PARAMETER</span>  <span class="kd">::</span> <span class="n">NTheta</span> <span class="o">=</span> <span class="mi">24</span>       <span class="c">! Number of azimuth angle steps for sky integration</span>
<a name="ln-8820"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">PARAMETER</span>     <span class="kd">::</span> <span class="n">Eps</span> <span class="o">=</span> <span class="mf">1.d-10</span>       <span class="c">! Small number</span>
<a name="ln-8821"></a>
<a name="ln-8822"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8823"></a>          <span class="c">! na</span>
<a name="ln-8824"></a>
<a name="ln-8825"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8826"></a>          <span class="c">! na</span>
<a name="ln-8827"></a>
<a name="ln-8828"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8829"></a>
<a name="ln-8830"></a><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface counter</span>
<a name="ln-8831"></a><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">IPhi</span>              <span class="c">! Altitude step counter</span>
<a name="ln-8832"></a><span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">ITheta</span>            <span class="c">! Azimuth step counter</span>
<a name="ln-8833"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DPhi</span>              <span class="c">! Altitude step size</span>
<a name="ln-8834"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DTheta</span>            <span class="c">! Azimuth step size</span>
<a name="ln-8835"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">DThetaDPhi</span>        <span class="c">! Product of DTheta and DPhi</span>
<a name="ln-8836"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">PhiMin</span>            <span class="c">! Minimum altitude</span>
<a name="ln-8837"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Phi</span>               <span class="c">! Altitude angle</span>
<a name="ln-8838"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Theta</span>             <span class="c">! Azimuth angle</span>
<a name="ln-8839"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CosPhi</span>            <span class="c">! Cosine of Phi</span>
<a name="ln-8840"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Fac1WoShdg</span>        <span class="c">! Intermediate calculation factor, without shading</span>
<a name="ln-8841"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FracIlluminated</span>   <span class="c">! Fraction of surface area illuminated by a sky patch</span>
<a name="ln-8842"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Fac1WithShdg</span>      <span class="c">! Intermediate calculation factor, with shading</span>
<a name="ln-8843"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SurfArea</span>          <span class="c">! Surface area (m2)</span>
<a name="ln-8844"></a><span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">ShadowingSurf</span>     <span class="c">! True if surface is a shadowing surface</span>
<a name="ln-8845"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:) :: WithShdgIsoSky     ! Diffuse solar irradiance from isotropic</span>
<a name="ln-8846"></a><span class="c">!                                                          ! sky on surface, with shading</span>
<a name="ln-8847"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:) :: WoShdgIsoSky       ! Diffuse solar from isotropic</span>
<a name="ln-8848"></a><span class="c">!                                                           ! sky on surface, without shading</span>
<a name="ln-8849"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:) :: WithShdgHoriz      ! Diffuse solar irradiance from horizon portion of</span>
<a name="ln-8850"></a><span class="c">!                                                           ! sky on surface, with shading</span>
<a name="ln-8851"></a><span class="c">!REAL(r64), ALLOCATABLE, DIMENSION(:) :: WoShdgHoriz        ! Diffuse solar irradiance from horizon portion of</span>
<a name="ln-8852"></a><span class="c">!                                                           ! sky on surface, without shading</span>
<a name="ln-8853"></a><span class="c">!INTEGER iHour,iTS</span>
<a name="ln-8854"></a>
<a name="ln-8855"></a>          <span class="c">! FLOW:</span>
<a name="ln-8856"></a>
<a name="ln-8857"></a><span class="c">! Initialize Surfaces Arrays</span>
<a name="ln-8858"></a>  <span class="n">SAREA</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8859"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8860"></a>  <span class="n">WithShdgIsoSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8861"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8862"></a>  <span class="n">WoShdgIsoSky</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8863"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8864"></a>  <span class="n">WithShdgHoriz</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8865"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8866"></a>  <span class="n">WoShdgHoriz</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8867"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8868"></a>  <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DifShdgRatioHoriz</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8869"></a>  <span class="c">! initialized as no shading</span>
<a name="ln-8870"></a>  <span class="n">DifShdgRatioIsoSky</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8871"></a>  <span class="n">DifShdgRatioHoriz</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8872"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-8873"></a>      <span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8874"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">curDifShdgRatioIsoSky</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-8875"></a>    <span class="n">curDifShdgRatioIsoSky</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8876"></a>  <span class="n">ENDIF</span>
<a name="ln-8877"></a>
<a name="ln-8878"></a>  <span class="c">! only for detailed.</span>
<a name="ln-8879"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-8880"></a>      <span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8881"></a><span class="k">    ALLOCATE</span> <span class="p">(</span><span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-8882"></a>    <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8883"></a>    <span class="k">ALLOCATE</span> <span class="p">(</span><span class="n">DifShdgRatioHorizHRTS</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="n">NumOfTimeStepInHour</span><span class="p">))</span>
<a name="ln-8884"></a>    <span class="n">DifShdgRatioHorizHRTS</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8885"></a>  <span class="n">ENDIF</span>
<a name="ln-8886"></a>
<a name="ln-8887"></a>  <span class="k">do </span><span class="n">surfnum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">totsurfaces</span>
<a name="ln-8888"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">ExtSolar</span><span class="p">)</span> <span class="k">cycle</span>
<a name="ln-8889"></a>
<a name="ln-8890"></a>  <span class="c">! CurrentModuleObject=&#39;Surfaces&#39;</span>
<a name="ln-8891"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-8892"></a>      <span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8893"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Debug Surface Solar Shading Model DifShdgRatioIsoSky []&#39;</span><span class="p">,</span><span class="n">curDifShdgRatioIsoSky</span><span class="p">(</span><span class="n">Surfnum</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8894"></a>                                                        <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8895"></a>  <span class="k">ELSE</span>
<a name="ln-8896"></a><span class="k">    CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Debug Surface Solar Shading Model DifShdgRatioIsoSky []&#39;</span><span class="p">,</span><span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">Surfnum</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8897"></a>                                                        <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8898"></a>  <span class="n">ENDIF</span>
<a name="ln-8899"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Debug Surface Solar Shading Model DifShdgRatioHoriz []&#39;</span><span class="p">,</span><span class="n">DifShdgRatioHoriz</span><span class="p">(</span><span class="n">Surfnum</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8900"></a>                                                      <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8901"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Debug Surface Solar Shading Model WithShdgIsoSky []&#39;</span><span class="p">,</span><span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">surfnum</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8902"></a>                                                      <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8903"></a>  <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Debug Surface Solar Shading Model WoShdgIsoSky []&#39;</span><span class="p">,</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">surfnum</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-8904"></a>                                                      <span class="s1">&#39;Zone&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Surface</span><span class="p">(</span><span class="n">surfnum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-8905"></a>  <span class="n">enddo</span>
<a name="ln-8906"></a>
<a name="ln-8907"></a>  <span class="n">DPhi</span> <span class="o">=</span> <span class="n">PiOvr2</span><span class="o">/</span><span class="n">NPhi</span>              <span class="c">! 15 deg for NPhi = 6</span>
<a name="ln-8908"></a>  <span class="n">DTheta</span> <span class="o">=</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Pi</span><span class="o">/</span><span class="n">NTheta</span>           <span class="c">! 15 deg for NTheta = 24</span>
<a name="ln-8909"></a>  <span class="n">DThetaDPhi</span> <span class="o">=</span> <span class="n">DTheta</span><span class="o">*</span><span class="n">DPhi</span>
<a name="ln-8910"></a>  <span class="n">PhiMin</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">DPhi</span>               <span class="c">! 7.5 deg for DPhi = 15 deg</span>
<a name="ln-8911"></a>
<a name="ln-8912"></a>  <span class="k">DO </span><span class="n">IPhi</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NPhi</span>                <span class="c">! Loop over patch altitude values</span>
<a name="ln-8913"></a>    <span class="n">Phi</span> <span class="o">=</span> <span class="n">PhiMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">IPhi</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">DPhi</span>  <span class="c">! 7.5,22.5,37.5,52.5,67.5,82.5 for NPhi = 6</span>
<a name="ln-8914"></a>    <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">SIN</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-8915"></a>    <span class="n">CosPhi</span> <span class="o">=</span> <span class="nb">COS</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
<a name="ln-8916"></a>
<a name="ln-8917"></a>    <span class="k">DO </span><span class="n">ITheta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NTheta</span>          <span class="c">! Loop over patch azimuth values</span>
<a name="ln-8918"></a>      <span class="n">Theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">ITheta</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">DTheta</span>   <span class="c">! 0,15,30,....,330,345 for NTheta = 24</span>
<a name="ln-8919"></a>      <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosPhi</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-8920"></a>      <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">CosPhi</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">Theta</span><span class="p">)</span>
<a name="ln-8921"></a>
<a name="ln-8922"></a>      <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>  <span class="c">! Cosine of angle of incidence on surface of solar</span>
<a name="ln-8923"></a>                                  <span class="c">! radiation from patch</span>
<a name="ln-8924"></a>        <span class="n">ShadowingSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span>
<a name="ln-8925"></a>
<a name="ln-8926"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8927"></a>
<a name="ln-8928"></a><span class="k">        </span><span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-8929"></a>                        <span class="o">+</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-8930"></a>                        <span class="o">+</span> <span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-8931"></a>      <span class="k">END DO</span>
<a name="ln-8932"></a>
<a name="ln-8933"></a><span class="k">      CALL </span><span class="n">SHADOW</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-8934"></a>
<a name="ln-8935"></a>      <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-8936"></a>        <span class="n">ShadowingSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span>
<a name="ln-8937"></a>
<a name="ln-8938"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8939"></a>           <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8940"></a>           <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8941"></a>           <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span> <span class="p">)))</span> <span class="k">CYCLE</span>
<a name="ln-8942"></a>
<a name="ln-8943"></a><span class="k">        IF</span><span class="p">(</span><span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-8944"></a>
<a name="ln-8945"></a><span class="k">        </span><span class="n">Fac1WoShdg</span> <span class="o">=</span> <span class="n">CosPhi</span> <span class="o">*</span> <span class="n">DThetaDPhi</span> <span class="o">*</span> <span class="n">CTHETA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-8946"></a>        <span class="n">SurfArea</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">NetAreaShadowCalc</span>
<a name="ln-8947"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SurfArea</span> <span class="o">&gt;</span> <span class="n">Eps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8948"></a><span class="k">          </span><span class="n">FracIlluminated</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="n">SurfArea</span>
<a name="ln-8949"></a>        <span class="k">ELSE</span>
<a name="ln-8950"></a><span class="k">          </span><span class="n">FracIlluminated</span> <span class="o">=</span> <span class="n">SAREA</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SurfArea</span><span class="o">+</span><span class="n">Eps</span><span class="p">)</span>
<a name="ln-8951"></a>        <span class="n">ENDIF</span>
<a name="ln-8952"></a>        <span class="n">Fac1WithShdg</span> <span class="o">=</span> <span class="n">Fac1WoShdg</span> <span class="o">*</span> <span class="n">FracIlluminated</span>
<a name="ln-8953"></a>        <span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fac1WithShdg</span>
<a name="ln-8954"></a>        <span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fac1WoShdg</span>
<a name="ln-8955"></a>
<a name="ln-8956"></a>        <span class="c">! Horizon region</span>
<a name="ln-8957"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">IPhi</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8958"></a><span class="k">          </span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fac1WithShdg</span>
<a name="ln-8959"></a>          <span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">+</span> <span class="n">Fac1WoShdg</span>
<a name="ln-8960"></a>        <span class="k">END IF</span>
<a name="ln-8961"></a><span class="k">      END DO</span>  <span class="c">! End of surface loop</span>
<a name="ln-8962"></a>    <span class="k">END DO</span>    <span class="c">! End of Theta loop</span>
<a name="ln-8963"></a>  <span class="k">END DO</span>      <span class="c">! End of Phi loop</span>
<a name="ln-8964"></a>
<a name="ln-8965"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-8966"></a>    <span class="n">ShadowingSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadowingSurf</span>
<a name="ln-8967"></a>
<a name="ln-8968"></a>    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">ShadowingSurf</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>                                                     <span class="p">&amp;</span>
<a name="ln-8969"></a>      <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtSolar</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8970"></a>      <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8971"></a>         <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-8972"></a>
<a name="ln-8973"></a><span class="k">    IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">Eps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8974"></a><span class="k">      </span><span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-8975"></a>    <span class="k">ELSE</span>
<a name="ln-8976"></a><span class="k">      </span><span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">WithShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">+</span><span class="n">Eps</span><span class="p">)</span>
<a name="ln-8977"></a>    <span class="n">ENDIF</span>
<a name="ln-8978"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">Eps</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8979"></a><span class="k">      </span><span class="n">DifShdgRatioHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-8980"></a>    <span class="k">ELSE</span>
<a name="ln-8981"></a><span class="k">      </span><span class="n">DifShdgRatioHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span> <span class="o">=</span>  <span class="p">(</span><span class="n">WithShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">WoShdgHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">+</span><span class="n">Eps</span><span class="p">)</span>
<a name="ln-8982"></a>    <span class="n">ENDIF</span>
<a name="ln-8983"></a>  <span class="k">END DO</span>
<a name="ln-8984"></a>
<a name="ln-8985"></a>  <span class="c">! Get IR view factors. An exterior surface can receive IR radiation from</span>
<a name="ln-8986"></a>  <span class="c">! sky, ground or shadowing surfaces. Assume shadowing surfaces have same</span>
<a name="ln-8987"></a>  <span class="c">! temperature as outside air (and therefore same temperature as ground),</span>
<a name="ln-8988"></a>  <span class="c">! so that the view factor to these shadowing surfaces can be included in</span>
<a name="ln-8989"></a>  <span class="c">! the ground view factor. Sky IR is assumed to be isotropic and shadowing</span>
<a name="ln-8990"></a>  <span class="c">! surfaces are assumed to be opaque to IR so they totally &quot;shade&quot; IR from</span>
<a name="ln-8991"></a>  <span class="c">! sky or ground.</span>
<a name="ln-8992"></a>
<a name="ln-8993"></a>  <span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-8994"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-8995"></a>        <span class="n">SolarDistribution</span> <span class="o">==</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8996"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">*</span> <span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-8997"></a>    <span class="k">ELSE</span>
<a name="ln-8998"></a><span class="k">      </span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span> <span class="o">*</span> <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-8999"></a>    <span class="n">ENDIF</span>
<a name="ln-9000"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorGroundIR</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ViewFactorSkyIR</span>
<a name="ln-9001"></a>  <span class="k">END DO</span>
<a name="ln-9002"></a>
<a name="ln-9003"></a>
<a name="ln-9004"></a>
<a name="ln-9005"></a><span class="c">!  DEALLOCATE (WithShdgIsoSky)</span>
<a name="ln-9006"></a><span class="c">!  DEALLOCATE (WoShdgIsoSky)</span>
<a name="ln-9007"></a><span class="c">!  DEALLOCATE (WithShdgHoriz)</span>
<a name="ln-9008"></a><span class="c">!  DEALLOCATE (WoShdgHoriz)</span>
<a name="ln-9009"></a>
<a name="ln-9010"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">DetailedSkyDiffuseAlgorithm</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">ShadingTransmittanceVaries</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-9011"></a>      <span class="n">SolarDistribution</span> <span class="o">/=</span> <span class="n">MinimalShadowing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9012"></a><span class="k">    DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9013"></a>      <span class="n">DifShdgRatioIsoSkyHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfTimeStepInHour</span><span class="p">)</span><span class="o">=</span><span class="n">DifShdgRatioIsoSky</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-9014"></a>      <span class="n">DifShdgRatioHorizHRTS</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">24</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NumOfTimeStepInHour</span><span class="p">)</span><span class="o">=</span><span class="n">DifShdgRatioHoriz</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span>
<a name="ln-9015"></a>    <span class="n">ENDDO</span>
<a name="ln-9016"></a>  <span class="n">ENDIF</span>
<a name="ln-9017"></a>
<a name="ln-9018"></a>  <span class="k">RETURN</span>
<a name="ln-9019"></a>
<a name="ln-9020"></a><span class="k">END SUBROUTINE </span><span class="n">SkyDifSolarShading</span>
<a name="ln-9021"></a>
<a name="ln-9022"></a><span class="k">SUBROUTINE </span><span class="n">CalcWindowProfileAngles</span>
<a name="ln-9023"></a>
<a name="ln-9024"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9025"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9026"></a>          <span class="c">!       DATE WRITTEN   April 2002</span>
<a name="ln-9027"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9028"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9029"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9030"></a>          <span class="c">! Called by CalcPerSolarBeam for wholly or partially sunlit exterior windows</span>
<a name="ln-9031"></a>          <span class="c">! Calculates horizontal and vertical beam solar profile angles</span>
<a name="ln-9032"></a>
<a name="ln-9033"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9034"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-9035"></a>
<a name="ln-9036"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9037"></a>
<a name="ln-9038"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-9039"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-9040"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-9041"></a>
<a name="ln-9042"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9043"></a>
<a name="ln-9044"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-9045"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ElevSun</span>           <span class="c">! Sun elevation; angle between sun and horizontal</span>
<a name="ln-9046"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ElevWin</span>           <span class="c">! Window elevation: angle between window outward normal and horizontal</span>
<a name="ln-9047"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AzimWin</span>           <span class="c">! Window azimuth (radians)</span>
<a name="ln-9048"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AzimSun</span>           <span class="c">! Sun azimuth (radians)</span>
<a name="ln-9049"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ProfileAngHor</span>     <span class="c">! Solar profile angle (radians) for horizontally oriented window elements</span>
<a name="ln-9050"></a>                                        <span class="c">! such as the top and bottom of a frame.</span>
<a name="ln-9051"></a>                                        <span class="c">! This is the incidence angle in a plane that is normal to the window</span>
<a name="ln-9052"></a>                                        <span class="c">! and parallel to the Y-axis of the window (the axis along</span>
<a name="ln-9053"></a>                                        <span class="c">! which the height of the window is measured).</span>
<a name="ln-9054"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ProfileAngVert</span>    <span class="c">! Solar profile angle (radians) for vertically oriented elements</span>
<a name="ln-9055"></a>                                        <span class="c">! such as the sides of a frame.</span>
<a name="ln-9056"></a>                                        <span class="c">! This is the incidence angle in a plane that is normal to the window</span>
<a name="ln-9057"></a>                                        <span class="c">! and parallel to the X-axis of the window (the axis along</span>
<a name="ln-9058"></a>                                        <span class="c">! which the width of the window is measured).</span>
<a name="ln-9059"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">WinNorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! Unit vector normal to window</span>
<a name="ln-9060"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! Cross product of WinNorm and vector along window baseline</span>
<a name="ln-9061"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">SunPrime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Projection of sun vector onto plane (perpendicular to</span>
<a name="ln-9062"></a>                                        <span class="c">!  window plane) determined by WinNorm and vector along</span>
<a name="ln-9063"></a>                                        <span class="c">!  baseline of window</span>
<a name="ln-9064"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ThWin</span>             <span class="c">! Azimuth angle of WinNorm (radians)</span>
<a name="ln-9065"></a><span class="kt">real</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dot1</span><span class="p">,</span><span class="n">dot2</span><span class="p">,</span><span class="n">dot3</span>
<a name="ln-9066"></a>
<a name="ln-9067"></a><span class="n">ElevSun</span> <span class="o">=</span> <span class="n">Piovr2</span> <span class="o">-</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-9068"></a><span class="n">AzimSun</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-9069"></a>
<a name="ln-9070"></a><span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9071"></a>
<a name="ln-9072"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9073"></a>    <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9074"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-9075"></a>
<a name="ln-9076"></a><span class="k">  </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ProfileAngHor</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9077"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ProfileAngVert</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9078"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9079"></a>
<a name="ln-9080"></a><span class="k">  </span><span class="n">ElevWin</span> <span class="o">=</span> <span class="n">Piovr2</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9081"></a>  <span class="n">AzimWin</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9082"></a>
<a name="ln-9083"></a>  <span class="n">ProfileAngHor</span> <span class="o">=</span> <span class="nb">ATAN</span><span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ElevSun</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">COS</span><span class="p">(</span><span class="n">ElevSun</span><span class="p">)</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">AzimWin</span><span class="o">-</span><span class="n">AzimSun</span><span class="p">)))</span> <span class="o">-</span> <span class="n">ElevWin</span>
<a name="ln-9084"></a>
<a name="ln-9085"></a><span class="c">!CR9280 - were having negative profile angles on west sides.  commenting out previous code (original code) for</span>
<a name="ln-9086"></a><span class="c">! vertical windows</span>
<a name="ln-9087"></a><span class="c">!  IF(ABS(ElevWin) &lt; 0.1d0) THEN  ! Near-vertical window</span>
<a name="ln-9088"></a><span class="c">!    ProfileAngVert = ABS(AzimWin-AzimSun)</span>
<a name="ln-9089"></a><span class="c">!  ELSE</span>
<a name="ln-9090"></a>    <span class="n">WinNorm</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-9091"></a>    <span class="n">ThWin</span> <span class="o">=</span> <span class="n">AzimWin</span> <span class="o">-</span> <span class="n">PiOvr2</span>
<a name="ln-9092"></a>    <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">ThWin</span><span class="p">)</span>
<a name="ln-9093"></a>    <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">SIN</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ThWin</span><span class="p">)</span>
<a name="ln-9094"></a>    <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">COS</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span>
<a name="ln-9095"></a>    <span class="n">SunPrime</span> <span class="o">=</span> <span class="n">SOLCOS</span> <span class="o">-</span> <span class="n">WinNormCrossBase</span><span class="o">*</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SOLCOS</span><span class="p">,</span><span class="n">WinNormCrossBase</span><span class="p">)</span>
<a name="ln-9096"></a>    <span class="n">dot1</span><span class="o">=</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WinNorm</span><span class="p">,</span><span class="n">SunPrime</span><span class="p">)</span>
<a name="ln-9097"></a>    <span class="n">dot2</span><span class="o">=</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SunPrime</span><span class="p">,</span><span class="n">SunPrime</span><span class="p">))</span>
<a name="ln-9098"></a>    <span class="n">dot3</span><span class="o">=</span><span class="n">dot1</span><span class="o">/</span><span class="n">dot2</span>
<a name="ln-9099"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">dot3</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9100"></a><span class="k">      </span><span class="n">dot3</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-9101"></a>    <span class="n">elseif</span> <span class="p">(</span><span class="n">dot3</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9102"></a><span class="k">      </span><span class="n">dot3</span><span class="o">=-</span><span class="mf">1.0d0</span>
<a name="ln-9103"></a>    <span class="n">endif</span>
<a name="ln-9104"></a><span class="c">!    ProfileAngVert = ABS(ACOS(DOT_PRODUCT(WinNorm,SunPrime)/SQRT(DOT_PRODUCT(SunPrime,SunPrime))))</span>
<a name="ln-9105"></a>    <span class="n">ProfileAngVert</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">ACOS</span><span class="p">(</span><span class="n">dot3</span><span class="p">))</span>
<a name="ln-9106"></a><span class="c">!  END IF</span>
<a name="ln-9107"></a>  <span class="c">! Constrain to 0 to pi</span>
<a name="ln-9108"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ProfileAngVert</span> <span class="o">&gt;</span> <span class="n">Pi</span><span class="p">)</span> <span class="n">ProfileAngVert</span> <span class="o">=</span> <span class="mf">2.d0</span><span class="o">*</span><span class="n">Pi</span> <span class="o">-</span> <span class="n">ProfileAngVert</span>
<a name="ln-9109"></a>
<a name="ln-9110"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ProfileAngHor</span>     <span class="o">=</span> <span class="n">ProfileAngHor</span><span class="o">/</span><span class="n">DegToRadians</span>
<a name="ln-9111"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ProfileAngVert</span>    <span class="o">=</span> <span class="n">ProfileAngVert</span><span class="o">/</span><span class="n">DegToRadians</span>
<a name="ln-9112"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TanProfileAngHor</span>  <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">TAN</span><span class="p">(</span><span class="n">ProfileAngHor</span><span class="p">))</span>
<a name="ln-9113"></a>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TanProfileAngVert</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">TAN</span><span class="p">(</span><span class="n">ProfileAngVert</span><span class="p">))</span>
<a name="ln-9114"></a>
<a name="ln-9115"></a><span class="k">END DO</span>
<a name="ln-9116"></a>
<a name="ln-9117"></a><span class="k">RETURN</span>
<a name="ln-9118"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWindowProfileAngles</span>
<a name="ln-9119"></a>
<a name="ln-9120"></a><span class="k">SUBROUTINE </span><span class="n">CalcFrameDividerShadow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">FrDivNum</span><span class="p">,</span><span class="n">HourNum</span><span class="p">)</span>
<a name="ln-9121"></a>
<a name="ln-9122"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9123"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-9124"></a>          <span class="c">!       DATE WRITTEN   June 2000</span>
<a name="ln-9125"></a>          <span class="c">!       MODIFIED       Aug 2000, FW: add effective shadowing by inside</span>
<a name="ln-9126"></a>          <span class="c">!                      projections</span>
<a name="ln-9127"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9128"></a>
<a name="ln-9129"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9130"></a>          <span class="c">! Called by CalcPerSolarBeam for wholly or partially sunlit exterior windows</span>
<a name="ln-9131"></a>          <span class="c">! with a frame and/or divider. Using beam solar profile angles,</span>
<a name="ln-9132"></a>          <span class="c">! calculates fraction of glass shaded by exterior frame and divider projections,</span>
<a name="ln-9133"></a>          <span class="c">! The frame and divider profiles are assumed to be rectangular.</span>
<a name="ln-9134"></a>          <span class="c">!</span>
<a name="ln-9135"></a>          <span class="c">! A similar shadowing approach is used to calculate the fraction of glass area</span>
<a name="ln-9136"></a>          <span class="c">! that produces beam solar illumination on interior frame and divider projections.</span>
<a name="ln-9137"></a>          <span class="c">! This fraction is used in CalcWinFrameAndDividerTemps to determine the</span>
<a name="ln-9138"></a>          <span class="c">! beam solar absorbed by inside projections. Beam solar reflected by inside projections</span>
<a name="ln-9139"></a>          <span class="c">! is assumed to stay in the zone (as beam solar) although in actuality roughly</span>
<a name="ln-9140"></a>          <span class="c">! half of this is reflected back onto the glass and the half that is reflected</span>
<a name="ln-9141"></a>          <span class="c">! into the zone is diffuse.</span>
<a name="ln-9142"></a>          <span class="c">!</span>
<a name="ln-9143"></a>          <span class="c">! For multipane glazing the effect of solar absorbed by the exposed portion of</span>
<a name="ln-9144"></a>          <span class="c">! frame or divider between the panes is not calculated. Beam solar incident on</span>
<a name="ln-9145"></a>          <span class="c">! these portions is assumed to be transmitted into the zone unchanged.</span>
<a name="ln-9146"></a>          <span class="c">!</span>
<a name="ln-9147"></a>          <span class="c">! The shadowing of diffuse solar radiation by projections is not considered.</span>
<a name="ln-9148"></a>          <span class="c">!</span>
<a name="ln-9149"></a>
<a name="ln-9150"></a>          <span class="c">! REFERENCES: na</span>
<a name="ln-9151"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-9152"></a>
<a name="ln-9153"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9154"></a>
<a name="ln-9155"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9156"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-9157"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FrDivNum</span>          <span class="c">! Frame/divider number</span>
<a name="ln-9158"></a><span class="kt">INTEGER</span><span class="p">,</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HourNum</span>           <span class="c">! Hour number</span>
<a name="ln-9159"></a>
<a name="ln-9160"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-9161"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-9162"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-9163"></a>
<a name="ln-9164"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9165"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ElevSun</span>           <span class="c">! Sun elevation; angle between sun and horizontal</span>
<a name="ln-9166"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ElevWin</span>           <span class="c">! Window elevation: angle between window outward normal and horizontal</span>
<a name="ln-9167"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AzimWin</span>           <span class="c">! Window azimuth (radians)</span>
<a name="ln-9168"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">AzimSun</span>           <span class="c">! Sun azimuth (radians)</span>
<a name="ln-9169"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ProfileAngHor</span>     <span class="c">! Solar profile angle (radians) for horizontally oriented projections</span>
<a name="ln-9170"></a>                                        <span class="c">! such as the top and bottom of a frame or horizontal dividers.</span>
<a name="ln-9171"></a>                                        <span class="c">! This is the incidence angle in a plane that is normal to the window</span>
<a name="ln-9172"></a>                                        <span class="c">! and parallel to the Y-axis of the window (the axis along</span>
<a name="ln-9173"></a>                                        <span class="c">! which the height of the window is measured).</span>
<a name="ln-9174"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ProfileAngVert</span>    <span class="c">! Solar profile angle (radians) for vertically oriented projections</span>
<a name="ln-9175"></a>                                        <span class="c">! such as the top and bottom of a frame or horizontal dividers.</span>
<a name="ln-9176"></a>                                        <span class="c">! This is the incidence angle in a plane that is normal to the window</span>
<a name="ln-9177"></a>                                        <span class="c">! and parallel to the X-axis of the window (the axis along</span>
<a name="ln-9178"></a>                                        <span class="c">! which the width of the window is measured).</span>
<a name="ln-9179"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TanProfileAngHor</span>  <span class="c">! Tangent of ProfileAngHor</span>
<a name="ln-9180"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">TanProfileAngVert</span> <span class="c">! Tangent of ProfileAngVert</span>
<a name="ln-9181"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FrWidth</span>           <span class="c">! Frame width (m)</span>
<a name="ln-9182"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">DivWidth</span>          <span class="c">! Divider width (m)</span>
<a name="ln-9183"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FrProjOut</span>         <span class="c">! Outside frame projection (m)</span>
<a name="ln-9184"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">DivProjOut</span>        <span class="c">! Outside divider projection (m)</span>
<a name="ln-9185"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FrProjIn</span>          <span class="c">! Inside frame projection (m)</span>
<a name="ln-9186"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">DivProjIn</span>         <span class="c">! Inside divider projection (m)</span>
<a name="ln-9187"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NHorDiv</span>           <span class="c">! Number of horizontal dividers</span>
<a name="ln-9188"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">NVertDiv</span>          <span class="c">! Number of vertical dividers</span>
<a name="ln-9189"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">GlArea</span>            <span class="c">! Glazed area (m2)</span>
<a name="ln-9190"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">Arealite</span>          <span class="c">! Area of a single lite of glass (m2); glazed area, GlArea,</span>
<a name="ln-9191"></a>                                        <span class="c">! if there is no divider (in which case there is only one lite).</span>
<a name="ln-9192"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ArealiteCol</span>       <span class="c">! Area of a vertical column of lites (m2)</span>
<a name="ln-9193"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ArealiteRow</span>       <span class="c">! Area of a horizontal row of lites (m2)</span>
<a name="ln-9194"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshVDout</span>          <span class="c">! Shaded area from all vertical divider outside projections (m2)</span>
<a name="ln-9195"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshVDin</span>           <span class="c">! Shaded area from all vertical divider inside projections (m2)</span>
<a name="ln-9196"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshHDout</span>          <span class="c">! Shaded area from all horizontal divider outside projections (m2)</span>
<a name="ln-9197"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshHDin</span>           <span class="c">! Shaded area from all horizontal divider inside projections (m2)</span>
<a name="ln-9198"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshVFout</span>          <span class="c">! Shaded area from outside projection of vertical sides of frame (m2)</span>
<a name="ln-9199"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshVFin</span>           <span class="c">! Shaded area from inside projection of vertical sides of frame (m2)</span>
<a name="ln-9200"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshHFout</span>          <span class="c">! Shaded area from outside projection of horizontal sides</span>
<a name="ln-9201"></a>                                        <span class="c">!   (top) of frame (m2)</span>
<a name="ln-9202"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshHFin</span>           <span class="c">! Shaded area from inside projection of horizontal sides</span>
<a name="ln-9203"></a>                                        <span class="c">!   (top) of frame (m2)</span>
<a name="ln-9204"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshDDover</span>         <span class="c">! Divider/divider shadow overlap area (m2)</span>
<a name="ln-9205"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshFFover</span>         <span class="c">! Frame/frame shadow overlap area (m2)</span>
<a name="ln-9206"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshFVDover</span>        <span class="c">! Frame/vertical divider overlap area (m2)</span>
<a name="ln-9207"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshFHDover</span>        <span class="c">! Frame/horizontal divider overlap area (m2)</span>
<a name="ln-9208"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshFDtotOut</span>       <span class="c">! Total outside projection shadow area (m2)</span>
<a name="ln-9209"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AshFDtotIn</span>        <span class="c">! Total inside projection shadow area (m2)</span>
<a name="ln-9210"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FracShFDOut</span>       <span class="c">! Fraction of glazing shadowed by frame and divider</span>
<a name="ln-9211"></a>                                        <span class="c">!  outside projections</span>
<a name="ln-9212"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FracShFDin</span>        <span class="c">! Fraction of glazing that illuminates frame and divider</span>
<a name="ln-9213"></a>                                        <span class="c">!  inside projections with beam radiation</span>
<a name="ln-9214"></a>
<a name="ln-9215"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">WinNorm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>        <span class="c">! Window outward normal unit vector</span>
<a name="ln-9216"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ThWin</span>             <span class="c">! Azimuth angle of WinNorm</span>
<a name="ln-9217"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SunPrime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>       <span class="c">! Projection of sun vector onto plane (perpendicular to</span>
<a name="ln-9218"></a>                                        <span class="c">!  window plane) determined by WinNorm and vector along</span>
<a name="ln-9219"></a>                                        <span class="c">!  baseline of window</span>
<a name="ln-9220"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c">! Cross product of WinNorm and vector along window baseline</span>
<a name="ln-9221"></a>
<a name="ln-9222"></a><span class="k">IF</span> <span class="p">(</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameProjectionOut</span><span class="o">==</span><span class="mf">0.0d0</span>   <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-9223"></a>    <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameProjectionIn</span><span class="o">==</span><span class="mf">0.0d0</span>    <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-9224"></a>    <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerProjectionOut</span><span class="o">==</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-9225"></a>    <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerProjectionIn</span><span class="o">==</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-9226"></a>
<a name="ln-9227"></a><span class="n">FrProjOut</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameProjectionOut</span>
<a name="ln-9228"></a><span class="n">FrProjIn</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameProjectionIn</span>
<a name="ln-9229"></a><span class="n">DivProjOut</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerProjectionOut</span>
<a name="ln-9230"></a><span class="n">DivProjIn</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerProjectionIn</span>
<a name="ln-9231"></a>
<a name="ln-9232"></a><span class="n">GlArea</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-9233"></a><span class="n">ElevWin</span> <span class="o">=</span> <span class="n">Piovr2</span> <span class="o">-</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Tilt</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9234"></a><span class="n">ElevSun</span> <span class="o">=</span> <span class="n">Piovr2</span> <span class="o">-</span> <span class="nb">ACOS</span><span class="p">(</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-9235"></a><span class="n">AzimWin</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Azimuth</span> <span class="o">*</span> <span class="n">DegToRadians</span>
<a name="ln-9236"></a><span class="n">AzimSun</span> <span class="o">=</span> <span class="n">ATAN2</span><span class="p">(</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">SUNCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-9237"></a>
<a name="ln-9238"></a><span class="n">ProfileAngHor</span> <span class="o">=</span> <span class="nb">ATAN</span><span class="p">(</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ElevSun</span><span class="p">)</span><span class="o">/</span><span class="nb">ABS</span><span class="p">(</span><span class="nb">COS</span><span class="p">(</span><span class="n">ElevSun</span><span class="p">)</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">AzimWin</span><span class="o">-</span><span class="n">AzimSun</span><span class="p">)))</span> <span class="o">-</span> <span class="n">ElevWin</span>
<a name="ln-9239"></a><span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Near-vertical window</span>
<a name="ln-9240"></a>  <span class="n">ProfileAngVert</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">AzimWin</span><span class="o">-</span><span class="n">AzimSun</span><span class="p">)</span>
<a name="ln-9241"></a><span class="k">ELSE</span>
<a name="ln-9242"></a><span class="k">  </span><span class="n">WinNorm</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutNormVec</span>
<a name="ln-9243"></a>  <span class="n">ThWin</span> <span class="o">=</span> <span class="n">AzimWin</span> <span class="o">-</span> <span class="n">PiOvr2</span>
<a name="ln-9244"></a>  <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span><span class="o">*</span><span class="nb">COS</span><span class="p">(</span><span class="n">ThWin</span><span class="p">)</span>
<a name="ln-9245"></a>  <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">SIN</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span><span class="o">*</span><span class="nb">SIN</span><span class="p">(</span><span class="n">ThWin</span><span class="p">)</span>
<a name="ln-9246"></a>  <span class="n">WinNormCrossBase</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span>  <span class="nb">COS</span><span class="p">(</span><span class="n">ElevWin</span><span class="p">)</span>
<a name="ln-9247"></a>  <span class="n">SunPrime</span> <span class="o">=</span> <span class="n">SUNCOS</span> <span class="o">-</span> <span class="n">WinNormCrossBase</span><span class="o">*</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SUNCOS</span><span class="p">,</span><span class="n">WinNormCrossBase</span><span class="p">)</span>
<a name="ln-9248"></a>  <span class="n">ProfileAngVert</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">ACOS</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">WinNorm</span><span class="p">,</span><span class="n">SunPrime</span><span class="p">)</span><span class="o">/</span><span class="nb">SQRT</span><span class="p">(</span><span class="nb">DOT_PRODUCT</span><span class="p">(</span><span class="n">SunPrime</span><span class="p">,</span><span class="n">SunPrime</span><span class="p">))))</span>
<a name="ln-9249"></a><span class="k">END IF</span>
<a name="ln-9250"></a><span class="c">! Constrain to 0 to pi</span>
<a name="ln-9251"></a><span class="k">IF</span><span class="p">(</span><span class="n">ProfileAngVert</span> <span class="o">&gt;</span> <span class="n">Pi</span><span class="p">)</span> <span class="n">ProfileAngVert</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">Pi</span> <span class="o">-</span> <span class="n">ProfileAngVert</span>
<a name="ln-9252"></a><span class="n">TanProfileAngHor</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">TAN</span><span class="p">(</span><span class="n">ProfileAngHor</span><span class="p">))</span>
<a name="ln-9253"></a><span class="n">TanProfileAngVert</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="nb">TAN</span><span class="p">(</span><span class="n">ProfileAngVert</span><span class="p">))</span>
<a name="ln-9254"></a>
<a name="ln-9255"></a><span class="n">NHorDiv</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">HorDividers</span>
<a name="ln-9256"></a><span class="n">NVertDiv</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">VertDividers</span>
<a name="ln-9257"></a><span class="n">FrWidth</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameWidth</span>
<a name="ln-9258"></a><span class="n">DivWidth</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerWidth</span>
<a name="ln-9259"></a>
<a name="ln-9260"></a><span class="n">Arealite</span> <span class="o">=</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">/</span><span class="p">(</span><span class="n">NHorDiv</span> <span class="o">+</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="o">-</span> <span class="n">DivWidth</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9261"></a>           <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">/</span><span class="p">(</span><span class="n">NVertDiv</span> <span class="o">+</span> <span class="mf">1.d0</span><span class="p">)</span> <span class="o">-</span> <span class="n">DivWidth</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span>
<a name="ln-9262"></a><span class="k">IF</span><span class="p">(</span><span class="n">DivProjOut</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DivProjIn</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9263"></a><span class="k">  </span><span class="n">ArealiteCol</span> <span class="o">=</span> <span class="p">(</span><span class="n">NHorDiv</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Arealite</span>
<a name="ln-9264"></a>  <span class="n">ArealiteRow</span> <span class="o">=</span> <span class="p">(</span><span class="n">NVertDiv</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Arealite</span>
<a name="ln-9265"></a><span class="k">ELSE</span>
<a name="ln-9266"></a><span class="k">  </span><span class="n">ArealiteCol</span> <span class="o">=</span> <span class="n">GlArea</span>
<a name="ln-9267"></a>  <span class="n">ArealiteRow</span> <span class="o">=</span> <span class="n">GlArea</span>
<a name="ln-9268"></a><span class="k">END IF</span>
<a name="ln-9269"></a><span class="n">AshVDout</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9270"></a><span class="n">AshVDin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9271"></a><span class="n">AshHDout</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9272"></a><span class="n">AshHDin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9273"></a><span class="n">AshVFout</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9274"></a><span class="n">AshVFin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9275"></a><span class="n">AshHFout</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9276"></a><span class="n">AshHFin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9277"></a><span class="n">AshDDover</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9278"></a><span class="n">AshFFover</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9279"></a><span class="n">AshFVDover</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9280"></a><span class="n">AshFHDover</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9281"></a>
<a name="ln-9282"></a><span class="k">IF</span><span class="p">(</span><span class="n">DivProjOut</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">DivProjIn</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9283"></a>
<a name="ln-9284"></a>  <span class="c">! Shaded area from all vertical dividers</span>
<a name="ln-9285"></a>  <span class="n">AshVDout</span> <span class="o">=</span> <span class="n">NVertDiv</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9286"></a>    <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">-</span><span class="n">NHorDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">DivProjOut</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">ArealiteCol</span><span class="p">)</span>
<a name="ln-9287"></a>  <span class="n">AshVDin</span> <span class="o">=</span> <span class="n">NVertDiv</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9288"></a>    <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">-</span><span class="n">NHorDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">DivProjIn</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">ArealiteCol</span><span class="p">)</span>
<a name="ln-9289"></a>
<a name="ln-9290"></a>  <span class="c">! Shaded area from all horizontal dividers</span>
<a name="ln-9291"></a>  <span class="n">AshHDout</span> <span class="o">=</span> <span class="n">NHorDiv</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9292"></a>    <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">-</span><span class="n">NVertDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">DivProjOut</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="p">,</span><span class="n">ArealiteRow</span><span class="p">)</span>
<a name="ln-9293"></a>  <span class="n">AshHDin</span> <span class="o">=</span> <span class="n">NHorDiv</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9294"></a>    <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">-</span><span class="n">NVertDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">DivProjIn</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="p">,</span><span class="n">ArealiteRow</span><span class="p">)</span>
<a name="ln-9295"></a>
<a name="ln-9296"></a>  <span class="c">! Horizontal divider/vertical divider shadow overlap</span>
<a name="ln-9297"></a>  <span class="n">AshDDover</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">DivProjOut</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="o">*</span><span class="n">DivProjOut</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">Arealite</span><span class="p">)</span><span class="o">*</span><span class="n">NHorDiv</span><span class="o">*</span><span class="n">NVertDiv</span>
<a name="ln-9298"></a>
<a name="ln-9299"></a><span class="k">END IF</span>
<a name="ln-9300"></a>
<a name="ln-9301"></a><span class="k">IF</span><span class="p">(</span><span class="n">FrProjOut</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FrProjIn</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9302"></a>
<a name="ln-9303"></a>  <span class="c">! Shaded area from sides of frame; to avoid complications from possible overlaps between</span>
<a name="ln-9304"></a>  <span class="c">! shadow from side of frame and shadow from vertical divider the shaded area from side of</span>
<a name="ln-9305"></a>  <span class="c">! frame is restricted to the area of one column of lites.</span>
<a name="ln-9306"></a>  <span class="n">AshVFOut</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">-</span><span class="n">NHorDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">FrProjOut</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">ArealiteCol</span><span class="p">)</span>
<a name="ln-9307"></a>  <span class="n">AshVFin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span><span class="o">-</span><span class="n">NHorDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">FrProjIn</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">ArealiteCol</span><span class="p">)</span>
<a name="ln-9308"></a>
<a name="ln-9309"></a>  <span class="c">! Shaded area from top or bottom of frame; to avoid complications from possible overlaps</span>
<a name="ln-9310"></a>  <span class="c">! between shadow from top or bottom of frame and shadow from horizontal divider, the shaded</span>
<a name="ln-9311"></a>  <span class="c">! area from the top or bottom of frame is restricted to the area of one row of lites.</span>
<a name="ln-9312"></a>  <span class="n">AshHFOut</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">-</span><span class="n">NVertDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">FrProjOut</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="p">,</span><span class="n">ArealiteRow</span><span class="p">)</span>
<a name="ln-9313"></a>  <span class="n">AshHFin</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">((</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span><span class="o">-</span><span class="n">NVertDiv</span><span class="o">*</span><span class="n">DivWidth</span><span class="p">)</span><span class="o">*</span><span class="n">FrProjIn</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="p">,</span><span class="n">ArealiteRow</span><span class="p">)</span>
<a name="ln-9314"></a>
<a name="ln-9315"></a>  <span class="c">! Top/bottom of frame/side of frame shadow overlap</span>
<a name="ln-9316"></a>  <span class="n">AshFFover</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">FrProjOut</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="o">*</span><span class="n">FrProjOut</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">Arealite</span><span class="p">)</span>
<a name="ln-9317"></a>
<a name="ln-9318"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">DivProjOut</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9319"></a>    <span class="c">! Frame/vertical divider shadow overlap</span>
<a name="ln-9320"></a>    <span class="n">AshFVDover</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">FrProjOut</span><span class="o">*</span><span class="n">DivProjOut</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">Arealite</span><span class="p">)</span><span class="o">*</span><span class="n">NVertDiv</span>
<a name="ln-9321"></a>
<a name="ln-9322"></a>    <span class="c">! Frame/horizontal divider shadow overlap</span>
<a name="ln-9323"></a>    <span class="n">AshFHDover</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="n">FrProjOut</span><span class="o">*</span><span class="n">DivProjOut</span><span class="o">*</span><span class="n">TanProfileAngHor</span><span class="o">*</span><span class="n">TanProfileAngVert</span><span class="p">,</span><span class="n">Arealite</span><span class="p">)</span><span class="o">*</span><span class="n">NHorDiv</span>
<a name="ln-9324"></a>
<a name="ln-9325"></a>  <span class="k">END IF</span>
<a name="ln-9326"></a>
<a name="ln-9327"></a><span class="k">END IF</span>
<a name="ln-9328"></a>
<a name="ln-9329"></a><span class="n">AshFDtotOut</span> <span class="o">=</span> <span class="n">AshVDout</span> <span class="o">+</span> <span class="n">AshHDout</span> <span class="o">+</span> <span class="n">AshVFout</span> <span class="o">+</span> <span class="n">AshHFout</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9330"></a>              <span class="p">(</span><span class="n">AshDDover</span> <span class="o">+</span> <span class="n">AshFFover</span> <span class="o">+</span> <span class="n">AshFVDover</span> <span class="o">+</span> <span class="n">AshFHDover</span><span class="p">)</span>
<a name="ln-9331"></a><span class="n">AshFDtotIn</span> <span class="o">=</span> <span class="p">(</span><span class="n">AshVDin</span> <span class="o">+</span> <span class="n">AshHDin</span><span class="p">)</span><span class="o">*</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">DividerSolAbsorp</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9332"></a>             <span class="p">(</span><span class="n">AshVFin</span> <span class="o">+</span> <span class="n">AshHFin</span><span class="p">)</span><span class="o">*</span><span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrDivNum</span><span class="p">)%</span><span class="n">FrameSolAbsorp</span>
<a name="ln-9333"></a>
<a name="ln-9334"></a><span class="c">! Divide by the glazed area of the window</span>
<a name="ln-9335"></a><span class="n">FracShFDout</span> <span class="o">=</span> <span class="n">AshFDtotOut</span><span class="o">/</span><span class="n">GlArea</span>
<a name="ln-9336"></a><span class="n">FracShFDin</span> <span class="o">=</span> <span class="n">AshFDtotIn</span><span class="o">/</span><span class="n">GlArea</span>
<a name="ln-9337"></a><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutProjSLFracMult</span><span class="p">(</span><span class="n">HourNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">-</span><span class="n">FracShFDout</span>
<a name="ln-9338"></a><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InOutProjSLFracMult</span><span class="p">(</span><span class="n">HourNum</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span><span class="o">-</span><span class="p">(</span><span class="n">FracShFDin</span> <span class="o">+</span> <span class="n">FracShFDout</span><span class="p">)</span>
<a name="ln-9339"></a>
<a name="ln-9340"></a><span class="k">RETURN</span>
<a name="ln-9341"></a><span class="k">END SUBROUTINE </span><span class="n">CalcFrameDividerShadow</span>
<a name="ln-9342"></a>
<a name="ln-9343"></a><span class="k">SUBROUTINE </span><span class="n">CalcBeamSolarOnWinRevealSurface</span>
<a name="ln-9344"></a>
<a name="ln-9345"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9346"></a>          <span class="c">!       AUTHOR         F. Winkelmann</span>
<a name="ln-9347"></a>          <span class="c">!       DATE WRITTEN   April 2002</span>
<a name="ln-9348"></a>          <span class="c">!       MODIFIED:na</span>
<a name="ln-9349"></a>          <span class="c">!       RE-ENGINEERED:na</span>
<a name="ln-9350"></a>
<a name="ln-9351"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE</span>
<a name="ln-9352"></a>          <span class="c">! Called by InitHeatGains when the sun is up.</span>
<a name="ln-9353"></a>          <span class="c">! Calculates beam solar radiation absorbed and reflected by top, bottom,</span>
<a name="ln-9354"></a>          <span class="c">! right and left sides of outside and inside window reveal surfaces.</span>
<a name="ln-9355"></a>          <span class="c">! In doing this calculation, the shadowing on a reveal surface by other reveal surfaces</span>
<a name="ln-9356"></a>          <span class="c">! is determined using the orientation of the reveal surfaces and the sun position.</span>
<a name="ln-9357"></a>          <span class="c">! It is assumed that:</span>
<a name="ln-9358"></a>          <span class="c">!</span>
<a name="ln-9359"></a>          <span class="c">! (1) The window is an exterior window and is rectangular.</span>
<a name="ln-9360"></a>          <span class="c">! (2) The reveal surfaces are perpendicular to the window plane.</span>
<a name="ln-9361"></a>          <span class="c">! (3) If an exterior shade or blind is in place, there is no beam solar on</span>
<a name="ln-9362"></a>          <span class="c">!     on exterior or interior reveal surfaces.</span>
<a name="ln-9363"></a>          <span class="c">! (3) If an interior shade or blind is in place, there is no beam solar on</span>
<a name="ln-9364"></a>          <span class="c">!     interior reveal surfaces.</span>
<a name="ln-9365"></a>          <span class="c">! (4) The effect of window divider, if present, is ignored, including shadowing</span>
<a name="ln-9366"></a>          <span class="c">!     of divider on inside reveal surfaces.</span>
<a name="ln-9367"></a>
<a name="ln-9368"></a>          <span class="c">! In the variable names, the &quot;subscript&quot; 1 = outside reveal, 2 = inside reveal</span>
<a name="ln-9369"></a>          <span class="c">!</span>
<a name="ln-9370"></a>          <span class="c">! The outside reveal surfaces (top, bottom, left, right) are assumed to have the same depth</span>
<a name="ln-9371"></a>          <span class="c">! (given by Surface%Reveal and determined from vertices of window and vertices of parent</span>
<a name="ln-9372"></a>          <span class="c">! wall) and the same solar absorptance. The inside reveal surfaces are divided into</span>
<a name="ln-9373"></a>          <span class="c">! two categories: (1) the bottom reveal surface, called here the &quot;inside sill;&quot; and</span>
<a name="ln-9374"></a>          <span class="c">! the other reveal surfaces (left, right and top). The left, right and top inside reveal</span>
<a name="ln-9375"></a>          <span class="c">! surfaces are assumed to have the same depth and solar absorptance.</span>
<a name="ln-9376"></a>          <span class="c">! The depth of the outside reveal is measured from the outside surface of the glazing;</span>
<a name="ln-9377"></a>          <span class="c">! The depth of the inside sill and the other reveal surfaces is measured from the inside</span>
<a name="ln-9378"></a>          <span class="c">! surface of the glazing. The inside sill is</span>
<a name="ln-9379"></a>          <span class="c">! allowed to have depth and solar absorptance values that are different from the corresponding</span>
<a name="ln-9380"></a>          <span class="c">! values for the other inside reveal surfaces. The inside sill depth is required to be</span>
<a name="ln-9381"></a>          <span class="c">! greater than or equal to the depth of the other inside reveal surfaces. If the inside sill</span>
<a name="ln-9382"></a>          <span class="c">! depth is greater than zero the depth of the other inside reveal surfaces is required to</span>
<a name="ln-9383"></a>          <span class="c">! to be greater than zero.</span>
<a name="ln-9384"></a>          <span class="c">!</span>
<a name="ln-9385"></a>          <span class="c">! The reflection of beam solar radiation from all reveal surfaces is assumed to be isotropic</span>
<a name="ln-9386"></a>          <span class="c">! diffuse; there is no specular component. Half of the beam solar reflected from outside</span>
<a name="ln-9387"></a>          <span class="c">! reveal surfaces is assumed to go towards the window; the other half is assumed to go back</span>
<a name="ln-9388"></a>          <span class="c">! to the exterior environment (i.e., reflection of this outward-going component from</span>
<a name="ln-9389"></a>          <span class="c">! other outside reveal surfaces is not considered). The half that goes towards the window</span>
<a name="ln-9390"></a>          <span class="c">! is added to the other radiation incident on the window.</span>
<a name="ln-9391"></a>          <span class="c">! Correspondingly, half of the beam solar reflected from inside reveal surfaces is assumed</span>
<a name="ln-9392"></a>          <span class="c">! to go towards the window, with the other half going into the zone (this half, and the portion</span>
<a name="ln-9393"></a>          <span class="c">! going towards the window that is reflected) is added in CalcInteriorSolarDistribution</span>
<a name="ln-9394"></a>          <span class="c">! to the variable BTOTzone, which is the total beam solar entering the zone as beam or diffuse.</span>
<a name="ln-9395"></a>          <span class="c">! The portion going towards the window that is not reflected is absorbed in the glazing or</span>
<a name="ln-9396"></a>          <span class="c">! transmitted back out into the exterior environment.</span>
<a name="ln-9397"></a>          <span class="c">!</span>
<a name="ln-9398"></a>          <span class="c">! The beam solar that is absorbed by outside reveal surfaces is added to the solar absorbed</span>
<a name="ln-9399"></a>          <span class="c">! by the outside surface of the window&#39;s parent wall; similarly, the beam solar absorbed</span>
<a name="ln-9400"></a>          <span class="c">! by the inside reveal surfaces is added to the solar absorbed by the inside surface of the</span>
<a name="ln-9401"></a>          <span class="c">! parent wall (and is subtracted from BTOTzone).</span>
<a name="ln-9402"></a>          <span class="c">!</span>
<a name="ln-9403"></a>          <span class="c">! The net effect of beam solar reflected from outside reveal surfaces is to INCREASE the</span>
<a name="ln-9404"></a>          <span class="c">! the heat gain to the zone, whereas the effect of beam solar reflected from interior reveal</span>
<a name="ln-9405"></a>          <span class="c">! surfaces is to DECREASE the heat gain to the zone since part of this reflected solar is</span>
<a name="ln-9406"></a>          <span class="c">! transmitted back out the window.</span>
<a name="ln-9407"></a>          <span class="c">!</span>
<a name="ln-9408"></a>          <span class="c">! If the window has a frame, the absorption of reflected beam solar by the inside and outside</span>
<a name="ln-9409"></a>          <span class="c">! surfaces of the frame is considered. The shadowing of the frame onto interior reveal</span>
<a name="ln-9410"></a>          <span class="c">! surfaces is also considered.</span>
<a name="ln-9411"></a>
<a name="ln-9412"></a>          <span class="c">! The total glazing thickness is taken to be the sum of the thickness of the glass layers</span>
<a name="ln-9413"></a>          <span class="c">! and between-glass gas layers. If the window has an exterior, movable, storm window glass layer</span>
<a name="ln-9414"></a>          <span class="c">! the presence of this layer and its adjacent air gap is considered in calculating the glazing</span>
<a name="ln-9415"></a>          <span class="c">! properties (solar transmittance, etc.). But the storm window glass is assumed to be close</span>
<a name="ln-9416"></a>          <span class="c">! enough to the rest of the glazing that its effect on total glazing thickness and outside</span>
<a name="ln-9417"></a>          <span class="c">! reveal depth can be ignored.</span>
<a name="ln-9418"></a>
<a name="ln-9419"></a>          <span class="c">! METHODOLOGY EMPLOYED</span>
<a name="ln-9420"></a>          <span class="c">! na</span>
<a name="ln-9421"></a>
<a name="ln-9422"></a>          <span class="c">! REFERENCES</span>
<a name="ln-9423"></a>          <span class="c">! na</span>
<a name="ln-9424"></a>
<a name="ln-9425"></a>          <span class="c">! USE STATEMENTS</span>
<a name="ln-9426"></a><span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">POLYF</span><span class="p">,</span><span class="n">InterpSw</span>
<a name="ln-9427"></a>
<a name="ln-9428"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9429"></a>
<a name="ln-9430"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:na</span>
<a name="ln-9431"></a>
<a name="ln-9432"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS</span>
<a name="ln-9433"></a>
<a name="ln-9434"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ConstrNum</span>             <span class="c">! Construction number</span>
<a name="ln-9435"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ConstrNumSh</span>           <span class="c">! Shaded construction number</span>
<a name="ln-9436"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CosBetaBottom</span>         <span class="c">! Cosine of beam solar angle of incidence on bottom reveal</span>
<a name="ln-9437"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CosBetaLeft</span>           <span class="c">! Cosine of beam solar angle of incidence on left reveal</span>
<a name="ln-9438"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">CosBeta</span>               <span class="c">! ABS of CosBetaBottom or CosBetaLeft</span>
<a name="ln-9439"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">d1</span>                    <span class="c">! Depth of outside reveal + half of glazing thickness (m)</span>
<a name="ln-9440"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">d2</span>                    <span class="c">! Depth of inside sill or of inside reveal plus half of glazing thickness (m)</span>
<a name="ln-9441"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">d2prime</span>               <span class="c">! Depth of shadow cast on a reveal surface by opposite reveal (m)</span>
<a name="ln-9442"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">d2prime2</span>              <span class="c">! Depth of shadow cast by frame onto inside reveal (m)</span>
<a name="ln-9443"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">d12</span>                   <span class="c">! d12 = d1 + d2 - d2prime (m)</span>
<a name="ln-9444"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TanAlpha</span>              <span class="c">! Tangent of horizontal or vertical profile angle</span>
<a name="ln-9445"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TanGamma</span>              <span class="c">! Tangent of vertical or horizontal profile angle</span>
<a name="ln-9446"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">H</span><span class="p">,</span><span class="n">W</span>                   <span class="c">! Window height, width (m)</span>
<a name="ln-9447"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">L</span>                     <span class="c">! Window height or width (m)</span>
<a name="ln-9448"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">A1sh</span>                  <span class="c">! Shadowed area of outside horizontal or vertical reveal (m2)</span>
<a name="ln-9449"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">A2sh</span>                  <span class="c">! Shadowed area of inside horizontal or vertical reveal (m2)</span>
<a name="ln-9450"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">A1ill</span>                 <span class="c">! Illuminated area of outside horizontal or vertical reveal (m2)</span>
<a name="ln-9451"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">A2ill</span>                 <span class="c">! Illuminated area of inside horizontal or vertical reveal (m2)</span>
<a name="ln-9452"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SolTransGlass</span>         <span class="c">! Beam solar transmittance of glazing</span>
<a name="ln-9453"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">SolTransGlassSh</span>       <span class="c">! For switchable glazing, beam solar trans in switched state</span>
<a name="ln-9454"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DiffReflGlass</span>         <span class="c">! Diffuse back reflectance of glazing</span>
<a name="ln-9455"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">DiffReflGlassSh</span>       <span class="c">! For switchable glazing, diffuse back refl in switched state</span>
<a name="ln-9456"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">HorVertReveal</span>         <span class="c">! Index: 1 = horizontal reveal, 2 = vertical reveal</span>
<a name="ln-9457"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">OutsReveal</span>            <span class="c">! Depth of outside reveal (from outside glazing plane to outside wall plane) (m)</span>
<a name="ln-9458"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">InsReveal</span>             <span class="c">! Depth of inside reveal (from inside glazing plane to inside wall plane (m)</span>
<a name="ln-9459"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">InsSillDepth</span>          <span class="c">! Depth of inside sill, measured from innermost face of glazing (m)</span>
<a name="ln-9460"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">GlazingThickness</span>      <span class="c">! Thickness of glazing, measured from innermost face to outermost face (m)</span>
<a name="ln-9461"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">InsideRevealSolAbs</span>    <span class="c">! Solar absorptance of inside reveal or inside sill</span>
<a name="ln-9462"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BmSolRefldOutsReveal</span>  <span class="c">! Multiplied by beam solar gives beam solar reflected by horiz or vertical</span>
<a name="ln-9463"></a>                                        <span class="c">!  outside reveal surface (m2)</span>
<a name="ln-9464"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">BmSolRefldInsReveal</span>   <span class="c">! Multiplied by beam solar gives beam solar reflected by horiz or vertical</span>
<a name="ln-9465"></a>                                        <span class="c">!  inside reveal surface (m2)</span>
<a name="ln-9466"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">SurfNum</span>               <span class="c">! Surface number</span>
<a name="ln-9467"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">ShadeFlag</span>             <span class="c">! Shading flag</span>
<a name="ln-9468"></a><span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">FrameDivNum</span>           <span class="c">! Frame/Divider number</span>
<a name="ln-9469"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FrameWidth</span>            <span class="c">! Frame width (m)</span>
<a name="ln-9470"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">P1</span><span class="p">,</span><span class="n">P2</span>                 <span class="c">! Frame outside/inside projection plus half of glazing thickness (m)</span>
<a name="ln-9471"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">f1</span><span class="p">,</span><span class="n">f2</span>                 <span class="c">! f1=d1-P1, f2=d2-P2 (m)</span>
<a name="ln-9472"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">L1</span><span class="p">,</span><span class="n">L2</span>                 <span class="c">! Average distance of outside/inside illuminated area to frame;</span>
<a name="ln-9473"></a>                                        <span class="c">! used in calculating view factor to frame (m)</span>
<a name="ln-9474"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FracToGlassOuts</span>       <span class="c">! View factor from outside horizontal or vertical reveal to glass</span>
<a name="ln-9475"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">FracToGlassIns</span>        <span class="c">! View factor from inside horizontal or vertical reveal to glass</span>
<a name="ln-9476"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TanProfileAngVert</span>     <span class="c">! Tangent of vertical profile angle (the profile angle appropriate for</span>
<a name="ln-9477"></a>                                        <span class="c">! vertical reveal surfaces.</span>
<a name="ln-9478"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">TanProfileAngHor</span>      <span class="c">! Tangent of horizontal profile angle (the profile angle appropriate for</span>
<a name="ln-9479"></a>                                        <span class="c">! horizontal reveal surfaces.</span>
<a name="ln-9480"></a>
<a name="ln-9481"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">tmp_SunlitFracWithoutReveal</span>      <span class="c">! Temporary variable</span>
<a name="ln-9482"></a>
<a name="ln-9483"></a><span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9484"></a>
<a name="ln-9485"></a>  <span class="c">! Added TH for initialization. CR 7596 inside reveal causing high cooling loads</span>
<a name="ln-9486"></a>      <span class="c">! for outside reveals</span>
<a name="ln-9487"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdOutsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9488"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9489"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9490"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9491"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoFrame</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9492"></a>      <span class="c">! for inside reveals</span>
<a name="ln-9493"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9494"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsRevealReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9495"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9496"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9497"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealRepEnergy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9498"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9499"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazingReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9500"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrame</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9501"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrameReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9502"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZone</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9503"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZoneReport</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9504"></a>
<a name="ln-9505"></a>
<a name="ln-9506"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9507"></a>    <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9508"></a>    <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-9509"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Reveal</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideReveal</span> <span class="o">==</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9510"></a>       <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideSillDepth</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9511"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Sides</span> <span class="o">/=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9512"></a><span class="k">  IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideSillDepth</span> <span class="o">&lt;</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideReveal</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9513"></a>
<a name="ln-9514"></a><span class="k">  </span><span class="n">ShadeFlag</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span>
<a name="ln-9515"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9516"></a>
<a name="ln-9517"></a><span class="k">  IF</span><span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-9518"></a>
<a name="ln-9519"></a><span class="k">  </span><span class="n">tmp_SunlitFracWithoutReveal</span> <span class="o">=</span> <span class="n">SunlitFracWithoutReveal</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-9520"></a>
<a name="ln-9521"></a>  <span class="c">! Calculate cosine of angle of incidence of beam solar on reveal surfaces,</span>
<a name="ln-9522"></a>  <span class="c">! assumed to be perpendicular to window plane</span>
<a name="ln-9523"></a>
<a name="ln-9524"></a>  <span class="n">CosBetaBottom</span> <span class="o">=</span> <span class="o">-</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9525"></a>                   <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosTilt</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9526"></a>                   <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinTilt</span>
<a name="ln-9527"></a>
<a name="ln-9528"></a>  <span class="n">CosBetaLeft</span> <span class="o">=</span>   <span class="o">-</span><span class="n">SOLCOS</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">CosAzim</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-9529"></a>                   <span class="n">SOLCOS</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SinAzim</span>
<a name="ln-9530"></a>
<a name="ln-9531"></a>  <span class="c">!Note: CosBetaTop = -CosBetaBottom, CosBetaRight = -CosBetaLeft</span>
<a name="ln-9532"></a>
<a name="ln-9533"></a>  <span class="n">OutsReveal</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Reveal</span>
<a name="ln-9534"></a>  <span class="n">InsReveal</span>  <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideReveal</span>
<a name="ln-9535"></a>  <span class="n">InsideRevealSolAbs</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9536"></a>  <span class="n">GlazingThickness</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TotGlazingThickness</span>
<a name="ln-9537"></a>  <span class="n">H</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9538"></a>  <span class="n">W</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9539"></a>  <span class="n">d1</span> <span class="o">=</span> <span class="n">OutsReveal</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span>
<a name="ln-9540"></a>  <span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-9541"></a>  <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-9542"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9543"></a><span class="k">    </span><span class="n">ConstrNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-9544"></a>    <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span>
<a name="ln-9545"></a>  <span class="k">END IF</span>
<a name="ln-9546"></a><span class="k">  </span><span class="n">SolTransGlass</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-9547"></a>  <span class="n">TanProfileAngVert</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TanProfileAngVert</span>
<a name="ln-9548"></a>  <span class="n">TanProfileAngHor</span>  <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">TanProfileAngHor</span>
<a name="ln-9549"></a>  <span class="n">FrameDivNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameDivider</span>
<a name="ln-9550"></a>  <span class="n">FrameWidth</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9551"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FrameDivNum</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9552"></a><span class="k">    </span><span class="n">FrameWidth</span> <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrameDivNum</span><span class="p">)%</span><span class="n">FrameWidth</span>
<a name="ln-9553"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FrameWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9554"></a><span class="k">      </span><span class="n">P1</span>  <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrameDivNum</span><span class="p">)%</span><span class="n">FrameProjectionOut</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span>
<a name="ln-9555"></a>      <span class="n">P2</span>  <span class="o">=</span> <span class="n">FrameDivider</span><span class="p">(</span><span class="n">FrameDivNum</span><span class="p">)%</span><span class="n">FrameProjectionIn</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span>
<a name="ln-9556"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutsReveal</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span> <span class="o">&lt;=</span> <span class="n">P1</span><span class="p">)</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">P1</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-9557"></a>    <span class="k">END IF</span>
<a name="ln-9558"></a><span class="k">  END IF</span>
<a name="ln-9559"></a>                                      <span class="c">! Loop over vertical and horizontal reveal surfaces</span>
<a name="ln-9560"></a>  <span class="k">DO </span><span class="n">HorVertReveal</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>
<a name="ln-9561"></a>
<a name="ln-9562"></a>    <span class="n">FracToGlassOuts</span> <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-9563"></a>    <span class="n">FracToGlassIns</span>  <span class="o">=</span> <span class="mf">0.5d0</span>
<a name="ln-9564"></a>    <span class="n">BmSolRefldOutsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9565"></a>    <span class="n">BmSolRefldInsReveal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9566"></a>    <span class="n">A1ill</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9567"></a>    <span class="n">A2ill</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9568"></a>
<a name="ln-9569"></a>    <span class="c">! Added TH. 5/27/2009</span>
<a name="ln-9570"></a>    <span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9571"></a>    <span class="n">A2sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9572"></a>
<a name="ln-9573"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HorVertReveal</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>       <span class="c">! Vertical reveal</span>
<a name="ln-9574"></a>      <span class="n">TanAlpha</span> <span class="o">=</span> <span class="n">TanProfileAngHor</span>
<a name="ln-9575"></a>      <span class="n">TanGamma</span> <span class="o">=</span> <span class="n">TanProfileAngVert</span>
<a name="ln-9576"></a>      <span class="n">CosBeta</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CosBetaLeft</span><span class="p">)</span>
<a name="ln-9577"></a>      <span class="n">L</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Height</span>
<a name="ln-9578"></a>      <span class="n">d2</span> <span class="o">=</span> <span class="n">InsReveal</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span>
<a name="ln-9579"></a>      <span class="n">d2prime</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">+</span> <span class="n">d2</span> <span class="o">-</span> <span class="n">W</span><span class="o">/</span><span class="n">TanGamma</span>
<a name="ln-9580"></a>      <span class="n">InsideRevealSolAbs</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideRevealSolAbs</span>
<a name="ln-9581"></a>    <span class="k">ELSE</span>                              <span class="c">! Horizontal reveal</span>
<a name="ln-9582"></a>      <span class="n">InsSillDepth</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideSillDepth</span>
<a name="ln-9583"></a>      <span class="n">TanAlpha</span> <span class="o">=</span> <span class="n">TanProfileAngVert</span>
<a name="ln-9584"></a>      <span class="n">TanGamma</span> <span class="o">=</span> <span class="n">TanProfileAngHor</span>
<a name="ln-9585"></a>      <span class="n">CosBeta</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">CosBetaBottom</span><span class="p">)</span>
<a name="ln-9586"></a>      <span class="n">L</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Width</span>
<a name="ln-9587"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CosBetaBottom</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Bottom reveal surfaces may be illuminated</span>
<a name="ln-9588"></a>        <span class="n">d2</span> <span class="o">=</span> <span class="n">InsSillDepth</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span>
<a name="ln-9589"></a>        <span class="n">InsideRevealSolAbs</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideSillSolAbs</span>
<a name="ln-9590"></a>      <span class="k">ELSE</span>                          <span class="c">! Top reveal surfaces may be illuminated</span>
<a name="ln-9591"></a>        <span class="n">d2</span> <span class="o">=</span> <span class="n">InsReveal</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span>
<a name="ln-9592"></a>        <span class="n">InsideRevealSolAbs</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsideRevealSolAbs</span>
<a name="ln-9593"></a>      <span class="k">END IF</span>
<a name="ln-9594"></a><span class="k">      </span><span class="n">d2prime</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">+</span> <span class="n">d2</span> <span class="o">-</span> <span class="n">H</span><span class="o">/</span><span class="n">TanGamma</span>
<a name="ln-9595"></a>    <span class="k">END IF</span>
<a name="ln-9596"></a><span class="k">    IF</span><span class="p">(</span><span class="n">d2prime</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">d2prime</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! No shadow from opposing reveal</span>
<a name="ln-9597"></a>    <span class="n">d12</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">+</span> <span class="n">d2</span> <span class="o">-</span> <span class="n">d2prime</span>
<a name="ln-9598"></a>
<a name="ln-9599"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FrameWidth</span> <span class="o">&lt;=</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9600"></a>      <span class="c">! Window without frame</span>
<a name="ln-9601"></a>
<a name="ln-9602"></a>      <span class="c">! Find inside and outside shadowed area of vertical or horizontal reveal surfaces</span>
<a name="ln-9603"></a>      <span class="c">! that can be illuminated by beam solar; shadowing is by other reveal surfaces.</span>
<a name="ln-9604"></a>
<a name="ln-9605"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">d2prime</span> <span class="o">&lt;=</span> <span class="n">d2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9606"></a><span class="k">        IF</span><span class="p">(</span><span class="n">d12</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9607"></a><span class="k">          </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">d1</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9608"></a>          <span class="n">A2sh</span> <span class="o">=</span> <span class="n">d2prime</span><span class="o">*</span><span class="n">L</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">d12</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">A1sh</span>
<a name="ln-9609"></a>        <span class="k">ELSE</span>  <span class="c">! d12*TanAlpha &gt; L</span>
<a name="ln-9610"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">d1</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9611"></a><span class="k">            </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">d1</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9612"></a>            <span class="n">A2sh</span> <span class="o">=</span> <span class="n">d2</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">TanAlpha</span> <span class="o">-</span> <span class="n">d1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9613"></a>          <span class="k">ELSE</span>  <span class="c">! d1*TanAlpha &gt; L</span>
<a name="ln-9614"></a>            <span class="n">A1sh</span> <span class="o">=</span> <span class="n">d1</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">/</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9615"></a>            <span class="n">A2sh</span> <span class="o">=</span> <span class="n">d2</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9616"></a>          <span class="k">END IF</span>
<a name="ln-9617"></a><span class="k">        END IF</span>
<a name="ln-9618"></a><span class="k">      ELSE</span>  <span class="c">! d2prime &gt; d2</span>
<a name="ln-9619"></a>        <span class="n">A2sh</span> <span class="o">=</span> <span class="n">d2</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9620"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">d2prime</span> <span class="o">&lt;</span> <span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9621"></a><span class="k">          IF</span><span class="p">(</span><span class="n">d12</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9622"></a><span class="k">            </span><span class="n">A1sh</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="p">(</span><span class="n">d2prime</span><span class="o">-</span><span class="n">d2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">d12</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9623"></a>          <span class="k">ELSE</span>  <span class="c">! d12*TanAlpha &gt; L</span>
<a name="ln-9624"></a>            <span class="n">A1sh</span> <span class="o">=</span> <span class="n">d1</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">TanAlpha</span>
<a name="ln-9625"></a>          <span class="k">END IF</span>
<a name="ln-9626"></a><span class="k">        ELSE</span>  <span class="c">! d2prime &gt;= d1+d2</span>
<a name="ln-9627"></a>          <span class="n">A1sh</span> <span class="o">=</span> <span class="n">d1</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9628"></a>        <span class="k">END IF</span>
<a name="ln-9629"></a><span class="k">      END IF</span>
<a name="ln-9630"></a>
<a name="ln-9631"></a>      <span class="c">! Added TH. 5/27/2009</span>
<a name="ln-9632"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">A1sh</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9633"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">A2sh</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">A2sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9634"></a>
<a name="ln-9635"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutsReveal</span> <span class="o">&gt;=</span> <span class="mf">0.001d0</span><span class="p">)</span> <span class="n">A1ill</span> <span class="o">=</span> <span class="n">d1</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="n">A1sh</span>  <span class="c">! A1ill = 0.0 if OutsReveal &lt; 0.001</span>
<a name="ln-9636"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">InsReveal</span> <span class="o">&gt;=</span> <span class="mf">0.001d0</span><span class="p">)</span>  <span class="n">A2ill</span> <span class="o">=</span> <span class="n">d2</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="n">A2sh</span>  <span class="c">! A2ill = 0.0 if InsReveal &lt; 0.001</span>
<a name="ln-9637"></a>
<a name="ln-9638"></a>    <span class="k">ELSE</span>                             <span class="c">! Window with frame; take into account shadowing</span>
<a name="ln-9639"></a>                                     <span class="c">! of inside reveal surfaces by frame</span>
<a name="ln-9640"></a>      <span class="n">f1</span> <span class="o">=</span> <span class="n">d1</span><span class="o">-</span><span class="n">P1</span>
<a name="ln-9641"></a>      <span class="n">f2</span> <span class="o">=</span> <span class="n">d2</span><span class="o">-</span><span class="n">P2</span>
<a name="ln-9642"></a>      <span class="n">d2prime2</span> <span class="o">=</span> <span class="n">FrameWidth</span><span class="o">/</span><span class="n">TanGamma</span>
<a name="ln-9643"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HorVertReveal</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Vertical reveal</span>
<a name="ln-9644"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">InsReveal</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span> <span class="o">&lt;=</span> <span class="n">P2</span><span class="p">)</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">P2</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-9645"></a>      <span class="k">ELSE</span>                <span class="c">! Horizontal</span>
<a name="ln-9646"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CosBetaBottom</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Bottom reveal surfaces may be illuminated</span>
<a name="ln-9647"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">InsSillDepth</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span> <span class="o">&lt;=</span> <span class="n">P2</span><span class="p">)</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">P2</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-9648"></a>        <span class="k">ELSE</span>                          <span class="c">! Top reveal surfaces may be illuminated</span>
<a name="ln-9649"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">InsReveal</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span> <span class="o">&lt;=</span> <span class="n">P2</span><span class="p">)</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">P2</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-9650"></a>        <span class="k">END IF</span>
<a name="ln-9651"></a><span class="k">      END IF</span>
<a name="ln-9652"></a>
<a name="ln-9653"></a><span class="k">      IF</span><span class="p">(</span><span class="n">d2prime</span> <span class="o">&lt;=</span> <span class="n">f2</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">! Shadow from opposing reveal does not go beyond inside surface of frame</span>
<a name="ln-9654"></a>
<a name="ln-9655"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">d12</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9656"></a><span class="k">          </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">f1</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9657"></a>          <span class="n">L1</span>   <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">/</span><span class="p">(</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">L</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5d0</span><span class="p">)</span>
<a name="ln-9658"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">d2</span><span class="o">-</span><span class="p">(</span><span class="n">d2prime</span><span class="o">+</span><span class="n">d2prime2</span><span class="o">+</span><span class="n">P2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9659"></a><span class="k">            </span><span class="n">A2sh</span> <span class="o">=</span> <span class="p">(</span><span class="n">d2prime</span><span class="o">+</span><span class="n">d2prime2</span><span class="p">)</span><span class="o">*</span><span class="n">L</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="p">((</span><span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="o">-</span><span class="n">d2prime</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">p2</span><span class="o">+</span><span class="n">d2prime2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-9660"></a>            <span class="n">L2</span>   <span class="o">=</span> <span class="n">d2prime2</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">d2</span><span class="o">-</span><span class="p">(</span><span class="n">d2prime</span><span class="o">+</span><span class="n">d2prime2</span><span class="o">+</span><span class="n">P2</span><span class="p">))</span>
<a name="ln-9661"></a>          <span class="k">ELSE</span>  <span class="c">! d2-(d2prime+d2prime2+P2) &lt; 0.  ! Inside reveal is fully shadowed by frame and/or opposing reveal</span>
<a name="ln-9662"></a>            <span class="n">A2sh</span> <span class="o">=</span> <span class="n">f2</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9663"></a>            <span class="n">L2</span>   <span class="o">=</span> <span class="n">f2</span>
<a name="ln-9664"></a>          <span class="k">END IF</span>
<a name="ln-9665"></a><span class="k">        ELSE</span>  <span class="c">! d12*TanAlpha &gt;= L</span>
<a name="ln-9666"></a>          <span class="k">IF</span><span class="p">((</span><span class="n">d1</span><span class="o">+</span><span class="n">P2</span><span class="p">)</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9667"></a><span class="k">            </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">f1</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9668"></a>            <span class="n">L1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="p">((</span><span class="n">f1</span><span class="o">*</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="p">)</span>
<a name="ln-9669"></a>            <span class="k">IF</span><span class="p">((</span><span class="n">d1</span><span class="o">+</span><span class="n">P2</span><span class="o">+</span><span class="n">d2prime2</span><span class="p">)</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&gt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9670"></a><span class="k">              </span><span class="n">A2sh</span> <span class="o">=</span> <span class="n">f2</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9671"></a>              <span class="n">L2</span>     <span class="o">=</span> <span class="n">f2</span>
<a name="ln-9672"></a>            <span class="k">ELSE</span>  <span class="c">! (d1+P2+d2prime2)*TanAlpha &lt; L</span>
<a name="ln-9673"></a>              <span class="n">A2sh</span> <span class="o">=</span> <span class="n">f2</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">P2</span><span class="p">)</span><span class="o">*</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">TanAlpha</span> <span class="o">+</span> <span class="n">d2prime2</span><span class="o">*</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">P2</span><span class="o">+</span><span class="n">d2prime2</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">*</span><span class="n">TanAlpha</span><span class="p">)</span>
<a name="ln-9674"></a>              <span class="n">L2</span> <span class="o">=</span> <span class="n">d2prime2</span> <span class="o">+</span> <span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">TanAlpha</span> <span class="o">-</span> <span class="p">(</span><span class="n">d1</span><span class="o">+</span><span class="n">P2</span><span class="o">+</span><span class="n">d2prime2</span><span class="p">))</span><span class="o">/</span><span class="mf">3.d0</span>
<a name="ln-9675"></a>            <span class="k">END IF</span>
<a name="ln-9676"></a><span class="k">          ELSE</span>  <span class="c">! (d1+P2)*TanAlpha &gt; L</span>
<a name="ln-9677"></a>            <span class="n">L2</span> <span class="o">=</span> <span class="n">f2</span>
<a name="ln-9678"></a>            <span class="n">A2sh</span> <span class="o">=</span> <span class="n">f2</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9679"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">f1</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9680"></a><span class="k">              </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">f1</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9681"></a>              <span class="n">L1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="p">((</span><span class="n">f1</span><span class="o">*</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="p">)</span>
<a name="ln-9682"></a>            <span class="k">ELSE</span>  <span class="c">! f1*TanAlpha &gt; L</span>
<a name="ln-9683"></a>              <span class="n">A1sh</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">TanAlpha</span>
<a name="ln-9684"></a>              <span class="n">L1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">-</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span>
<a name="ln-9685"></a>            <span class="k">END IF</span>
<a name="ln-9686"></a><span class="k">          END IF</span>
<a name="ln-9687"></a><span class="k">        END IF</span>
<a name="ln-9688"></a>
<a name="ln-9689"></a><span class="k">      ELSE</span>  <span class="c">! d2prime &gt; f2   ! Shadow from opposing reveal goes beyond inside of frame</span>
<a name="ln-9690"></a>
<a name="ln-9691"></a>        <span class="n">A2sh</span> <span class="o">=</span> <span class="n">f2</span><span class="o">*</span><span class="n">L</span>
<a name="ln-9692"></a>        <span class="n">L2</span> <span class="o">=</span> <span class="n">f2</span>
<a name="ln-9693"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">d2prime</span> <span class="o">&gt;=</span> <span class="n">d1</span><span class="o">+</span><span class="n">d2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9694"></a><span class="k">          </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9695"></a>          <span class="n">L1</span>   <span class="o">=</span> <span class="n">f1</span>
<a name="ln-9696"></a>        <span class="k">ELSE</span>  <span class="c">! d2prime &lt; d1+d2</span>
<a name="ln-9697"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">d2prime</span> <span class="o">&lt;=</span> <span class="n">d2</span><span class="o">+</span><span class="n">P1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9698"></a><span class="k">            IF</span><span class="p">(</span><span class="n">f1</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9699"></a><span class="k">              </span><span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">f1</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9700"></a>              <span class="n">L1</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="p">((</span><span class="n">f1</span><span class="o">*</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">6.d0</span><span class="o">*</span><span class="n">L</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="p">)</span>
<a name="ln-9701"></a>            <span class="k">ELSE</span>  <span class="c">! f1*TanAlpha &gt; L</span>
<a name="ln-9702"></a>              <span class="n">A1sh</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">TanAlpha</span>
<a name="ln-9703"></a>              <span class="n">L1</span>   <span class="o">=</span> <span class="n">f1</span> <span class="o">-</span> <span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span>
<a name="ln-9704"></a>            <span class="k">END IF</span>
<a name="ln-9705"></a><span class="k">          ELSE</span>  <span class="c">! d2prime &gt; d2+P1</span>
<a name="ln-9706"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">d12</span><span class="o">*</span><span class="n">TanAlpha</span> <span class="o">&lt;=</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9707"></a><span class="k">              </span><span class="n">A1sh</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="p">(</span><span class="n">d2prime</span><span class="o">-</span><span class="p">(</span><span class="n">d2</span><span class="o">+</span><span class="n">P1</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="n">d12</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-9708"></a>              <span class="n">L1</span>   <span class="o">=</span> <span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">-</span><span class="n">d12</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span><span class="o">-</span><span class="n">d12</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="n">d12</span><span class="o">/</span><span class="mf">3.d0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">d12</span><span class="o">*</span><span class="n">TanAlpha</span><span class="o">/</span><span class="mf">2.d0</span><span class="p">)</span>
<a name="ln-9709"></a>            <span class="k">ELSE</span>  <span class="c">! d12*TanAlpha &gt; L</span>
<a name="ln-9710"></a>              <span class="n">A1sh</span> <span class="o">=</span> <span class="n">f1</span><span class="o">*</span><span class="n">L</span> <span class="o">-</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="n">L</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">TanAlpha</span>
<a name="ln-9711"></a>              <span class="n">L1</span>   <span class="o">=</span> <span class="n">f1</span> <span class="o">-</span> <span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">TanAlpha</span><span class="p">)</span><span class="o">/</span><span class="mf">3.d0</span>
<a name="ln-9712"></a>            <span class="k">END IF</span>
<a name="ln-9713"></a><span class="k">          END IF</span>
<a name="ln-9714"></a><span class="k">        END IF</span>
<a name="ln-9715"></a>
<a name="ln-9716"></a><span class="k">      END IF</span>
<a name="ln-9717"></a>
<a name="ln-9718"></a>      <span class="c">! Added TH. 5/27/2009</span>
<a name="ln-9719"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">A1sh</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">A1sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9720"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">A2sh</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">A2sh</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9721"></a>
<a name="ln-9722"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OutsReveal</span> <span class="o">&gt;=</span> <span class="n">P1</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span><span class="o">+</span><span class="mf">0.001d0</span><span class="p">)</span> <span class="n">A1ill</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="n">f1</span> <span class="o">-</span> <span class="n">A1sh</span>
<a name="ln-9723"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">InsReveal</span> <span class="o">&gt;=</span> <span class="n">P2</span><span class="o">+</span><span class="mf">0.5d0</span><span class="o">*</span><span class="n">GlazingThickness</span><span class="o">+</span><span class="mf">0.001d0</span><span class="p">)</span>  <span class="n">A2ill</span> <span class="o">=</span> <span class="n">L</span><span class="o">*</span><span class="n">f2</span> <span class="o">-</span> <span class="n">A2sh</span>
<a name="ln-9724"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">L1</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9725"></a><span class="k">        </span><span class="n">FracToGlassOuts</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9726"></a>      <span class="k">ELSE</span>
<a name="ln-9727"></a><span class="k">        </span><span class="n">FracToGlassOuts</span> <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">ATAN</span><span class="p">(</span><span class="n">FrameWidth</span><span class="o">/</span><span class="n">L1</span><span class="p">)</span><span class="o">/</span><span class="n">PiOvr2</span><span class="p">)</span>
<a name="ln-9728"></a>      <span class="k">END IF</span>
<a name="ln-9729"></a><span class="k">      IF</span><span class="p">(</span><span class="n">L2</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9730"></a><span class="k">        </span><span class="n">FracToGlassIns</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9731"></a>      <span class="k">ELSE</span>
<a name="ln-9732"></a><span class="k">        </span><span class="n">FracToGlassIns</span>  <span class="o">=</span> <span class="mf">0.5d0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">ATAN</span><span class="p">(</span><span class="n">FrameWidth</span><span class="o">/</span><span class="n">L2</span><span class="p">)</span><span class="o">/</span><span class="n">PiOvr2</span><span class="p">)</span>
<a name="ln-9733"></a>      <span class="k">END IF</span>
<a name="ln-9734"></a><span class="k">    END IF</span>  <span class="c">! End of check if window has frame</span>
<a name="ln-9735"></a>
<a name="ln-9736"></a>    <span class="c">! Added TH. 5/27/2009</span>
<a name="ln-9737"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">A1ill</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">A1ill</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9738"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">A2ill</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">A2ill</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9739"></a>
<a name="ln-9740"></a>    <span class="c">! Quantities related to outside reveal</span>
<a name="ln-9741"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">A1ill</span> <span class="o">&gt;</span> <span class="mf">1.0d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9742"></a>
<a name="ln-9743"></a><span class="k">      </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdOutsReveal</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdOutsReveal</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9744"></a>        <span class="n">A1ill</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsideRevealSolAbs</span> <span class="o">*</span> <span class="n">CosBeta</span> <span class="o">*</span> <span class="n">tmp_SunlitFracWithoutReveal</span>
<a name="ln-9745"></a>
<a name="ln-9746"></a>      <span class="n">BmSolRefldOutsReveal</span> <span class="o">=</span> <span class="n">A1ill</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsideRevealSolAbs</span><span class="p">)</span> <span class="o">*</span> <span class="n">CosBeta</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-9747"></a>        <span class="n">tmp_SunlitFracWithoutReveal</span>
<a name="ln-9748"></a>
<a name="ln-9749"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealReport</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealReport</span> <span class="p">&amp;</span>
<a name="ln-9750"></a>                           <span class="o">+</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">BmSolRefldOutsReveal</span>
<a name="ln-9751"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealRepEnergy</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldOutsRevealReport</span> <span class="p">&amp;</span>
<a name="ln-9752"></a>                            <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-9753"></a>
<a name="ln-9754"></a>      <span class="c">! Reflected solar from outside horizontal and vertical reveal incident on glazing</span>
<a name="ln-9755"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoGlazing</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9756"></a>        <span class="n">FracToGlassOuts</span> <span class="o">*</span> <span class="n">BmSolRefldOutsReveal</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-9757"></a>
<a name="ln-9758"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FrameWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9759"></a>      <span class="c">! Reflected solar from outside horizontal and vertical reveal incident on frame</span>
<a name="ln-9760"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoFrame</span> <span class="o">=</span>  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">OutsRevealDiffOntoFrame</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9761"></a>          <span class="p">(</span><span class="mf">0.5d0</span><span class="o">-</span><span class="n">FracToGlassOuts</span><span class="p">)</span> <span class="o">*</span> <span class="n">BmSolRefldOutsReveal</span> <span class="o">/</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameArea</span>
<a name="ln-9762"></a>      <span class="k">END IF</span>
<a name="ln-9763"></a>
<a name="ln-9764"></a><span class="k">    END IF</span>  <span class="c">! End of check if A1ill &gt; 0.0d0</span>
<a name="ln-9765"></a>
<a name="ln-9766"></a>   <span class="c">! Quantities related to inside reveal; inside reveal reflection/absorption is assumed</span>
<a name="ln-9767"></a>   <span class="c">! to occur only if an interior shade or blind is not in place.</span>
<a name="ln-9768"></a>
<a name="ln-9769"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9770"></a>
<a name="ln-9771"></a><span class="k">      IF</span><span class="p">(</span><span class="n">A2ill</span> <span class="o">&gt;</span> <span class="mf">1.0d-6</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9772"></a>
<a name="ln-9773"></a><span class="k">        </span><span class="n">DiffReflGlass</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-9774"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9775"></a><span class="k">          </span><span class="n">SolTransGlassSh</span> <span class="o">=</span> <span class="n">POLYF</span><span class="p">(</span><span class="n">CosIncAng</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">),</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TransSolBeamCoef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">))</span>
<a name="ln-9776"></a>          <span class="n">SolTransGlass</span>   <span class="o">=</span> <span class="n">InterpSW</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span><span class="n">SolTransGlass</span><span class="p">,</span><span class="n">SolTransGlassSh</span><span class="p">)</span>
<a name="ln-9777"></a>          <span class="n">DiffReflGlassSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-9778"></a>          <span class="n">DiffReflGlass</span>   <span class="o">=</span> <span class="n">InterpSW</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span><span class="n">DiffReflGlass</span><span class="p">,</span><span class="n">DiffReflGlassSh</span><span class="p">)</span>
<a name="ln-9779"></a>        <span class="k">END IF</span>
<a name="ln-9780"></a>
<a name="ln-9781"></a>        <span class="c">! Calc beam solar sbsorbed (m2)</span>
<a name="ln-9782"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsReveal</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9783"></a>          <span class="n">A2ill</span> <span class="o">*</span> <span class="n">SolTransGlass</span> <span class="o">*</span> <span class="n">InsideRevealSolAbs</span> <span class="o">*</span> <span class="n">CosBeta</span> <span class="o">*</span> <span class="n">tmp_SunlitFracWithoutReveal</span>
<a name="ln-9784"></a>
<a name="ln-9785"></a>        <span class="c">! Added TH 5/26/2009 for reporting purpose - Beam solar absorbed by the inside reveal (W)</span>
<a name="ln-9786"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsRevealReport</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolAbsdInsRevealReport</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9787"></a>          <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">A2ill</span> <span class="o">*</span> <span class="n">SolTransGlass</span> <span class="o">*</span> <span class="n">InsideRevealSolAbs</span> <span class="o">*</span> <span class="n">CosBeta</span> <span class="o">*</span> <span class="n">tmp_SunlitFracWithoutReveal</span>
<a name="ln-9788"></a>
<a name="ln-9789"></a>        <span class="c">! in m2 = Area * solar transmitted fraction * inside reveal reflection fraction</span>
<a name="ln-9790"></a>        <span class="n">BmSolRefldInsReveal</span> <span class="o">=</span> <span class="n">A2ill</span> <span class="o">*</span> <span class="n">SolTransGlass</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">InsideRevealSolAbs</span><span class="p">)</span> <span class="o">*</span> <span class="n">CosBeta</span> <span class="o">*</span>  <span class="p">&amp;</span>
<a name="ln-9791"></a>          <span class="n">tmp_SunlitFracWithoutReveal</span>
<a name="ln-9792"></a>
<a name="ln-9793"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsReveal</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsReveal</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9794"></a>          <span class="n">BmSolRefldInsReveal</span>
<a name="ln-9795"></a>
<a name="ln-9796"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealReport</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealReport</span> <span class="p">&amp;</span>
<a name="ln-9797"></a>                                  <span class="o">+</span> <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">BmSolRefldInsReveal</span>  <span class="c">! W, BeamSolarRad in W/m2</span>
<a name="ln-9798"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealRepEnergy</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">BmSolRefldInsRevealReport</span> <span class="p">&amp;</span>
<a name="ln-9799"></a>                                  <span class="o">*</span> <span class="n">TimeStepZone</span> <span class="o">*</span> <span class="n">SecInHour</span>
<a name="ln-9800"></a>
<a name="ln-9801"></a>        <span class="c">! Reflected solar from inside horizontal and vertical reveal incident on glazing</span>
<a name="ln-9802"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazing</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9803"></a>          <span class="n">FracToGlassIns</span> <span class="o">*</span> <span class="n">BmSolRefldInsReveal</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-9804"></a>
<a name="ln-9805"></a>        <span class="c">! Added TH 5/26/2009 for reporting purpose - diffuse on window glass from inside reveal (W)</span>
<a name="ln-9806"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazingReport</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoGlazingReport</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9807"></a>          <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">FracToGlassIns</span> <span class="o">*</span> <span class="n">BmSolRefldInsReveal</span>
<a name="ln-9808"></a>
<a name="ln-9809"></a>        <span class="c">! Reflected solar from inside horizontal and vertical reveal incident on frame</span>
<a name="ln-9810"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FrameWidth</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9811"></a><span class="k">          </span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrame</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrame</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9812"></a>            <span class="p">(</span><span class="mf">0.5d0</span><span class="o">-</span><span class="n">FracToGlassIns</span><span class="p">)</span><span class="o">*</span><span class="n">BmSolRefldInsReveal</span> <span class="o">/</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">FrameArea</span>
<a name="ln-9813"></a>
<a name="ln-9814"></a>          <span class="c">! Added TH 5/26/2009 for reporting purpose - diffuse on window frame from inside reveal (W)</span>
<a name="ln-9815"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrameReport</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffOntoFrameReport</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-9816"></a>            <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5d0</span><span class="o">-</span><span class="n">FracToGlassIns</span><span class="p">)</span><span class="o">*</span><span class="n">BmSolRefldInsReveal</span>
<a name="ln-9817"></a>        <span class="k">END IF</span>
<a name="ln-9818"></a>
<a name="ln-9819"></a>        <span class="c">! Reflected solar from inside reveal going directly into zone and reflected from glass.</span>
<a name="ln-9820"></a>        <span class="c">! Assumes half of solar reflected from inside reveal goes as diffuse radiation into the zone and</span>
<a name="ln-9821"></a>        <span class="c">! half goes as diffuse radiation towards window.</span>
<a name="ln-9822"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZone</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZone</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9823"></a>          <span class="n">BmSolRefldInsReveal</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5d0</span> <span class="o">+</span> <span class="n">DiffReflGlass</span> <span class="o">*</span> <span class="n">FracToGlassIns</span><span class="p">)</span>
<a name="ln-9824"></a>
<a name="ln-9825"></a>        <span class="c">! Added TH 5/26/2009 for reporting purpose - diffuse into zone from inside reveal (W)</span>
<a name="ln-9826"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZoneReport</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">InsRevealDiffIntoZoneReport</span> <span class="o">+</span>  <span class="p">&amp;</span>
<a name="ln-9827"></a>          <span class="n">BeamSolarRad</span> <span class="o">*</span> <span class="n">BmSolRefldInsReveal</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5d0</span> <span class="o">+</span> <span class="n">DiffReflGlass</span> <span class="o">*</span> <span class="n">FracToGlassIns</span><span class="p">)</span>
<a name="ln-9828"></a>
<a name="ln-9829"></a>      <span class="k">END IF</span>  <span class="c">! End of check if A2ill &gt; 0.0d0</span>
<a name="ln-9830"></a>
<a name="ln-9831"></a>    <span class="k">END IF</span>  <span class="c">! End of check if interior shade or blind is in place</span>
<a name="ln-9832"></a>
<a name="ln-9833"></a>  <span class="k">END DO</span>  <span class="c">! End of loop over vertical and horizontal reveal</span>
<a name="ln-9834"></a>
<a name="ln-9835"></a><span class="k">END DO</span>  <span class="c">! End of surface loop</span>
<a name="ln-9836"></a>
<a name="ln-9837"></a><span class="k">RETURN</span>
<a name="ln-9838"></a><span class="k">END SUBROUTINE </span><span class="n">CalcBeamSolarOnWinRevealSurface</span>
<a name="ln-9839"></a>
<a name="ln-9840"></a><span class="k">SUBROUTINE </span><span class="n">ReportSurfaceShading</span>
<a name="ln-9841"></a>
<a name="ln-9842"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9843"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-9844"></a>          <span class="c">!       DATE WRITTEN   April 2000</span>
<a name="ln-9845"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9846"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9847"></a>
<a name="ln-9848"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9849"></a>          <span class="c">! This subroutine uses the internal variables used in the Shading</span>
<a name="ln-9850"></a>          <span class="c">! calculations and prepares them for reporting (at timestep level).</span>
<a name="ln-9851"></a>
<a name="ln-9852"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9853"></a>          <span class="c">! Because all of the calculations are done on a &quot;daily&quot; basis in this</span>
<a name="ln-9854"></a>          <span class="c">! module, it is difficult to formulate the values that might be useful</span>
<a name="ln-9855"></a>          <span class="c">! for reporting.  SunLitFrac was the first of these two arrays to be</span>
<a name="ln-9856"></a>          <span class="c">! made into &quot;two dimensions&quot;.  It is not clear that both have to be</span>
<a name="ln-9857"></a>          <span class="c">! two dimensions.</span>
<a name="ln-9858"></a>
<a name="ln-9859"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9860"></a>          <span class="c">! na</span>
<a name="ln-9861"></a>
<a name="ln-9862"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9863"></a>  <span class="k">USE </span><span class="n">OutputReportPredefined</span>
<a name="ln-9864"></a>
<a name="ln-9865"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9866"></a>
<a name="ln-9867"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9868"></a>          <span class="c">! na</span>
<a name="ln-9869"></a>
<a name="ln-9870"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9871"></a>          <span class="c">! na</span>
<a name="ln-9872"></a>
<a name="ln-9873"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9874"></a>          <span class="c">! na</span>
<a name="ln-9875"></a>
<a name="ln-9876"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9877"></a>          <span class="c">! na</span>
<a name="ln-9878"></a>
<a name="ln-9879"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9880"></a>  <span class="kt">INTEGER </span><span class="n">SurfNum</span> <span class="c">! Loop Counter</span>
<a name="ln-9881"></a>  <span class="kt">INTEGER </span><span class="n">RepCol</span>  <span class="c">! the column of the predefined report</span>
<a name="ln-9882"></a>
<a name="ln-9883"></a>  <span class="k">DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9884"></a>    <span class="n">SurfSunlitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span><span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span>
<a name="ln-9885"></a>    <span class="n">SurfSunlitArea</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)</span><span class="o">=</span><span class="n">SunLitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">,</span><span class="n">HourOfDay</span><span class="p">,</span><span class="n">TimeStep</span><span class="p">)</span><span class="o">*</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-9886"></a>  <span class="n">ENDDO</span>
<a name="ln-9887"></a>  <span class="c">!added for predefined reporting</span>
<a name="ln-9888"></a>  <span class="n">RepCol</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9889"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Month</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DayOfMonth</span> <span class="o">==</span> <span class="mi">21</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9890"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9891"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfMar21_9</span>
<a name="ln-9892"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">12</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9893"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfMar21_12</span>
<a name="ln-9894"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9895"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfMar21_15</span>
<a name="ln-9896"></a>    <span class="k">END IF</span>
<a name="ln-9897"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Month</span> <span class="o">==</span> <span class="mi">6</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DayOfMonth</span> <span class="o">==</span> <span class="mi">21</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-9898"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9899"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfJun21_9</span>
<a name="ln-9900"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">12</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9901"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfJun21_12</span>
<a name="ln-9902"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9903"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfJun21_15</span>
<a name="ln-9904"></a>    <span class="k">END IF</span>
<a name="ln-9905"></a><span class="k">  </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Month</span> <span class="o">==</span> <span class="mi">12</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">DayOfMonth</span> <span class="o">==</span> <span class="mi">21</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-9906"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9907"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfDec21_9</span>
<a name="ln-9908"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">12</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9909"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfDec21_12</span>
<a name="ln-9910"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">HourOfDay</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">TimeStep</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">4</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9911"></a><span class="k">      </span><span class="n">RepCol</span> <span class="o">=</span> <span class="n">pdchSlfDec21_15</span>
<a name="ln-9912"></a>    <span class="k">END IF</span>
<a name="ln-9913"></a><span class="k">  END IF</span>
<a name="ln-9914"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">RepCol</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9915"></a><span class="k">    DO </span><span class="n">SurfNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-9916"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SurfaceClass_Window</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9917"></a><span class="k">        CALL </span><span class="n">PreDefTableEntry</span><span class="p">(</span><span class="n">RepCol</span><span class="p">,</span><span class="n">surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">SurfSunlitFrac</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">))</span>
<a name="ln-9918"></a>      <span class="k">END IF</span>
<a name="ln-9919"></a><span class="k">    END DO</span>
<a name="ln-9920"></a><span class="k">  END IF</span>
<a name="ln-9921"></a><span class="k">  RETURN</span>
<a name="ln-9922"></a>
<a name="ln-9923"></a><span class="k">END SUBROUTINE </span><span class="n">ReportSurfaceShading</span>
<a name="ln-9924"></a>
<a name="ln-9925"></a><span class="k">SUBROUTINE </span><span class="n">ReportSurfaceErrors</span>
<a name="ln-9926"></a>
<a name="ln-9927"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9928"></a>          <span class="c">!       AUTHOR         Linda Lawrie</span>
<a name="ln-9929"></a>          <span class="c">!       DATE WRITTEN   November 2004</span>
<a name="ln-9930"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9931"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9932"></a>
<a name="ln-9933"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9934"></a>          <span class="c">! This subroutine reports some recurring type errors that can get mixed up with more important</span>
<a name="ln-9935"></a>          <span class="c">! errors in the error file.</span>
<a name="ln-9936"></a>
<a name="ln-9937"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9938"></a>          <span class="c">! na</span>
<a name="ln-9939"></a>
<a name="ln-9940"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9941"></a>          <span class="c">! na</span>
<a name="ln-9942"></a>
<a name="ln-9943"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9944"></a>  <span class="k">USE </span><span class="n">DataErrorTracking</span>  <span class="c">! for error tracking</span>
<a name="ln-9945"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-9946"></a>
<a name="ln-9947"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9948"></a>
<a name="ln-9949"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9950"></a>          <span class="c">! na</span>
<a name="ln-9951"></a>
<a name="ln-9952"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9953"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="k">PARAMETER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MSG</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;misses  &#39;</span><span class="p">,</span><span class="s1">&#39;        &#39;</span><span class="p">,</span><span class="s1">&#39;within  &#39;</span><span class="p">,</span><span class="s1">&#39;overlaps&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-9954"></a>
<a name="ln-9955"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9956"></a>          <span class="c">! na</span>
<a name="ln-9957"></a>
<a name="ln-9958"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9959"></a>          <span class="c">! na</span>
<a name="ln-9960"></a>
<a name="ln-9961"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9962"></a>  <span class="kt">INTEGER </span><span class="n">Loop1</span>
<a name="ln-9963"></a>  <span class="kt">INTEGER </span><span class="n">Loop2</span>
<a name="ln-9964"></a>  <span class="kt">INTEGER </span><span class="nb">Count</span>
<a name="ln-9965"></a><span class="nb">  </span><span class="kt">INTEGER </span><span class="n">TotCount</span>
<a name="ln-9966"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span> <span class="n">CountOut</span>
<a name="ln-9967"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SurfErrorReported</span>
<a name="ln-9968"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">SurfErrorReported2</span>
<a name="ln-9969"></a>
<a name="ln-9970"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">NumTooManyFigures</span><span class="o">+</span><span class="n">NumTooManyVertices</span><span class="o">+</span><span class="n">NumBaseSubSurround</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9971"></a><span class="k">    CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9972"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;===== Recurring Surface Error Summary =====&#39;</span><span class="p">)</span>
<a name="ln-9973"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;The following surface error messages occurred.&#39;</span><span class="p">)</span>
<a name="ln-9974"></a>    <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9975"></a>
<a name="ln-9976"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumBaseSubSurround</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9977"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Base Surface does not surround subsurface errors occuring...&#39;</span><span class="p">)</span>
<a name="ln-9978"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Check that the GlobalGeometryRules object is expressing the proper starting corner and &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9979"></a>                     <span class="s1">&#39;direction [CounterClockwise/Clockwise]&#39;</span><span class="p">)</span>
<a name="ln-9980"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9981"></a>    <span class="n">ENDIF</span>
<a name="ln-9982"></a>
<a name="ln-9983"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-9984"></a>    <span class="n">SurfErrorReported</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-9985"></a>    <span class="n">TotCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9986"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumBaseSubSurround</span>
<a name="ln-9987"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-9988"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-9989"></a><span class="k">      DO </span><span class="n">Loop2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumBaseSubSurround</span>
<a name="ln-9990"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="o">==</span> <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-9991"></a>            <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">MiscIndex</span> <span class="o">==</span> <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">MiscIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9992"></a><span class="k">          </span><span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9993"></a>        <span class="n">ENDIF</span>
<a name="ln-9994"></a>      <span class="n">ENDDO</span>
<a name="ln-9995"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CountOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">Count</span>
<a name="ln-9996"></a><span class="nb">      </span><span class="n">TotCount</span><span class="o">=</span><span class="n">TotCount</span><span class="o">+</span><span class="nb">Count</span>
<a name="ln-9997"></a><span class="nb">      </span><span class="n">TotalWarningErrors</span><span class="o">=</span><span class="n">TotalWarningErrors</span><span class="o">+</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-9998"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Base surface does not surround subsurface (CHKSBS), Overlap Status=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9999"></a>                             <span class="nb">TRIM</span><span class="p">(</span><span class="n">cOverLapStatus</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">MiscIndex</span><span class="p">)))</span>
<a name="ln-10000"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The base surround errors occurred &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CountOut</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-10001"></a>      <span class="k">DO </span><span class="n">Loop2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumBaseSubSurround</span>
<a name="ln-10002"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="o">==</span> <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-10003"></a>            <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">MiscIndex</span> <span class="o">==</span> <span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">MiscIndex</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10004"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Surface &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10005"></a>                                 <span class="s1">&#39;&quot; &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">MSG</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">MiscIndex</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10006"></a>                                 <span class="s1">&#39; SubSurface &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-10007"></a>        <span class="n">ENDIF</span>
<a name="ln-10008"></a>      <span class="n">ENDDO</span>
<a name="ln-10009"></a>      <span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TrackBaseSubSurround</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10010"></a>    <span class="n">ENDDO</span>
<a name="ln-10011"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10012"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10013"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CountOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">TotCount</span>
<a name="ln-10014"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The base surround errors occurred &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CountOut</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times (total).&#39;</span><span class="p">)</span>
<a name="ln-10015"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10016"></a>    <span class="n">ENDIF</span>
<a name="ln-10017"></a>
<a name="ln-10018"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">SurfErrorReported2</span><span class="p">(</span><span class="n">TotSurfaces</span><span class="p">))</span>
<a name="ln-10019"></a>    <span class="n">SurfErrorReported</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10020"></a>    <span class="n">TotCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10021"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumTooManyVertices</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10022"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Too many vertices [&gt;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10023"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCV</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] in shadow overlap errors occurring...&#39;</span><span class="p">)</span>
<a name="ln-10024"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;These occur throughout the year and may occur several times for the same surfaces. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10025"></a>                     <span class="s1">&#39;You may be able to reduce them by adding Output:Diagnostics,DoNotMirrorDetachedShading;&#39;</span><span class="p">)</span>
<a name="ln-10026"></a>    <span class="n">ENDIF</span>
<a name="ln-10027"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumTooManyVertices</span>
<a name="ln-10028"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10029"></a>      <span class="n">SurfErrorReported2</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10030"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-10031"></a><span class="k">      DO </span><span class="n">Loop2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumTooManyVertices</span>
<a name="ln-10032"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="o">==</span> <span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10033"></a><span class="k">          </span><span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10034"></a>        <span class="n">ENDIF</span>
<a name="ln-10035"></a>      <span class="n">ENDDO</span>
<a name="ln-10036"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CountOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">Count</span>
<a name="ln-10037"></a><span class="nb">      </span><span class="n">TotCount</span><span class="o">=</span><span class="n">TotCount</span><span class="o">+</span><span class="nb">Count</span>
<a name="ln-10038"></a><span class="nb">      </span><span class="n">TotalWarningErrors</span><span class="o">=</span><span class="n">TotalWarningErrors</span><span class="o">+</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-10039"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10040"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Too many vertices [&gt;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10041"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCV</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] in a shadow overlap&#39;</span><span class="p">)</span>
<a name="ln-10042"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Overlapping figure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10043"></a>                             <span class="s1">&#39;, Surface Class=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)%</span><span class="k">Class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-10044"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  This error occurred &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CountOut</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-10045"></a>      <span class="k">DO </span><span class="n">Loop2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumTooManyVertices</span>
<a name="ln-10046"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="o">==</span> <span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10047"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfErrorReported2</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-10048"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Figure being Overlapped=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10049"></a>                       <span class="s1">&#39;, Surface Class=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)%</span><span class="k">Class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-10050"></a>          <span class="n">SurfErrorReported2</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10051"></a>        <span class="n">ENDIF</span>
<a name="ln-10052"></a>      <span class="n">ENDDO</span>
<a name="ln-10053"></a>      <span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TrackTooManyVertices</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10054"></a>    <span class="n">ENDDO</span>
<a name="ln-10055"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10056"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10057"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CountOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">TotCount</span>
<a name="ln-10058"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The too many vertices errors occurred &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CountOut</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times (total).&#39;</span><span class="p">)</span>
<a name="ln-10059"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10060"></a>    <span class="n">ENDIF</span>
<a name="ln-10061"></a>
<a name="ln-10062"></a>    <span class="n">SurfErrorReported</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10063"></a>    <span class="n">TotCount</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10064"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumTooManyFigures</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10065"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;Too many figures [&gt;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10066"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] in shadow overlap errors occurring...&#39;</span><span class="p">)</span>
<a name="ln-10067"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39;These occur throughout the year and may occur several times for the same surfaces. &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10068"></a>                     <span class="s1">&#39;You may be able to reduce them by adding OutputDiagnostics,DoNotMirrorDetachedShading;&#39;</span><span class="p">)</span>
<a name="ln-10069"></a>    <span class="n">ENDIF</span>
<a name="ln-10070"></a>    <span class="k">DO </span><span class="n">Loop1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumTooManyFigures</span>
<a name="ln-10071"></a>      <span class="nb">Count</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-10072"></a>      <span class="n">SurfErrorReported2</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-10073"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-10074"></a><span class="k">      DO </span><span class="n">Loop2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumTooManyFigures</span>
<a name="ln-10075"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="o">==</span> <span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10076"></a><span class="k">          </span><span class="nb">Count</span><span class="o">=</span><span class="nb">Count</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-10077"></a>        <span class="n">ENDIF</span>
<a name="ln-10078"></a>      <span class="n">ENDDO</span>
<a name="ln-10079"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CountOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="nb">Count</span>
<a name="ln-10080"></a><span class="nb">      </span><span class="n">TotCount</span><span class="o">=</span><span class="n">TotCount</span><span class="o">+</span><span class="nb">Count</span>
<a name="ln-10081"></a><span class="nb">      </span><span class="n">TotalWarningErrors</span><span class="o">=</span><span class="n">TotalWarningErrors</span><span class="o">+</span><span class="nb">Count</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-10082"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10083"></a>      <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Too many figures [&gt;=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10084"></a>          <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHCS</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;] in a shadow overlap&#39;</span><span class="p">)</span>
<a name="ln-10085"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Overlapping figure=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10086"></a>                             <span class="s1">&#39;, Surface Class=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)%</span><span class="k">Class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-10087"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  This error occurred &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CountOut</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times.&#39;</span><span class="p">)</span>
<a name="ln-10088"></a>      <span class="k">DO </span><span class="n">Loop2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumTooManyFigures</span>
<a name="ln-10089"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span> <span class="o">==</span> <span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10090"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SurfErrorReported2</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">))</span> <span class="k">CYCLE</span>
<a name="ln-10091"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Figure being Overlapped=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-10092"></a>                       <span class="s1">&#39;, Surface Class=[&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cSurfaceClass</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)%</span><span class="k">Class</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]&#39;</span><span class="p">)</span>
<a name="ln-10093"></a>          <span class="n">SurfErrorReported2</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop2</span><span class="p">)%</span><span class="n">SurfIndex2</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10094"></a>        <span class="n">ENDIF</span>
<a name="ln-10095"></a>      <span class="n">ENDDO</span>
<a name="ln-10096"></a>      <span class="n">SurfErrorReported</span><span class="p">(</span><span class="n">TrackTooManyFigures</span><span class="p">(</span><span class="n">Loop1</span><span class="p">)%</span><span class="n">SurfIndex1</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-10097"></a>    <span class="n">ENDDO</span>
<a name="ln-10098"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">TotCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10099"></a><span class="k">      CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10100"></a>      <span class="k">WRITE</span><span class="p">(</span><span class="n">CountOut</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">TotCount</span>
<a name="ln-10101"></a>      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The too many figures errors occurred &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="nb">ADJUSTL</span><span class="p">(</span><span class="n">CountOut</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; times (total).&#39;</span><span class="p">)</span>
<a name="ln-10102"></a>      <span class="k">CALL </span><span class="n">ShowMessage</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-10103"></a>    <span class="n">ENDIF</span>
<a name="ln-10104"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SurfErrorReported</span><span class="p">)</span>
<a name="ln-10105"></a>    <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">SurfErrorReported2</span><span class="p">)</span>
<a name="ln-10106"></a>  <span class="n">ENDIF</span>
<a name="ln-10107"></a>
<a name="ln-10108"></a>  <span class="k">RETURN</span>
<a name="ln-10109"></a>
<a name="ln-10110"></a><span class="k">END SUBROUTINE </span><span class="n">ReportSurfaceErrors</span>
<a name="ln-10111"></a>
<a name="ln-10112"></a><span class="k">SUBROUTINE </span><span class="n">ComputeWinShadeAbsorpFactors</span>
<a name="ln-10113"></a>
<a name="ln-10114"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10115"></a>          <span class="c">!       AUTHOR         Fred Winkelmann</span>
<a name="ln-10116"></a>          <span class="c">!       DATE WRITTEN   Mar 2001</span>
<a name="ln-10117"></a>          <span class="c">!       MODIFIED       Oct 2002,FCW: change ConstrNumSh = WindowShadingControl(WinShadeCtrlNum)%ShadedConstruction</span>
<a name="ln-10118"></a>          <span class="c">!                      to Surface(SurfNum)%ShadedConstruction</span>
<a name="ln-10119"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10120"></a>
<a name="ln-10121"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10122"></a>          <span class="c">! Called by InitSolarCalculations. Finds fractions that apportion radiation absorbed by a</span>
<a name="ln-10123"></a>          <span class="c">! window shade to the two faces of the shade. For radiation incident from the left,</span>
<a name="ln-10124"></a>          <span class="c">! ShadeAbsFacFace(1) is the fraction of radiation absorbed in the left-hand half of the</span>
<a name="ln-10125"></a>          <span class="c">! of the shade and ShadeAbsFacFace(2) is the fraction absorbed in the right-hand half.</span>
<a name="ln-10126"></a>          <span class="c">! The shade is assumed to be homogeneous.</span>
<a name="ln-10127"></a>
<a name="ln-10128"></a>          <span class="c">! REFERENCES: See EnergyPlus engineering documentation</span>
<a name="ln-10129"></a>          <span class="c">! USE STATEMENTS: na</span>
<a name="ln-10130"></a>
<a name="ln-10131"></a><span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10132"></a>
<a name="ln-10133"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS: na</span>
<a name="ln-10134"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS: na</span>
<a name="ln-10135"></a>          <span class="c">! DERIVED TYPE DEFINITIONS: na</span>
<a name="ln-10136"></a>
<a name="ln-10137"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10138"></a>
<a name="ln-10139"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">WinShadeCtrlNum</span>   <span class="c">! Window shading control number</span>
<a name="ln-10140"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SurfNum</span>           <span class="c">! Surface number</span>
<a name="ln-10141"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">ConstrNumSh</span>       <span class="c">! Window construction number with shade</span>
<a name="ln-10142"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">TotLay</span>            <span class="c">! Total layers in a construction</span>
<a name="ln-10143"></a><span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">MatNumSh</span>          <span class="c">! Shade layer material number</span>
<a name="ln-10144"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">AbsorpEff</span>         <span class="c">! Effective absorptance of isolated shade layer (fraction of</span>
<a name="ln-10145"></a>                                        <span class="c">!  of incident radiation remaining after reflected portion is</span>
<a name="ln-10146"></a>                                        <span class="c">!  removed that is absorbed</span>
<a name="ln-10147"></a><span class="k">DO </span><span class="n">SurfNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotSurfaces</span>
<a name="ln-10148"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10149"></a><span class="k">    </span><span class="n">WinShadeCtrlNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">WindowShadingControlPtr</span>
<a name="ln-10150"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadeCtrlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorShade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10151"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadeCtrlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorShade</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10152"></a>       <span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadeCtrlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10153"></a><span class="k">      </span><span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-10154"></a>      <span class="n">TotLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-10155"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadeCtrlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_InteriorShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10156"></a><span class="k">        </span><span class="n">MatNumSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="n">TotLay</span><span class="p">)</span>  <span class="c">! Interior shade</span>
<a name="ln-10157"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadeCtrlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_ExteriorShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10158"></a><span class="k">        </span><span class="n">MatNumSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>       <span class="c">! Exterior shade</span>
<a name="ln-10159"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">WindowShadingControl</span><span class="p">(</span><span class="n">WinShadeCtrlNum</span><span class="p">)%</span><span class="n">ShadingType</span> <span class="o">==</span> <span class="n">WSC_ST_BetweenGlassShade</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10160"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotGlassLayers</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10161"></a><span class="k">          </span><span class="n">MatNumSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c">! Double pane with between-glass shade</span>
<a name="ln-10162"></a>        <span class="k">ELSE</span>
<a name="ln-10163"></a><span class="k">          </span><span class="n">MatNumSh</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">LayerPoint</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>   <span class="c">! Triple pane with between-glass shade</span>
<a name="ln-10164"></a>        <span class="k">END IF</span>
<a name="ln-10165"></a><span class="k">      END IF</span>
<a name="ln-10166"></a><span class="k">      </span><span class="n">AbsorpEff</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatNumSh</span><span class="p">)%</span><span class="n">AbsorpSolar</span><span class="o">/</span><span class="p">(</span><span class="n">Material</span><span class="p">(</span><span class="n">MatNumSh</span><span class="p">)%</span><span class="n">AbsorpSolar</span> <span class="o">+</span> <span class="n">Material</span><span class="p">(</span><span class="n">MatNumSh</span><span class="p">)%</span><span class="n">Trans</span> <span class="o">+</span> <span class="mf">0.0001d0</span><span class="p">)</span>
<a name="ln-10167"></a>      <span class="n">AbsorpEff</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="nb">MAX</span><span class="p">(</span><span class="n">AbsorpEff</span><span class="p">,</span><span class="mf">0.0001d0</span><span class="p">),</span><span class="mf">0.999d0</span><span class="p">)</span> <span class="c">! Constrain to avoid problems with following log eval</span>
<a name="ln-10168"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadeAbsFacFace</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">*</span><span class="nb">LOG</span><span class="p">(</span><span class="mf">1.0d0</span><span class="o">-</span><span class="n">AbsorpEff</span><span class="p">)))</span><span class="o">/</span><span class="n">AbsorpEff</span>
<a name="ln-10169"></a>      <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadeAbsFacFace</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span> <span class="o">-</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">SurfNum</span><span class="p">)%</span><span class="n">ShadeAbsFacFace</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10170"></a>    <span class="k">END IF</span>
<a name="ln-10171"></a><span class="k">  END IF</span>
<a name="ln-10172"></a><span class="k">END DO</span>
<a name="ln-10173"></a>
<a name="ln-10174"></a><span class="k">END SUBROUTINE </span><span class="n">ComputeWinShadeAbsorpFactors</span>
<a name="ln-10175"></a>
<a name="ln-10176"></a><span class="k">SUBROUTINE </span><span class="n">CalcWinTransDifSolInitialDistribution</span>
<a name="ln-10177"></a>
<a name="ln-10178"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10179"></a>          <span class="c">!       AUTHOR         Rob Hitchcock</span>
<a name="ln-10180"></a>          <span class="c">!       DATE WRITTEN   July 2007</span>
<a name="ln-10181"></a>          <span class="c">!       MODIFIED       N/A</span>
<a name="ln-10182"></a>          <span class="c">!       RE-ENGINEERED  N/A</span>
<a name="ln-10183"></a>
<a name="ln-10184"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10185"></a>          <span class="c">! This subroutine calculates the initial distribution</span>
<a name="ln-10186"></a>          <span class="c">! of diffuse solar transmitted through exterior windows</span>
<a name="ln-10187"></a>          <span class="c">! to individual heat transfer surfaces in each zone.</span>
<a name="ln-10188"></a>
<a name="ln-10189"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10190"></a>          <span class="c">! Apportions diffuse solar transmitted through each exterior window</span>
<a name="ln-10191"></a>          <span class="c">! that is then absorbed, reflected, and/or transmitted</span>
<a name="ln-10192"></a>          <span class="c">! by other heat transfer surfaces in the zone.</span>
<a name="ln-10193"></a>          <span class="c">! Calculations use:</span>
<a name="ln-10194"></a>          <span class="c">! 1. WinDifSolar calculated in SUBROUTINE CalcInteriorSolarDistribution,</span>
<a name="ln-10195"></a>          <span class="c">! 2. view factors between each exterior window and</span>
<a name="ln-10196"></a>          <span class="c">! other heat transfer surfaces in a zone</span>
<a name="ln-10197"></a>          <span class="c">! calculated in SUBROUTINE CalcApproximateViewFactors, and</span>
<a name="ln-10198"></a>          <span class="c">! 3. surface absorptances, reflectances, and transmittances</span>
<a name="ln-10199"></a>          <span class="c">! determined here using revised code from SUBROUTINE InitIntSolarDistribution</span>
<a name="ln-10200"></a>
<a name="ln-10201"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10202"></a>
<a name="ln-10203"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10204"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InterpSw</span><span class="p">,</span> <span class="n">InterpSlatAng</span>
<a name="ln-10205"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-10206"></a>  <span class="k">USE </span><span class="n">DataViewFactorInformation</span>
<a name="ln-10207"></a>
<a name="ln-10208"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitialDifSolInAbs</span><span class="p">,</span> <span class="n">InitialDifSolInTrans</span>
<a name="ln-10209"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitialDifSolwinAbs</span><span class="p">,</span> <span class="n">InitialZoneDifSolReflW</span>
<a name="ln-10210"></a>
<a name="ln-10211"></a>  <span class="k">USE </span><span class="n">WindowEquivalentLayer</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CalcEQLOpticalProperty</span>
<a name="ln-10212"></a>  <span class="k">USE </span><span class="n">DataWindowEquivalentLayer</span>
<a name="ln-10213"></a>
<a name="ln-10214"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10215"></a>
<a name="ln-10216"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10217"></a>          <span class="c">! na</span>
<a name="ln-10218"></a>
<a name="ln-10219"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10220"></a>          <span class="c">! na</span>
<a name="ln-10221"></a>
<a name="ln-10222"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10223"></a>          <span class="c">! na</span>
<a name="ln-10224"></a>
<a name="ln-10225"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10226"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! DO loop counter for zones</span>
<a name="ln-10227"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AdjZoneNum</span>         <span class="c">! Index for adjacent zones</span>
<a name="ln-10228"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AdjSurfNum</span>         <span class="c">! Index for adjacent surfaces</span>
<a name="ln-10229"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">DifTransSurfNum</span>    <span class="c">! Diffuse Solar Transmitting Surface number</span>
<a name="ln-10230"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatTransSurfNum</span>   <span class="c">! Heat Transfer Surface number</span>
<a name="ln-10231"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>          <span class="c">! Construction number</span>
<a name="ln-10232"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AdjConstrNum</span>       <span class="c">! Construction number of other side surface</span>
<a name="ln-10233"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumSh</span>        <span class="c">! Shaded construction number</span>
<a name="ln-10234"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IGlass</span>             <span class="c">! Glass layer counter</span>
<a name="ln-10235"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotGlassLayers</span>     <span class="c">! Number of glass layers in a window construction</span>
<a name="ln-10236"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShadeFlag</span>          <span class="c">! Shading flag</span>
<a name="ln-10237"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AbsInt</span>             <span class="c">! Tmp var for Inside surface short-wave absorptance</span>
<a name="ln-10238"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MovInsulSchedVal</span>   <span class="c">! Value of the movable insulation schedule for current time</span>
<a name="ln-10239"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HMovInsul</span>          <span class="c">! Conductance of movable insulation</span>
<a name="ln-10240"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InsideDifAbsorptance</span> <span class="c">! Inside diffuse solar absorptance of a surface</span>
<a name="ln-10241"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InsideDifReflectance</span> <span class="c">! Inside diffuse solar reflectance of a surface</span>
<a name="ln-10242"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BlNum</span>              <span class="c">! Blind number</span>
<a name="ln-10243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BlAbsDiffBk</span>        <span class="c">! Glass layer back diffuse solar absorptance when blind in place</span>
<a name="ln-10244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AbsDiffBkBl</span>        <span class="c">! Blind diffuse back solar absorptance as part of glazing system</span>
<a name="ln-10245"></a>
<a name="ln-10246"></a><span class="c">!  REAL(r64)    :: DividerSolAbs      ! Window divider solar absorptance</span>
<a name="ln-10247"></a><span class="c">!  REAL(r64)    :: DividerSolRefl     ! Window divider solar reflectance</span>
<a name="ln-10248"></a><span class="c">!  INTEGER :: MatNumGl           ! Glass layer material number</span>
<a name="ln-10249"></a><span class="c">!  INTEGER :: MatNumSh           ! Shade layer material number</span>
<a name="ln-10250"></a><span class="c">!  REAL(r64)    :: TransGl,ReflGl,AbsGl ! Glass layer solar transmittance, reflectance, absorptance</span>
<a name="ln-10251"></a>
<a name="ln-10252"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ViewFactor</span>         <span class="c">! temp var for view factor</span>
<a name="ln-10253"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ViewFactorTotal</span>    <span class="c">! debug var for view factor total</span>
<a name="ln-10254"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarTrans</span>   <span class="c">! debug var for WinDifSolar() [W]</span>
<a name="ln-10255"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistTotl</span>    <span class="c">! debug var for window total distributed diffuse solar [W]</span>
<a name="ln-10256"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistAbsorbedTotl</span>    <span class="c">! debug var for individual exterior window total distributed</span>
<a name="ln-10257"></a>                                            <span class="c">!    diffuse solar absorbed [W]</span>
<a name="ln-10258"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistReflectedTotl</span>   <span class="c">! debug var for individual exterior window total distributed</span>
<a name="ln-10259"></a>                                            <span class="c">!    diffuse solar reflected [W]</span>
<a name="ln-10260"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="c">! debug var for individual exterior window total distributed</span>
<a name="ln-10261"></a>                                            <span class="c">!    diffuse solar transmitted [W]</span>
<a name="ln-10262"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolLayAbsW</span>   <span class="c">! temp var for diffuse solar absorbed by individual glass layer [W]</span>
<a name="ln-10263"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarTrans</span>   <span class="c">! debug var for WinDifSolar() [W]</span>
<a name="ln-10264"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistTotl</span>    <span class="c">! debug var for zone total distributed diffuse solar [W]</span>
<a name="ln-10265"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span>    <span class="c">! debug var for zone total distributed diffuse solar absorbed [W]</span>
<a name="ln-10266"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistReflectedTotl</span>   <span class="c">! debug var for zone total distributed diffuse solar reflected [W]</span>
<a name="ln-10267"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="c">! debug var for zone total distributed diffuse solar transmitted [W]</span>
<a name="ln-10268"></a>
<a name="ln-10269"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarAbsW</span>       <span class="c">! temp var for diffuse solar absorbed by surface [W]</span>
<a name="ln-10270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarAbs</span>        <span class="c">! temp var for diffuse solar absorbed by surface [W/m2]</span>
<a name="ln-10271"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarReflW</span>      <span class="c">! temp var for diffuse solar reflected by surface [W]</span>
<a name="ln-10272"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarTransW</span>     <span class="c">! temp var for diffuse solar transmitted through interior window surface [W]</span>
<a name="ln-10273"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ShBlDifSolarAbsW</span>   <span class="c">! temp var for diffuse solar absorbed by shade/blind [W]</span>
<a name="ln-10274"></a>
<a name="ln-10275"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolBeamEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c">! absorbed exterior beam radiation by layers fraction</span>
<a name="ln-10276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolDiffEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c">! absorbed exterior diffuse radiation by layers fraction</span>
<a name="ln-10277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolBeamBackEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c">! absorbed interior beam radiation by layers fraction from back</span>
<a name="ln-10278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AbsSolDiffBackEQL</span><span class="p">(</span><span class="n">CFSMAXNL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c">! absorbed exterior diffuse radiation by layers fraction from back</span>
<a name="ln-10279"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">EQLNum</span>                      <span class="c">! equivalent layer fenestration index</span>
<a name="ln-10280"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">Lay</span>                         <span class="c">! equivalent layer fenestration layer index</span>
<a name="ln-10281"></a>
<a name="ln-10282"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FirstZoneSurf</span>      <span class="c">! conversion index for ViewFactor</span>
<a name="ln-10283"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LastZoneSurf</span>       <span class="c">! debug</span>
<a name="ln-10284"></a>
<a name="ln-10285"></a>  <span class="c">! Init accumulators for absorbed diffuse solar for all surfaces for later heat balance calcs</span>
<a name="ln-10286"></a>  <span class="n">InitialDifSolInAbs</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10287"></a>  <span class="n">InitialDifSolwinAbs</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10288"></a>
<a name="ln-10289"></a>  <span class="c">! Init accumulator for total reflected diffuse solar within each zone for interreflection calcs</span>
<a name="ln-10290"></a>  <span class="n">InitialZoneDifSolReflW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10291"></a>
<a name="ln-10292"></a>  <span class="c">! Init accumulator for transmitted diffuse solar for all surfaces for reporting</span>
<a name="ln-10293"></a>  <span class="n">InitialDifSolInTrans</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10294"></a>
<a name="ln-10295"></a>  <span class="c">! Loop over all zones doing initial distribution of diffuse solar to interior heat transfer surfaces</span>
<a name="ln-10296"></a>  <span class="k">DO </span><span class="n">ZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfZones</span>
<a name="ln-10297"></a>
<a name="ln-10298"></a>    <span class="c">! Init Zone accumulators for debugging</span>
<a name="ln-10299"></a>    <span class="n">ZoneDifSolarTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10300"></a>    <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10301"></a>    <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10302"></a>    <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10303"></a>
<a name="ln-10304"></a>    <span class="c">! Loop over all diffuse solar transmitting surfaces (i.e., exterior windows and TDDs) in the current zone</span>
<a name="ln-10305"></a>    <span class="n">FirstZoneSurf</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span>
<a name="ln-10306"></a>    <span class="n">LastZoneSurf</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10307"></a>    <span class="k">DO </span><span class="n">DifTransSurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10308"></a>      <span class="c">! Skip surfaces that are not exterior, except for TDD_Diffusers</span>
<a name="ln-10309"></a>      <span class="k">IF</span> <span class="p">(((</span><span class="n">Surface</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">ExternalEnvironment</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10310"></a>            <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span> <span class="o">/=</span> <span class="n">OtherSideCondModeledExt</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10311"></a>           <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10312"></a>
<a name="ln-10313"></a>      <span class="c">! Do I need to do anything special for TDDs?</span>
<a name="ln-10314"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10315"></a><span class="k">      END IF</span>
<a name="ln-10316"></a>
<a name="ln-10317"></a>      <span class="c">! Skip surfaces that are not exterior windows or TDD diffusers</span>
<a name="ln-10318"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">/=</span> <span class="n">SurfaceClass_Window</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10319"></a>          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)%</span><span class="n">OriginalClass</span> <span class="o">/=</span> <span class="n">SurfaceClass_TDD_Diffuser</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10320"></a>
<a name="ln-10321"></a>      <span class="c">!----------------------------------------------------------------------------------------------------------</span>
<a name="ln-10322"></a>      <span class="c">! DISTRIBUTE TRANSMITTED DIFFUSE SOLAR THROUGH EXTERIOR WINDOWS AND TDDS TO INTERIOR HEAT TRANSFER SURFACES</span>
<a name="ln-10323"></a>      <span class="c">!----------------------------------------------------------------------------------------------------------</span>
<a name="ln-10324"></a>
<a name="ln-10325"></a>      <span class="c">! Init transmitted solar debug vars</span>
<a name="ln-10326"></a>      <span class="n">ViewFactorTotal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10327"></a>      <span class="n">WinDifSolarTrans</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span>
<a name="ln-10328"></a>      <span class="n">ZoneDifSolarTrans</span> <span class="o">=</span> <span class="n">ZoneDifSolarTrans</span> <span class="o">+</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span>
<a name="ln-10329"></a>
<a name="ln-10330"></a>      <span class="c">! Init Exterior Window accumulators for debugging</span>
<a name="ln-10331"></a>      <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10332"></a>      <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10333"></a>      <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10334"></a>
<a name="ln-10335"></a>      <span class="c">! Loop over all heat transfer surfaces in the current zone that might receive diffuse solar</span>
<a name="ln-10336"></a>      <span class="k">DO </span><span class="n">HeatTransSurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10337"></a>        <span class="c">! Skip surfaces that are not heat transfer surfaces</span>
<a name="ln-10338"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10339"></a>        <span class="c">! Skip tubular daylighting device domes</span>
<a name="ln-10340"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10341"></a>
<a name="ln-10342"></a>        <span class="c">! View factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10343"></a>        <span class="n">ViewFactor</span> <span class="o">=</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">F</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="o">-</span><span class="n">FirstZoneSurf</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">HeatTransSurfNum</span><span class="o">-</span><span class="n">FirstZoneSurf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10344"></a>        <span class="c">! debug ViewFactorTotal</span>
<a name="ln-10345"></a>        <span class="n">ViewFactorTotal</span> <span class="o">=</span> <span class="n">ViewFactorTotal</span> <span class="o">+</span> <span class="n">ViewFactor</span>  <span class="c">! debug</span>
<a name="ln-10346"></a>
<a name="ln-10347"></a>        <span class="c">! Skip receiving surfaces with 0.0 view factor</span>
<a name="ln-10348"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ViewFactor</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10349"></a>
<a name="ln-10350"></a>        <span class="c">! Calculate diffuse solar from current exterior window absorbed and reflected by current heat transfer surface</span>
<a name="ln-10351"></a>        <span class="c">! And calculate transmitted diffuse solar to adjacent zones through interior windows</span>
<a name="ln-10352"></a>        <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10353"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Interior Opaque Surface</span>
<a name="ln-10354"></a>
<a name="ln-10355"></a>          <span class="c">! Determine the inside (back) diffuse solar absorptance</span>
<a name="ln-10356"></a>          <span class="c">! and reflectance of the current heat transfer surface</span>
<a name="ln-10357"></a>          <span class="n">InsideDifAbsorptance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>
<a name="ln-10358"></a>          <span class="c">! Check for movable insulation; reproduce code from subr. EvalInsideMovableInsulation;</span>
<a name="ln-10359"></a>          <span class="c">! Can&#39;t call that routine here since cycle prevents SolarShadingGeometry from USEing</span>
<a name="ln-10360"></a>          <span class="c">! HeatBalanceSurfaceManager, which contains EvalInsideMovableInsulation</span>
<a name="ln-10361"></a>          <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10362"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10363"></a><span class="k">            </span><span class="n">MovInsulSchedVal</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span><span class="p">)</span>
<a name="ln-10364"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Movable insulation not present at current time</span>
<a name="ln-10365"></a>              <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10366"></a>            <span class="k">ELSE</span>  <span class="c">! Movable insulation present</span>
<a name="ln-10367"></a>              <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">Resistance</span><span class="p">)</span>
<a name="ln-10368"></a>              <span class="n">AbsInt</span>    <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">AbsorpSolar</span>
<a name="ln-10369"></a>            <span class="k">END IF</span>
<a name="ln-10370"></a><span class="k">          END IF</span>
<a name="ln-10371"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">InsideDifAbsorptance</span> <span class="o">=</span> <span class="n">AbsInt</span>  <span class="c">! Movable inside insulation present</span>
<a name="ln-10372"></a>          <span class="c">! Inside (back) diffuse solar reflectance is assumed to be 1 - absorptance</span>
<a name="ln-10373"></a>          <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">InsideDifAbsorptance</span>
<a name="ln-10374"></a>
<a name="ln-10375"></a>          <span class="c">! Absorbed diffuse solar [W] = current window transmitted diffuse solar [W]</span>
<a name="ln-10376"></a>          <span class="c">!    * view factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10377"></a>          <span class="c">!    * current surface inside solar absorptance</span>
<a name="ln-10378"></a>          <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! [W]</span>
<a name="ln-10379"></a>                          <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10380"></a>                          <span class="o">*</span> <span class="n">InsideDifAbsorptance</span>
<a name="ln-10381"></a>
<a name="ln-10382"></a>          <span class="c">! Absorbed diffuse solar [W/m2] = Absorbed diffuse solar [W]</span>
<a name="ln-10383"></a>          <span class="c">!                                 / current surface net area</span>
<a name="ln-10384"></a>          <span class="n">DifSolarAbs</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-10385"></a>                         <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-10386"></a>
<a name="ln-10387"></a>          <span class="c">! Accumulate absorbed diffuse solar [W/m2] on this surface for heat balance calcs</span>
<a name="ln-10388"></a>          <span class="n">InitialDifSolInAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10389"></a>                                                  <span class="o">+</span> <span class="n">DifSolarAbs</span>
<a name="ln-10390"></a>
<a name="ln-10391"></a>          <span class="c">! Reflected diffuse solar [W] = current window transmitted diffuse solar</span>
<a name="ln-10392"></a>          <span class="c">!    * view factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10393"></a>          <span class="c">!    * current window inside solar reflectance</span>
<a name="ln-10394"></a>          <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10395"></a>                          <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10396"></a>                          <span class="o">*</span> <span class="n">InsideDifReflectance</span>
<a name="ln-10397"></a>
<a name="ln-10398"></a>          <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-10399"></a>          <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10400"></a>                                                   <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-10401"></a>
<a name="ln-10402"></a>          <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10403"></a>          <span class="c">! For opaque surfaces all incident diffuse is either absorbed or reflected</span>
<a name="ln-10404"></a>          <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">DifSolarAbsW</span>  <span class="c">! debug [W]</span>
<a name="ln-10405"></a>          <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug [W]</span>
<a name="ln-10406"></a>          <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">DifSolarAbsW</span>  <span class="c">! debug [W]</span>
<a name="ln-10407"></a>          <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug [W]</span>
<a name="ln-10408"></a>
<a name="ln-10409"></a>        <span class="k">ELSE</span>  <span class="c">! Exterior or Interior Window</span>
<a name="ln-10410"></a>
<a name="ln-10411"></a>          <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-10412"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10413"></a><span class="k">            </span><span class="n">ConstrNum</span>   <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-10414"></a>            <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span>
<a name="ln-10415"></a>          <span class="k">END IF</span>
<a name="ln-10416"></a><span class="k">          </span><span class="n">TotGlassLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-10417"></a>          <span class="n">ShadeFlag</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span>
<a name="ln-10418"></a>
<a name="ln-10419"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">/=</span> <span class="n">WindowEQLModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10420"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! No window shading</span>
<a name="ln-10421"></a>                <span class="c">! Init accumulator for transmittance calc below</span>
<a name="ln-10422"></a>                <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10423"></a>
<a name="ln-10424"></a>                <span class="c">! Calc diffuse solar absorbed by all window glass layers</span>
<a name="ln-10425"></a>                <span class="c">! Note: I am assuming here that individual glass layer absorptances have been corrected</span>
<a name="ln-10426"></a>                <span class="c">!       to account for layer by layer transmittance and reflection effects.</span>
<a name="ln-10427"></a>                <span class="k">DO </span><span class="n">IGlass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotGlassLayers</span>
<a name="ln-10428"></a>                  <span class="c">! Calc diffuse solar absorbed from the inside by each window glass layer [W]</span>
<a name="ln-10429"></a>                  <span class="n">AbsInt</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">)</span>
<a name="ln-10430"></a>                  <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">)</span>
<a name="ln-10431"></a>
<a name="ln-10432"></a>                  <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-10433"></a>                  <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-10434"></a>
<a name="ln-10435"></a>                  <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10436"></a>                  <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10437"></a>                  <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10438"></a>
<a name="ln-10439"></a>                  <span class="c">! Accumulate diffuse solar absorbed from the inside by each window glass layer [W/m2] for heat balance calcs</span>
<a name="ln-10440"></a>                  <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10441"></a>                                                             <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-10442"></a>                                                             <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10443"></a>                <span class="k">END DO</span>
<a name="ln-10444"></a>
<a name="ln-10445"></a>                <span class="c">! Calc diffuse solar reflected back to zone</span>
<a name="ln-10446"></a>                <span class="c">! I don&#39;t really care if this is a window or opaque surface since I am just</span>
<a name="ln-10447"></a>                <span class="c">! accumulating all reflected diffuse solar in a zone bucket for &quot;interreflected&quot; distribution</span>
<a name="ln-10448"></a>                <span class="c">! Reflected diffuse solar [W] = current window transmitted diffuse solar</span>
<a name="ln-10449"></a>                <span class="c">!    * view factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10450"></a>                <span class="c">!    * current window inside solar reflectance</span>
<a name="ln-10451"></a>                <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-10452"></a>                <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10453"></a>                                <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10454"></a>                                <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-10455"></a>
<a name="ln-10456"></a>                <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-10457"></a>                <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10458"></a>                                              <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-10459"></a>
<a name="ln-10460"></a>                <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10461"></a>                <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10462"></a>                <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10463"></a>
<a name="ln-10464"></a>                <span class="c">!------------------------------------------------------------------------------</span>
<a name="ln-10465"></a>                <span class="c">! DISTRIBUTE TRANSMITTED DIFFUSE SOLAR THROUGH INTERIOR WINDOW TO ADJACENT ZONE</span>
<a name="ln-10466"></a>                <span class="c">!------------------------------------------------------------------------------</span>
<a name="ln-10467"></a>
<a name="ln-10468"></a>                <span class="c">! If this receiving window surface (HeatTransSurfNum) is an interior window,</span>
<a name="ln-10469"></a>                <span class="c">! calc distributed solar transmitted to adjacent zone [W]</span>
<a name="ln-10470"></a>                <span class="c">! NOTE: This calc is here because interior windows are currently assumed to have no shading</span>
<a name="ln-10471"></a>
<a name="ln-10472"></a>                <span class="c">! Get the adjacent surface number for this receiving window surface</span>
<a name="ln-10473"></a>                <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-10474"></a>                <span class="c">! If the adjacent surface number is &gt; 0, this is an interior window</span>
<a name="ln-10475"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! this is an interior window surface</span>
<a name="ln-10476"></a>
<a name="ln-10477"></a>                  <span class="c">! Calc diffuse solar from current exterior window</span>
<a name="ln-10478"></a>                  <span class="c">! transmitted through this interior window to adjacent zone [W]</span>
<a name="ln-10479"></a>                  <span class="c">! Transmitted diffuse solar [W] = current exterior window transmitted diffuse solar</span>
<a name="ln-10480"></a>                  <span class="c">!    * view factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10481"></a>                  <span class="c">!    - diffuse absorbed by this interior window</span>
<a name="ln-10482"></a>                  <span class="c">!    - diffuse reflected by this interior window</span>
<a name="ln-10483"></a>                  <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10484"></a>                                    <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10485"></a>                                    <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-10486"></a>                                    <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-10487"></a>    <span class="c">! HERE 8/15/07 Note Construct(AdjConstrNum)%TransDiff could be used here since the &quot;front&quot; transmittance for an interior window</span>
<a name="ln-10488"></a>    <span class="c">! in the adjacent zone is the correct direction as long as I use the Construct() of the Surface in the adjacent zone.</span>
<a name="ln-10489"></a>    <span class="c">! However, the above calculation better conserves energy, although possibly at the expense of less accurate</span>
<a name="ln-10490"></a>    <span class="c">! transmittance calcs.</span>
<a name="ln-10491"></a>    <span class="c">! Preliminary tests showed fairly good agreement between the two DifSolarTransW calculation methods,</span>
<a name="ln-10492"></a>    <span class="c">! but for consistency I stuck with the above.</span>
<a name="ln-10493"></a>                  <span class="n">AdjConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10494"></a>    <span class="c">!              DifSolarTransW = WinDifSolar(DifTransSurfNum) &amp;</span>
<a name="ln-10495"></a>    <span class="c">!                                * ViewFactor &amp;</span>
<a name="ln-10496"></a>    <span class="c">!                                * Construct(AdjConstrNum)%TransDiff</span>
<a name="ln-10497"></a>
<a name="ln-10498"></a>                  <span class="c">! Get the adjacent zone index</span>
<a name="ln-10499"></a>                  <span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-10500"></a>
<a name="ln-10501"></a>                  <span class="c">! Call routine to distribute diffuse solar transmitted through this interior window into adjacent zone</span>
<a name="ln-10502"></a>                  <span class="k">CALL </span><span class="n">CalcInteriorWinTransDifSolInitialDistribution</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">,</span> <span class="n">AdjSurfNum</span><span class="p">,</span> <span class="n">DifSolarTransW</span><span class="p">)</span>
<a name="ln-10503"></a>
<a name="ln-10504"></a>                <span class="k">ELSE</span> <span class="c">! this is an exterior window surface</span>
<a name="ln-10505"></a>
<a name="ln-10506"></a>                  <span class="c">! Calc transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10507"></a>                  <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-10508"></a>                  <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-10509"></a>                  <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10510"></a>                                  <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10511"></a>                                  <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-10512"></a>                                  <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-10513"></a>
<a name="ln-10514"></a>                <span class="k">END IF</span> <span class="c">! this is an interior window surface</span>
<a name="ln-10515"></a>
<a name="ln-10516"></a>                <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10517"></a>                <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-10518"></a>                <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-10519"></a>
<a name="ln-10520"></a>                <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-10521"></a>                <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10522"></a>                                                         <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-10523"></a>                                                         <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10524"></a>
<a name="ln-10525"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10526"></a>                    <span class="c">! Interior, exterior or between-glass shade, screen or blind in place</span>
<a name="ln-10527"></a>
<a name="ln-10528"></a>                <span class="c">! Init accumulator for transmittance calc below</span>
<a name="ln-10529"></a>                <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10530"></a>                <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10531"></a>
<a name="ln-10532"></a>                <span class="c">! First calc diffuse solar absorbed by each glass layer in this window with shade/blind in place</span>
<a name="ln-10533"></a>                <span class="k">DO </span><span class="n">IGlass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-10534"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10535"></a>                    <span class="c">! Calc diffuse solar absorbed in each window glass layer and shade</span>
<a name="ln-10536"></a>                    <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">)</span>
<a name="ln-10537"></a>                  <span class="k">END IF</span>
<a name="ln-10538"></a>
<a name="ln-10539"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10540"></a><span class="k">                    </span><span class="n">BlAbsDiffBk</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10541"></a>                                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10542"></a>                                         <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">BlAbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="p">))</span>
<a name="ln-10543"></a>                    <span class="c">! Calc diffuse solar absorbed in each window glass layer and shade</span>
<a name="ln-10544"></a>                    <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">BlAbsDiffBk</span>
<a name="ln-10545"></a>                  <span class="k">END IF</span>
<a name="ln-10546"></a>
<a name="ln-10547"></a>                  <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-10548"></a>                  <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-10549"></a>
<a name="ln-10550"></a>                  <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10551"></a>                  <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10552"></a>                  <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10553"></a>
<a name="ln-10554"></a>                  <span class="c">! Accumulate diffuse solar absorbed from the inside by each window glass layer [W/m2] for heat balance calcs</span>
<a name="ln-10555"></a>                  <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10556"></a>                                                                   <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-10557"></a>                                                                   <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10558"></a>               <span class="k">END DO</span>
<a name="ln-10559"></a>
<a name="ln-10560"></a>                <span class="c">! Next calc diffuse solar reflected back to zone from window with shade or blind on</span>
<a name="ln-10561"></a>                <span class="c">! Diffuse back solar reflectance, bare glass or shade on</span>
<a name="ln-10562"></a>                <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-10563"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10564"></a>                  <span class="c">! Diffuse back solar reflectance, blind present, vs. slat angle</span>
<a name="ln-10565"></a>                  <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10566"></a>                                          <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10567"></a>                                          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">BlReflectSolDiffBack</span><span class="p">)</span>
<a name="ln-10568"></a>                <span class="k">END IF</span>
<a name="ln-10569"></a><span class="k">                </span><span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10570"></a>                                <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10571"></a>                                <span class="o">*</span> <span class="n">InsideDifReflectance</span>
<a name="ln-10572"></a>
<a name="ln-10573"></a>                <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-10574"></a>                <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10575"></a>                                              <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-10576"></a>
<a name="ln-10577"></a>                <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10578"></a>                <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10579"></a>                <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10580"></a>
<a name="ln-10581"></a>                <span class="c">! Now calc diffuse solar absorbed by shade/blind itself</span>
<a name="ln-10582"></a>                <span class="n">BlNum</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-10583"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10584"></a>                  <span class="c">! Calc diffuse solar absorbed by shade or screen [W]</span>
<a name="ln-10585"></a>                  <span class="n">ShBlDifSolarAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBackShade</span>
<a name="ln-10586"></a>                <span class="k">END IF</span>
<a name="ln-10587"></a><span class="k">                IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10588"></a>                  <span class="c">! Calc diffuse solar absorbed by blind [W]</span>
<a name="ln-10589"></a>                  <span class="n">AbsDiffBkBl</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10590"></a>                                         <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10591"></a>                                         <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBackBlind</span><span class="p">)</span>
<a name="ln-10592"></a>                  <span class="n">ShBlDifSolarAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">AbsDiffBkBl</span>
<a name="ln-10593"></a>                <span class="k">END IF</span>
<a name="ln-10594"></a>                <span class="c">! Correct for divider shadowing</span>
<a name="ln-10595"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10596"></a>                  <span class="n">ShBlDifSolarAbsW</span> <span class="o">=</span> <span class="n">ShBlDifSolarAbsW</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-10597"></a>
<a name="ln-10598"></a>                <span class="c">! Accumulate diffuse solar absorbed  by shade or screen [W/m2] for heat balance calcs</span>
<a name="ln-10599"></a>                <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">InitialDifSolAbsByShade</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">InitialDifSolAbsByShade</span> <span class="p">&amp;</span>
<a name="ln-10600"></a>                                                                    <span class="o">+</span> <span class="p">(</span><span class="n">ShBlDifSolarAbsW</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10601"></a>
<a name="ln-10602"></a>                <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-10603"></a>                <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">ShBlDifSolarAbsW</span>
<a name="ln-10604"></a>
<a name="ln-10605"></a>                <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10606"></a>                <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">ShBlDifSolarAbsW</span>  <span class="c">! debug</span>
<a name="ln-10607"></a>                <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">ShBlDifSolarAbsW</span>  <span class="c">! debug</span>
<a name="ln-10608"></a>
<a name="ln-10609"></a>                <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10610"></a>                <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-10611"></a>                <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-10612"></a>                <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10613"></a>                                <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10614"></a>                                <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-10615"></a>                                <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-10616"></a>                <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-10617"></a>                <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-10618"></a>
<a name="ln-10619"></a>                <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-10620"></a>                <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10621"></a>                                                         <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-10622"></a>                                                         <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10623"></a>
<a name="ln-10624"></a>              <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Switchable glazing</span>
<a name="ln-10625"></a>                <span class="c">! Init accumulator for transmittance calc below</span>
<a name="ln-10626"></a>                <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10627"></a>
<a name="ln-10628"></a>                <span class="k">DO </span><span class="n">IGlass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotGlassLayers</span>
<a name="ln-10629"></a>                  <span class="c">! Calc diffuse solar absorbed in each window glass layer</span>
<a name="ln-10630"></a>                  <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10631"></a>                                      <span class="o">*</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10632"></a>                                        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-10633"></a>                                        <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">))</span>
<a name="ln-10634"></a>
<a name="ln-10635"></a>                  <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-10636"></a>                  <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-10637"></a>
<a name="ln-10638"></a>                  <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10639"></a>                  <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10640"></a>                  <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10641"></a>
<a name="ln-10642"></a>                  <span class="c">! Accumulate diffuse solar absorbed from the inside by each window glass layer [W/m2] for heat balance calcs</span>
<a name="ln-10643"></a>                  <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10644"></a>                                                                   <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-10645"></a>                                                                   <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10646"></a>
<a name="ln-10647"></a>                <span class="k">END DO</span>
<a name="ln-10648"></a>
<a name="ln-10649"></a>                <span class="c">! Calc diffuse solar reflected back to zone</span>
<a name="ln-10650"></a>                <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10651"></a>                                <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10652"></a>                                <span class="o">*</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10653"></a>                                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10654"></a>                                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span><span class="p">)</span>
<a name="ln-10655"></a>
<a name="ln-10656"></a>                <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-10657"></a>                <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10658"></a>                                              <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-10659"></a>
<a name="ln-10660"></a>                <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10661"></a>                <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10662"></a>                <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10663"></a>
<a name="ln-10664"></a>                <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10665"></a>                <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-10666"></a>                <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-10667"></a>                <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10668"></a>                                <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10669"></a>                                <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-10670"></a>                                <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-10671"></a>                <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-10672"></a>                <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-10673"></a>
<a name="ln-10674"></a>                <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-10675"></a>                <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10676"></a>                                                         <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-10677"></a>                                                         <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10678"></a>
<a name="ln-10679"></a>              <span class="k">END IF</span>  <span class="c">! End of shading flag check</span>
<a name="ln-10680"></a>
<a name="ln-10681"></a>          <span class="k">ELSE</span>
<a name="ln-10682"></a>              <span class="c">! SurfaceWindow(HeatTransSurfNum)%WindowModelType == WindowEQLModel</span>
<a name="ln-10683"></a>              <span class="c">! ConstrNum=Surface(HeatTransSurfNum)%Construction</span>
<a name="ln-10684"></a>              <span class="c">! call the ASHWAT fenestration model for diffuse radiation here</span>
<a name="ln-10685"></a>              <span class="k">CALL </span><span class="n">CalcEQLOpticalProperty</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span> <span class="n">isDIFF</span><span class="p">,</span> <span class="n">AbsSolDiffBackEQL</span><span class="p">)</span>
<a name="ln-10686"></a>
<a name="ln-10687"></a>              <span class="n">EQLNum</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">EQLConsPtr</span>
<a name="ln-10688"></a>              <span class="k">DO </span><span class="n">Lay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span>
<a name="ln-10689"></a>
<a name="ln-10690"></a>
<a name="ln-10691"></a>                  <span class="c">! Calc diffuse solar absorbed from the inside by each layer of EQL model [W]</span>
<a name="ln-10692"></a>                  <span class="c">!WinDifSolLayAbsW = WinDifSolar(DifTransSurfNum)* ViewFactor * Construct(ConstrNum)%AbsDiffBack(Lay)</span>
<a name="ln-10693"></a>                  <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">AbsSolDiffBackEQL</span><span class="p">(</span><span class="n">Lay</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-10694"></a>
<a name="ln-10695"></a>                  <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-10696"></a>                  <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-10697"></a>
<a name="ln-10698"></a>                  <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10699"></a>                  <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10700"></a>                  <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-10701"></a>
<a name="ln-10702"></a>                  <span class="c">! Accumulate diffuse solar absorbed from the inside by each window layer [W/m2] for heat balance calcs</span>
<a name="ln-10703"></a>                  <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">Lay</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10704"></a>                                                            <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-10705"></a>                                                            <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10706"></a>
<a name="ln-10707"></a>                  <span class="c">! ASHWAT equivalent layer model may require not the individual layer absorption but the flux</span>
<a name="ln-10708"></a>                  <span class="c">! InitialDifSolwinEQL(HeatTransSurfNum) = WinDifSolar(DifTransSurfNum)* ViewFactor</span>
<a name="ln-10709"></a>
<a name="ln-10710"></a>              <span class="k">END DO</span>
<a name="ln-10711"></a>
<a name="ln-10712"></a>              <span class="c">! Calc diffuse solar reflected back to zone</span>
<a name="ln-10713"></a>              <span class="c">! I don&#39;t really care if this is a window or opaque surface since I am just</span>
<a name="ln-10714"></a>              <span class="c">! accumulating all reflected diffuse solar in a zone bucket for &quot;interreflected&quot; distribution</span>
<a name="ln-10715"></a>              <span class="c">! Reflected diffuse solar [W] = current window transmitted diffuse solar</span>
<a name="ln-10716"></a>              <span class="c">!    * view factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10717"></a>              <span class="c">!    * current window inside solar reflectance</span>
<a name="ln-10718"></a>              <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-10719"></a>              <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">WinDifSolar</span><span class="p">(</span><span class="n">DifTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10720"></a>                            <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-10721"></a>                            <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-10722"></a>
<a name="ln-10723"></a>              <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-10724"></a>              <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10725"></a>                                              <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-10726"></a>
<a name="ln-10727"></a>              <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10728"></a>              <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10729"></a>              <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-10730"></a>
<a name="ln-10731"></a>                <span class="c">!------------------------------------------------------------------------------</span>
<a name="ln-10732"></a>                <span class="c">! DISTRIBUTE TRANSMITTED DIFFUSE SOLAR THROUGH INTERIOR WINDOW TO ADJACENT ZONE</span>
<a name="ln-10733"></a>                <span class="c">!------------------------------------------------------------------------------</span>
<a name="ln-10734"></a>
<a name="ln-10735"></a>                <span class="c">! If this receiving window surface (HeatTransSurfNum) is an interior window,</span>
<a name="ln-10736"></a>                <span class="c">! calc distributed solar transmitted to adjacent zone [W]</span>
<a name="ln-10737"></a>                <span class="c">! NOTE: This calc is here because interior windows are currently assumed to have no shading</span>
<a name="ln-10738"></a>
<a name="ln-10739"></a>                <span class="c">! Get the adjacent surface number for this receiving window surface</span>
<a name="ln-10740"></a>              <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-10741"></a>                <span class="c">! If the adjacent surface number is &gt; 0, this is an interior window</span>
<a name="ln-10742"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! this is an interior window surface</span>
<a name="ln-10743"></a>
<a name="ln-10744"></a>                  <span class="c">! Calc diffuse solar from current exterior window</span>
<a name="ln-10745"></a>                  <span class="c">! transmitted through this interior window to adjacent zone [W]</span>
<a name="ln-10746"></a>                  <span class="c">! Transmitted diffuse solar [W] = current exterior window transmitted diffuse solar</span>
<a name="ln-10747"></a>                  <span class="c">!    * view factor from current (sending) window DifTransSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10748"></a>                  <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">AbsSolDiffBackEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ViewFactor</span>
<a name="ln-10749"></a>                                   <span class="n">AdjConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10750"></a>                  <span class="c">! Get the adjacent zone index</span>
<a name="ln-10751"></a>                  <span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-10752"></a>                  <span class="c">! Call routine to distribute diffuse solar transmitted through this interior window into adjacent zone</span>
<a name="ln-10753"></a>                  <span class="k">CALL </span><span class="n">CalcInteriorWinTransDifSolInitialDistribution</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">,</span> <span class="n">AdjSurfNum</span><span class="p">,</span> <span class="n">DifSolarTransW</span><span class="p">)</span>
<a name="ln-10754"></a>
<a name="ln-10755"></a>              <span class="k">ELSE</span> <span class="c">! this is an exterior window surface</span>
<a name="ln-10756"></a>
<a name="ln-10757"></a>                    <span class="c">! Calc transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10758"></a>                    <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-10759"></a>                    <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-10760"></a>                    <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">AbsSolDiffBackEQL</span><span class="p">(</span><span class="n">CFS</span><span class="p">(</span><span class="n">EQLNum</span><span class="p">)%</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">ViewFactor</span>
<a name="ln-10761"></a>
<a name="ln-10762"></a>              <span class="k">END IF</span> <span class="c">! this is an interior window surface</span>
<a name="ln-10763"></a>
<a name="ln-10764"></a>              <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-10765"></a>              <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-10766"></a>              <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-10767"></a>              <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-10768"></a>              <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10769"></a>                                                     <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-10770"></a>                                                     <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-10771"></a>
<a name="ln-10772"></a>          <span class="k">END IF</span>      <span class="c">!IF (SurfaceWindow(HeatTransSurfNum)%WindowModelType /= WindowEQLModel) THEN</span>
<a name="ln-10773"></a>
<a name="ln-10774"></a><span class="c">! HERE 8/14/07 Ignore absorptance and reflectance of Frames and Dividers for now.</span>
<a name="ln-10775"></a><span class="c">! I would need revised view factors that included these surface types.</span>
<a name="ln-10776"></a><span class="c">! By ignoring them here, the diffuse solar is accounted for on the other surfaces</span>
<a name="ln-10777"></a>
<a name="ln-10778"></a><span class="c">!          IF(SurfaceWindow(HeatTransSurfNum)%FrameArea &gt; 0.0) THEN  ! Window has a frame</span>
<a name="ln-10779"></a>            <span class="c">! Note that FrameQRadInAbs is initially calculated in InitSolarHeatGains</span>
<a name="ln-10780"></a><span class="c">!          END IF</span>
<a name="ln-10781"></a>
<a name="ln-10782"></a><span class="c">!          IF(SurfaceWindow(HeatTransSurfNum)%DividerArea &gt; 0.0) THEN  ! Window has dividers</span>
<a name="ln-10783"></a><span class="c">!            DividerSolAbs = SurfaceWindow(HeatTransSurfNum)%DividerSolAbsorp</span>
<a name="ln-10784"></a><span class="c">!            IF(SurfaceWindow(HeatTransSurfNum)%DividerType == Suspended) THEN ! Suspended divider; account for inside glass</span>
<a name="ln-10785"></a><span class="c">!              MatNumGl = Construct(ConstrNum)%LayerPoint(Construct(ConstrNum)%TotLayers)</span>
<a name="ln-10786"></a><span class="c">!              TransGl = Material(MatNumGl)%Trans</span>
<a name="ln-10787"></a><span class="c">!              ReflGl = Material(MatNumGl)%ReflectSolDiffBack</span>
<a name="ln-10788"></a><span class="c">!              AbsGl = 1.-TransGl-ReflGl</span>
<a name="ln-10789"></a><span class="c">!              DividerSolRefl = 1.-DividerSolAbs</span>
<a name="ln-10790"></a><span class="c">!              DividerSolAbs = AbsGl + TransGl*(DividerSolAbs + DividerSolRefl*AbsGl)/(1.-DividerSolRefl*ReflGl)</span>
<a name="ln-10791"></a><span class="c">!            END IF</span>
<a name="ln-10792"></a>            <span class="c">! Correct for interior shade transmittance</span>
<a name="ln-10793"></a><span class="c">!            IF(ShadeFlag == IntShadeOn) THEN</span>
<a name="ln-10794"></a><span class="c">!              MatNumSh = Construct(ConstrNumSh)%LayerPoint(Construct(ConstrNumSh)%TotLayers)</span>
<a name="ln-10795"></a><span class="c">!              DividerSolAbs = DividerSolAbs * Material(MatNumSh)%Trans</span>
<a name="ln-10796"></a><span class="c">!            ELSE IF(ShadeFlag == IntBlindOn) THEN</span>
<a name="ln-10797"></a><span class="c">!              DividerSolAbs = DividerSolAbs * InterpSlatAng(SurfaceWindow(HeatTransSurfNum)%SlatAngThisTS, &amp;</span>
<a name="ln-10798"></a><span class="c">!                  SurfaceWindow(HeatTransSurfNum)%MovableSlats,Blind(BlNum)%SolBackDiffDiffTrans)</span>
<a name="ln-10799"></a><span class="c">!            END IF</span>
<a name="ln-10800"></a>            <span class="c">! Note that DividerQRadInAbs is initially calculated in InitSolarHeatGains</span>
<a name="ln-10801"></a>
<a name="ln-10802"></a><span class="c">!          END IF  ! Window has dividers</span>
<a name="ln-10803"></a>
<a name="ln-10804"></a>        <span class="k">END IF</span>  <span class="c">! opaque or window heat transfer surface</span>
<a name="ln-10805"></a>
<a name="ln-10806"></a>      <span class="k">END DO</span>  <span class="c">! HeatTransSurfNum = Zone(ZoneNum)%SurfaceFirst, Zone(ZoneNum)%SurfaceLast</span>
<a name="ln-10807"></a>
<a name="ln-10808"></a>      <span class="c">! Check debug var for view factors here</span>
<a name="ln-10809"></a>      <span class="c">! ViewFactorTotal</span>
<a name="ln-10810"></a>      <span class="c">! Check debug vars for individual transmitting surfaces here</span>
<a name="ln-10811"></a>      <span class="n">WinDifSolarDistTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">WinDifSolarDistTransmittedTotl</span>
<a name="ln-10812"></a>      <span class="c">! WinDifSolarTrans</span>
<a name="ln-10813"></a>
<a name="ln-10814"></a>    <span class="k">END DO</span>  <span class="c">! DifTransSurfNum = Zone(ZoneNum)%SurfaceFirst, Zone(ZoneNum)%SurfaceLast</span>
<a name="ln-10815"></a>
<a name="ln-10816"></a>    <span class="c">! Check debug vars for zone totals here</span>
<a name="ln-10817"></a>    <span class="n">ZoneDifSolarDistTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span>
<a name="ln-10818"></a>    <span class="c">! ZoneDifSolarTrans</span>
<a name="ln-10819"></a>    <span class="c">! ZoneDifSolarDistAbsorbedTotl</span>
<a name="ln-10820"></a>    <span class="c">! ZoneDifSolarDistReflectedTotl</span>
<a name="ln-10821"></a>    <span class="c">! ZoneDifSolarDistTransmittedTotl</span>
<a name="ln-10822"></a><span class="c">!    CALL DisplayString(&#39;Diffuse Solar Distribution Zone Totals&#39;)</span>
<a name="ln-10823"></a>
<a name="ln-10824"></a>  <span class="k">END DO</span>  <span class="c">! ZoneNum = 1, NumOfZones</span>
<a name="ln-10825"></a>
<a name="ln-10826"></a>  <span class="k">RETURN</span>
<a name="ln-10827"></a>
<a name="ln-10828"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWinTransDifSolInitialDistribution</span>
<a name="ln-10829"></a>
<a name="ln-10830"></a>
<a name="ln-10831"></a><span class="k">SUBROUTINE </span><span class="n">CalcInteriorWinTransDifSolInitialDistribution</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">,</span> <span class="n">IntWinSurfNum</span><span class="p">,</span> <span class="n">IntWinDifSolarTransW</span><span class="p">)</span>
<a name="ln-10832"></a>
<a name="ln-10833"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10834"></a>          <span class="c">!       AUTHOR         Rob Hitchcock</span>
<a name="ln-10835"></a>          <span class="c">!       DATE WRITTEN   August 2007</span>
<a name="ln-10836"></a>          <span class="c">!       MODIFIED       N/A</span>
<a name="ln-10837"></a>          <span class="c">!       RE-ENGINEERED  N/A</span>
<a name="ln-10838"></a>
<a name="ln-10839"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10840"></a>          <span class="c">! This subroutine calculates the initial distribution</span>
<a name="ln-10841"></a>          <span class="c">! of diffuse solar transmitted through the given interior window</span>
<a name="ln-10842"></a>          <span class="c">! to individual heat transfer surfaces in the given zone.</span>
<a name="ln-10843"></a>          <span class="c">! Diffuse solar transmitted through interior windows in this zone</span>
<a name="ln-10844"></a>          <span class="c">! to adjacent zones, is added to the InitialZoneDifSolReflW</span>
<a name="ln-10845"></a>          <span class="c">! of the adjacent zone for subsequent interreflection calcs</span>
<a name="ln-10846"></a>
<a name="ln-10847"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10848"></a>          <span class="c">! Similar to method used in CalcWinTransDifSolInitialDistribution.</span>
<a name="ln-10849"></a>          <span class="c">! Apportions diffuse solar transmitted through an interior window</span>
<a name="ln-10850"></a>          <span class="c">! that is then absorbed, reflected, and/or transmitted</span>
<a name="ln-10851"></a>          <span class="c">! by other heat transfer surfaces in the given zone.</span>
<a name="ln-10852"></a>          <span class="c">! Calculations use:</span>
<a name="ln-10853"></a>          <span class="c">! 1. DifSolarTransW calculated in SUBROUTINE CalcWinTransDifSolInitialDistribution,</span>
<a name="ln-10854"></a>          <span class="c">! 2. view factors between the interior window and</span>
<a name="ln-10855"></a>          <span class="c">! other heat transfer surfaces in the given zone</span>
<a name="ln-10856"></a>          <span class="c">! calculated in SUBROUTINE CalcApproximateViewFactors, and</span>
<a name="ln-10857"></a>          <span class="c">! 3. surface absorptances, reflectances, and transmittances</span>
<a name="ln-10858"></a>          <span class="c">! determined here using revised code from SUBROUTINE InitIntSolarDistribution</span>
<a name="ln-10859"></a>
<a name="ln-10860"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10861"></a>
<a name="ln-10862"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10863"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InterpSw</span><span class="p">,</span> <span class="n">InterpSlatAng</span>
<a name="ln-10864"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCurrentScheduleValue</span>
<a name="ln-10865"></a>  <span class="k">USE </span><span class="n">DataViewFactorInformation</span>
<a name="ln-10866"></a>
<a name="ln-10867"></a>  <span class="k">USE </span><span class="n">DataHeatBalSurface</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitialDifSolInAbs</span><span class="p">,</span> <span class="n">InitialDifSolInTrans</span>
<a name="ln-10868"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">InitialDifSolwinAbs</span><span class="p">,</span> <span class="n">InitialZoneDifSolReflW</span>
<a name="ln-10869"></a>
<a name="ln-10870"></a>  <span class="k">IMPLICIT NONE</span> <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10871"></a>
<a name="ln-10872"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10873"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>              <span class="c">! Zone index number</span>
<a name="ln-10874"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IntWinSurfNum</span>        <span class="c">! Interior Window Surface number in Zone ZoneNum</span>
<a name="ln-10875"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">IntWinDifSolarTransW</span> <span class="c">! Diffuse Solar transmitted through Interior Window IntWinSurfNum from adjacent zone [W]</span>
<a name="ln-10876"></a>
<a name="ln-10877"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10878"></a>          <span class="c">! na</span>
<a name="ln-10879"></a>
<a name="ln-10880"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS:</span>
<a name="ln-10881"></a>          <span class="c">! na</span>
<a name="ln-10882"></a>
<a name="ln-10883"></a>          <span class="c">! DERIVED TYPE DEFINITIONS:</span>
<a name="ln-10884"></a>          <span class="c">! na</span>
<a name="ln-10885"></a>
<a name="ln-10886"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10887"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AdjZoneNum</span>         <span class="c">! Index for adjacent zones</span>
<a name="ln-10888"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AdjSurfNum</span>         <span class="c">! Index for adjacent surfaces</span>
<a name="ln-10889"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatTransSurfNum</span>   <span class="c">! Heat Transfer Surface number</span>
<a name="ln-10890"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNum</span>          <span class="c">! Construction number</span>
<a name="ln-10891"></a><span class="c">!  INTEGER :: AdjConstrNum       ! Construction number of other side surface</span>
<a name="ln-10892"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ConstrNumSh</span>        <span class="c">! Shaded construction number</span>
<a name="ln-10893"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IGlass</span>             <span class="c">! Glass layer counter</span>
<a name="ln-10894"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TotGlassLayers</span>     <span class="c">! Number of glass layers in a window construction</span>
<a name="ln-10895"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ShadeFlag</span>          <span class="c">! Shading flag</span>
<a name="ln-10896"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AbsInt</span>             <span class="c">! Tmp var for Inside surface short-wave absorptance</span>
<a name="ln-10897"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MovInsulSchedVal</span>   <span class="c">! Value of the movable insulation schedule for current time</span>
<a name="ln-10898"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HMovInsul</span>          <span class="c">! Conductance of movable insulation</span>
<a name="ln-10899"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InsideDifAbsorptance</span> <span class="c">! Inside diffuse solar absorptance of a surface</span>
<a name="ln-10900"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">InsideDifReflectance</span> <span class="c">! Inside diffuse solar reflectance of a surface</span>
<a name="ln-10901"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BlNum</span>              <span class="c">! Blind number</span>
<a name="ln-10902"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">BlAbsDiffBk</span>        <span class="c">! Glass layer back diffuse solar absorptance when blind in place</span>
<a name="ln-10903"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AbsDiffBkBl</span>        <span class="c">! Blind diffuse back solar absorptance as part of glazing system</span>
<a name="ln-10904"></a>
<a name="ln-10905"></a><span class="c">!  REAL(r64)    :: DividerSolAbs      ! Window divider solar absorptance</span>
<a name="ln-10906"></a><span class="c">!  REAL(r64)    :: DividerSolRefl     ! Window divider solar reflectance</span>
<a name="ln-10907"></a><span class="c">!  INTEGER :: MatNumGl           ! Glass layer material number</span>
<a name="ln-10908"></a><span class="c">!  INTEGER :: MatNumSh           ! Shade layer material number</span>
<a name="ln-10909"></a><span class="c">!  REAL(r64)    :: TransGl,ReflGl,AbsGl ! Glass layer solar transmittance, reflectance, absorptance</span>
<a name="ln-10910"></a>
<a name="ln-10911"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ViewFactor</span>         <span class="c">! temp var for view factor</span>
<a name="ln-10912"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ViewFactorTotal</span>    <span class="c">! debug var for view factor total</span>
<a name="ln-10913"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarTrans</span>   <span class="c">! debug var for WinDifSolar() [W]</span>
<a name="ln-10914"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistTotl</span>    <span class="c">! debug var for window total distributed diffuse solar [W]</span>
<a name="ln-10915"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistAbsorbedTotl</span>    <span class="c">! debug var for individual exterior window total distributed</span>
<a name="ln-10916"></a>                                            <span class="c">!           diffuse solar absorbed [W]</span>
<a name="ln-10917"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistReflectedTotl</span>   <span class="c">! debug var for individual exterior window total distributed</span>
<a name="ln-10918"></a>                                            <span class="c">!           diffuse solar reflected [W]</span>
<a name="ln-10919"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="c">! debug var for individual exterior window total distributed</span>
<a name="ln-10920"></a>                                            <span class="c">!           diffuse solar transmitted [W]</span>
<a name="ln-10921"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WinDifSolLayAbsW</span>   <span class="c">! temp var for diffuse solar absorbed by individual glass layer [W]</span>
<a name="ln-10922"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarTrans</span>   <span class="c">! debug var for WinDifSolar() [W]</span>
<a name="ln-10923"></a><span class="c">!  REAL(r64)    :: ZoneDifSolarDistTotl    ! debug var for zone total distributed diffuse solar [W]</span>
<a name="ln-10924"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span>    <span class="c">! debug var for zone total distributed diffuse solar absorbed [W]</span>
<a name="ln-10925"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistReflectedTotl</span>   <span class="c">! debug var for zone total distributed diffuse solar reflected [W]</span>
<a name="ln-10926"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="c">! debug var for zone total distributed diffuse solar transmitted [W]</span>
<a name="ln-10927"></a>
<a name="ln-10928"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarAbsW</span>       <span class="c">! temp var for diffuse solar absorbed by surface [W]</span>
<a name="ln-10929"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarAbs</span>        <span class="c">! temp var for diffuse solar absorbed by surface [W/m2]</span>
<a name="ln-10930"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarReflW</span>      <span class="c">! temp var for diffuse solar reflected by surface [W]</span>
<a name="ln-10931"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DifSolarTransW</span>     <span class="c">! temp var for diffuse solar transmitted through interior window surface [W]</span>
<a name="ln-10932"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ShBlDifSolarAbsW</span>   <span class="c">! temp var for diffuse solar absorbed by shade/blind [W]</span>
<a name="ln-10933"></a>
<a name="ln-10934"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FirstZoneSurf</span>      <span class="c">! conversion index for ViewFactor</span>
<a name="ln-10935"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">LastZoneSurf</span>       <span class="c">! debug</span>
<a name="ln-10936"></a>
<a name="ln-10937"></a>  <span class="c">!-------------------------------------------------------------------------------------------------</span>
<a name="ln-10938"></a>  <span class="c">! DISTRIBUTE TRANSMITTED DIFFUSE SOLAR THROUGH INTERIOR WINDOW TO INTERIOR HEAT TRANSFER SURFACES</span>
<a name="ln-10939"></a>  <span class="c">!-------------------------------------------------------------------------------------------------</span>
<a name="ln-10940"></a>
<a name="ln-10941"></a>  <span class="c">! Init debug vars</span>
<a name="ln-10942"></a>  <span class="n">ViewFactorTotal</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10943"></a>  <span class="n">WinDifSolarTrans</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span>
<a name="ln-10944"></a>
<a name="ln-10945"></a>  <span class="c">! Init Interior Window accumulators for debugging</span>
<a name="ln-10946"></a>  <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10947"></a>  <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10948"></a>  <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10949"></a>
<a name="ln-10950"></a>  <span class="c">! Init first and last surfnums for this zone</span>
<a name="ln-10951"></a>  <span class="n">FirstZoneSurf</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span>
<a name="ln-10952"></a>  <span class="n">LastZoneSurf</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10953"></a>
<a name="ln-10954"></a>  <span class="n">ZoneDifSolarTrans</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10955"></a>  <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10956"></a>  <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10957"></a>  <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10958"></a>
<a name="ln-10959"></a>  <span class="c">! Loop over all heat transfer surfaces in the current zone that might receive diffuse solar</span>
<a name="ln-10960"></a>  <span class="k">DO </span><span class="n">HeatTransSurfNum</span> <span class="o">=</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceFirst</span><span class="p">,</span> <span class="n">Zone</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">SurfaceLast</span>
<a name="ln-10961"></a>    <span class="c">! Skip surfaces that are not heat transfer surfaces</span>
<a name="ln-10962"></a>    <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">HeatTransSurf</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10963"></a>    <span class="c">! Skip tubular daylighting device domes</span>
<a name="ln-10964"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="k">Class</span> <span class="o">==</span> <span class="n">SurfaceClass_TDD_Dome</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10965"></a>
<a name="ln-10966"></a>    <span class="c">! View factor from current (sending) window IntWinSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-10967"></a>    <span class="n">ViewFactor</span> <span class="o">=</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)%</span><span class="n">F</span><span class="p">(</span><span class="n">IntWinSurfNum</span><span class="o">-</span><span class="n">FirstZoneSurf</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">HeatTransSurfNum</span><span class="o">-</span><span class="n">FirstZoneSurf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10968"></a>    <span class="c">! debug ViewFactorTotal</span>
<a name="ln-10969"></a>    <span class="n">ViewFactorTotal</span> <span class="o">=</span> <span class="n">ViewFactorTotal</span> <span class="o">+</span> <span class="n">ViewFactor</span>  <span class="c">! debug</span>
<a name="ln-10970"></a>
<a name="ln-10971"></a>    <span class="c">! Skip receiving surfaces with 0.0 view factor</span>
<a name="ln-10972"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ViewFactor</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-10973"></a>
<a name="ln-10974"></a>    <span class="c">! Calculate diffuse solar from current interior window absorbed and reflected by current heat transfer surface</span>
<a name="ln-10975"></a>    <span class="c">! And calculate transmitted diffuse solar to adjacent zones through interior windows</span>
<a name="ln-10976"></a>    <span class="n">ConstrNum</span><span class="o">=</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-10977"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TransDiff</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Interior Opaque Surface</span>
<a name="ln-10978"></a>
<a name="ln-10979"></a>      <span class="c">! Determine the inside (back) diffuse solar absorptance</span>
<a name="ln-10980"></a>      <span class="c">! and reflectance of the current heat transfer surface</span>
<a name="ln-10981"></a>      <span class="n">InsideDifAbsorptance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">InsideAbsorpSolar</span>
<a name="ln-10982"></a>      <span class="c">! Check for movable insulation; reproduce code from subr. EvalInsideMovableInsulation;</span>
<a name="ln-10983"></a>      <span class="c">! Can&#39;t call that routine here since cycle prevents SolarShadingGeometry from USEing</span>
<a name="ln-10984"></a>      <span class="c">! HeatBalanceSurfaceManager, which contains EvalInsideMovableInsulation</span>
<a name="ln-10985"></a>      <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10986"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10987"></a><span class="k">        </span><span class="n">MovInsulSchedVal</span> <span class="o">=</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SchedMovInsulExt</span><span class="p">)</span>
<a name="ln-10988"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="p">.</span><span class="n">LE</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! Movable insulation not present at current time</span>
<a name="ln-10989"></a>          <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10990"></a>        <span class="k">ELSE</span>  <span class="c">! Movable insulation present</span>
<a name="ln-10991"></a>          <span class="n">HMovInsul</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="o">/</span><span class="p">(</span><span class="n">MovInsulSchedVal</span><span class="o">*</span><span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">Resistance</span><span class="p">)</span>
<a name="ln-10992"></a>          <span class="n">AbsInt</span>    <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MaterialMovInsulInt</span><span class="p">)%</span><span class="n">AbsorpSolar</span>
<a name="ln-10993"></a>        <span class="k">END IF</span>
<a name="ln-10994"></a><span class="k">      END IF</span>
<a name="ln-10995"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">HMovInsul</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">InsideDifAbsorptance</span> <span class="o">=</span> <span class="n">AbsInt</span>  <span class="c">! Movable inside insulation present</span>
<a name="ln-10996"></a>      <span class="c">! Inside (back) diffuse solar reflectance is assumed to be 1 - absorptance</span>
<a name="ln-10997"></a>      <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">InsideDifAbsorptance</span>
<a name="ln-10998"></a>
<a name="ln-10999"></a>      <span class="c">! Absorbed diffuse solar [W] = current window transmitted diffuse solar [W]</span>
<a name="ln-11000"></a>      <span class="c">!    * view factor from current (sending) window IntWinSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-11001"></a>      <span class="c">!    * current surface inside solar absorptance</span>
<a name="ln-11002"></a>      <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span> <span class="c">! [W]</span>
<a name="ln-11003"></a>                      <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11004"></a>                      <span class="o">*</span> <span class="n">InsideDifAbsorptance</span>
<a name="ln-11005"></a>
<a name="ln-11006"></a>      <span class="c">! Absorbed diffuse solar [W/m2] = Absorbed diffuse solar [W]</span>
<a name="ln-11007"></a>      <span class="c">!                                 / current surface net area</span>
<a name="ln-11008"></a>      <span class="n">DifSolarAbs</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-11009"></a>                     <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span>
<a name="ln-11010"></a>
<a name="ln-11011"></a>      <span class="c">! Accumulate absorbed diffuse solar [W/m2] on this surface for heat balance calcs</span>
<a name="ln-11012"></a>      <span class="n">InitialDifSolInAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11013"></a>                                              <span class="o">+</span> <span class="n">DifSolarAbs</span>
<a name="ln-11014"></a>
<a name="ln-11015"></a>      <span class="c">! Reflected diffuse solar [W] = current window transmitted diffuse solar</span>
<a name="ln-11016"></a>      <span class="c">!    * view factor from current (sending) window IntWinSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-11017"></a>      <span class="c">!    * current window inside solar reflectance</span>
<a name="ln-11018"></a>      <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11019"></a>                      <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11020"></a>                      <span class="o">*</span> <span class="n">InsideDifReflectance</span>
<a name="ln-11021"></a>
<a name="ln-11022"></a>      <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-11023"></a>      <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11024"></a>                                    <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-11025"></a>
<a name="ln-11026"></a>      <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11027"></a>      <span class="c">! For opaque surfaces all incident diffuse is either absorbed or reflected</span>
<a name="ln-11028"></a>      <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">DifSolarAbsW</span>  <span class="c">! debug [W]</span>
<a name="ln-11029"></a>      <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug [W]</span>
<a name="ln-11030"></a>      <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">DifSolarAbsW</span>  <span class="c">! debug [W]</span>
<a name="ln-11031"></a>      <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug [W]</span>
<a name="ln-11032"></a>
<a name="ln-11033"></a>    <span class="k">ELSE</span>  <span class="c">! Exterior or Interior Window</span>
<a name="ln-11034"></a>
<a name="ln-11035"></a>      <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ShadedConstruction</span>
<a name="ln-11036"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">StormWinFlag</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11037"></a><span class="k">        </span><span class="n">ConstrNum</span>   <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">StormWinConstruction</span>
<a name="ln-11038"></a>        <span class="n">ConstrNumSh</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">StormWinShadedConstruction</span>
<a name="ln-11039"></a>      <span class="k">END IF</span>
<a name="ln-11040"></a><span class="k">      </span><span class="n">TotGlassLayers</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-11041"></a>      <span class="n">ShadeFlag</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ShadingFlag</span>
<a name="ln-11042"></a>
<a name="ln-11043"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! No window shading</span>
<a name="ln-11044"></a>        <span class="c">! Init accumulator for transmittance calc below</span>
<a name="ln-11045"></a>        <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11046"></a>
<a name="ln-11047"></a>        <span class="c">! Calc diffuse solar absorbed by all window glass layers</span>
<a name="ln-11048"></a>        <span class="c">! Note: I am assuming here that individual glass layer absorptances have been corrected</span>
<a name="ln-11049"></a>        <span class="c">!       to account for layer by layer transmittance and reflection effects.</span>
<a name="ln-11050"></a>        <span class="k">DO </span><span class="n">IGlass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotGlassLayers</span>
<a name="ln-11051"></a>          <span class="c">! Calc diffuse solar absorbed from the inside by each window glass layer [W]</span>
<a name="ln-11052"></a>          <span class="n">AbsInt</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">)</span>
<a name="ln-11053"></a>          <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span><span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">)</span>
<a name="ln-11054"></a>
<a name="ln-11055"></a>          <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-11056"></a>          <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-11057"></a>
<a name="ln-11058"></a>          <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11059"></a>          <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-11060"></a>          <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-11061"></a>
<a name="ln-11062"></a>          <span class="c">! Accumulate diffuse solar absorbed from the inside by each window glass layer [W/m2] for heat balance calcs</span>
<a name="ln-11063"></a>          <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-11064"></a>                                                           <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-11065"></a>                                                           <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11066"></a>        <span class="k">END DO</span>
<a name="ln-11067"></a>
<a name="ln-11068"></a>        <span class="c">! Calc diffuse solar reflected back to zone</span>
<a name="ln-11069"></a>        <span class="c">! I don&#39;t really care if this is a window or opaque surface since I am just</span>
<a name="ln-11070"></a>        <span class="c">! accumulating all reflected diffuse solar in a zone bucket for &quot;interreflected&quot; distribution</span>
<a name="ln-11071"></a>        <span class="c">! Reflected diffuse solar [W] = current window transmitted diffuse solar</span>
<a name="ln-11072"></a>        <span class="c">!    * view factor from current (sending) window IntWinSurfNum to current (receiving) surface HeatTransSurfNum</span>
<a name="ln-11073"></a>        <span class="c">!    * current window inside solar reflectance</span>
<a name="ln-11074"></a>        <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11075"></a>                        <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11076"></a>                        <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-11077"></a>
<a name="ln-11078"></a>        <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-11079"></a>        <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11080"></a>                                      <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-11081"></a>
<a name="ln-11082"></a>        <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11083"></a>        <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-11084"></a>        <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-11085"></a>
<a name="ln-11086"></a>        <span class="c">! Calc transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11087"></a>        <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-11088"></a>        <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-11089"></a>        <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11090"></a>                        <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11091"></a>                        <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-11092"></a>                        <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-11093"></a>
<a name="ln-11094"></a>        <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11095"></a>        <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-11096"></a>        <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-11097"></a>
<a name="ln-11098"></a>        <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-11099"></a>        <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11100"></a>                                                 <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-11101"></a>                                                 <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11102"></a>
<a name="ln-11103"></a>        <span class="c">!-----------------------------------------------------------------------------------</span>
<a name="ln-11104"></a>        <span class="c">! ADD TRANSMITTED DIFFUSE SOLAR THROUGH INTERIOR WINDOW TO ADJACENT ZONE</span>
<a name="ln-11105"></a>        <span class="c">! TOTAL REFLECTED DIFFUSE SOLAR FOR SUBSEQUENT INTERREFLECTION CALCS</span>
<a name="ln-11106"></a>        <span class="c">!-----------------------------------------------------------------------------------</span>
<a name="ln-11107"></a>
<a name="ln-11108"></a>        <span class="c">! If this receiving window surface (HeatTransSurfNum) is an interior window,</span>
<a name="ln-11109"></a>        <span class="c">! add transmitted diffuse solar to adjacent zone total reflected distributed</span>
<a name="ln-11110"></a>        <span class="c">! diffuse solar for subsequent interreflection calcs</span>
<a name="ln-11111"></a>        <span class="c">! NOTE: This calc is here because interior windows are currently assumed to have no shading</span>
<a name="ln-11112"></a>
<a name="ln-11113"></a>        <span class="c">! Get the adjacent surface number for this receiving window surface</span>
<a name="ln-11114"></a>        <span class="n">AdjSurfNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">ExtBoundCond</span>
<a name="ln-11115"></a>        <span class="c">! If the adjacent surface number is &gt; 0, this is an interior window</span>
<a name="ln-11116"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">AdjSurfNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! this is an interior window surface</span>
<a name="ln-11117"></a>
<a name="ln-11118"></a>          <span class="c">! Get the adjacent zone index</span>
<a name="ln-11119"></a>          <span class="n">AdjZoneNum</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">AdjSurfNum</span><span class="p">)%</span><span class="n">Zone</span>
<a name="ln-11120"></a>
<a name="ln-11121"></a>          <span class="c">! Add transmitted diffuse solar to total reflected distributed diffuse solar for each zone</span>
<a name="ln-11122"></a>          <span class="c">! for subsequent interreflection calcs</span>
<a name="ln-11123"></a>          <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">AdjZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11124"></a>                                           <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! [W]</span>
<a name="ln-11125"></a>
<a name="ln-11126"></a>        <span class="k">END IF</span>
<a name="ln-11127"></a>
<a name="ln-11128"></a><span class="k">      ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11129"></a>            <span class="c">! Interior, exterior or between-glass shade, screen or blind in place</span>
<a name="ln-11130"></a>
<a name="ln-11131"></a>        <span class="c">! Init accumulator for transmittance calc below</span>
<a name="ln-11132"></a>        <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11133"></a>        <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11134"></a>
<a name="ln-11135"></a>        <span class="c">! First calc diffuse solar absorbed by each glass layer in this window with shade/blind in place</span>
<a name="ln-11136"></a>        <span class="k">DO </span><span class="n">IGlass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">TotGlassLayers</span>
<a name="ln-11137"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11138"></a>            <span class="c">! Calc diffuse solar absorbed in each window glass layer and shade</span>
<a name="ln-11139"></a>            <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">)</span>
<a name="ln-11140"></a>          <span class="k">END IF</span>
<a name="ln-11141"></a>
<a name="ln-11142"></a><span class="k">          IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11143"></a><span class="k">            </span><span class="n">BlAbsDiffBk</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11144"></a>                                 <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11145"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">BlAbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">MaxSlatAngs</span><span class="p">))</span>
<a name="ln-11146"></a>            <span class="c">! Calc diffuse solar absorbed in each window glass layer and shade</span>
<a name="ln-11147"></a>            <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">BlAbsDiffBk</span>
<a name="ln-11148"></a>          <span class="k">END IF</span>
<a name="ln-11149"></a>
<a name="ln-11150"></a>          <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-11151"></a>          <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-11152"></a>
<a name="ln-11153"></a>          <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11154"></a>          <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-11155"></a>          <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-11156"></a>
<a name="ln-11157"></a>          <span class="c">! Accumulate diffuse solar absorbed from the inside by each window glass layer [W/m2] for heat balance calcs</span>
<a name="ln-11158"></a>          <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-11159"></a>                                                           <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-11160"></a>                                                           <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11161"></a>        <span class="k">END DO</span>
<a name="ln-11162"></a>
<a name="ln-11163"></a>        <span class="c">! Next calc diffuse solar reflected back to zone from window with shade or blind on</span>
<a name="ln-11164"></a>        <span class="c">! Diffuse back solar reflectance, bare glass or shade on</span>
<a name="ln-11165"></a>        <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span>
<a name="ln-11166"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11167"></a>          <span class="c">! Diffuse back solar reflectance, blind present, vs. slat angle</span>
<a name="ln-11168"></a>          <span class="n">InsideDifReflectance</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11169"></a>                                  <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11170"></a>                                  <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">BlReflectSolDiffBack</span><span class="p">)</span>
<a name="ln-11171"></a>        <span class="k">END IF</span>
<a name="ln-11172"></a><span class="k">        </span><span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11173"></a>                        <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11174"></a>                        <span class="o">*</span> <span class="n">InsideDifReflectance</span>
<a name="ln-11175"></a>
<a name="ln-11176"></a>        <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-11177"></a>        <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11178"></a>                                      <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-11179"></a>
<a name="ln-11180"></a>        <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11181"></a>        <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-11182"></a>        <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-11183"></a>
<a name="ln-11184"></a>        <span class="c">! Now calc diffuse solar absorbed by shade/blind itself</span>
<a name="ln-11185"></a>        <span class="n">BlNum</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">BlindNumber</span>
<a name="ln-11186"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGShadeOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtScreenOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11187"></a>          <span class="c">! Calc diffuse solar absorbed by shade or screen [W]</span>
<a name="ln-11188"></a>          <span class="n">ShBlDifSolarAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBackShade</span>
<a name="ln-11189"></a>        <span class="k">END IF</span>
<a name="ln-11190"></a><span class="k">        IF</span><span class="p">(</span><span class="n">ShadeFlag</span><span class="o">==</span><span class="n">IntBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">ExtBlindOn</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">ShadeFlag</span><span class="o">==</span><span class="n">BGBlindOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11191"></a>          <span class="c">! Calc diffuse solar absorbed by blind [W]</span>
<a name="ln-11192"></a>          <span class="n">AbsDiffBkBl</span> <span class="o">=</span> <span class="n">InterpSlatAng</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SlatAngThisTS</span><span class="p">,</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">MovableSlats</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-11193"></a>                                 <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBackBlind</span><span class="p">)</span>
<a name="ln-11194"></a>          <span class="n">ShBlDifSolarAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="o">*</span> <span class="n">ViewFactor</span> <span class="o">*</span> <span class="n">AbsDiffBkBl</span>
<a name="ln-11195"></a>        <span class="k">END IF</span>
<a name="ln-11196"></a>        <span class="c">! Correct for divider shadowing</span>
<a name="ln-11197"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtShadeOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtBlindOn</span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">ExtScreenOn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11198"></a>          <span class="n">ShBlDifSolarAbsW</span> <span class="o">=</span> <span class="n">ShBlDifSolarAbsW</span> <span class="o">*</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">GlazedFrac</span>
<a name="ln-11199"></a>
<a name="ln-11200"></a>        <span class="c">! Accumulate diffuse solar absorbed  by shade or screen [W/m2] for heat balance calcs</span>
<a name="ln-11201"></a>        <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">InitialDifSolAbsByShade</span> <span class="o">=</span> <span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">InitialDifSolAbsByShade</span> <span class="p">&amp;</span>
<a name="ln-11202"></a>                                                            <span class="o">+</span> <span class="p">(</span><span class="n">ShBlDifSolarAbsW</span> <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11203"></a>
<a name="ln-11204"></a>        <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-11205"></a>        <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">ShBlDifSolarAbsW</span>
<a name="ln-11206"></a>
<a name="ln-11207"></a>        <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11208"></a>        <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">ShBlDifSolarAbsW</span>  <span class="c">! debug</span>
<a name="ln-11209"></a>        <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">ShBlDifSolarAbsW</span>  <span class="c">! debug</span>
<a name="ln-11210"></a>
<a name="ln-11211"></a>        <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11212"></a>        <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-11213"></a>        <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-11214"></a>        <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11215"></a>                        <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11216"></a>                        <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-11217"></a>                        <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-11218"></a>        <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-11219"></a>        <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-11220"></a>
<a name="ln-11221"></a>        <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-11222"></a>        <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11223"></a>                                                 <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-11224"></a>                                                 <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11225"></a>
<a name="ln-11226"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">ShadeFlag</span> <span class="o">==</span> <span class="n">SwitchableGlazing</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">! Switchable glazing</span>
<a name="ln-11227"></a>        <span class="c">! Init accumulator for transmittance calc below</span>
<a name="ln-11228"></a>        <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11229"></a>
<a name="ln-11230"></a>        <span class="k">DO </span><span class="n">IGlass</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">TotGlassLayers</span>
<a name="ln-11231"></a>          <span class="c">! Calc diffuse solar absorbed in each window glass layer</span>
<a name="ln-11232"></a>          <span class="n">WinDifSolLayAbsW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11233"></a>                              <span class="o">*</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11234"></a>                                <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-11235"></a>                                <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">AbsDiffBack</span><span class="p">(</span><span class="n">IGlass</span><span class="p">))</span>
<a name="ln-11236"></a>
<a name="ln-11237"></a>          <span class="c">! Accumulate distributed diffuse solar absorbed [W] by overall window for transmittance calc below</span>
<a name="ln-11238"></a>          <span class="n">DifSolarAbsW</span> <span class="o">=</span> <span class="n">DifSolarAbsW</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>
<a name="ln-11239"></a>
<a name="ln-11240"></a>          <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11241"></a>          <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-11242"></a>          <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolLayAbsW</span>  <span class="c">! debug</span>
<a name="ln-11243"></a>
<a name="ln-11244"></a>          <span class="c">! Accumulate diffuse solar absorbed from the inside by each window glass layer [W/m2] for heat balance calcs</span>
<a name="ln-11245"></a>          <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolwinAbs</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">,</span><span class="n">IGlass</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-11246"></a>                                                           <span class="o">+</span> <span class="p">(</span><span class="n">WinDifSolLayAbsW</span>  <span class="p">&amp;</span>
<a name="ln-11247"></a>                                                           <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11248"></a>
<a name="ln-11249"></a>        <span class="k">END DO</span>
<a name="ln-11250"></a>
<a name="ln-11251"></a>        <span class="c">! Calc diffuse solar reflected back to zone</span>
<a name="ln-11252"></a>        <span class="n">DifSolarReflW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11253"></a>                        <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11254"></a>                        <span class="o">*</span> <span class="n">InterpSw</span><span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">SwitchingFactor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11255"></a>                          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNum</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-11256"></a>                          <span class="n">Construct</span><span class="p">(</span><span class="n">ConstrNumSh</span><span class="p">)%</span><span class="n">ReflectSolDiffBack</span><span class="p">)</span>
<a name="ln-11257"></a>
<a name="ln-11258"></a>        <span class="c">! Accumulate total reflected distributed diffuse solar for each zone for subsequent interreflection calcs</span>
<a name="ln-11259"></a>        <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialZoneDifSolReflW</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11260"></a>                                      <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! [W]</span>
<a name="ln-11261"></a>
<a name="ln-11262"></a>        <span class="c">! Accumulate Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11263"></a>        <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-11264"></a>        <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">DifSolarReflW</span> <span class="c">! debug</span>
<a name="ln-11265"></a>
<a name="ln-11266"></a>        <span class="c">! Accumulate transmitted Window and Zone total distributed diffuse solar to check for conservation of energy</span>
<a name="ln-11267"></a>        <span class="c">! This is not very effective since it assigns whatever distributed diffuse solar has not been</span>
<a name="ln-11268"></a>        <span class="c">! absorbed or reflected to transmitted.</span>
<a name="ln-11269"></a>        <span class="n">DifSolarTransW</span> <span class="o">=</span> <span class="n">IntWinDifSolarTransW</span> <span class="p">&amp;</span>
<a name="ln-11270"></a>                        <span class="o">*</span> <span class="n">ViewFactor</span> <span class="p">&amp;</span>
<a name="ln-11271"></a>                        <span class="o">-</span> <span class="n">DifSolarAbsW</span> <span class="p">&amp;</span>
<a name="ln-11272"></a>                        <span class="o">-</span> <span class="n">DifSolarReflW</span>
<a name="ln-11273"></a>        <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span>  <span class="c">! debug [W]</span>
<a name="ln-11274"></a>        <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">=</span> <span class="n">ZoneDifSolarDistTransmittedTotl</span> <span class="o">+</span> <span class="n">DifSolarTransW</span> <span class="c">! debug [W]</span>
<a name="ln-11275"></a>
<a name="ln-11276"></a>        <span class="c">! Accumulate transmitted diffuse solar for reporting</span>
<a name="ln-11277"></a>        <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="o">=</span> <span class="n">InitialDifSolInTrans</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-11278"></a>                                                 <span class="o">+</span> <span class="p">(</span><span class="n">DifSolarTransW</span>  <span class="p">&amp;</span>
<a name="ln-11279"></a>                                                 <span class="o">/</span> <span class="n">Surface</span><span class="p">(</span><span class="n">HeatTransSurfNum</span><span class="p">)%</span><span class="n">Area</span><span class="p">)</span>
<a name="ln-11280"></a>
<a name="ln-11281"></a>      <span class="k">END IF</span>  <span class="c">! End of shading flag check</span>
<a name="ln-11282"></a>
<a name="ln-11283"></a><span class="c">! HERE 8/14/07 Ignore absorptance and reflectance of Frames and Dividers for now.</span>
<a name="ln-11284"></a><span class="c">! I would need revised view factors that included these surface types.</span>
<a name="ln-11285"></a><span class="c">! By ignoring them here, the diffuse solar is accounted for on the other surfaces</span>
<a name="ln-11286"></a>
<a name="ln-11287"></a><span class="c">!          IF(SurfaceWindow(HeatTransSurfNum)%FrameArea &gt; 0.0) THEN  ! Window has a frame</span>
<a name="ln-11288"></a>            <span class="c">! Note that FrameQRadInAbs is initially calculated in InitSolarHeatGains</span>
<a name="ln-11289"></a><span class="c">!          END IF</span>
<a name="ln-11290"></a>
<a name="ln-11291"></a><span class="c">!          IF(SurfaceWindow(HeatTransSurfNum)%DividerArea &gt; 0.0) THEN  ! Window has dividers</span>
<a name="ln-11292"></a><span class="c">!            DividerSolAbs = SurfaceWindow(HeatTransSurfNum)%DividerSolAbsorp</span>
<a name="ln-11293"></a><span class="c">!            IF(SurfaceWindow(HeatTransSurfNum)%DividerType == Suspended) THEN ! Suspended divider; account for inside glass</span>
<a name="ln-11294"></a><span class="c">!              MatNumGl = Construct(ConstrNum)%LayerPoint(Construct(ConstrNum)%TotLayers)</span>
<a name="ln-11295"></a><span class="c">!              TransGl = Material(MatNumGl)%Trans</span>
<a name="ln-11296"></a><span class="c">!              ReflGl = Material(MatNumGl)%ReflectSolDiffBack</span>
<a name="ln-11297"></a><span class="c">!              AbsGl = 1.-TransGl-ReflGl</span>
<a name="ln-11298"></a><span class="c">!              DividerSolRefl = 1.-DividerSolAbs</span>
<a name="ln-11299"></a><span class="c">!              DividerSolAbs = AbsGl + TransGl*(DividerSolAbs + DividerSolRefl*AbsGl)/(1.-DividerSolRefl*ReflGl)</span>
<a name="ln-11300"></a><span class="c">!            END IF</span>
<a name="ln-11301"></a>            <span class="c">! Correct for interior shade transmittance</span>
<a name="ln-11302"></a><span class="c">!            IF(ShadeFlag == IntShadeOn) THEN</span>
<a name="ln-11303"></a><span class="c">!              MatNumSh = Construct(ConstrNumSh)%LayerPoint(Construct(ConstrNumSh)%TotLayers)</span>
<a name="ln-11304"></a><span class="c">!              DividerSolAbs = DividerSolAbs * Material(MatNumSh)%Trans</span>
<a name="ln-11305"></a><span class="c">!            ELSE IF(ShadeFlag == IntBlindOn) THEN</span>
<a name="ln-11306"></a><span class="c">!              DividerSolAbs = DividerSolAbs * InterpSlatAng(SurfaceWindow(HeatTransSurfNum)%SlatAngThisTS, &amp;</span>
<a name="ln-11307"></a><span class="c">!                  SurfaceWindow(HeatTransSurfNum)%MovableSlats,Blind(BlNum)%SolBackDiffDiffTrans)</span>
<a name="ln-11308"></a><span class="c">!            END IF</span>
<a name="ln-11309"></a>            <span class="c">! Note that DividerQRadInAbs is initially calculated in InitSolarHeatGains</span>
<a name="ln-11310"></a>
<a name="ln-11311"></a><span class="c">!          END IF  ! Window has dividers</span>
<a name="ln-11312"></a>    <span class="k">END IF</span>  <span class="c">! opaque or window heat transfer surface</span>
<a name="ln-11313"></a>
<a name="ln-11314"></a>  <span class="k">END DO</span>  <span class="c">! HeatTransSurfNum = Zone(ZoneNum)%SurfaceFirst, Zone(ZoneNum)%SurfaceLast</span>
<a name="ln-11315"></a>
<a name="ln-11316"></a>  <span class="c">! Check debug var for view factors here</span>
<a name="ln-11317"></a>  <span class="c">! ViewFactorTotal</span>
<a name="ln-11318"></a>  <span class="c">! Check debug vars for individual transmitting surfaces here</span>
<a name="ln-11319"></a>  <span class="n">WinDifSolarDistTotl</span> <span class="o">=</span> <span class="n">WinDifSolarDistAbsorbedTotl</span> <span class="o">+</span> <span class="n">WinDifSolarDistReflectedTotl</span> <span class="o">+</span> <span class="n">WinDifSolarDistTransmittedTotl</span>
<a name="ln-11320"></a>  <span class="c">! WinDifSolarTrans</span>
<a name="ln-11321"></a>
<a name="ln-11322"></a>  <span class="k">RETURN</span>
<a name="ln-11323"></a>
<a name="ln-11324"></a><span class="k">END SUBROUTINE </span><span class="n">CalcInteriorWinTransDifSolInitialDistribution</span>
<a name="ln-11325"></a>
<a name="ln-11326"></a><span class="k">subroutine </span><span class="n">CalcComplexWindowOverlap</span><span class="p">(</span><span class="n">Geom</span><span class="p">,</span> <span class="n">Window</span><span class="p">,</span> <span class="n">ISurf</span><span class="p">)</span>
<a name="ln-11327"></a>  <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11328"></a>  <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-11329"></a>  <span class="c">!       DATE WRITTEN   May 2012</span>
<a name="ln-11330"></a>  <span class="c">!       MODIFIED       Simon Vidanovic (May 2013) - added overlaps calculations for daylighting</span>
<a name="ln-11331"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11332"></a>
<a name="ln-11333"></a>  <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11334"></a>  <span class="c">! For each of basis directions on back surface of the window calculates</span>
<a name="ln-11335"></a>  <span class="c">! overlap areas. It also calculates overlap areas and reflectances for daylighting calculations</span>
<a name="ln-11336"></a>
<a name="ln-11337"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11338"></a>  <span class="c">! na</span>
<a name="ln-11339"></a>
<a name="ln-11340"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-11341"></a>  <span class="c">! na</span>
<a name="ln-11342"></a>
<a name="ln-11343"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-11344"></a>  <span class="k">USE </span><span class="n">vectors</span>
<a name="ln-11345"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span> <span class="n">ONLY</span> <span class="p">:</span> <span class="n">Material</span>
<a name="ln-11346"></a>
<a name="ln-11347"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-11348"></a>
<a name="ln-11349"></a>  <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-11350"></a>
<a name="ln-11351"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>      <span class="kd">::</span>  <span class="n">ISurf</span>    <span class="c">!Surface number of the complex fenestration</span>
<a name="ln-11352"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">BSDFWindowGeomDescr</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span>  <span class="n">Window</span>  <span class="c">!Window Geometry</span>
<a name="ln-11353"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">BSDFGeomDescr</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span>  <span class="n">Geom</span>    <span class="c">!State Geometry</span>
<a name="ln-11354"></a>  <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-11355"></a>
<a name="ln-11356"></a>  <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-11357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span>  <span class="n">XShadowProjection</span>   <span class="c">! temporary buffer</span>
<a name="ln-11358"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span>  <span class="n">YShadowProjection</span>   <span class="c">! temporary buffer</span>
<a name="ln-11359"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span>  <span class="n">XSp</span>           <span class="c">!for calc BSDF projection direction</span>
<a name="ln-11360"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span>  <span class="n">YSp</span>           <span class="c">!for calc BSDF projection direction</span>
<a name="ln-11361"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span>  <span class="n">ZSp</span>           <span class="c">!for calc BSDF projection direction</span>
<a name="ln-11362"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span>  <span class="n">SdotX</span>           <span class="c">!temporary variable for manipulating .dot. product</span>
<a name="ln-11363"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span>  <span class="n">SdotY</span>           <span class="c">!temporary variable for manipulating .dot. product</span>
<a name="ln-11364"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span>  <span class="n">SdotZ</span>           <span class="c">!temporary variable for manipulating .dot. product</span>
<a name="ln-11365"></a>  <span class="kt">INTEGER</span>         <span class="kd">::</span> <span class="n">BackSurfaceNumber</span> <span class="c">! current back surface number</span>
<a name="ln-11366"></a>  <span class="kt">INTEGER </span><span class="n">NVR</span>
<a name="ln-11367"></a>  <span class="kt">INTEGER </span><span class="n">NVT</span>  <span class="c">! Number of vertices of back surface</span>
<a name="ln-11368"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">XVT</span>    <span class="c">! X,Y,Z coordinates of vertices of</span>
<a name="ln-11369"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">YVT</span>    <span class="c">! back surfaces projected into system</span>
<a name="ln-11370"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">SAVE</span> <span class="kd">::</span> <span class="n">ZVT</span>    <span class="c">! relative to receiving surface</span>
<a name="ln-11371"></a>  <span class="kt">INTEGER </span><span class="n">NS1</span>      <span class="c">! Number of the figure being overlapped</span>
<a name="ln-11372"></a>  <span class="kt">INTEGER </span><span class="n">NS2</span>      <span class="c">! Number of the figure doing overlapping</span>
<a name="ln-11373"></a>  <span class="kt">INTEGER </span><span class="n">NS3</span>      <span class="c">! Location to place results of overlap</span>
<a name="ln-11374"></a>  <span class="kt">INTEGER </span><span class="n">IRay</span>     <span class="c">! Current ray of BSDF direction</span>
<a name="ln-11375"></a>  <span class="kt">INTEGER </span><span class="n">KBkSurf</span>  <span class="c">! Current back surface</span>
<a name="ln-11376"></a>  <span class="kt">INTEGER </span><span class="n">BaseSurf</span> <span class="c">! Base surface number</span>
<a name="ln-11377"></a>  <span class="kt">INTEGER </span><span class="n">N</span><span class="p">,</span> <span class="n">M</span>
<a name="ln-11378"></a>  <span class="kt">INTEGER </span><span class="n">CurBaseSurf</span> <span class="c">! Currnet base surface number for shadow overlap calcualtions</span>
<a name="ln-11379"></a>  <span class="kt">INTEGER </span><span class="n">curBackSurface</span> <span class="c">! Current back surface number for base surface</span>
<a name="ln-11380"></a>  <span class="kt">INTEGER </span><span class="n">LOCStore</span> <span class="c">! Use to store pointer to highes data in local array</span>
<a name="ln-11381"></a>                   <span class="c">! When that counter is used in this routine, it just</span>
<a name="ln-11382"></a>                   <span class="c">! can be taken back to old number because all results</span>
<a name="ln-11383"></a>                   <span class="c">! are stored within this routine</span>
<a name="ln-11384"></a>
<a name="ln-11385"></a>  <span class="c">! Daylighting</span>
<a name="ln-11386"></a>  <span class="kt">INTEGER </span><span class="n">IConst</span>   <span class="c">! Construction number of back surface</span>
<a name="ln-11387"></a>  <span class="kt">INTEGER </span><span class="n">InsideConLay</span> <span class="c">! Construction&#39;s inside material layer number</span>
<a name="ln-11388"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">VisibleReflectance</span>  <span class="c">! Visible reflectance for inside surface material</span>
<a name="ln-11389"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotAOverlap</span>     <span class="c">! Total overlap area for given outgoing direction</span>
<a name="ln-11390"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">TotARhoVisOverlap</span> <span class="c">! Total overlap area time reflectance for given outgoing direction</span>
<a name="ln-11391"></a>
<a name="ln-11392"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">XVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-11393"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">YVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-11394"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">ZVT</span><span class="p">(</span><span class="n">MaxVerticesPerSurface</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-11395"></a>  <span class="n">XVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11396"></a>  <span class="n">YVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11397"></a>  <span class="n">ZVT</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11398"></a>
<a name="ln-11399"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">Geom</span><span class="p">%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span><span class="p">,</span> <span class="n">Window</span><span class="p">%</span><span class="n">NBkSurf</span><span class="p">))</span>
<a name="ln-11400"></a>  <span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11401"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Geom</span><span class="p">%</span><span class="n">ARhoVisOverlap</span><span class="p">(</span><span class="n">Geom</span><span class="p">%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span><span class="p">,</span> <span class="n">Window</span><span class="p">%</span><span class="n">NBkSurf</span><span class="p">))</span>
<a name="ln-11402"></a>  <span class="n">Geom</span><span class="p">%</span><span class="n">ARhoVisOverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11403"></a>  <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Geom</span><span class="p">%</span><span class="n">AveRhoVisOverlap</span><span class="p">(</span><span class="n">Geom</span><span class="p">%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span><span class="p">))</span>
<a name="ln-11404"></a>  <span class="n">Geom</span><span class="p">%</span><span class="n">AveRhoVisOverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11405"></a>
<a name="ln-11406"></a>  <span class="c">! First to calculate and store coordinates of the window surface</span>
<a name="ln-11407"></a>  <span class="n">LOCHCA</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-11408"></a>  <span class="n">BaseSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-11409"></a>
<a name="ln-11410"></a>  <span class="c">! Base surface contains current window surface (ISurf).</span>
<a name="ln-11411"></a>  <span class="c">! Since that is case, bellow transformation should always return ZVT = 0.0d0</span>
<a name="ln-11412"></a>  <span class="c">! for every possible transformation</span>
<a name="ln-11413"></a>  <span class="k">CALL </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">ISurf</span><span class="p">,</span><span class="n">BaseSurf</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-11414"></a>
<a name="ln-11415"></a>  <span class="c">! HTRANS routine is using coordinates stored in XVS and YVS in order to calculate</span>
<a name="ln-11416"></a>  <span class="c">! surface area.  Since both projections are equal to zero, then simply</span>
<a name="ln-11417"></a>  <span class="c">! compy these values into XVS and YVS arrays</span>
<a name="ln-11418"></a>  <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-11419"></a>    <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11420"></a>    <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11421"></a>  <span class="k">END DO</span>
<a name="ln-11422"></a>
<a name="ln-11423"></a>  <span class="c">! This calculates the area stored in XVS and YVS</span>
<a name="ln-11424"></a>  <span class="c">!CALL HTRANS(1,LOCHCA,NVT)</span>
<a name="ln-11425"></a>  <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">,</span><span class="n">NVT</span><span class="p">)</span>
<a name="ln-11426"></a>  <span class="c">!HCAREA(LOCHCA) = -HCAREA(LOCHCA)</span>
<a name="ln-11427"></a>
<a name="ln-11428"></a>  <span class="c">! Calculation of overlap areas for each outgoing basis direction</span>
<a name="ln-11429"></a>  <span class="k">DO </span><span class="n">IRay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Geom</span><span class="p">%</span><span class="n">Trn</span><span class="p">%</span><span class="n">NBasis</span> <span class="c">! basis directions loop (on back surface)</span>
<a name="ln-11430"></a>    <span class="c">! For current basis direction calculate dot product between window surface</span>
<a name="ln-11431"></a>    <span class="c">! and basis direction.  This will be used to calculate projection of each</span>
<a name="ln-11432"></a>    <span class="c">! of the back surfaces to window surface for given basis direciton</span>
<a name="ln-11433"></a>    <span class="n">SdotX</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">lcsx</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">Geom</span><span class="p">%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">IRay</span><span class="p">)</span>
<a name="ln-11434"></a>    <span class="n">SdotY</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">lcsy</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">Geom</span><span class="p">%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">IRay</span><span class="p">)</span>
<a name="ln-11435"></a>    <span class="n">SdotZ</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">ISurf</span><span class="p">)%</span><span class="n">lcsz</span><span class="p">.</span><span class="n">dot</span><span class="p">.</span><span class="n">Geom</span><span class="p">%</span><span class="n">sTrn</span><span class="p">(</span><span class="n">IRay</span><span class="p">)</span>
<a name="ln-11436"></a>    <span class="n">XSp</span> <span class="o">=</span> <span class="o">-</span><span class="n">SdotX</span>
<a name="ln-11437"></a>    <span class="n">YSp</span> <span class="o">=</span> <span class="o">-</span><span class="n">SdotY</span>
<a name="ln-11438"></a>    <span class="n">ZSp</span> <span class="o">=</span> <span class="o">-</span><span class="n">SdotZ</span>
<a name="ln-11439"></a>
<a name="ln-11440"></a>    <span class="c">! Projection of shadows for current basis direciton</span>
<a name="ln-11441"></a>    <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ZSp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1.d-4</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11442"></a><span class="k">      </span><span class="n">XShadowProjection</span> <span class="o">=</span> <span class="n">XSp</span><span class="o">/</span><span class="n">ZSp</span>
<a name="ln-11443"></a>      <span class="n">YShadowProjection</span> <span class="o">=</span> <span class="n">YSp</span><span class="o">/</span><span class="n">ZSp</span>
<a name="ln-11444"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">XShadowProjection</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-8</span><span class="p">)</span> <span class="n">XShadowProjection</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11445"></a>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">YShadowProjection</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.d-8</span><span class="p">)</span> <span class="n">YShadowProjection</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-11446"></a>    <span class="k">ELSE</span>
<a name="ln-11447"></a><span class="k">      </span><span class="n">XShadowProjection</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11448"></a>      <span class="n">YShadowProjection</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11449"></a>    <span class="n">ENDIF</span>
<a name="ln-11450"></a>
<a name="ln-11451"></a>    <span class="k">DO </span><span class="n">KBkSurf</span>  <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">Window</span><span class="p">%</span><span class="n">NBkSurf</span>    <span class="c">!back surf loop</span>
<a name="ln-11452"></a>      <span class="c">!BaseSurf = Surface(ISurf)%BaseSurf</span>
<a name="ln-11453"></a>      <span class="n">BackSurfaceNumber</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">KBkSurf</span><span class="p">)</span>
<a name="ln-11454"></a>
<a name="ln-11455"></a>      <span class="c">! Transform coordinates of back surface from general system to the</span>
<a name="ln-11456"></a>      <span class="c">! plane of the receiving surface</span>
<a name="ln-11457"></a>      <span class="k">CALL </span><span class="n">CTRANS</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">,</span><span class="n">BaseSurf</span><span class="p">,</span><span class="n">NVT</span><span class="p">,</span><span class="n">XVT</span><span class="p">,</span><span class="n">YVT</span><span class="p">,</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-11458"></a>
<a name="ln-11459"></a>      <span class="c">! Project &quot;shadow&quot; from back surface along sun&#39;s rays to receiving surface.  Back surface vertices</span>
<a name="ln-11460"></a>      <span class="c">! become clockwise sequential.</span>
<a name="ln-11461"></a>
<a name="ln-11462"></a>      <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NVT</span>
<a name="ln-11463"></a>        <span class="n">XVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">XVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">XShadowProjection</span><span class="o">*</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11464"></a>        <span class="n">YVS</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">=</span> <span class="n">YVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">-</span> <span class="n">YShadowProjection</span><span class="o">*</span><span class="n">ZVT</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<a name="ln-11465"></a>      <span class="k">END DO</span>
<a name="ln-11466"></a>
<a name="ln-11467"></a>      <span class="c">! Transform to the homogeneous coordinate system.</span>
<a name="ln-11468"></a>
<a name="ln-11469"></a>      <span class="n">NS3</span>      <span class="o">=</span> <span class="n">LOCHCA</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-11470"></a>      <span class="c">!NS3      = LOCHCA</span>
<a name="ln-11471"></a>      <span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11472"></a>      <span class="c">!CALL HTRANS(1,NS3,NVT)</span>
<a name="ln-11473"></a>      <span class="k">CALL </span><span class="n">HTRANS1</span><span class="p">(</span><span class="n">NS3</span><span class="p">,</span><span class="n">NVT</span><span class="p">)</span>
<a name="ln-11474"></a>
<a name="ln-11475"></a>      <span class="c">! Determine area of overlap of projected back surface and receiving surface.</span>
<a name="ln-11476"></a>
<a name="ln-11477"></a>      <span class="n">NS1</span>      <span class="o">=</span> <span class="mi">1</span>
<a name="ln-11478"></a>      <span class="n">NS2</span>      <span class="o">=</span> <span class="n">NS3</span>
<a name="ln-11479"></a>      <span class="n">HCT</span><span class="p">(</span><span class="n">NS3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-11480"></a>      <span class="k">CALL </span><span class="n">DeterminePolygonOverlap</span><span class="p">(</span><span class="n">NS1</span><span class="p">,</span><span class="n">NS2</span><span class="p">,</span><span class="n">NS3</span><span class="p">)</span>
<a name="ln-11481"></a>
<a name="ln-11482"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">NoOverlap</span><span class="p">)</span> <span class="k">CYCLE</span> <span class="c">! to next back surface</span>
<a name="ln-11483"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyVertices</span><span class="p">).</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-11484"></a>        <span class="p">(</span><span class="n">OverlapStatus</span> <span class="o">==</span> <span class="n">TooManyFigures</span><span class="p">)</span> <span class="p">)</span> <span class="k">EXIT</span> <span class="c">! back surfaces DO loop</span>
<a name="ln-11485"></a>
<a name="ln-11486"></a>      <span class="n">LOCHCA</span>         <span class="o">=</span> <span class="n">NS3</span>
<a name="ln-11487"></a>      <span class="n">HCNS</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>   <span class="o">=</span> <span class="n">BackSurfaceNumber</span>
<a name="ln-11488"></a>      <span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>
<a name="ln-11489"></a>
<a name="ln-11490"></a>      <span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">KBkSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">HCAREA</span><span class="p">(</span><span class="n">LOCHCA</span><span class="p">)</span>
<a name="ln-11491"></a>    <span class="k">END DO</span> <span class="c">! DO KBkSurf  = 1 , NBkSurf</span>
<a name="ln-11492"></a>
<a name="ln-11493"></a>    <span class="c">! If some of back surfaces is contained in base surface, then need to substract shadow of subsurface</span>
<a name="ln-11494"></a>    <span class="c">! from shadow on base surface.  Reson is that above shadowing algorithm is calculating shadow wihtout</span>
<a name="ln-11495"></a>    <span class="c">! influence of subsurfaces</span>
<a name="ln-11496"></a>    <span class="k">DO </span><span class="n">KBkSurf</span>  <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">Window</span><span class="p">%</span><span class="n">NBkSurf</span>    <span class="c">!back surf loop</span>
<a name="ln-11497"></a>      <span class="n">BackSurfaceNumber</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">KBkSurf</span><span class="p">)</span>
<a name="ln-11498"></a>      <span class="n">CurBaseSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-11499"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CurBaseSurf</span> <span class="o">/=</span> <span class="n">BackSurfaceNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11500"></a>        <span class="c">! Search if that base surface in list of back surfaces for current window</span>
<a name="ln-11501"></a>        <span class="n">CurBackSurface</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-11502"></a>        <span class="k">DO </span><span class="n">N</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Window</span><span class="p">%</span><span class="n">NBkSurf</span>
<a name="ln-11503"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ShadowComb</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">==</span> <span class="n">CurBaseSurf</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11504"></a><span class="k">            </span><span class="n">curBackSurface</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-11505"></a>            <span class="k">EXIT</span>
<a name="ln-11506"></a><span class="k">          END IF</span>
<a name="ln-11507"></a><span class="k">        END DO</span>
<a name="ln-11508"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">CurBackSurface</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11509"></a><span class="k">          </span><span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">curBackSurface</span><span class="p">)</span> <span class="o">=</span> <span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">curBackSurface</span><span class="p">)</span> <span class="o">-</span> <span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">KBkSurf</span><span class="p">)</span>
<a name="ln-11510"></a>        <span class="k">END IF</span>
<a name="ln-11511"></a><span class="k">      END IF</span>
<a name="ln-11512"></a><span class="k">    END DO</span>
<a name="ln-11513"></a>
<a name="ln-11514"></a>    <span class="c">! Calculate overlap area times reflectance.  This is necessary for complex fenestration daylighting calculations</span>
<a name="ln-11515"></a>    <span class="n">TotAOverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11516"></a>    <span class="n">TotARhoVisOverlap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-11517"></a>    <span class="k">DO </span><span class="n">KBkSurf</span>  <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">Window</span><span class="p">%</span><span class="n">NBkSurf</span>    <span class="c">!back surf loop</span>
<a name="ln-11518"></a>      <span class="n">BackSurfaceNumber</span> <span class="o">=</span> <span class="n">ShadowComb</span><span class="p">(</span><span class="n">BaseSurf</span><span class="p">)%</span><span class="n">BackSurf</span><span class="p">(</span><span class="n">KBkSurf</span><span class="p">)</span>
<a name="ln-11519"></a>      <span class="n">CurBaseSurf</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">BaseSurf</span>
<a name="ln-11520"></a>      <span class="n">IConst</span> <span class="o">=</span> <span class="n">Surface</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">Construction</span>
<a name="ln-11521"></a>      <span class="n">InsideConLay</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">TotLayers</span>
<a name="ln-11522"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">BackSurfaceNumber</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11523"></a><span class="k">        </span><span class="n">VisibleReflectance</span> <span class="o">=</span> <span class="n">Construct</span><span class="p">(</span><span class="n">IConst</span><span class="p">)%</span><span class="n">ReflectVisDiffBack</span>
<a name="ln-11524"></a>      <span class="k">ELSE</span>
<a name="ln-11525"></a><span class="k">        </span><span class="n">VisibleReflectance</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span>  <span class="n">Material</span><span class="p">(</span><span class="n">InsideConLay</span><span class="p">)%</span><span class="n">AbsorpVisible</span><span class="p">)</span>
<a name="ln-11526"></a>      <span class="k">END IF</span>
<a name="ln-11527"></a><span class="k">      </span><span class="n">Geom</span><span class="p">%</span><span class="n">ARhoVisoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">KBkSurf</span><span class="p">)</span> <span class="o">=</span> <span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">KBkSurf</span><span class="p">)</span> <span class="o">*</span> <span class="n">VisibleReflectance</span>
<a name="ln-11528"></a>      <span class="n">TotAOverlap</span> <span class="o">=</span> <span class="n">TotAOverlap</span> <span class="o">+</span> <span class="n">Geom</span><span class="p">%</span><span class="n">Aoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">KBkSurf</span><span class="p">)</span>
<a name="ln-11529"></a>      <span class="n">TotARhoVisOverlap</span> <span class="o">=</span> <span class="n">TotARhoVisOverlap</span> <span class="o">+</span> <span class="n">Geom</span><span class="p">%</span><span class="n">ARhoVisoverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">,</span> <span class="n">KBkSurf</span><span class="p">)</span>
<a name="ln-11530"></a>    <span class="k">END DO</span>
<a name="ln-11531"></a>
<a name="ln-11532"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">TotAOverlap</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-11533"></a><span class="k">      </span><span class="n">Geom</span><span class="p">%</span><span class="n">AveRhoVisOverlap</span><span class="p">(</span><span class="n">IRay</span><span class="p">)</span> <span class="o">=</span> <span class="n">TotARhoVisOverlap</span> <span class="o">/</span> <span class="n">TotAOverlap</span>
<a name="ln-11534"></a>    <span class="k">END IF</span>
<a name="ln-11535"></a>
<a name="ln-11536"></a><span class="k">  END DO</span> <span class="c">! DO IRay = 1, Geom%Trn%NBasis</span>
<a name="ln-11537"></a>
<a name="ln-11538"></a>  <span class="c">! Reset back shadowing counter since complex windows do not need it anymore</span>
<a name="ln-11539"></a>  <span class="n">LOCHCA</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-11540"></a>
<a name="ln-11541"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">XVT</span><span class="p">)</span>
<a name="ln-11542"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">YVT</span><span class="p">)</span>
<a name="ln-11543"></a>  <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">ZVT</span><span class="p">)</span>
<a name="ln-11544"></a>
<a name="ln-11545"></a><span class="k">end subroutine </span><span class="n">CalcComplexWindowOverlap</span>
<a name="ln-11546"></a>
<a name="ln-11547"></a><span class="k">subroutine </span><span class="n">TimestepInitComplexFenestration</span>
<a name="ln-11548"></a>  <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-11549"></a>  <span class="c">!       AUTHOR         Simon Vidanovic</span>
<a name="ln-11550"></a>  <span class="c">!       DATE WRITTEN   May 2012</span>
<a name="ln-11551"></a>  <span class="c">!       MODIFIED       May 2012 (Initialize complex fenestration in case of EMS)</span>
<a name="ln-11552"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-11553"></a>
<a name="ln-11554"></a>  <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-11555"></a>  <span class="c">! Performs initialization of complex fenestration. It also performs check if current surface containing</span>
<a name="ln-11556"></a>  <span class="c">! complex fenestration have construction changed (by EMS) in which case performs addition of current states</span>
<a name="ln-11557"></a>  <span class="c">! into complex fenestration array</span>
<a name="ln-11558"></a>
<a name="ln-11559"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-11560"></a>  <span class="c">! na</span>
<a name="ln-11561"></a>
<a name="ln-11562"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-11563"></a>  <span class="c">! na</span>
<a name="ln-11564"></a>
<a name="ln-11565"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-11566"></a>  <span class="k">use </span><span class="n">WindowComplexManager</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">CheckCFSStates</span>
<a name="ln-11567"></a>
<a name="ln-11568"></a>  <span class="kt">integer </span><span class="n">iSurf</span>  <span class="c">! Current surface number</span>
<a name="ln-11569"></a>  <span class="kt">integer </span><span class="n">iState</span> <span class="c">! current state number</span>
<a name="ln-11570"></a>  <span class="kt">integer </span><span class="n">NumOfStates</span> <span class="c">! number of states for current window</span>
<a name="ln-11571"></a>
<a name="ln-11572"></a>
<a name="ln-11573"></a>  <span class="k">do </span><span class="n">iSurf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">TotSurfaces</span>
<a name="ln-11574"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">SurfaceWindow</span><span class="p">(</span><span class="n">iSurf</span><span class="p">)%</span><span class="n">WindowModelType</span> <span class="o">==</span> <span class="n">WindowBSDFModel</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11575"></a>      <span class="c">! This will check complex fenestrations state and add new one if necessary (EMS case)</span>
<a name="ln-11576"></a>      <span class="k">call </span><span class="n">CheckCFSStates</span><span class="p">(</span><span class="n">iSurf</span><span class="p">)</span>
<a name="ln-11577"></a>
<a name="ln-11578"></a>      <span class="n">NumOfStates</span> <span class="o">=</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iSurf</span><span class="p">)%</span><span class="n">NumStates</span>
<a name="ln-11579"></a>
<a name="ln-11580"></a>      <span class="c">! Check for overlap areas and initialize if necessary</span>
<a name="ln-11581"></a>      <span class="k">do </span><span class="n">iState</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumOfStates</span>
<a name="ln-11582"></a>        <span class="c">! do initialization only once</span>
<a name="ln-11583"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">iSurf</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">iState</span><span class="p">)%</span><span class="n">InitState</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-11584"></a><span class="k">          call </span><span class="n">CalcComplexWindowOverlap</span><span class="p">(</span><span class="n">ComplexWind</span><span class="p">(</span><span class="n">iSurf</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">iState</span><span class="p">),</span> <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iSurf</span><span class="p">),</span> <span class="n">iSurf</span><span class="p">)</span>
<a name="ln-11585"></a>          <span class="n">ComplexWind</span><span class="p">(</span><span class="n">iSurf</span><span class="p">)%</span><span class="n">Geom</span><span class="p">(</span><span class="n">iState</span><span class="p">)%</span><span class="n">InitState</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-11586"></a>        <span class="k">end if</span>
<a name="ln-11587"></a><span class="k">      end do</span>
<a name="ln-11588"></a><span class="k">    end if</span>
<a name="ln-11589"></a><span class="k">  end do</span>
<a name="ln-11590"></a>
<a name="ln-11591"></a><span class="k">end subroutine </span><span class="n">TimestepInitComplexFenestration</span>
<a name="ln-11592"></a>
<a name="ln-11593"></a><span class="c">!     NOTICE</span>
<a name="ln-11594"></a><span class="c">!</span>
<a name="ln-11595"></a><span class="c">!     Copyright  1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-11596"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-11597"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-11598"></a><span class="c">!</span>
<a name="ln-11599"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-11600"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-11601"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-11602"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-11603"></a><span class="c">!</span>
<a name="ln-11604"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-11605"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-11606"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-11607"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-11608"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-11609"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-11610"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-11611"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-11612"></a><span class="c">!     permit others to do so.</span>
<a name="ln-11613"></a><span class="c">!</span>
<a name="ln-11614"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-11615"></a>
<a name="ln-11616"></a><span class="k">END MODULE </span><span class="n">SolarShading</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
