<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	 <meta name="description" content="">

    <meta name="author" content="dmey (forked from NREL)" >
    <link rel="icon" href="../favicon.png">

    <title>HVACFurnace.f90 &ndash; EnergyPlusFortran</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>


    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>


  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">EnergyPlusFortran <small>8.1.0.009</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">

            <li><a href="../lists/files.html">Source Files</a></li>


            <li><a href="../lists/modules.html">Modules</a></li>


            <li><a href="../lists/procedures.html">Procedures</a></li>


            <li><a href="../lists/types.html">Derived Types</a></li>


            <li><a href="../program/energyplus.html">Program</a></li>

            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/energyplus.html">Program</a></li>

          </ul>


        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">


  <div class="row">
    <h1>HVACFurnace.f90
    <small>Source File</small>

    </h1>

<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">


     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.8% of total for source files.">6709 statements</a>
     </li>


    <li><i class="fa fa-code"></i><a href="../src/HVACFurnace.f90"> Source File</a></li>

  </ul>
  <ol class="breadcrumb in-well text-right">

     <li class="active">HVACFurnace.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">

<div id="sidebar">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/furnaces.html">Furnaces</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html#src">HVACFurnace.f90</a>
  </div>
</div>


  <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


</div>

    </div>
    <div class="col-md-9" id='text'>


    <h3>This File Depends On</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacfurnace.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilehvacfurnacef90EfferentGraph" width="641pt" height="2785pt"
 viewBox="0.00 0.00 641.00 2785.30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph" class="graph" transform="scale(.1611 .1611) rotate(0) translate(4 17287.2179)">
<title>sourcefile~~hvacfurnace.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-17287.2179 3975.3423,-17287.2179 3975.3423,4 -4,4"/>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<polygon fill="none" stroke="#000000" points="3971.5586,-7139.2218 3874.6953,-7139.2218 3874.6953,-7117.2109 3971.5586,-7117.2109 3971.5586,-7139.2218"/>
<text text-anchor="middle" x="3923.127" y="-7125.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACFurnace.f90</text>
</g>
<!-- sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~hvacwatertoair.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node2"><a xlink:href="../sourcefile/hvacwatertoair.f90.html" xlink:title="HVACWatertoAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2440.8743,-9708.2218 2334.78,-9708.2218 2334.78,-9686.2109 2440.8743,-9686.2109 2440.8743,-9708.2218"/>
<text text-anchor="middle" x="2387.8271" y="-9694.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWatertoAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge884" class="edge">
<title>sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2401.1599,-9708.3749C2421.3408,-9726.2041 2458.9156,-9763.3 2474.269,-9804.2164 2510.8334,-9901.6589 2435.2747,-10668.051 2510.269,-10740.2164 2565.3218,-10793.1924 2620.3273,-10785.0752 2682.1736,-10740.2164 3350.9505,-10255.1339 3040.9286,-9769.979 3259.4165,-8973.2164 3284.0437,-8883.4079 3568.4039,-7411.5849 3624.4519,-7337.2164 3635.079,-7323.1155 3648.6081,-7304.1969 3659.3423,-7318.2164"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node70" class="node">
<title>sourcefile~hvacunitarysystem.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node70"><a xlink:href="../sourcefile/hvacunitarysystem.f90.html" xlink:title="HVACUnitarySystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3588.5407,-4080.2218 3462.1859,-4080.2218 3462.1859,-4058.2109 3588.5407,-4058.2109 3588.5407,-4080.2218"/>
<text text-anchor="middle" x="3525.3633" y="-4066.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACUnitarySystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge297" class="edge">
<title>sourcefile~hvacwatertoair.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2396.1825,-9685.8066C2449.8782,-9611.8289 2748.2175,-9190.8647 2876.0764,-8798.2164 2931.9177,-8626.7307 2971.791,-7325.5708 3089.8293,-7189.2164 3141.0984,-7129.9918 3202.0765,-7194.5848 3259.4165,-7141.2164 3356.3028,-7051.0408 3313.5788,-6984.8466 3360.8456,-6861.2164"/>
</g>
<!-- sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~datahvacglobals.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node3"><a xlink:href="../sourcefile/datahvacglobals.f90.html" xlink:title="DataHVACGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643.4123,-11263.2218 528.0262,-11263.2218 528.0262,-11241.2109 643.4123,-11241.2109 643.4123,-11263.2218"/>
<text text-anchor="middle" x="585.7192" y="-11249.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge885" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.2091,-11263.5521C595.7355,-11328.9944 638.5217,-11665.189 654.4731,-11941.2164 668.9047,-12190.9428 648.1262,-13945.6838 690.4731,-14192.2164 799.6153,-14827.613 814.2453,-15018.4358 1152.5955,-15567.2164 1208.4152,-15657.7521 1275.8833,-15640.9126 1321.0291,-15737.2164 1391.9098,-15888.4174 1275.3014,-15965.5921 1357.0291,-16111.2164 1395.3506,-16179.4986 2197.7954,-16802.2164 2387.8271,-16802.2164 2387.8271,-16802.2164 2387.8271,-16802.2164 2797.125,-16802.2164 3048.2361,-16802.2164 3110.0589,-16751.4558 3360.8456,-16764.2164"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge31" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-11241.2164C1078.4855,-11221.28 1098.5169,-11237.9667 1116.5955,-11217.2164 1157.3866,-11170.3967 1109.3047,-11126.735 1152.5955,-11082.2164 1207.0347,-11026.2331 1272.6578,-11093.5187 1321.0291,-11032.2164 1413.1156,-10915.5124 1279.1989,-10490.8743 1357.0291,-10364.2164 1357.2111,-10363.92 1703.9279,-10164.4044 1704.2205,-10164.2164 1795.626,-10105.474 1812.5625,-10082.102 1903.2231,-10022.2164 2027.1325,-9940.3685 2058.2942,-9919.6801 2188.4692,-9848.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M591.6654,-11263.3974C605.5118,-11288.3335 642.4168,-11348.7698 690.4731,-11380.2164 775.7062,-11435.9902 816.8697,-11403.5667 911.1119,-11442.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-11442.2164C1005.9488,-11496.982 944.4678,-11333.7619 1002.4307,-11265.2164 1020.2011,-11244.2015 1040.5574,-11261.1687 1059.5131,-11241.2164"/>
</g>
<!-- sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~hvacfancomponent.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node4"><a xlink:href="../sourcefile/hvacfancomponent.f90.html" xlink:title="HVACFanComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2661.5107,-11554.2218 2530.9319,-11554.2218 2530.9319,-11532.2109 2661.5107,-11532.2109 2661.5107,-11554.2218"/>
<text text-anchor="middle" x="2596.2213" y="-11540.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACFanComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge54" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M586.1155,-11263.4322C588.8441,-11334.2585 607.2954,-11726.3367 690.4731,-12032.2164 729.4306,-12175.4795 784.3281,-12196.049 819.7932,-12340.2164 864.8645,-12523.4337 833.0918,-12575.9074 855.7932,-12763.2164 874.7944,-12919.9947 872.7114,-12961.0306 911.1119,-13114.2164"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M911.1119,-13114.2164C919.9109,-13150.0823 943.4521,-13147.3067 966.4307,-13176.2164 983.6943,-13197.936 986.2324,-13204.691 1002.4307,-13227.2164 1068.3685,-13318.9096 1072.1809,-13352.9134 1152.5955,-13432.2164 1414.5835,-13690.5829 1536.809,-14012.1345 1867.2231,-13850.2164 2150.0202,-13711.6328 2057.7888,-13489.8169 2301.3853,-13290.2164 2367.7662,-13235.8245 2428.1608,-13276.5968 2474.269,-13204.2164 2516.9062,-13137.2847 2495.3356,-11854.1572 2510.269,-11776.2164 2525.9429,-11694.4114 2566.9071,-11603.3869 2586.0667,-11563.6419"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.3032,-11564.9902 2590.5434,-11554.4682 2583.0123,-11561.9202 2589.3032,-11564.9902"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~hvachxassistedcoolingcoil.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node5"><a xlink:href="../sourcefile/hvachxassistedcoolingcoil.f90.html" xlink:title="HVACHXAssistedCoolingCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3257.4982,-7253.2218 3091.7476,-7253.2218 3091.7476,-7231.2109 3257.4982,-7231.2109 3257.4982,-7253.2218"/>
<text text-anchor="middle" x="3174.6229" y="-7239.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHXAssistedCoolingCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge95" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1059.5131,-11241.2164C1078.4687,-11221.264 1095.7329,-11235.1654 1116.5955,-11217.2164 1139.8815,-11197.1823 1130.1163,-11179.1518 1152.5955,-11158.2164 1214.2527,-11100.7932 1275.1722,-11141.9001 1321.0291,-11071.2164 1397.4702,-10953.3901 1268.9165,-10549.5894 1357.0291,-10440.2164 1461.0086,-10311.1477 1935.1021,-10328.2161 2075.5532,-10240.2164 2302.555,-10097.9882 2320.5698,-10007.6138 2474.269,-9788.2164 2493.4404,-9760.8503 2491.2739,-9749.7051 2510.269,-9722.2164 2543.5859,-9674.0021 2564.4234,-9671.4456 2596.2213,-9622.2164"/>
</g>
<!-- sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~datazoneequipment.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node6"><a xlink:href="../sourcefile/datazoneequipment.f90.html" xlink:title="DataZoneEquipment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.5454,-3966.2218 1740.8982,-3966.2218 1740.8982,-3944.2109 1866.5454,-3944.2109 1866.5454,-3966.2218"/>
<text text-anchor="middle" x="1803.7218" y="-3952.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEquipment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge109" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M755.1332,-6077.2164C766.5927,-6008.4134 801.7344,-6001.5888 819.7932,-5934.2164 861.6536,-5778.0468 788.6707,-5719.3075 855.7932,-5572.2164 925.8574,-5418.6789 1047.9327,-5450.3856 1116.5955,-5296.2164 1197.1433,-5115.3615 1084.0737,-5037.9614 1152.5955,-4852.2164 1196.8204,-4732.3338 1262.8792,-4732.9981 1321.0291,-4619.2164 1344.2464,-4573.7871 1320.8154,-4546.1529 1357.0291,-4510.2164 1381.7471,-4485.6875 1411.5094,-4514.6491 1431.6149,-4486.2164"/>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M587.6101,-11240.9097C597.1413,-11183.2975 640.0283,-10916.5303 654.4731,-10696.2164 662.7459,-10570.0389 642.6601,-6261.2767 690.4731,-6144.2164 706.1211,-6105.9056 748.1134,-6117.9999 755.1332,-6077.2164"/>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1431.6149,-4486.2164C1460.0163,-4447.1648 1480.5738,-4448.1422 1506.2007,-4407.2164 1530.1637,-4368.9477 1507.3729,-4340.9521 1542.2007,-4312.2164 1570.3841,-4288.9628 1603.8266,-4329.1889 1623.2106,-4298.2164"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node13" class="node">
<title>sourcefile~hvacheatingcoils.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node13"><a xlink:href="../sourcefile/hvacheatingcoils.f90.html" xlink:title="HVACHeatingCoils.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3041.8946,-11877.2218 2924.0111,-11877.2218 2924.0111,-11855.2109 3041.8946,-11855.2109 3041.8946,-11877.2218"/>
<text text-anchor="middle" x="2982.9529" y="-11863.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACHeatingCoils.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge237" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2797.125,-13988.2164C2903.1586,-13859.9643 2856.7128,-13787.4942 2876.0764,-13622.2164 2887.269,-13526.6823 2855.7004,-11969.1508 2912.0764,-11891.2164 2914.3515,-11888.0712 2917.0551,-11885.3195 2920.0567,-11882.9121"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.1613,-11885.7176 2928.6089,-11877.3105 2918.3259,-11879.8619 2922.1613,-11885.7176"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M586.6823,-11263.5199C593.4478,-11342.2378 635.1865,-11816.7119 690.4731,-12200.2164 750.25,-12614.8678 756.0415,-12721.3274 855.7932,-13128.2164 894.8403,-13287.49 928.6784,-13320.6309 966.4307,-13480.2164 989.5425,-13577.9142 971.6702,-13607.6507 1002.4307,-13703.2164 1048.2374,-13845.5275 1065.1873,-13882.9294 1152.5955,-14004.2164 1224.1268,-14103.4727 1440.8829,-14324.636 1542.2007,-14393.2164 1621.5137,-14446.9021 1648.1121,-14451.9721 1740.2205,-14478.2164 1965.9656,-14542.5375 2080.131,-14678.3655 2265.3853,-14534.2164 2316.7698,-14494.2333 2260.5097,-14442.8938 2301.3853,-14392.2164 2355.2637,-14325.4181 2423.2645,-14375.234 2474.269,-14306.2164 2532.6326,-14227.2407 2447.6092,-14163.8286 2510.269,-14088.2164 2573.0444,-14012.4647 2624.8722,-14043.4241 2718.1736,-14012.2164 2752.9545,-14000.5827 2773.7561,-14016.482 2797.125,-13988.2164"/>
</g>
<!-- sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node14" class="node">
<title>sourcefile~hvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node14"><a xlink:href="../sourcefile/hvaccontrollers.f90.html" xlink:title="HVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3838.7516,-7139.2218 3730.3927,-7139.2218 3730.3927,-7117.2109 3838.7516,-7117.2109 3838.7516,-7139.2218"/>
<text text-anchor="middle" x="3784.5721" y="-7125.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge625" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3659.3423,-16308.2164C3768.9893,-16165.1842 3685.5454,-16084.2308 3694.2327,-15904.2164 3739.801,-14959.9618 3781.9194,-7598.8267 3784.4518,-7149.6699"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3787.9534,-7149.3811 3784.5098,-7139.3615 3780.9535,-7149.3416 3787.9534,-7149.3811"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M587.1936,-11263.553C595.6333,-11329.0004 638.0186,-11665.2185 654.4731,-11941.2164 666.5963,-12144.5613 655.1525,-13573.5959 690.4731,-13774.2164 697.3639,-13813.3558 1138.4404,-15091.0813 1152.5955,-15128.2164 1221.155,-15308.0792 1275.1213,-15340.2845 1321.0291,-15527.2164 1344.2684,-15621.8446 1311.9138,-15877.8498 1357.0291,-15964.2164 1429.909,-16103.7343 1755.0979,-16361.9655 1903.2231,-16415.2164 1975.2983,-16441.1273 1999.0056,-16417.7992 2075.5532,-16415.2164 2163.6919,-16412.2425 3605.6888,-16378.2062 3659.3423,-16308.2164"/>
</g>
<!-- sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node18" class="node">
<title>sourcefile~branchinputmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node18"><a xlink:href="../sourcefile/branchinputmanager.f90.html" xlink:title="BranchInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1867.2245,-1530.2218 1740.2191,-1530.2218 1740.2191,-1508.2109 1867.2245,-1508.2109 1867.2245,-1530.2218"/>
<text text-anchor="middle" x="1803.7218" y="-1516.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge663" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M587.6153,-11240.91C597.172,-11183.2995 640.1638,-10916.5392 654.4731,-10696.2164 673.8808,-10397.3948 649.0756,-5602.7922 690.4731,-5306.2164 720.1872,-5093.3419 782.2393,-5051.8485 819.7932,-4840.2164 854.5392,-4644.4084 814.4047,-4588.7287 855.7932,-4394.2164 886.588,-4249.4913 938.3553,-4225.4935 966.4307,-4080.2164 1001.7134,-3897.6444 927.5293,-3414.4138 1002.4307,-3244.2164 1031.3138,-3178.5855 1088.1759,-3196.0493 1116.5955,-3130.2164 1171.4012,-3003.2608 1067.6985,-1995.3672 1152.5955,-1886.2164 1176.4903,-1855.4951 1219.6444,-1897.1452 1236.8123,-1862.2164"/>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1236.8123,-1862.2164C1254.0062,-1827.3004 1293.8676,-1866.0914 1321.0291,-1838.2164 1365.8654,-1792.2021 1314.8347,-1746.6647 1357.0291,-1698.2164 1415.4545,-1631.131 1459.664,-1655.4078 1542.2007,-1622.2164 1621.3591,-1590.3835 1714.3806,-1553.9872 1765.4038,-1534.11"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1766.9834,-1537.251 1775.032,-1530.361 1764.4435,-1530.728 1766.9834,-1537.251"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node28" class="node">
<title>sourcefile~hvacwatercoilcomponent.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node28"><a xlink:href="../sourcefile/hvacwatercoilcomponent.f90.html" xlink:title="HVACWaterCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2876.0279,-7234.2218 2718.2221,-7234.2218 2718.2221,-7212.2109 2876.0279,-7212.2109 2876.0279,-7234.2218"/>
<text text-anchor="middle" x="2797.125" y="-7220.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWaterCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge727" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M602.2165,-11263.4366C622.1144,-11276.2288 657.0662,-11296.3809 690.4731,-11304.2164 746.4302,-11317.3409 766.141,-11324.8291 819.7932,-11304.2164 1005.6838,-11232.7989 999.4684,-11131.5266 1152.5955,-11004.2164 1225.1016,-10943.9346 1277.1758,-10958.6905 1321.0291,-10875.2164 1395.1216,-10734.1822 1297.5038,-10306.9902 1357.0291,-10159.2164 1437.3781,-9959.7467 1547.9767,-9969.973 1704.2205,-9822.2164 1785.0595,-9745.7685 1797.2726,-9718.7389 1867.2231,-9632.2164 2050.8918,-9405.0349 2129.9222,-9368.051 2265.3853,-9109.2164 2289.4338,-9063.2659 2273.917,-9042.2081 2301.3853,-8998.2164 2357.9662,-8907.5991 2421.0534,-8923.85 2474.269,-8831.2164 2507.7752,-8772.8916 2475.4861,-8741.7889 2510.269,-8684.2164 2563.0068,-8596.9252 2636.8085,-8623.5566 2682.1736,-8532.2164 2729.5571,-8436.8122 2709.1356,-8160.3553 2718.1736,-8054.2164 2745.6447,-7731.6054 2785.2997,-7339.1643 2794.9488,-7244.4954"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2798.4404,-7244.755 2795.974,-7234.4513 2791.4766,-7244.0442 2798.4404,-7244.755"/>
</g>
<!-- sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node29" class="node">
<title>sourcefile~dxcoil.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node29"><a xlink:href="../sourcefile/dxcoil.f90.html" xlink:title="DXCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2828.313,-9290.2218 2765.937,-9290.2218 2765.937,-9268.2109 2828.313,-9268.2109 2828.313,-9290.2218"/>
<text text-anchor="middle" x="2797.125" y="-9276.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DXCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge764" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M911.1119,-11442.2164C1181.6019,-11598.4166 896.5811,-11923.2752 1152.5955,-12102.2164 1213.9529,-12145.1021 1266.4239,-12153.4239 1321.0291,-12102.2164 1366.5099,-12059.5654 1331.6981,-11599.1896 1357.0291,-11542.2164 1404.9338,-11434.4711 1440.3717,-11411.6703 1542.2007,-11352.2164 1671.2417,-11276.8743 1729.8039,-11324.9018 1867.2231,-11266.2164 1884.4676,-11258.852 1886.7396,-11253.155 1903.2231,-11244.2164 2075.5878,-11150.7474 2117.742,-11122.9272 2301.3853,-11054.2164 2338.7288,-11040.2441 2361.197,-11059.8913 2387.8271,-11030.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2387.8271,-11030.2164C2399.9378,-11017.6 2496.5221,-10751.0266 2510.269,-10740.2164 2540.6933,-10716.2916 2571.8507,-10756.2847 2596.2213,-10726.2164"/>
</g>
<!-- sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node30" class="node">
<title>sourcefile~general.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node30"><a xlink:href="../sourcefile/general.f90.html" xlink:title="General.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="788.502,-9933.2218 721.7644,-9933.2218 721.7644,-9911.2109 788.502,-9911.2109 788.502,-9933.2218"/>
<text text-anchor="middle" x="755.1332" y="-9919.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">General.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge792" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M589.8215,-11240.8639C602.3081,-11205.7013 639.8861,-11095.2434 654.4731,-11000.2164 686.1904,-10793.5945 641.1435,-10263.3546 690.4731,-10060.2164 701.3164,-10015.5642 727.2061,-9967.9843 742.7367,-9941.9995"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="745.7319,-9943.8102 747.9428,-9933.4486 739.7529,-9940.17 745.7319,-9943.8102"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node36" class="node">
<title>sourcefile~hvacsteamcoilcomponent.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node36"><a xlink:href="../sourcefile/hvacsteamcoilcomponent.f90.html" xlink:title="HVACSteamCoilComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2467.9579,-11916.2218 2307.6964,-11916.2218 2307.6964,-11894.2109 2467.9579,-11894.2109 2467.9579,-11916.2218"/>
<text text-anchor="middle" x="2387.8271" y="-11902.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACSteamCoilComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge830" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M588.8664,-11263.5875C622.7607,-11385.3584 923.4947,-12448.5262 1152.5955,-12672.2164 1221.9529,-12739.9358 1261.6252,-12731.0565 1357.0291,-12748.2164 1491.1808,-12772.3457 1864.3323,-12711.3296 1867.2231,-12710.2164 1974.1822,-12669.0263 2006.6808,-12649.8322 2075.5532,-12558.2164 2103.6865,-12520.7928 2081.3926,-12495.0261 2111.5532,-12459.2164 2162.2943,-12398.9714 2217.4628,-12433.7267 2265.3853,-12371.2164 2321.2833,-12298.3027 2371.4053,-12007.4055 2384.5062,-11926.3046"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2387.9834,-11926.725 2386.1059,-11916.2979 2381.0711,-11925.62 2387.9834,-11926.725"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node38" class="node">
<title>sourcefile~hvacwatertoairmultispeedhp.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node38"><a xlink:href="../sourcefile/hvacwatertoairmultispeedhp.f90.html" xlink:title="HVACWatertoAirMultiSpeedHP.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2474.211,-5877.2218 2301.4433,-5877.2218 2301.4433,-5855.2109 2474.211,-5855.2109 2474.211,-5877.2218"/>
<text text-anchor="middle" x="2387.8271" y="-5863.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACWatertoAirMultiSpeedHP.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge850" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2188.4692,-5628.2164C2267.0384,-5675.0049 2239.0651,-5733.295 2301.3853,-5800.2164 2319.2996,-5819.4534 2343.2941,-5837.2864 2361.4577,-5849.5533"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2359.5829,-5852.5096 2369.8537,-5855.1098 2363.4462,-5846.6722 2359.5829,-5852.5096"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M589.9462,-11240.8821C602.7916,-11205.7718 641.2927,-11095.4487 654.4731,-11000.2164 670.2169,-10886.463 635.788,-6967.1977 690.4731,-6866.2164 723.3423,-6805.5204 765.1342,-6822.3681 819.7932,-6780.2164 854.7437,-6753.2634 1097.4569,-6555.9871 1116.5955,-6516.2164 1181.8281,-6380.6604 1061.5759,-5959.9918 1152.5955,-5840.2164 1205.5337,-5770.5534 1816.5542,-5614.2113 1903.2231,-5602.2164 2029.3228,-5584.7643 2079.0928,-5563.0819 2188.4692,-5628.2164"/>
</g>
<!-- sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node50" class="node">
<title>sourcefile~heatrecovery.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node50"><a xlink:href="../sourcefile/heatrecovery.f90.html" xlink:title="HeatRecovery.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3030.7201,-13506.2218 2935.1857,-13506.2218 2935.1857,-13484.2109 3030.7201,-13484.2109 3030.7201,-13506.2218"/>
<text text-anchor="middle" x="2982.9529" y="-13492.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatRecovery.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge77" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.0445,-11263.5632C594.6546,-11329.0674 633.2001,-11665.548 654.4731,-11941.2164 677.0417,-12233.6725 649.4137,-12309.7787 690.4731,-12600.2164 788.8345,-13295.9844 775.1906,-13519.4823 1152.5955,-14112.2164 1221.0312,-14219.6983 1272.3163,-14226.4756 1321.0291,-14344.2164 1360.2488,-14439.0122 1310.2856,-14480.8956 1357.0291,-14572.2164 1506.4377,-14864.1098 1602.0284,-14938.5767 1903.2231,-15068.2164 1996.2052,-15108.2375 2731.9038,-15321.6345 2797.125,-15244.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-15244.2164C2855.7371,-15174.3176 2966.8669,-13710.6405 2981.3768,-13516.4316"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2984.8746,-13516.5904 2982.1277,-13506.3578 2977.894,-13516.0699 2984.8746,-13516.5904"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node51" class="node">
<title>sourcefile~runtimelanguageprocessor.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node51"><a xlink:href="../sourcefile/runtimelanguageprocessor.f90.html" xlink:title="RuntimeLanguageProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1704.2303,-4080.2218 1542.1908,-4080.2218 1542.1908,-4058.2109 1704.2303,-4058.2109 1704.2303,-4080.2218"/>
<text text-anchor="middle" x="1623.2106" y="-4066.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RuntimeLanguageProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge133" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.6118,-11240.9098C597.1512,-11183.2981 640.0716,-10916.5332 654.4731,-10696.2164 671.8316,-10430.6645 648.9786,-6169.0801 690.4731,-5906.2164 728.5508,-5664.9986 779.4379,-5614.1771 855.7932,-5382.2164 877.6093,-5315.941 1031.9266,-4852.305 1059.5131,-4788.2164"/>
</g>
<!-- sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node59" class="node">
<title>sourcefile~refrigeratedcase.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node59"><a xlink:href="../sourcefile/refrigeratedcase.f90.html" xlink:title="RefrigeratedCase.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2443.6337,-7559.2218 2332.0206,-7559.2218 2332.0206,-7537.2109 2443.6337,-7537.2109 2443.6337,-7559.2218"/>
<text text-anchor="middle" x="2387.8271" y="-7545.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RefrigeratedCase.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge214" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-8478.2164C2219.4443,-8375.8562 2244.6251,-8355.1262 2265.3853,-8250.2164 2312.9387,-8009.9087 2231.0493,-7934.8692 2301.3853,-7700.2164 2316.8797,-7648.5242 2352.5354,-7595.331 2372.8822,-7567.6455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2375.7218,-7569.6925 2378.9054,-7559.5873 2370.115,-7565.5016 2375.7218,-7569.6925"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-11290.2164C882.6998,-11250.317 891.9976,-11187.2341 966.4307,-11076.2164 1235.1065,-10675.4835 1221.3178,-10522.2664 1321.0291,-10050.2164 1348.3268,-9920.9842 1313.6043,-9879.9578 1357.0291,-9755.2164 1408.9161,-9606.1664 1450.2859,-9580.5122 1542.2007,-9452.2164 1673.6089,-9268.795 1766.3123,-9264.0295 1867.2231,-9062.2164 1898.2718,-9000.1218 1877.851,-8974.8384 1903.2231,-8910.2164 1959.9835,-8765.6498 2013.5323,-8748.6053 2075.5532,-8606.2164 2096.7711,-8557.5038 2071.6946,-8527.3504 2111.5532,-8492.2164 2137.6189,-8469.2403 2178.4053,-8511.4736 2188.4692,-8478.2164"/>
</g>
<!-- sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node60" class="node">
<title>sourcefile~watermanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node60"><a xlink:href="../sourcefile/watermanager.f90.html" xlink:title="WaterManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2237.4688,-8033.2218 2139.4697,-8033.2218 2139.4697,-8011.2109 2237.4688,-8011.2109 2237.4688,-8033.2218"/>
<text text-anchor="middle" x="2188.4692" y="-8019.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">WaterManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge202" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-11290.2164C755.1332,-11290.2164 1002.4307,-10695.2164 1002.4307,-10695.2164 1048.1037,-10600.1664 1076.9512,-10584.9346 1116.5955,-10487.2164 1245.1915,-10170.2434 1254.6326,-10080.7761 1321.0291,-9745.2164 1346.5815,-9616.0775 1323.9283,-9578.6296 1357.0291,-9451.2164 1411.9261,-9239.9034 1436.3526,-9187.1694 1542.2007,-8996.2164 1738.4002,-8642.2667 1868.866,-8606.1459 2075.5532,-8258.2164 2120.8899,-8181.8983 2162.814,-8084.5609 2180.1128,-8042.7775"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2183.4034,-8043.978 2183.9673,-8033.3982 2176.9288,-8041.3172 2183.4034,-8043.978"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M605.5621,-11263.3384C637.4883,-11279.7521 702.0551,-11306.8177 755.1332,-11290.2164"/>
</g>
<!-- sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node63" class="node">
<title>sourcefile~setpointmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node63"><a xlink:href="../sourcefile/setpointmanager.f90.html" xlink:title="SetPointManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2651.2948,-2334.2218 2541.1478,-2334.2218 2541.1478,-2312.2109 2651.2948,-2312.2109 2651.2948,-2334.2218"/>
<text text-anchor="middle" x="2596.2213" y="-2320.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SetPointManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge262" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M587.6144,-11240.9099C597.1664,-11183.2991 640.1388,-10916.5376 654.4731,-10696.2164 663.8747,-10551.7129 639.3447,-5618.699 690.4731,-5483.2164 721.4329,-5401.1778 783.8765,-5414.209 819.7932,-5334.2164 870.6444,-5220.9622 839.1554,-5180.2429 855.7932,-5057.2164 967.4288,-4231.7379 1046.5034,-4031.2552 1116.5955,-3201.2164 1122.4226,-3132.2109 1110.3375,-2010.0797 1152.5955,-1955.2164 1198.2056,-1896.001 1729.9079,-1774.4582 1803.7218,-1786.2164"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1803.7218,-1786.2164C1890.787,-1801.0173 1843.9507,-1892.7474 1903.2231,-1958.2164 1934.8875,-1993.191 1963.6365,-1980.6853 1989.3882,-2020.2164"/>
</g>
<!-- sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node66" class="node">
<title>sourcefile~mixedair.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node66"><a xlink:href="../sourcefile/mixedair.f90.html" xlink:title="MixedAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3694.1234,-7368.2218 3624.5612,-7368.2218 3624.5612,-7346.2109 3694.1234,-7346.2109 3694.1234,-7368.2218"/>
<text text-anchor="middle" x="3659.3423" y="-7354.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">MixedAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge582" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M911.1119,-13874.2164C997.1915,-14041.3396 955.4152,-14105.2015 1002.4307,-14287.2164 1061.2058,-14514.7572 1074.5804,-14572.5342 1152.5955,-14794.2164 1171.5491,-14848.0737 1507.4085,-15699.9465 1542.2007,-15745.2164 1755.3275,-16022.5262 1838.7211,-16194.2164 2188.4692,-16194.2164 2188.4692,-16194.2164 2188.4692,-16194.2164 2387.8271,-16194.2164 2623.7289,-16194.2164 2678.3939,-16143.498 2912.0764,-16111.2164 3028.469,-16095.1375 3058.9084,-16100.6104 3174.6229,-16080.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-16080.2164C3318.4107,-16050.5424 3359.8905,-15997.1691 3426.2747,-15866.2164 3651.9355,-15421.0661 3567.6009,-14124.8613 3588.4519,-13626.2164 3644.4165,-12287.8415 3658.2978,-7727.7003 3659.284,-7378.4398"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3662.7841,-7378.3794 3659.3121,-7368.3696 3655.7841,-7378.3598 3662.7841,-7378.3794"/>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge298" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M587.6176,-11240.9102C597.1853,-11183.3003 640.2223,-10916.543 654.4731,-10696.2164 696.4716,-10046.8942 616.0529,-5486.6255 690.4731,-4840.2164 720.184,-4582.1496 770.4832,-4525.2649 819.7932,-4270.2164 917.1954,-3766.418 909.7673,-3634.9079 1002.4307,-3130.2164 1047.5933,-2884.2378 1084.9798,-2827.3001 1116.5955,-2579.2164 1137.1561,-2417.8799 1092.3877,-1999.3032 1152.5955,-1848.2164 1201.8101,-1724.7158 1421.4018,-1449.7331 1542.2007,-1394.2164 1607.6304,-1364.1462 1632.2239,-1392.8917 1704.2205,-1394.2164 1776.7029,-1395.5499 1795.5635,-1389.2445 1867.2231,-1400.2164 1962.1116,-1414.7448 1982.9731,-1431.8427 2075.5532,-1457.2164 2125.7441,-1470.9723 2143.9522,-1461.2611 2188.4692,-1488.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2188.4692,-1488.2164C2245.9486,-1509.3691 2244.5348,-1544.4273 2301.3853,-1567.2164 2584.0765,-1680.5359 2678.5531,-1628.3982 2982.9529,-1638.2164"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node71" class="node">
<title>sourcefile~desiccantdehumidifiers.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node71"><a xlink:href="../sourcefile/desiccantdehumidifiers.f90.html" xlink:title="DesiccantDehumidifiers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3244.4277,-11916.2218 3104.8181,-11916.2218 3104.8181,-11894.2109 3244.4277,-11894.2109 3244.4277,-11916.2218"/>
<text text-anchor="middle" x="3174.6229" y="-11902.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DesiccantDehumidifiers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge337" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M911.1119,-13874.2164C978.0996,-14005.1171 938.8998,-14059.6035 1002.4307,-14192.2164 1040.4867,-14271.6536 1080.5945,-14273.8269 1116.5955,-14354.2164 1145.5011,-14418.762 1127.113,-14443.2442 1152.5955,-14509.2164 1345.7034,-15009.1577 1278.0507,-15290.8658 1740.2205,-15562.2164 1788.8965,-15590.7952 1810.7801,-15562.7583 1867.2231,-15562.2164 2191.2671,-15559.1051 2272.1624,-15548.2164 2596.2213,-15548.2164 2596.2213,-15548.2164 2596.2213,-15548.2164 2797.125,-15548.2164 3163.609,-15548.2164 2843.5688,-16319.2875 3053.8293,-14610.2164 3122.9429,-14048.4376 3168.9163,-12149.9865 3174.1277,-11926.7152"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3177.6293,-11926.6828 3174.3625,-11916.6042 3170.6312,-11926.5203 3177.6293,-11926.6828"/>
</g>
<!-- sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node72" class="node">
<title>sourcefile~hvacdxsystem.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node72"><a xlink:href="../sourcefile/hvacdxsystem.f90.html" xlink:title="HVACDXSystem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3414.3516,-4348.2218 3307.3396,-4348.2218 3307.3396,-4326.2109 3414.3516,-4326.2109 3414.3516,-4348.2218"/>
<text text-anchor="middle" x="3360.8456" y="-4334.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACDXSystem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge443" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M587.605,-11240.9093C597.1109,-11183.2955 639.894,-10916.5215 654.4731,-10696.2164 661.7077,-10586.8954 644.8399,-6851.8207 690.4731,-6752.2164 767.3343,-6584.4505 840.5791,-6566.8567 1002.4307,-6478.2164 1048.7555,-6452.8459 1083.7618,-6486.5879 1116.5955,-6445.2164 1164.182,-6385.2557 1119.4441,-5826.2145 1152.5955,-5757.2164 1304.0091,-5442.0777 1413.4567,-5358.5702 1740.2205,-5234.2164 1865.4411,-5186.5622 2138.9222,-5258.0362 2265.3853,-5305.2164 2484.9073,-5387.1144 2492.2887,-5512.9807 2718.1736,-5575.2164 2919.6566,-5630.7289 3006.1728,-5585.916 3174.6229,-5462.2164"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node73" class="node">
<title>sourcefile~photovoltaicthermalcollectors.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node73"><a xlink:href="../sourcefile/photovoltaicthermalcollectors.f90.html" xlink:title="PhotovoltaicThermalCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2682.1259,-11364.2218 2510.3167,-11364.2218 2510.3167,-11342.2109 2682.1259,-11342.2109 2682.1259,-11364.2218"/>
<text text-anchor="middle" x="2596.2213" y="-11350.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PhotovoltaicThermalCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge490" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M587.315,-11263.3322C595.708,-11321.0868 636.4122,-11592.5899 690.4731,-11810.2164 737.1511,-11998.122 764.5235,-12040.6561 819.7932,-12226.2164 896.8349,-12484.8728 961.7611,-13203.374 1152.5955,-13394.2164 1207.6354,-13449.2586 1260.2363,-13393.6028 1321.0291,-13442.2164 1347.1247,-13463.0841 1328.297,-13491.1601 1357.0291,-13508.2164 1552.5537,-13624.2863 1648.351,-13531.8372 1867.2231,-13470.2164 1961.1107,-13443.7835 2013.8439,-13476.7513 2075.5532,-13401.2164 2118.1736,-13349.0471 2090.7619,-13164.2932 2111.5532,-13100.2164 2133.2245,-13033.4276 2160.6963,-13026.7071 2188.4692,-12962.2164"/>
</g>
<!-- sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node74" class="node">
<title>sourcefile~hvacevapcomponent.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node74"><a xlink:href="../sourcefile/hvacevapcomponent.f90.html" xlink:title="HVACEvapComponent.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2865.2537,-12675.2218 2728.9963,-12675.2218 2728.9963,-12653.2109 2865.2537,-12653.2109 2865.2537,-12675.2218"/>
<text text-anchor="middle" x="2797.125" y="-12661.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACEvapComponent.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge516" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M911.1119,-13114.2164C920.3454,-13149.9729 951.6171,-13142.3882 966.4307,-13176.2164 1032.7059,-13327.5622 960.6964,-13386.3532 1002.4307,-13546.2164 1044.3634,-13706.8397 1057.88,-13751.8815 1152.5955,-13888.2164 1256.3928,-14037.6237 1571.6193,-14389.8784 1740.2205,-14458.2164 1792.5323,-14479.4196 1812.0641,-14470.1993 1867.2231,-14458.2164 2685.2698,-14280.5014 2786.2252,-12875.3476 2796.1607,-12685.4302"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2799.6617,-12685.4943 2796.661,-12675.3333 2792.6703,-12685.1478 2799.6617,-12685.4943"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node75" class="node">
<title>sourcefile~hvactranspiredcollector.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node75"><a xlink:href="../sourcefile/hvactranspiredcollector.f90.html" xlink:title="HVACTranspiredCollector.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2670.2937,-14646.2218 2522.1489,-14646.2218 2522.1489,-14624.2109 2670.2937,-14624.2109 2670.2937,-14646.2218"/>
<text text-anchor="middle" x="2596.2213" y="-14632.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACTranspiredCollector.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge545" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M587.1817,-11263.5538C595.5552,-11329.0052 637.6337,-11665.2417 654.4731,-11941.2164 665.3372,-12119.2634 636.5179,-13376.194 690.4731,-13546.2164 703.7587,-13588.0816 887.0476,-13837.4725 911.1119,-13874.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M911.1119,-13874.2164C956.5977,-13962.5268 953.2978,-13991.8819 1002.4307,-14078.2164 1045.9974,-14154.7701 1076.4243,-14161.8275 1116.5955,-14240.2164 1138.9029,-14283.7465 1131.9383,-14299.8793 1152.5955,-14344.2164 1227.383,-14504.735 1232.6316,-14560.1819 1357.0291,-14686.2164 1517.1523,-14848.4469 1584.6064,-14875.394 1803.7218,-14938.2164"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node77" class="node">
<title>sourcefile~packagedthermalstoragecoil.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node77"><a xlink:href="../sourcefile/packagedthermalstoragecoil.f90.html" xlink:title="PackagedThermalStorageCoil.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3259.2106,-4156.2218 3090.0353,-4156.2218 3090.0353,-4134.2109 3259.2106,-4134.2109 3259.2106,-4156.2218"/>
<text text-anchor="middle" x="3174.6229" y="-4142.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PackagedThermalStorageCoil.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge412" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-3764.2164C2832.1674,-3770.6986 2842.6072,-3765.977 2876.0764,-3778.2164 2927.6508,-3797.0765 2936.1967,-3811.4157 2982.9529,-3840.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-3726.2164C2686.4481,-3715.392 2707.7673,-3747.6868 2797.125,-3764.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.6053,-11240.9094C597.1131,-11183.2956 639.9036,-10916.5221 654.4731,-10696.2164 669.072,-10475.4673 650.7444,-6931.8511 690.4731,-6714.2164 720.4035,-6550.2576 764.0838,-6519.2984 819.7932,-6362.2164 903.6341,-6125.8126 912.4749,-6062.3616 1002.4307,-5828.2164 1048.7154,-5707.7421 1086.6328,-5686.7495 1116.5955,-5561.2164 1145.3919,-5440.5693 1101.8838,-5117.412 1152.5955,-5004.2164 1196.2099,-4906.8628 1248.7545,-4911.6786 1321.0291,-4833.2164 1326.555,-4827.2174 1700.8024,-4395.6218 1704.2205,-4388.2164 1747.9488,-4293.476 1692.9941,-4249.2624 1740.2205,-4156.2164 1776.3493,-4085.0349 1826.8127,-4098.0574 1867.2231,-4029.2164 1896.9231,-3978.6211 1862.034,-3943.9947 1903.2231,-3902.2164 2126.3239,-3675.9239 2280.7067,-3764.0684 2596.2213,-3726.2164"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node78" class="node">
<title>sourcefile~plantwaterthermaltank.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node78"><a xlink:href="../sourcefile/plantwaterthermaltank.f90.html" xlink:title="PlantWaterThermalTank.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3053.706,-5033.2218 2912.1997,-5033.2218 2912.1997,-5011.2109 3053.706,-5011.2109 3053.706,-5033.2218"/>
<text text-anchor="middle" x="2982.9529" y="-5019.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantWaterThermalTank.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge381" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.6071,-11240.9095C597.1234,-11183.2963 639.949,-10916.5251 654.4731,-10696.2164 669.7209,-10464.932 648.8958,-6752.2433 690.4731,-6524.2164 720.3697,-6360.2514 783.4142,-6334.8659 819.7932,-6172.2164 839.6601,-6083.3921 815.4299,-5845.7961 855.7932,-5764.2164 885.3189,-5704.541 921.3006,-5712.1673 966.4307,-5663.2164 1040.3375,-5583.0524 1077.3714,-5570.9511 1116.5955,-5469.2164 1153.8798,-5372.5124 1104.4578,-5096.0017 1152.5955,-5004.2164 1227.0853,-4862.1848 1593.866,-4650.8063 1740.2205,-4585.2164 1957.9212,-4487.652 2038.5255,-4400.4121 2265.3853,-4474.2164 2374.5677,-4509.7367 2390.8834,-4547.2902 2474.269,-4626.2164 2494.884,-4645.7289 2769.2402,-5016.9101 2797.125,-5022.2164"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node79" class="node">
<title>sourcefile~plantsolarcollectors.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node79"><a xlink:href="../sourcefile/plantsolarcollectors.f90.html" xlink:title="PlantSolarCollectors.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2449.9668,-3814.2218 2325.6875,-3814.2218 2325.6875,-3792.2109 2449.9668,-3792.2109 2449.9668,-3814.2218"/>
<text text-anchor="middle" x="2387.8271" y="-3800.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantSolarCollectors.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge367" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6077.2164C766.965,-6008.4764 799.3126,-6000.8926 819.7932,-5934.2164 847.3408,-5844.533 818.9267,-5812.4882 855.7932,-5726.2164 932.4442,-5546.8442 1048.7291,-5556.0931 1116.5955,-5373.2164 1154.0424,-5272.3096 1103.4568,-4985.9756 1152.5955,-4890.2164 1197.1668,-4803.3577 1270.3676,-4832.6697 1321.0291,-4749.2164 1359.5285,-4685.7972 1313.1648,-4646.0505 1357.0291,-4586.2164 1402.2751,-4524.4974 1452.3748,-4554.615 1506.2007,-4500.2164 1529.1551,-4477.0177 1520.8049,-4460.86 1542.2007,-4436.2164 1601.6487,-4367.7442 1658.487,-4390.5167 1704.2205,-4312.2164 1762.169,-4213.0027 1678.0844,-4152.8626 1740.2205,-4056.2164 1776.426,-3999.9024 1822.547,-4025.0777 1867.2231,-3975.2164 1891.3636,-3948.2742 1874.6246,-3924.3696 1903.2231,-3902.2164 2024.6411,-3808.1623 2212.9478,-3797.2075 2315.4105,-3799.1459"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2315.5773,-3802.6507 2325.6573,-3799.3884 2315.743,-3795.6527 2315.5773,-3802.6507"/>
</g>
<!-- sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node88" class="node">
<title>sourcefile~standardratings.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node88"><a xlink:href="../sourcefile/standardratings.f90.html" xlink:title="StandardRatings.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2242.2,-10504.2218 2134.7384,-10504.2218 2134.7384,-10482.2109 2242.2,-10482.2109 2242.2,-10504.2218"/>
<text text-anchor="middle" x="2188.4692" y="-10490.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">StandardRatings.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge756" class="edge">
<title>sourcefile~datahvacglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-11288.2164C1254.3344,-11253.4639 1296.5585,-11294.481 1321.0291,-11264.2164 1396.5061,-11170.868 1294.0488,-10827.4133 1357.0291,-10725.2164 1393.0582,-10666.7525 1556.3126,-10583.7337 1623.2106,-10568.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-11442.2164C935.5107,-11453.3049 942.579,-11430.4374 966.4307,-11418.2164 1052.1632,-11374.2892 1063.1281,-11342.9273 1152.5955,-11307.2164 1188.2319,-11292.992 1219.3387,-11322.3773 1236.8123,-11288.2164"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge886" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3659.3423,-15928.2164C3692.6301,-16031.2603 3676.2936,-16138.5881 3784.5721,-16137.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3174.6229,-11752.2164C3246.8663,-11782.1693 3422.9598,-11958.4715 3426.2747,-11965.2164 3629.3985,-12378.5232 3565.9975,-13571.2407 3588.4519,-14031.2164 3593.5264,-14135.1674 3575.1287,-15812.5715 3624.4519,-15904.2164 3633.3717,-15920.7898 3653.5566,-15910.3064 3659.3423,-15928.2164"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge765" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2604.0391,-11531.9396C2621.8027,-11505.6086 2664.9893,-11437.4311 2682.1736,-11373.2164 2696.3253,-11320.334 2785.3919,-9517.6511 2796.0768,-9300.5433"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2799.5786,-9300.5912 2796.5742,-9290.4313 2792.5871,-9300.2473 2799.5786,-9300.5912"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge583" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-11752.2164C3191.588,-11764.792 3340.109,-11786.2218 3360.8456,-11790.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2661.4771,-11554.0616C2775.132,-11575.547 3012.722,-11632.2044 3174.6229,-11752.2164"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge299" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2603.7021,-11532.0667C2640.0596,-11477.3244 2799.6624,-11230.5538 2876.0764,-11005.2164 3191.7245,-10074.4009 3162.8907,-9805.3441 3259.4165,-8827.2164 3268.1428,-8738.7901 3259.3952,-7309.4434 3295.4165,-7228.2164 3311.6571,-7191.5943 3357.5871,-7206.1452 3360.8456,-7166.2164"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge338" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2613.8475,-11554.248C2696.8326,-11606.1852 3048.7164,-11826.4162 3148.2792,-11888.7288"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3146.5167,-11891.7547 3156.8502,-11894.0931 3150.2304,-11885.821 3146.5167,-11891.7547"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge517" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2604.3034,-11554.3413C2621.8408,-11579.1207 2663.3218,-11641.3221 2682.1736,-11700.2164 2711.9742,-11793.3154 2782.1629,-12509.3251 2795.0674,-12642.8221"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.6032,-12643.3627 2796.0473,-12652.9804 2798.5708,-12642.6905 2791.6032,-12643.3627"/>
</g>
<!-- sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge382" class="edge">
<title>sourcefile~hvacfancomponent.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2602.8636,-11532.0319C2618.4892,-11505.3466 2658.0697,-11435.5214 2682.1736,-11373.2164 2703.8049,-11317.3025 2701.2093,-11300.7184 2718.1736,-11243.2164 2784.5955,-11018.0737 2839.8146,-10971.1348 2876.0764,-10739.2164 2969.8815,-10139.2702 2827.1124,-5875.4783 2912.0764,-5274.2164 2924.5043,-5186.2687 2959.2649,-5085.7333 2975.0162,-5043.0876"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.3637,-5044.1282 2978.5861,-5033.5357 2971.8067,-5041.6776 2978.3637,-5044.1282"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge887" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3257.8797,-7234.9596C3290.3199,-7234.0145 3327.6183,-7235.2638 3360.8456,-7242.2164"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge584" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3196.3054,-7253.4028C3220.0457,-7265.2065 3259.5249,-7283.5464 3295.4165,-7294.2164 3407.5169,-7327.5417 3544.6087,-7345.3596 3614.1812,-7352.8512"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3614.0373,-7356.3554 3624.3493,-7353.924 3614.7718,-7349.394 3614.0373,-7356.3554"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge300" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3196.4611,-7231.1272C3215.6496,-7220.3282 3242.9999,-7202.1981 3259.4165,-7179.2164 3345.6461,-7058.5029 3305.5761,-6998.8847 3360.8456,-6861.2164"/>
</g>
<!-- sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge446" class="edge">
<title>sourcefile~hvachxassistedcoolingcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M3188.6929,-7230.9665C3208.7097,-7213.9863 3244.6188,-7179.6789 3259.4165,-7141.2164 3285.9561,-7072.234 3353.3753,-4612.4415 3360.2734,-4358.3601"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3363.7758,-4358.3158 3360.5482,-4348.2246 3356.7784,-4358.1261 3363.7758,-4358.3158"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge888" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1804.0419,-3944.0958C1808.3474,-3795.6297 1855.394,-2207.2791 1903.2231,-2006.2164 1947.0782,-1821.8597 2031.8329,-1800.605 2075.5532,-1616.2164 2112.8206,-1459.0426 2046.0927,-1037.8896 2111.5532,-890.2164 2215.7623,-655.1297 2345.5482,-631.5599 2596.2213,-574.2164"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge55" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1804.4273,-3966.3103C1810.2569,-4058.4824 1850.66,-4707.0173 1867.2231,-5234.2164 1869.6012,-5309.9078 1873.2346,-7890.6783 1903.2231,-7960.2164 1945.4581,-8058.1518 2032.0879,-8029.8208 2075.5532,-8127.2164 2160.4737,-8317.503 2018.0416,-8878.0013 2111.5532,-9064.2164 2150.9619,-9142.6932 2221.142,-9112.3599 2265.3853,-9188.2164 2314.8606,-9273.0435 2263.5111,-9315.6128 2301.3853,-9406.2164 2351.8089,-9526.8412 2432.5818,-9520.3008 2474.269,-9644.2164 2535.5382,-9826.3393 2463.7603,-11186.7771 2510.269,-11373.2164 2524.8501,-11431.6675 2562.1986,-11493.0081 2582.5319,-11523.5324"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2579.7465,-11525.6614 2588.2519,-11531.9788 2585.5425,-11521.7362 2579.7465,-11525.6614"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge215" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1804.4078,-3966.3109C1810.0797,-4058.4881 1849.4506,-4707.0566 1867.2231,-5234.2164 1869.1169,-5290.3878 1877.3129,-7207.3418 1903.2231,-7257.2164 1990.5284,-7425.2698 2221.5773,-7505.3174 2330.0493,-7534.5455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2329.2792,-7537.9621 2339.8418,-7537.1354 2331.0691,-7531.1948 2329.2792,-7537.9621"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge263" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1804.2088,-3943.9134C1809.1241,-3831.2855 1850.6869,-2912.6257 1903.2231,-2804.2164 1949.0659,-2709.6191 2027.2477,-2735.5801 2075.5532,-2642.2164 2128.7562,-2539.3869 2033.1155,-2469.3749 2111.5532,-2384.2164 2196.8097,-2291.6548 2262.5138,-2310.6895 2387.8271,-2322.2164"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge585" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.8594,-3943.8063C1805.6144,-3803.9679 1824.8828,-2423.0147 1903.2231,-2262.2164 1947.9529,-2170.4057 2031.7764,-2202.4853 2075.5532,-2110.2164 2120.6893,-2015.0825 2035.6951,-1236.2456 2111.5532,-1163.2164 2160.8077,-1115.7988 2201.6663,-1138.4307 2265.3853,-1163.2164 2285.6139,-1171.085 2281.4928,-1187.533 2301.3853,-1196.2164 2421.8775,-1248.8132 2464.7496,-1220.2164 2596.2213,-1220.2164 2596.2213,-1220.2164 2596.2213,-1220.2164 2797.125,-1220.2164 3007.8209,-1220.2164 3101.3874,-1185.8622 3259.4165,-1325.2164 3294.5322,-1356.1823 3265.3734,-1388.308 3295.4165,-1424.2164 3338.5743,-1475.7997 3368.6796,-1465.4855 3426.2747,-1500.2164 3470.7618,-1527.043 3489.9337,-1524.2227 3525.3633,-1562.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3525.3633,-1562.2164C3638.7948,-1689.8605 3573.8163,-1771.0825 3588.4519,-1941.2164 3594.8694,-2015.8175 3590.017,-7265.7276 3624.4519,-7332.2164 3625.8013,-7334.8218 3627.561,-7337.2172 3629.5728,-7339.4056"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3278,-7342.092 3637.1547,-7346.0523 3631.9423,-7336.8282 3627.3278,-7342.092"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge302" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-2094.2164C3073.5471,-2080.4177 3082.9889,-2017.2603 3174.6229,-2018.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1804.0359,-3944.0177C1807.7155,-3814.7811 1843.5718,-2607.7963 1903.2231,-2462.2164 1947.7112,-2353.6427 2021.5685,-2366.3945 2075.5532,-2262.2164 2105.9053,-2203.6438 2062.1848,-2161.9744 2111.5532,-2118.2164 2175.4366,-2061.5929 2795.3313,-2014.5121 2876.0764,-2042.2164 2895.2491,-2048.7947 2894.2278,-2060.6095 2912.0764,-2070.2164 2941.3615,-2085.9788 2950.0745,-2099.2242 2982.9529,-2094.2164"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge518" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1804.4155,-3966.3106C1810.1493,-4058.4858 1849.9256,-4707.0408 1867.2231,-5234.2164 1875.4264,-5484.2249 1857.6106,-7239.2671 1903.2231,-7485.2164 1943.869,-7704.3843 2032.6948,-7737.4704 2075.5532,-7956.2164 2096.8025,-8064.6712 2060.0666,-8852.4252 2111.5532,-8950.2164 2151.1976,-9025.5149 2220.4713,-8991.9372 2265.3853,-9064.2164 2312.8235,-9140.5579 2267.6575,-9179.9046 2301.3853,-9263.2164 2327.2834,-9327.1881 2368.3778,-9325.9984 2387.8271,-9392.2164"/>
</g>
<!-- sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node76" class="node">
<title>sourcefile~userdefinedcomponents.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node76"><a xlink:href="../sourcefile/userdefinedcomponents.f90.html" xlink:title="UserDefinedComponents.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2670.1298,-7063.2218 2522.3128,-7063.2218 2522.3128,-7041.2109 2670.1298,-7041.2109 2670.1298,-7063.2218"/>
<text text-anchor="middle" x="2596.2213" y="-7049.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UserDefinedComponents.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge561" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1804.6753,-3966.4285C1810.4322,-4032.5687 1842.3611,-4378.3082 1903.2231,-4654.2164 1972.319,-4967.4513 1929.7474,-5080.9495 2111.5532,-5345.2164 2160.5457,-5416.4302 2222.1203,-5389.3845 2265.3853,-5464.2164 2324.4369,-5566.3531 2239.5188,-5626.7596 2301.3853,-5727.2164 2350.3,-5806.6427 2429.5269,-5764.3669 2474.269,-5846.2164 2533.191,-5954.0059 2465.9818,-6836.6344 2510.269,-6951.2164 2523.4597,-6985.3437 2553.3924,-7016.0191 2574.2002,-7034.3786"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2572.0739,-7037.1659 2581.9437,-7041.0181 2576.6304,-7031.8518 2572.0739,-7037.1659"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge413" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1804.5756,-3943.9546C1808.2005,-3904.6056 1825.9115,-3772.2333 1903.2231,-3709.2164 2042.6764,-3595.5476 2122.2136,-3652.5055 2301.3853,-3636.2164 2560.7109,-3612.6402 2646.0973,-3628.0884 2876.0764,-3750.2164 2930.922,-3779.3415 2930.1143,-3807.5913 2982.9529,-3840.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2982.9529,-3840.2164C3094.5507,-3907.1608 3151.3649,-4066.7938 3168.7219,-4124.2005"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3165.4158,-4125.3643 3171.5903,-4133.9739 3172.1325,-4123.393 3165.4158,-4125.3643"/>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge383" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1806.3728,-3943.9589C1814.466,-3912.4617 1842.1165,-3823.4482 1903.2231,-3788.2164 2123.1022,-3661.4423 2242.6367,-3679.4623 2474.269,-3783.2164 2538.213,-3811.8585 2848.9557,-4204.6125 2876.0764,-4269.2164 2934.0802,-4407.3863 2973.2458,-4892.4971 2981.3801,-5000.7071"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2977.9134,-5001.2865 2982.1451,-5010.9995 2984.8942,-5000.7676 2977.9134,-5001.2865"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node81" class="node">
<title>sourcefile~heatbalanceconvectioncoeffs.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node81"><a xlink:href="../sourcefile/heatbalanceconvectioncoeffs.f90.html" xlink:title="HeatBalanceConvectionCoeffs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2075.7186,-13392.2218 1903.0578,-13392.2218 1903.0578,-13370.2109 2075.7186,-13370.2109 2075.7186,-13392.2218"/>
<text text-anchor="middle" x="1989.3882" y="-13378.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceConvectionCoeffs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge479" class="edge">
<title>sourcefile~datazoneequipment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1804.4613,-3966.3092C1810.5666,-4058.4733 1852.7745,-4706.9551 1867.2231,-5234.2164 1909.4941,-6776.7691 1844.0683,-10636.2188 1903.2231,-12178.2164 1921.5947,-12657.1108 1975.9907,-13241.2901 1987.3103,-13359.6952"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1983.8554,-13360.3334 1988.295,-13369.9532 1990.8234,-13359.6645 1983.8554,-13360.3334"/>
</g>
<!-- sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~dataipshortcuts.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node7"><a xlink:href="../sourcefile/dataipshortcuts.f90.html" xlink:title="DataIPShortCuts.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="453.3838,-10655.2218 344.7839,-10655.2218 344.7839,-10633.2109 453.3838,-10633.2109 453.3838,-10655.2218"/>
<text text-anchor="middle" x="399.0839" y="-10641.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataIPShortCuts.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge889" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.9871,-10655.4556C414.5521,-10704.7354 464.3594,-10906.8005 480.9653,-11076.2164 505.0667,-11322.1016 465.7167,-15281.5264 516.9653,-15523.2164 595.3663,-15892.9574 591.5542,-16032.9704 855.7932,-16303.2164 893.0161,-16341.2855 2543.1971,-17111.0359 2596.2213,-17106.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-17106.2164C2770.8097,-17091.9756 2807.8516,-17025.3723 2982.9529,-17030.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge238" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M401.9686,-10655.4574C414.4567,-10704.7448 463.9893,-10906.8372 480.9653,-11076.2164 488.9662,-11156.0449 470.108,-13899.0934 516.9653,-13964.2164 535.8683,-13990.4881 578.0403,-13956.775 585.7192,-13988.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M585.7192,-13988.2164C593.1179,-14018.5103 632.916,-13979.683 654.4731,-14002.2164 725.3907,-14076.3456 632.7133,-14145.4329 690.4731,-14230.2164 728.0078,-14285.312 778.2546,-14254.073 819.7932,-14306.2164 852.8995,-14347.7746 832.0245,-14372.6963 855.7932,-14420.2164 944.8221,-14598.2094 1036.099,-14602.2054 1116.5955,-14784.2164 1147.4816,-14854.053 1115.6855,-14885.3676 1152.5955,-14952.2164 1181.8244,-15005.1537 1486.1898,-15309.4243 1542.2007,-15332.2164 1935.2506,-15492.1569 2140.0415,-15386.676 2474.269,-15125.2164 2593.2812,-15032.1155 2627.8561,-14997.2173 2682.1736,-14856.2164 2756.5285,-14663.201 2670.8032,-14593.561 2718.1736,-14392.2164 2761.0002,-14210.185 2838.7639,-14185.4575 2876.0764,-14002.2164 2899.4803,-13887.2801 2843.5072,-11986.3811 2912.0764,-11891.2164 2914.3457,-11888.067 2917.0447,-11885.3119 2920.0429,-11882.9021"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.1472,-11885.7077 2928.5886,-11877.2959 2918.3074,-11879.8547 2922.1472,-11885.7077"/>
</g>
<!-- sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node27" class="node">
<title>sourcefile~schedulemanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node27"><a xlink:href="../sourcefile/schedulemanager.f90.html" xlink:title="ScheduleManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1116.678,-10390.2218 1002.3481,-10390.2218 1002.3481,-10368.2109 1116.678,-10368.2109 1116.678,-10390.2218"/>
<text text-anchor="middle" x="1059.5131" y="-10376.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ScheduleManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge722" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M453.3933,-10644.3249C490.6317,-10644.3727 541.1668,-10644.3852 585.7192,-10644.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge729" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M453.6225,-10648.3272C463.3139,-10650.8245 472.8808,-10654.5905 480.9653,-10660.2164 506.1794,-10677.7622 490.1783,-10704.1812 516.9653,-10719.2164 570.2589,-10749.1293 594.5182,-10731.0652 654.4731,-10719.2164 890.7438,-10672.5224 956.0617,-10615.7521 1116.5955,-10436.2164 1239.4985,-10298.7657 1265.4146,-10251.0142 1321.0291,-10075.2164 1345.8127,-9996.875 1314.0375,-9777.2402 1357.0291,-9707.2164 1398.1545,-9640.232 1457.6642,-9674.0421 1506.2007,-9612.2164 1536.9238,-9573.0814 1514.0488,-9547.2399 1542.2007,-9506.2164 1629.5404,-9378.9433 2000.6675,-9196.1933 2075.5532,-9061.2164 2132.1488,-8959.2064 2049.6662,-8900.1056 2111.5532,-8801.2164 2155.2028,-8731.4686 2209.705,-8758.7948 2265.3853,-8698.2164 2287.7329,-8673.9028 2277.3111,-8655.8218 2301.3853,-8633.2164 2332.3829,-8604.1099 2356.5503,-8621.0226 2387.8271,-8592.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge796" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M453.4744,-10635.1966C463.514,-10631.5435 473.2487,-10626.4149 480.9653,-10619.2164 674.9759,-10438.2333 591.3741,-10306.3349 690.4731,-10060.2164 707.6481,-10017.5614 731.3047,-9969.219 744.7264,-9942.5711"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="747.9364,-9943.9795 749.3344,-9933.4773 741.6923,-9940.8155 747.9364,-9943.9795"/>
</g>
<!-- sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node39" class="node">
<title>sourcefile~inputprocessor.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node39"><a xlink:href="../sourcefile/inputprocessor.f90.html" xlink:title="InputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="635.2783,-5922.2218 536.1602,-5922.2218 536.1602,-5900.2109 635.2783,-5900.2109 635.2783,-5922.2218"/>
<text text-anchor="middle" x="585.7192" y="-5908.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">InputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge879" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M453.5714,-10637.9389C464.2398,-10634.1445 474.2034,-10628.2651 480.9653,-10619.2164 514.0644,-10574.9234 514.1097,-6693.4365 516.9653,-6638.2164 531.4546,-6358.0303 572.2716,-6018.9882 583.0707,-5932.2234"/>
<polygon fill="#ff0028" stroke="#ff0028" points="586.5443,-5932.6515 584.313,-5922.2943 579.5985,-5931.7824 586.5443,-5932.6515"/>
</g>
<!-- sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node41" class="node">
<title>sourcefile~curvemanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node41"><a xlink:href="../sourcefile/curvemanager.f90.html" xlink:title="CurveManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1481.0048,-3736.2218 1382.2249,-3736.2218 1382.2249,-3714.2109 1481.0048,-3714.2109 1481.0048,-3736.2218"/>
<text text-anchor="middle" x="1431.6149" y="-3722.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">CurveManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M453.5876,-10637.951C464.2552,-10634.156 474.2143,-10628.2733 480.9653,-10619.2164 526.0214,-10558.7707 508.1326,-5266.0877 516.9653,-5191.2164 556.8977,-4852.7255 547.2465,-4753.5007 690.4731,-4444.2164 730.9625,-4356.7835 763.7497,-4348.5937 819.7932,-4270.2164 971.6367,-4057.8621 935.9396,-3931.8564 1152.5955,-3786.2164 1218.8244,-3741.6961 1312.0567,-3729.0441 1372.1646,-3725.7868"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1372.4282,-3729.2783 1382.2523,-3725.3114 1372.0986,-3722.2861 1372.4282,-3729.2783"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge86" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.9748,-10655.4568C414.4883,-10704.7417 464.112,-10906.8249 480.9653,-11076.2164 498.9412,-11256.8909 458.0363,-14172.4788 516.9653,-14344.2164 554.8378,-14454.5884 1063.0769,-15105.3649 1152.5955,-15180.2164 1217.077,-15234.1329 1249.771,-15221.6389 1321.0291,-15266.2164 1518.8268,-15389.9544 1518.9706,-15508.1654 1740.2205,-15582.2164 2238.0387,-15748.8331 2604.5693,-15707.5137 2876.0764,-15258.2164 2919.3404,-15186.622 2907.1511,-14589.7225 2912.0764,-14506.2164 2935.5413,-14108.3825 2972.9663,-13623.1183 2981.2807,-13516.5529"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2984.7816,-13516.6773 2982.0716,-13506.4349 2977.8029,-13516.1318 2984.7816,-13516.6773"/>
</g>
<!-- sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node52" class="node">
<title>sourcefile~outputprocessor.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node52"><a xlink:href="../sourcefile/outputprocessor.f90.html" xlink:title="OutputProcessor.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1485.3406,-4306.2218 1377.8892,-4306.2218 1377.8892,-4284.2109 1485.3406,-4284.2109 1485.3406,-4306.2218"/>
<text text-anchor="middle" x="1431.6149" y="-4292.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputProcessor.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge171" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M453.582,-10637.9468C464.2498,-10634.152 474.2105,-10628.2704 480.9653,-10619.2164 520.9725,-10565.5912 508.4513,-5868.5771 516.9653,-5802.2164 556.9862,-5490.2833 556.3254,-5400.6602 690.4731,-5116.2164 826.916,-4826.9061 980.0719,-4825.4885 1116.5955,-4536.2164 1144.384,-4477.3368 1107.2374,-4440.9246 1152.5955,-4394.2164 1179.7095,-4366.2952 1203.7906,-4390.8156 1236.8123,-4370.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge586" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-15509.2164C613.7148,-15579.4353 641.121,-15585.9555 690.4731,-15643.2164 787.874,-15756.2259 1045.3724,-16026.4797 1152.5955,-16130.2164 1303.6485,-16276.3579 1363.8493,-16289.5864 1506.2007,-16444.2164 1524.2618,-16463.8354 1520.3195,-16476.9741 1542.2007,-16492.2164 1617.553,-16544.7062 1649.3491,-16537.9666 1740.2205,-16551.2164 1887.8086,-16572.7359 1927.3803,-16555.2497 2075.5532,-16538.2164 2347.1583,-16506.9938 2419.5045,-16512.0392 2682.1736,-16436.2164 2965.9353,-16354.3049 3016.8817,-16278.4434 3295.4165,-16180.2164 3400.5169,-16143.152 3462.2239,-16172.0493 3525.3633,-16080.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge305" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M453.6018,-10637.9616C464.2686,-10634.166 474.2239,-10628.2804 480.9653,-10619.2164 547.0519,-10530.3608 491.6535,-2754.022 516.9653,-2646.2164 572.8814,-2408.0643 891.9413,-1876.471 1002.4307,-1658.2164 1052.0073,-1560.2854 1081.0523,-1543.0672 1116.5955,-1439.2164 1145.6997,-1354.1789 1117.1373,-1322.8066 1152.5955,-1240.2164 1202.5799,-1123.791 1255.0341,-1118.3735 1321.0291,-1010.2164 1339.6642,-979.6757 1328.6512,-960.004 1357.0291,-938.2164 1610.3279,-743.7413 1849.481,-711.6677 2075.5532,-937.2164 2131.3741,-992.908 2065.2313,-1226.4056 2111.5532,-1290.2164 2143.6038,-1334.3676 2544.9668,-1479.0494 2596.2213,-1486.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2596.2213,-1486.2164C2767.4592,-1508.7062 2810.5177,-1514.504 2982.9529,-1524.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge339" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2387.8271,-16118.2164C2622.0854,-16030.853 2677.113,-15999.665 2912.0764,-15914.2164 2943.3314,-15902.8499 2963.756,-15917.3742 2982.9529,-15890.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2982.9529,-15890.2164C3012.9356,-15844.7341 3036.5034,-15841.8633 3053.8293,-15790.2164 3095.1954,-15666.9084 3085.7993,-14750.2154 3089.8293,-14620.2164 3124.609,-13498.3071 3168.0146,-12115.6403 3173.9413,-11926.9185"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3177.4481,-11926.753 3174.2638,-11916.6481 3170.4516,-11926.5332 3177.4481,-11926.753"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M401.9805,-10655.4563C414.5178,-10704.7388 464.2263,-10906.8136 480.9653,-11076.2164 486.0516,-11127.6903 487.8935,-14757.4347 516.9653,-14800.2164 554.054,-14854.7955 596.8765,-14824.0126 654.4731,-14856.2164 765.6389,-14918.3719 1023.1924,-15108.6311 1116.5955,-15195.2164 1134.6256,-15211.9304 1133.4593,-15221.781 1152.5955,-15237.2164 1218.8227,-15290.6358 1261.3089,-15267.6096 1321.0291,-15328.2164 1462.4523,-15471.7393 1567.9283,-16027.7425 1740.2205,-16132.2164 1785.2916,-16159.5465 2126.1613,-16220.1952 2387.8271,-16118.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge452" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M453.581,-10637.9461C464.2489,-10634.1513 474.2099,-10628.2699 480.9653,-10619.2164 520.2371,-10566.5847 505.3489,-5955.8493 516.9653,-5891.2164 548.6629,-5714.8537 608.3157,-5685.358 654.4731,-5512.2164 678.4145,-5422.4097 651.326,-5390.513 690.4731,-5306.2164 781.4994,-5110.207 848.6301,-5085.0415 1002.4307,-4933.2164 1049.0051,-4887.2402 1084.9483,-4897.5002 1116.5955,-4840.2164 1148.3182,-4782.7958 1103.4616,-4590.6827 1152.5955,-4547.2164 1336.4095,-4384.6047 1464.8941,-4517.8746 1704.2205,-4572.2164 1778.9207,-4589.1779 1798.2265,-4594.9405 1867.2231,-4628.2164 1886.6231,-4637.5726 3157.1017,-5474.7425 3174.6229,-5462.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge491" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M401.9657,-10655.4577C414.4416,-10704.7464 463.9306,-10906.8431 480.9653,-11076.2164 488.5713,-11151.8414 474.9595,-13748.872 516.9653,-13812.2164 563.4926,-13882.3791 608.0726,-13870.9612 690.4731,-13888.2164 1202.3699,-13995.4109 1462.4074,-14219.3556 1867.2231,-13888.2164 1929.697,-13837.1127 1859.443,-13778.024 1903.2231,-13710.2164 1954.4046,-13630.9454 2022.5847,-13664.3046 2075.5532,-13586.2164 2112.5858,-13531.6216 2076.0277,-13497.8036 2111.5532,-13442.2164 2158.8433,-13368.221 2225.2488,-13396.3236 2265.3853,-13318.2164 2329.5782,-13193.2942 2248.6511,-12817.3908 2301.3853,-12687.2164 2345.5007,-12578.3172 2431.2264,-12596.544 2474.269,-12487.2164 2552.8007,-12287.7472 2456.6673,-11730.7784 2510.269,-11523.2164 2525.3321,-11464.8876 2562.4767,-11403.4952 2582.6522,-11372.9309"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2585.6617,-11374.7272 2588.3255,-11364.4726 2579.8484,-11370.8278 2585.6617,-11374.7272"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge519" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-13988.2164C593.6711,-14018.3698 633.3564,-13979.2698 654.4731,-14002.2164 700.5386,-14052.2736 665.9104,-14242.778 690.4731,-14306.2164 817.9353,-14635.4128 919.436,-14687.1624 1152.5955,-14952.2164 1234.5233,-15045.3513 1249.8388,-15079.7941 1357.0291,-15142.2164 1511.3627,-15232.0926 1563.7086,-15236.01 1740.2205,-15263.2164 1796.0073,-15271.815 1811.0615,-15268.8711 1867.2231,-15263.2164 1957.0617,-15254.1709 2183.3449,-15219.9282 2265.3853,-15182.2164 2283.8024,-15173.7505 2284.2258,-15165.0061 2301.3853,-15154.2164 2374.0355,-15108.5344 2413.4415,-15128.7548 2474.269,-15068.2164 2619.9261,-14923.2516 2631.8164,-14854.4522 2682.1736,-14655.2164 2716.249,-14520.3985 2708.7903,-13542.957 2718.1736,-13404.2164 2737.467,-13118.9457 2782.4026,-12773.8952 2794.2299,-12685.595"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2797.7247,-12685.8676 2795.5894,-12675.4902 2790.7872,-12684.9342 2797.7247,-12685.8676"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge553" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M585.7192,-15509.2164C685.052,-15773.3124 1298.9374,-15575.0656 1321.0291,-15567.2164 1518.0699,-15497.2074 1578.9216,-15461.6277 1704.2205,-15294.2164 1733.5295,-15255.0567 1708.3632,-15227.3326 1740.2205,-15190.2164 1781.7857,-15141.7896 1811.2106,-15153.801 1867.2231,-15123.2164 1921.9532,-15093.332 1927.0957,-15057.0622 1989.3882,-15054.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M401.9868,-10655.4556C414.5506,-10704.7355 464.3535,-10906.8011 480.9653,-11076.2164 486.9413,-11137.1622 481.3062,-15435.4314 516.9653,-15485.2164 535.8118,-15511.5286 573.7329,-15479.1522 585.7192,-15509.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge414" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3686.2164C791.4139,-3050.7819 1103.9759,-2927.3917 1740.2205,-2724.2164 1793.991,-2707.0455 1811.5232,-2715.0717 1867.2231,-2724.2164 2035.9391,-2751.9156 2454.2063,-2875.0111 2596.2213,-2970.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge384" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-3764.2164C2623.805,-3796.8306 2655.868,-3773.5627 2682.1736,-3807.2164 2727.3288,-3864.9849 2673.3108,-3910.2204 2718.1736,-3968.2164 2766.433,-4030.6033 2831.3384,-3984.2579 2876.0764,-4049.2164 2932.0392,-4130.4729 2974.4199,-4865.0145 2981.8073,-5000.7124"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.3297,-5001.2235 2982.3635,-5011.0204 2985.3195,-5000.8463 2978.3297,-5001.2235"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.5974,-10637.9582C464.2644,-10634.1629 474.2209,-10628.2782 480.9653,-10619.2164 538.5736,-10541.8141 493.3586,-3765.7714 516.9653,-3672.2164 573.1375,-3449.6028 805.605,-2878.4186 1002.4307,-2760.2164 1085.2216,-2710.4968 1331.4285,-2823.8741 1357.0291,-2828.2164 1582.4517,-2866.4519 1675.6262,-2769.4448 1867.2231,-2894.2164 2224.2685,-3126.731 2266.4639,-3264.2467 2474.269,-3636.2164 2498.1246,-3678.9177 2474.6444,-3706.6996 2510.269,-3740.2164 2539.1561,-3767.3942 2569.9791,-3734.4768 2596.2213,-3764.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge374" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-3688.2164C2250.9543,-3721.7339 2322.6078,-3764.0439 2360.6922,-3786.85"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2359.2498,-3790.0662 2369.6254,-3792.2107 2362.8517,-3784.064 2359.2498,-3790.0662"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3686.2164C612.2535,-3589.4447 626.7635,-3563.7399 690.4731,-3486.2164 798.0291,-3355.3397 840.5179,-3317.0283 1002.4307,-3267.2164 1066.3614,-3247.5483 1085.7447,-3259.4398 1152.5955,-3257.2164 1471.3832,-3246.6135 1625.8324,-3114.7253 1867.2231,-3323.2164 1913.2434,-3362.9645 1870.0987,-3404.2208 1903.2231,-3455.2164 1992.3918,-3592.493 2044.2175,-3610.8384 2188.4692,-3688.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M453.5966,-10637.9577C464.2637,-10634.1623 474.2204,-10628.2778 480.9653,-10619.2164 537.3175,-10543.5109 495.1044,-3916.0259 516.9653,-3824.2164 532.8379,-3757.5561 564.6157,-3751.4097 585.7192,-3686.2164"/>
</g>
<!-- sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge482" class="edge">
<title>sourcefile~dataipshortcuts.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M401.9616,-10655.4582C414.4201,-10704.7485 463.8475,-10906.8515 480.9653,-11076.2164 488.0778,-11146.5871 473.3138,-13566.5641 516.9653,-13622.2164 584.4709,-13708.2805 645.753,-13684.2164 755.1332,-13684.2164 755.1332,-13684.2164 755.1332,-13684.2164 911.1119,-13684.2164 1266.3955,-13684.2164 1372.7064,-13711.985 1704.2205,-13584.2164 1786.7111,-13552.4237 1807.8454,-13535.7127 1867.2231,-13470.2164 1889.143,-13446.0378 1877.6507,-13426.4928 1903.2231,-13406.2164 1908.109,-13402.3424 1913.5737,-13399.0687 1919.3169,-13396.3022"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1920.7122,-13399.5122 1928.5278,-13392.3591 1917.9573,-13393.077 1920.7122,-13399.5122"/>
</g>
<!-- sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~plantutilities.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node8"><a xlink:href="../sourcefile/plantutilities.f90.html" xlink:title="PlantUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2232.2539,-6303.2218 2144.6846,-6303.2218 2144.6846,-6281.2109 2232.2539,-6281.2109 2232.2539,-6303.2218"/>
<text text-anchor="middle" x="2188.4692" y="-6289.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PlantUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge890" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3525.3633,-916.2164C3671.0344,-868.0466 3707.8814,-555.3295 3784.5721,-688.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2189.6932,-6280.9802C2198.1536,-6202.7195 2248.1194,-5730.8156 2265.3853,-5345.2164 2268.032,-5286.1068 2262.3116,-1129.6483 2301.3853,-1085.2164 2343.9498,-1036.8148 2813.9621,-1023.4286 2876.0764,-1006.2164 2958.8756,-983.2722 2981.6328,-976.7975 3053.8293,-930.2164 3072.0678,-918.449 3069.6007,-905.085 3089.8293,-897.2164 3160.0742,-869.8923 3184.0782,-894.9608 3259.4165,-897.2164 3333.6755,-899.4396 3352.1925,-901.6334 3426.2747,-907.2164 3470.3703,-910.5395 3483.2416,-929.6787 3525.3633,-916.2164"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge32" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.7097,-6303.2768C2201.5668,-6357.4725 2248.859,-6600.5252 2265.3853,-6802.2164 2289.0159,-7090.6108 2257.7756,-9120.1605 2301.3853,-9406.2164 2317.2985,-9510.5989 2361.2476,-9629.8306 2379.6039,-9676.7375"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2376.3746,-9678.089 2383.3064,-9686.1015 2382.8842,-9675.515 2376.3746,-9678.089"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge628" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2387.8271,-6169.2164C2515.305,-6137.9558 2567.2126,-6208.555 2682.1736,-6145.2164 2922.8191,-6012.6309 2962.3925,-5910.308 3053.8293,-5651.2164 3133.2275,-5426.2371 3019.1982,-4806.1001 3089.8293,-4578.2164 3131.337,-4444.2964 3219.2728,-4446.5515 3259.4165,-4312.2164 3302.798,-4167.0465 3234.8337,-1724.0903 3295.4165,-1585.2164 3297.9765,-1579.3481 3456.4318,-1428.8337 3462.2747,-1426.2164 3542.47,-1390.2926 3626.4529,-1328.7296 3659.3423,-1410.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2232.3251,-6284.5278C2244.0629,-6280.8169 2256.0644,-6275.3279 2265.3853,-6267.2164 2292.9749,-6243.2062 2273.2806,-6216.6217 2301.3853,-6193.2164 2332.0238,-6167.7008 2349.2308,-6179.2209 2387.8271,-6169.2164"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge730" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2199.37,-6303.678C2269.0219,-6377.0145 2649.8844,-6779.5692 2682.1736,-6847.2164 2724.475,-6935.8394 2687.8864,-6971.8025 2718.1736,-7065.2164 2735.0826,-7117.3685 2766.8823,-7173.7404 2784.526,-7203.0005"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2781.7251,-7205.1295 2789.9249,-7211.8388 2787.6988,-7201.4805 2781.7251,-7205.1295"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge839" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M2190.7365,-6303.2746C2201.7195,-6357.4602 2249.5105,-6600.4729 2265.3853,-6802.2164 2286.6882,-7072.9424 2248.8132,-11423.7908 2301.3853,-11690.2164 2316.2559,-11765.578 2357.0309,-11848.1254 2376.7964,-11885.2166"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2373.7267,-11886.8982 2381.5584,-11894.0336 2379.8858,-11883.5716 2373.7267,-11886.8982"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge851" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2232.3052,-6287.0533C2244.7612,-6283.432 2257.1609,-6277.3592 2265.3853,-6267.2164 2360.5336,-6149.8728 2225.8556,-6060.0521 2301.3853,-5929.2164 2313.3532,-5908.4849 2335.1861,-5892.6579 2353.9145,-5882.0526"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2355.6567,-5885.0898 2362.8023,-5877.2673 2352.3382,-5878.9263 2355.6567,-5885.0898"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge216" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.4098,-6303.3068C2199.861,-6357.6433 2241.5809,-6601.2542 2265.3853,-6802.2164 2287.267,-6986.9476 2269.6338,-7035.9235 2301.3853,-7219.2164 2321.9007,-7337.6467 2364.4313,-7475.7129 2381.0057,-7527.3399"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2377.7244,-7528.5682 2384.1312,-7537.0064 2384.3848,-7526.4146 2377.7244,-7528.5682"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge304" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2387.8271,-6169.2164C2431.5765,-6160.9737 3135.2832,-6300.3757 3174.6229,-6321.2164"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge340" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2232.2914,-6298.1965C2291.4949,-6307.9577 2398.3437,-6331.6557 2474.269,-6383.2164 2594.9547,-6465.1737 2621.0921,-6504.7358 2682.1736,-6637.2164 2719.9895,-6719.2358 2660.8667,-6767.4084 2718.1736,-6837.2164 2766.0122,-6895.4905 2830.8165,-6838.9176 2876.0764,-6899.2164 2928.8553,-6969.5325 2903.6068,-7205.705 2912.0764,-7293.2164 2971.7696,-7909.9899 3018.7656,-8061.5537 3053.8293,-8680.2164 3058.7998,-8767.9147 3049.9235,-11763.9654 3089.8293,-11842.2164 3100.4979,-11863.1363 3121.708,-11878.8902 3140.245,-11889.4121"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.6071,-11892.5053 3149.0724,-11894.1569 3141.9212,-11886.3395 3138.6071,-11892.5053"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge492" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2189.1018,-6303.3593C2192.8862,-6364.8975 2215.3633,-6668.7357 2301.3853,-6898.2164 2354.4575,-7039.7972 2433.8099,-7045.5289 2474.269,-7191.2164 2505.0201,-7301.9467 2440.883,-11236.6062 2510.269,-11328.2164 2512.6119,-11331.3096 2515.3153,-11334.0372 2518.2868,-11336.4412"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.4566,-11339.4278 2526.7148,-11342.0774 2520.3479,-11333.609 2516.4566,-11339.4278"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge562" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2189.9564,-6303.2221C2198.9808,-6368.9605 2247.8018,-6709.902 2301.3853,-6799.2164 2369.5663,-6912.8624 2506.7747,-7001.0982 2566.8831,-7035.9806"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2565.4292,-7039.1813 2575.8458,-7041.1166 2568.9096,-7033.1079 2565.4292,-7039.1813"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge385" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2232.3859,-6286.6682C2244.6932,-6283.0227 2256.9885,-6277.033 2265.3853,-6267.2164 2331.2129,-6190.2572 2247.9744,-6128.2587 2301.3853,-6042.2164 2351.1189,-5962.0979 2421.1248,-5997.1143 2474.269,-5919.2164 2511.4475,-5864.7208 2473.708,-5830.128 2510.269,-5775.2164 2532.3073,-5742.1168 2773.7764,-5593.405 2797.125,-5561.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-5561.2164C2856.7814,-5468.9506 2952.7203,-5131.3583 2977.1484,-5043.3253"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2980.5906,-5044.0092 2979.8819,-5033.438 2973.8437,-5042.1438 2980.5906,-5044.0092"/>
</g>
<!-- sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge373" class="edge">
<title>sourcefile~plantutilities.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2189.6026,-6280.9756C2197.4506,-6202.6842 2244.0294,-5730.6108 2265.3853,-5345.2164 2280.3058,-5075.9552 2262.8725,-4399.1264 2301.3853,-4132.2164 2318.5504,-4013.2542 2363.0578,-3875.5018 2380.5834,-3824.0258"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2383.9551,-3824.9834 2383.894,-3814.3887 2377.3349,-3822.709 2383.9551,-3824.9834"/>
</g>
<!-- sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~datasizing.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node9"><a xlink:href="../sourcefile/datasizing.f90.html" xlink:title="DataSizing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="439.3754,-13905.2218 358.7923,-13905.2218 358.7923,-13883.2109 439.3754,-13883.2109 439.3754,-13905.2218"/>
<text text-anchor="middle" x="399.0839" y="-13891.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSizing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge891" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.221,-13905.4145C408.4045,-13986.4725 458.6253,-14491.843 480.9653,-14904.2164 484.9218,-14977.2477 485.7468,-16154.0753 516.9653,-16220.2164 593.0553,-16381.4238 719.6328,-16335.7531 819.7932,-16483.2164 847.0402,-16523.3313 821.4107,-16552.0191 855.7932,-16586.2164 892.6561,-16622.8806 919.1545,-16602.5807 966.4307,-16624.2164 1205.6612,-16733.6989 1726.4905,-17230.3397 1989.3882,-17220.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-17220.2164C2263.1147,-17200.6987 2321.8234,-17109.8124 2596.2213,-17106.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge33" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-14330.2164C664.4067,-14367.8864 639.9039,-14235.3043 690.4731,-14164.2164 743.8757,-14089.1456 780.9246,-14085.7429 819.7932,-14002.2164 854.2137,-13928.2486 834.6629,-13901.0168 855.7932,-13822.2164 949.3747,-13473.2261 1020.4749,-13400.5158 1116.5955,-13052.2164 1231.4891,-12635.8914 1262.4542,-12530.1136 1321.0291,-12102.2164 1339.0848,-11970.317 1310.4032,-11628.9139 1357.0291,-11504.2164 1395.1217,-11402.3404 1448.4655,-11402.3923 1506.2007,-11310.2164 1525.1921,-11279.896 1520.7115,-11266.8208 1542.2007,-11238.2164 1749.1247,-10962.7775 1850.7738,-10937.3345 2111.5532,-10712.2164 2178.0271,-10654.8327 2222.1737,-10664.6652 2265.3853,-10588.2164 2353.6792,-10432.0086 2382.1261,-9838.1059 2387.0185,-9718.3398"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2390.5191,-9718.3916 2387.4196,-9708.2603 2383.5247,-9718.1132 2390.5191,-9718.3916"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.8092,-13905.5638C417.6152,-13970.201 499.7927,-14290.435 585.7192,-14330.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge57" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M585.7192,-14330.2164C961.1746,-14504.0409 1147.8696,-14676.0509 1506.2007,-14469.2164 1825.849,-14284.7102 2257.6239,-13621.8192 2265.3853,-13611.2164 2282.6418,-13587.6422 2283.0923,-13578.9957 2301.3853,-13556.2164 2370.2396,-13470.4756 2431.6446,-13480.5848 2474.269,-13379.2164 2543.3252,-13214.9884 2476.9848,-11951.2356 2510.269,-11776.2164 2525.8304,-11694.3899 2566.8519,-11603.3764 2586.0464,-11563.638"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.2828,-11564.9869 2590.5316,-11554.4659 2582.9944,-11561.9118 2589.2828,-11564.9869"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge114" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M408.6297,-13882.925C426.9615,-13860.417 466.553,-13807.605 480.9653,-13755.2164 538.9083,-13544.5945 478.6496,-6106.2766 516.9653,-5891.2164 548.3951,-5714.8058 608.3157,-5685.358 654.4731,-5512.2164 678.4145,-5422.4097 655.4385,-5392.3035 690.4731,-5306.2164 783.0343,-5078.7753 812.1767,-5005.4594 1002.4307,-4850.2164 1045.077,-4815.4179 1083.7068,-4846.3523 1116.5955,-4802.2164 1205.2792,-4683.2045 1068.3794,-4592.4305 1152.5955,-4470.2164 1200.2883,-4401.0047 1249.3186,-4428.0624 1321.0291,-4384.2164 1337.8675,-4373.9208 1339.0369,-4366.3289 1357.0291,-4358.2164 1370.8482,-4351.9855 1615.1686,-4311.0662 1623.2106,-4298.2164"/>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1623.2106,-4298.2164C1657.8559,-4242.6785 1679.7898,-4235.9445 1704.2205,-4175.2164 1737.1134,-4093.4535 1684.1795,-4048.2349 1740.2205,-3980.2164 1742.9751,-3976.873 1746.2382,-3973.9747 1749.8083,-3971.4625"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1751.7676,-3974.3704 1758.6011,-3966.2738 1748.21,-3968.3418 1751.7676,-3974.3704"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge128" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M408.5851,-13882.9126C426.8386,-13860.3829 466.2993,-13807.5346 480.9653,-13755.2164 556.64,-13485.2606 479.8709,-11510.1134 516.9653,-11232.2164 549.505,-10988.4419 622.5601,-10940.0737 654.4731,-10696.2164 661.5815,-10641.8995 657.6918,-6796.1053 690.4731,-6752.2164 859.1242,-6526.4197 1628.7503,-6445.1852 1903.2231,-6381.2164 1941.0083,-6372.4101 1952.8439,-6380.2463 1989.3882,-6367.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge240" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M399.7396,-13905.3441C405.8404,-14007.3441 453.8703,-14777.9428 516.9653,-14856.2164 557.5892,-14906.6129 595.12,-14878.3841 654.4731,-14904.2164 1063.434,-15082.2087 1122.781,-15220.5017 1542.2007,-15372.2164 1626.8025,-15402.819 1650.7446,-15404.8318 1740.2205,-15414.2164 2077.9454,-15449.6381 2209.2372,-15414.5156 2474.269,-15202.2164 2577.516,-15119.5122 2627.3869,-15109.6254 2682.1736,-14989.2164 2764.3507,-14808.6091 2666.8267,-14735.8816 2718.1736,-14544.2164 2760.5596,-14385.9997 2838.8704,-14370.7307 2876.0764,-14211.2164 2890.7166,-14148.4489 2874.4385,-11943.5373 2912.0764,-11891.2164 2914.3432,-11888.0652 2917.0404,-11885.3089 2920.0372,-11882.8981"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.1414,-11885.7036 2928.5803,-11877.2899 2918.2999,-11879.8518 2922.1414,-11885.7036"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge631" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M400.2125,-13905.415C408.3366,-13986.4762 458.2165,-14491.8653 480.9653,-14904.2164 484.7219,-14972.3088 486.9031,-16070.004 516.9653,-16131.2164 593.5405,-16287.1381 991.8076,-16520.4699 1152.5955,-16586.2164 1190.0222,-16601.5202 1477.4705,-16643.7639 1506.2007,-16672.2164 1552.4618,-16718.0303 1499.1755,-16765.3508 1542.2007,-16814.2164 1604.7088,-16885.2097 1647.2901,-16874.5734 1740.2205,-16892.2164 2418.1259,-17020.9176 2636.3278,-16868.6625 3259.4165,-16572.2164 3460.7122,-16476.4462 3590.2882,-16519.4153 3694.2327,-16322.2164 3752.1019,-16212.4294 3782.8152,-7632.4966 3784.4989,-7149.4123"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3787.9994,-7149.2648 3784.5342,-7139.2527 3780.9994,-7149.2404 3787.9994,-7149.2648"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge670" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M408.6343,-13882.9263C426.9743,-13860.4205 466.5794,-13807.6123 480.9653,-13755.2164 555.1218,-13485.1266 466.7806,-3947.7688 516.9653,-3672.2164 551.1503,-3484.5149 1072.8652,-2248.9262 1116.5955,-2063.2164 1133.9595,-1989.4763 1110.5522,-1787.236 1152.5955,-1724.2164 1199.934,-1653.2594 1259.0617,-1690.8327 1321.0291,-1632.2164 1343.0701,-1611.3672 1335.3355,-1595.4269 1357.0291,-1574.2164 1412.068,-1520.4029 1441.0024,-1527.1352 1506.2007,-1486.2164 1559.1384,-1452.9924 1561.4716,-1398.4935 1623.2106,-1408.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge731" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M585.7192,-14330.2164C678.8931,-14369.6085 688.9463,-14254.7173 755.1332,-14178.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M755.1332,-14178.2164C785.272,-14143.3809 801.3382,-14139.4215 819.7932,-14097.2164 862.4781,-13999.5992 820.702,-13960.8132 855.7932,-13860.2164 888.3584,-13766.8609 925.4359,-13757.1895 966.4307,-13667.2164 1186.7865,-13183.591 1235.4694,-13049.7445 1321.0291,-12525.2164 1350.9651,-12341.6919 1287.3512,-11861.6182 1357.0291,-11689.2164 1471.073,-11407.041 2100.516,-10920.0426 2265.3853,-10664.2164 2388.7747,-10472.7541 2420.0207,-10417.44 2474.269,-10196.2164 2536.6256,-9941.9276 2454.8201,-9864.1002 2510.269,-9608.2164 2555.5226,-9399.382 2637.1124,-9368.0924 2682.1736,-9159.2164 2766.6742,-8767.5229 2793.4141,-7430.6305 2796.7539,-7244.7363"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2800.2558,-7244.6533 2796.9332,-7234.593 2793.2569,-7244.5295 2800.2558,-7244.6533"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge766" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M399.9012,-13905.4474C407.028,-14002.1331 459.7195,-14692.1401 516.9653,-14762.2164 537.4413,-14787.2815 558.0986,-14769.3454 585.7192,-14786.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M585.7192,-14786.2164C710.2645,-14862.2899 1732.6904,-14554.782 1867.2231,-14498.2164 1968.9304,-14455.4525 2001.0887,-14444.6299 2075.5532,-14363.2164 2331.6649,-14083.2044 2375.165,-13974.5199 2474.269,-13608.2164 2523.354,-13426.791 2492.9214,-12950.3622 2510.269,-12763.2164 2559.9984,-12226.7383 2630.3768,-12099.4988 2682.1736,-11563.2164 2693.6749,-11444.1362 2785.441,-9524.1446 2796.1135,-9300.432"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2799.6154,-9300.4751 2796.5958,-9290.3197 2792.6233,-9300.1415 2799.6154,-9300.4751"/>
</g>
<!-- sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node31" class="node">
<title>sourcefile~dataplant.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node31"><a xlink:href="../sourcefile/dataplant.f90.html" xlink:title="DataPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2027.0146,-4346.2218 1951.7618,-4346.2218 1951.7618,-4324.2109 2027.0146,-4324.2109 2027.0146,-4346.2218"/>
<text text-anchor="middle" x="1989.3882" y="-4332.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge806" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M408.6331,-13882.9259C426.9708,-13860.4196 466.5722,-13807.6103 480.9653,-13755.2164 549.8463,-13504.4758 451.7863,-4645.9447 516.9653,-4394.2164 595.2867,-4091.7309 621.3547,-3984.7842 855.7932,-3778.2164 1024.769,-3629.3289 1706.5283,-3556.427 1867.2231,-3714.2164 1961.8982,-3807.1796 1820.3735,-4206.5753 1903.2231,-4310.2164 1912.6268,-4321.9799 1927.2183,-4328.4237 1941.7376,-4331.8882"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1941.2272,-4335.3547 1951.7132,-4333.8395 1942.571,-4328.4849 1941.2272,-4335.3547"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge840" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M755.1332,-14178.2164C1040.0291,-13895.6524 1224.6157,-13963.0799 1506.2007,-13677.2164 1898.5816,-13278.8734 1920.502,-13110.9642 2188.4692,-12620.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge852" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M408.5977,-13882.9161C426.8735,-13860.3926 466.3713,-13807.5547 480.9653,-13755.2164 527.5994,-13587.9738 491.0515,-10801.8942 516.9653,-10630.2164 549.0679,-10417.5382 622.5074,-10378.9152 654.4731,-10166.2164 668.9971,-10069.5743 637.8825,-6730.5866 690.4731,-6648.2164 746.9183,-6559.8089 1058.3044,-6532.4178 1116.5955,-6445.2164 1201.6774,-6317.9368 1069.9219,-5886.0732 1152.5955,-5757.2164 1207.9741,-5670.902 1260.4537,-5684.7149 1357.0291,-5650.2164 1445.8692,-5618.481 2135.3269,-5400.2702 2188.4692,-5478.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge880" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M408.6275,-13882.9244C426.9554,-13860.4153 466.5404,-13807.6016 480.9653,-13755.2164 533.4502,-13564.6136 507.1488,-6835.6695 516.9653,-6638.2164 530.8964,-6358.002 572.1203,-6018.9806 583.0399,-5932.2219"/>
<polygon fill="#ff0028" stroke="#ff0028" points="586.5131,-5932.6538 584.2963,-5922.2935 579.5684,-5931.7749 586.5131,-5932.6538"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge88" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-15146.2164C614.5816,-15177.2562 927.4185,-15153.6465 966.4307,-15170.2164 990.992,-15180.6485 1309.29,-15470.2522 1321.0291,-15494.2164 1364.771,-15583.5117 1283.9453,-15872.794 1357.0291,-15940.2164 1403.3419,-15982.9416 1651.2584,-15953.5535 1867.2231,-15904.2164 2340.3759,-15796.1246 2602.6881,-15887.2352 2876.0764,-15486.2164 2906.7651,-15441.2008 2909.171,-14560.62 2912.0764,-14506.2164 2933.3294,-14108.2582 2972.4564,-13623.0897 2981.1926,-13516.5479"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2984.693,-13516.6854 2982.0242,-13506.4323 2977.7166,-13516.1119 2984.693,-13516.6854"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.5125,-13905.3482C402.8673,-13988.0481 427.1998,-14515.1009 516.9653,-14932.2164 537.983,-15029.8797 519.3363,-15071.5626 585.7192,-15146.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge587" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M400.09,-13905.4226C407.3526,-13986.5376 452.2892,-14492.2351 480.9653,-14904.2164 490.533,-15041.6718 465.6719,-15395.3316 516.9653,-15523.2164 561.2743,-15633.6873 611.0122,-15638.5988 690.4731,-15727.2164 1038.4047,-16115.2415 1067.1248,-16318.9203 1542.2007,-16533.2164 1671.6429,-16591.6049 2388.7793,-16773.8651 2596.2213,-16688.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2596.2213,-16688.2164C2924.8677,-16528.7698 2980.1056,-16440.6364 3295.4165,-16256.2164 3423.8731,-16181.0843 3512.3308,-16222.0894 3588.4519,-16094.2164 3648.7171,-15992.9791 3658.7835,-7852.7979 3659.3188,-7378.7574"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3662.819,-7378.4783 3659.3302,-7368.4744 3655.819,-7378.4704 3662.819,-7378.4783"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge306" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M408.6357,-13882.9266C426.9779,-13860.4215 466.5869,-13807.6143 480.9653,-13755.2164 561.5078,-13461.7039 433.7378,-3090.9788 516.9653,-2798.2164 621.3592,-2430.9989 845.4115,-2428.2953 966.4307,-2066.2164 1020.2076,-1905.3204 933.0535,-1841.0268 1002.4307,-1686.2164 1032.9327,-1618.1531 1085.1503,-1630.8491 1116.5955,-1563.2164 1171.9099,-1444.2452 1082.7267,-1381.2668 1152.5955,-1270.2164 1210.0625,-1178.8775 1258.4647,-1183.1518 1357.0291,-1139.2164 1648.8984,-1009.1146 1844.0846,-892.9065 2075.5532,-1113.2164 2150.8176,-1184.8524 2048.8503,-1261.3623 2111.5532,-1344.2164 2179.2803,-1433.7092 2484.5127,-1475.3951 2596.2213,-1486.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge342" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-15146.2164C607.2261,-15170.4028 626.0456,-15154.7437 654.4731,-15170.2164 672.2766,-15179.9066 671.8657,-15190.1774 690.4731,-15198.2164 804.4214,-15247.4455 852.922,-15190.9821 966.4307,-15241.2164 1059.0058,-15282.1863 1273.6409,-15437.7566 1321.0291,-15527.2164 1366.6404,-15613.322 1297.3804,-15887.167 1357.0291,-15964.2164 1400.0093,-16019.7349 1446.568,-15979.1548 1506.2007,-16016.2164 1630.0612,-16093.1955 1605.248,-16190.9927 1740.2205,-16246.2164 1792.4625,-16267.5911 1810.9851,-16251.0532 1867.2231,-16246.2164 2046.161,-16230.8264 2094.3647,-16232.0578 2265.3853,-16177.2164 2322.907,-16158.7708 2331.7124,-16140.5799 2387.8271,-16118.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge493" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M585.7192,-14330.2164C1053.1615,-14508.8356 1288.3884,-14479.5881 1704.2205,-14201.2164 1731.6628,-14182.8456 1723.0296,-14164.4128 1740.2205,-14136.2164 1793.0952,-14049.4913 1829.12,-14040.3712 1867.2231,-13946.2164 1900.776,-13863.3055 1849.5301,-13819.75 1903.2231,-13748.2164 1954.6086,-13679.7571 2019.2616,-13726.702 2075.5532,-13662.2164 2108.2725,-13624.7343 2085.8249,-13598.8017 2111.5532,-13556.2164 2162.8969,-13471.2325 2222.2312,-13483.6376 2265.3853,-13394.2164 2315.3229,-13290.7387 2275.6852,-13250.2025 2301.3853,-13138.2164 2357.4683,-12893.8387 2431.251,-12848.2289 2474.269,-12601.2164 2515.3927,-12365.0814 2450.7947,-11755.4095 2510.269,-11523.2164 2525.2171,-11464.858 2562.4103,-11403.4781 2582.6235,-11372.9235"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2585.6332,-11374.7198 2588.308,-11364.4681 2579.824,-11370.8143 2585.6332,-11374.7198"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge521" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M585.7192,-14786.2164C880.8605,-14936.6668 1789.4656,-15005.2419 2075.5532,-14838.2164 2330.7276,-14689.2388 2335.6777,-14567.1775 2474.269,-14306.2164 2497.2112,-14263.0174 2487.7086,-14245.6159 2510.269,-14202.2164 2570.453,-14086.4403 2638.061,-14087.0182 2682.1736,-13964.2164 2724.3311,-13846.8572 2707.5565,-13528.4649 2718.1736,-13404.2164 2742.517,-13119.3322 2783.7716,-12774 2794.5083,-12685.6163"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2798.0054,-12685.8516 2795.7402,-12675.5017 2791.0568,-12685.0052 2798.0054,-12685.8516"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge415" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.633,-13882.9259C426.9706,-13860.4195 466.5718,-13807.6102 480.9653,-13755.2164 515.267,-13630.3553 450.2006,-4543.164 516.9653,-4432.2164 595.6671,-4301.432 733.1102,-4395.853 819.7932,-4270.2164 890.7963,-4167.3059 806.8831,-4106.2807 855.7932,-3991.2164 1006.4634,-3636.7542 1197.012,-3633.0663 1542.2007,-3462.2164 1820.2759,-3324.5841 1878.1977,-3198.2164 2188.4692,-3198.2164 2188.4692,-3198.2164 2188.4692,-3198.2164 2387.8271,-3198.2164 2569.7373,-3198.2164 2664.0855,-3074.1527 2797.125,-3198.2164"/>
</g>
<!-- sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge386" class="edge">
<title>sourcefile~datasizing.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M408.6339,-13882.9261C426.9731,-13860.4202 466.5769,-13807.6116 480.9653,-13755.2164 553.2147,-13492.1212 444.6098,-4196.2824 516.9653,-3933.2164 548.854,-3817.2773 613.2518,-3813.1745 654.4731,-3700.2164 687.5366,-3609.6132 660.2224,-3577.797 690.4731,-3486.2164 786.23,-3196.3236 752.9297,-3050.1608 1002.4307,-2874.2164 1132.3057,-2782.6304 1198.5924,-2840.5995 1357.0291,-2828.2164 1439.1072,-2821.8013 1459.8797,-2824.3276 1542.2007,-2823.2164 1614.2029,-2822.2444 1632.2455,-2821.0107 1704.2205,-2823.2164 1776.7682,-2825.4396 1795.8198,-2820.1902 1867.2231,-2833.2164 1868.6466,-2833.4761 2264.3887,-2955.1673 2265.3853,-2956.2164 2310.2268,-3003.4207 2272.9647,-3039.6392 2301.3853,-3098.2164 2356.4347,-3211.6779 2424.4378,-3207.3682 2474.269,-3323.2164 2514.6323,-3417.0533 2467.3482,-3457.5213 2510.269,-3550.2164 2559.5184,-3656.579 2628.1369,-3646.2042 2682.1736,-3750.2164 2712.1895,-3807.9923 2676.969,-3841.8061 2718.1736,-3892.2164 2767.4643,-3952.5194 2831.3545,-3904.4513 2876.0764,-3968.2164 2937.6459,-4056.0029 2975.7287,-4858.4315 2982.0253,-5000.7029"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.5466,-5001.2686 2982.4808,-5011.1059 2985.5399,-5000.9624 2978.5466,-5001.2686"/>
</g>
<!-- sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node10" class="node">
<title>sourcefile~emsmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node10"><a xlink:href="../sourcefile/emsmanager.f90.html" xlink:title="EMSManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2434.4613,-4728.2218 2341.193,-4728.2218 2341.193,-4706.2109 2434.4613,-4706.2109 2434.4613,-4728.2218"/>
<text text-anchor="middle" x="2387.8271" y="-4714.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EMSManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge892" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2405.1489,-4706.074C2498.0273,-4646.5081 2938.4641,-4366.3488 3089.8293,-4312.2164 3125.7948,-4299.3541 3136.596,-4301.8086 3174.6229,-4298.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3784.5721,-16137.2164C3906.1483,-16135.6762 3922.2743,-7632.5603 3923.0922,-7149.5977"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3926.5924,-7149.4316 3923.1092,-7139.4258 3919.5924,-7149.4199 3926.5924,-7149.4316"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3174.6229,-4298.2164C3291.0737,-4267.8209 3336.1787,-4278.0123 3426.2747,-4198.2164 3451.2879,-4176.0627 3433.5427,-4149.2726 3462.2747,-4132.2164 3510.4967,-4103.5902 3548.1428,-4093.2291 3588.4519,-4132.2164 3715.1898,-4254.7982 3690.3924,-7127.938 3694.2327,-7304.2164 3695.5687,-7365.5453 3723.2336,-16137.9934 3784.5721,-16137.2164"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge56" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M2389.1543,-4728.3493C2398.5649,-4807.8981 2455.3842,-5298.3251 2474.269,-5699.2164 2481.6856,-5856.6561 2473.2277,-11220.0165 2510.269,-11373.2164 2524.4268,-11431.7715 2561.9544,-11493.0681 2582.4262,-11523.5584"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2579.6574,-11525.7103 2588.1872,-11531.9947 2585.4382,-11521.7627 2579.6574,-11525.7103"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge239" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2392.1296,-4728.4191C2425.1403,-4814.5018 2638.1293,-5372.2649 2682.1736,-5547.2164 2716.8083,-5684.7914 2864.6768,-6667.8074 2876.0764,-6809.2164 2952.362,-7755.5135 2865.3527,-10132.9998 2912.0764,-11081.2164 2927.0599,-11385.293 2969.5327,-11753.746 2980.3969,-11845.0101"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2976.9495,-11845.659 2981.6128,-11855.1723 2983.8999,-11844.8273 2976.9495,-11845.659"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge630" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2413.5716,-4706.1341C2433.9237,-4695.8713 2461.0357,-4678.516 2474.269,-4654.2164 2542.1845,-4529.507 2483.0968,-4155.5957 2510.269,-4016.2164 2555.5559,-3783.9184 2607.5404,-3736.8119 2682.1736,-3512.2164 2944.9706,-2721.3753 3062.7024,-2538.0284 3259.4165,-1728.2164 3282.5968,-1632.7903 3248.5251,-1596.4988 3295.4165,-1510.2164 3326.1435,-1453.6773 3461.2817,-1328.3537 3525.3633,-1334.2164"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge732" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2392.926,-4728.5122C2408.4557,-4763.5219 2455.2662,-4873.6654 2474.269,-4970.2164 2526.2867,-5234.5105 2461.1752,-5310.3635 2510.269,-5575.2164 2556.3283,-5823.6983 2638.7853,-5868.2542 2682.1736,-6117.2164 2718.3688,-6324.9045 2665.8776,-6860.9872 2718.1736,-7065.2164 2731.8327,-7118.5585 2765.1745,-7174.8059 2783.8665,-7203.6382"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2780.951,-7205.5748 2789.3771,-7211.9976 2786.7954,-7201.7221 2780.951,-7205.5748"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge767" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2391.3449,-4728.4794C2405.0738,-4773.0306 2455.2266,-4941.4715 2474.269,-5084.2164 2536.6589,-5551.9002 2439.3125,-5678.7554 2510.269,-6145.2164 2553.6589,-6430.457 2641.5232,-6485.5725 2682.1736,-6771.2164 2701.3135,-6905.7093 2658.35,-9094.2498 2718.1736,-9216.2164 2728.1034,-9236.4609 2747.9769,-9252.2628 2765.2997,-9262.9774"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2763.6628,-9266.0748 2774.0597,-9268.1133 2767.2032,-9260.0362 2763.6628,-9266.0748"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge87" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2392.7294,-4728.5533C2407.6933,-4763.6811 2453.0481,-4874.1286 2474.269,-4970.2164 2507.0388,-5118.5967 2459.5259,-5166.9833 2510.269,-5310.2164 2557.1494,-5442.5459 2640.4194,-5441.1811 2682.1736,-5575.2164 2765.6171,-5843.0788 2664.9178,-6561.7587 2718.1736,-6837.2164 2737.4171,-6936.7507 2783.8026,-6950.7181 2797.125,-7051.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-7051.2164C2806.562,-7126.7542 2857.8037,-7129.3169 2876.0764,-7203.2164 2896.9698,-7287.7147 2861.5921,-13399.3092 2912.0764,-13470.2164 2915.8012,-13475.4479 2920.7135,-13479.5919 2926.2192,-13482.8732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2924.7587,-13486.0555 2935.2739,-13487.3516 2927.8621,-13479.781 2924.7587,-13486.0555"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge264" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2414.2239,-4706.0551C2434.6687,-4695.8413 2461.5769,-4678.5939 2474.269,-4654.2164 2522.7161,-4561.165 2499.237,-2870.5427 2510.269,-2766.2164 2527.6393,-2601.9511 2574.6998,-2407.7704 2590.7625,-2344.3739"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2594.2254,-2344.9588 2593.3074,-2334.4038 2587.4429,-2343.2275 2594.2254,-2344.9588"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge588" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-4298.2164C3230.4209,-4292.5815 3386.8121,-4277.3683 3426.2747,-4317.2164 3485.3334,-4376.8521 3583.6731,-7258.8579 3624.4519,-7332.2164 3625.9114,-7334.842 3627.7765,-7337.2606 3629.8831,-7339.4723"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.8649,-7342.3518 3637.7381,-7346.195 3632.4165,-7337.0336 3627.8649,-7342.3518"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge307" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2412.9086,-4706.198C2433.15,-4695.8757 2460.4528,-4678.4035 2474.269,-4654.2164 2515.2443,-4582.4841 2459.217,-4349.1639 2510.269,-4284.2164 2593.7071,-4178.068 2662.1087,-4184.2164 2797.125,-4184.2164 2797.125,-4184.2164 2797.125,-4184.2164 2982.9529,-4184.2164 3150.9052,-4184.2164 3197.3802,-4145.654 3360.8456,-4184.2164"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge341" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2395.51,-4728.4538C2411.2634,-4751.7259 2447.9543,-4807.1257 2474.269,-4856.2164 2579.5007,-5052.5279 2611.1093,-5101.1198 2682.1736,-5312.2164 2921.8671,-6024.226 2967.9763,-6214.8653 3053.8293,-6961.2164 3069.3238,-7095.9152 3028.4735,-11721.3061 3089.8293,-11842.2164 3100.456,-11863.1577 3121.666,-11878.9115 3140.2136,-11889.4281"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.5806,-11892.5239 3149.0468,-11894.1699 3141.8914,-11886.3564 3138.5806,-11892.5239"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge453" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M3174.6229,-5462.2164C3270.4438,-5396.8247 3346.9123,-4508.0648 3359.1376,-4358.5076"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3362.6414,-4358.6018 3359.9615,-4348.3516 3355.6643,-4358.0358 3362.6414,-4358.6018"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M2434.5095,-4722.9009C2556.3543,-4740.305 2886.1388,-4804.3131 3053.8293,-5002.2164 3190.477,-5163.4837 3000.0288,-5581.3659 3174.6229,-5462.2164"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge494" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2391.4642,-4728.4643C2405.6394,-4772.9592 2457.2377,-4941.2177 2474.269,-5084.2164 2484.5255,-5170.3314 2458.0093,-11259.0072 2510.269,-11328.2164 2512.6073,-11331.313 2515.3071,-11334.0434 2518.2757,-11336.4496"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.4414,-11339.4335 2526.6977,-11342.0904 2520.3368,-11333.6175 2516.4414,-11339.4335"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge520" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2434.4481,-4714.8947C2449.3437,-4716.6985 2464.4874,-4721.7004 2474.269,-4733.2164 2537.3663,-4807.5007 2487.7638,-6392.3853 2510.269,-6487.2164 2551.21,-6659.7304 2642.3914,-6674.4314 2682.1736,-6847.2164 2745.3978,-7121.8168 2702.3064,-11637.8786 2718.1736,-11919.2164 2734.3813,-12206.5923 2781.5661,-12553.8446 2794.0598,-12642.7031"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2790.632,-12643.4601 2795.4973,-12652.8717 2797.5631,-12642.4802 2790.632,-12643.4601"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge555" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M2389.1633,-4728.3489C2398.6365,-4807.8947 2455.8101,-5298.3052 2474.269,-5699.2164 2496.0677,-6172.6635 2459.8076,-13758.9617 2510.269,-14230.2164 2526.2631,-14379.583 2573.4274,-14554.9911 2590.2091,-14614.3732"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2586.8681,-14615.4205 2592.9747,-14624.0784 2593.6002,-14613.5021 2586.8681,-14615.4205"/>
</g>
<!-- sourcefile~emsmanager.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge563" class="edge">
<title>sourcefile~emsmanager.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2391.4069,-4728.4713C2405.3678,-4772.9925 2456.2718,-4941.336 2474.269,-5084.2164 2487.2339,-5187.1446 2473.5119,-6854.205 2510.269,-6951.2164 2523.2326,-6985.4306 2553.2201,-7016.085 2574.1022,-7034.4161"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2571.9953,-7037.2192 2581.8757,-7041.0441 2576.5371,-7031.8926 2571.9953,-7037.2192"/>
</g>
<!-- sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node11" class="node">
<title>sourcefile~datainterfaces.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node11"><a xlink:href="../sourcefile/datainterfaces.f90.html" xlink:title="DataInterfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.8836,-10163.2218 350.2841,-10163.2218 350.2841,-10141.2109 447.8836,-10141.2109 447.8836,-10163.2218"/>
<text text-anchor="middle" x="399.0839" y="-10149.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataInterfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge893" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2982.9529,-17030.2164C3295.1311,-17023.3982 3394.6305,-17005.8347 3659.3423,-16840.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-15585.2164C943.6183,-15704.0727 1201.3539,-16227.7839 1357.0291,-16387.2164 1430.2469,-16462.2014 1452.1259,-16479.6427 1542.2007,-16533.2164 1687.7439,-16619.7809 2814.0222,-17018.4412 2982.9529,-17030.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge34" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-10682.2164C655.4127,-10882.7522 667.9703,-10977.25 855.7932,-11076.2164 962.6061,-11132.4975 1011.1471,-11059.0143 1116.5955,-11000.2164 1209.6108,-10948.3512 1266.1259,-10966.4715 1321.0291,-10875.2164 1388.4036,-10763.2323 1289.9719,-10400.3908 1357.0291,-10288.2164 1450.1562,-10132.4315 1556.9894,-10179.3513 1704.2205,-10073.2164 1721.1156,-10061.0371 1723.7113,-10055.9138 1740.2205,-10043.2164 1767.6396,-10022.128 1772.9875,-10014.0886 1803.7218,-9998.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M400.245,-10163.5334C407.385,-10231.0823 447.3418,-10580.717 516.9653,-10658.2164 538.5951,-10682.2929 574.3311,-10651.9206 585.7192,-10682.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge58" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M755.1332,-13760.2164C808.6823,-13808.9022 794.493,-13849.7443 855.7932,-13888.2164 988.0806,-13971.2402 1386.9329,-14022.3398 1542.2007,-14039.2164 1613.7878,-14046.9974 1634.6178,-14057.6755 1704.2205,-14039.2164 1784.8409,-14017.8353 1802.4764,-13998.7965 1867.2231,-13946.2164 1906.6954,-13914.1614 2455.6594,-13308.5372 2474.269,-13261.2164 2534.6738,-13107.6186 2479.2891,-11938.3313 2510.269,-11776.2164 2525.9033,-11694.4038 2566.8877,-11603.3832 2586.0596,-11563.6405"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.296,-11564.989 2590.5393,-11554.4674 2583.006,-11561.9173 2589.296,-11564.989"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M401.887,-10163.3082C414.2436,-10212.8209 463.9874,-10418.7713 480.9653,-10591.2164 489.2153,-10675.0116 474.4893,-13549.515 516.9653,-13622.2164 578.6802,-13727.8467 664.5615,-13677.9773 755.1332,-13760.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge103" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2596.2213,-9622.2164C2656.6143,-9533.8308 2651.953,-9499.9103 2682.1736,-9397.2164 2704.0993,-9322.7096 2665.7131,-9283.4868 2718.1736,-9226.2164 2742.9462,-9199.1725 2771.7162,-9228.6634 2797.125,-9202.2164"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M585.7192,-10682.2164C639.7141,-10825.8585 592.4862,-10893.1187 690.4731,-11011.2164 811.9098,-11157.5765 941.7056,-11124.927 1116.5955,-11050.2164 1122.5016,-11047.6934 1317.5459,-10947.6122 1321.0291,-10942.2164 1391.4264,-10833.162 1278.0911,-10462.2574 1357.0291,-10359.2164 1456.0545,-10229.9543 1558.3229,-10314.5258 1704.2205,-10242.2164 1974.1017,-10108.4583 2068.0959,-10089.8213 2265.3853,-9862.2164 2289.3411,-9834.5795 2274.7204,-9813.2496 2301.3853,-9788.2164 2361.9443,-9731.3629 2402.4221,-9758.9026 2474.269,-9717.2164 2533.6962,-9682.7362 2557.4599,-9678.944 2596.2213,-9622.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge115" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M399.3788,-10141.1942C403.6102,-9982.7612 452.3831,-8147.5966 480.9653,-6666.2164 482.243,-6599.9989 491.3903,-4343.3089 516.9653,-4282.2164 655.3385,-3951.6772 804.2486,-3870.227 1152.5955,-3786.2164 1225.3684,-3768.6658 1247.2285,-3773.6703 1321.0291,-3786.2164 1411.3678,-3801.574 1669.8305,-3902.0346 1766.5725,-3940.378"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1765.3685,-3943.6657 1775.9543,-3944.1028 1767.9516,-3937.1597 1765.3685,-3943.6657"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge129" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M399.3459,-10141.0749C405.081,-9897.4067 503.1612,-5737.9416 516.9653,-5679.2164 558.803,-5501.2317 536.317,-5404.5261 690.4731,-5306.2164 738.9331,-5275.3121 772.9742,-5272.8783 819.7932,-5306.2164 859.6373,-5334.5879 832.1494,-5367.3974 855.7932,-5410.2164 893.7925,-5479.033 925.1701,-5481.3041 966.4307,-5548.2164 1050.5827,-5684.6855 1072.9991,-5721.9285 1116.5955,-5876.2164 1134.5534,-5939.7698 1113.7614,-6117.7987 1152.5955,-6171.2164 1230.135,-6277.875 1926.9426,-6395.1675 1989.3882,-6367.2164"/>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M1989.3882,-6367.2164C2045.7919,-6347.1056 2110.6037,-6322.3854 2150.5497,-6306.9609"/>
<polygon fill="#fff100" stroke="#fff100" points="2151.8406,-6310.2144 2159.9049,-6303.3429 2149.3156,-6303.6856 2151.8406,-6310.2144"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge195" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M585.7192,-2812.2164C608.9502,-2780.7417 1845.037,-3363.9967 1867.2231,-3396.2164 1939.4554,-3501.1151 1841.6084,-3856.7495 1903.2231,-3968.2164 1926.0471,-4009.5071 1974.3043,-3985.5136 1989.3882,-4030.2164"/>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1989.3882,-4030.2164C1991.3565,-4035.6534 2108.2736,-4423.4541 2111.5532,-4428.2164 2136.1435,-4463.924 2165.8448,-4451.2319 2188.4692,-4488.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge241" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M401.8879,-10163.3081C414.2483,-10212.8205 464.006,-10418.7695 480.9653,-10591.2164 497.7518,-10761.9046 471.8832,-13512.7357 516.9653,-13678.2164 533.122,-13737.522 565.8021,-13740.0657 585.7192,-13798.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M585.7192,-13798.2164C590.7716,-13812.9673 639.6525,-13807.3725 654.4731,-13812.2164 731.3396,-13837.339 764.2906,-13829.4026 819.7932,-13888.2164 849.9288,-13920.1498 828.7726,-13945.6073 855.7932,-13980.2164 1023.7868,-14195.3886 1127.919,-14186.7929 1357.0291,-14335.2164 1437.3683,-14387.2622 1455.4177,-14404.8197 1542.2007,-14445.2164 1626.6938,-14484.5471 1650.0189,-14490.7713 1740.2205,-14514.2164 1902.3786,-14556.3642 1944.6356,-14564.7175 2111.5532,-14579.2164 2179.6665,-14585.1328 2202.4411,-14605.9084 2265.3853,-14579.2164 2388.3342,-14527.0789 2410.9103,-14480.7767 2474.269,-14363.2164 2509.0555,-14298.6711 2471.0524,-14264.17 2510.269,-14202.2164 2562.081,-14120.365 2616.8535,-14139.7525 2682.1736,-14068.2164 2702.1247,-14046.3666 2694.5704,-14030.0586 2718.1736,-14012.2164 2747.4301,-13990.1006 2775.8607,-14018.0975 2797.125,-13988.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge632" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M585.7192,-15471.2164C604.2149,-15497.7765 626.5922,-15478.7793 654.4731,-15495.2164 706.1702,-15525.6941 701.6645,-15557.9663 755.1332,-15585.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M755.1332,-15585.2164C847.7007,-15632.3931 884.995,-15620.6979 966.4307,-15685.2164 991.2082,-15704.8467 1306.466,-16102.1594 1321.0291,-16130.2164 1347.27,-16180.7718 1331.0353,-16202.5334 1357.0291,-16253.2164 1406.183,-16349.0574 1440.7351,-16358.6835 1506.2007,-16444.2164 1522.4084,-16465.3923 1520.3195,-16476.9741 1542.2007,-16492.2164 1753.5643,-16639.4506 2433.5108,-16769.4422 2682.1736,-16702.2164 2700.0549,-16697.3822 2701.4483,-16689.1773 2718.1736,-16681.2164 3091.4006,-16503.5663 3218.6239,-16537.8382 3588.4519,-16353.2164 3592.6256,-16351.1328 3656.6996,-16312.0605 3659.3423,-16308.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node15" class="node">
<title>sourcefile~reportsizingmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node15"><a xlink:href="../sourcefile/reportsizingmanager.f90.html" xlink:title="ReportSizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2253.9643,-6833.2218 2122.9742,-6833.2218 2122.9742,-6811.2109 2253.9643,-6811.2109 2253.9643,-6833.2218"/>
<text text-anchor="middle" x="2188.4692" y="-6819.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ReportSizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge654" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M399.4071,-10141.1947C404.0396,-9982.7688 457.2682,-8147.6828 480.9653,-6666.2164 481.9057,-6607.4301 491.536,-2486.2264 516.9653,-2433.2164 572.7374,-2316.9536 894.5726,-2173.2863 966.4307,-2066.2164 996.9859,-2020.6884 979.9074,-1998.2076 1002.4307,-1948.2164 1042.2746,-1859.7812 1082.9815,-1853.2022 1116.5955,-1762.2164 1151.9953,-1666.3966 1099.6944,-1622.6008 1152.5955,-1535.2164 1211.2306,-1438.3603 1249.5431,-1418.7967 1357.0291,-1383.2164 1503.5925,-1334.7005 1557.7581,-1345.396 1704.2205,-1394.2164 1722.4633,-1400.2973 1724.1132,-1407.7124 1740.2205,-1418.2164 1796.2984,-1454.7864 1834.7669,-1440.6612 1867.2231,-1499.2164 1919.9466,-1594.3363 1880.8618,-5307.7855 1903.2231,-5414.2164 1943.1925,-5604.4542 2032.1392,-5626.735 2075.5532,-5816.2164 2154.1486,-6159.2471 2043.5284,-6261.934 2111.5532,-6607.2164 2126.1223,-6681.1663 2161.4755,-6763.8616 2178.7053,-6801.5239"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="2175.6731,-6803.3051 2183.0521,-6810.9077 2182.0247,-6800.3628 2175.6731,-6803.3051"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge671" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M399.4058,-10141.1946C404.0211,-9982.7685 457.0575,-8147.6794 480.9653,-6666.2164 481.8833,-6609.3327 491.8748,-2621.2758 516.9653,-2570.2164 592.4615,-2416.5811 698.9315,-2453.443 819.7932,-2332.2164 971.0972,-2180.4555 1032.8678,-2149.4825 1116.5955,-1952.2164 1161.4863,-1846.4516 1093.6461,-1794.8387 1152.5955,-1696.2164 1215.5019,-1590.9738 1501.9121,-1390.3309 1623.2106,-1408.2164"/>
</g>
<!-- sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node19" class="node">
<title>sourcefile~outairnodemanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node19"><a xlink:href="../sourcefile/outairnodemanager.f90.html" xlink:title="OutAirNodeManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2251.2085,-5336.2218 2125.73,-5336.2218 2125.73,-5314.2109 2251.2085,-5314.2109 2251.2085,-5336.2218"/>
<text text-anchor="middle" x="2188.4692" y="-5322.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutAirNodeManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge682" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M399.387,-10141.1943C403.7357,-9982.7636 453.8111,-8147.6235 480.9653,-6666.2164 482.3568,-6590.3059 491.8467,-4004.8641 516.9653,-3933.2164 558.5116,-3814.7108 582.7285,-3774.7204 690.4731,-3710.2164 914.8399,-3575.8936 1702.7604,-3510.9061 1867.2231,-3714.2164 1927.6516,-3788.9185 1857.635,-4493.6367 1903.2231,-4578.2164 1947.9927,-4661.2773 2029.8498,-4619.6656 2075.5532,-4702.2164 2135.9538,-4811.3135 2054.593,-5151.2842 2111.5532,-5262.2164 2121.665,-5281.9093 2140.9494,-5297.6825 2157.6781,-5308.5208"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2156.2826,-5311.7714 2166.6344,-5314.0279 2159.9492,-5305.8085 2156.2826,-5311.7714"/>
</g>
<!-- sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node21" class="node">
<title>sourcefile~dataenvironment.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node21"><a xlink:href="../sourcefile/dataenvironment.f90.html" xlink:title="DataEnvironment.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="966.25,-7082.2218 855.9739,-7082.2218 855.9739,-7060.2109 966.25,-7060.2109 966.25,-7082.2218"/>
<text text-anchor="middle" x="911.1119" y="-7068.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEnvironment.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge686" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-6766.2164C801.0468,-6792.5434 799.8826,-6817.1783 819.7932,-6866.2164 850.485,-6941.8075 805.0111,-6982.3636 855.7932,-7046.2164 858.3404,-7049.4191 861.3874,-7052.2255 864.7242,-7054.682"/>
<polygon fill="#00ffff" stroke="#00ffff" points="863.1471,-7057.8215 873.4954,-7060.094 866.8229,-7051.8642 863.1471,-7057.8215"/>
</g>
<!-- sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node22" class="node">
<title>sourcefile~dataheatbalance.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node22"><a xlink:href="../sourcefile/dataheatbalance.f90.html" xlink:title="DataHeatBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1115.3299,-6130.2218 1003.6963,-6130.2218 1003.6963,-6108.2109 1115.3299,-6108.2109 1115.3299,-6130.2218"/>
<text text-anchor="middle" x="1059.5131" y="-6116.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge699" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M399.278,-10141.1808C402.8646,-9938.5934 455.6553,-7010.3198 516.9653,-6638.2164 560.3623,-6374.8307 476.1836,-6222.387 690.4731,-6063.2164 796.0859,-5984.7691 966.2783,-6065.962 1032.2038,-6102.9315"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1030.7341,-6106.1227 1041.1538,-6108.0409 1034.2046,-6100.0435 1030.7341,-6106.1227"/>
</g>
<!-- sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node23" class="node">
<title>sourcefile~psychroutines.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node23"><a xlink:href="../sourcefile/psychroutines.f90.html" xlink:title="PsychRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1481.1637,-11720.2218 1382.066,-11720.2218 1382.066,-11698.2109 1481.1637,-11698.2109 1481.1637,-11720.2218"/>
<text text-anchor="middle" x="1431.6149" y="-11706.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">PsychRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge707" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00aeff" stroke-dasharray="5,2" d="M401.8276,-10163.3142C413.9319,-10212.8527 462.7598,-10418.8966 480.9653,-10591.2164 513.1495,-10895.8477 465.5958,-11667.2276 516.9653,-11969.2164 533.718,-12067.701 543.5131,-12092.6707 585.7192,-12183.2164"/>
<path fill="none" stroke="#00aeff" stroke-dasharray="5,2" d="M585.7192,-12183.2164C644.8552,-12310.0818 717.5028,-12323.5912 855.7932,-12345.2164 1061.4034,-12377.3687 1176.8728,-12442.3106 1321.0291,-12292.2164 1372.4342,-12238.6938 1342.4001,-12032.9704 1357.0291,-11960.2164 1374.543,-11873.1146 1408.7859,-11772.7163 1424.0076,-11730.0882"/>
<polygon fill="#00aeff" stroke="#00aeff" points="1427.3513,-11731.1329 1427.4459,-11720.5385 1420.7652,-11728.7616 1427.3513,-11731.1329"/>
</g>
<!-- sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node25" class="node">
<title>sourcefile~branchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node25"><a xlink:href="../sourcefile/branchnodeconnections.f90.html" xlink:title="BranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1504.8695,-9895.2218 1358.3603,-9895.2218 1358.3603,-9873.2109 1504.8695,-9873.2109 1504.8695,-9895.2218"/>
<text text-anchor="middle" x="1431.6149" y="-9881.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">BranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge714" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M401.1506,-10163.4582C411.9469,-10221.1556 463.4167,-10483.6583 516.9653,-10544.2164 574.8577,-10609.6867 1187.6032,-10933.4407 1236.8123,-10861.2164"/>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M1236.8123,-10861.2164C1260.4695,-10828.7136 1297.6556,-10860.9237 1321.0291,-10828.2164 1374.3767,-10753.5651 1329.7614,-10090.8249 1357.0291,-10003.2164 1369.1191,-9964.372 1397.1332,-9925.6116 1415.1781,-9903.3267"/>
<polygon fill="#005dff" stroke="#005dff" points="1418.0924,-9905.2951 1421.7766,-9895.3614 1412.7018,-9900.8295 1418.0924,-9905.2951"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge726" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M585.7192,-10152.2164C647.0732,-10150.4072 637.5943,-10211.0489 690.4731,-10242.2164 716.8809,-10257.7814 737.2004,-10241.3557 755.1332,-10266.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge733" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M410.7416,-10163.4683C482.4822,-10231.3515 869.1317,-10577.4763 1116.5955,-10399.2164 1390.3382,-10202.0265 1185.0855,-9969.4823 1357.0291,-9679.2164 1406.7454,-9595.288 1459.6232,-9603.9265 1506.2007,-9518.2164 1537.2884,-9461.01 1505.1298,-9429.7399 1542.2007,-9376.2164 1567.2453,-9340.0566 1834.2352,-9179.312 1867.2231,-9150.2164 1885.1605,-9134.3955 1885.4445,-9126.2154 1903.2231,-9110.2164 1973.5559,-9046.9239 2026.7643,-9066.2859 2075.5532,-8985.2164 2134.5718,-8887.1488 2045.1123,-8823.4153 2111.5532,-8730.2164 2191.2277,-8618.4543 2269.7019,-8662.1105 2387.8271,-8592.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2387.8271,-8592.2164C2421.0352,-8570.1484 2443.8978,-8594.0496 2474.269,-8568.2164 2495.2846,-8550.3408 2675.2442,-8143.9217 2682.1736,-8117.2164 2735.2369,-7912.7152 2690.6162,-7852.6848 2718.1736,-7643.2164 2738.4443,-7489.1356 2778.3994,-7306.0176 2792.2561,-7244.5329"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2795.7324,-7245.0286 2794.5291,-7234.5023 2788.9055,-7243.4815 2795.7324,-7245.0286"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge768" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M585.7192,-11955.2164C673.6858,-12139.0226 707.3404,-12278.2164 911.1119,-12278.2164 911.1119,-12278.2164 911.1119,-12278.2164 1059.5131,-12278.2164 1192.4128,-12278.2164 1249.6298,-12245.3078 1321.0291,-12133.2164 1382.6633,-12036.4551 1304.3956,-11720.1538 1357.0291,-11618.2164 1405.8779,-11523.6088 1450.6484,-11520.5761 1542.2007,-11466.2164 1772.0667,-11329.7321 1849.7241,-11326.1779 2111.5532,-11272.2164 2145.5846,-11265.2027 2159.4081,-11277.263 2188.4692,-11258.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2188.4692,-11258.2164C2209.7155,-11243.3913 2281.0471,-11070.2646 2301.3853,-11054.2164 2332.6861,-11029.5177 2360.2159,-11058.9807 2387.8271,-11030.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge800" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M585.7192,-10152.2164C637.5201,-10150.6889 717.6522,-9998.3675 745.334,-9942.4791"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="748.6122,-9943.7434 749.8738,-9933.2239 742.3276,-9940.6606 748.6122,-9943.7434"/>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M448.2149,-10153.0061C485.8579,-10153.4197 539.0807,-10153.5916 585.7192,-10152.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge807" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M399.392,-10141.1944C403.8105,-9982.7649 454.6615,-8147.6388 480.9653,-6666.2164 482.4419,-6583.0568 482.1646,-3747.7584 516.9653,-3672.2164 627.3965,-3432.5033 748.3154,-3401.5105 1002.4307,-3330.2164 1138.7659,-3291.9664 1209.4197,-3243.0744 1321.0291,-3330.2164 1373.0267,-3370.8149 1306.9921,-3431.2245 1357.0291,-3474.2164 1529.7772,-3622.6418 1710.1002,-3357.3395 1867.2231,-3522.2164 1927.6889,-3585.6661 1848.9999,-4241.3556 1903.2231,-4310.2164 1912.5402,-4322.0486 1927.1106,-4328.5092 1941.637,-4331.968"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1941.137,-4335.4363 1951.6216,-4333.9121 1942.4749,-4328.5654 1941.137,-4335.4363"/>
</g>
<!-- sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node34" class="node">
<title>sourcefile~nodeinputmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node34"><a xlink:href="../sourcefile/nodeinputmanager.f90.html" xlink:title="NodeInputManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1682.5461,-6614.2218 1563.875,-6614.2218 1563.875,-6592.2109 1682.5461,-6592.2109 1682.5461,-6614.2218"/>
<text text-anchor="middle" x="1623.2106" y="-6600.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">NodeInputManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge820" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1059.5131,-5890.2164C1089.1128,-5949.624 1099.775,-5964.0098 1116.5955,-6028.2164 1133.4997,-6092.7426 1109.2829,-6275.4876 1152.5955,-6326.2164 1177.8672,-6355.8153 1217.7342,-6316.2931 1236.8123,-6350.2164"/>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M399.3368,-10140.8815C404.6907,-9901.3029 493.4719,-5943.6003 516.9653,-5891.2164 601.6031,-5702.4976 663.5371,-5648.4787 855.7932,-5572.2164 901.5007,-5554.0855 928.935,-5540.4048 966.4307,-5572.2164 1041.3128,-5635.7468 969.5731,-5697.6754 1002.4307,-5790.2164 1019.5538,-5838.4423 1036.6909,-5844.4114 1059.5131,-5890.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge841" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M2188.4692,-12620.2164C2319.3479,-12365.818 2373.1555,-12014.9377 2385.1381,-11926.2346"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2388.608,-11926.6925 2386.4488,-11916.32 2381.6683,-11925.775 2388.608,-11926.6925"/>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M585.7192,-12183.2164C768.8306,-12579.7994 507.0525,-12865.1806 855.7932,-13128.2164 895.0508,-13157.8262 918.2094,-13137.8399 966.4307,-13128.2164 1038.5322,-13113.827 2154.8343,-12685.5951 2188.4692,-12620.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node37" class="node">
<title>sourcefile~fluidproperties.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node37"><a xlink:href="../sourcefile/fluidproperties.f90.html" xlink:title="FluidProperties.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1481.7421,-8526.2218 1381.4876,-8526.2218 1381.4876,-8504.2109 1481.7421,-8504.2109 1481.7421,-8526.2218"/>
<text text-anchor="middle" x="1431.6149" y="-8512.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FluidProperties.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge848" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M755.1332,-10152.2164C779.404,-10134.6636 799.6497,-10155.3841 819.7932,-10133.2164 876.7124,-10070.5772 834.4956,-10028.1302 855.7932,-9946.2164 961.7788,-9538.5794 975.7735,-9428.4922 1152.5955,-9046.2164 1182.7602,-8981.0025 1165.5288,-8899.1923 1236.8123,-8908.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge853" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M399.3744,-10141.1941C403.5442,-9982.7599 451.6323,-8147.5819 480.9653,-6666.2164 483.4227,-6542.1135 471.1447,-4547.5768 516.9653,-4432.2164 559.1794,-4325.9361 601.7081,-4314.3155 690.4731,-4242.2164 736.7643,-4204.6165 1095.5463,-3986.5949 1152.5955,-3969.2164 1304.6813,-3922.8873 1752.2886,-3825.3686 1867.2231,-3935.2164 1899.185,-3965.7636 1895.2676,-4686.7261 1903.2231,-4730.2164 1947.4897,-4972.2055 2010.183,-5019.0561 2075.5532,-5256.2164 2094.9218,-5326.4848 2073.0311,-5354.3388 2111.5532,-5416.2164 2134.7588,-5453.4912 2162.832,-5442.5702 2188.4692,-5478.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2188.4692,-5478.2164C2227.5869,-5535.5919 2241.3817,-5549.0553 2265.3853,-5614.2164 2294.4905,-5693.2269 2257.0204,-5728.6515 2301.3853,-5800.2164 2314.637,-5821.5928 2337.5015,-5838.5925 2356.3874,-5849.9828"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2354.8695,-5853.1479 2365.2795,-5855.1184 2358.3704,-5847.0862 2354.8695,-5853.1479"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge883" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M399.2505,-10140.9277C402.21,-9942.2907 444.4725,-7179.0081 516.9653,-6372.2164 532.2997,-6201.556 569.3061,-5997.8141 581.6412,-5932.4788"/>
<polygon fill="#ff0028" stroke="#ff0028" points="585.0971,-5933.0401 583.5254,-5922.5625 578.2202,-5931.7334 585.0971,-5933.0401"/>
</g>
<!-- sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node40" class="node">
<title>sourcefile~globalnames.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node40"><a xlink:href="../sourcefile/globalnames.f90.html" xlink:title="GlobalNames.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2235.0931,-8832.2218 2141.8454,-8832.2218 2141.8454,-8810.2109 2235.0931,-8810.2109 2235.0931,-8832.2218"/>
<text text-anchor="middle" x="2188.4692" y="-8818.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">GlobalNames.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-9238.2164C2017.41,-9200.2606 2050.2067,-9216.0085 2075.5532,-9176.2164 2121.7274,-9103.7263 2085.1927,-9068.0209 2111.5532,-8986.2164 2129.1346,-8931.6561 2160.4115,-8871.5847 2177.1529,-8841.1975"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2180.234,-8842.8586 2182.042,-8832.4192 2174.1185,-8839.4526 2180.234,-8842.8586"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-10152.2164C756.3032,-10147.1862 823.5443,-10295.5313 966.4307,-10202.2164 1105.4225,-10111.4448 1062.7741,-10017.2561 1116.5955,-9860.2164 1137.8439,-9798.2179 1115.0472,-9770.9326 1152.5955,-9717.2164 1364.5698,-9413.9672 1569.8824,-9510.4019 1867.2231,-9290.2164 1885.9195,-9276.3714 1882.6606,-9263.0983 1903.2231,-9252.2164 1937.5149,-9234.0687 1966.3444,-9269.4294 1989.3882,-9238.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.3788,-10141.1942C403.6102,-9982.7612 452.3831,-8147.5966 480.9653,-6666.2164 482.243,-6599.9989 491.3903,-4343.3089 516.9653,-4282.2164 663.7235,-3931.6475 792.7497,-3832.4763 1152.5955,-3710.2164 1229.7238,-3684.0115 1325.7169,-3698.6374 1382.6429,-3711.8043"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1381.9219,-3715.2305 1392.4616,-3714.1511 1383.5492,-3708.4223 1381.9219,-3715.2305"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge89" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-13798.2164C608.326,-13862.9038 634.1598,-13870.7725 654.4731,-13936.2164 688.5335,-14045.9491 618.4459,-14102.6985 690.4731,-14192.2164 728.9056,-14239.9815 769.662,-14204.9259 819.7932,-14240.2164 1079.5865,-14423.1011 1452.1896,-15200.1357 1740.2205,-15334.2164 1951.8234,-15432.7193 2032.7984,-15353.7607 2265.3853,-15334.2164 2267.2513,-15334.0596 2795.9218,-15245.6513 2797.125,-15244.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge144" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-4446.2164C604.3246,-4430.5411 1408.5955,-4227.0894 1431.6149,-4219.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.3714,-10141.194C403.4982,-9982.759 451.1081,-8147.5715 480.9653,-6666.2164 483.3614,-6547.3348 474.702,-4637.3576 516.9653,-4526.2164 533.629,-4482.3955 552.1756,-4478.9696 585.7192,-4446.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-4219.2164C1464.6245,-4199.8651 1481.1934,-4205.1775 1506.2007,-4176.2164 1532.6277,-4145.611 1512.148,-4117.3202 1541.634,-4087.1415"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1544.1663,-4089.57 1549.2234,-4080.26 1539.4643,-4084.3843 1544.1663,-4089.57"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge178" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-4370.2164C1269.6332,-4349.2987 1286.0101,-4363.1996 1321.0291,-4346.2164 1338.7874,-4337.6041 1339.4725,-4329.233 1357.0291,-4320.2164 1364.7965,-4316.2272 1373.3365,-4312.6712 1381.7787,-4309.5809"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1382.9301,-4312.8861 1391.2222,-4306.2914 1380.6274,-4306.2757 1382.9301,-4312.8861"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-4446.2164C639.3779,-4412.7093 793.3485,-4526.0856 855.7932,-4536.2164 904.3308,-4544.0909 919.8274,-4551.9021 966.4307,-4536.2164 1045.8463,-4509.4866 1050.1531,-4473.2726 1116.5955,-4422.2164 1132.668,-4409.8658 1134.5174,-4403.3842 1152.5955,-4394.2164 1187.307,-4376.6133 1203.9913,-4391.134 1236.8123,-4370.2164"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node53" class="node">
<title>sourcefile~dataruntimelanguage.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node53"><a xlink:href="../sourcefile/dataruntimelanguage.f90.html" xlink:title="DataRuntimeLanguage.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="654.2279,-3964.2218 517.2105,-3964.2218 517.2105,-3942.2109 654.2279,-3942.2109 654.2279,-3964.2218"/>
<text text-anchor="middle" x="585.7192" y="-3950.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRuntimeLanguage.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge180" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.3844,-10141.1943C403.696,-9982.7628 453.3592,-8147.6151 480.9653,-6666.2164 483.6693,-6521.1167 473.2844,-4192.6115 516.9653,-4054.2164 527.0873,-4022.1467 551.0411,-3991.0621 567.8128,-3972.0421"/>
<polygon fill="#0000ff" stroke="#0000ff" points="570.5938,-3974.1856 574.7186,-3964.4266 565.4084,-3969.4833 570.5938,-3974.1856"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node56" class="node">
<title>sourcefile~sqlitefortranroutines.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node56"><a xlink:href="../sourcefile/sqlitefortranroutines.f90.html" xlink:title="SQLiteFortranRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1305.21,-4610.2218 1168.4145,-4610.2218 1168.4145,-4588.2109 1305.21,-4588.2109 1305.21,-4610.2218"/>
<text text-anchor="middle" x="1236.8123" y="-4596.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SQLiteFortranRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge157" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.3441,-10141.0943C405.3476,-9884.5461 513.2521,-5275.5785 516.9653,-5268.2164 668.9612,-4966.8599 940.131,-5089.9294 1116.5955,-4802.2164 1160.8463,-4730.0685 1092.675,-4674.9909 1152.5955,-4615.2164 1154.7192,-4613.0978 1157.0306,-4611.2137 1159.4869,-4609.5402"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1161.2911,-4612.5418 1168.3347,-4604.6274 1157.893,-4606.4219 1161.2911,-4612.5418"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge217" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-10152.2164C779.725,-10135.1163 794.3492,-10149.0205 819.7932,-10133.2164 901.4539,-10082.4944 919.4727,-10058.0981 966.4307,-9974.2164 984.9882,-9941.0668 1139.9315,-9352.0339 1152.5955,-9316.2164 1216.0784,-9136.6677 1264.2274,-9103.9893 1321.0291,-8922.2164 1344.843,-8846.0087 1306.7075,-8808.204 1357.0291,-8746.2164 1512.7754,-8554.3633 1687.2837,-8694.5866 1867.2231,-8525.2164 1892.9858,-8500.9669 1874.6622,-8475.0976 1903.2231,-8454.2164 1934.543,-8431.3181 1959.8425,-8465.3624 1989.3882,-8440.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge208" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-10152.2164C623.3126,-10150.1974 724.8627,-10174.6001 755.1332,-10152.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-10152.2164C779.2167,-10134.4076 801.1433,-10156.6546 819.7932,-10133.2164 861.8609,-10080.348 845.6545,-9593.0143 855.7932,-9526.2164 896.5992,-9257.3701 888.2728,-9179.0187 1002.4307,-8932.2164 1174.6902,-8559.8018 1196.1053,-8403.634 1542.2007,-8183.2164 1543.5338,-8182.3673 1987.8341,-8098.5044 1989.3882,-8098.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge266" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M585.7192,-2271.2164C659.4231,-2021.5884 817.3147,-2039.5491 966.4307,-1826.2164 985.1277,-1799.4674 980.7332,-1786.5948 1002.4307,-1762.2164 1044.1374,-1715.3562 1084.6944,-1733.2316 1116.5955,-1679.2164 1181.9694,-1568.5246 1065.7423,-1486.9947 1152.5955,-1392.2164 1259.5918,-1275.4568 1348.1942,-1337.4939 1506.2007,-1348.2164 1669.2684,-1359.2823 1759.2359,-1295.5286 1867.2231,-1418.2164 1907.7984,-1464.3152 1884.1214,-1633.8504 1903.2231,-1692.2164 1952.7383,-1843.5115 2023.8183,-1855.6659 2075.5532,-2006.2164 2108.1799,-2101.1612 2043.5376,-2155.3727 2111.5532,-2229.2164 2135.4091,-2255.1164 2157.9726,-2230.6133 2188.4692,-2248.2164"/>
</g>
<!-- sourcefile~rootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node65" class="node">
<title>sourcefile~rootfinder.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node65"><a xlink:href="../sourcefile/rootfinder.f90.html" xlink:title="RootFinder.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="951.4926,-1228.2218 870.7312,-1228.2218 870.7312,-1206.2109 951.4926,-1206.2109 951.4926,-1228.2218"/>
<text text-anchor="middle" x="911.1119" y="-1214.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">RootFinder.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge289" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.4099,-10141.1947C404.0821,-9982.7695 457.7518,-8147.6905 480.9653,-6666.2164 482.9608,-6538.867 473.4897,-2200.9315 516.9653,-2081.2164 549.7842,-1990.8457 606.905,-1997.7699 654.4731,-1914.2164 784.9134,-1685.098 762.2987,-1602.7294 855.7932,-1356.2164 871.8115,-1313.9816 891.5963,-1264.9802 902.6373,-1237.8982"/>
<polygon fill="#00ffff" stroke="#00ffff" points="906.0006,-1238.9201 906.5427,-1228.3392 899.5206,-1236.2726 906.0006,-1238.9201"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge589" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3525.3633,-16080.2164C3717.4569,-15842.4664 3579.9665,-15011.7536 3588.4519,-14706.2164 3632.1759,-13131.8262 3657.4964,-7759.3815 3659.2452,-7378.5437"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3662.7452,-7378.5477 3659.291,-7368.5317 3655.7452,-7378.5156 3662.7452,-7378.5477"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M911.1119,-15509.2164C970.192,-15526.0917 1077.9408,-15646.456 1116.5955,-15694.2164 1251.1839,-15860.5093 1249.9021,-15926.0376 1357.0291,-16111.2164 1423.1625,-16225.5342 1441.425,-16253.1237 1506.2007,-16368.2164 1522.5888,-16397.3346 1515.4424,-16414.2055 1542.2007,-16434.2164 1734.0532,-16577.691 1838.5786,-16547.3645 2075.5532,-16512.2164 2635.9743,-16429.0947 2750.7614,-16298.2029 3295.4165,-16142.2164 3397.1738,-16113.0736 3458.8413,-16162.5491 3525.3633,-16080.2164"/>
</g>
<!-- sourcefile~faultsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node68" class="node">
<title>sourcefile~faultsmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node68"><a xlink:href="../sourcefile/faultsmanager.f90.html" xlink:title="FaultsManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1286.2859,-15558.2218 1187.3386,-15558.2218 1187.3386,-15536.2109 1286.2859,-15536.2109 1286.2859,-15558.2218"/>
<text text-anchor="middle" x="1236.8123" y="-15544.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">FaultsManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~faultsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge293" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~faultsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.9042,-10163.3065C414.3342,-10212.8121 464.3442,-10418.7366 480.9653,-10591.2164 530.5474,-11105.7373 439.562,-14732.1402 516.9653,-15243.2164 532.8143,-15347.8634 522.4561,-15386.3638 585.7192,-15471.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-15547.2164C1098.5312,-15545.5542 1142.4232,-15545.5396 1176.7742,-15545.9477"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1177.0665,-15549.4519 1187.1126,-15546.0866 1177.1606,-15542.4525 1177.0665,-15549.4519"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-15471.2164C607.4766,-15500.3987 876.9956,-15496.5252 911.1119,-15509.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-15509.2164C976.5777,-15527.9157 991.4907,-15550.1141 1059.5131,-15547.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge308" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M399.4078,-10141.1947C404.0512,-9982.769 457.4008,-8147.6849 480.9653,-6666.2164 482.8757,-6546.1163 471.4293,-2453.3656 516.9653,-2342.2164 533.6178,-2301.5692 573.6126,-2313.4411 585.7192,-2271.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-1524.2164C3025.3298,-1528.5048 3146.0424,-1492.6355 3174.6229,-1524.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M585.7192,-2271.2164C607.2767,-2196.0298 626.9063,-2182.4135 654.4731,-2109.2164 672.4543,-2061.4718 667.4862,-2045.7626 690.4731,-2000.2164 786.1444,-1810.6539 869.4114,-1799.0925 966.4307,-1610.2164 988.7797,-1566.7076 980.1232,-1549.7465 1002.4307,-1506.2164 1042.6018,-1427.8275 1084.9189,-1426.406 1116.5955,-1344.2164 1163.9373,-1221.381 1082.5309,-1161.6647 1152.5955,-1050.2164 1199.9251,-974.9314 1262.9463,-1009.5538 1321.0291,-942.2164 1346.4953,-912.6924 1326.5937,-886.5862 1357.0291,-862.2164 1606.3628,-662.5723 1872.4519,-600.6906 2075.5532,-847.2164 2130.7544,-914.2199 2059.313,-1166.8795 2111.5532,-1236.2164 2172.9156,-1317.6608 2881.4979,-1513.9493 2982.9529,-1524.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge343" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M401.8899,-10163.3079C414.2589,-10212.8194 464.0478,-10418.7654 480.9653,-10591.2164 498.4371,-10769.317 454.3444,-13644.5747 516.9653,-13812.2164 550.0124,-13900.6861 615.8126,-13888.0517 654.4731,-13974.2164 701.508,-14079.0453 653.5989,-14121.3969 690.4731,-14230.2164 824.6061,-14626.0553 879.611,-14732.7364 1152.5955,-15049.2164 1214.5377,-15121.028 1265.2133,-15103.546 1321.0291,-15180.2164 1348.5845,-15218.0674 1340.7583,-15235.3158 1357.0291,-15279.2164 1422.2448,-15455.177 1444.7733,-15496.8977 1506.2007,-15674.2164 1523.5931,-15724.4221 1501.3061,-15754.2938 1542.2007,-15788.2164 1578.6211,-15818.4275 2340.5074,-15890.2164 2387.8271,-15890.2164 2387.8271,-15890.2164 2387.8271,-15890.2164 2596.2213,-15890.2164 2721.0579,-15890.2164 2780.7233,-15946.7891 2876.0764,-15866.2164 3116.9772,-15662.6569 3008.2482,-15491.2933 3053.8293,-15179.2164 3078.8503,-15007.9069 3165.5598,-12200.3515 3173.9663,-11926.638"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3177.4712,-11926.5298 3174.2796,-11916.4271 3170.4744,-11926.315 3177.4712,-11926.5298"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge454" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M399.3952,-10141.1945C403.8597,-9982.7658 455.2218,-8147.6487 480.9653,-6666.2164 482.5074,-6577.4741 475.9183,-3549.9101 516.9653,-3471.2164 896.3165,-2743.9387 1448.4502,-2806.3427 2265.3853,-2880.2164 2452.9138,-2897.1742 2514.5985,-2870.3495 2682.1736,-2956.2164 2983.1242,-3110.426 3050.959,-3221.4798 3174.6229,-3536.2164"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M3174.6229,-3536.2164C3299.8012,-3807.8398 3204.1188,-3913.4118 3295.4165,-4198.2164 3309.5668,-4242.3585 3334.6601,-4290.6297 3349.3162,-4317.0785"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3346.4299,-4319.0869 3354.3778,-4326.0927 3352.5335,-4315.6596 3346.4299,-4319.0869"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge495" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M585.7192,-13513.2164C680.8837,-13625.5575 1756.3051,-13947.0357 1867.2231,-13850.2164 1911.8295,-13811.2799 1874.3032,-13637.8828 1903.2231,-13586.2164 1951.559,-13499.8627 2021.2673,-13527.9591 2075.5532,-13445.2164 2107.7362,-13396.163 2091.4661,-13373.3388 2111.5532,-13318.2164 2168.618,-13161.6212 2224.4596,-13137.7822 2265.3853,-12976.2164 2278.763,-12923.404 2264.575,-12527.38 2301.3853,-12487.2164 2327.6814,-12458.5246 2375.7231,-12510.2055 2387.8271,-12473.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge522" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M755.1332,-13760.2164C795.653,-13794.265 792.5872,-13814.8181 819.7932,-13860.2164 836.7687,-13888.5431 833.0665,-13901.2567 855.7932,-13925.2164 949.8615,-14024.3878 1003.0302,-14012.1457 1116.5955,-14088.2164 1309.9419,-14217.7276 1339.5143,-14278.8737 1542.2007,-14393.2164 1625.6168,-14440.2744 1646.4077,-14458.9326 1740.2205,-14478.2164 1887.8189,-14508.5562 1936.3006,-14485.788 2075.5532,-14428.2164 2166.9269,-14390.4395 2188.9855,-14374.9804 2265.3853,-14312.2164 2371.3238,-14225.1856 2396.9739,-14198.4541 2474.269,-14085.2164 2489.1159,-14063.4657 2674.7813,-13684.4923 2682.1736,-13659.2164 2696.3871,-13610.6167 2779.917,-12826.568 2794.843,-12685.7791"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2798.363,-12685.7743 2795.9361,-12675.4611 2791.402,-12685.0367 2798.363,-12685.7743"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge556" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M585.7192,-13798.2164C643.4669,-13972.3064 1018.6822,-14275.1192 1116.5955,-14430.2164 1137.193,-14462.8435 1132.3725,-14476.3558 1152.5955,-14509.2164 1228.7277,-14632.9247 1250.0099,-14665.9983 1357.0291,-14764.2164 1430.002,-14831.1882 1450.572,-14850.6069 1542.2007,-14888.2164 1651.6746,-14933.1505 1692.2616,-14898.4642 1803.7218,-14938.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge564" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M755.1332,-6766.2164C881.9286,-6838.9212 900.0573,-6887.9948 966.4307,-7018.2164 996.3882,-7076.9917 964.411,-7108.3044 1002.4307,-7162.2164 1037.5601,-7212.03 1076.7284,-7192.1067 1116.5955,-7238.2164 1141.0407,-7266.4894 1121.0126,-7294.2298 1152.5955,-7314.2164 1365.8373,-7449.1625 1693.3677,-7071.3916 1740.2205,-7058.2164 1794.5586,-7042.9363 1810.7935,-7056.8707 1867.2231,-7058.2164 2044.3351,-7062.4398 2088.6908,-7064.3501 2265.3853,-7077.2164 2319.9202,-7081.1874 2333.2075,-7086.6618 2387.8271,-7089.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M399.6613,-10141.1454C410.4592,-9934.9657 570.4686,-6916.5218 690.4731,-6780.2164 709.9031,-6758.1471 729.2023,-6752.354 755.1332,-6766.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2387.8271,-7089.2164C2440.1538,-7085.6629 2498.9122,-7074.5702 2540.6642,-7065.4498"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2541.6269,-7068.8214 2550.6319,-7063.2394 2540.1113,-7061.9875 2541.6269,-7068.8214"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge416" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-3198.2164C2996.0334,-3250.7185 3144.9765,-3988.7504 3170.6813,-4124.0074"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3167.2647,-4124.7776 3172.5554,-4133.9569 3174.1438,-4123.4818 3167.2647,-4124.7776"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-2970.2164C2636.6773,-2997.8402 2648.4191,-3003.7143 2682.1736,-3039.2164 2742.2586,-3102.4121 2733.3512,-3138.7452 2797.125,-3198.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.4042,-10141.1946C403.9969,-9982.7681 456.7825,-8147.675 480.9653,-6666.2164 481.8562,-6611.638 481.9674,-2778.1059 516.9653,-2736.2164 739.2306,-2470.1834 1747.4773,-2558.227 2075.5532,-2670.2164 2328.3054,-2756.4938 2375.6612,-2819.6152 2596.2213,-2970.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge388" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.4036,-10141.1946C403.9873,-9982.7679 456.6738,-8147.6732 480.9653,-6666.2164 481.8461,-6612.499 482.0581,-2839.0553 516.9653,-2798.2164 615.0452,-2683.47 1724.2588,-2599.7648 1867.2231,-2648.2164 1877.8678,-2651.8239 2180.6969,-2886.0977 2188.4692,-2894.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge376" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2812.2164C679.6033,-2704.0384 1767.3815,-2849.5113 1867.2231,-2952.2164 1936.5323,-3023.5133 1847.5533,-3315.8278 1903.2231,-3398.2164 1951.1473,-3469.1418 2006.1038,-3434.1772 2075.5532,-3484.2164 2172.4023,-3553.9974 2182.1047,-3588.6975 2265.3853,-3674.2164 2303.2909,-3713.1408 2346.9337,-3759.5001 2370.5194,-3784.6849"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2368.0517,-3787.1704 2377.4396,-3792.0815 2373.1634,-3782.388 2368.0517,-3787.1704"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.3988,-10141.1945C403.9139,-9982.7667 455.8386,-8147.6593 480.9653,-6666.2164 487.4665,-6282.9173 482.7005,-3598.0362 516.9653,-3216.2164 533.2451,-3034.8082 451.4303,-2935.2628 585.7192,-2812.2164"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge486" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M401.843,-10163.3126C414.013,-10212.8442 463.0792,-10418.8631 480.9653,-10591.2164 497.7324,-10752.7863 467.7173,-13401.5852 585.7192,-13513.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-13513.2164C630.8602,-13555.9202 1647.1925,-13532.8971 1704.2205,-13508.2164 1725.5712,-13498.9761 1719.9702,-13481.669 1740.2205,-13470.2164 1765.3766,-13455.9892 1775.0523,-13459.8638 1803.7218,-13456.2164"/>
</g>
<!-- sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node82" class="node">
<title>sourcefile~vectorutilities.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node82"><a xlink:href="../sourcefile/vectorutilities.f90.html" xlink:title="VectorUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="957.7358,-15272.2218 864.4881,-15272.2218 864.4881,-15250.2109 957.7358,-15250.2109 957.7358,-15272.2218"/>
<text text-anchor="middle" x="911.1119" y="-15258.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">VectorUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge467" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.8925,-10163.3076C414.2725,-10212.8181 464.1015,-10418.7601 480.9653,-10591.2164 499.4089,-10779.8273 477.1524,-13816.935 516.9653,-14002.2164 548.9716,-14151.1672 620.2185,-14167.7665 654.4731,-14316.2164 698.5786,-14507.3569 609.8421,-15019.3906 690.4731,-15198.2164 706.8384,-15234.5117 723.002,-15236.7056 755.1332,-15260.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-15260.2164C786.0379,-15283.6351 831.1683,-15281.1692 864.9423,-15274.4482"/>
<polygon fill="#ff0000" stroke="#ff0000" points="866.0056,-15277.7987 875.031,-15272.2497 864.5151,-15270.9592 866.0056,-15277.7987"/>
</g>
<!-- sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge762" class="edge">
<title>sourcefile~datainterfaces.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.7165,-10163.3267C413.3483,-10212.9183 460.4614,-10419.1549 480.9653,-10591.2164 552.9102,-11194.9522 394.6152,-11378.023 585.7192,-11955.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-11955.2164C695.6605,-12287.2731 914.2994,-11659.5671 1116.5955,-11374.2164 1136.1459,-11346.6393 1125.6809,-11327.6693 1152.5955,-11307.2164 1183.1457,-11284.0006 1218.0054,-11321.6617 1236.8123,-11288.2164"/>
</g>
<!-- sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node12" class="node">
<title>sourcefile~datazonecontrols.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node12"><a xlink:href="../sourcefile/datazonecontrols.f90.html" xlink:title="DataZoneControls.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2245.6932,-1194.2218 2131.2453,-1194.2218 2131.2453,-1172.2109 2245.6932,-1172.2109 2245.6932,-1194.2218"/>
<text text-anchor="middle" x="2188.4692" y="-1180.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneControls.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge894" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.7686,-1171.98C2207.7556,-1117.8244 2277.3741,-885.4019 2301.3853,-862.2164 2506.4049,-664.2462 3259.2275,-581.1819 3525.3633,-479.2164"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge193" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M2189.5849,-1194.3696C2197.6065,-1275.1023 2246.7004,-1778.4471 2265.3853,-2189.2164 2268.497,-2257.6252 2269.8966,-4593.4059 2301.3853,-4654.2164 2312.2458,-4675.1901 2333.6517,-4690.8739 2352.4438,-4701.3471"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2350.9232,-4704.502 2361.4014,-4706.0702 2354.1882,-4698.31 2350.9232,-4704.502"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge265" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2191.531,-1194.3867C2223.1154,-1309.5448 2488.8546,-2276.7575 2510.269,-2298.2164 2516.2655,-2304.2253 2523.6164,-2308.8081 2531.4706,-2312.2999"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2530.2813,-2315.5923 2540.8711,-2315.9177 2532.7956,-2309.0594 2530.2813,-2315.5923"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge590" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2230.5329,-1194.2855C2242.1212,-1198.0264 2254.4933,-1202.6854 2265.3853,-1208.2164 2282.9829,-1217.1525 2283.3023,-1226.3082 2301.3853,-1234.2164 2352.8689,-1256.7316 2741.0062,-1337.0778 2797.125,-1334.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2797.125,-1334.2164C2848.5752,-1335.5339 2860.7039,-1323.3332 2912.0764,-1320.2164 2974.9621,-1316.401 2992.4911,-1305.8365 3053.8293,-1320.2164 3153.1367,-1343.4976 3188.3139,-1349.0837 3259.4165,-1422.2164 3286.0318,-1449.5916 3266.2357,-1475.594 3295.4165,-1500.2164 3376.3139,-1568.4766 3449.6572,-1488.2404 3525.3633,-1562.2164"/>
</g>
<!-- sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge309" class="edge">
<title>sourcefile~datazonecontrols.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2797.125,-1334.2164C2879.608,-1330.0106 2906.7794,-1302.2987 2982.9529,-1334.2164"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge895" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3174.6229,-11828.2164C3213.7461,-11826.3754 3234.4129,-11822.0695 3259.4165,-11852.2164 3403.7077,-12026.1886 3510.3748,-15709.0941 3624.4519,-15904.2164 3633.9513,-15920.4645 3653.2155,-15910.4202 3659.3423,-15928.2164"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge591" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-11828.2164C3259.0008,-11824.2459 3278.0057,-11773.6957 3360.8456,-11790.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3021.0856,-11855.1726C3059.4715,-11844.8849 3120.5744,-11830.7597 3174.6229,-11828.2164"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge310" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2983.8708,-11855.0925C2988.8913,-11797.3437 3015.5727,-11526.4451 3089.8293,-11319.2164 3143.3326,-11169.9043 3217.0649,-11158.0661 3259.4165,-11005.2164 3477.5883,-10217.819 3403.1358,-8148.9527 3426.2747,-7332.2164 3428.7921,-7243.3575 3427.766,-4214.1394 3462.2747,-4132.2164 3470.0373,-4113.7879 3486.0315,-4097.9152 3499.9724,-4086.7119"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3502.4703,-4089.2084 3508.2953,-4080.3585 3498.2229,-4083.6442 3502.4703,-4089.2084"/>
</g>
<!-- sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge344" class="edge">
<title>sourcefile~hvacheatingcoils.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M3037.1093,-11877.2358C3059.8722,-11881.8675 3086.5312,-11887.2919 3110.2855,-11892.1253"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3109.7711,-11895.5923 3120.2682,-11894.1566 3111.1669,-11888.7329 3109.7711,-11895.5923"/>
</g>
<!-- sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge896" class="edge">
<title>sourcefile~hvaccontrollers.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3838.935,-7128.2164C3847.3433,-7128.2164 3856.0593,-7128.2164 3864.5552,-7128.2164"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3864.7736,-7131.7165 3874.7736,-7128.2164 3864.7736,-7124.7165 3864.7736,-7131.7165"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge897" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3360.8456,-7242.2164C3432.4146,-7257.1917 3457.0418,-7216.1673 3525.3633,-7242.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-6823.2164C2830.8358,-6834.7736 2844.1305,-6821.4225 2876.0764,-6837.2164 3083.4247,-6939.7279 3095.6455,-7025.8731 3259.4165,-7189.2164 3276.1183,-7205.8745 3274.923,-7216.5346 3295.4165,-7228.2164 3321.2518,-7242.9431 3331.7381,-7236.1258 3360.8456,-7242.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge35" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.6931,-6833.5195C2201.4728,-6888.9034 2248.4579,-7137.2751 2265.3853,-7343.2164 2302.9462,-7800.1895 2231.4611,-8953.0653 2301.3853,-9406.2164 2317.4877,-9510.5699 2361.3299,-9629.8179 2379.6307,-9676.7334"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2376.3989,-9678.0788 2383.3217,-9686.0991 2382.9114,-9675.5122 2376.3989,-9678.0788"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge59" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M2197.8122,-6833.383C2214.6533,-6854.2222 2249.7963,-6901.1124 2265.3853,-6947.2164 2316.4656,-7098.2856 2242.3963,-7156.0563 2301.3853,-7304.2164 2347.9038,-7421.0551 2433.1211,-7409.3798 2474.269,-7528.2164 2544.1651,-7730.0783 2459.7522,-11165.6549 2510.269,-11373.2164 2524.5151,-11431.75 2562.0053,-11493.0558 2582.4483,-11523.553"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2579.676,-11525.7001 2588.2007,-11531.9914 2585.4599,-11521.7572 2579.676,-11525.7001"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge242" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2596.2213,-6861.2164C2631.6324,-6879.0811 2646.7863,-6867.3046 2682.1736,-6885.2164 2779.8726,-6934.6682 2827.7161,-6938.9725 2876.0764,-7037.2164 2925.6894,-7138.0049 2906.521,-10969.016 2912.0764,-11081.2164 2927.1321,-11385.2895 2969.5516,-11753.7451 2980.4006,-11845.01"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2976.9531,-11845.6581 2981.6148,-11855.1722 2983.9037,-11844.8276 2976.9531,-11845.6581"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2387.8271,-6785.2164C2484.2816,-6764.8233 2509.4551,-6814.4087 2596.2213,-6861.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge634" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2249.5985,-6811.1599C2289.0755,-6803.9483 2341.5266,-6794.2335 2387.8271,-6785.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2387.8271,-6785.2164C2933.2113,-6679.0015 2890.4011,-6258.2688 3053.8293,-5727.2164 3090.604,-5607.719 3069.8585,-5571.6391 3089.8293,-5448.2164 3152.7546,-5059.3302 3218.9905,-4970.0809 3259.4165,-4578.2164 3275.1014,-4426.1769 3253.7589,-1974.2765 3295.4165,-1827.2164 3334.7949,-1688.2023 3363.848,-1653.9887 3462.2747,-1548.2164 3498.695,-1509.078 3639.3748,-1360.6225 3659.3423,-1410.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge734" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2596.2213,-6937.2164C2627.698,-6961.3475 2653.2865,-6934.0386 2682.1736,-6961.2164 2717.7983,-6994.7332 2699.2015,-7020.1325 2718.1736,-7065.2164 2739.5455,-7116.003 2769.8123,-7173.3367 2785.958,-7203.0057"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2782.9866,-7204.8666 2790.8589,-7211.9573 2789.1266,-7201.505 2782.9866,-7204.8666"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2387.8271,-6785.2164C2425.9046,-6777.1658 2444.8238,-6773.7667 2474.269,-6799.2164 2514.468,-6833.9605 2472.0727,-6876.2819 2510.269,-6913.2164 2538.7815,-6940.7869 2564.7446,-6913.0852 2596.2213,-6937.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge769" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2213.5645,-6833.3689C2267.2831,-6856.998 2397.6847,-6913.0589 2510.269,-6951.2164 2585.396,-6976.6786 2633.7033,-6936.423 2682.1736,-6999.2164 2757.4431,-7096.7281 2663.8437,-9105.6619 2718.1736,-9216.2164 2728.1187,-9236.4534 2747.9921,-9252.2553 2765.311,-9262.9718"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2763.6723,-9266.0682 2774.0687,-9268.1088 2767.214,-9260.0303 2763.6723,-9266.0682"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge832" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M2189.4239,-6833.2676C2196.973,-6921.2206 2247.2182,-7517.0317 2265.3853,-8002.2164 2273.052,-8206.9715 2261.4779,-11489.2416 2301.3853,-11690.2164 2316.3462,-11765.5601 2357.0768,-11848.1163 2376.8139,-11885.2131"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2373.742,-11886.8907 2381.5688,-11894.0316 2379.9034,-11883.5684 2373.742,-11886.8907"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge854" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2200.5186,-6811.1982C2218.4011,-6793.992 2251.36,-6758.7982 2265.3853,-6721.2164 2309.4507,-6603.1389 2279.1842,-6279.2775 2301.3853,-6155.2164 2319.8288,-6052.1521 2362.1862,-5933.8044 2379.8569,-5886.9042"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2383.2314,-5887.877 2383.5139,-5877.2859 2376.6884,-5885.3892 2383.2314,-5887.877"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge80" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-6861.2164C2631.1281,-6880.0475 2653.0764,-6858.2636 2682.1736,-6885.2164 2716.521,-6917.0324 2691.4319,-6945.7862 2718.1736,-6984.2164 2744.46,-7021.9922 2791.4198,-7005.5497 2797.125,-7051.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge592" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3360.8456,-7280.2164C3428.0354,-7309.0593 3457.307,-7253.4819 3525.3633,-7280.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2797.125,-6823.2164C2831.477,-6832.6994 2844.1305,-6821.4225 2876.0764,-6837.2164 3083.4247,-6939.7279 3117.5043,-7006.5613 3259.4165,-7189.2164 3280.1563,-7215.9105 3269.8837,-7234.0626 3295.4165,-7256.2164 3318.8118,-7276.5156 3332.3831,-7267.9981 3360.8456,-7280.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge311" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2797.125,-6823.2164C2938.3179,-6864.0741 3253.4272,-6577.5462 3360.8456,-6477.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2387.8271,-6785.2164C2566.5683,-6747.4257 2624.4632,-6763.5133 2797.125,-6823.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge496" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2197.6739,-6833.431C2214.2903,-6854.3481 2249.0816,-6901.3603 2265.3853,-6947.2164 2306.2357,-7062.1136 2242.3184,-7112.5335 2301.3853,-7219.2164 2349.6857,-7306.4536 2431.3996,-7272.1859 2474.269,-7362.2164 2521.6333,-7461.6866 2443.7343,-11240.4051 2510.269,-11328.2164 2512.6124,-11331.3091 2515.3164,-11334.0364 2518.2882,-11336.4401"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.4586,-11339.4271 2526.717,-11342.0758 2520.3494,-11333.6079 2516.4586,-11339.4271"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge523" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2198.6012,-6833.3983C2217.1709,-6853.2805 2258.6887,-6894.9658 2301.3853,-6919.2164 2386.5226,-6967.5721 2416.286,-6961.7601 2510.269,-6989.2164 2585.8651,-7011.3011 2633.4819,-6970.3162 2682.1736,-7032.2164 2724.1391,-7085.5658 2714.3424,-11851.4477 2718.1736,-11919.2164 2734.4199,-12206.5901 2781.5765,-12553.8441 2794.062,-12642.703"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2790.634,-12643.4595 2795.4984,-12652.8716 2797.5652,-12642.4804 2790.634,-12643.4595"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge417" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-6397.2164C2409.9955,-6364.0753 2438.3849,-6390.5973 2474.269,-6373.2164 2577.2845,-6323.3195 2606.0431,-6306.6917 2682.1736,-6221.2164 2876.3568,-6003.1975 2899.1045,-5916.8747 2982.9529,-5637.2164"/>
</g>
<!-- sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge389" class="edge">
<title>sourcefile~reportsizingmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2244.6953,-6811.0838C2252.3621,-6807.6371 2259.578,-6803.1244 2265.3853,-6797.2164 2395.7145,-6664.6245 2290.3984,-6555.564 2387.8271,-6397.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-6397.2164C2412.603,-6356.9491 2449.3105,-6375.3707 2474.269,-6335.2164 2526.1093,-6251.8135 2468.7233,-6206.1962 2510.269,-6117.2164 2559.8574,-6011.0114 2628.9568,-6021.6504 2682.1736,-5917.2164 2713.694,-5855.3599 2679.6051,-5822.9418 2718.1736,-5765.2164 2766.2603,-5693.245 2833.042,-5726.318 2876.0764,-5651.2164 2917.9183,-5578.196 2896.6215,-5356.944 2912.0764,-5274.2164 2928.3875,-5186.9055 2961.1023,-5086.0346 2975.6682,-5043.1945"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2979.0264,-5044.1915 2978.9594,-5033.5969 2972.4048,-5041.9209 2979.0264,-5044.1915"/>
</g>
<!-- sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node16" class="node">
<title>sourcefile~dataloopnode.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node16"><a xlink:href="../sourcefile/dataloopnode.f90.html" xlink:title="DataLoopNode.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1286.9652,-5942.2218 1186.6593,-5942.2218 1186.6593,-5920.2109 1286.9652,-5920.2109 1286.9652,-5942.2218"/>
<text text-anchor="middle" x="1236.8123" y="-5928.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataLoopNode.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge898" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-306.2164C2968.8663,-272.5738 3008.3732,-139.5545 3174.6229,-194.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1262.2064,-5920.1179C1282.2204,-5909.8455 1308.7323,-5892.4852 1321.0291,-5868.2164 1368.9285,-5773.682 1338.0708,-2157.4838 1357.0291,-2053.2164 1483.5763,-1357.227 1532.967,-1160.9815 1903.2231,-558.2164 1974.2136,-442.6461 1990.9468,-397.2666 2111.5532,-335.2164 2187.2239,-296.2849 2216.4924,-316.1264 2301.3853,-310.2164 2411.2872,-302.5653 2687.855,-320.2538 2797.125,-306.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge37" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1238.1016,-5942.5927C1245.408,-6005.4581 1283.9019,-6316.3469 1357.0291,-6560.2164 1406.6565,-6725.7174 1456.9406,-6753.6057 1506.2007,-6919.2164 1531.0778,-7002.8522 1525.7436,-7026.5251 1542.2007,-7112.2164 1612.2654,-7477.0396 1640.5097,-7566.2301 1704.2205,-7932.2164 1805.9711,-8516.7223 1624.6288,-8728.3981 1903.2231,-9252.2164 2016.8148,-9465.7936 2274.1204,-9630.5484 2359.6162,-9681.0903"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2357.865,-9684.1208 2368.2623,-9686.1571 2361.4042,-9678.0814 2357.865,-9684.1208"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge60" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1431.6149,-11974.2164C1465.1532,-12027.9828 1485.4794,-11912.4713 1542.2007,-11884.2164 1628.8091,-11841.0736 2299.7453,-11716.2652 2387.8271,-11676.2164"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1237.7883,-5942.3039C1245.8471,-6034.4247 1301.5739,-6682.6238 1321.0291,-7210.2164 1330.2808,-7461.1094 1319.0782,-11481.0378 1357.0291,-11729.2164 1374.2346,-11841.7314 1371.3737,-11877.6417 1431.6149,-11974.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge93" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1623.2106,-5818.2164C1677.212,-5780.9564 1681.9284,-5758.3243 1740.2205,-5728.2164 1893.6078,-5648.9916 1940.8253,-5639.8333 2111.5532,-5614.2164 2179.1661,-5604.0714 2210.1885,-5573.871 2265.3853,-5614.2164 2307.9389,-5645.3204 2269.9843,-5684.8814 2301.3853,-5727.2164 2356.9558,-5802.1371 2406.6318,-5781.9793 2474.269,-5846.2164 2584.3431,-5950.7568 2608.7748,-5984.3344 2682.1736,-6117.2164 2697.9292,-6145.7406 3066.0152,-7194.9732 3089.8293,-7217.2164 3093.7252,-7220.8552 3098.1248,-7223.9668 3102.8198,-7226.6273"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3101.6385,-7229.9461 3112.1579,-7231.2075 3104.7211,-7223.6614 3101.6385,-7229.9461"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge108" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1261.5475,-5920.1903C1281.4505,-5909.8634 1308.1506,-5892.3886 1321.0291,-5868.2164 1395.5213,-5728.398 1309.4258,-5307.3196 1357.0291,-5156.2164 1394.5402,-5037.1477 1466.885,-5036.7014 1506.2007,-4918.2164 1568.5518,-4730.3101 1459.0961,-4653.9107 1542.2007,-4474.2164 1584.9447,-4381.7923 1659.5936,-4403.7462 1704.2205,-4312.2164 1761.9128,-4193.889 1682.2973,-4136.431 1740.2205,-4018.2164 1749.1045,-4000.085 1765.3439,-3984.1206 1779.1759,-3972.7987"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1781.6712,-3975.2904 1787.3899,-3966.3714 1777.3575,-3969.7775 1781.6712,-3975.2904"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge121" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M1623.2106,-5894.2164C1734.505,-5882.6289 1768.7112,-5903.1492 1867.2231,-5956.2164 1881.0139,-5963.6453 2067.2287,-6132.9469 2075.5532,-6146.2164 2105.3701,-6193.7453 2072.3798,-6227.048 2111.5532,-6267.2164 2118.0326,-6273.8603 2126.2932,-6278.74 2134.9835,-6282.3236"/>
<polygon fill="#fff100" stroke="#fff100" points="2133.9233,-6285.6614 2144.5179,-6285.7256 2136.2758,-6279.0685 2133.9233,-6285.6614"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge185" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1253.2231,-5920.0866C1270.6331,-5908.0204 1298.6585,-5887.8473 1321.0291,-5868.2164 1409.6574,-5790.4416 1429.5153,-5767.789 1506.2007,-5678.2164 1601.5881,-5566.7987 1644.3502,-5548.1126 1704.2205,-5414.2164 1737.5225,-5339.7384 1695.6572,-5302.5546 1740.2205,-5234.2164 1896.0375,-4995.2694 2101.4356,-5098.6583 2265.3853,-4865.2164 2300.3344,-4815.4536 2256.6349,-4774.389 2301.3853,-4733.2164 2309.5545,-4725.7002 2320.0596,-4721.1635 2330.9137,-4718.5198"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2331.7648,-4721.9203 2340.9229,-4716.593 2330.4416,-4715.0465 2331.7648,-4721.9203"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge244" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1623.2106,-12050.2164C1725.4988,-12132.3241 1781.934,-12116.5653 1867.2231,-12216.2164 1891.5262,-12244.6118 1876.44,-12266.1472 1903.2231,-12292.2164 1963.2083,-12350.6024 2025.229,-12301.3238 2075.5532,-12368.2164 2147.2744,-12463.5504 2031.8561,-12545.4422 2111.5532,-12634.2164 2158.5998,-12686.6213 2210.1401,-12628.5398 2265.3853,-12672.2164 2292.8289,-12693.9132 2281.3266,-12713.5536 2301.3853,-12742.2164 2366.2826,-12834.9512 2404.4376,-12840.1378 2474.269,-12929.2164 2554.6056,-13031.6954 2692.1498,-13495.2625 2797.125,-13418.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1431.6149,-11974.2164C1449.9136,-12002.5491 1476.585,-11972.0764 1506.2007,-11988.2164 1526.6285,-11999.3491 1522.3699,-12014.052 1542.2007,-12026.2164 1574.2097,-12045.851 1593.689,-12027.0092 1623.2106,-12050.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2797.125,-13418.2164C2920.5491,-13310.1444 2863.5782,-12847.7916 2876.0764,-12684.2164 2882.7961,-12596.2709 2859.5067,-11962.04 2912.0764,-11891.2164 2914.5006,-11887.9504 2917.3853,-11885.1092 2920.5824,-11882.6376"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.5314,-11885.546 2929.0887,-11877.2242 2918.773,-11879.6405 2922.5314,-11885.546"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge635" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M1262.192,-5920.1106C1282.1975,-5909.8339 1308.7049,-5892.4713 1321.0291,-5868.2164 1359.7621,-5791.9865 1340.1355,-2874.0368 1357.0291,-2790.2164 1391.8155,-2617.6168 1465.0869,-2594.4191 1506.2007,-2423.2164 1528.1264,-2331.9152 1499.2333,-2085.7056 1542.2007,-2002.2164 1585.4847,-1918.112 1658.6199,-1947.0876 1704.2205,-1864.2164 1759.1872,-1764.3237 1675.7554,-1704.2598 1740.2205,-1610.2164 1776.7832,-1556.8776 1832.504,-1593.7732 1867.2231,-1539.2164 1926.5559,-1445.9825 1848.7397,-1139.3647 1903.2231,-1043.2164 1949.3616,-961.7947 2003.0491,-981.389 2075.5532,-922.2164 2092.6035,-908.3012 2092.5682,-899.3481 2111.5532,-888.2164 2271.7565,-794.2821 2326.696,-791.3177 2510.269,-763.2164 2671.5541,-738.5269 2721.4674,-742.0774 2876.0764,-794.2164 2911.7385,-806.2427 3138.1571,-944.9069 3174.6229,-954.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3174.6229,-954.2164C3325.2997,-997.5955 3415.7929,-880.0576 3525.3633,-992.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge661" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1262.1927,-5920.111C1282.1986,-5909.8344 1308.7062,-5892.4719 1321.0291,-5868.2164 1360.1104,-5791.2911 1346.717,-2847.8815 1357.0291,-2762.2164 1400.5427,-2400.736 1392.4272,-2296.0739 1542.2007,-1964.2164 1593.1896,-1851.2387 1653.2201,-1850.1889 1704.2205,-1737.2164 1733.3197,-1672.7577 1705.7702,-1643.9809 1740.2205,-1582.2164 1750.1185,-1564.4706 1766.4871,-1548.4072 1780.1264,-1536.9423"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1782.6105,-1539.4346 1788.1838,-1530.424 1778.2079,-1533.9924 1782.6105,-1539.4346"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge674" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M1623.2106,-5818.2164C1693.6184,-5761.7331 1684.7689,-5723.4396 1740.2205,-5652.2164 1808.5715,-5564.4247 1821.2646,-5537.4628 1903.2231,-5462.2164 1937.9765,-5430.3092 1942.3571,-5403.9492 1989.3882,-5400.2164"/>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M1431.6149,-5894.2164C1466.434,-5893.688 1475.4127,-5886.4875 1506.2007,-5870.2164 1524.1217,-5860.7453 1524.1706,-5851.4781 1542.2007,-5842.2164 1575.6027,-5825.0584 1592.3026,-5839.5423 1623.2106,-5818.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge710" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M1237.7068,-5942.3073C1245.1054,-6034.4556 1296.5108,-6682.8349 1321.0291,-7210.2164 1348.3873,-7798.687 1332.7657,-7946.61 1357.0291,-8535.2164 1379.302,-9075.5393 1421.9516,-9736.7741 1430.2106,-9862.8943"/>
<polygon fill="#005dff" stroke="#005dff" points="1426.7344,-9863.3724 1430.8819,-9873.1216 1433.7194,-9862.9138 1426.7344,-9863.3724"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge736" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1431.6149,-5894.2164C1623.162,-5893.6412 2007.1549,-6288.2965 2075.5532,-6467.2164 2105.4469,-6545.4137 2055.3226,-6780.1957 2111.5532,-6842.2164 2148.4128,-6882.8714 2552.6701,-6903.8285 2596.2213,-6937.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge771" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1240.2627,-5942.3998C1253.5651,-5985.1337 1303.4556,-6141.95 1357.0291,-6266.2164 1415.037,-6400.7688 1447.1287,-6426.1277 1506.2007,-6560.2164 1625.1103,-6830.1318 1613.8028,-6914.7349 1740.2205,-7181.2164 1788.4462,-7282.8735 1822.8765,-7296.8081 1867.2231,-7400.2164 1889.6731,-7452.5656 1873.4262,-7474.6717 1903.2231,-7523.2164 1958.2135,-7612.8058 2009.6242,-7603.341 2075.5532,-7685.2164 2305.2129,-7970.424 2365.0128,-8056.7167 2474.269,-8406.2164 2511.4419,-8525.1287 2451.8797,-8574.1589 2510.269,-8684.2164 2558.0658,-8774.3079 2635.93,-8745.3178 2682.1736,-8836.2164 2759.0964,-8987.4194 2637.4558,-9067.0048 2718.1736,-9216.2164 2728.9734,-9236.1804 2749.0358,-9252.0619 2766.2332,-9262.8856"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2764.524,-9265.9417 2774.901,-9268.0795 2768.1221,-9259.9371 2764.524,-9265.9417"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge801" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M1431.6149,-5664.2164C1457.9296,-5615.4135 1482.2704,-5614.2316 1506.2007,-5564.2164 1533.9295,-5506.2619 1522.1697,-5485.2603 1542.2007,-5424.2164 1662.8846,-5056.4348 1767.3098,-4990.1752 1867.2231,-4616.2164 1882.052,-4560.7146 1865.5997,-4403.6309 1903.2231,-4360.2164 1913.0033,-4348.9309 1927.5433,-4342.592 1941.9061,-4339.0775"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1942.6609,-4342.4957 1951.7607,-4337.0696 1941.2632,-4335.6367 1942.6609,-4342.4957"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge811" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1431.6149,-6160.2164C1458.6631,-6195.2551 1483.0346,-6188.4983 1506.2007,-6226.2164 1539.3743,-6280.2283 1524.0151,-6303.4952 1542.2007,-6364.2164 1566.5989,-6445.6816 1600.5708,-6541.0096 1615.5722,-6582.3446"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1612.3293,-6583.6681 1619.0397,-6591.8669 1618.9068,-6581.2729 1612.3293,-6583.6681"/>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1246.9332,-5942.3364C1276.459,-5974.9378 1364.6355,-6073.4502 1431.6149,-6160.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge828" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1989.3882,-12164.2164C2084.2127,-12155.8557 2099.4525,-12118.9447 2188.4692,-12085.2164"/>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1431.6149,-11974.2164C1444.5603,-11994.7068 1845.9033,-11986.688 1867.2231,-11998.2164 1907.512,-12020.0018 1943.7635,-12168.2391 1989.3882,-12164.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge856" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1623.2106,-5894.2164C1660.5334,-5890.0809 1675.6996,-5894.6429 1704.2205,-5870.2164 1732.608,-5845.9041 1710.9876,-5817.5054 1740.2205,-5794.2164 1762.8247,-5776.2082 1774.8218,-5780.3989 1803.7218,-5780.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2188.4692,-5958.2164C2245.1246,-5944.2376 2247.833,-5914.3981 2301.3853,-5891.2164 2310.946,-5887.0777 2321.3916,-5883.3988 2331.6121,-5880.2209"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2332.7239,-5883.5417 2341.306,-5877.329 2330.7228,-5876.8339 2332.7239,-5883.5417"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1431.6149,-5894.2164C1516.7587,-5892.9245 1538.5749,-5903.5943 1623.2106,-5894.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1803.7218,-5780.2164C1850.8239,-5779.9188 2142.7376,-5969.4998 2188.4692,-5958.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1262.1289,-5920.0783C1282.0968,-5909.7824 1308.5844,-5892.4097 1321.0291,-5868.2164 1363.2992,-5786.0401 1348.9167,-4297.2701 1357.0291,-4205.2164 1372.7755,-4026.5357 1413.8427,-3813.423 1427.2859,-3746.4361"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1430.7815,-3746.8075 1429.3314,-3736.3124 1423.9202,-3745.4211 1430.7815,-3746.8075"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge76" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-11974.2164C1449.9136,-12002.5491 1479.4934,-11967.6175 1506.2007,-11988.2164 1535.7961,-12011.0428 1519.6779,-12034.3892 1542.2007,-12064.2164 1599.901,-12140.6294 1659.1213,-12121.7513 1704.2205,-12206.2164 1762.4863,-12315.3411 1672.3622,-12378.7834 1740.2205,-12482.2164 1776.304,-12537.2166 1815.9023,-12517.0676 1867.2231,-12558.2164 1885.3737,-12572.7694 1882.9731,-12584.7634 1903.2231,-12596.2164 1971.4917,-12634.8277 2024.0571,-12575.0591 2075.5532,-12634.2164 2142.2935,-12710.8857 2068.7095,-12998.038 2111.5532,-13090.2164 2152.0648,-13177.3771 2224.5633,-13155.2006 2265.3853,-13242.2164 2344.5805,-13411.0284 2206.0167,-13499.9846 2301.3853,-13660.2164 2348.4587,-13739.306 2404.221,-13714.5142 2474.269,-13774.2164 2629.9471,-13906.9014 2613.4779,-14192.2981 2797.125,-14102.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-14102.2164C2836.1595,-14080.6087 2852.7803,-14078.2673 2876.0764,-14040.2164 2931.9612,-13948.9363 2971.2948,-13606.1078 2980.7558,-13516.6667"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2984.2473,-13516.9301 2981.8048,-13506.6206 2977.2851,-13516.2031 2984.2473,-13516.9301"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge218" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-7558.2164C2232.9503,-7560.43 2283.013,-7557.9009 2321.8431,-7554.833"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2322.2921,-7558.308 2331.9718,-7554.0007 2321.7187,-7551.3315 2322.2921,-7558.308"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-5894.2164C1485.1659,-5893.4038 1853.2988,-6702.5009 1867.2231,-6754.2164 1903.6233,-6889.4083 1846.6436,-7255.1516 1903.2231,-7383.2164 1925.3438,-7433.2854 1952.9237,-7430.3928 1989.3882,-7471.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-7471.2164C2016.4641,-7500.3235 2040.0449,-7477.3422 2075.5532,-7495.2164 2093.6585,-7504.3302 2094.2099,-7512.7248 2111.5532,-7523.2164 2143.6885,-7542.6562 2150.9579,-7556.3496 2188.4692,-7558.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge267" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1262.1606,-5920.0946C1282.1474,-5909.8083 1308.645,-5892.4407 1321.0291,-5868.2164 1375.7354,-5761.2059 1333.8566,-3823.1446 1357.0291,-3705.2164 1392.251,-3525.9665 1460.3018,-3499.0338 1506.2007,-3322.2164 1535.733,-3208.4484 1506.2992,-3172.1377 1542.2007,-3060.2164 1589.4448,-2912.9349 1634.0363,-2890.0496 1704.2205,-2752.2164 1795.0432,-2573.8514 1753.4249,-2480.9692 1903.2231,-2348.2164 1953.4938,-2303.666 2130.1102,-2214.9583 2188.4692,-2248.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge593" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1262.1871,-5920.1081C1282.1897,-5909.8299 1308.6956,-5892.4665 1321.0291,-5868.2164 1393.7691,-5725.1943 1303.6653,-3131.5396 1357.0291,-2980.2164 1392.7345,-2878.9668 1468.3165,-2890.6711 1506.2007,-2790.2164 1556.9354,-2655.6869 1481.4178,-2274.5146 1542.2007,-2144.2164 1583.9423,-2054.7364 1657.7742,-2079.3471 1704.2205,-1992.2164 1750.8271,-1904.7846 1700.4052,-1862.9426 1740.2205,-1772.2164 1776.9856,-1688.4403 1832.2242,-1694.7456 1867.2231,-1610.2164 1918.2582,-1486.9567 1858.1062,-1437.7631 1903.2231,-1312.2164 1951.2409,-1178.5974 2011.5346,-1169.9498 2075.5532,-1043.2164 2095.7243,-1003.285 2076.7922,-977.3776 2111.5532,-949.2164 2311.4388,-787.281 3044.3623,-958.0463 3259.4165,-1099.2164 3378.7468,-1177.5495 3346.5428,-1264.6584 3462.2747,-1348.2164 3486.5974,-1365.7773 3511.0949,-1345.827 3525.3633,-1372.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3525.3633,-1372.2164C3547.0202,-1406.533 3573.2317,-1400.5999 3588.4519,-1438.2164 3649.8612,-1589.9888 3549.1979,-7186.8107 3624.4519,-7332.2164 3625.8005,-7334.8222 3627.5597,-7337.2179 3629.5713,-7339.4064"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3259,-7342.0925 3637.1525,-7346.0534 3631.9407,-7336.8291 3627.3259,-7342.0925"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge312" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1262.1765,-5920.1027C1282.1728,-5909.8213 1308.6753,-5892.4562 1321.0291,-5868.2164 1385.2621,-5742.1821 1327.1647,-3460.4866 1357.0291,-3322.2164 1392.0386,-3160.1244 1459.7436,-3139.4057 1506.2007,-2980.2164 1534.9408,-2881.7357 1519.1537,-2852.1828 1542.2007,-2752.2164 1609.8545,-2458.767 1554.8626,-2341.56 1740.2205,-2104.2164 1887.9517,-1915.0522 2781.2823,-1772.2346 2982.9529,-1866.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge345" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1623.2106,-12050.2164C1651.9356,-12072.7974 1678.5812,-12038.1844 1704.2205,-12064.2164 1776.5163,-12137.6195 1701.1133,-12197.8993 1740.2205,-12293.2164 1752.0069,-12321.9438 1879.1117,-12500.6505 1903.2231,-12520.2164 1968.2232,-12572.9624 2026.5791,-12528.3292 2075.5532,-12596.2164 2174.8049,-12733.7975 2028.1824,-12828.4708 2111.5532,-12976.2164 2153.3736,-13050.3284 2223.5648,-13016.1043 2265.3853,-13090.2164 2307.0707,-13164.0892 2249.5285,-13403.0916 2301.3853,-13470.2164 2462.9063,-13679.2934 2671.7585,-13789.717 2876.0764,-13622.2164 2939.169,-13570.4928 2858.2291,-13503.5064 2912.0764,-13442.2164 2934.0271,-13417.2317 2958.5213,-13440.7811 2982.9529,-13418.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge441" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1261.4696,-5920.1485C1281.3251,-5909.796 1307.9991,-5892.3073 1321.0291,-5868.2164 1381.4093,-5756.58 1297.2232,-5410.1615 1357.0291,-5298.2164 1396.3481,-5224.6187 1465.7497,-5257.198 1506.2007,-5184.2164 1547.5353,-5109.6404 1521.8,-4885.0049 1542.2007,-4802.2164 1587.6007,-4617.9778 1634.7157,-4583.7783 1704.2205,-4407.2164 1779.3893,-4216.2661 1824.4206,-4175.9159 1867.2231,-3975.2164 1895.3147,-3843.4963 1836.7882,-3487.3731 1903.2231,-3370.2164 2064.3101,-3086.1424 2209.6926,-3083.8911 2510.269,-2956.2164 2649.0534,-2897.2655 3072.6972,-2707.0973 3174.6229,-2818.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge497" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1237.7806,-5942.3042C1245.777,-6034.4273 1301.0956,-6682.6417 1321.0291,-7210.2164 1322.9594,-7261.3074 1327.7741,-10849.2859 1357.0291,-10891.2164 1435.4365,-11003.5961 2380.3102,-11284.7695 2510.269,-11328.2164 2521.7838,-11332.0659 2534.2754,-11335.8941 2546.0752,-11339.3556"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2545.2088,-11342.7485 2555.7878,-11342.1694 2547.1567,-11336.0249 2545.2088,-11342.7485"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge524" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1623.2106,-12050.2164C1657.7032,-12079.6423 1677.6781,-12075.4587 1704.2205,-12112.2164 1732.8552,-12151.8717 1713.5468,-12175.2162 1740.2205,-12216.2164 1794.2384,-12299.2476 1821.8441,-12311.74 1903.2231,-12368.2164 1973.5463,-12417.0201 2023.5693,-12386.2104 2075.5532,-12454.2164 2125.0992,-12519.033 2063.7875,-12568.0768 2111.5532,-12634.2164 2243.0445,-12816.2877 2374.8069,-12814.8409 2596.2213,-12777.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge543" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1431.6149,-11974.2164C1449.4656,-12002.8335 1482.6486,-11964.0733 1506.2007,-11988.2164 1575.9988,-12059.7659 1502.7681,-12118.3677 1542.2007,-12210.2164 1589.1231,-12319.511 1643.5068,-12320.9378 1704.2205,-12423.2164 1717.1003,-12444.9139 2068.2801,-13228.0549 2075.5532,-13252.2164 2103.8594,-13346.2494 2083.6762,-13376.0552 2111.5532,-13470.2164 2160.02,-13633.9242 2199.0189,-13664.9116 2265.3853,-13822.2164 2397.995,-14136.5346 2551.6774,-14522.8524 2588.1629,-14614.8674"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2584.9129,-14616.1667 2591.8512,-14624.1737 2591.4205,-14613.5876 2584.9129,-14616.1667"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge566" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1803.7218,-5780.2164C1832.6006,-5781.3378 1845.0765,-5775.6484 1867.2231,-5794.2164 1899.2902,-5821.1016 1875.8763,-5849.5421 1903.2231,-5881.2164 1961.5349,-5948.7556 2005.1856,-5929.351 2075.5532,-5984.2164 2124.9795,-6022.7538 2448.4745,-6326.096 2474.269,-6383.2164 2526.3217,-6498.4837 2462.8651,-6833.9606 2510.269,-6951.2164 2523.9824,-6985.137 2553.7889,-7015.8623 2574.4258,-7034.2894"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2572.2556,-7037.0403 2582.1002,-7040.9562 2576.8463,-7031.7558 2572.2556,-7037.0403"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge419" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1259.9417,-5920.1299C1279.4013,-5909.5573 1306.336,-5891.7622 1321.0291,-5868.2164 1366.5293,-5795.3014 1296.2035,-5738.938 1357.0291,-5678.2164 1380.8988,-5654.3874 1416.1682,-5694.1995 1431.6149,-5664.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-5664.2164C1470.5229,-5588.6931 1485.986,-5570.7328 1506.2007,-5488.2164 1530.1236,-5390.563 1499.0495,-5128.0264 1542.2007,-5037.2164 1584.9712,-4947.2073 1658.997,-4971.0183 1704.2205,-4882.2164 1758.3593,-4775.9079 1679.7515,-4719.056 1740.2205,-4616.2164 1775.9493,-4555.4523 1830.3316,-4581.2817 1867.2231,-4521.2164 1915.8658,-4442.0184 1853.0892,-4393.4788 1903.2231,-4315.2164 1953.4297,-4236.8407 2015.2775,-4267.1408 2075.5532,-4196.2164 2099.7572,-4167.7364 2085.3436,-4146.862 2111.5532,-4120.2164 2165.0295,-4065.8505 2215.5929,-4101.9753 2265.3853,-4044.2164 2299.5249,-4004.6145 2269.343,-3973.5337 2301.3853,-3932.2164 2357.0507,-3860.4377 2413.4777,-3890.7088 2474.269,-3823.2164 2498.4795,-3796.3371 2482.426,-3773.3119 2510.269,-3750.2164 2540.796,-3724.8945 2557.0572,-3732.4828 2596.2213,-3726.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge391" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-5894.2164C1487.7389,-5893.1358 1700.9091,-5534.2876 1740.2205,-5494.2164 1888.412,-5343.1603 1925.8856,-5297.7359 2111.5532,-5196.2164 2260.7838,-5114.6199 2317.9495,-5141.2385 2474.269,-5074.2164 2490.8968,-5067.0872 2493.7951,-5062.6941 2510.269,-5055.2164 2547.5299,-5038.3033 2555.3764,-5024.6899 2596.2213,-5022.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1276.3362,-5920.1968C1315.415,-5910.1384 1377.0998,-5896.4989 1431.6149,-5894.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge364" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1260.4665,-5920.0063C1279.9823,-5909.4628 1306.7096,-5891.7779 1321.0291,-5868.2164 1372.0303,-5784.2978 1329.6783,-5744.5318 1357.0291,-5650.2164 1404.3527,-5487.0268 1464.299,-5462.8815 1506.2007,-5298.2164 1546.7272,-5138.9555 1462.3295,-5073.8374 1542.2007,-4930.2164 1586.2723,-4850.9687 1657.5525,-4883.9634 1704.2205,-4806.2164 1754.7602,-4722.019 1700.692,-4678.1105 1740.2205,-4588.2164 1777.0469,-4504.4672 1829.0773,-4509.3729 1867.2231,-4426.2164 1901.603,-4351.2695 1858.6456,-4313.5839 1903.2231,-4244.2164 1954.2351,-4164.8362 2000.3413,-4177.1953 2075.5532,-4120.2164 2078.7503,-4117.7943 2186.0216,-4033.3939 2188.4692,-4030.2164"/>
</g>
<!-- sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge471" class="edge">
<title>sourcefile~dataloopnode.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1237.7901,-5942.3039C1245.8637,-6034.4241 1301.6879,-6682.6196 1321.0291,-7210.2164 1330.7537,-7475.4902 1299.9195,-11728.9805 1357.0291,-11988.2164 1373.9594,-12065.0677 1901.6836,-13193.8754 1979.7718,-13360.6839"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1976.6663,-13362.3054 1984.0765,-13369.8778 1983.0058,-13359.3372 1976.6663,-13362.3054"/>
</g>
<!-- sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node17" class="node">
<title>sourcefile~dataairsystems.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node17"><a xlink:href="../sourcefile/dataairsystems.f90.html" xlink:title="DataAirSystems.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2240.7519,-4346.2218 2136.1865,-4346.2218 2136.1865,-4324.2109 2240.7519,-4324.2109 2240.7519,-4346.2218"/>
<text text-anchor="middle" x="2188.4692" y="-4332.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirSystems.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge899" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2189.0696,-4323.9236C2194.8775,-4214.2948 2241.3879,-3327.9464 2265.3853,-2609.2164 2266.8873,-2564.2303 2271.7175,-1023.0664 2301.3853,-989.2164 2357.8252,-924.8199 2597.8316,-945.0088 2682.1736,-930.2164 2768.6716,-915.0458 2796.1534,-928.6082 2876.0764,-892.2164 2894.5239,-883.8166 2894.3204,-873.9933 2912.0764,-864.2164 2985.6294,-823.7164 3010.4546,-827.6014 3089.8293,-800.2164 3121.3264,-789.3496 3627.2549,-603.2414 3659.3423,-612.2164"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge38" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2195.1833,-4346.4152C2211.1884,-4373.8353 2251.3002,-4447.014 2265.3853,-4514.2164 2321.1378,-4780.2217 2261.2932,-9137.4046 2301.3853,-9406.2164 2316.961,-9510.6498 2361.1009,-9629.8527 2379.5561,-9676.7447"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2376.3312,-9678.1071 2383.2792,-9686.1056 2382.8356,-9675.52 2376.3312,-9678.1071"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge186" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M2240.9858,-4343.4601C2250.3063,-4347.1734 2259.0457,-4352.5225 2265.3853,-4360.2164 2349.0984,-4461.8131 2234.6746,-4540.7287 2301.3853,-4654.2164 2313.516,-4674.853 2335.3476,-4690.6807 2354.0349,-4701.31"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2352.4393,-4704.4262 2362.8997,-4706.1087 2355.7717,-4698.2702 2352.4393,-4704.4262"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge245" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2237.3068,-4346.2797C2247.1168,-4349.7924 2256.982,-4354.3472 2265.3853,-4360.2164 2388.6201,-4446.2885 2416.653,-4487.3797 2474.269,-4626.2164 2525.0654,-4748.6198 2439.7284,-4810.0251 2510.269,-4922.2164 2558.5497,-4999.0042 2636.0158,-4954.134 2682.1736,-5032.2164 2743.713,-5136.3189 2670.9059,-5463.905 2718.1736,-5575.2164 2758.9912,-5671.3385 2838.1336,-5651.9236 2876.0764,-5749.2164 2929.8915,-5887.2086 2904.9108,-10933.2753 2912.0764,-11081.2164 2926.8052,-11385.3055 2969.466,-11753.7493 2980.3838,-11845.0108"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2976.9369,-11845.6621 2981.6058,-11855.1727 2983.8868,-11844.8263 2976.9369,-11845.6621"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge636" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2193.9663,-4323.833C2209.3376,-4292.3632 2254.7042,-4201.91 2301.3853,-4132.2164 2370.0081,-4029.7644 2428.1198,-4029.5656 2474.269,-3915.2164 2537.7591,-3757.8999 2481.0166,-3702.3204 2510.269,-3535.2164 2625.9495,-2874.3934 2654.4811,-2699.6626 2912.0764,-2080.2164 2986.3603,-1901.5839 3170.8891,-1370.8796 3360.8456,-1334.2164"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge737" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2241.1303,-4343.8276C2250.3235,-4347.5168 2258.9778,-4352.7632 2265.3853,-4360.2164 2329.4034,-4434.682 2249.5449,-4494.8135 2301.3853,-4578.2164 2326.3438,-4618.3707 2370.5972,-4596.1888 2387.8271,-4640.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2387.8271,-4640.2164C2402.3577,-4677.3463 2448.6371,-4633.6751 2474.269,-4664.2164 2527.6603,-4727.8336 2490.5918,-4955.5282 2510.269,-5036.2164 2558.8367,-5235.3719 2641.0054,-5263.4007 2682.1736,-5464.2164 2753.6419,-5812.8338 2632.5664,-6719.7989 2718.1736,-7065.2164 2731.4195,-7118.6626 2764.9278,-7174.868 2783.756,-7203.666"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2780.8566,-7205.6267 2789.309,-7212.0148 2786.6851,-7201.75 2780.8566,-7205.6267"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge772" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2387.8271,-4640.2164C2404.4263,-4683.1377 2451.1788,-4657.4092 2474.269,-4697.2164 2537.6171,-4806.4273 2493.76,-5139.0467 2510.269,-5264.2164 2560.8386,-5647.629 2641.5485,-5732.6229 2682.1736,-6117.2164 2691.217,-6202.8292 2680.3825,-9138.8654 2718.1736,-9216.2164 2728.0719,-9236.4763 2747.9456,-9252.2781 2765.2763,-9262.9888"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2763.6432,-9266.0885 2774.041,-9268.1224 2767.1811,-9260.0483 2763.6432,-9266.0885"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge857" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2195.0871,-4346.4359C2210.8784,-4373.9021 2250.5514,-4447.1753 2265.3853,-4514.2164 2323.6456,-4777.5221 2223.4931,-5469.0362 2301.3853,-5727.2164 2315.6918,-5774.6365 2350.5876,-5821.9188 2371.4045,-5847.2691"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2368.7702,-5849.5749 2377.8744,-5854.994 2374.1367,-5845.0803 2368.7702,-5849.5749"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge268" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2189.852,-4324.18C2195.9931,-4278.4719 2223.9925,-4100.7654 2301.3853,-3980.2164 2357.459,-3892.8743 2430.6448,-3917.3961 2474.269,-3823.2164 2523.6598,-3716.5873 2497.0366,-2882.9815 2510.269,-2766.2164 2528.8692,-2602.0858 2575.1337,-2407.8179 2590.8774,-2344.3864"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2594.3413,-2344.961 2593.3705,-2334.4107 2587.5502,-2343.2637 2594.3413,-2344.961"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge594" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2387.8271,-4146.2164C2458.7022,-4074.2478 3194.4492,-4195.3263 3295.4165,-4198.2164 3353.5519,-4199.8804 3369.8052,-4212.1335 3426.2747,-4198.2164 3474.5649,-4186.315 3484.253,-4118.2247 3525.3633,-4146.2164"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge314" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3360.8456,-4184.2164C3390.9663,-4191.4372 3402.8155,-4180.4418 3426.2747,-4160.2164 3451.5811,-4138.3983 3437.2509,-4116.358 3462.2747,-4094.2164 3466.4106,-4090.5568 3471.1472,-4087.3992 3476.1257,-4084.6824"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3477.7952,-4087.7628 3485.2709,-4080.2552 3474.745,-4081.4623 3477.7952,-4087.7628"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2210.5647,-4324.112C2226.6321,-4315.4856 2248.4446,-4302.5977 2265.3853,-4288.2164 2328.9138,-4234.2857 2330.4295,-4206.6309 2387.8271,-4146.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2387.8271,-4146.2164C2428.2911,-4103.6256 2450.8469,-4100.0931 2474.269,-4046.2164 2504.0321,-3977.754 2463.2885,-3770.2316 2510.269,-3712.2164 2726.4402,-3445.2715 3009.7801,-3286.2689 3259.4165,-3522.2164 3311.0171,-3570.9874 3253.1403,-4103.1729 3295.4165,-4160.2164 3313.8593,-4185.1013 3330.7248,-4176.9956 3360.8456,-4184.2164"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge498" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2194.5295,-4346.5785C2209.083,-4374.3612 2246.2155,-4448.2841 2265.3853,-4514.2164 2293.4142,-4610.6186 2281.7588,-4638.7592 2301.3853,-4737.2164 2366.313,-5062.9297 2434.5748,-5134.4754 2474.269,-5464.2164 2484.0032,-5545.0786 2461.1775,-11263.2282 2510.269,-11328.2164 2512.6079,-11331.3126 2515.3082,-11334.0427 2518.2771,-11336.4485"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.4433,-11339.4328 2526.6999,-11342.0887 2520.3382,-11333.6164 2516.4433,-11339.4328"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge525" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2387.8271,-4640.2164C2404.8118,-4682.9866 2451.9503,-4656.9716 2474.269,-4697.2164 2552.3222,-4837.9606 2471.1841,-5989.0959 2510.269,-6145.2164 2551.584,-6310.2447 2642.3645,-6321.8184 2682.1736,-6487.2164 2717.483,-6633.9191 2709.7123,-11768.5616 2718.1736,-11919.2164 2734.3137,-12206.5961 2781.5477,-12553.8457 2794.0561,-12642.7033"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2790.6284,-12643.461 2795.4953,-12652.8718 2797.5593,-12642.48 2790.6284,-12643.461"/>
</g>
<!-- sourcefile~dataairsystems.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge420" class="edge">
<title>sourcefile~dataairsystems.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-4146.2164C2415.3389,-4117.3568 2445.2892,-4149.6013 2474.269,-4122.2164 2510.4314,-4088.0442 2473.4318,-4049.66 2510.269,-4016.2164 2633.9238,-3903.9531 2726.8256,-4005.168 2876.0764,-3930.2164 2931.571,-3902.3478 2928.6013,-3810.1795 2982.9529,-3840.2164"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge900" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1805.1309,-1508.0769C1818.7232,-1402.485 1930.0165,-578.5049 2111.5532,-428.2164 2349.946,-230.8585 2492.515,-360.9339 2797.125,-306.2164"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge802" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M1805.1427,-1530.5928C1813.0993,-1594.8623 1852.3035,-1919.0714 1867.2231,-2185.2164 1870.5274,-2244.1601 1867.3697,-4263.3143 1903.2231,-4310.2164 1912.3694,-4322.1811 1926.898,-4328.6742 1941.4385,-4332.122"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1940.9589,-4335.594 1951.441,-4334.0523 1942.2853,-4328.7208 1940.9589,-4335.594"/>
</g>
<!-- sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge313" class="edge">
<title>sourcefile~branchinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1821.9722,-1508.0888C1841.329,-1496.9907 1873.1995,-1480.6899 1903.2231,-1474.2164 1965.2618,-1460.8399 2139.3761,-1447.9971 2188.4692,-1488.2164"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge901" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2189.9187,-5314.2046C2199.0019,-5244.6162 2248.2491,-4858.6457 2265.3853,-4542.2164 2268.0141,-4493.6738 2269.0929,-1078.5549 2301.3853,-1042.2164 2386.9184,-945.9661 2761.2889,-1026.5591 2876.0764,-968.2164 2896.8157,-957.6753 2892.3002,-942.4694 2912.0764,-930.2164 3052.806,-843.0228 3462.9944,-748.809 3624.4519,-712.2164 3694.6316,-696.3109 3748.3296,-626.0501 3784.5721,-688.2164"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge187" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M2190.8529,-5313.7764C2206.0972,-5240.7106 2289.6679,-4841.6589 2301.3853,-4818.2164 2317.8914,-4785.1928 2347.5198,-4754.0048 2367.4271,-4735.2519"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2370.0587,-4737.5864 2375.042,-4728.2366 2365.3158,-4732.438 2370.0587,-4737.5864"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge774" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2596.2213,-6899.2164C2601.0948,-6942.6983 2659.7277,-6909.6583 2682.1736,-6947.2164 2746.8483,-7055.4346 2662.5908,-9103.0592 2718.1736,-9216.2164 2728.1149,-9236.4552 2747.9884,-9252.2571 2765.3082,-9262.9732"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2763.6699,-9266.0698 2774.0665,-9268.1099 2767.2114,-9260.0317 2763.6699,-9266.0698"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2387.8271,-5713.2164C2404.832,-5749.2803 2449.6407,-5705.8602 2474.269,-5737.2164 2552.4113,-5836.705 2432.1998,-6775.6704 2510.269,-6875.2164 2534.745,-6906.4257 2591.8036,-6859.8009 2596.2213,-6899.2164"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge858" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2209.7091,-5336.3202C2227.8133,-5347.0144 2252.8361,-5364.979 2265.3853,-5388.2164 2337.3811,-5521.5319 2252.1339,-5583.9308 2301.3853,-5727.2164 2317.486,-5774.0577 2351.7328,-5821.5493 2371.9528,-5847.0923"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2369.2272,-5849.2881 2378.2258,-5854.8806 2374.6788,-5844.8971 2369.2272,-5849.2881"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge219" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2189.567,-5336.4591C2197.1749,-5414.7644 2242.4251,-5886.9142 2265.3853,-6272.2164 2290.4397,-6692.6634 2239.4988,-6802.5948 2301.3853,-7219.2164 2319.0456,-7338.106 2363.2608,-7475.9012 2380.6458,-7527.3978"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2377.3921,-7528.7011 2383.9291,-7537.0389 2384.0184,-7526.4445 2377.3921,-7528.7011"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge269" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2196.3281,-5313.9348C2235.9415,-5256.3083 2414.1899,-4987.7659 2474.269,-4737.2164 2525.3438,-4524.2179 2487.3228,-2984.0477 2510.269,-2766.2164 2527.5734,-2601.9442 2574.6766,-2407.7679 2590.7564,-2344.3732"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2594.2192,-2344.9587 2593.3041,-2334.4035 2587.4371,-2343.2256 2594.2192,-2344.9587"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge595" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2251.201,-5331.738C2256.4144,-5334.1443 2261.2578,-5337.2439 2265.3853,-5341.2164 2313.2274,-5387.2622 2281.5341,-5422.8522 2301.3853,-5486.2164 2333.6597,-5589.2354 2342.0149,-5615.4626 2387.8271,-5713.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2387.8271,-5713.2164C2396.085,-5730.8369 2456.2614,-5719.8405 2474.269,-5727.2164 2676.8744,-5810.2026 2740.8357,-5840.0375 2876.0764,-6012.2164 3161.3943,-6375.4627 3133.0685,-6533.93 3259.4165,-6978.2164 3284.3611,-7065.9308 3239.5134,-7108.1685 3295.4165,-7180.2164 3363.7345,-7268.2647 3421.6352,-7239.469 3525.3633,-7280.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3525.3633,-7280.2164C3566.5136,-7295.5584 3609.8203,-7322.7645 3635.6994,-7340.3885"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3633.8771,-7343.3835 3644.0942,-7346.1875 3637.8557,-7337.6241 3633.8771,-7343.3835"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge346" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2387.8271,-5713.2164C2404.4257,-5748.4186 2445.7764,-5700.7046 2474.269,-5727.2164 2525.0944,-5774.5084 2481.3884,-5816.0843 2510.269,-5879.2164 2564.5506,-5997.8743 2625.492,-5999.6859 2682.1736,-6117.2164 2716.86,-6189.1395 2857.4607,-6731.5663 2876.0764,-6809.2164 2895.0964,-6888.5526 2886.4588,-6911.7584 2912.0764,-6989.2164 2958.3818,-7129.2262 3020.977,-7145.4538 3053.8293,-7289.2164 3082.0051,-7412.5142 3032.5664,-11729.4459 3089.8293,-11842.2164 3100.4615,-11863.1548 3121.6716,-11878.9087 3140.2177,-11889.426"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.5841,-11892.5215 3149.0502,-11894.1682 3141.8954,-11886.3541 3138.5841,-11892.5215"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge527" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2596.2213,-6899.2164C2602.2404,-6952.9195 2661.3185,-6935.3634 2682.1736,-6985.2164 2735.0679,-7111.6577 2710.4423,-11782.3754 2718.1736,-11919.2164 2734.4098,-12206.5907 2781.5738,-12553.8442 2794.0614,-12642.703"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2790.6335,-12643.4597 2795.4981,-12652.8717 2797.5646,-12642.4803 2790.6335,-12643.4597"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge422" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2251.1584,-5334.9571C2331.0604,-5346.5086 2473.5508,-5364.2164 2596.2213,-5364.2164 2596.2213,-5364.2164 2596.2213,-5364.2164 2797.125,-5364.2164 2914.4963,-5364.2164 2979.6098,-5393.1421 3053.8293,-5302.2164 3125.3996,-5214.5362 3057.2963,-4392.6217 3089.8293,-4284.2164 3103.9915,-4237.0259 3138.1754,-4189.6606 3158.5527,-4164.2338"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.2681,-4166.4421 3164.8851,-4156.4838 3155.8474,-4162.013 3161.2681,-4166.4421"/>
</g>
<!-- sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge392" class="edge">
<title>sourcefile~outairnodemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2207.2995,-5314.0517C2302.8091,-5257.6667 2731.7078,-5007.4595 2797.125,-5022.2164"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node20" class="node">
<title>sourcefile~dataheatbalfansys.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node20"><a xlink:href="../sourcefile/dataheatbalfansys.f90.html" xlink:title="DataHeatBalFanSys.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1865.8666,-2216.2218 1741.577,-2216.2218 1741.577,-2194.2109 1865.8666,-2194.2109 1865.8666,-2216.2218"/>
<text text-anchor="middle" x="1803.7218" y="-2202.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalFanSys.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge902" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-574.2164C3069.7793,-495.9329 3263.5229,-112.716 3659.3423,-384.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1805.687,-2194.1138C1813.5764,-2149.4883 1843.6568,-1978.8351 1867.2231,-1838.2164 1883.7443,-1739.6356 1881.6628,-1713.819 1903.2231,-1616.2164 1964.2671,-1339.8727 2021.2603,-1280.9653 2075.5532,-1003.2164 2089.2815,-932.9859 2069.2143,-740.907 2111.5532,-683.2164 2242.1845,-505.2193 2380.0058,-618.9192 2596.2213,-574.2164"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge223" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1804.5392,-2216.3139C1810.8261,-2302.2084 1851.67,-2869.9886 1867.2231,-3332.2164 1873.3459,-3514.1799 1866.2824,-6430.9368 1903.2231,-6609.2164 1951.7358,-6843.3433 1973.2461,-6910.1778 2111.5532,-7105.2164 2164.855,-7180.3818 2220.1128,-7163.9585 2265.3853,-7244.2164 2306.7541,-7317.5539 2267.6897,-7353.0517 2301.3853,-7430.2164 2318.3265,-7469.0128 2349.8589,-7507.3188 2369.7956,-7529.3218"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2367.459,-7531.9505 2376.8142,-7536.9235 2372.602,-7527.2019 2367.459,-7531.9505"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge599" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1989.3882,-2096.2164C2065.524,-2005.5858 2053.1998,-1960.4527 2075.5532,-1844.2164 2090.5124,-1766.4295 2054.145,-1186.7953 2111.5532,-1132.2164 2161.1036,-1085.1081 2197.2077,-1127.0935 2265.3853,-1132.2164 2413.6752,-1143.3588 2447.5133,-1182.2164 2596.2213,-1182.2164 2596.2213,-1182.2164 2596.2213,-1182.2164 2797.125,-1182.2164 2900.2999,-1182.2164 3181.9703,-1157.0464 3259.4165,-1225.2164 3314.4547,-1273.6622 3245.2185,-1332.7715 3295.4165,-1386.2164 3336.8782,-1430.3599 3372.2167,-1396.9132 3426.2747,-1424.2164 3507.2643,-1465.122 3547.9985,-1467 3588.4519,-1548.2164 3660.0862,-1692.0333 3550.594,-7189.5286 3624.4519,-7332.2164 3625.8007,-7334.8221 3627.56,-7337.2177 3629.5716,-7339.4062"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3263,-7342.0924 3637.153,-7346.0531 3631.9411,-7336.8289 3627.3263,-7342.0924"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1815.1552,-2193.9493C1840.1535,-2169.3634 1897.8773,-2112.8761 1903.2231,-2110.2164 1937.9593,-2092.9343 1964.1804,-2125.7093 1989.3882,-2096.2164"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge316" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1989.3882,-2096.2164C2006.1698,-2076.2275 2256.7104,-2049.7674 2301.3853,-2045.2164 2687.6772,-2005.8649 2786.353,-2014.1654 3174.6229,-2018.2164"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge529" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2596.2213,-11314.2164C2601.491,-11352.9831 2656.752,-11303.478 2682.1736,-11333.2164 2724.5614,-11382.8019 2712.7349,-11854.2096 2718.1736,-11919.2164 2742.1707,-12206.0469 2783.6777,-12553.6968 2794.4892,-12642.6731"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.046,-12643.3522 2795.7299,-12652.8554 2797.9946,-12642.5055 2791.046,-12643.3522"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2387.8271,-9392.2164C2393.118,-9410.9429 2461.4581,-9391.5686 2474.269,-9406.2164 2523.0768,-9462.0219 2503.7674,-10666.3639 2510.269,-10740.2164 2532.8908,-10997.1779 2561.4763,-11058.6116 2596.2213,-11314.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1804.25,-2216.5357C1809.354,-2326.4222 1850.1019,-3214.8524 1867.2231,-3935.2164 1869.4159,-4027.4735 1873.0317,-7170.0116 1903.2231,-7257.2164 1944.3173,-7375.9125 2033.5926,-7362.8237 2075.5532,-7481.2164 2101.8039,-7555.2831 2065.4839,-8831.5564 2111.5532,-8895.2164 2154.1209,-8954.0377 2220.2414,-8893.3482 2265.3853,-8950.2164 2308.9162,-9005.0528 2277.2171,-9197.5058 2301.3853,-9263.2164 2325.2086,-9327.9894 2369.0625,-9325.8011 2387.8271,-9392.2164"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge395" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1816.3929,-2216.4484C1859.9975,-2255.8495 2005.041,-2393.2581 2075.5532,-2538.2164 2104.033,-2596.7648 2076.4011,-2625.4136 2111.5532,-2680.2164 2158.9657,-2754.1333 2198.6895,-2747.0907 2265.3853,-2804.2164 2360.6997,-2885.8544 2398.2605,-2894.3548 2474.269,-2994.2164 2713.8078,-3308.9273 2767.7518,-3407.8382 2876.0764,-3788.2164 2944.8177,-4029.5991 2977.059,-4856.7712 2982.21,-5000.7583"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.7183,-5001.0578 2982.5691,-5010.928 2985.7139,-5000.8107 2978.7183,-5001.0578"/>
</g>
<!-- sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge484" class="edge">
<title>sourcefile~dataheatbalfansys.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1804.2781,-2216.5351C1809.6499,-2326.4156 1852.4321,-3214.8008 1867.2231,-3935.2164 1904.8243,-5766.6257 1833.7503,-10347.739 1903.2231,-12178.2164 1921.3991,-12657.1183 1975.9493,-13241.2917 1987.3038,-13359.6954"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1983.8491,-13360.3348 1988.2914,-13369.9533 1990.8168,-13359.6639 1983.8491,-13360.3348"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge903" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2982.9529,-16688.2164C3153.3976,-16705.465 3190.3973,-16747.0032 3360.8456,-16764.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3360.8456,-16764.2164C3433.8701,-16767.932 3456.8913,-16738.5655 3525.3633,-16764.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.5343,-7082.4317C915.7584,-7195.0461 950.5753,-8133.6571 966.4307,-8894.2164 981.1186,-9598.7754 956.6339,-11361.994 1002.4307,-12065.2164 1039.052,-12627.5468 1075.2094,-12766.0336 1152.5955,-13324.2164 1232.4923,-13900.5094 1247.687,-14045.7783 1357.0291,-14617.2164 1427.4904,-14985.4576 1436.2872,-15080.5655 1542.2007,-15440.2164 1644.0005,-15785.8986 1641.7845,-15918.2058 1903.2231,-16166.2164 2289.9242,-16533.0555 2460.4236,-16582.9936 2982.9529,-16688.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge40" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.213,-7082.4965C912.564,-7226.6679 928.2107,-8707.3032 1002.4307,-8884.2164 1016.9209,-8918.7559 1055.3993,-8908.9871 1059.5131,-8946.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-8946.2164C1083.1001,-9159.6761 1561.2284,-9513.5435 1740.2205,-9632.2164 1839.6742,-9698.1548 1870.9047,-9718.0537 1989.3882,-9732.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge62" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M911.4901,-7082.4328C915.2793,-7195.0573 946.6815,-8133.7482 966.4307,-8894.2164 971.2403,-9079.4193 966.5594,-10379.4569 1002.4307,-10561.2164 1016.0811,-10630.383 1054.3806,-10638.9027 1059.5131,-10709.2164"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1059.5131,-10709.2164C1061.5166,-10736.6645 1101.082,-10710.4843 1116.5955,-10733.2164 1161.8615,-10799.5452 1128.2161,-12101.7038 1152.5955,-12178.2164 1202.0266,-12333.3518 1241.1901,-12367.7971 1357.0291,-12482.2164 1642.1969,-12763.8892 1727.4475,-12861.6603 2111.5532,-12976.2164 2650.114,-13136.8372 2398.0066,-12326.8922 2510.269,-11776.2164 2526.9072,-11694.602 2567.3803,-11603.4805 2586.2409,-11563.6763"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.4787,-11565.0187 2590.645,-11554.4883 2583.1664,-11561.993 2589.4787,-11565.0187"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge248" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M911.4983,-7082.4326C915.3687,-7195.055 947.4085,-8133.7297 966.4307,-8894.2164 968.972,-8995.8154 962.5824,-10629.7234 1002.4307,-10723.2164 1030.5455,-10789.1801 1088.3897,-10771.2915 1116.5955,-10837.2164 1186.7181,-11001.1126 1088.1335,-12275.0122 1152.5955,-12441.2164 1193.7638,-12547.3621 1255.979,-12540.7806 1321.0291,-12634.2164 1438.4347,-12802.8541 1392.69,-12899.2577 1542.2007,-13040.2164 1754.116,-13240.0101 2578.0051,-13610.0811 2797.125,-13418.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge639" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M950.724,-7060.1187C956.9322,-7056.6531 962.5641,-7052.1249 966.4307,-7046.2164 1009.8757,-6979.8288 997.6774,-4269.4135 1002.4307,-4190.2164 1030.8185,-3717.2319 1084.5501,-3602.9672 1116.5955,-3130.2164 1126.2327,-2988.042 1105.3959,-1982.6731 1152.5955,-1848.2164 1167.2299,-1806.5275 2071.9991,-598.9039 2111.5532,-579.2164 2343.6652,-463.6858 3028.4552,-670.4024 3259.4165,-788.2164 3325.7666,-822.0617 3476.1596,-936.2983 3525.3633,-992.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3525.3633,-992.2164C3544.5724,-1015.2597 3569.2946,-993.1299 3588.4519,-1016.2164 3702.0701,-1153.1379 3593.2655,-1245.0182 3659.3423,-1410.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge680" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M966.3042,-7061.2396C1015.0356,-7049.2214 1083.352,-7023.8122 1116.5955,-6972.2164 1184.7535,-6866.4311 1082.9493,-5945.0279 1152.5955,-5840.2164 1176.5133,-5804.222 1469.1101,-5700.3963 1506.2007,-5678.2164 1600.9588,-5621.5517 1619.9578,-5599.5592 1704.2205,-5528.2164 1721.0167,-5513.9955 1721.8266,-5506.2998 1740.2205,-5494.2164 1806.1168,-5450.9272 1828.8575,-5450.4083 1903.2231,-5424.2164 1940.7188,-5411.0102 1950.9869,-5410.4958 1989.3882,-5400.2164"/>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M1989.3882,-5400.2164C2024.8842,-5382.3178 2038.1821,-5389.7709 2075.5532,-5376.2164 2103.8631,-5365.9484 2134.9791,-5351.6584 2157.3653,-5340.8162"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2158.9454,-5343.9397 2166.3913,-5336.4025 2155.8703,-5337.6513 2158.9454,-5343.9397"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge700" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M950.2361,-7060.1328C956.5735,-7056.6605 962.3769,-7052.1263 966.4307,-7046.2164 1006.7811,-6987.3908 993.4272,-6475.9804 1002.4307,-6405.2164 1015.1801,-6305.0102 1042.7261,-6187.2903 1054.263,-6140.2134"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1057.7118,-6140.8463 1056.7131,-6130.2986 1050.9162,-6139.1669 1057.7118,-6140.8463"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge706" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00aeff" stroke-dasharray="5,2" d="M911.4716,-7082.4893C915.1836,-7197.6482 947.5003,-8172.4851 1002.4307,-8960.2164 1041.2994,-9517.6158 1082.8739,-9654.4818 1116.5955,-10212.2164 1124.6862,-10346.0317 1100.7469,-11294.589 1152.5955,-11418.2164 1181.0993,-11486.1808 1351.5272,-11639.2536 1411.0862,-11691.4148"/>
<polygon fill="#00aeff" stroke="#00aeff" points="1408.893,-11694.1462 1418.7281,-11698.0859 1413.4965,-11688.8729 1408.893,-11694.1462"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge724" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M911.471,-7082.4333C915.0728,-7195.0629 945.0034,-8133.7936 966.4307,-8894.2164 970.7636,-9047.9851 961.3681,-10129.9684 1002.4307,-10278.2164 1010.9244,-10308.8813 1030.6735,-10340.1623 1044.5516,-10359.6211"/>
<polygon fill="#000dff" stroke="#000dff" points="1041.9028,-10361.928 1050.6355,-10367.9272 1047.55,-10357.7916 1041.9028,-10361.928"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge740" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1059.5131,-8031.2164C1145.0207,-8154.5062 2244.5182,-8318.6516 2387.8271,-8274.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge778" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M911.8828,-7082.4567C922.0358,-7229.2296 1031.0329,-8766.5798 1152.5955,-8922.2164 1376.9212,-9209.4206 1556.8029,-9139.0736 1903.2231,-9252.2164 2150.2828,-9332.9074 2297.8457,-9187.3648 2474.269,-9378.2164 2552.8594,-9463.234 2422.9281,-9560.2164 2510.269,-9636.2164 2567.9056,-9686.369 2625.384,-9687.3262 2682.1736,-9636.2164 2738.8122,-9585.2425 2666.9054,-9351.5887 2718.1736,-9295.2164 2727.6215,-9284.8278 2741.8034,-9280.127 2755.5524,-9278.2504"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2756.2508,-9281.7017 2765.8964,-9277.3184 2755.6226,-9274.73 2756.2508,-9281.7017"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge823" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1059.5131,-7148.2164C1176.1517,-7152.5143 1207.7447,-7152.3179 1321.0291,-7124.2164 1337.8525,-7120.0431 1340.7648,-7115.2096 1357.0291,-7109.2164 1422.3797,-7085.1352 1462.6688,-7115.5816 1506.2007,-7061.2164 1561.2929,-6992.4138 1499.9163,-6743.5531 1542.2007,-6666.2164 1553.1912,-6646.1151 1573.5792,-6630.3126 1591.1513,-6619.5618"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1593.1344,-6622.4575 1600.0191,-6614.4044 1589.6151,-6616.4064 1593.1344,-6622.4575"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge844" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M911.48,-7082.4331C915.1706,-7195.0602 945.7981,-8133.7717 966.4307,-8894.2164 970.9674,-9061.4249 969.853,-10235.1494 1002.4307,-10399.2164 1029.8922,-10537.5177 1089.0188,-10556.9379 1116.5955,-10695.2164 1147.1807,-10848.5808 1080.2576,-11963.5681 1152.5955,-12102.2164 1195.5944,-12184.6315 1269.1381,-12149.0899 1321.0291,-12226.2164 1357.3735,-12280.2357 1305.6445,-12328.2333 1357.0291,-12368.2164 1409.3534,-12408.9307 1441.2204,-12381.3714 1506.2007,-12368.2164 1534.7595,-12362.4347 1960.5196,-12168.1703 1989.3882,-12164.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge862" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1059.5131,-7148.2164C1089.1052,-7148.8887 1523.2521,-6220.9562 1542.2007,-6198.2164 1613.0518,-6113.1895 1645.0802,-6103.7653 1740.2205,-6047.2164 1808.4561,-6006.6589 1826.0921,-5992.9729 1903.2231,-5974.2164 2026.6028,-5944.2132 2066.0302,-5991.853 2188.4692,-5958.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M921.4084,-7082.2227C944.3936,-7105.4436 1002.3708,-7156.6497 1059.5131,-7148.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge92" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-14406.2164C2829.9234,-14389.8054 2852.5115,-14410.3188 2876.0764,-14382.2164 2933.6982,-14313.4993 2974.4341,-13645.0337 2981.7667,-13516.5254"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2985.2692,-13516.5783 2982.3388,-13506.3967 2978.2803,-13516.1834 2985.2692,-13516.5783"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.507,-7082.4324C915.4631,-7195.0527 948.1757,-8133.7109 966.4307,-8894.2164 971.8654,-9120.6309 958.8896,-10709.9614 1002.4307,-10932.2164 1029.4587,-11070.1807 1089.1118,-11089.3421 1116.5955,-11227.2164 1132.7066,-11308.0394 1114.522,-12637.1251 1152.5955,-12710.2164 1195.5404,-12792.6596 1274.8696,-12753.5289 1321.0291,-12834.2164 1398.2407,-12969.1835 1289.4497,-13042.1778 1357.0291,-13182.2164 1397.3479,-13265.7655 1444.6901,-13258.7721 1506.2007,-13328.2164 1523.6472,-13347.9132 1523.7705,-13356.4367 1542.2007,-13375.2164 1606.6726,-13440.9108 1634.3185,-13444.3323 1704.2205,-13504.2164 1978.24,-13738.9652 2008.4262,-13843.5775 2301.3853,-14054.2164 2422.7799,-14141.4996 2465.8967,-14142.9326 2596.2213,-14216.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-14216.2164C2642.0036,-14241.8933 2644.0282,-14261.1575 2682.1736,-14297.2164 2733.3378,-14345.5819 2734.161,-14437.721 2797.125,-14406.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge141" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M948.7186,-7060.0861C955.4347,-7056.5965 961.7667,-7052.0678 966.4307,-7046.2164 1016.7385,-6983.0999 979.695,-6945.6609 1002.4307,-6868.2164 1041.7985,-6734.1174 1088.7091,-6712.1642 1116.5955,-6575.2164 1143.0123,-6445.4849 1108.08,-5508.9019 1152.5955,-5384.2164 1193.8822,-5268.5742 1274.017,-5278.6517 1321.0291,-5165.2164 1368.2225,-5051.3434 1320.6995,-5008.0062 1357.0291,-4890.2164 1400.3305,-4749.8219 1463.9482,-4735.9301 1506.2007,-4595.2164 1546.2171,-4461.9494 1509.4242,-4419.4461 1542.2007,-4284.2164 1560.0646,-4210.5131 1596.0767,-4127.6981 1613.4274,-4089.9578"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1616.7573,-4091.0973 1617.7958,-4080.5535 1610.4087,-4088.1483 1616.7573,-4091.0973"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge174" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M949.7589,-7060.1469C956.2224,-7056.6672 962.194,-7052.1267 966.4307,-7046.2164 1014.3021,-6979.4337 979.9951,-6757.2622 1002.4307,-6678.2164 1033.9177,-6567.2801 1088.8891,-6557.1568 1116.5955,-6445.2164 1148.9914,-6314.3288 1097.9508,-5355.4844 1152.5955,-5232.2164 1194.6882,-5137.2631 1277.4952,-5164.5176 1321.0291,-5070.2164 1376.8288,-4949.3452 1326.7475,-4601.8562 1357.0291,-4472.2164 1370.9828,-4412.4782 1403.3995,-4347.1916 1420.5371,-4315.1815"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1423.6318,-4316.8168 1425.3278,-4306.3586 1417.4801,-4313.4766 1423.6318,-4316.8168"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge160" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.5131,-6042.2164C1063.4439,-6004.9673 1102.3379,-6014.8526 1116.5955,-5980.2164 1157.9027,-5879.8674 1139.5027,-5111.9418 1152.5955,-5004.2164 1170.704,-4855.2217 1215.3737,-4679.5782 1231.168,-4620.0972"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1234.5655,-4620.94 1233.7682,-4610.3752 1227.8032,-4619.1313 1234.5655,-4620.94"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge224" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-7946.2164C1506.8636,-7906.357 1544.2887,-7978.1925 1623.2106,-7946.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-7946.2164C1943.832,-7816.3127 1976.1842,-7682.1881 2301.3853,-7564.2164 2307.8438,-7561.8734 2314.7038,-7559.8598 2321.6243,-7558.132"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2322.8059,-7561.4517 2331.7674,-7555.8001 2321.2374,-7554.6297 2322.8059,-7561.4517"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge211" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-8098.2164C2052.8025,-8088.7437 2121.5988,-8057.2639 2159.425,-8037.9163"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2161.0912,-8040.9948 2168.3524,-8033.2796 2157.8647,-8034.7827 2161.0912,-8040.9948"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-7946.2164C1704.1706,-7911.4608 1902.2501,-8111.2328 1989.3882,-8098.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge271" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M950.3357,-7060.2004C956.6639,-7056.7218 962.4384,-7052.168 966.4307,-7046.2164 1029.4801,-6952.2222 986.8832,-6140.3252 1002.4307,-6028.2164 1031.7222,-5817.0019 1089.9117,-5773.7761 1116.5955,-5562.2164 1128.3173,-5469.2807 1103.2599,-2269.8433 1152.5955,-2190.2164 1196.8647,-2118.7664 1260.4091,-2162.4408 1321.0291,-2104.2164 1344.5663,-2081.6092 1329.6266,-2057.9419 1357.0291,-2040.2164 1406.8968,-2007.9589 1572.9487,-2047.8563 1623.2106,-2016.2164"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1623.2106,-2016.2164C1654.5638,-1995.5507 1678.9271,-2019.9714 1704.2205,-1992.2164 1759.7604,-1931.2711 1686.9518,-1873.1565 1740.2205,-1810.2164 1759.7118,-1787.1861 1773.76,-1782.6674 1803.7218,-1786.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge600" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1059.5131,-8946.2164C1062.228,-8972.1967 1100.3214,-8939.7834 1116.5955,-8960.2164 1200.3644,-9065.3928 1062.2476,-11280.6344 1152.5955,-11380.2164 1205.507,-11438.5357 1427.4645,-11404.3916 1506.2007,-11403.2164 1759.3308,-11399.4382 1828.1251,-11439.7746 2075.5532,-11386.2164 2280.2685,-11341.9038 2312.7541,-11273.9288 2510.269,-11204.2164 2716.5267,-11131.4182 2764.4892,-11077.9584 2982.9529,-11067.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge317" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M950.7084,-7060.1085C956.9181,-7056.6438 962.5545,-7052.1186 966.4307,-7046.2164 1001.0791,-6993.4575 995.8092,-4836.9871 1002.4307,-4774.2164 1029.9915,-4512.942 1088.9679,-4455.4837 1116.5955,-4194.2164 1123.0256,-4133.4083 1119.3778,-2044.554 1152.5955,-1993.2164 1197.5131,-1923.7965 1249.1615,-1955.1036 1321.0291,-1914.2164 1333.9334,-1906.8747 1528.8153,-1770.6392 1542.2007,-1764.2164 1689.6342,-1693.4723 1739.8871,-1701.1354 1903.2231,-1693.2164 2414.3279,-1668.4365 2543.5821,-1690.8144 3053.8293,-1652.2164 3107.7208,-1648.1397 3126.1884,-1614.2372 3174.6229,-1638.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge348" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2982.9529,-14520.2164C3073.9262,-14416.7273 3164.2927,-12169.1999 3173.8001,-11926.4228"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3177.2988,-11926.5228 3174.1914,-11916.3939 3170.3041,-11926.2498 3177.2988,-11926.5228"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M911.5175,-7082.4321C915.5762,-7195.0501 949.0944,-8133.6894 966.4307,-8894.2164 969.4202,-9025.3642 959.9568,-11131.1009 1002.4307,-11255.2164 1029.7862,-11335.1536 1088.8065,-11327.4287 1116.5955,-11407.2164 1167.0087,-11551.9629 1067.7638,-12658.5581 1152.5955,-12786.2164 1198.0497,-12854.6179 1273.4724,-12795.2594 1321.0291,-12862.2164 1373.6064,-12936.2422 1321.5596,-13185.6334 1357.0291,-13269.2164 1396.558,-13362.3652 1448.7526,-13357.9159 1506.2007,-13441.2164 1525.3923,-13469.0444 1525.7294,-13478.6966 1542.2007,-13508.2164 1627.7826,-13661.5959 1616.2026,-13725.8415 1740.2205,-13850.2164 2095.4438,-14206.4623 2263.9564,-14203.926 2718.1736,-14420.2164 2831.7472,-14474.2982 2899.9006,-14614.6946 2982.9529,-14520.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge459" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M950.6366,-7060.0609C956.8533,-7056.6009 962.5106,-7052.0895 966.4307,-7046.2164 1002.5329,-6992.1273 998.3181,-5941.117 1002.4307,-5876.2164 1035.975,-5346.8457 1087.5065,-5217.8506 1116.5955,-4688.2164 1120.5321,-4616.5397 1115.9827,-2165.9623 1152.5955,-2104.2164 1171.7197,-2071.9641 1703.9573,-1781.7521 1740.2205,-1772.2164 1794.8103,-1757.8615 1811.9075,-1760.9786 1867.2231,-1772.2164 2072.6024,-1813.9405 2106.3671,-1879.4737 2301.3853,-1956.2164 2393.3147,-1992.392 2416.4713,-2001.2055 2510.269,-2032.2164 2525.2279,-2037.162 3042.4932,-2183.2748 3053.8293,-2194.2164 3259.6795,-2392.9016 3209.4796,-2522.5137 3259.4165,-2804.2164 3313.5053,-3109.3404 3223.9014,-3896.7004 3295.4165,-4198.2164 3306.1067,-4243.2873 3332.405,-4291.178 3348.2142,-4317.3195"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3345.2892,-4319.2445 3353.5157,-4325.921 3351.2483,-4315.5716 3345.2892,-4319.2445"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge499" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M911.4176,-7082.2774C916.1315,-7252.4209 974.1751,-9332.0506 1002.4307,-9600.2164 1033.1656,-9891.9126 1087.0079,-9958.4015 1116.5955,-10250.2164 1145.1879,-10532.2168 1090.1825,-11248.7269 1152.5955,-11525.2164 1154.1433,-11532.0733 1351.1395,-11984.3787 1357.0291,-11988.2164 1412.576,-12024.4108 1449.1907,-12022.0594 1506.2007,-11988.2164 1534.9327,-11971.1601 1516.2139,-11943.2195 1542.2007,-11922.2164 1600.6108,-11875.0079 1633.2835,-11898.8805 1704.2205,-11874.2164 2013.3879,-11766.7219 2097.8723,-11752.0906 2387.8271,-11600.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge530" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1059.5131,-10709.2164C1061.3863,-10735.271 1100.2325,-10702.8545 1116.5955,-10723.2164 1169.7156,-10789.3187 1133.0801,-12166.6911 1152.5955,-12249.2164 1192.9694,-12419.9471 1258.7694,-12442.1957 1321.0291,-12606.2164 1341.2429,-12659.469 1331.5371,-12678.2791 1357.0291,-12729.2164 1357.9885,-12731.1335 1540.4637,-12974.9599 1542.2007,-12976.2164 1896.3829,-13232.4115 2065.7812,-13134.5929 2474.269,-13290.2164 2529.3311,-13311.1936 2552.5573,-13381.7806 2596.2213,-13342.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge560" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M911.5215,-7082.432C915.6193,-7195.0491 949.4451,-8133.6815 966.4307,-8894.2164 991.3713,-10010.9414 937.0304,-10292.1291 1002.4307,-11407.2164 1040.4939,-12056.2026 1001.907,-12229.8201 1152.5955,-12862.2164 1295.2613,-13460.9441 1372.14,-13622.916 1740.2205,-14116.2164 1907.5397,-14340.4572 2048.4914,-14315.9646 2188.4692,-14558.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge569" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1431.6149,-7946.2164C1677.9379,-7815.7387 1585.214,-7631.8895 1740.2205,-7400.2164 1791.0957,-7324.1781 1826.3822,-7320.0829 1867.2231,-7238.2164 1894.9435,-7182.6504 1857.1843,-7144.8868 1903.2231,-7103.2164 1931.9881,-7077.1809 1956.9994,-7110.576 1989.3882,-7089.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1059.5131,-8031.2164C1163.3085,-8165.3944 1279.5756,-8021.4579 1431.6149,-7946.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M911.5135,-7082.3414C915.1635,-7178.2799 945.1405,-7866.3073 1059.5131,-8031.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge425" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-2780.2164C2862.2897,-2833.2428 2930.2863,-2942.677 3053.8293,-3184.2164 3091.0451,-3256.9769 3080.0619,-3469.0763 3089.8293,-3550.2164 3116.9292,-3775.34 3159.1217,-4047.0114 3171.2554,-4123.9816"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3167.8041,-4124.5653 3172.8221,-4133.8964 3174.7183,-4123.4726 3167.8041,-4124.5653"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M950.323,-7060.1918C956.6524,-7056.714 962.4305,-7052.1627 966.4307,-7046.2164 1025.2041,-6958.8471 960.2591,-6195.701 1002.4307,-6099.2164 1016.7895,-6066.3646 1055.7505,-6077.871 1059.5131,-6042.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-6042.2164C1070.7021,-5936.1872 1103.2822,-5914.9998 1116.5955,-5809.2164 1122.756,-5760.2666 1120.7529,-2294.9003 1152.5955,-2257.2164 1255.8847,-2134.9794 1708.5676,-2147.2646 1867.2231,-2168.2164 1962.2758,-2180.7689 2013.7344,-2150.9292 2075.5532,-2224.2164 2130.9572,-2289.8986 2054.4997,-2544.9618 2111.5532,-2609.2164 2138.9238,-2640.0416 2436.8273,-2669.9693 2474.269,-2687.2164 2536.1795,-2715.7347 2533.0786,-2754.5416 2596.2213,-2780.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge396" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M945.6043,-7060.0752C953.0981,-7056.5054 960.5361,-7051.9463 966.4307,-7046.2164 992.6562,-7020.7233 981.5168,-7002.2212 1002.4307,-6972.2164 1044.3406,-6912.0888 1088.1455,-6920.7617 1116.5955,-6853.2164 1211.7909,-6627.2047 1077.4635,-5983.6658 1152.5955,-5750.2164 1163.4111,-5716.6101 1494.4868,-5255.5202 1506.2007,-5222.2164 1536.9886,-5134.6831 1483.5274,-4878.1012 1542.2007,-4806.2164 1589.6897,-4748.0342 1654.9521,-4814.8997 1704.2205,-4758.2164 1775.2667,-4676.4776 1686.069,-4611.0055 1740.2205,-4517.2164 1776.281,-4454.7603 1830.8174,-4478.4719 1867.2231,-4416.2164 1918.1239,-4329.1737 1834.4728,-4265.9775 1903.2231,-4192.2164 1957.1388,-4134.3712 2549.5944,-3966.3501 2596.2213,-4030.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge380" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M946.9509,-7060.1277C954.1227,-7056.5949 961.0844,-7052.0385 966.4307,-7046.2164 998.9463,-7010.8067 982.8445,-6988.1196 1002.4307,-6944.2164 1045.5531,-6847.5554 1089.0086,-6837.4017 1116.5955,-6735.2164 1135.6147,-6664.7667 1107.8382,-5479.8504 1152.5955,-5422.2164 1200.3384,-5360.7376 1266.801,-5430.0587 1321.0291,-5374.2164 1366.3871,-5327.5081 1312.4643,-5279.6821 1357.0291,-5232.2164 1404.7003,-5181.4418 1462.7355,-5238.6349 1506.2007,-5184.2164 1562.728,-5113.4441 1488.578,-4851.214 1542.2007,-4778.2164 1588.3324,-4715.4163 1656.155,-4772.549 1704.2205,-4711.2164 1769.9389,-4627.3582 1694.9865,-4570.6788 1740.2205,-4474.2164 1776.3096,-4397.2554 1830.1183,-4407.6928 1867.2231,-4331.2164 1906.839,-4249.5645 1844.8191,-4199.6816 1903.2231,-4130.2164 1966.65,-4054.777 2018.1884,-4085.7929 2111.5532,-4054.2164 2145.476,-4042.7435 2166.5331,-4058.5217 2188.4692,-4030.2164"/>
</g>
<!-- sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge489" class="edge">
<title>sourcefile~dataenvironment.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M911.5033,-7082.4325C915.4227,-7195.0537 947.8474,-8133.7188 966.4307,-8894.2164 969.068,-9002.1471 968.8581,-10734.606 1002.4307,-10837.2164 1029.8211,-10920.932 1089.059,-10915.5487 1116.5955,-10999.2164 1173.402,-11171.8194 1068.83,-12472.9646 1152.5955,-12634.2164 1195.4474,-12716.708 1274.1311,-12677.9559 1321.0291,-12758.2164 1387.6663,-12872.2585 1309.8,-12929.8651 1357.0291,-13053.2164 1408.4055,-13187.3995 1434.6013,-13222.9954 1542.2007,-13318.2164 1603.2517,-13372.244 1635.7843,-13359.914 1704.2205,-13404.2164 1721.2361,-13415.2315 1722.542,-13422.3 1740.2205,-13432.2164 1766.5346,-13446.9768 1773.8437,-13460.4122 1803.7218,-13456.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge904" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1062.5156,-6130.2754C1072.642,-6168.205 1105.5223,-6296.6675 1116.5955,-6405.2164 1180.8365,-7034.9608 1092.8666,-11472.0279 1152.5955,-12102.2164 1242.5354,-13051.157 1367.8781,-13274.099 1542.2007,-14211.2164 1613.7316,-14595.75 1656.1323,-14688.0536 1704.2205,-15076.2164 1720.261,-15205.6943 1695.5433,-15539.6367 1740.2205,-15662.2164 1823.5104,-15890.7371 1917.9511,-15916.9848 2111.5532,-16064.2164 2575.1836,-16416.8003 2778.3779,-16460.2164 3360.8456,-16460.2164 3360.8456,-16460.2164 3360.8456,-16460.2164 3525.3633,-16460.2164 3612.5887,-16460.2164 3637.3413,-16426.3348 3694.2327,-16360.2164 3763.9793,-16279.1577 3677.6461,-16138.6069 3784.5721,-16137.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge105" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1100.0216,-6130.3313C1106.4633,-6133.7953 1112.3815,-6138.3184 1116.5955,-6144.2164 1172.8553,-6222.9587 1124.5198,-6485.6027 1152.5955,-6578.2164 1179.7915,-6667.9283 1291.3098,-6880.367 1357.0291,-6947.2164 1410.6788,-7001.7887 1445.6646,-6986.3996 1506.2007,-7033.2164 1687.1928,-7173.1903 1750.245,-7203.5772 1867.2231,-7400.2164 1895.256,-7447.3394 1867.3171,-7476.7775 1903.2231,-7518.2164 2144.6306,-7796.8226 2372.5379,-8003.2782 2682.1736,-7803.2164 2907.7185,-7657.4873 2714.4813,-7284.7399 2982.9529,-7279.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge117" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1236.8123,-5056.2164C1246.817,-5018.6043 1293.915,-5060.1375 1321.0291,-5032.2164 1366.3871,-4985.5081 1334.2012,-4951.191 1357.0291,-4890.2164 1408.5419,-4752.6226 1463.1549,-4735.6894 1506.2007,-4595.2164 1524.7748,-4534.6027 1498.3839,-4358.0323 1542.2007,-4312.2164 1567.4545,-4285.8104 1604.1312,-4329.3774 1623.2106,-4298.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge196" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1096.4781,-6108.1738C1104.3514,-6104.0969 1111.7449,-6098.5954 1116.5955,-6091.2164 1207.6408,-5952.7123 1074.2629,-5492.2871 1152.5955,-5346.2164 1196.5272,-5264.2947 1259.8902,-5292.2393 1321.0291,-5222.2164 1343.0051,-5197.047 1333.6831,-5180.1206 1357.0291,-5156.2164 1410.499,-5101.4679 1447.0398,-5118.7594 1506.2007,-5070.2164 1609.4412,-4985.5049 1627.7789,-4953.7213 1704.2205,-4844.2164 1723.3461,-4816.8183 1717.9402,-4803.1169 1740.2205,-4778.2164 1799.1698,-4712.3343 1818.9022,-4690.7768 1903.2231,-4664.2164 1981.7972,-4639.4662 2221.1009,-4683.0063 2331.2469,-4705.2876"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2330.6789,-4708.7437 2341.1763,-4707.3095 2332.0757,-4701.8845 2330.6789,-4708.7437"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge250" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1062.5119,-6130.2758C1072.6262,-6168.2066 1105.4725,-6296.6726 1116.5955,-6405.2164 1144.7715,-6680.1726 1103.9188,-11108.1403 1152.5955,-11380.2164 1191.3797,-11596.999 1269.5317,-11632.0973 1321.0291,-11846.2164 1350.9872,-11970.7786 1304.1912,-12015.5056 1357.0291,-12132.2164 1363.427,-12146.3484 1531.3705,-12330.1099 1542.2007,-12341.2164 1610.9216,-12411.6905 1636.0795,-12421.1814 1704.2205,-12492.2164 1721.2398,-12509.9586 1724.192,-12515.5741 1740.2205,-12534.2164 1812.5379,-12618.3268 1819.5133,-12650.4356 1903.2231,-12723.2164 1971.9751,-12782.9921 2022.3644,-12760.2506 2075.5532,-12834.2164 2113.5646,-12887.076 2081.8263,-12918.2912 2111.5532,-12976.2164 2198.5772,-13145.7893 2221.0373,-13211.9704 2387.8271,-13304.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge780" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1069.6409,-6130.2708C1083.2046,-6145.8594 1106.707,-6175.8087 1116.5955,-6206.2164 1167.9915,-6364.2621 1095.7905,-6797.0332 1152.5955,-6953.2164 1197.4702,-7076.5978 1815.3016,-7773.6309 1867.2231,-7894.2164 1906.0593,-7984.4118 1871.1627,-8019.3962 1903.2231,-8112.2164 1966.1043,-8294.2673 1999.7344,-8335.3944 2111.5532,-8492.2164 2294.9711,-8749.4534 2335.0219,-8834.4866 2596.2213,-9012.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2596.2213,-9012.2164C2679.6308,-9077.0319 2648.676,-9136.6659 2718.1736,-9216.2164 2733.7488,-9234.0445 2754.8527,-9250.5893 2771.323,-9262.2464"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2769.7156,-9265.3901 2779.9319,-9268.1969 2773.6957,-9259.6317 2769.7156,-9265.3901"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge142" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-5056.2164C1247.0453,-5018.6658 1295.9385,-5061.9691 1321.0291,-5032.2164 1368.8703,-4975.4857 1332.7052,-4770.3271 1357.0291,-4700.2164 1397.947,-4582.2751 1459.929,-4578.1619 1506.2007,-4462.2164 1536.1173,-4387.2526 1519.8993,-4361.7871 1542.2007,-4284.2164 1563.1549,-4211.3314 1597.6671,-4128.1193 1614.0413,-4090.1204"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1617.3818,-4091.2147 1618.1524,-4080.6479 1610.9604,-4088.4278 1617.3818,-4091.2147"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge176" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1100.5318,-6108.1005C1106.8391,-6104.6412 1112.5788,-6100.12 1116.5955,-6094.2164 1177.6393,-6004.4954 1101.8567,-5214.1422 1152.5955,-5118.2164 1174.3272,-5077.1308 1224.5918,-5101.06 1236.8123,-5056.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-5056.2164C1247.0453,-5018.6658 1296.5962,-5062.5115 1321.0291,-5032.2164 1360.171,-4983.6828 1342.7233,-4532.9037 1357.0291,-4472.2164 1371.1044,-4412.5067 1403.4679,-4347.2077 1420.566,-4315.1883"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1423.661,-4316.8228 1425.345,-4306.3627 1417.5055,-4313.4896 1423.661,-4316.8228"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge158" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1074.3519,-6108.0889C1088.1433,-6096.7604 1107.8335,-6077.8276 1116.5955,-6056.2164 1160.5397,-5947.8286 1138.6391,-5120.338 1152.5955,-5004.2164 1170.5057,-4855.1978 1215.3009,-4679.5694 1231.1479,-4620.0948"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1234.5451,-4620.9394 1233.7571,-4610.3739 1227.7844,-4619.1247 1234.5451,-4620.9394"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge225" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-6933.2164C1679.3328,-6960.278 1721.9126,-7083.7779 1867.2231,-7286.2164 1894.0379,-7323.5732 1878.5977,-7344.3814 1903.2231,-7383.2164 1932.5362,-7429.4438 1952.1064,-7431.1378 1989.3882,-7471.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge209" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.2618,-6130.3809C1087.9864,-6141.7368 1107.6287,-6160.6894 1116.5955,-6182.2164 1174.4399,-6321.0859 1090.0154,-6721.4156 1152.5955,-6858.2164 1195.8026,-6952.6678 1249.2705,-6945.1255 1321.0291,-7020.2164 1337.7828,-7037.7481 1340.6692,-7043.3165 1357.0291,-7061.2164 1594.3239,-7320.8493 1727.5668,-7343.3941 1867.2231,-7666.2164 1896.3358,-7733.5116 1852.7328,-7774.0476 1903.2231,-7827.2164 1930.5975,-7856.0429 1961.0449,-7823.3419 1989.3882,-7851.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-7851.2164C2017.8153,-7880.7724 2047.2419,-7854.5493 2075.5532,-7884.2164 2110.7754,-7921.1252 2076.2352,-7956.3992 2111.5532,-7993.2164 2116.7831,-7998.6682 2123.139,-8003.1054 2129.9317,-8006.7144"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2128.859,-8010.0764 2139.4003,-8011.14 2131.823,-8003.7349 2128.859,-8010.0764"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge272" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1074.4696,-6108.1357C1088.3482,-6096.842 1108.1012,-6077.9342 1116.5955,-6056.2164 1154.9447,-5958.1667 1097.1975,-2355.7456 1152.5955,-2266.2164 1196.8227,-2194.7404 1248.6789,-2222.9987 1321.0291,-2180.2164 1423.2654,-2119.7616 1432.0569,-2074.6618 1542.2007,-2030.2164 1576.0842,-2016.5437 1593.9363,-2038.0808 1623.2106,-2016.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge602" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1236.8123,-11366.2164C1269.9896,-11385.4921 1284.115,-11357.6873 1321.0291,-11347.2164 1584.24,-11272.5551 1640.2965,-11222.8729 1903.2231,-11147.2164 2365.6547,-11014.1528 2507.0758,-10995.8726 2982.9529,-11067.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2982.9529,-11067.2164C3150.8105,-11072.8556 3239.8783,-10950.7051 3360.8456,-11067.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1062.5117,-6130.2758C1072.6254,-6168.2067 1105.4699,-6296.6729 1116.5955,-6405.2164 1123.5944,-6473.4993 1109.5365,-11293.761 1152.5955,-11347.2164 1176.6656,-11377.0981 1208.1891,-11340.6624 1236.8123,-11366.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge318" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-1866.2164C3079.8042,-1915.6163 3065.9268,-2020.597 3174.6229,-2018.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1074.4706,-6108.1362C1088.35,-6096.8428 1108.1036,-6077.9351 1116.5955,-6056.2164 1155.8443,-5955.8342 1103.851,-2272.3466 1152.5955,-2176.2164 1221.7897,-2039.7567 1584.1172,-1859.0019 1704.2205,-1764.2164 1720.5696,-1751.3136 1720.6371,-1741.3065 1740.2205,-1734.2164 2001.3492,-1639.6747 2735.5594,-1740.0309 2982.9529,-1866.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3174.6229,-2018.2164C3257.3687,-2016.4041 3327.2619,-1942.5706 3360.8456,-2018.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge349" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2797.125,-14026.2164C2830.1869,-14010.343 2853.3034,-14030.9643 2876.0764,-14002.2164 2953.5086,-13904.4683 2836.1879,-13541.1676 2912.0764,-13442.2164 2932.3157,-13415.8263 2958.8055,-13441.085 2982.9529,-13418.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1062.5133,-6130.2756C1072.6321,-6168.206 1105.4911,-6296.6707 1116.5955,-6405.2164 1146.1209,-6693.8281 1095.3068,-11342.8109 1152.5955,-11627.2164 1191.4152,-11819.9341 1265.367,-11847.6724 1321.0291,-12036.2164 1345.8588,-12120.322 1310.4886,-12155.891 1357.0291,-12230.2164 1400.7465,-12300.0333 1455.8284,-12275.0378 1506.2007,-12340.2164 1532.5449,-12374.3042 1513.7247,-12397.8881 1542.2007,-12430.2164 1596.6477,-12492.0289 1651.3423,-12457.0566 1704.2205,-12520.2164 1735.8894,-12558.043 1717.7679,-12581.2885 1740.2205,-12625.2164 1857.8317,-12855.3195 1944.3414,-12877.5882 2075.5532,-13100.2164 2192.6152,-13298.8364 2169.8357,-13377.8803 2301.3853,-13567.2164 2454.1619,-13787.1042 2490.04,-13862.0507 2718.1736,-14002.2164 2749.4218,-14021.4153 2764.0631,-14042.0898 2797.125,-14026.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge457" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1431.6149,-5170.2164C1623.301,-5140.6808 1673.6229,-5184.6039 1867.2231,-5196.2164 2044.1872,-5206.831 2088.4348,-5209.3771 2265.3853,-5220.2164 2358.2281,-5225.9036 2382.9101,-5215.7327 2474.269,-5233.2164 2554.6811,-5248.6051 3106.845,-5508.1411 3174.6229,-5462.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge501" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1236.8123,-11366.2164C1318.4512,-11411.2168 1982.38,-11389.1661 2075.5532,-11386.2164 2223.8371,-11381.522 2395.5192,-11369.3253 2499.9537,-11361.1484"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2500.465,-11364.6191 2510.1596,-11360.3454 2499.9158,-11357.6407 2500.465,-11364.6191"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge558" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1236.8123,-12050.2164C1244.5262,-12088.3642 1295.9385,-12044.4637 1321.0291,-12074.2164 1368.8703,-12130.9471 1320.5985,-12341.5636 1357.0291,-12406.2164 1397.9917,-12478.9121 1464.2781,-12448.07 1506.2007,-12520.2164 1566.1387,-12623.3664 1480.2429,-12684.2668 1542.2007,-12786.2164 1587.9277,-12861.4588 1654.8616,-12827.3049 1704.2205,-12900.2164 1743.1393,-12957.7062 1705.16,-12992.2954 1740.2205,-13052.2164 1842.5686,-13227.1371 1986.864,-13178.9895 2075.5532,-13361.2164 2163.5505,-13542.0214 2044.3593,-13622.6934 2111.5532,-13812.2164 2151.9104,-13926.0453 2209.9467,-13928.921 2265.3853,-14036.2164 2286.6852,-14077.4401 2281.538,-14092.2739 2301.3853,-14134.2164 2393.9601,-14329.8512 2538.336,-14549.2952 2582.7599,-14615.3706"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2580.0773,-14617.6525 2588.571,-14623.9855 2585.8805,-14613.738 2580.0773,-14617.6525"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1062.5145,-6130.2755C1072.6375,-6168.2054 1105.508,-6296.669 1116.5955,-6405.2164 1147.4703,-6707.4835 1084.3795,-11578.1331 1152.5955,-11874.2164 1172.0644,-11958.7188 1218.9913,-11965.3511 1236.8123,-12050.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge570" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1099.0628,-6130.3074C1105.7611,-6133.7852 1112.0179,-6138.3195 1116.5955,-6144.2164 1177.3497,-6222.4814 1122.4599,-6269.8324 1152.5955,-6364.2164 1174.0126,-6431.2946 1361.5097,-6926.6251 1431.6149,-6933.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1989.3882,-6937.2164C2076.2825,-6953.8949 2117.2089,-6884.7687 2188.4692,-6937.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1431.6149,-6933.2164C1465.0343,-6943.0037 1480.7852,-6933.0219 1506.2007,-6909.2164 1537.9448,-6879.4832 1506.2308,-6842.6688 1542.2007,-6818.2164 1712.2875,-6702.5907 1787.4084,-6898.4483 1989.3882,-6937.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge427" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.4678,-6108.135C1088.345,-6096.8408 1108.097,-6077.9325 1116.5955,-6056.2164 1153.4755,-5961.9764 1095.0139,-2496.437 1152.5955,-2413.2164 1311.9906,-2182.8479 1464.8672,-2236.7632 1740.2205,-2185.2164 1795.7023,-2174.83 1815.5164,-2162.5775 1867.2231,-2185.2164 1888.8318,-2194.6773 1884.0295,-2210.5033 1903.2231,-2224.2164 1971.334,-2272.879 2026.226,-2232.5853 2075.5532,-2300.2164 2165.6176,-2423.7008 2014.6653,-2524.0101 2111.5532,-2642.2164 2134.2541,-2669.9121 2162.6387,-2641.4138 2188.4692,-2666.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-2666.2164C2213.3323,-2690.4888 2231.6083,-2672.0654 2265.3853,-2680.2164 2414.7074,-2716.2503 2443.9796,-2759.7713 2596.2213,-2780.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge398" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-4908.2164C2631.3551,-4924.4537 2647.1344,-4905.7759 2682.1736,-4922.2164 2743.4769,-4950.9801 2730.6028,-5009.5577 2797.125,-5022.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-5170.2164C1469.9397,-5165.8185 1683.4025,-4987.6932 1704.2205,-4955.2164 1740.9861,-4897.8607 1698.0525,-4859.7257 1740.2205,-4806.2164 1779.4676,-4756.4134 1816.7141,-4779.5506 1867.2231,-4741.2164 1886.0133,-4726.9554 1881.6145,-4711.6773 1903.2231,-4702.2164 1973.3841,-4671.4977 1999.3191,-4694.8296 2075.5532,-4702.2164 2120.4843,-4706.57 2434.6837,-4758.5194 2474.269,-4780.2164 2543.1731,-4817.9831 2524.8948,-4875.2523 2596.2213,-4908.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1096.4683,-6108.1673C1104.3419,-6104.0906 1111.7379,-6098.5908 1116.5955,-6091.2164 1204.3526,-5957.988 1062.7069,-5506.016 1152.5955,-5374.2164 1198.8695,-5306.3667 1266.4813,-5359.6119 1321.0291,-5298.2164 1356.3192,-5258.4959 1317.2672,-5219.4599 1357.0291,-5184.2164 1382.2694,-5161.8442 1398.4714,-5176.4693 1431.6149,-5170.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge378" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1096.5152,-6108.198C1104.3874,-6104.1204 1111.771,-6098.6125 1116.5955,-6091.2164 1169.6355,-6009.9037 1104.6322,-5302.6233 1152.5955,-5218.2164 1196.7679,-5140.4806 1254.6191,-5168.081 1321.0291,-5108.2164 1327.0892,-5102.7535 1502.5282,-4887.502 1506.2007,-4880.2164 1535.1193,-4822.8464 1502.4431,-4790.6836 1542.2007,-4740.2164 1592.6503,-4676.177 1657.4336,-4720.9786 1704.2205,-4654.2164 1770.1601,-4560.1241 1695.2342,-4503.9406 1740.2205,-4398.2164 1776.0413,-4314.0322 1830.458,-4319.9925 1867.2231,-4236.2164 1907.0384,-4145.4902 1827.719,-4080.3695 1903.2231,-4016.2164 1961.5906,-3966.6236 1999.1077,-4011.4954 2075.5532,-4016.2164 2126.0262,-4019.3334 2157.4378,-4070.1449 2188.4692,-4030.2164"/>
</g>
<!-- sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge487" class="edge">
<title>sourcefile~dataheatbalance.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1236.8123,-12050.2164C1244.6493,-12088.3391 1296.3495,-12044.1219 1321.0291,-12074.2164 1384.081,-12151.1024 1317.178,-12429.118 1357.0291,-12520.2164 1396.2554,-12609.8868 1463.2826,-12594.2531 1506.2007,-12682.2164 1549.2618,-12770.4728 1506.6436,-12808.6787 1542.2007,-12900.2164 1600.5857,-13050.5219 1628.5223,-13087.9233 1740.2205,-13204.2164 1808.9376,-13275.7604 1910.1722,-13337.2055 1959.7833,-13365.1469"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1958.2714,-13368.3112 1968.7097,-13370.1255 1961.6811,-13362.1977 1958.2714,-13368.3112"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge905" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1436.1401,-11720.4747C1449.9017,-11755.3567 1491.2226,-11865.013 1506.2007,-11960.2164 1559.678,-12300.1284 1518.084,-13164.9695 1542.2007,-13508.2164 1585.4212,-14123.3631 1651.671,-14271.7963 1704.2205,-14886.2164 1716.9454,-15034.9988 1680.2311,-15420.4706 1740.2205,-15557.2164 1811.948,-15720.7194 2145.4026,-16045.3401 2301.3853,-16132.2164 2762.8015,-16389.2071 2936.6332,-16334.7362 3462.2747,-16386.2164 3518.0864,-16391.6825 3534.2129,-16400.4629 3588.4519,-16386.2164 3623.4414,-16377.026 3625.9114,-16360.0405 3659.3423,-16346.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge42" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-11594.2164C1653.6763,-11560.6386 1673.4575,-11565.522 1704.2205,-11532.2164 2015.9128,-11194.7612 2107.8951,-11095.7543 2265.3853,-10664.2164 2332.2629,-10480.9653 2377.9904,-9843.4773 2386.4206,-9718.5499"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2389.9257,-9718.589 2387.1005,-9708.3778 2382.9413,-9718.1221 2389.9257,-9718.589"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge64" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1989.3882,-11676.2164C2154.9572,-11613.4019 2226.3704,-11748.952 2387.8271,-11676.2164"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M2387.8271,-11676.2164C2460.1694,-11643.324 2536.8802,-11588.4373 2573.797,-11560.5783"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2576.0464,-11563.2648 2581.8857,-11554.4244 2571.8079,-11557.6938 2576.0464,-11563.2648"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge98" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1989.3882,-11676.2164C2021.514,-11664.1089 2862.3994,-10846.706 2876.0764,-10815.2164 2958.2024,-10626.1315 2825.0619,-9147.1021 2912.0764,-8960.2164 2947.4074,-8884.3341 3016.3791,-8911.0754 3053.8293,-8836.2164 3127.5659,-8688.8246 3168.4629,-7442.6114 3173.9791,-7263.5991"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3177.4844,-7263.4763 3174.2913,-7253.3742 3170.4877,-7263.2627 3177.4844,-7263.4763"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1440.7963,-11720.4898C1458.0984,-11740.7289 1497.8062,-11782.5707 1542.2007,-11798.2164 1610.1153,-11822.1511 1633.6777,-11812.6724 1704.2205,-11798.2164 1839.2668,-11770.5419 1861.51,-11727.6998 1989.3882,-11676.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge251" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1439.4993,-11720.4895C1464.0835,-11755.1776 1542.5343,-11862.4296 1623.2106,-11936.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1803.7218,-11898.2164C2245.2074,-11913.252 2359.5968,-11805.3502 2797.125,-11866.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1623.2106,-11936.2164C1683.7088,-11991.5482 1721.7708,-11895.8356 1803.7218,-11898.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge641" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M1436.0457,-11720.4901C1449.5355,-11755.4164 1490.1572,-11865.1868 1506.2007,-11960.2164 1564.5631,-12305.912 1520.7138,-12398.2879 1542.2007,-12748.2164 1599.573,-13682.5636 1641.8441,-13914.1898 1704.2205,-14848.2164 1708.9516,-14919.0602 1699.4517,-15428.086 1740.2205,-15486.2164 1910.209,-15728.5953 2686.9062,-15966.2164 2982.9529,-15966.2164 2982.9529,-15966.2164 2982.9529,-15966.2164 3360.8456,-15966.2164 3395.07,-15966.2164 3645.7218,-15921.6137 3659.3423,-15890.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge676" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M1432.7158,-11698.1348C1440.2504,-11622.8712 1485.6012,-11178.9408 1542.2007,-10820.2164 1601.8659,-10442.0612 1653.9346,-10353.7326 1704.2205,-9974.2164 1732.5538,-9760.38 1721.1053,-9705.0731 1740.2205,-9490.2164 1788.7652,-8944.5668 1831.6239,-8810.8632 1867.2231,-8264.2164 1905.9683,-7669.2619 1845.1787,-7516.5989 1903.2231,-6923.2164 1947.7695,-6467.8231 2018.7142,-6362.2392 2075.5532,-5908.2164 2100.1464,-5711.7689 2054.3411,-5653.7506 2111.5532,-5464.2164 2125.4557,-5418.1598 2156.123,-5370.3324 2174.254,-5344.5306"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2177.1259,-5346.5317 2180.0963,-5336.3617 2171.4321,-5342.4595 2177.1259,-5346.5317"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge742" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1475.2277,-11698.1439C1530.8446,-11682.9098 1628.8357,-11652.2742 1704.2205,-11608.2164 1846.2562,-11525.2051 1874.2159,-11489.6913 1989.3882,-11372.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1989.3882,-11372.2164C2126.142,-11239.316 2403.1469,-10841.1507 2474.269,-10664.2164 2745.911,-9988.4386 2792.6935,-7499.8621 2796.8037,-7244.4262"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2800.3061,-7244.2996 2796.9637,-7234.2458 2793.3069,-7244.1895 2800.3061,-7244.2996"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge781" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1989.3882,-11372.2164C2017.2185,-11343.8297 2044.432,-11372.9509 2075.5532,-11348.2164 2101.7111,-11327.4267 2085.7187,-11303.4065 2111.5532,-11282.2164 2139.2412,-11259.506 2158.5184,-11277.8462 2188.4692,-11258.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge817" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1432.9531,-11698.1733C1441.5435,-11626.7197 1489.1176,-11222.328 1506.2007,-10891.2164 1573.9663,-9577.7549 1494.1761,-9246.5477 1542.2007,-7932.2164 1561.6404,-7400.1926 1611.6691,-6749.7881 1621.5142,-6624.6078"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1625.019,-6624.6836 1622.3166,-6614.4392 1618.0407,-6624.1329 1625.019,-6624.6836"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge835" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1803.7218,-11898.2164C1993.8446,-11899.3971 2008.8871,-12147.6529 2188.4692,-12085.2164"/>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M2188.4692,-12085.2164C2225.0928,-12071.3398 2234.8243,-12066.7087 2265.3853,-12042.2164 2310.3077,-12006.2144 2352.7425,-11952.8881 2373.8723,-11924.5549"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2376.8488,-11926.4154 2379.9601,-11916.2877 2371.2122,-11922.2647 2376.8488,-11926.4154"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge864" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1436.5365,-11697.9584C1466.7309,-11628.397 1628.1226,-11249.413 1704.2205,-10924.2164 1836.0945,-10360.6662 1826.6829,-10209.569 1867.2231,-9632.2164 1876.7503,-9496.5357 1860.2175,-7313.2532 1903.2231,-7184.2164 1944.4015,-7060.6621 2028.8108,-7068.7748 2075.5532,-6947.2164 2102.8222,-6876.3006 2059.8683,-6662.9058 2111.5532,-6607.2164 2135.19,-6581.7482 2175.2406,-6625.3462 2188.4692,-6593.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge82" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-11936.2164C1656.6668,-11966.8155 1673.1074,-11965.2375 1704.2205,-11998.2164 1812.4981,-12112.9872 1800.8928,-12172.1126 1903.2231,-12292.2164 1971.3975,-12372.2317 2026.0835,-12361.4643 2075.5532,-12454.2164 2121.7669,-12540.8637 2072.4403,-12582.1406 2111.5532,-12672.2164 2156.2184,-12775.0788 2205.6249,-12777.3251 2265.3853,-12872.2164 2393.856,-13076.2105 2381.0071,-13152.7227 2510.269,-13356.2164 2590.7228,-13482.8726 2583.3043,-13556.4523 2718.1736,-13622.2164 2781.253,-13652.9748 2812.4514,-13651.8297 2876.0764,-13622.2164 2923.4909,-13600.148 2957.3921,-13545.5425 2973.1105,-13515.6235"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2976.333,-13517.0075 2977.7373,-13506.5061 2970.0908,-13513.8397 2976.333,-13517.0075"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge136" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.9813,-11698.1747C1441.7477,-11626.7299 1490.2297,-11222.3835 1506.2007,-10891.2164 1515.0414,-10707.8989 1508.8209,-4464.6859 1542.2007,-4284.2164 1555.9937,-4209.644 1593.9816,-4127.2508 1612.6188,-4089.7852"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1615.9472,-4090.9579 1617.3261,-4080.4532 1609.6973,-4087.8053 1615.9472,-4090.9579"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge226" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1472.9109,-11698.1279C1484.0364,-11694.4096 1495.85,-11689.767 1506.2007,-11684.2164 1524.0641,-11674.637 1526.1523,-11668.5983 1542.2007,-11656.2164 1578.0974,-11628.5207 1591.8821,-11626.9906 1623.2106,-11594.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-11594.2164C1654.5391,-11561.4421 1680.2949,-11570.7286 1704.2205,-11532.2164 1747.963,-11461.8054 1716.776,-11428.724 1740.2205,-11349.2164 1849.8348,-10977.4786 1810.9071,-10804.7898 2111.5532,-10560.2164 2167.0104,-10515.1024 2222.3985,-10570.3383 2265.3853,-10513.2164 2303.0214,-10463.2044 2297.1076,-8322.6613 2301.3853,-8260.2164 2320.158,-7986.1756 2370.7634,-7655.7362 2384.4017,-7569.5794"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2387.8938,-7569.9049 2386.0089,-7559.4791 2380.9808,-7568.8048 2387.8938,-7569.9049"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge273" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2188.4692,-2398.2164C2214.2378,-2376.248 2422.4466,-2346.0511 2530.9567,-2331.5933"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2531.6835,-2335.0277 2541.1369,-2330.2441 2530.7637,-2328.0883 2531.6835,-2335.0277"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1432.9691,-11698.1742C1441.6593,-11626.7256 1489.7483,-11222.3599 1506.2007,-10891.2164 1518.0774,-10652.1695 1502.7983,-6819.2924 1542.2007,-6583.2164 1579.6149,-6359.0521 1663.0808,-6321.727 1704.2205,-6098.2164 1773.7927,-5720.2326 1708.8532,-5617.2674 1740.2205,-5234.2164 1788.8969,-4639.7898 1769.8008,-4483.5174 1903.2231,-3902.2164 1956.1817,-3671.4836 2032.2604,-3630.9564 2075.5532,-3398.2164 2094.6271,-3295.6763 2064.7495,-2553.4241 2111.5532,-2460.2164 2131.2568,-2420.9775 2158.4933,-2430.3 2188.4692,-2398.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge605" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1433.9883,-11720.2425C1442.44,-11757.1745 1474.2658,-11878.238 1542.2007,-11950.2164 1598.1577,-12009.5039 1652.5793,-11973.1339 1704.2205,-12036.2164 1739.7615,-12079.6317 1715.6711,-12106.7646 1740.2205,-12157.2164 1795.0404,-12269.8775 1816.4524,-12296.8361 1903.2231,-12387.2164 1970.227,-12457.0075 2027.1442,-12436.4495 2075.5532,-12520.2164 2135.246,-12623.5085 2063.6961,-12676.936 2111.5532,-12786.2164 2154.587,-12884.4828 2223.8722,-12873.2979 2265.3853,-12972.2164 2295.2998,-13043.4976 2255.9797,-13255.6525 2301.3853,-13318.2164 2482.9192,-13568.3505 2677.6261,-13504.1457 2982.9529,-13456.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge319" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1432.8668,-11698.1684C1440.9163,-11626.6841 1485.7016,-11222.1341 1506.2007,-10891.2164 1536.3613,-10404.3316 1503.1706,-10280.4705 1542.2007,-9794.2164 1587.5513,-9229.2187 1662.4093,-9094.487 1704.2205,-8529.2164 1762.4249,-7742.3149 1680.3852,-7540.9955 1740.2205,-6754.2164 1772.8573,-6325.0714 1833.8297,-6223.3031 1867.2231,-5794.2164 1893.3007,-5459.1343 1837.8071,-4611.884 1903.2231,-4282.2164 1944.6648,-4073.369 2033.6289,-4043.9674 2075.5532,-3835.2164 2089.4076,-3766.2321 2062.8109,-2619.9604 2111.5532,-2569.2164 2154.1838,-2524.835 2326.2879,-2550.2164 2387.8271,-2550.2164 2387.8271,-2550.2164 2387.8271,-2550.2164 2596.2213,-2550.2164 2804.4022,-2550.2164 2881.7516,-2567.3851 3053.8293,-2450.2164 3102.5041,-2417.0734 3338.0289,-1963.9293 3360.8456,-2018.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge350" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1803.7218,-12012.2164C1826.852,-12029.5438 1846.629,-12005.9402 1867.2231,-12026.2164 1916.6941,-12074.9234 1853.7531,-12129.5084 1903.2231,-12178.2164 1959.1111,-12233.2434 2005.758,-12180.4385 2075.5532,-12216.2164 2176.3388,-12267.8803 2207.7765,-12288.7067 2265.3853,-12386.2164 2301.5793,-12447.479 2249.8007,-12493.2047 2301.3853,-12542.2164 2489.4459,-12720.8971 2696.2051,-12457.2941 2876.0764,-12644.2164 2996.4704,-12769.3298 2857.2038,-13537.9462 2982.9529,-13418.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1623.2106,-11936.2164C1692.649,-11988.7107 1733.9134,-11960.2151 1803.7218,-12012.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2982.9529,-13418.2164C3227.9574,-13191.9334 2867.9706,-12170.2342 3089.8293,-11921.2164 3091.6605,-11919.161 3093.6657,-11917.3183 3095.8104,-11915.6683"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3098.0059,-11918.4277 3104.7019,-11910.2171 3094.3472,-11912.46 3098.0059,-11918.4277"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge447" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M2188.4692,-11600.2164C2222.6877,-11589.6579 2235.3093,-11595.654 2265.3853,-11576.2164 2403.1147,-11487.2037 2400.5164,-11422.0647 2510.269,-11300.2164 2586.0433,-11216.0911 2617.2395,-11204.9653 2682.1736,-11112.2164 2702.0115,-11083.8808 2696.6848,-11070.3213 2718.1736,-11043.2164 2775.7142,-10970.6374 2833.2241,-10989.3279 2876.0764,-10907.2164 2983.7709,-10700.8576 2954.4,-9012.5334 3089.8293,-8823.2164 3113.9637,-8789.4789 3153.3658,-8819.8368 3174.6229,-8784.2164"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1989.3882,-11676.2164C2075.8048,-11637.462 2100.055,-11634.167 2188.4692,-11600.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge502" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2387.8271,-11600.2164C2488.9583,-11547.2453 2560.9818,-11422.4312 2586.2769,-11373.4493"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2589.437,-11374.9561 2590.8337,-11364.4537 2583.1925,-11371.7928 2589.437,-11374.9561"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2188.4692,-11600.2164C2273.1339,-11574.0922 2309.3386,-11641.3276 2387.8271,-11600.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge531" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.7218,-12012.2164C1826.852,-12029.5438 1847.0935,-12005.4789 1867.2231,-12026.2164 1927.0863,-12087.887 1857.049,-12143.7263 1903.2231,-12216.2164 1953.9161,-12295.8007 2009.9533,-12272.3925 2075.5532,-12340.2164 2138.2271,-12405.015 2229.8213,-12622.3942 2301.3853,-12677.2164 2411.229,-12761.3631 2461.3643,-12808.199 2596.2213,-12777.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge548" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1434.9585,-11720.571C1451.7656,-11777.5576 1526.8196,-12030.9679 1542.2007,-12064.2164 1573.6767,-12132.2566 1858.5784,-12573.9913 1903.2231,-12634.2164 1973.0979,-12728.4764 2029.9027,-12726.1263 2075.5532,-12834.2164 2146.3772,-13001.9117 2072.4447,-13064.4291 2111.5532,-13242.2164 2154.9795,-13439.6324 2198.1388,-13479.5941 2265.3853,-13670.2164 2281.6576,-13716.3434 2282.5679,-13729.0677 2301.3853,-13774.2164 2368.4382,-13935.0975 2415.1836,-13962.2416 2474.269,-14126.2164 2540.3613,-14309.6367 2581.331,-14543.1393 2592.8641,-14613.9364"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2589.4729,-14614.8931 2594.5158,-14624.2108 2596.3841,-14613.782 2589.4729,-14614.8931"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge571" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1481.3771,-11699.6077C1490.5053,-11696.0002 1499.3106,-11691.039 1506.2007,-11684.2164 1540.957,-11649.8 1524.7893,-11625.9256 1542.2007,-11580.2164 1608.868,-11405.1984 1657.2794,-11372.5238 1704.2205,-11191.2164 1740.0918,-11052.6653 1712.5809,-11011.6415 1740.2205,-10871.2164 1845.5954,-10335.8507 1989.396,-10229.0088 2075.5532,-9690.2164 2106.7732,-9494.9793 2062.4083,-8992.7287 2111.5532,-8801.2164 2149.6852,-8652.6202 2218.8884,-8638.4112 2265.3853,-8492.2164 2297.0109,-8392.7794 2277.8302,-8361.868 2301.3853,-8260.2164 2359.8031,-8008.1148 2426.4731,-7958.5457 2474.269,-7704.2164 2516.4833,-7479.5879 2440.1234,-7408.747 2510.269,-7191.2164 2525.4463,-7144.1497 2559.8002,-7096.7396 2580.1825,-7071.2716"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2582.9057,-7073.4705 2586.5113,-7063.508 2577.48,-7069.0475 2582.9057,-7073.4705"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge428" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-11068.2164C2414.7634,-11038.819 2439.6362,-11063.9733 2474.269,-11044.2164 2585.6378,-10980.684 2619.2022,-10955.9033 2682.1736,-10844.2164 2874.3957,-10503.2886 2830.1471,-10373.8957 2876.0764,-9985.2164 2947.0149,-9384.8958 2837.6896,-7865.1194 2912.0764,-7265.2164 2945.5817,-6995.0078 3020.0729,-6939.3937 3053.8293,-6669.2164 3086.6872,-6406.2309 3016.2236,-4538.8204 3089.8293,-4284.2164 3103.5128,-4236.8849 3137.8699,-4189.5706 3158.4064,-4164.1907"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.1243,-4166.3962 3164.7913,-4156.4562 3155.726,-4161.9398 3161.1243,-4166.3962"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge399" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-11068.2164C2414.6985,-11038.7597 2445.9104,-11072.2442 2474.269,-11044.2164 2515.0849,-11003.8766 2481.6315,-10969.9469 2510.269,-10920.2164 2565.4726,-10824.3527 2634.2483,-10839.9181 2682.1736,-10740.2164 2962.1365,-10157.7932 2830.0074,-9943.7888 2876.0764,-9299.2164 2907.9603,-8853.1142 2848.9771,-5716.9829 2912.0764,-5274.2164 2924.6079,-5186.2834 2959.314,-5085.7402 2975.0336,-5043.0901"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.3813,-5044.1297 2978.596,-5033.5371 2971.8225,-5041.6839 2978.3813,-5044.1297"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.1681,-11705.1431C1537.0128,-11699.2993 1629.7176,-11685.7823 1704.2205,-11656.2164 1836.4953,-11603.724 2188.5226,-11354.9881 2265.3853,-11272.2164 2337.3406,-11194.7292 2313.4371,-11143.3692 2387.8271,-11068.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge370" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.8447,-11698.167C1440.7562,-11626.674 1484.8294,-11222.0789 1506.2007,-10891.2164 1512.9737,-10786.3587 1493.8826,-10039.5243 1542.2007,-9946.2164 1583.8979,-9865.6941 1663.1272,-9903.0486 1704.2205,-9822.2164 1743.4559,-9745.0384 1723.9258,-8349.2478 1740.2205,-8264.2164 1770.7367,-8104.9717 1836.7198,-8081.4635 1867.2231,-7922.2164 1932.8341,-7579.6851 1881.7537,-6701.3133 1903.2231,-6353.2164 1960.1714,-5429.8811 1929.3542,-5189.1864 2111.5532,-4282.2164 2134.6166,-4167.4092 2121.3394,-4126.1653 2188.4692,-4030.2164"/>
</g>
<!-- sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge483" class="edge">
<title>sourcefile~psychroutines.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1435.5515,-11720.5886C1447.6187,-11755.7985 1484.5813,-11866.2982 1506.2007,-11960.2164 1528.2299,-12055.9147 1514.917,-12083.8815 1542.2007,-12178.2164 1645.4053,-12535.0524 1744.3257,-12597.6749 1867.2231,-12948.2164 1921.7087,-13103.6261 1969.312,-13296.7549 1984.4112,-13360.0559"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1981.0606,-13361.0953 1986.7739,-13370.0176 1987.8716,-13359.4798 1981.0606,-13361.0953"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node24" class="node">
<title>sourcefile~datazoneenergydemands.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node24"><a xlink:href="../sourcefile/datazoneenergydemands.f90.html" xlink:title="DataZoneEnergyDemands.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2265.3014,-2220.2218 2111.6371,-2220.2218 2111.6371,-2198.2109 2265.3014,-2198.2109 2265.3014,-2220.2218"/>
<text text-anchor="middle" x="2188.4692" y="-2206.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataZoneEnergyDemands.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge906" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2189.337,-2197.9765C2199.1598,-2070.888 2289.2987,-908.5974 2301.3853,-896.2164 2360.8545,-835.2984 2605.4283,-891.0641 2682.1736,-854.2164 2702.5717,-844.4226 2699.2304,-830.5919 2718.1736,-818.2164 2866.6111,-721.2424 2919.9981,-724.1574 3089.8293,-673.2164 3179.3311,-646.3703 3203.8948,-648.0592 3295.4165,-629.2164 3369.4591,-613.9722 3387.039,-603.5848 3462.2747,-596.2164 3549.73,-587.6512 3575.9256,-584.5856 3659.3423,-612.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3659.3423,-612.2164C3722.438,-628.2679 3751.3643,-632.2168 3784.5721,-688.2164"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge227" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.6962,-2220.2797C2204.2744,-2264.0377 2250.0736,-2429.4492 2265.3853,-2569.2164 2321.6519,-3082.8257 2233.208,-6707.052 2301.3853,-7219.2164 2317.2451,-7338.3596 2362.5227,-7476.0051 2380.4188,-7527.4298"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2377.1843,-7528.7827 2383.8016,-7537.0569 2383.7885,-7526.462 2377.1843,-7528.7827"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge274" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2387.8271,-2284.2164C2435.5415,-2295.2156 2489.9406,-2305.3148 2531.1923,-2312.4792"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2530.6676,-2315.9403 2541.1169,-2314.1903 2531.8571,-2309.042 2530.6676,-2315.9403"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge606" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2197.0397,-2198.0505C2251.5348,-2128.1011 2558.7379,-1749.1798 2912.0764,-1624.2164 3057.6159,-1572.7442 3119.8394,-1558.2667 3259.4165,-1624.2164 3285.8152,-1636.6897 3415.4333,-1800.1065 3426.2747,-1827.2164 3610.1089,-2286.9123 3567.708,-3554.5599 3588.4519,-4049.2164 3592.2731,-4140.3362 3582.3366,-7251.3231 3624.4519,-7332.2164 3625.8069,-7334.8189 3627.5704,-7337.2123 3629.5848,-7339.3993"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3423,-7342.0878 3637.1708,-7346.0439 3631.9545,-7336.8221 3627.3423,-7342.0878"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge320" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2387.8271,-2284.2164C2478.0798,-2305.0217 2505.687,-2303.7597 2596.2213,-2284.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2230.5329,-2220.2855C2242.1212,-2224.0264 2254.4933,-2228.6854 2265.3853,-2234.2164 2282.9829,-2243.1525 2283.5977,-2251.6645 2301.3853,-2260.2164 2337.3198,-2277.4929 2348.9742,-2275.2599 2387.8271,-2284.2164"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge532" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2190.26,-2220.2608C2198.608,-2270.3751 2236.0815,-2480.9139 2301.3853,-2642.2164 2360.0035,-2787.0054 2433.2437,-2797.4952 2474.269,-2948.2164 2535.2102,-3172.1051 2489.9985,-4805.069 2510.269,-5036.2164 2552.768,-5520.8378 2642.3492,-5632.3678 2682.1736,-6117.2164 2734.9484,-6759.7317 2682.1594,-11275.544 2718.1736,-11919.2164 2734.253,-12206.5995 2781.5313,-12553.8466 2794.0528,-12642.7035"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2790.6252,-12643.4618 2795.4934,-12652.8719 2797.556,-12642.4798 2790.6252,-12643.4618"/>
</g>
<!-- sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge572" class="edge">
<title>sourcefile~datazoneenergydemands.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2190.6973,-2220.4552C2200.7762,-2270.5607 2244.1073,-2478.304 2301.3853,-2642.2164 2363.931,-2821.2036 2434.1474,-2846.9094 2474.269,-3032.2164 2520.3435,-3245.017 2434.1523,-6747.2232 2510.269,-6951.2164 2523.0598,-6985.4956 2553.089,-7016.1343 2574.0277,-7034.4441"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2571.9356,-7037.2593 2581.8239,-7041.0636 2576.4663,-7031.9232 2571.9356,-7037.2593"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge907" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.4864,-9895.4971C1443.32,-9955.344 1489.2029,-10241.8555 1506.2007,-10478.2164 1521.5693,-10691.924 1493.2405,-12197.6257 1542.2007,-12406.2164 1580.6345,-12569.9604 1666.1921,-12584.3777 1704.2205,-12748.2164 1737.1836,-12890.2325 1671.4597,-15243.6585 1740.2205,-15372.2164 1773.6163,-15434.6546 2207.5444,-15692.3721 2265.3853,-15733.2164 2555.4109,-15938.0175 2588.9194,-16055.152 2912.0764,-16202.2164 2985.8699,-16235.7988 3010.4718,-16226.6139 3089.8293,-16243.2164 3341.6016,-16295.8898 3419.4858,-16439.1283 3659.3423,-16346.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge43" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1487.3521,-9873.1857C1542.7278,-9861.8413 1629.8841,-9842.9445 1704.2205,-9822.2164 1793.9793,-9797.1878 1814.091,-9783.3925 1903.2231,-9756.2164 1941.2483,-9744.6226 1951.3337,-9720.7191 1989.3882,-9732.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge65" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1437.8828,-9895.4551C1453.0648,-9921.9463 1494.1225,-9989.365 1542.2007,-10033.2164 1611.6942,-10096.6003 2216.8956,-10392.621 2265.3853,-10473.2164 2335.2755,-10589.382 2259.5097,-10953.2763 2301.3853,-11082.2164 2363.7454,-11274.2308 2525.7357,-11465.1212 2578.9808,-11524.444"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2576.4465,-11526.8598 2585.7505,-11531.9279 2581.6378,-11522.1639 2576.4465,-11526.8598"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge104" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1989.3882,-9676.2164C2369.1537,-9649.9035 2371.2275,-9382.8772 2718.1736,-9226.2164 2751.5989,-9211.1234 2770.8358,-9227.7884 2797.125,-9202.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge116" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1432.396,-9873.1235C1439.0458,-9778.1948 1486.3921,-9092.5287 1506.2007,-8535.2164 1515.1806,-8282.5665 1486.1429,-6506.7324 1542.2007,-6260.2164 1580.3889,-6092.2825 1665.5425,-6076.0381 1704.2205,-5908.2164 1745.7032,-5728.2248 1718.4287,-4429.6364 1740.2205,-4246.2164 1752.4172,-4143.5568 1784.2933,-4023.7618 1797.6721,-3976.2083"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1801.0775,-3977.0288 1800.4438,-3966.453 1794.344,-3975.1157 1801.0775,-3977.0288"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge252" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1623.2106,-9960.2164C1658.9173,-9967.9661 1672.0122,-9956.9635 1704.2205,-9974.2164 1724.728,-9985.2016 1720.8365,-9999.3519 1740.2205,-10012.2164 1872.875,-10100.2546 1931.2605,-10070.9292 2075.5532,-10138.2164 2163.328,-10179.1479 2214.2231,-10162.9836 2265.3853,-10245.2164 2341.4556,-10367.4839 2219.3527,-10773.8664 2301.3853,-10892.2164 2349.1998,-10961.1995 2416.3731,-10907.4466 2474.269,-10968.2164 2505.1276,-11000.6067 2485.3644,-11025.0527 2510.269,-11062.2164 2568.7119,-11149.427 2619.2339,-11140.1933 2682.1736,-11224.2164 2845.1224,-11441.7494 2950.7518,-11761.6804 2976.7056,-11845.5016"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2973.3811,-11846.5987 2979.6573,-11855.1345 2980.0739,-11844.5478 2973.3811,-11846.5987"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge672" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1432.4072,-9873.1239C1439.1508,-9778.1985 1487.1282,-9092.5544 1506.2007,-8535.2164 1526.9585,-7928.6298 1498.903,-6409.6116 1542.2007,-5804.2164 1581.944,-5248.5181 1664.5532,-5116.9201 1704.2205,-4561.2164 1748.3528,-3942.9601 1660.2319,-2386.8629 1740.2205,-1772.2164 1751.6421,-1684.4506 1782.6345,-1583.2365 1796.6592,-1540.2596"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1800.0263,-1541.2248 1799.837,-1530.6316 1793.379,-1539.0307 1800.0263,-1541.2248"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge743" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1623.2106,-9808.2164C1659.5936,-9781.1627 1679.263,-9784.068 1704.2205,-9746.2164 1740.0599,-9691.8606 1702.8194,-9657.5097 1740.2205,-9604.2164 1779.3802,-9548.417 1828.0634,-9574.0157 1867.2231,-9518.2164 1904.6242,-9464.9231 1866.5853,-9430.0372 1903.2231,-9376.2164 1956.3209,-9298.2159 2008.8571,-9318.9627 2075.5532,-9252.2164 2088.9709,-9238.7886 2463.3865,-8712.7698 2474.269,-8697.2164 2529.4567,-8618.342 2551.29,-8603.3516 2596.2213,-8518.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1476.1769,-9873.1247C1486.4675,-9869.5378 1497.0668,-9864.9588 1506.2007,-9859.2164 1525.6246,-9847.0045 1521.904,-9832.9153 1542.2007,-9822.2164 1574.5231,-9805.1784 1593.6647,-9829.7123 1623.2106,-9808.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge782" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1623.2106,-9960.2164C1752.3882,-9980.2404 1774.4129,-9892.4817 1903.2231,-9870.2164 2061.8707,-9842.7936 2107.374,-9893.0952 2265.3853,-9862.2164 2419.8054,-9832.0394 2447.1762,-9786.6326 2596.2213,-9736.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1452.7236,-9895.2712C1487.2676,-9912.7382 1558.5155,-9946.175 1623.2106,-9960.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge821" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1432.3779,-9873.1228C1438.8769,-9778.1886 1485.2071,-9092.4853 1506.2007,-8535.2164 1513.702,-8336.0952 1488.3068,-6934.0521 1542.2007,-6742.2164 1555.3106,-6695.5514 1587.873,-6648.2788 1607.4903,-6622.6664"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1610.4359,-6624.5812 1613.8362,-6614.5468 1604.9205,-6620.2706 1610.4359,-6624.5812"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge842" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1623.2106,-10872.2164C1641.2794,-10905.1346 1673.0364,-10875.2963 1704.2205,-10896.2164 1922.9891,-11042.9787 1970.9397,-11116.4418 2075.5532,-11358.2164 2121.1801,-11463.6657 2059.9743,-11511.547 2111.5532,-11614.2164 2154.7007,-11700.1028 2199.3947,-11696.3348 2265.3853,-11766.2164 2304.8339,-11807.9911 2348.8578,-11859.1593 2371.8564,-11886.2621"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2369.4203,-11888.8016 2378.5522,-11894.1737 2374.7636,-11884.2794 2369.4203,-11888.8016"/>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1433.1548,-9895.5275C1441.2986,-9955.5292 1479.9622,-10242.7022 1506.2007,-10478.2164 1515.3477,-10560.3189 1489.6235,-10784.4972 1542.2007,-10848.2164 1566.1,-10877.1804 1607.2576,-10838.2223 1623.2106,-10872.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge865" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2188.4692,-6593.2164C2235.7789,-6472.6857 2239.6781,-6439.1218 2265.3853,-6312.2164 2289.4205,-6193.5643 2266.2403,-6158.0647 2301.3853,-6042.2164 2319.4766,-5982.582 2355.8962,-5918.2375 2375.1805,-5886.4133"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2378.3281,-5887.9758 2380.5759,-5877.6221 2372.3621,-5884.3142 2378.3281,-5887.9758"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1434.0881,-9873.0635C1459.1805,-9759.759 1667.5063,-8815.419 1704.2205,-8529.2164 1740.1874,-8248.8385 1694.8073,-8173.22 1740.2205,-7894.2164 1774.7074,-7682.3396 1831.1973,-7639.8369 1867.2231,-7428.2164 1904.9858,-7206.3937 1830.9444,-7136.3058 1903.2231,-6923.2164 1957.2584,-6763.9118 1971.2128,-6699.965 2111.5532,-6607.2164 2140.5412,-6588.0587 2175.7738,-6625.5606 2188.4692,-6593.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge90" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.7948,-9895.2817C1445.0381,-9929.2143 1480.1676,-10033.2522 1542.2007,-10095.2164 1798.7918,-10351.5226 2068.4237,-10168.6872 2265.3853,-10473.2164 2339.0107,-10587.0513 2229.9541,-10966.9918 2301.3853,-11082.2164 2404.136,-11247.9622 2563.5501,-11145.4331 2682.1736,-11300.2164 2720.4691,-11350.1855 2699.8191,-11376.9954 2718.1736,-11437.2164 2780.4572,-11641.5693 2838.0912,-11680.9868 2876.0764,-11891.2164 2891.678,-11977.5632 2860.5774,-13399.1738 2912.0764,-13470.2164 2915.7068,-13475.2245 2920.4231,-13479.2351 2925.6987,-13482.4459"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2924.5057,-13485.7635 2935.0121,-13487.1292 2927.6505,-13479.5097 2924.5057,-13485.7635"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge228" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.6611,-9873.1838C1490.4551,-9869.7068 1499.0633,-9865.1578 1506.2007,-9859.2164 1531.5814,-9838.0885 1520.6329,-9819.2243 1542.2007,-9794.2164 1601.4225,-9725.5485 1656.2478,-9747.1652 1704.2205,-9670.2164 1747.3821,-9600.9844 1701.2947,-9561.9157 1740.2205,-9490.2164 1777.8598,-9420.8866 1827.8319,-9434.566 1867.2231,-9366.2164 1899.7334,-9309.8063 1879.3691,-9284.7969 1903.2231,-9224.2164 1961.5475,-9076.0941 2029.274,-9062.5325 2075.5532,-8910.2164 2102.0137,-8823.1286 2054.4505,-8573.0946 2111.5532,-8502.2164 2134.0197,-8474.3301 2177.9848,-8512.4576 2188.4692,-8478.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge607" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1433.6377,-9895.3382C1446.6479,-9963.5898 1524.9218,-10328.6657 1740.2205,-10506.2164 1744.8146,-10510.005 3357.2135,-11062.4975 3360.8456,-11067.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3360.8456,-11067.2164C3485.4613,-11187.2417 3365.4566,-11894.2847 3525.3633,-11828.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3525.3633,-11828.2164C3635.5273,-11782.7001 3657.6267,-7709.8095 3659.2421,-7378.5771"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3662.7429,-7378.4021 3659.2911,-7368.3854 3655.743,-7378.3684 3662.7429,-7378.4021"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge321" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1432.3849,-9873.1231C1438.9418,-9778.1911 1485.6627,-9092.5023 1506.2007,-8535.2164 1514.1898,-8318.4378 1505.4102,-6796.9996 1542.2007,-6583.2164 1580.7447,-6359.2436 1663.0808,-6321.727 1704.2205,-6098.2164 1773.7927,-5720.2326 1705.3561,-5616.965 1740.2205,-5234.2164 1776.9054,-4831.4806 1822.1516,-4735.1 1867.2231,-4333.2164 1888.6467,-4142.1913 1863.8299,-4090.3591 1903.2231,-3902.2164 1951.7381,-3670.5086 2031.8673,-3630.883 2075.5532,-3398.2164 2084.3982,-3351.1089 2078.2867,-2570.7226 2111.5532,-2536.2164 2170.6925,-2474.8732 2792.889,-2494.6635 2876.0764,-2476.2164 2925.592,-2465.2361 2939.8016,-2462.8683 2982.9529,-2436.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge351" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1623.2106,-9960.2164C1658.874,-9968.1632 1668.3288,-9967.3739 1704.2205,-9974.2164 1776.916,-9988.0753 1795.7996,-9988.8413 1867.2231,-10008.2164 1961.4943,-10033.7893 1983.4249,-10045.7603 2075.5532,-10078.2164 2160.3671,-10108.0956 2211.227,-10076.4316 2265.3853,-10148.2164 2329.5412,-10233.2527 2260.2431,-10527.9591 2301.3853,-10626.2164 2400.753,-10863.5301 2535.0535,-10851.1537 2682.1736,-11062.2164 2879.3457,-11345.0852 2911.9183,-11428.9666 3053.8293,-11743.2164 3073.0984,-11785.8861 3061.8586,-11804.6712 3089.8293,-11842.2164 3104.2911,-11861.6284 3126.3814,-11877.7707 3144.3893,-11888.8546"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3142.9852,-11892.091 3153.3721,-11894.1802 3146.5551,-11886.0697 3142.9852,-11892.091"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge455" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1803.7218,-9618.2164C1877.1102,-9572.5226 1904.2167,-9691.0353 1989.3882,-9676.2164"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1989.3882,-9676.2164C2044.8703,-9666.5631 2654.9858,-8985.5345 2682.1736,-8936.2164 2712.7747,-8880.7065 2691.8417,-8855.874 2718.1736,-8798.2164 2769.6834,-8685.428 2837.7051,-8686.1236 2876.0764,-8568.2164 2965.7168,-8292.7694 2838.3684,-7545.3477 2912.0764,-7265.2164 2996.023,-6946.1729 3172.7624,-6927.5352 3259.4165,-6609.2164 3321.7905,-6380.0889 3356.5062,-4575.2161 3360.4644,-4358.4845"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3363.9654,-4358.456 3360.6473,-4348.3942 3356.9665,-4358.3291 3363.9654,-4358.456"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge503" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1444.0631,-9895.3987C1464.0375,-9913.0956 1504.8062,-9948.2135 1542.2007,-9974.2164 1856.128,-10192.5108 2088.1899,-10101.388 2265.3853,-10440.2164 2319.886,-10544.4314 2236.0874,-10870.4038 2301.3853,-10968.2164 2349.0343,-11039.5919 2424.411,-10984.366 2474.269,-11054.2164 2545.626,-11154.1864 2430.2832,-11235.0064 2510.269,-11328.2164 2513.1154,-11331.5333 2516.3738,-11334.4232 2519.9193,-11336.9398"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2518.275,-11340.0345 2528.6545,-11342.1598 2521.8658,-11334.0256 2518.275,-11340.0345"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge534" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1432.3398,-9895.2378C1437.6913,-9974.3368 1472.8063,-10456.0291 1542.2007,-10582.2164 1694.449,-10859.0658 1922.6032,-10775.7539 2075.5532,-11052.2164 2123.5164,-11138.9114 2081.4351,-11177.8268 2111.5532,-11272.2164 2158.7933,-11420.2656 2205.6717,-11442.7435 2265.3853,-11586.2164 2284.1801,-11631.3744 2276.6876,-11647.9964 2301.3853,-11690.2164 2359.8678,-11790.1907 2412.831,-11787.0307 2474.269,-11885.2164 2647.9436,-12162.7699 2764.5731,-12549.9075 2791.2797,-12643.332"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2787.9322,-12644.3566 2794.027,-12653.0228 2794.6668,-12642.4473 2787.9322,-12644.3566"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge557" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1623.2106,-10872.2164C1639.1635,-10906.2105 1678.2372,-10869.1061 1704.2205,-10896.2164 1735.6868,-10929.0476 1891.6749,-11646.2316 1903.2231,-11690.2164 2146.6679,-12617.4411 2309.229,-12825.8791 2474.269,-13770.2164 2509.5736,-13972.2241 2480.9195,-14027.2579 2510.269,-14230.2164 2531.7686,-14378.8904 2575.4493,-14554.7368 2590.766,-14614.3031"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2587.3917,-14615.2345 2593.2842,-14624.0395 2594.1687,-14613.4817 2587.3917,-14615.2345"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge573" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1436.8286,-9872.7722C1451.7897,-9840.2559 1496.7104,-9744.8497 1542.2007,-9670.2164 1606.9004,-9564.0672 1652.8641,-9555.4252 1704.2205,-9442.2164 1833.3263,-9157.6183 1827.2048,-9068.1565 1867.2231,-8758.2164 1878.4236,-8671.4692 1851.0408,-7254.4128 1903.2231,-7184.2164 1942.9991,-7130.7092 2122.0945,-7097.5052 2188.4692,-7091.2164"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge429" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-9808.2164C1717.3988,-9739.6901 1708.9336,-9685.9103 1803.7218,-9618.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-9618.2164C1831.4593,-9598.4074 1841.2944,-9597.3401 1867.2231,-9575.2164 2081.8189,-9392.1124 2075.0437,-9280.5848 2301.3853,-9112.2164 2370.2426,-9060.9956 2403.0392,-9074.083 2474.269,-9026.2164 2576.4409,-8957.5567 2611.7741,-8944.1974 2682.1736,-8843.2164 2716.3696,-8794.1657 2864.4112,-8399.8616 2876.0764,-8341.2164 2940.865,-8015.5011 2849.5902,-7173.3812 2912.0764,-6847.2164 2946.2282,-6668.9513 3020.3534,-6642.6096 3053.8293,-6464.2164 3098.5093,-6226.117 3022.3837,-4516.8936 3089.8293,-4284.2164 3103.5464,-4236.8947 3137.8913,-4189.5768 3158.4167,-4164.1937"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.1344,-4166.3994 3164.7979,-4156.4581 3155.7345,-4161.9449 3161.1344,-4166.3994"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge400" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.0386,-9873.1969C1445.1176,-9823.1438 1492.5373,-9612.3011 1542.2007,-9442.2164 1605.7822,-9224.4655 1650.3999,-9178.5829 1704.2205,-8958.2164 1718.044,-8901.6164 1861.4489,-7980.1931 1867.2231,-7922.2164 1885.8938,-7734.7517 1839.1269,-7252.3696 1903.2231,-7075.2164 1955.151,-6931.695 2007.1806,-6913.5773 2111.5532,-6802.2164 2173.5581,-6736.0599 2222.7193,-6748.2221 2265.3853,-6668.2164 2325.4626,-6555.5613 2249.4152,-6499.8335 2301.3853,-6383.2164 2349.2124,-6275.8956 2425.9663,-6290.324 2474.269,-6183.2164 2523.3136,-6074.4638 2443.1037,-6015.8131 2510.269,-5917.2164 2559.5358,-5844.8942 2630.2596,-5891.6624 2682.1736,-5821.2164 2727.9906,-5759.0437 2670.4902,-5711.9695 2718.1736,-5651.2164 2766.2605,-5589.9491 2830.7831,-5638.5768 2876.0764,-5575.2164 2915.2524,-5520.4134 2898.9172,-5340.2842 2912.0764,-5274.2164 2929.4268,-5187.106 2961.594,-5086.1295 2975.8427,-5043.2282"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2979.2049,-5044.21 2979.0593,-5033.6162 2972.5667,-5041.9886 2979.2049,-5044.21"/>
</g>
<!-- sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge377" class="edge">
<title>sourcefile~branchnodeconnections.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.2318,-9873.0653C1440.8446,-9717.4156 1536.8299,-7983.8071 1542.2007,-7932.2164 1641.7204,-6976.2429 1783.1337,-6751.6705 1867.2231,-5794.2164 1874.414,-5712.3405 1850.9658,-4378.6556 1903.2231,-4315.2164 1928.1565,-4284.9478 1973.7159,-4332.1641 1989.3882,-4296.2164"/>
</g>
<!-- sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node26" class="node">
<title>sourcefile~dataairloop.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node26"><a xlink:href="../sourcefile/dataairloop.f90.html" xlink:title="DataAirLoop.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2232.3533,-2600.2218 2144.5851,-2600.2218 2144.5851,-2578.2109 2232.3533,-2578.2109 2232.3533,-2600.2218"/>
<text text-anchor="middle" x="2188.4692" y="-2586.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirLoop.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge908" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2191.6128,-2578.1435C2203.8789,-2534.3497 2248.6672,-2368.8222 2265.3853,-2229.2164 2273.9165,-2157.9753 2253.046,-991.2389 2301.3853,-938.2164 2358.8094,-875.2288 2599.4399,-912.7129 2682.1736,-892.2164 2776.324,-868.8915 2997.9517,-767.3107 3089.8293,-736.2164 3253.3202,-680.8859 3292.4341,-656.9558 3462.2747,-626.2164 3548.6773,-610.5784 3576.0237,-584.504 3659.3423,-612.2164"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge66" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M2191.1408,-2600.2618C2201.8059,-2644.6699 2241.8895,-2814.6078 2265.3853,-2956.2164 2286.8606,-3085.6483 2273.0505,-3121.1111 2301.3853,-3249.2164 2355.2599,-3492.791 2434.7905,-3536.8984 2474.269,-3783.2164 2507.6348,-3991.3952 2460.8841,-11168.2461 2510.269,-11373.2164 2524.3799,-11431.7828 2561.9273,-11493.0746 2582.4145,-11523.5612"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2579.6476,-11525.7156 2588.18,-11531.9964 2585.4266,-11521.7656 2579.6476,-11525.7156"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge194" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M2188.9418,-2600.3032C2195.7895,-2760.5978 2275.1463,-4605.9353 2301.3853,-4654.2164 2312.7395,-4675.1088 2334.3616,-4690.8627 2353.1394,-4701.3915"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2351.5988,-4704.5363 2362.0716,-4706.1401 2354.8848,-4698.3555 2351.5988,-4704.5363"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge253" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2387.8271,-2628.2164C2418.709,-2651.9022 2447.5258,-2613.9408 2474.269,-2642.2164 2526.7807,-2697.7368 2492.5383,-2909.8819 2510.269,-2984.2164 2560.136,-3193.2783 2633.8032,-3226.8031 2682.1736,-3436.2164 2695.5755,-3494.2383 2873.1862,-5511.7369 2876.0764,-5571.2164 2935.5048,-6794.244 2852.971,-9858.1731 2912.0764,-11081.2164 2926.772,-11385.3071 2969.4573,-11753.7497 2980.3821,-11845.0109"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2976.9352,-11845.6625 2981.6049,-11855.1727 2983.8851,-11844.8262 2976.9352,-11845.6625"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge783" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2201.9611,-2600.4646C2249.7216,-2641.2168 2411.2725,-2787.23 2474.269,-2948.2164 2513.8945,-3049.4785 2501.1671,-3327.8589 2510.269,-3436.2164 2578.4263,-4247.6178 2640.2301,-4447.0384 2682.1736,-5260.2164 2687.8343,-5369.9639 2670.0573,-9117.4166 2718.1736,-9216.2164 2728.0464,-9236.4887 2747.9202,-9252.2905 2765.2573,-9262.9981"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2763.6274,-9266.0995 2774.0259,-9268.1298 2767.1631,-9260.058 2763.6274,-9266.0995"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge275" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2206.9729,-2578.1024C2241.9657,-2557.1833 2320.382,-2510.7752 2387.8271,-2474.2164"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge608" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3360.8456,-4146.2164C3421.041,-4187.7241 3468.5878,-4100.1411 3525.3633,-4146.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3525.3633,-4146.2164C3684.2289,-4275.1416 3573.0536,-4398.1995 3588.4519,-4602.2164 3594.1597,-4677.8412 3589.355,-7264.9862 3624.4519,-7332.2164 3625.8098,-7334.8174 3627.5753,-7337.2098 3629.591,-7339.3961"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3497,-7342.0857 3637.1792,-7346.0395 3631.9608,-7336.8189 3627.3497,-7342.0857"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge322" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3360.8456,-4146.2164C3402.501,-4175.0455 3416.1334,-4115.1275 3462.2747,-4094.2164 3469.9037,-4090.7589 3478.161,-4087.2937 3486.1092,-4084.0918"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3487.5812,-4087.2733 3495.588,-4080.3348 3485.0019,-4080.7658 3487.5812,-4087.2733"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2387.8271,-2628.2164C2420.8913,-2650.4993 2435.856,-2641.5298 2474.269,-2652.2164 2617.7813,-2692.1419 2648.2338,-2737.6093 2797.125,-2742.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2232.6598,-2588.2095C2275.7609,-2589.3113 2341.4273,-2596.7303 2387.8271,-2628.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2797.125,-2742.2164C2848.4454,-2742.7279 2860.8119,-2733.6636 2912.0764,-2731.2164 3069.6429,-2723.6946 3163.6347,-2678.8783 3259.4165,-2804.2164 3441.0107,-3041.8465 3114.9247,-3976.0181 3360.8456,-4146.2164"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge458" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M2797.125,-2742.2164C2968.1487,-2748.6108 3058.149,-2692.8216 3174.6229,-2818.2164"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M3174.6229,-2818.2164C3382.7113,-3045.0736 3220.2781,-3899.688 3295.4165,-4198.2164 3306.7228,-4243.1367 3332.8013,-4291.0812 3348.4053,-4317.2727"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3345.4548,-4319.1572 3353.6335,-4325.8922 3351.4399,-4315.5269 3345.4548,-4319.1572"/>
</g>
<!-- sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge505" class="edge">
<title>sourcefile~dataairloop.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2191.9821,-2600.3031C2224.156,-2701.8838 2466.6592,-3468.3816 2474.269,-3518.2164 2482.4562,-3571.8316 2477.611,-11284.9143 2510.269,-11328.2164 2512.6055,-11331.3144 2515.3039,-11334.0459 2518.2713,-11336.4529"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.4354,-11339.4358 2526.691,-11342.0954 2520.3324,-11333.6208 2516.4354,-11339.4358"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge909" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3525.3633,-16764.2164C3587.7393,-16792.4285 3601.3059,-16876.5271 3659.3423,-16840.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1062.1884,-10390.3205C1071.803,-10430.8222 1104.6654,-10574.5506 1116.5955,-10695.2164 1202.2304,-11561.3626 1063.9875,-11787.3692 1152.5955,-12653.2164 1224.6436,-13357.2466 1445.2847,-15139.895 1740.2205,-15783.2164 2117.5041,-16606.1572 2700.5066,-16391.1401 3525.3633,-16764.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3659.3423,-16840.2164C3675.298,-16830.2336 3684.3908,-16832.2593 3694.2327,-16816.2164 3773.8297,-16686.4674 3632.3663,-16139.1845 3784.5721,-16137.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge67" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1431.6149,-12354.2164C1445.9778,-12373.992 2277.0144,-12485.3638 2301.3853,-12487.2164 2378.0015,-12493.0404 2418.5801,-12540.1569 2474.269,-12487.2164 2531.5988,-12432.7159 2494.3992,-11853.7093 2510.269,-11776.2164 2526.9799,-11694.6169 2567.416,-11603.4878 2586.254,-11563.679"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.492,-11565.0209 2590.6526,-11554.4898 2583.178,-11561.9986 2589.492,-11565.0209"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1236.8123,-12088.2164C1241.9766,-12106.4716 1307.6687,-12088.747 1321.0291,-12102.2164 1393.2748,-12175.0518 1290.3107,-12252.2862 1357.0291,-12330.2164 1379.6762,-12356.6693 1408.859,-12327.8569 1431.6149,-12354.2164"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1066.5098,-10390.4749C1079.3603,-10411.864 1106.3428,-10460.2616 1116.5955,-10505.2164 1135.8592,-10589.6817 1099.6065,-11995.6769 1152.5955,-12064.2164 1176.4004,-12095.0073 1226.2178,-12050.7662 1236.8123,-12088.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge107" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1068.4688,-10367.9485C1081.9979,-10350.1356 1107.0772,-10313.825 1116.5955,-10278.2164 1181.3574,-10035.9368 1104.8757,-6010.4202 1152.5955,-5764.2164 1191.4931,-5563.5291 1274.3424,-5535.2359 1321.0291,-5336.2164 1363.6147,-5154.6789 1281.8388,-5088.8499 1357.0291,-4918.2164 1396.496,-4828.6516 1466.9581,-4845.8797 1506.2007,-4756.2164 1545.8906,-4665.5311 1475.4317,-4385.2986 1542.2007,-4312.2164 1566.8456,-4285.2412 1604.2806,-4329.4684 1623.2106,-4298.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge183" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1068.4682,-10367.9483C1081.9965,-10350.1352 1107.0747,-10313.8244 1116.5955,-10278.2164 1148.4394,-10159.1182 1087.7993,-5945.0966 1152.5955,-5840.2164 1196.7731,-5768.7097 1270.2917,-5821.2282 1321.0291,-5754.2164 1370.2764,-5689.1725 1315.2699,-5644.3033 1357.0291,-5574.2164 1401.1575,-5500.1529 1451.0018,-5516.4418 1506.2007,-5450.2164 1527.096,-5425.147 1525.0024,-5413.9527 1542.2007,-5386.2164 1609.6337,-5277.4644 1637.498,-5257.4058 1704.2205,-5148.2164 1721.6429,-5119.7049 1716.9449,-5106.1891 1740.2205,-5082.2164 1873.3756,-4945.0727 1932.2848,-4931.5602 2111.5532,-4865.2164 2144.1398,-4853.1567 2155.6943,-4862.7544 2188.4692,-4851.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge254" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1236.8123,-12088.2164C1247.1409,-12124.7269 1294.835,-12074.7652 1321.0291,-12102.2164 1414.9543,-12200.6494 1279.2289,-12294.6003 1357.0291,-12406.2164 1399.5772,-12467.258 1447.5841,-12436.3849 1506.2007,-12482.2164 1810.3257,-12720.0076 1896.7527,-12796.0657 2075.5532,-13138.2164 2105.7079,-13195.92 2061.9487,-13238.0452 2111.5532,-13280.2164 2205.4561,-13360.0476 2278.3044,-13247.6874 2387.8271,-13304.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge744" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1236.8123,-9731.2164C1263.314,-9685.8354 1286.3791,-9687.7278 1321.0291,-9648.2164 1411.023,-9545.5961 1441.757,-9523.5361 1506.2007,-9403.2164 1529.0966,-9360.4685 1511.7949,-9337.9933 1542.2007,-9300.2164 1648.549,-9168.0863 1736.5223,-9208.3164 1867.2231,-9100.2164 1972.9973,-9012.7327 2017.0833,-8996.4051 2075.5532,-8872.2164 2124.4955,-8768.2643 2033.6668,-8700.6858 2111.5532,-8616.2164 2196.8591,-8523.7004 2277.3478,-8614.4709 2387.8271,-8554.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge784" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2596.2213,-9736.2164C2639.4229,-9717.448 2658.7571,-9715.0856 2682.1736,-9674.2164 2724.2323,-9600.8103 2661.5808,-9358.1023 2718.1736,-9295.2164 2727.567,-9284.7784 2741.7371,-9280.067 2755.4919,-9278.1957"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2756.1947,-9281.6469 2765.8434,-9277.2705 2755.5715,-9274.6747 2756.1947,-9281.6469"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1236.8123,-9731.2164C1298.8825,-9633.9624 1625.7265,-9618.4359 1740.2205,-9604.2164 1983.5244,-9573.9994 2387.5723,-9635.8175 2474.269,-9677.2164 2494.4063,-9686.8322 2490.9234,-9701.0934 2510.269,-9712.2164 2544.6531,-9731.9858 2559.8436,-9752.0202 2596.2213,-9736.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge810" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1236.8123,-7300.2164C1254.7765,-7257.3494 1283.7281,-7265.9459 1321.0291,-7238.2164 1403.6143,-7176.8225 1456.4221,-7189.2809 1506.2007,-7099.2164 1599.6133,-6930.2047 1450.2334,-6836.0189 1542.2007,-6666.2164 1553.1113,-6646.0717 1573.4997,-6630.2693 1591.092,-6619.5295"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1593.0779,-6622.4238 1599.9717,-6614.3786 1589.5655,-6616.3688 1593.0779,-6622.4238"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge827" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1066.5021,-10390.4766C1079.3398,-10411.8687 1106.3019,-10460.271 1116.5955,-10505.2164 1134.5226,-10583.4924 1109.8166,-11882.2569 1152.5955,-11950.2164 1197.3721,-12021.3495 1267.4148,-11971.4833 1321.0291,-12036.2164 1357.3619,-12080.084 1317.0329,-12118.6609 1357.0291,-12159.2164 1417.4933,-12220.5262 1457.0494,-12203.4072 1542.2007,-12216.2164 1740.0637,-12245.9806 1790.407,-12185.2447 1989.3882,-12164.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge866" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1236.8123,-7300.2164C1253.7614,-7256.938 1296.5368,-7277.7185 1321.0291,-7238.2164 1369.7751,-7159.5967 1303.9729,-7108.9942 1357.0291,-7033.2164 1400.9211,-6970.5273 1464.698,-7011.5122 1506.2007,-6947.2164 1550.2827,-6878.9245 1517.3211,-6660.5986 1542.2007,-6583.2164 1632.612,-6302.0129 1657.0602,-6188.4752 1903.2231,-6025.2164 1982.8443,-5972.4105 2018.2039,-5992.5607 2111.5532,-5972.2164 2145.5029,-5964.8175 2155.0043,-5967.5664 2188.4692,-5958.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1068.3906,-10367.9272C1081.815,-10350.0858 1106.7565,-10313.7378 1116.5955,-10278.2164 1157.658,-10129.9684 1146.5369,-9047.9268 1152.5955,-8894.2164 1166.5659,-8539.7753 1104.1325,-7629.184 1236.8123,-7300.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge75" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1062.159,-10390.3235C1071.6724,-10430.8353 1104.2312,-10574.5943 1116.5955,-10695.2164 1132.5419,-10850.7857 1107.1237,-11952.5887 1152.5955,-12102.2164 1193.2828,-12236.1005 1274.209,-12236.3516 1321.0291,-12368.2164 1366.5526,-12496.4296 1282.1438,-12558.6241 1357.0291,-12672.2164 1399.1499,-12736.1089 1462.6282,-12695.3048 1506.2007,-12758.2164 1562.1136,-12838.9455 1501.9552,-12886.6409 1542.2007,-12976.2164 1589.0834,-13080.5644 1640.5646,-13081.1667 1704.2205,-13176.2164 1722.8133,-13203.9788 1714.7992,-13220.5322 1740.2205,-13242.2164 1860.5379,-13344.8463 1975.6932,-13238.5902 2075.5532,-13361.2164 2149.4954,-13452.0159 2076.9282,-13510.3544 2111.5532,-13622.2164 2167.377,-13802.5644 2151.4675,-13887.4715 2301.3853,-14002.2164 2390.6286,-14070.5219 2698.8008,-14156.6441 2797.125,-14102.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge163" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1068.471,-10367.9491C1082.003,-10350.1369 1107.0861,-10313.8274 1116.5955,-10278.2164 1185.6536,-10019.6039 1079.2133,-5717.6353 1152.5955,-5460.2164 1191.9917,-5322.0173 1278.6676,-5321.5355 1321.0291,-5184.2164 1414.4301,-4881.4469 1286.4421,-4781.1024 1357.0291,-4472.2164 1370.6957,-4412.4118 1403.2379,-4347.1543 1420.4689,-4315.1657"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1423.5628,-4316.8028 1425.287,-4306.3492 1417.4202,-4313.4459 1423.5628,-4316.8028"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge149" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1068.4738,-10367.9498C1082.0095,-10350.1387 1107.0976,-10313.8305 1116.5955,-10278.2164 1154.3466,-10136.6604 1137.1063,-5149.8987 1152.5955,-5004.2164 1168.4639,-4854.9665 1214.551,-4679.4845 1230.9414,-4620.0714"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1234.3345,-4620.9331 1233.6423,-4610.3609 1227.5905,-4619.0572 1234.3345,-4620.9331"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge229" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1076.6376,-10368.2025C1090.1511,-10358.4463 1108.0935,-10342.8758 1116.5955,-10324.2164 1181.5464,-10181.6673 1095.3239,-9766.0205 1152.5955,-9620.2164 1195.2074,-9511.7332 1277.6378,-9527.3901 1321.0291,-9419.2164 1366.5461,-9305.743 1287.025,-8970.4532 1357.0291,-8870.2164 1499.0298,-8666.8896 1654.3828,-8771.515 1867.2231,-8644.2164 1884.6189,-8633.812 1885.1178,-8625.3302 1903.2231,-8616.2164 1938.7315,-8598.3422 1970.4663,-8627.1777 1989.3882,-8592.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-8592.2164C2009.754,-8558.0761 2048.5061,-8597.3503 2075.5532,-8568.2164 2131.061,-8508.426 2084.8906,-8465.3209 2111.5532,-8388.2164 2136.2968,-8316.6614 2155.5331,-8304.3895 2188.4692,-8236.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge201" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1074.3073,-10368.0707C1088.0655,-10356.7287 1107.732,-10337.7861 1116.5955,-10316.2164 1186.3432,-10146.4802 1079.3259,-9659.4623 1152.5955,-9491.2164 1195.1885,-9393.4117 1277.31,-9417.523 1321.0291,-9320.2164 1370.2266,-9210.7161 1298.9695,-8886.2869 1357.0291,-8781.2164 1449.2461,-8614.3309 1560.6353,-8654.6677 1704.2205,-8529.2164 1903.7586,-8354.8785 2114.0999,-8110.4281 2172.5866,-8041.1682"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2175.4803,-8043.1655 2179.2449,-8033.2621 2170.1261,-8038.6563 2175.4803,-8043.1655"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge276" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1068.4837,-10367.9525C1082.0328,-10350.1449 1107.1384,-10313.8413 1116.5955,-10278.2164 1144.876,-10171.6828 1096.203,-2436.9216 1152.5955,-2342.2164 1169.9365,-2313.0938 1669.7006,-2054.8953 1740.2205,-2038.2164 1795.1506,-2025.2246 1819.2076,-2008.5411 1867.2231,-2038.2164 1897.657,-2057.0255 1875.6165,-2087.4595 1903.2231,-2110.2164 1964.5728,-2160.7885 2014.0618,-2107.8168 2075.5532,-2158.2164 2102.9166,-2180.644 2083.8623,-2207.1945 2111.5532,-2229.2164 2139.1129,-2251.1339 2157.9726,-2230.6133 2188.4692,-2248.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge610" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-11333.2164C3325.4522,-11492.4483 3145.643,-11747.8831 3360.8456,-11790.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1111.8944,-10390.4214C1113.6147,-10391.8448 1115.1956,-10393.4367 1116.5955,-10395.2164 1186.2272,-10483.7386 1092.1956,-11313.1553 1152.5955,-11408.2164 1256.978,-11572.5002 1353.0071,-11562.4924 1542.2007,-11608.2164 2257.3554,-11781.0538 2668.6581,-10799.0642 3174.6229,-11333.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3360.8456,-11790.2164C3434.4786,-11804.701 3467.8335,-11876.4029 3525.3633,-11828.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~faultsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge290" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~faultsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1062.2083,-10390.3185C1071.8911,-10430.8136 1104.9584,-10574.522 1116.5955,-10695.2164 1173.3525,-11283.874 1137.2369,-12765.0284 1152.5955,-13356.2164 1175.9346,-14254.5973 1227.8498,-15359.3535 1235.7862,-15525.8095"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1232.3073,-15526.3356 1236.2806,-15536.1571 1239.2993,-15526.0014 1232.3073,-15526.3356"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge324" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1068.4836,-10367.9524C1082.0324,-10350.1448 1107.1377,-10313.8411 1116.5955,-10278.2164 1144.6251,-10172.6365 1091.804,-2503.9752 1152.5955,-2413.2164 1191.9625,-2354.4432 1670.8564,-2182.0973 1740.2205,-2168.2164 1888.1064,-2138.6218 1947.2449,-2140.9505 2075.5532,-2220.2164 2096.4693,-2233.1378 2091.5,-2247.9928 2111.5532,-2262.2164 2185.4137,-2314.605 2213.8448,-2313.0515 2301.3853,-2336.2164 2375.379,-2355.7965 2916.7054,-2474.5534 2982.9529,-2436.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-2436.2164C3101.8369,-2357.1088 2992.0441,-2237.2811 3089.8293,-2133.2164 3112.2296,-2109.3776 3347.5722,-1988.3186 3360.8456,-2018.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge352" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-12088.2164C1247.2837,-12124.6862 1295.1408,-12074.4766 1321.0291,-12102.2164 1378.1477,-12163.4202 1323.6548,-12400.44 1357.0291,-12477.2164 1405.0567,-12587.7025 2025.1359,-13179.8 2075.5532,-13289.2164 2123.8212,-13393.9681 2044.0184,-13452.719 2111.5532,-13546.2164 2156.2058,-13608.0348 2220.8766,-13560.2943 2265.3853,-13622.2164 2335.0153,-13719.0882 2222.9982,-13798.2833 2301.3853,-13888.2164 2376.5219,-13974.4203 2694.4695,-14076.5998 2797.125,-14026.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge440" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1236.8123,-9731.2164C1263.2994,-9682.5202 1297.1014,-9689.2198 1321.0291,-9639.2164 1366.8277,-9543.5076 1313.1229,-9499.8079 1357.0291,-9403.2164 1409.7745,-9287.1787 1457.7728,-9279.7085 1542.2007,-9184.2164 1546.0591,-9179.8523 2106.8872,-8571.7035 2111.5532,-8568.2164 2172.6377,-8522.565 2215.0717,-8549.5218 2265.3853,-8492.2164 2487.5584,-8239.1688 2375.3158,-8083.7316 2510.269,-7775.2164 2574.6566,-7628.0205 2636.1481,-7611.145 2682.1736,-7457.2164 2709.0091,-7367.4669 2673.6503,-7119.6347 2718.1736,-7037.2164 2760.5848,-6958.7077 2826.9597,-6987.7139 2876.0764,-6913.2164 3239.9174,-6361.3632 3144.4903,-6127.1497 3259.4165,-5476.2164 3338.2554,-5029.6789 3357.1541,-4473.2637 3360.3122,-4358.5"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3363.8173,-4358.3502 3360.5837,-4348.2609 3356.8198,-4358.1646 3363.8173,-4358.3502"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1076.4661,-10368.1225C1089.8774,-10358.3187 1107.7661,-10342.7231 1116.5955,-10324.2164 1196.5048,-10156.7219 1103.9523,-10087.3078 1152.5955,-9908.2164 1175.4302,-9824.145 1197.3003,-9808.858 1236.8123,-9731.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge506" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1066.4993,-10390.4773C1079.3323,-10411.8704 1106.2868,-10460.2745 1116.5955,-10505.2164 1134.0771,-10581.4294 1102.9897,-11851.7739 1152.5955,-11912.2164 1201.2804,-11971.537 1262.2418,-11900.8887 1321.0291,-11950.2164 1352.771,-11976.8506 1325.7824,-12009.0026 1357.0291,-12036.2164 1528.2273,-12185.3187 1657.2844,-12147.6227 1867.2231,-12061.2164 2177.0582,-11933.6948 2269.7978,-11879.6425 2474.269,-11614.2164 2500.8122,-11579.7604 2492.4379,-11562.8876 2510.269,-11523.2164 2534.9822,-11468.2339 2568.0772,-11405.3652 2585.0898,-11373.7139"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2588.3478,-11375.0464 2590.0173,-11364.584 2582.1877,-11371.7218 2588.3478,-11375.0464"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge535" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1431.6149,-12354.2164C1454.3708,-12380.5758 1475.1283,-12362.4952 1506.2007,-12378.2164 1523.8114,-12387.1266 1526.1387,-12392.7472 1542.2007,-12404.2164 1954.8721,-12698.8878 2154.0726,-12669.0202 2474.269,-13062.2164 2559.9797,-13167.4677 2496.227,-13434.0058 2596.2213,-13342.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2596.2213,-13342.2164C2699.2496,-13248.8617 2777.2339,-12789.9673 2793.8402,-12685.4359"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2797.3136,-12685.8779 2795.4092,-12675.4556 2790.3986,-12684.7907 2797.3136,-12685.8779"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge542" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1062.1794,-10390.3214C1071.7631,-10430.8261 1104.5329,-10574.5638 1116.5955,-10695.2164 1135.9322,-10888.6266 1111.2909,-12254.2812 1152.5955,-12444.2164 1192.7171,-12628.712 1267.889,-12653.041 1321.0291,-12834.2164 1348.7912,-12928.8686 1324.7089,-12960.022 1357.0291,-13053.2164 1364.8537,-13075.7786 2177.3566,-14537.0791 2188.4692,-14558.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M2387.8271,-15054.2164C2534.5255,-14958.6927 2581.91,-14727.1344 2593.2363,-14656.2125"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2596.7072,-14656.6679 2594.7542,-14646.2546 2589.7871,-14655.613 2596.7072,-14656.6679"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M2188.4692,-14558.2164C2247.9015,-14661.0725 2288.2793,-15119.0377 2387.8271,-15054.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge430" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-5854.2164C1240.6198,-5846.8177 1499.3976,-5728.0076 1506.2007,-5723.2164 1535.9449,-5702.2684 1712.2249,-5517.4496 1740.2205,-5494.2164 1895.2564,-5365.5537 1919.4072,-5294.7979 2111.5532,-5234.2164 2176.7588,-5213.6578 2197.0637,-5231.6493 2265.3853,-5234.2164 2345.2841,-5237.2185 2919.3687,-5336.692 2982.9529,-5288.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge401" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1068.4676,-10367.9482C1081.9951,-10350.1349 1107.0724,-10313.8237 1116.5955,-10278.2164 1147.9377,-10161.0255 1095.288,-6018.1364 1152.5955,-5911.2164 1173.9468,-5871.3807 1216.1308,-5894.4039 1236.8123,-5854.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-5854.2164C1256.043,-5816.848 1295.2836,-5844.4336 1321.0291,-5811.2164 1365.9467,-5753.2629 1318.7897,-5712.7779 1357.0291,-5650.2164 1401.9912,-5576.656 1457.9387,-5597.6552 1506.2007,-5526.2164 1535.4703,-5482.8906 1512.7977,-5457.4517 1542.2007,-5414.2164 1594.5909,-5337.1797 1639.4638,-5348.1937 1704.2205,-5281.2164 1722.5099,-5262.2997 1719.7065,-5250.6943 1740.2205,-5234.2164 2045.7875,-4988.7681 2204.4824,-5034.7356 2596.2213,-5022.2164"/>
</g>
<!-- sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge470" class="edge">
<title>sourcefile~schedulemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1062.1756,-10390.3218C1071.7462,-10430.8278 1104.4765,-10574.5694 1116.5955,-10695.2164 1125.8871,-10787.7168 1109.7604,-12285.7068 1152.5955,-12368.2164 1195.4268,-12450.7187 1275.3059,-12411.2809 1321.0291,-12492.2164 1363.7301,-12567.8025 1332.7778,-12797.8586 1357.0291,-12881.2164 1407.4011,-13054.3583 1426.6225,-13103.8071 1542.2007,-13242.2164 1571.2612,-13277.0174 1593.6655,-13269.8258 1623.2106,-13304.2164"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge910" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3525.3633,-7242.2164C3585.6759,-7274.6059 3624.092,-7259.5298 3659.3423,-7318.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2818.4393,-7212.0752C2840.9895,-7200.966 2877.9598,-7184.6562 2912.0764,-7178.2164 3181.3729,-7127.3838 3283.9239,-7112.5569 3525.3633,-7242.2164"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge94" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2982.9529,-7279.2164C3033.0299,-7278.1861 3089.1688,-7266.0135 3127.6801,-7255.9073"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3128.8127,-7259.2273 3137.5651,-7253.2569 3126.9999,-7252.4661 3128.8127,-7259.2273"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2818.245,-7234.3164C2852.0871,-7251.004 2920.9674,-7280.4917 2982.9529,-7279.2164"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge642" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2799.7649,-7212.1456C2808.8836,-7176.2206 2842.3904,-7061.6162 2912.0764,-6999.2164 3005.0982,-6915.9206 3049.758,-6899.2164 3174.6229,-6899.2164 3174.6229,-6899.2164 3174.6229,-6899.2164 3525.3633,-6899.2164 3651.1191,-6899.2164 3744.5933,-7052.4718 3774.4425,-7108.2355"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3771.383,-7109.9377 3779.1242,-7117.1712 3777.5835,-7106.689 3771.383,-7109.9377"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge611" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2833.8393,-7212.1996C2902.8944,-7193.4215 3055.8511,-7161.1267 3174.6229,-7203.2164"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge325" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2800.9181,-7211.9944C2820.7029,-7153.4681 2911.1963,-6885.8829 2912.0764,-6885.2164 2951.8827,-6855.0682 3342.2417,-6907.5559 3360.8456,-6861.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3360.8456,-6861.2164C3420.4821,-6705.2321 3410.4102,-6657.4569 3426.2747,-6491.2164 3438.7263,-6360.7383 3411.1512,-4252.9058 3462.2747,-4132.2164 3470.0743,-4113.8035 3486.0681,-4097.9307 3499.9996,-4086.7234"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3502.4961,-4089.2206 3508.3158,-4080.3672 3498.2453,-4083.659 3502.4961,-4089.2206"/>
</g>
<!-- sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge353" class="edge">
<title>sourcefile~hvacwatercoilcomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2797.3849,-7234.2725C2800.4617,-7361.8508 2831.2741,-8553.0127 2912.0764,-8684.2164 2950.7181,-8746.9613 3017.3045,-8706.2161 3053.8293,-8770.2164 3138.4279,-8918.4533 3012.2637,-11690.1812 3089.8293,-11842.2164 3100.5014,-11863.1345 3121.7114,-11878.8884 3140.2476,-11889.4108"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.6093,-11892.5037 3149.0745,-11894.1558 3141.9237,-11886.3381 3138.6093,-11892.5037"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge911" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2828.4048,-9273.3691C2843.6286,-9269.5456 2861.6993,-9263.4915 2876.0764,-9254.2164 3090.3844,-9115.9602 3151.8432,-9058.4537 3259.4165,-8827.2164 3263.6964,-8818.0163 3455.7174,-7387.9599 3462.2747,-7380.2164 3521.6104,-7310.1463 3612.0645,-7239.5058 3659.3423,-7318.2164"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge97" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2828.4002,-9277.4522C2845.1845,-9274.7664 2864.704,-9268.5021 2876.0764,-9254.2164 2938.0053,-9176.4229 2867.3707,-8897.0331 2912.0764,-8808.2164 2930.8933,-8770.8329 2973.1269,-8786.8987 2982.9529,-8746.2164"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge255" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2797.72,-9290.3125C2803.7172,-9401.7278 2854.2359,-10330.2975 2912.0764,-11081.2164 2935.4575,-11384.7628 2971.7315,-11753.6072 2980.8287,-11844.9829"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2977.3683,-11845.5546 2981.8437,-11855.1578 2984.3337,-11844.8597 2977.3683,-11845.5546"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge79" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.6425,-9290.4458C2803.2005,-9411.4472 2852.1228,-10486.575 2876.0764,-11357.2164 2877.6909,-11415.8971 2877.7597,-13422.5886 2912.0764,-13470.2164 2915.6924,-13475.2349 2920.3996,-13479.2521 2925.67,-13482.4667"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2924.4723,-13485.7822 2934.978,-13487.1539 2927.6207,-13479.5302 2924.4723,-13485.7822"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge327" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-8822.2164C3081.754,-8748.3934 3175.0256,-8888.1589 3259.4165,-8798.2164 3319.1133,-8734.5924 3260.0316,-7307.9636 3295.4165,-7228.2164 3311.6647,-7191.5977 3357.5929,-7206.1457 3360.8456,-7166.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3360.8456,-7166.2164C3371.6277,-7034.0934 3410.7813,-7006.87 3426.2747,-6875.2164 3444.0868,-6723.8588 3402.9809,-4272.6109 3462.2747,-4132.2164 3470.0546,-4113.7951 3486.0486,-4097.9225 3499.9851,-4086.7173"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3502.4824,-4089.2141 3508.3049,-4080.3626 3498.2333,-4083.6511 3502.4824,-4089.2141"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge355" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2798.7245,-9290.4252C2815.9159,-9411.209 2967.5874,-10484.5085 3053.8293,-11357.2164 3064.4576,-11464.7668 3037.7365,-11747.5254 3089.8293,-11842.2164 3101.1727,-11862.8355 3122.4489,-11878.6129 3140.8502,-11889.2217"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3139.416,-11892.4265 3149.869,-11894.1546 3142.7752,-11886.2851 3139.416,-11892.4265"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge444" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M2982.9529,-8822.2164C3017.7377,-8796.2256 3152.3709,-8821.5038 3174.6229,-8784.2164"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M2828.311,-9277.3806C2845.0665,-9274.6716 2864.5869,-9268.408 2876.0764,-9254.2164 2928.0575,-9190.01 2874.3288,-8957.6984 2912.0764,-8884.2164 2931.2001,-8846.9889 2949.426,-8847.2672 2982.9529,-8822.2164"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M3174.6229,-8784.2164C3235.3733,-8682.4177 3350.8334,-4687.3367 3360.234,-4358.6751"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3363.7364,-4358.6386 3360.5234,-4348.5428 3356.7392,-4358.4387 3363.7364,-4358.6386"/>
</g>
<!-- sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge403" class="edge">
<title>sourcefile~dxcoil.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2798.8017,-9267.9954C2808.6083,-9201.7719 2858.6986,-8855.1637 2876.0764,-8570.2164 2898.3707,-8204.6515 2860.0459,-5636.7457 2912.0764,-5274.2164 2924.6948,-5186.2958 2959.3551,-5085.7461 2975.0482,-5043.0922"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.3961,-5044.1311 2978.6044,-5033.5383 2971.8358,-5041.6892 2978.3961,-5044.1311"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge912" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.4371,-9933.4218C776.792,-9956.1789 808.2849,-10009.9235 819.7932,-10060.2164 895.8375,-10392.5393 763.492,-12800.037 855.7932,-13128.2164 881.8353,-13220.8095 936.7349,-13222.7295 966.4307,-13314.2164 1020.7186,-13481.4668 974.4878,-13534.6102 1002.4307,-13708.2164 1075.1072,-14159.7482 1370.889,-15270.1702 1542.2007,-15694.2164 1612.9474,-15869.3351 1633.239,-15914.5673 1740.2205,-16070.2164 1997.1844,-16444.0772 2070.694,-16628.0726 2510.269,-16740.2164 2715.0588,-16792.462 2774.0235,-16656.3263 2982.9529,-16688.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge44" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-9960.2164C1064.2455,-10047.5237 1542.1838,-10043.6179 1704.2205,-9974.2164 1800.7372,-9932.8776 1798.978,-9883.0097 1867.2231,-9803.2164 1884.3255,-9783.22 1881.4237,-9770.9518 1903.2231,-9756.2164 1936.1581,-9733.9539 1950.0022,-9726.8244 1989.3882,-9732.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M788.7698,-9924.4215C822.0096,-9927.9162 873.238,-9936.9389 911.1119,-9960.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge68" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M761.4748,-9933.2798C774.3554,-9956.2126 803.7179,-10010.9135 819.7932,-10060.2164 845.7594,-10139.8546 821.7376,-10168.6872 855.7932,-10245.2164 889.0379,-10319.9234 938.8965,-10315.2214 966.4307,-10392.2164 1031.0635,-10572.9518 936.7271,-11074.8674 1002.4307,-11255.2164 1030.8672,-11333.2716 1088.6455,-11324.9856 1116.5955,-11403.2164 1162.6336,-11532.0754 1075.1154,-12521.429 1152.5955,-12634.2164 1299.9943,-12848.7843 2023.5717,-13096.6113 2265.3853,-13000.2164 2384.2091,-12952.8492 2421.6886,-12918.827 2474.269,-12802.2164 2521.1577,-12698.2286 2488.2511,-11888.1414 2510.269,-11776.2164 2526.3463,-11694.4897 2567.1051,-11603.4254 2586.1396,-11563.656"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.3765,-11565.002 2590.5859,-11554.4764 2583.0767,-11561.9505 2589.3765,-11565.002"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge96" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M762.1031,-9910.9104C777.3647,-9886.6211 815.5986,-9828.255 855.7932,-9786.2164 973.2225,-9663.3996 1019.504,-9650.8585 1152.5955,-9545.2164 1575.107,-9209.8452 1601.2108,-8975.9746 2111.5532,-8801.2164 2365.3811,-8714.2973 2495.5465,-8805.463 2682.1736,-8998.2164 2710.1431,-9027.104 2699.1194,-9045.8083 2718.1736,-9081.2164 2748.6025,-9137.762 2754.3741,-9250.1297 2797.125,-9202.2164"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2797.125,-9202.2164C2865.9181,-9130.6124 2851.5944,-9089.4466 2876.0764,-8993.2164 2904.9478,-8879.7332 2856.4939,-8835.2823 2912.0764,-8732.2164 2931.9422,-8695.3795 2967.7559,-8709.2119 2982.9529,-8670.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge110" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M911.1119,-6766.2164C918.6179,-6700.5664 952.0875,-6692.7185 966.4307,-6628.2164 997.2547,-6489.5988 955.7273,-6124.3198 1002.4307,-5990.2164 1031.4001,-5907.034 1088.0672,-5911.5511 1116.5955,-5828.2164 1144.9107,-5745.5039 1098.3419,-5110.7705 1152.5955,-5042.2164 1176.7481,-5011.6974 1223.2806,-5054.7082 1236.8123,-5018.2164"/>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1236.8123,-5018.2164C1272.5405,-4922.4531 1296.0986,-4903.3404 1321.0291,-4804.2164 1337.6218,-4738.2434 1310.5811,-4549.9189 1357.0291,-4500.2164 1380.058,-4475.5738 1412.1416,-4513.7551 1431.6149,-4486.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge123" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M1989.3882,-6443.2164C2004.0369,-6427.4303 2115.7465,-6345.2781 2165.1242,-6309.2175"/>
<polygon fill="#fff100" stroke="#fff100" points="2167.2945,-6311.9667 2173.3097,-6303.245 2163.1685,-6306.3119 2167.2945,-6311.9667"/>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M911.1119,-7032.2164C927.4634,-7012.0071 948.2078,-7032.6769 966.4307,-7051.2164 1002.7863,-7088.2035 968.7054,-7122.8161 1002.4307,-7162.2164 1051.0717,-7219.0424 1079.8378,-7220.8532 1152.5955,-7238.2164 1225.4101,-7255.5931 1250.0162,-7261.9039 1321.0291,-7238.2164 1418.6469,-7205.6543 1435.4536,-7173.9451 1506.2007,-7099.2164 1724.5086,-6868.6219 1682.5981,-6733.5949 1903.2231,-6505.2164 1936.0028,-6471.2848 1957.2966,-6477.7995 1989.3882,-6443.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge188" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M755.3285,-9911.1298C758.7331,-9719.0589 806.1274,-7093.8748 855.7932,-6942.2164 882.9282,-6859.3575 930.446,-6859.633 966.4307,-6780.2164 992.9465,-6721.697 977.9648,-6699.622 1002.4307,-6640.2164 1040.6747,-6547.356 1088.1229,-6541.523 1116.5955,-6445.2164 1166.7342,-6275.625 1090.7087,-5815.8821 1152.5955,-5650.2164 1201.3994,-5519.5723 1426.6681,-5236.3311 1542.2007,-5158.2164 1604.4167,-5116.1504 1655.1955,-5167.1104 1704.2205,-5110.2164 1779.2225,-5023.1757 1653.756,-4929.8819 1740.2205,-4854.2164 1890.1455,-4723.016 2001.2157,-4919.2395 2188.4692,-4851.2164"/>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M2188.4692,-4851.2164C2256.414,-4825.6732 2237.518,-4767.7116 2301.3853,-4733.2164 2310.544,-4728.2696 2320.9582,-4724.823 2331.3088,-4722.4284"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2332.059,-4725.8476 2341.17,-4720.4401 2330.6755,-4718.9857 2332.059,-4725.8476"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge256" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M762.1933,-9933.4813C776.1098,-9956.3453 806.8533,-10010.2726 819.7932,-10060.2164 878.1189,-10285.3344 807.0686,-10354.827 855.7932,-10582.2164 885.5688,-10721.1736 939.2888,-10742.7208 966.4307,-10882.2164 1015.6873,-11135.3708 979.0845,-11785.3733 1002.4307,-12042.2164 1033.1119,-12379.7555 1069.9111,-12460.5163 1116.5955,-12796.2164 1134.1204,-12922.2359 1109.0353,-12960.6732 1152.5955,-13080.2164 1226.2888,-13282.4546 1544.9605,-13759.6373 1740.2205,-13850.2164 1958.7935,-13951.6102 2687.4547,-13822.7561 2797.125,-13608.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2797.125,-13608.2164C2835.4734,-13531.5392 2857.1565,-13515.8347 2876.0764,-13432.2164 2894.9748,-13348.6932 2861.7967,-11960.536 2912.0764,-11891.2164 2914.3556,-11888.0741 2917.0622,-11885.3246 2920.0661,-11882.9189"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.171,-11885.7244 2928.6228,-11877.3206 2918.3385,-11879.8668 2922.171,-11885.7244"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge643" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M762.377,-9933.4358C776.6238,-9956.218 807.9319,-10010.0055 819.7932,-10060.2164 855.4655,-10211.2228 848.0754,-11301.2458 855.7932,-11456.2164 866.7935,-11677.0992 968.7307,-13222.6425 1002.4307,-13441.2164 1046.6219,-13727.8359 1074.2087,-13797.0048 1152.5955,-14076.2164 1231.8198,-14358.4114 1250.2886,-14430.2383 1357.0291,-14703.2164 1414.9079,-14851.2357 1458.9184,-14876.4795 1506.2007,-15028.2164 1533.7208,-15116.5333 1512.2873,-15145.6811 1542.2007,-15233.2164 1632.5913,-15497.7259 1657.2348,-15615.4555 1903.2231,-15748.2164 2239.6587,-15929.792 3292.7978,-16336.5947 3588.4519,-16094.2164 3651.5445,-16042.4928 3579.549,-15982.3319 3624.4519,-15914.2164 3634.8109,-15898.5023 3651.5063,-15907.3288 3659.3423,-15890.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge650" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M911.1119,-7032.2164C976.3101,-6954.8425 1026.7021,-6980.6568 1116.5955,-6934.2164 1209.0215,-6886.4675 1239.1207,-6884.3534 1321.0291,-6820.2164 1434.4657,-6731.3916 1410.2238,-6641.0074 1542.2007,-6583.2164 1650.7715,-6535.6746 1975.5334,-6517.6249 2075.5532,-6581.2164 2154.2313,-6631.239 2179.0316,-6752.1327 2186.0074,-6801.0967"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="2182.5569,-6801.7033 2187.3301,-6811.162 2189.4973,-6800.7912 2182.5569,-6801.7033"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge662" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M755.3733,-9911.0215C760.7171,-9661.8757 853.497,-5337.2711 855.7932,-5306.2164 889.8521,-4845.601 1081.4542,-3704.7504 1116.5955,-3244.2164 1122.3376,-3168.9642 1106.3325,-1945.8452 1152.5955,-1886.2164 1176.453,-1855.4661 1219.4949,-1897.0713 1236.8123,-1862.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge684" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.7454,-9911.0259C765.79,-9727.4292 896.2413,-7343.0243 909.9489,-7092.4737"/>
<polygon fill="#00ffff" stroke="#00ffff" points="913.4458,-7092.6254 910.4974,-7082.4491 906.4562,-7092.243 913.4458,-7092.6254"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge693" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M911.1119,-6766.2164C914.0911,-6739.5822 950.5563,-6763.8094 966.4307,-6742.2164 1011.0414,-6681.535 991.0484,-6479.6663 1002.4307,-6405.2164 1017.6969,-6305.3626 1043.8369,-6187.4458 1054.6307,-6140.2649"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1058.0857,-6140.8574 1056.9172,-6130.3272 1051.264,-6139.2877 1058.0857,-6140.8574"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge703" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00aeff" stroke-dasharray="5,2" d="M1059.5131,-10264.2164C1074.1177,-10311.2595 1102.7008,-10311.9587 1116.5955,-10359.2164 1153.1578,-10483.57 1089.3945,-11412.0515 1152.5955,-11525.2164 1203.862,-11617.012 1322.3407,-11671.0426 1387.2012,-11694.7803"/>
<polygon fill="#00aeff" stroke="#00aeff" points="1386.1552,-11698.1232 1396.7498,-11698.1975 1388.5139,-11691.5326 1386.1552,-11698.1232"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge711" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M769.9695,-9911.1554C820.2893,-9874.4213 990.3754,-9756.5866 1152.5955,-9717.2164 1225.343,-9699.5608 1255.0824,-9681.7909 1321.0291,-9717.2164 1379.3007,-9748.5189 1412.0322,-9825.5087 1425.0054,-9863.006"/>
<polygon fill="#005dff" stroke="#005dff" points="1421.8074,-9864.4825 1428.2752,-9872.874 1428.4521,-9862.2806 1421.8074,-9864.4825"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge719" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M776.2948,-9933.2547C819.6367,-9957.0472 918.4522,-10017.5996 966.4307,-10098.2164 1008.1548,-10168.3241 974.0034,-10201.7449 1002.4307,-10278.2164 1013.5784,-10308.2048 1032.8689,-10339.8635 1045.9054,-10359.5743"/>
<polygon fill="#000dff" stroke="#000dff" points="1043.0818,-10361.6474 1051.5714,-10367.986 1048.8875,-10357.7367 1043.0818,-10361.6474"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge745" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M911.1119,-8908.2164C929.84,-8865.4307 957.2813,-8948.2627 1002.4307,-8960.2164 1140.2838,-8996.7143 1219.2911,-9022.1413 1321.0291,-8922.2164 1377.991,-8866.2695 1300.3096,-8802.4091 1357.0291,-8746.2164 1588.1565,-8517.2353 1791.4325,-8764.7335 2075.5532,-8606.2164 2096.1531,-8594.7233 2090.1729,-8577.1827 2111.5532,-8567.2164 2222.9674,-8515.2812 2279.978,-8613.1989 2387.8271,-8554.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2387.8271,-8554.2164C2418.4892,-8528.729 2445.9667,-8558.301 2474.269,-8530.2164 2489.1783,-8515.4217 2677.2401,-7823.6327 2682.1736,-7803.2164 2734.4636,-7586.8238 2780.6539,-7320.8274 2793.5536,-7244.5621"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2797.0641,-7244.7917 2795.2733,-7234.3493 2790.1613,-7243.6293 2797.0641,-7244.7917"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge785" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1059.5131,-10264.2164C1074.1536,-10311.2483 1102.5973,-10311.9892 1116.5955,-10359.2164 1132.7248,-10413.6338 1111.7609,-11340.7962 1152.5955,-11380.2164 1206.4536,-11432.209 1250.4942,-11405.2913 1321.0291,-11380.2164 1440.4459,-11337.764 1437.1025,-11271.0469 1542.2007,-11200.2164 1730.3066,-11073.443 1772.7878,-11021.5931 1989.3882,-10954.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge803" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M911.1119,-6766.2164C918.585,-6700.5627 951.9727,-6692.6929 966.4307,-6628.2164 995.6569,-6497.8799 945.1068,-6148.8636 1002.4307,-6028.2164 1032.0155,-5965.9504 1087.503,-5985.7139 1116.5955,-5923.2164 1154.8485,-5841.0397 1094.4425,-5177.7472 1152.5955,-5108.2164 1201.8289,-5049.3502 1254.0569,-5107.6849 1321.0291,-5070.2164 1423.934,-5012.6448 1435.5501,-4974.6219 1506.2007,-4880.2164 1525.7549,-4854.0875 1522.478,-4842.2183 1542.2007,-4816.2164 1603.7393,-4735.0852 1639.3825,-4732.7359 1704.2205,-4654.2164 1804.6875,-4532.5497 1775.6415,-4453.0568 1903.2231,-4360.2164 1914.4637,-4352.0367 1928.3395,-4346.5218 1941.6469,-4342.8078"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1942.8069,-4346.1256 1951.6592,-4340.3045 1941.1089,-4339.3347 1942.8069,-4346.1256"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge814" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M911.1119,-7032.2164C942.2917,-6998.4994 1071.9256,-7020.8755 1116.5955,-7010.2164 1227.7323,-6983.6969 1249.1825,-6956.9497 1357.0291,-6919.2164 1422.7677,-6896.2158 1460.4522,-6923.7299 1506.2007,-6871.2164 1566.9646,-6801.467 1494.4957,-6745.4721 1542.2007,-6666.2164 1554.1717,-6646.3281 1574.9409,-6630.3654 1592.452,-6619.484"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1594.4355,-6622.3769 1601.2484,-6614.263 1590.8626,-6616.3574 1594.4355,-6622.3769"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge831" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M762.2125,-9933.2516C792.9158,-9981.7358 915.3029,-10181.5678 966.4307,-10364.2164 1009.6566,-10518.6362 976.6692,-10564.9434 1002.4307,-10723.2164 1039.3284,-10949.908 1086.754,-10999.4884 1116.5955,-11227.2164 1130.3345,-11332.0624 1111.3991,-12080.829 1152.5955,-12178.2164 1334.6172,-12608.5123 1820.7311,-12645.4093 2188.4692,-12357.2164"/>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M2188.4692,-12357.2164C2302.27,-12213.6448 2364.9585,-11994.9689 2382.5995,-11926.4836"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2386.0704,-11927.034 2385.1279,-11916.4812 2379.2838,-11925.3184 2386.0704,-11927.034"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge845" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M911.1119,-8908.2164C973.3675,-8777.5318 1093.1508,-8890.4517 1236.8123,-8908.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge867" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M911.1119,-7032.2164C934.4566,-7003.6015 944.9598,-7000.2628 966.4307,-6970.2164 985.4051,-6943.6634 983.2495,-6932.6203 1002.4307,-6906.2164 1046.459,-6845.6088 1087.9267,-6851.4253 1116.5955,-6782.2164 1153.6639,-6692.7297 1091.6094,-5986.4669 1152.5955,-5911.2164 1201.2408,-5851.1931 1246.9101,-5890.0233 1321.0291,-5868.2164 1512.9033,-5811.7639 2016.0101,-5526.9226 2188.4692,-5628.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M755.3403,-9910.9249C759.2125,-9700.622 816.5288,-6621.066 855.7932,-6438.2164 882.6753,-6313.0295 938.0766,-6297.0781 966.4307,-6172.2164 1034.0399,-5874.4879 913.1562,-5778.1809 1002.4307,-5486.2164 1031.2375,-5392.0061 1087.6279,-5390.3773 1116.5955,-5296.2164 1137.6684,-5227.7173 1105.5235,-4706.2574 1152.5955,-4652.2164 1202.6988,-4594.6951 1270.0431,-4675.9568 1321.0291,-4619.2164 1351.8906,-4584.8716 1351.4811,-4251.0554 1357.0291,-4205.2164 1378.5817,-4027.1428 1415.8071,-3813.6284 1427.7843,-3746.4882"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1431.2839,-3746.801 1429.6016,-3736.3406 1424.3935,-3745.567 1431.2839,-3746.801"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge78" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.2632,-9933.4635C776.3055,-9956.2955 807.2639,-10010.168 819.7932,-10060.2164 893.9371,-10356.3851 821.4072,-10442.8505 855.7932,-10746.2164 871.8516,-10887.8894 896.1188,-10920.4267 911.1119,-11062.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-11062.2164C916.453,-11112.7264 953.0396,-11113.2218 966.4307,-11162.2164 1003.6785,-11298.4966 987.6174,-12292.7162 1002.4307,-12433.2164 1003.6404,-12444.6901 1148.721,-13239.3491 1152.5955,-13250.2164 1204.7286,-13396.4425 1259.3763,-13413.7423 1321.0291,-13556.2164 1341.626,-13603.8141 1329.8981,-13623.0158 1357.0291,-13667.2164 1446.6448,-13813.2143 1745.1264,-14145.2482 1903.2231,-14211.2164 2187.4771,-14329.8254 2327.5804,-14065.5495 2596.2213,-14216.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge134" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.3018,-9911.0827C758.3731,-9709.7936 802.9814,-6845.8625 855.7932,-6780.2164 871.6903,-6760.4559 908.2928,-6791.4204 911.1119,-6766.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-6766.2164C919.3358,-6692.6923 952.1737,-6681.8122 966.4307,-6609.2164 1029.2859,-6289.1595 937.9828,-6195.9563 1002.4307,-5876.2164 1031.7714,-5730.6505 1086.1381,-5707.5527 1116.5955,-5562.2164 1167.5682,-5318.9844 1084.3016,-5243.1639 1152.5955,-5004.2164 1196.1155,-4851.9479 1270.0106,-4840.139 1321.0291,-4690.2164 1352.6651,-4597.2507 1313.2791,-4560.1334 1357.0291,-4472.2164 1399.9106,-4386.0444 1451.7014,-4394.5527 1506.2007,-4315.2164 1559.0174,-4238.3294 1599.9057,-4133.8918 1615.894,-4089.9973"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1619.2462,-4091.0184 1619.3337,-4080.4239 1612.6585,-4088.6514 1619.2462,-4091.0184"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge166" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.2767,-9911.1164C757.7906,-9718.7298 793.2595,-7085.9019 855.7932,-6752.2164 883.0479,-6606.7831 938.3251,-6583.4876 966.4307,-6438.2164 1001.4139,-6257.3955 931.7651,-5780.2939 1002.4307,-5610.2164 1031.1735,-5541.0382 1087.7724,-5555.3612 1116.5955,-5486.2164 1150.233,-5405.5217 1098.3419,-4768.7705 1152.5955,-4700.2164 1200.9007,-4639.1784 1269.2118,-4710.3026 1321.0291,-4652.2164 1386.4006,-4578.936 1325.3866,-4527.1799 1357.0291,-4434.2164 1372.3548,-4389.1903 1401.2133,-4341.2836 1418.1898,-4315.1272"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1421.2812,-4316.7967 1423.8596,-4306.5204 1415.4356,-4312.9458 1421.2812,-4316.7967"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge151" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.3219,-9911.1948C758.802,-9708.8633 809.7923,-6784.2469 855.7932,-6410.2164 883.7874,-6182.5978 932.5818,-6133.0382 966.4307,-5906.2164 995.9136,-5708.6512 963.3518,-5654.1094 1002.4307,-5458.2164 1018.5185,-5377.5719 1036.7944,-5361.2493 1059.5131,-5282.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge230" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-8098.2164C1852.1264,-8034.0075 1983.7504,-7947.018 2265.3853,-7628.2164 2286.9923,-7603.7578 2274.8374,-7583.1978 2301.3853,-7564.2164 2307.5308,-7559.8224 2314.5316,-7556.5294 2321.8272,-7554.076"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2323.2354,-7557.3151 2331.9058,-7551.2262 2321.3307,-7550.5792 2323.2354,-7557.3151"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.5854,-9911.1471C759.4805,-9818.4758 788.849,-9170.7315 855.7932,-8989.2164 870.878,-8948.315 893.2759,-8947.9952 911.1119,-8908.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-8908.2164C1054.039,-8589.4531 881.8449,-8380.9703 1152.5955,-8160.2164 1251.0507,-8079.9418 1305.2744,-8111.4656 1431.6149,-8098.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge203" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-8098.2164C1676.8583,-8062.0264 1745.2821,-8141.4164 1989.3882,-8098.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge277" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M755.3513,-9910.9851C759.7484,-9684.9546 829.4382,-6120.701 855.7932,-5906.2164 883.339,-5682.0404 935.3594,-5633.931 966.4307,-5410.2164 1005.3786,-5129.789 967.0072,-5055.1107 1002.4307,-4774.2164 1035.3023,-4513.5569 1088.8587,-4455.4722 1116.5955,-4194.2164 1122.7372,-4136.3662 1121.018,-2149.0756 1152.5955,-2100.2164 1299.7129,-1872.5845 1475.6852,-1985.9264 1704.2205,-1840.2164 1721.782,-1829.0195 1722.2299,-1820.7101 1740.2205,-1810.2164 1766.2822,-1795.0147 1773.76,-1782.6674 1803.7218,-1786.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge286" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.4406,-9910.883C759.4652,-9762.0089 801.9457,-8175.7644 819.7932,-6894.2164 821.9354,-6740.3947 826.3425,-1507.2076 855.7932,-1356.2164 864.4349,-1311.9114 886.8392,-1263.6985 900.3365,-1237.3038"/>
<polygon fill="#00ffff" stroke="#00ffff" points="903.5062,-1238.795 905.0261,-1228.3097 897.2993,-1235.5586 903.5062,-1238.795"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge615" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-15890.2164C3257.4353,-15873.5582 3296.7063,-15907.1848 3360.8456,-15852.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M762.3358,-9933.4456C776.5086,-9956.2456 807.6901,-10010.0633 819.7932,-10060.2164 872.7914,-10279.8315 817.577,-10853.5527 855.7932,-11076.2164 883.5336,-11237.8432 939.9665,-11266.3757 966.4307,-11428.2164 1032.1775,-11830.2883 931.5136,-12860.0241 1002.4307,-13261.2164 1029.6646,-13415.2841 1074.384,-13443.562 1116.5955,-13594.2164 1136.7289,-13666.0734 1133.3841,-13686.1073 1152.5955,-13758.2164 1301.2034,-14316.0094 1336.8117,-14457.7418 1542.2007,-14997.2164 1702.2625,-15417.6345 1738.6124,-15776.2164 2188.4692,-15776.2164 2188.4692,-15776.2164 2188.4692,-15776.2164 2596.2213,-15776.2164 2858.2342,-15776.2164 2917.7554,-15941.8867 3174.6229,-15890.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge326" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M755.3697,-9911.2054C760.6352,-9666.1538 852.0757,-5412.6169 855.7932,-5382.2164 882.9979,-5159.7463 935.9465,-5112.2608 966.4307,-4890.2164 1008.5602,-4583.348 959.1181,-4500.92 1002.4307,-4194.2164 1033.6986,-3972.8027 1088.8262,-3926.096 1116.5955,-3704.2164 1122.7715,-3654.8691 1121.1502,-1952.7455 1152.5955,-1914.2164 1201.118,-1854.7628 1262.8242,-1926.23 1321.0291,-1876.2164 1354.3314,-1847.6007 1326.5268,-1815.7998 1357.0291,-1784.2164 1400.281,-1739.4314 2127.9606,-1449.3423 2188.4692,-1488.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge354" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M911.1119,-11062.2164C916.4744,-11112.7241 953.1805,-11113.1835 966.4307,-11162.2164 1012.675,-11333.3455 971.3186,-12582.7006 1002.4307,-12757.2164 1029.8902,-12911.244 1082.4575,-12937.53 1116.5955,-13090.2164 1148.4981,-13232.9048 1089.0432,-13285.5392 1152.5955,-13417.2164 1198.4163,-13512.1549 1271.6923,-13491.0566 1321.0291,-13584.2164 1361.8666,-13661.3275 1319.7026,-13698.3458 1357.0291,-13777.2164 1411.6998,-13892.7354 1456.1098,-13902.7606 1542.2007,-13997.2164 1696.1145,-14166.0849 1699.9293,-14258.9203 1903.2231,-14363.2164 2118.9527,-14473.8924 2812.8302,-14692.9783 2982.9529,-14520.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge445" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M911.1119,-7032.2164C948.3723,-6985.7838 957.0504,-6972.7514 1002.4307,-6934.2164 1048.8937,-6894.7619 1085.9831,-6910.9265 1116.5955,-6858.2164 1174.9908,-6757.6679 1102.5001,-6441.1471 1152.5955,-6336.2164 1286.2865,-6056.1844 1526.6893,-6162.7235 1704.2205,-5908.2164 1741.4694,-5854.8166 1689.9151,-5807.5489 1740.2205,-5766.2164 1803.3273,-5714.3657 2392.9365,-5734.6984 2474.269,-5727.2164 2538.9429,-5721.2668 2999.0194,-5686.0585 3053.8293,-5651.2164 3137.9601,-5597.7354 3094.4979,-5521.5305 3174.6229,-5462.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge507" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M762.2125,-9933.2516C792.9158,-9981.7358 915.3029,-10181.5678 966.4307,-10364.2164 1009.6566,-10518.6362 976.6692,-10564.9434 1002.4307,-10723.2164 1039.3284,-10949.908 1086.754,-10999.4884 1116.5955,-11227.2164 1130.3345,-11332.0624 1111.3991,-12080.829 1152.5955,-12178.2164 1289.8479,-12502.6786 1408.4247,-12591.7866 1740.2205,-12710.2164 1793.3812,-12729.1913 1812.0603,-12722.1818 1867.2231,-12710.2164 1898.2794,-12703.4799 2377.5151,-12503.2751 2387.8271,-12473.2164"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2387.8271,-12473.2164C2464.816,-12238.9771 2444.0464,-12169.9241 2474.269,-11925.2164 2496.2565,-11747.1874 2460.9172,-11695.6756 2510.269,-11523.2164 2526.843,-11465.2988 2563.3483,-11403.7324 2583.0293,-11373.0335"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2586.0382,-11374.8267 2588.5564,-11364.5355 2580.1701,-11371.0101 2586.0382,-11374.8267"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge536" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M762.1119,-9933.5028C775.8822,-9956.4055 806.3757,-10010.3988 819.7932,-10060.2164 867.135,-10235.9905 802.5807,-10294.1296 855.7932,-10468.2164 885.4875,-10565.3626 939.5066,-10570.2662 966.4307,-10668.2164 1034.374,-10915.3955 964.0864,-11567.7533 1002.4307,-11821.2164 1030.9806,-12009.9369 1085.74,-12046.8591 1116.5955,-12235.2164 1163.0816,-12518.9906 1081.0209,-12602.7099 1152.5955,-12881.2164 1204.8673,-13084.613 1239.1567,-13133.41 1357.0291,-13307.2164 1425.2044,-13407.743 1430.9582,-13459.4455 1542.2007,-13508.2164 1696.5052,-13575.8664 2356.4081,-13603.8046 2596.2213,-13342.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge544" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M911.1119,-11062.2164C916.447,-11112.727 953.276,-11113.1578 966.4307,-11162.2164 1021.9222,-11369.1653 963.2929,-12879.5617 1002.4307,-13090.2164 1029.5552,-13236.2114 1076.55,-13261.2246 1116.5955,-13404.2164 1138.597,-13482.778 1124.9668,-13507.4527 1152.5955,-13584.2164 1217.5414,-13764.6628 1255.4256,-13801.5645 1357.0291,-13964.2164 1518.4297,-14222.5947 1885.223,-15025.0399 2188.4692,-15054.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M2188.4692,-15054.2164C2277.0045,-15057.6946 2313.5774,-15102.5646 2387.8271,-15054.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge574" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2188.4692,-7091.2164C2276.845,-7084.8053 2299.3159,-7085.0767 2387.8271,-7089.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1989.3882,-7089.2164C2063.3805,-7040.691 2100.2162,-7097.6185 2188.4692,-7091.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M911.1119,-7032.2164C927.545,-7012.0734 949.3859,-7031.5883 966.4307,-7051.2164 1021.9248,-7115.1214 957.7726,-7166.3198 1002.4307,-7238.2164 1046.6434,-7309.3961 1074.0684,-7322.9788 1152.5955,-7352.2164 1299.9756,-7407.0896 1355.578,-7410.4359 1506.2007,-7365.2164 1708.6855,-7304.427 1706.285,-7180.0984 1903.2231,-7103.2164 1939.3645,-7089.1073 1956.9449,-7110.4932 1989.3882,-7089.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge431" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-7032.2164C936.9741,-7001.2386 949.7058,-6996.9418 966.4307,-6960.2164 999.8821,-6886.7618 964.0866,-6853.2396 1002.4307,-6782.2164 1036.3466,-6719.3951 1087.8159,-6734.5505 1116.5955,-6669.2164 1157.6111,-6576.1045 1095.7242,-5838.5832 1152.5955,-5754.2164 1198.501,-5686.1168 1268.9509,-5741.7202 1321.0291,-5678.2164 1366.1499,-5623.1962 1312.6222,-5577.8144 1357.0291,-5522.2164 1402.9722,-5464.6949 1460.8824,-5508.2314 1506.2007,-5450.2164 1554.5469,-5388.325 1489.8329,-5335.7443 1542.2007,-5277.2164 1592.7199,-5220.7545 1648.4331,-5275.4794 1704.2205,-5224.2164 1734.4295,-5196.4572 1712.6836,-5169.6282 1740.2205,-5139.2164 1795.6219,-5078.0307 1823.2458,-5070.6281 1903.2231,-5050.2164 1977.4354,-5031.276 1999.5912,-5040.4201 2075.5532,-5050.2164 2127.2414,-5056.8822 2940.2521,-5318.0953 2982.9529,-5288.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2982.9529,-5288.2164C3072.3198,-5217.7918 3035.2542,-5154.4707 3053.8293,-5042.2164 3081.3596,-4875.8444 3040.38,-4445.4376 3089.8293,-4284.2164 3104.2141,-4237.3174 3138.0616,-4190.128 3158.3746,-4164.5935"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.3581,-4166.4714 3164.941,-4156.5007 3155.9223,-4162.0609 3161.3581,-4166.4714"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1609,-9911.159C755.6769,-9722.2534 764.3272,-7174.7077 855.7932,-7051.2164 871.2657,-7030.3265 894.842,-7052.4914 911.1119,-7032.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge402" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-5022.2164C2685.5111,-5021.8593 2709.4085,-5005.5246 2797.125,-5022.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.3206,-9911.1198C758.5468,-9721.5349 802.9945,-7164.4141 855.7932,-7018.2164 883.0883,-6942.6373 929.7637,-6946.7198 966.4307,-6875.2164 992.0326,-6825.2905 980.2663,-6805.7604 1002.4307,-6754.2164 1042.5583,-6660.898 1088.2122,-6653.7506 1116.5955,-6556.2164 1142.3882,-6467.5841 1109.1714,-5807.6737 1152.5955,-5726.2164 1196.3248,-5644.1864 1269.1381,-5679.3428 1321.0291,-5602.2164 1357.3735,-5548.197 1312.4643,-5507.6821 1357.0291,-5460.2164 1404.7003,-5409.4418 1459.7807,-5464.1373 1506.2007,-5412.2164 1559.9967,-5352.0453 1487.7076,-5293.7569 1542.2007,-5234.2164 1592.9059,-5178.8146 1653.5751,-5241.6729 1704.2205,-5186.2164 1759.2369,-5125.9736 1677.1279,-5057.9399 1740.2205,-5006.2164 1747.0079,-5000.652 2420.6605,-5005.0144 2474.269,-5008.2164 2528.729,-5011.4692 2541.6648,-5022.4345 2596.2213,-5022.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge366" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-5018.2164C1250.4168,-4981.7517 1293.1224,-5021.3453 1321.0291,-4994.2164 1359.1268,-4957.1803 1318.4132,-4916.7119 1357.0291,-4880.2164 1406.7522,-4833.2235 1459.3021,-4892.0285 1506.2007,-4842.2164 1564.5181,-4780.276 1489.9939,-4721.3877 1542.2007,-4654.2164 1591.0101,-4591.4163 1658.1014,-4643.0179 1704.2205,-4578.2164 1792.8433,-4453.6933 1657.9736,-4365.0397 1740.2205,-4236.2164 1775.6185,-4180.7725 1829.0595,-4213.7942 1867.2231,-4160.2164 1912.5348,-4096.6034 1863.0337,-4055.1833 1903.2231,-3988.2164 1928.9036,-3945.4254 1940.7123,-3927.2259 1989.3882,-3916.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge473" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1623.2106,-13494.2164C1704.8997,-13501.1828 1722.3917,-13466.5635 1803.7218,-13456.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M762.0272,-9933.5261C775.645,-9956.4706 805.8781,-10010.5355 819.7932,-10060.2164 859.8238,-10203.1366 795.509,-10256.5902 855.7932,-10392.2164 885.7926,-10459.7084 938.7302,-10447.7487 966.4307,-10516.2164 1003.5905,-10608.0649 993.4203,-11308.5461 1002.4307,-11407.2164 1035.0924,-11764.8859 1080.0525,-11849.9225 1116.5955,-12207.2164 1129.7121,-12335.4625 1098.4469,-12669.2247 1152.5955,-12786.2164 1196.2221,-12880.4747 1273.1809,-12856.0292 1321.0291,-12948.2164 1369.5031,-13041.6094 1318.7679,-13084.1955 1357.0291,-13182.2164 1400.2531,-13292.9516 1444.5247,-13302.5961 1506.2007,-13404.2164 1523.5369,-13432.7803 1516.2139,-13449.2132 1542.2007,-13470.2164 1571.4057,-13493.8206 1585.7952,-13491.0256 1623.2106,-13494.2164"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge462" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M762.4471,-9933.4195C776.8199,-9956.1726 808.3435,-10009.9101 819.7932,-10060.2164 866.9915,-10267.5891 850.5117,-13675.6059 855.7932,-13888.2164 869.4658,-14438.6098 903.4446,-15112.4877 910.0055,-15239.8983"/>
<polygon fill="#ff0000" stroke="#ff0000" points="906.5121,-15240.1166 910.5234,-15249.9227 913.5027,-15239.7555 906.5121,-15240.1166"/>
</g>
<!-- sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge755" class="edge">
<title>sourcefile~general.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-10264.2164C1074.1536,-10311.2483 1102.4553,-10312.0315 1116.5955,-10359.2164 1144.4323,-10452.1064 1082.6264,-11164.0763 1152.5955,-11231.2164 1206.6097,-11283.0467 1266.5359,-11282.543 1321.0291,-11231.2164 1418.4237,-11139.4811 1270.7449,-10732.4716 1357.0291,-10630.2164 1435.3647,-10537.381 1504.1441,-10592.2594 1623.2106,-10568.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-9960.2164C934.0976,-9973.3214 950.0943,-9961.4028 966.4307,-9982.2164 1037.9141,-10073.2909 931.8381,-10148.4497 1002.4307,-10240.2164 1019.211,-10262.03 1051.3332,-10237.939 1059.5131,-10264.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge913" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3525.3633,-479.2164C3593.8371,-453.922 3599.1458,-342.9264 3659.3423,-384.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1990.7323,-4324.1028C2000.027,-4246.6957 2054.9893,-3779.9252 2075.5532,-3398.2164 2082.3024,-3272.9377 2076.4263,-1260.6589 2111.5532,-1140.2164 2148.0803,-1014.9731 2213.737,-1010.0186 2265.3853,-890.2164 2289.7987,-833.5874 2258.9012,-800.915 2301.3853,-756.2164 2357.0279,-697.6731 2398.1809,-727.309 2474.269,-700.2164 2490.4417,-694.4578 2493.9272,-691.4755 2510.269,-686.2164 2853.2631,-575.8339 2938.4635,-533.3465 3295.4165,-484.2164 3320.7335,-480.7318 3501.3909,-488.0718 3525.3633,-479.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge46" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.5511,-4346.3718C1992.0458,-4513.9477 2023.5973,-6521.5259 2111.5532,-7105.2164 2151.9325,-7373.1799 2228.0952,-7426.8055 2265.3853,-7695.2164 2317.7183,-8071.9048 2242.7136,-9030.463 2301.3853,-9406.2164 2317.6749,-9510.5409 2361.4113,-9629.8053 2379.6573,-9676.7293"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2376.423,-9678.0687 2383.3368,-9686.0968 2382.9384,-9675.5094 2376.423,-9678.0687"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge124" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M1992.5617,-4346.3627C2005.8244,-4393.5481 2056.9876,-4581.7126 2075.5532,-4740.2164 2085.4251,-4824.4971 2060.8734,-6199.1558 2111.5532,-6267.2164 2117.4037,-6275.0733 2125.7778,-6280.5045 2134.8656,-6284.2487"/>
<polygon fill="#fff100" stroke="#fff100" points="2133.9238,-6287.626 2144.5185,-6287.5708 2136.2018,-6281.007 2133.9238,-6287.626"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge644" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3525.3633,-1334.2164C3593.503,-1340.8248 3633.9179,-1346.6531 3659.3423,-1410.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3360.8456,-1334.2164C3433.9246,-1331.799 3452.5858,-1327.1581 3525.3633,-1334.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M1990.7316,-4324.1028C2000.0216,-4246.6954 2054.958,-3779.9235 2075.5532,-3398.2164 2078.8985,-3336.2152 2067.2958,-1206.7666 2111.5532,-1163.2164 2157.0106,-1118.4853 3204.0865,-1145.5014 3259.4165,-1177.2164 3331.489,-1218.5281 3277.8181,-1336.9628 3360.8456,-1334.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge659" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff5d" stroke-dasharray="5,2" d="M2027.3024,-4335.2164C2055.0934,-4335.2164 2093.4503,-4335.2164 2125.7727,-4335.2164"/>
<polygon fill="#00ff5d" stroke="#00ff5d" points="2126.0339,-4338.7165 2136.0339,-4335.2164 2126.0339,-4331.7165 2126.0339,-4338.7165"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge747" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2000.2957,-4346.4001C2017.5149,-4364.389 2051.5082,-4401.2819 2075.5532,-4436.2164 2094.4976,-4463.7401 2085.9696,-4480.7239 2111.5532,-4502.2164 2139.1826,-4525.4275 2169.1145,-4497.7609 2188.4692,-4528.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2188.4692,-4528.2164C2207.54,-4558.225 2241.379,-4523.9883 2265.3853,-4550.2164 2322.5299,-4612.6499 2269.3943,-4658.858 2301.3853,-4737.2164 2353.9771,-4866.0343 2432.061,-4865.6327 2474.269,-4998.2164 2551.6276,-5241.2143 2463.6714,-5894.4954 2510.269,-6145.2164 2552.5937,-6372.9465 2633.8819,-6410.6765 2682.1736,-6637.2164 2721.9724,-6823.9155 2666.5835,-6881.4258 2718.1736,-7065.2164 2732.9903,-7118.0011 2765.6201,-7174.122 2783.955,-7203.1731"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2781.2345,-7205.4146 2789.5785,-7211.9435 2787.1272,-7201.6362 2781.2345,-7205.4146"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge833" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1989.7606,-4346.3151C1994.5407,-4489.0157 2044.2539,-5979.6773 2075.5532,-7184.2164 2085.1203,-7552.4012 2074.3003,-8474.7961 2111.5532,-8841.2164 2149.9865,-9219.247 2227.6695,-9304.1135 2265.3853,-9682.2164 2287.5342,-9904.2614 2257.0306,-11471.522 2301.3853,-11690.2164 2316.6536,-11765.4984 2357.2331,-11848.085 2376.8734,-11885.2012"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2373.7942,-11886.8651 2381.6041,-11894.0245 2379.9634,-11883.5574 2373.7942,-11886.8651"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge869" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2003.1079,-4346.2288C2023.0733,-4363.1653 2059.4993,-4397.7108 2075.5532,-4436.2164 2112.3682,-4524.5176 2098.113,-4770.4968 2111.5532,-4865.2164 2135.9449,-5037.1153 2147.0355,-5079.6119 2188.4692,-5248.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge231" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.5038,-4346.4653C1991.3563,-4521.6914 2016.1454,-6688.8335 2111.5532,-6951.2164 2150.1165,-7057.2699 2221.3576,-7049.3124 2265.3853,-7153.2164 2306.9528,-7251.3146 2267.2969,-7289.2753 2301.3853,-7390.2164 2319.3493,-7443.4108 2354.6422,-7499.7177 2374.1155,-7528.5987"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2371.3074,-7530.6929 2379.8401,-7536.9733 2377.0863,-7526.7426 2371.3074,-7530.6929"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge278" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2387.8271,-2474.2164C2461.6463,-2434.2025 2539.3909,-2371.5604 2575.5144,-2341.0781"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2578.0238,-2343.5386 2583.3763,-2334.3952 2573.4902,-2338.2051 2578.0238,-2343.5386"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1994.6228,-4323.9471C2010.5406,-4289.0138 2058.3273,-4179.0667 2075.5532,-4082.2164 2090.2766,-3999.4362 2061.9032,-2637.0707 2111.5532,-2569.2164 2188.2284,-2464.4279 2273.674,-2536.0934 2387.8271,-2474.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge328" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1990.6738,-4324.0995C1999.5736,-4246.6697 2052.3511,-3779.7739 2075.5532,-3398.2164 2079.6318,-3331.1438 2063.3362,-2236.019 2111.5532,-2189.2164 2160.6121,-2141.5965 2197.6949,-2179.6015 2265.3853,-2189.2164 2341.1152,-2199.9732 2521.4534,-2300.3563 2596.2213,-2284.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2596.2213,-2284.2164C2658.4497,-2272.0896 2662.9926,-2241.4332 2718.1736,-2210.2164 2802.9267,-2162.2701 2820.2637,-2140.6565 2912.0764,-2108.2164 2942.3515,-2097.5193 2951.2271,-2099.1645 2982.9529,-2094.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge356" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2001.3272,-4346.2254C2019.6359,-4363.692 2054.7106,-4399.5466 2075.5532,-4436.2164 2100.1389,-4479.4714 2093.2212,-4495.9628 2111.5532,-4542.2164 2413.6633,-5304.4716 2668.6169,-5427.9547 2876.0764,-6221.2164 2924.1518,-6405.042 2867.1662,-6462.5919 2912.0764,-6647.2164 2950.9668,-6807.0935 3021.1125,-6827.9626 3053.8293,-6989.2164 3080.6347,-7121.3338 3028.8229,-11722.0009 3089.8293,-11842.2164 3100.4564,-11863.1574 3121.6665,-11878.9113 3140.2139,-11889.428"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.5809,-11892.5237 3149.0471,-11894.1698 3141.8918,-11886.3562 3138.5809,-11892.5237"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge509" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2001.883,-4346.3735C2020.605,-4363.7613 2055.8384,-4399.1891 2075.5532,-4436.2164 2097.4835,-4477.4047 2286.7939,-5200.8937 2301.3853,-5245.2164 2368.901,-5450.3014 2434.527,-5486.9929 2474.269,-5699.2164 2488.6597,-5776.0627 2463.1368,-11265.8385 2510.269,-11328.2164 2512.6083,-11331.3123 2515.3089,-11334.0421 2518.2781,-11336.4478"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.4447,-11339.4323 2526.7014,-11342.0876 2520.3392,-11333.6157 2516.4447,-11339.4323"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge575" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2188.4692,-4528.2164C2212.3123,-4565.0867 2244.7138,-4551.4787 2265.3853,-4590.2164 2308.236,-4670.5174 2281.3774,-4909.4238 2301.3853,-4998.2164 2349.9448,-5213.718 2432.6077,-5247.2756 2474.269,-5464.2164 2505.4381,-5626.5213 2451.3309,-6796.8121 2510.269,-6951.2164 2523.3168,-6985.3986 2553.284,-7016.0607 2574.1386,-7034.4022"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2572.0245,-7037.1995 2581.9009,-7041.0345 2576.5717,-7031.8775 2572.0245,-7037.1995"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge432" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2027.195,-4332.049C2043.8626,-4328.8545 2062.5692,-4322.5563 2075.5532,-4310.2164 2111.0082,-4276.5201 2080.1497,-4243.7172 2111.5532,-4206.2164 2161.8422,-4146.1632 2209.926,-4175.5303 2265.3853,-4120.2164 2288.4924,-4097.1698 2279.6096,-4080.525 2301.3853,-4056.2164 2364.4776,-3985.7851 2412.0795,-4003.446 2474.269,-3932.2164 2496.7595,-3906.4567 2484.3285,-3886.4979 2510.269,-3864.2164 2612.6897,-3776.2425 2664.6444,-3738.1723 2797.125,-3764.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge404" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2027.0298,-4326.0192C2116.5252,-4306.5758 2344.2326,-4271.7088 2474.269,-4383.2164 2504.4622,-4409.1073 2758.3201,-5013.4903 2797.125,-5022.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-5022.2164C2831.2163,-5025.0115 2868.944,-5025.4913 2901.4483,-5025.0943"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2901.8615,-5028.5885 2911.8069,-5024.9364 2901.7547,-5021.5893 2901.8615,-5028.5885"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge369" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2027.1078,-4332.9802C2044.1686,-4330.014 2063.2259,-4323.6386 2075.5532,-4310.2164 2130.7392,-4250.1288 2077.8011,-4204.4915 2111.5532,-4130.2164 2134.7501,-4079.1691 2156.3259,-4076.159 2188.4692,-4030.2164"/>
</g>
<!-- sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge757" class="edge">
<title>sourcefile~dataplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.7962,-4346.3143C1995.0278,-4489.0041 2049.2412,-5979.558 2075.5532,-7184.2164 2088.5496,-7779.2393 2071.4876,-9268.4016 2111.5532,-9862.2164 2127.7687,-10102.5467 2172.2459,-10391.7566 2185.0054,-10471.794"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2181.6115,-10472.7347 2186.6507,-10482.0544 2188.5232,-10471.6263 2181.6115,-10472.7347"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node32" class="node">
<title>sourcefile~dataprecisionglobals.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node32"><a xlink:href="../sourcefile/dataprecisionglobals.f90.html" xlink:title="DataPrecisionGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="130.719,-10636.2218 -.2403,-10636.2218 -.2403,-10614.2109 130.719,-10614.2109 130.719,-10636.2218"/>
<text text-anchor="middle" x="65.2394" y="-10622.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPrecisionGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge914" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-16155.2164C299.3556,-16275.6956 264.7693,-16329.0478 317.2024,-16461.2164 391.0666,-16647.4066 415.3541,-16692.5958 516.9653,-16865.2164 585.7597,-16982.0865 573.267,-17047.9959 690.4731,-17116.2164 1191.0029,-17407.5523 1410.3472,-17231.0863 1989.3882,-17220.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge47" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-10574.2164C2212.5989,-10547.7562 2243.4611,-10578.531 2265.3853,-10550.2164 2314.9682,-10486.1809 2275.3551,-9898.9069 2301.3853,-9822.2164 2315.7356,-9779.937 2348.884,-9738.935 2369.7088,-9715.9949"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2372.5283,-9718.1021 2376.7659,-9708.3917 2367.3977,-9713.3401 2372.5283,-9718.1021"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C285.1155,-11485.7 159.6505,-13554.0421 317.2024,-13795.2164 361.3982,-13862.8696 429.0457,-13812.2924 480.9653,-13874.2164 518.9341,-13919.5012 469.8597,-13966.5316 516.9653,-14002.2164 565.6799,-14039.12 598.588,-14026.9518 654.4731,-14002.2164 754.4005,-13957.9874 775.074,-13919.9253 819.7932,-13820.2164 881.7964,-13681.97 805.6388,-13624.1883 855.7932,-13481.2164 886.0049,-13395.094 934.7632,-13393.8141 966.4307,-13308.2164 1006.2969,-13200.4571 979.1792,-13164.7364 1002.4307,-13052.2164 1041.2295,-12864.4583 1085.3152,-12825.3724 1116.5955,-12636.2164 1160.1808,-12372.6496 1085.6962,-12294.8505 1152.5955,-12036.2164 1196.0267,-11868.3101 1279.0045,-11852.4802 1321.0291,-11684.2164 1343.4772,-11594.3353 1304.1903,-10927.3124 1357.0291,-10851.2164 1394.6112,-10797.0922 1839.8967,-10638.4262 1903.2231,-10620.2164 1907.0798,-10619.1074 2185.7652,-10577.1815 2188.4692,-10574.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge53" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff2800" stroke-dasharray="5,2" d="M223.8406,-11204.2164C250.1532,-11325.0855 446.7046,-11289.5478 538.6075,-11265.8412"/>
<polygon fill="#ff2800" stroke="#ff2800" points="539.7116,-11269.1697 548.4874,-11263.2338 537.9253,-11262.4014 539.7116,-11269.1697"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge70" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M399.0839,-16402.2164C467.1483,-16430.0922 1450.1155,-15723.8008 1506.2007,-15676.2164 1601.3427,-15595.4948 1648.6203,-15588.915 1704.2205,-15477.2164 1755.0283,-15375.1455 1703.2506,-15331.0734 1740.2205,-15223.2164 1777.0783,-15115.6863 1811.2851,-15100.1717 1867.2231,-15001.2164 1960.6647,-14835.9165 1991.7441,-14798.6025 2075.5532,-14628.2164 2093.4807,-14591.7694 2095.3023,-14581.4412 2111.5532,-14544.2164 2290.0541,-14135.3385 2394.8709,-14047.2376 2474.269,-13608.2164 2484.3998,-13552.1996 2473.5027,-11602.676 2510.269,-11559.2164 2513.5287,-11555.3633 2517.3915,-11552.2413 2521.6459,-11549.7253"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2523.3139,-11552.8083 2530.8608,-11545.3721 2520.3239,-11546.479 2523.3139,-11552.8083"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge99" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1059.5131,-16990.2164C1253.6412,-16966.7499 2561.5016,-16259.5203 2682.1736,-16151.2164 2796.19,-16048.8858 2825.4991,-16010.8303 2876.0764,-15866.2164 3222.0124,-14877.0944 3010.3287,-14562.1842 3053.8293,-13515.2164 3141.3789,-11408.0848 3023.3841,-10878.119 3089.8293,-8770.2164 3109.2486,-8154.1615 3163.1054,-7399.8453 3173.0375,-7263.7631"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3176.5523,-7263.6877 3173.792,-7253.4587 3169.571,-7263.1764 3176.5523,-7263.6877"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M585.7192,-16611.2164C832.1623,-16720.6751 791.3183,-17018.2686 1059.5131,-16990.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge111" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M223.8406,-1962.2164C294.0363,-1914.4701 314.6605,-1895.1526 399.0839,-1886.2164"/>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M399.0839,-1886.2164C511.9596,-1874.2684 554.7122,-1832.0735 654.4731,-1886.2164 828.9072,-1980.8863 1451.3319,-3259.7724 1542.2007,-3436.2164 1614.1008,-3575.828 1633.925,-3609.79 1704.2205,-3750.2164 1737.8893,-3817.4754 1776.4298,-3897.9024 1794.0352,-3934.8405"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1790.9651,-3936.5344 1798.4242,-3944.0586 1797.2853,-3933.5251 1790.9651,-3936.5344"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge120" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ffc900" stroke-dasharray="5,2" d="M223.8406,-11204.2164C254.267,-11343.9825 274.352,-11032.6868 317.2024,-10896.2164 344.2621,-10810.0364 377.9842,-10707.8015 392.2281,-10664.8434"/>
<polygon fill="#ffc900" stroke="#ffc900" points="395.5856,-10665.8383 395.4139,-10655.2448 388.942,-10663.6332 395.5856,-10665.8383"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge126" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M399.0839,-3344.2164C479.051,-3474.0149 577.7551,-3441.4714 654.4731,-3573.2164 692.244,-3638.0788 660.8151,-3669.2658 690.4731,-3738.2164 730.8353,-3832.0524 773.7593,-3837.0287 819.7932,-3928.2164 908.5175,-4103.9685 925.7576,-4153.5859 966.4307,-4346.2164 1008.4299,-4545.128 942.5975,-4607.9234 1002.4307,-4802.2164 1032.554,-4900.0343 1088.4771,-4903.8033 1116.5955,-5002.2164 1131.09,-5052.9465 1115.8536,-5913.3526 1152.5955,-5951.2164 1195.8749,-5995.8174 1369.467,-5970.2164 1431.6149,-5970.2164 1431.6149,-5970.2164 1431.6149,-5970.2164 1623.2106,-5970.2164 1877.2398,-5970.2164 1880.6849,-6161.2415 2111.5532,-6267.2164 2120.0811,-6271.1309 2129.3981,-6274.7053 2138.5112,-6277.8504"/>
<polygon fill="#fff100" stroke="#fff100" points="2137.6792,-6281.262 2148.2727,-6281.0905 2139.8844,-6274.6184 2137.6792,-6281.262"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge131" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#e4ff00" stroke-dasharray="5,2" d="M223.8406,-11204.2164C286.866,-11493.7284 136.7735,-13634.1955 317.2024,-13869.2164 324.9871,-13879.3564 336.7833,-13885.5049 349.0168,-13889.1993"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="348.3024,-13892.6284 358.8534,-13891.6653 350.0047,-13885.8385 348.3024,-13892.6284"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge190" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M911.1119,-1178.2164C935.9274,-1170.472 946.62,-1180.3842 966.4307,-1197.2164 992.1917,-1219.1044 984.4055,-1235.619 1002.4307,-1264.2164 1048.2436,-1336.8994 1068.0246,-1349.3466 1116.5955,-1420.2164 1253.42,-1619.8571 1614.3268,-2112.5021 1704.2205,-2337.2164 1735.4942,-2415.3939 1708.2867,-2445.3061 1740.2205,-2523.2164 1778.8829,-2617.5427 1828.0096,-2620.1178 1867.2231,-2714.2164 1897.7679,-2787.513 1881.7786,-2812.7604 1903.2231,-2889.2164 1964.5495,-3107.8627 2032.604,-3147.2309 2075.5532,-3370.2164 2096.2667,-3477.7572 2061.5197,-4257.796 2111.5532,-4355.2164 2151.0432,-4432.1073 2219.8452,-4400.7469 2265.3853,-4474.2164 2308.3678,-4543.5597 2257.4151,-4585.495 2301.3853,-4654.2164 2314.3727,-4674.5146 2336.4043,-4690.4221 2354.9742,-4701.1747"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2353.3131,-4704.2556 2363.7574,-4706.0358 2356.7028,-4698.1311 2353.3131,-4704.2556"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge198" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datainterfaces.f90</title>
<path fill="none" stroke="#93ff00" stroke-dasharray="5,2" d="M223.8406,-11204.2164C282.4614,-11473.4957 271.1838,-10862.9332 317.2024,-10591.2164 344.4984,-10430.0473 382.3738,-10236.576 394.887,-10173.3334"/>
<polygon fill="#93ff00" stroke="#93ff00" points="398.3477,-10173.8752 396.8589,-10163.3855 391.4813,-10172.5141 398.3477,-10173.8752"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge200" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#6bff00" stroke-dasharray="5,2" d="M1989.3882,-572.2164C2022.1816,-606.1346 2050.5234,-594.2243 2075.5532,-634.2164 2125.3268,-713.7435 2093.2258,-750.2051 2111.5532,-842.2164 2135.7926,-963.9081 2170.3754,-1108.7288 2183.3186,-1162.112"/>
<polygon fill="#6bff00" stroke="#6bff00" points="2179.9773,-1163.1842 2185.7406,-1172.0743 2186.7791,-1161.5305 2179.9773,-1163.1842"/>
<path fill="none" stroke="#6bff00" stroke-dasharray="5,2" d="M1431.6149,-268.2164C1695.5819,-168.0642 1793.1461,-369.2432 1989.3882,-572.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge258" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1431.6149,-16686.2164C1817.6023,-16611.2196 2353.0707,-16009.8257 2474.269,-15829.2164 2765.2233,-15395.6375 2782.1445,-15238.8522 2876.0764,-14725.2164 2890.2391,-14647.7722 2866.1916,-11955.1911 2912.0764,-11891.2164 2914.3388,-11888.062 2917.0325,-11885.3032 2920.0268,-11882.8906"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.1307,-11885.6962 2928.565,-11877.2789 2918.286,-11879.8465 2922.1307,-11885.6962"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge645" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M585.7192,-117.2164C634.9231,-95.2716 639.0014,-72.1302 690.4731,-56.2164 784.4053,-27.1749 812.7928,-40.2164 911.1119,-40.2164 911.1119,-40.2164 911.1119,-40.2164 2387.8271,-40.2164 2396.4649,-40.2164 3580.8847,-361.0513 3588.4519,-365.2164 3607.467,-375.6823 3607.4692,-384.6997 3624.4519,-398.2164 3639.1782,-409.9372 3649.0831,-406.437 3659.3423,-422.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M65.3161,-10614.0056C67.6995,-10267.9807 125.49,-2027.0782 223.8406,-1962.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M223.8406,-1962.2164C369.0764,-1866.4339 247.8082,-558.7537 317.2024,-399.2164 386.2322,-240.5168 426.9761,-186.1461 585.7192,-117.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3659.3423,-422.2164C3711.1601,-498.7448 3685.812,-535.1795 3694.2327,-627.2164 3757.7071,-1320.9828 3782.7724,-6722.65 3784.478,-7106.6881"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3780.9784,-7106.8038 3784.5226,-7116.7882 3787.9783,-7106.7728 3780.9784,-7106.8038"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge651" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M1059.5131,-836.2164C1126.3031,-754.0319 1817.6171,-1248.6512 1867.2231,-1342.2164 1915.6671,-1433.5897 1870.907,-1707.974 1903.2231,-1806.2164 1948.411,-1943.5895 2035.1637,-1943.3567 2075.5532,-2082.2164 2145.7662,-2323.6092 2067.5952,-6359.6925 2111.5532,-6607.2164 2124.7323,-6681.4266 2160.7602,-6763.9955 2178.4292,-6801.5756"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="2175.4295,-6803.4168 2182.8917,-6810.9378 2181.7484,-6800.4048 2175.4295,-6803.4168"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge657" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M399.0839,-3344.2164C579.3693,-3514.2747 687.5533,-3500.6089 819.7932,-3710.2164 1082.8919,-4127.2421 1041.9669,-4291.8131 1116.5955,-4779.2164 1134.9189,-4898.8878 1096.605,-5760.8755 1152.5955,-5868.2164 1163.3593,-5888.852 1184.2828,-5904.5568 1202.5803,-5915.1252"/>
<polygon fill="#00ff35" stroke="#00ff35" points="1201.1148,-5918.313 1211.5678,-5920.0409 1204.4739,-5912.1716 1201.1148,-5918.313"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge660" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff5d" stroke-dasharray="5,2" d="M911.1119,-1178.2164C943.7726,-1168.0842 1195.0499,-1313.9507 1321.0291,-1468.2164 1440.3688,-1614.3518 1425.8069,-1679.5284 1506.2007,-1850.2164 1686.9603,-2233.9958 1712.8183,-2339.1298 1903.2231,-2718.2164 1974.6743,-2860.4721 2033.2839,-2878.7391 2075.5532,-3032.2164 2135.3046,-3249.1698 2078.5966,-3821.6116 2111.5532,-4044.2164 2126.8537,-4147.5632 2165.1674,-4266.972 2181.2175,-4314.3234"/>
<polygon fill="#00ff5d" stroke="#00ff5d" points="2177.9918,-4315.7076 2184.5415,-4324.0354 2184.6146,-4313.4408 2177.9918,-4315.7076"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge667" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1059.5131,-1102.2164C1167.483,-1058.8553 1210.9737,-1052.4602 1321.0291,-1090.2164 1552.9008,-1169.7636 1740.8056,-1426.3755 1790.7018,-1499.5638"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1787.845,-1501.5874 1796.3392,-1507.9197 1793.6478,-1497.6724 1787.845,-1501.5874"/>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M911.1119,-1178.2164C981.6148,-1155.4023 986.9726,-1117.3497 1059.5131,-1102.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge677" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M399.0839,-1672.2164C571.5618,-1569.9888 1034.3646,-2036.358 1116.5955,-2219.2164 1159.7513,-2315.1829 1111.6418,-2356.2896 1152.5955,-2453.2164 1200.9369,-2567.6281 1248.5616,-2575.3432 1321.0291,-2676.2164 1572.2166,-3025.8642 1731.7991,-3067.549 1867.2231,-3476.2164 1897.9708,-3569.003 1854.3255,-4270.5771 1903.2231,-4355.2164 1948.5578,-4433.6883 2030.0559,-4385.8387 2075.5532,-4464.2164 2164.6712,-4617.7387 2031.9826,-5103.5354 2111.5532,-5262.2164 2121.4763,-5282.0051 2140.7611,-5297.778 2157.5371,-5308.5923"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2156.1658,-5311.856 2166.5237,-5314.0841 2159.816,-5305.883 2156.1658,-5311.856"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge683" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalfansys.f90</title>
<path fill="none" stroke="#00ffd6" stroke-dasharray="5,2" d="M1059.5131,-1102.2164C1176.7343,-1060.4583 1216.5711,-1134.5917 1321.0291,-1202.2164 1321.8176,-1202.7269 1703.7926,-1583.3801 1704.2205,-1584.2164 1707.7554,-1591.1254 1783.5548,-2075.9719 1800.4172,-2184.0269"/>
<polygon fill="#00ffd6" stroke="#00ffd6" points="1796.9805,-2184.7043 1801.9802,-2194.0453 1803.8968,-2183.6252 1796.9805,-2184.7043"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge687" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-6652.2164C693.9231,-6619.2002 751.8303,-6661.7775 819.7932,-6752.2164 898.8783,-6857.4557 777.802,-6940.1638 855.7932,-7046.2164 858.082,-7049.3287 860.8495,-7052.0622 863.9117,-7054.4617"/>
<polygon fill="#00ffff" stroke="#00ffff" points="862.2811,-7057.5752 872.5796,-7060.0637 866.0808,-7051.6962 862.2811,-7057.5752"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge695" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M65.3048,-10613.9649C66.9916,-10328.4968 101.7583,-4705.5967 223.8406,-4597.2164"/>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M911.1119,-5586.2164C931.3056,-5666.561 948.9997,-5683.2274 966.4307,-5764.2164 993.9437,-5892.0495 947.9902,-5937.3277 1002.4307,-6056.2164 1010.4454,-6073.7192 1025.1108,-6089.7406 1037.5695,-6101.2467"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1035.5369,-6104.1216 1045.3458,-6108.126 1040.175,-6098.8786 1035.5369,-6104.1216"/>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M223.8406,-4597.2164C369.7637,-4467.671 165.2612,-4290.6476 317.2024,-4168.2164 373.8766,-4122.5494 415.9215,-4135.5553 480.9653,-4168.2164 596.3494,-4226.1553 606.2907,-4281.4296 654.4731,-4401.2164 702.4471,-4520.4846 630.3656,-4574.5788 690.4731,-4688.2164 726.2975,-4755.945 786.2106,-4733.3486 819.7932,-4802.2164 879.1165,-4923.8706 831.3173,-5277.1001 855.7932,-5410.2164 870.621,-5490.8596 891.1251,-5506.6946 911.1119,-5586.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge704" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00aeff" stroke-dasharray="5,2" d="M399.0839,-15585.2164C413.3007,-15603.6415 784.7191,-15624.1913 819.7932,-15599.2164 859.6373,-15570.8449 829.2998,-15536.3332 855.7932,-15495.2164 892.512,-15438.2303 932.477,-15448.892 966.4307,-15390.2164 1301.743,-14810.7595 1235.5877,-14590.2227 1321.0291,-13926.2164 1376.7956,-13492.8274 1290.1853,-12392.0356 1357.0291,-11960.2164 1370.62,-11872.4169 1406.9298,-11772.3862 1423.3489,-11729.9711"/>
<polygon fill="#00aeff" stroke="#00aeff" points="1426.6816,-11731.0592 1427.0688,-11720.4715 1420.1635,-11728.5068 1426.6816,-11731.0592"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge708" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datazoneenergydemands.f90</title>
<path fill="none" stroke="#0086ff" stroke-dasharray="5,2" d="M1059.5131,-836.2164C1101.2058,-787.1555 1098.1599,-759.5969 1152.5955,-725.2164 1286.9547,-640.3574 1358.2144,-614.3067 1506.2007,-672.2164 1617.7966,-715.8858 1628.7256,-762.1509 1704.2205,-855.2164 1793.2472,-964.9633 1808.3115,-999.7658 1867.2231,-1128.2164 1888.3158,-1174.2066 1885.7661,-1188.7269 1903.2231,-1236.2164 1973.9749,-1428.6868 2016.2203,-1467.925 2075.5532,-1664.2164 2135.7956,-1863.5165 2174.6216,-2113.4197 2185.4049,-2187.5492"/>
<polygon fill="#0086ff" stroke="#0086ff" points="2182.0059,-2188.5027 2186.8938,-2197.9026 2188.9347,-2187.5062 2182.0059,-2188.5027"/>
<path fill="none" stroke="#0086ff" stroke-dasharray="5,2" d="M911.1119,-1178.2164C1036.0641,-1139.2215 936.2932,-1011.1743 1002.4307,-898.2164 1021.356,-865.8934 1032.2069,-861.8546 1059.5131,-836.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge717" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M1803.7218,-1180.2164C1820.4992,-1209.6016 1850.075,-1193.046 1867.2231,-1222.2164 1973.3941,-1402.8217 1797.0596,-1511.6067 1903.2231,-1692.2164 1949.7591,-1771.3853 2029.6962,-1726.6522 2075.5532,-1806.2164 2142.9178,-1923.0972 2080.1896,-2281.0088 2111.5532,-2412.2164 2125.8836,-2472.1665 2159.339,-2537.3604 2177.0313,-2569.3016"/>
<polygon fill="#0035ff" stroke="#0035ff" points="2174.0274,-2571.1006 2181.9773,-2578.1042 2180.1301,-2567.6716 2174.0274,-2571.1006"/>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M1059.5131,-836.2164C1298.6466,-561.2764 1619.7605,-865.6769 1803.7218,-1180.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge720" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M223.8406,-11204.2164C241.8592,-11286.9222 263.575,-11103.707 317.2024,-11038.2164 437.8199,-10890.9165 829.2279,-10611.2059 966.4307,-10479.2164 994.5239,-10452.1906 1024.9115,-10418.6485 1043.0679,-10398.0967"/>
<polygon fill="#000dff" stroke="#000dff" points="1045.8659,-10400.2149 1049.838,-10390.3928 1040.6078,-10395.5941 1045.8659,-10400.2149"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge748" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M399.0839,-3610.2164C471.3264,-3701.9988 573.3503,-3588.1802 654.4731,-3672.2164 709.623,-3729.3468 665.7133,-3771.7688 690.4731,-3847.2164 733.341,-3977.8419 775.0359,-3998.2261 819.7932,-4128.2164 912.1176,-4396.3574 903.9613,-4472.5921 966.4307,-4749.2164 983.1559,-4823.2785 966.0812,-4849.5556 1002.4307,-4916.2164 1036.7589,-4979.1705 1087.8791,-4964.5124 1116.5955,-5030.2164 1158.8095,-5126.8035 1086.5158,-5896.0909 1152.5955,-5978.2164 1153.2157,-5978.9872 1703.316,-6120.8154 1704.2205,-6121.2164 1783.4448,-6156.3363 1820.2459,-6155.3944 1867.2231,-6228.2164 1923.0734,-6314.7927 1834.7063,-6380.2738 1903.2231,-6457.2164 1956.0977,-6516.5931 2024.4432,-6444.3142 2075.5532,-6505.2164 2128.5164,-6568.3266 2056.1345,-6813.2511 2111.5532,-6874.2164 2169.372,-6937.8219 2216.2715,-6899.2023 2301.3853,-6911.2164 2366.513,-6920.4093 2543.0047,-6898.5624 2596.2213,-6937.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge787" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M911.1119,-16572.2164C1486.5388,-16499.7133 2545.4516,-15218.8473 2682.1736,-14655.2164 2731.3401,-14452.5292 2712.1024,-11109.6931 2718.1736,-10901.2164 2737.2713,-10245.4193 2786.8871,-9441.6079 2795.7575,-9300.7682"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2799.2699,-9300.6808 2796.4074,-9290.48 2792.2838,-9300.2394 2799.2699,-9300.6808"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M755.1332,-16572.2164C824.0627,-16564.8321 841.9673,-16577.1991 911.1119,-16572.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge794" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M223.8406,-11204.2164C274.7431,-11437.8597 197.3974,-10339.1633 317.2024,-10132.2164 339.418,-10093.8419 370.6459,-10109.2373 399.0839,-10075.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge804" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M399.0839,-1672.2164C450.189,-1639.8661 458.5396,-1619.8598 516.9653,-1604.2164 713.1932,-1551.6767 803.3273,-1566.1252 966.4307,-1687.2164 984.8525,-1700.8931 986.056,-1708.1449 1002.4307,-1724.2164 1052.0615,-1772.9283 1083.3002,-1770.1632 1116.5955,-1831.2164 1159.2095,-1909.3574 1121.3681,-1944.8687 1152.5955,-2028.2164 1214.9935,-2194.7604 1248.5344,-2231.2932 1357.0291,-2372.2164 1414.771,-2447.2171 1448.6072,-2449.1016 1506.2007,-2524.2164 1530.2491,-2555.5809 1856.2451,-3099.2488 1867.2231,-3137.2164 1885.3326,-3199.8482 1863.273,-4258.6928 1903.2231,-4310.2164 1912.4514,-4322.118 1927,-4328.5956 1941.5338,-4332.0487"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1941.0444,-4335.5189 1951.5277,-4333.9855 1942.3763,-4328.6468 1941.0444,-4335.5189"/>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M223.8406,-1962.2164C327.4394,-1891.7498 226.3152,-1782.4589 317.2024,-1696.2164 344.7115,-1670.113 366.4607,-1691.5521 399.0839,-1672.2164"/>
</g>
<!-- sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node33" class="node">
<title>sourcefile~dataglobals.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node33"><a xlink:href="../sourcefile/dataglobals.f90.html" xlink:title="DataGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="267.6355,-10086.2218 180.0456,-10086.2218 180.0456,-10064.2109 267.6355,-10064.2109 267.6355,-10086.2218"/>
<text text-anchor="middle" x="223.8406" y="-10072.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge809" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataglobals.f90</title>
<path fill="none" stroke="#e400ff" stroke-dasharray="5,2" d="M68.552,-10613.7288C88.3862,-10544.9475 191.4428,-10187.566 217.7316,-10096.4013"/>
<polygon fill="#e400ff" stroke="#e400ff" points="221.1383,-10097.219 220.5462,-10086.6407 214.4124,-10095.2794 221.1383,-10097.219"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge818" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M399.0839,-3610.2164C433.4409,-3650.2565 464.2975,-3599.3329 516.9653,-3596.2164 577.9732,-3592.6063 608.9889,-3555.3975 654.4731,-3596.2164 709.7038,-3645.7819 665.6553,-3858.279 690.4731,-3928.2164 725.8729,-4027.9737 781.6318,-4029.4825 819.7932,-4128.2164 855.1963,-4219.8137 834.7658,-4250.2929 855.7932,-4346.2164 895.5646,-4527.6466 922.2573,-4568.8074 966.4307,-4749.2164 984.4881,-4822.965 977.2336,-4844.592 1002.4307,-4916.2164 1040.0391,-5023.1209 1088.1707,-5034.5122 1116.5955,-5144.2164 1140.0269,-5234.6491 1105.737,-5903.3993 1152.5955,-5984.2164 1226.1383,-6111.0561 1342.0219,-6044.1562 1431.6149,-6160.2164"/>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M223.8406,-1962.2164C352.3477,-1874.735 287.7708,-3205.5702 317.2024,-3358.2164 339.4978,-3473.8506 326.2471,-3517.679 399.0839,-3610.2164"/>
</g>
<!-- sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node35" class="node">
<title>sourcefile~dataairflownetwork.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node35"><a xlink:href="../sourcefile/dataairflownetwork.f90.html" xlink:title="DataAirflowNetwork.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2448.534,-1116.2218 2327.1203,-1116.2218 2327.1203,-1094.2109 2448.534,-1094.2109 2448.534,-1116.2218"/>
<text text-anchor="middle" x="2387.8271" y="-1102.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataAirflowNetwork.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge825" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff00c9" stroke-dasharray="5,2" d="M1803.7218,-268.2164C1941.3582,-296.0092 1996.8865,-312.9075 2075.5532,-429.2164 2134.2583,-516.0119 2040.8243,-584.9042 2111.5532,-662.2164 2159.0897,-714.1774 2218.7765,-647.4216 2265.3853,-700.2164 2310.4074,-751.214 2274.0893,-941.9052 2301.3853,-1004.2164 2316.183,-1037.9966 2346.1853,-1068.9564 2366.6464,-1087.456"/>
<polygon fill="#ff00c9" stroke="#ff00c9" points="2364.4161,-1090.1556 2374.2324,-1094.1419 2369.0445,-1084.9041 2364.4161,-1090.1556"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge836" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M399.0839,-16155.2164C513.4073,-16147.7447 546.8072,-16159.3789 654.4731,-16120.2164 740.6158,-16088.8827 1253.152,-15749.8746 1321.0291,-15663.2164 1638.3056,-15258.1513 1929.6106,-13967.6157 2075.5532,-13474.2164 2163.219,-13177.8381 2206.99,-13108.7215 2265.3853,-12805.2164 2294.5965,-12653.3931 2281.461,-12612.5351 2301.3853,-12459.2164 2328.4713,-12250.787 2371.3588,-11999.8517 2384.1252,-11926.3797"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2387.5785,-11926.9499 2385.8469,-11916.4975 2380.6824,-11925.7483 2387.5785,-11926.9499"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge846" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M223.8406,-11204.2164C238.8132,-11273.0199 265.6255,-11124.1531 317.2024,-11076.2164 380.0106,-11017.841 412.3174,-11025.5974 480.9653,-10974.2164 633.4536,-10860.0832 1036.3636,-10571.9644 1116.5955,-10399.2164 1180.524,-10261.5711 1127.3348,-9866.8659 1152.5955,-9717.2164 1197.4158,-9451.6914 1273.107,-9400.1991 1321.0291,-9135.2164 1358.4702,-8928.1877 1300.6149,-8865.8988 1357.0291,-8663.2164 1370.6251,-8614.3689 1400.8457,-8562.6414 1418.3606,-8535.1455"/>
<polygon fill="#ff0078" stroke="#ff0078" points="1421.478,-8536.7706 1423.9778,-8526.4748 1415.6032,-8532.9645 1421.478,-8536.7706"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge870" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M585.7192,-1369.2164C751.2735,-1333.7831 825.908,-1261.7859 966.4307,-1356.2164 984.758,-1368.5322 1109.8596,-1703.1878 1116.5955,-1724.2164 1137.7736,-1790.3317 1117.2241,-1816.4785 1152.5955,-1876.2164 1203.9703,-1962.9821 1254.3126,-1952.6082 1321.0291,-2028.2164 1345.6386,-2056.1058 1688.6081,-2543.4569 1704.2205,-2577.2164 1730.6461,-2634.3578 1714.7149,-2656.6584 1740.2205,-2714.2164 1782.1224,-2808.7756 1834.16,-2811.2161 1867.2231,-2909.2164 1936.8872,-3115.7029 1875.0543,-3182.1231 1903.2231,-3398.2164 1956.8266,-3809.4273 2023.6209,-3903.7911 2075.5532,-4315.2164 2106.2309,-4558.2554 2079.366,-4622.3727 2111.5532,-4865.2164 2134.366,-5037.332 2147.0355,-5079.6119 2188.4692,-5248.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2188.4692,-5248.2164C2198.6471,-5289.5297 2244.6486,-5268.063 2265.3853,-5305.2164 2311.2552,-5387.4004 2271.7137,-5637.8975 2301.3853,-5727.2164 2317.0004,-5774.2218 2351.4229,-5821.6541 2371.8044,-5847.1424"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2369.1028,-5849.3677 2378.1307,-5854.9127 2374.5312,-5844.9481 2369.1028,-5849.3677"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge877" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M223.8406,-4597.2164C310.3869,-4522.1135 399.6572,-4535.4718 480.9653,-4616.2164 575.3303,-4709.9273 584.7326,-5730.043 585.6283,-5890.1313"/>
<polygon fill="#ff0028" stroke="#ff0028" points="582.1283,-5890.1648 585.6791,-5900.1469 589.1282,-5890.1292 582.1283,-5890.1648"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C241.6541,-11286.0262 895.7883,-11121.1589 966.4307,-11076.2164 1077.099,-11005.8095 1066.4997,-10946.1715 1152.5955,-10847.2164 1224.724,-10764.3146 1278.5251,-10767.5507 1321.0291,-10666.2164 1390.0341,-10501.7005 1269.5412,-10019.6932 1357.0291,-9864.2164 1396.1713,-9794.6557 1445.1765,-9815.6639 1506.2007,-9764.2164 1621.573,-9666.9496 1608.7925,-9592.3669 1740.2205,-9518.2164 1765.3913,-9504.0152 1779.1378,-9519.4107 1803.7218,-9504.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-1886.2164C464.7747,-1875.1317 619.0948,-1986.767 654.4731,-2043.2164 696.642,-2110.5006 655.0826,-2147.1327 690.4731,-2218.2164 773.2781,-2384.5341 868.3646,-2374.415 966.4307,-2532.2164 1184.6562,-2883.3702 1182.6574,-3002.6209 1321.0291,-3392.2164 1339.6649,-3444.6869 1339.8235,-3459.2597 1357.0291,-3512.2164 1380.1578,-3583.4039 1410.3027,-3666.9608 1424.1122,-3704.7827"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1420.831,-3706.0012 1427.5545,-3714.1893 1427.4047,-3703.5955 1420.831,-3706.0012"/>
</g>
<!-- sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node42" class="node">
<title>sourcefile~outputreportpredefined.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node42"><a xlink:href="../sourcefile/outputreportpredefined.f90.html" xlink:title="OutputReportPredefined.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1308.6498,-11222.2218 1164.9747,-11222.2218 1164.9747,-11200.2109 1308.6498,-11200.2109 1308.6498,-11222.2218"/>
<text text-anchor="middle" x="1236.8123" y="-11208.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">OutputReportPredefined.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge19" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-11204.2164C284.1542,-11481.3637 142.2474,-13531.9696 317.2024,-13755.2164 374.1528,-13827.8865 425.5284,-13799.4264 516.9653,-13812.2164 651.3032,-13831.0072 732.5,-13878.0414 819.7932,-13774.2164 868.0558,-13716.8137 846.9403,-13174.6877 855.7932,-13100.2164 930.8682,-12468.6777 1031.3167,-12323.4583 1116.5955,-11693.2164 1129.1267,-11600.6062 1107.2083,-11355.909 1152.5955,-11274.2164 1163.9227,-11253.8283 1184.9132,-11238.1013 1203.1035,-11227.4598"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1205.2481,-11230.2727 1212.2947,-11222.3609 1201.8523,-11224.1515 1205.2481,-11230.2727"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node43" class="node">
<title>sourcefile~datacontaminantbalance.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node43"><a xlink:href="../sourcefile/datacontaminantbalance.f90.html" xlink:title="DataContaminantBalance.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1506.2866,-10882.2218 1356.9431,-10882.2218 1356.9431,-10860.2109 1506.2866,-10860.2109 1506.2866,-10882.2218"/>
<text text-anchor="middle" x="1431.6149" y="-10868.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataContaminantBalance.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge30" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M223.8406,-1962.2164C249.23,-1945.0394 456.452,-2043.8108 480.9653,-2062.2164 502.0068,-2078.0151 499.9912,-2089.111 516.9653,-2109.2164 574.8867,-2177.8227 615.1787,-2176.4844 654.4731,-2257.2164 699.178,-2349.0643 661.7683,-2386.1827 690.4731,-2484.2164 756.8619,-2710.9489 1056.6375,-3229.6991 1116.5955,-3458.2164 1156.9552,-3612.0389 1112.5992,-3660.299 1152.5955,-3814.2164 1200.0812,-3996.9552 1282.2801,-4019.4276 1321.0291,-4204.2164 1392.8834,-4546.8805 1320.8075,-10157.9782 1357.0291,-10506.2164 1370.8298,-10638.898 1410.8062,-10794.7055 1425.8228,-10850.2526"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1422.4702,-10851.262 1428.4781,-10859.9886 1429.2235,-10849.4201 1422.4702,-10851.262"/>
</g>
<!-- sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node44" class="node">
<title>sourcefile~databranchairloopplant.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node44"><a xlink:href="../sourcefile/databranchairloopplant.f90.html" xlink:title="DataBranchAirLoopPlant.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1309.3977,-2444.2218 1164.2268,-2444.2218 1164.2268,-2422.2109 1309.3977,-2422.2109 1309.3977,-2444.2218"/>
<text text-anchor="middle" x="1236.8123" y="-2430.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchAirLoopPlant.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1672.2164C705.4503,-1499.3906 949.1186,-1696.8935 1116.5955,-2006.2164 1159.2993,-2085.0886 1095.7969,-2338.8019 1152.5955,-2408.2164 1155.2364,-2411.4439 1158.274,-2414.2672 1161.5934,-2416.7358"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1160.0158,-2419.8758 1170.3594,-2422.1696 1163.7039,-2413.9261 1160.0158,-2419.8758"/>
</g>
<!-- sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node45" class="node">
<title>sourcefile~datasystemvariables.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node45"><a xlink:href="../sourcefile/datasystemvariables.f90.html" xlink:title="DataSystemVariables.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.7837,-3241.2218 334.3841,-3241.2218 334.3841,-3219.2109 463.7837,-3219.2109 463.7837,-3241.2218"/>
<text text-anchor="middle" x="399.0839" y="-3227.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSystemVariables.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1962.2164C223.8406,-1962.2164 373.1759,-3042.7556 396.1362,-3208.8879"/>
<polygon fill="#00ffff" stroke="#00ffff" points="392.6792,-3209.4405 397.5153,-3218.8671 399.6133,-3208.4821 392.6792,-3209.4405"/>
</g>
<!-- sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node47" class="node">
<title>sourcefile~datasurfaces.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node47"><a xlink:href="../sourcefile/datasurfaces.f90.html" xlink:title="DataSurfaces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="632.3482,-15234.2218 539.0902,-15234.2218 539.0902,-15212.2109 632.3482,-15212.2109 632.3482,-15234.2218"/>
<text text-anchor="middle" x="585.7192" y="-15220.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataSurfaces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge27" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C250.0788,-11324.7543 229.0611,-15557.909 317.2024,-15644.2164 369.2063,-15695.1382 425.5831,-15691.4419 480.9653,-15644.2164 519.4951,-15611.3613 504.5352,-15468.303 516.9653,-15419.2164 533.5624,-15353.6743 562.7278,-15279.0033 577.149,-15243.7318"/>
<polygon fill="#ff0000" stroke="#ff0000" points="580.3854,-15245.0642 580.9624,-15234.4851 573.9141,-15242.3954 580.3854,-15245.0642"/>
</g>
<!-- sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node48" class="node">
<title>sourcefile~datavectortypes.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node48"><a xlink:href="../sourcefile/datavectortypes.f90.html" xlink:title="DataVectorTypes.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="278.8255,-15359.2218 168.8556,-15359.2218 168.8556,-15337.2109 278.8255,-15337.2109 278.8255,-15359.2218"/>
<text text-anchor="middle" x="223.8406" y="-15345.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataVectorTypes.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge20" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datavectortypes.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.6138,-10636.3659C73.7505,-10878.6692 211.8933,-14992.4373 223.117,-15326.6694"/>
<polygon fill="#ff0000" stroke="#ff0000" points="219.6286,-15327.0751 223.4623,-15336.952 226.6246,-15326.8401 219.6286,-15327.0751"/>
</g>
<!-- sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node49" class="node">
<title>sourcefile~databsdfwindow.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node49"><a xlink:href="../sourcefile/databsdfwindow.f90.html" xlink:title="DataBSDFWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="457.5516,-14968.2218 340.6161,-14968.2218 340.6161,-14946.2109 457.5516,-14946.2109 457.5516,-14968.2218"/>
<text text-anchor="middle" x="399.0839" y="-14954.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBSDFWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge23" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-11204.2164C267.9097,-11406.6511 191.8631,-14767.2558 317.2024,-14932.2164 321.0971,-14937.3423 326.0178,-14941.4493 331.5058,-14944.7355"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.0219,-14947.9067 340.5309,-14949.2523 333.1548,-14941.6468 330.0219,-14947.9067"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge83" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-16572.2164C846.9351,-16562.3818 1061.5203,-16678.063 1152.5955,-16693.2164 1242.2752,-16708.1375 1266.1297,-16698.6606 1357.0291,-16700.2164 1423.3178,-16701.3509 1440.9855,-16712.1528 1506.2007,-16700.2164 1598.7727,-16683.2728 1620.7432,-16668.6699 1704.2205,-16625.2164 1790.1483,-16580.4872 2701.0257,-15987.3076 2797.125,-15852.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge137" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1962.2164C271.1893,-1929.9837 426.22,-1963.3701 480.9653,-1980.2164 486.2954,-1981.8566 651.3253,-2076.613 654.4731,-2081.2164 712.6286,-2166.2614 650.586,-2215.223 690.4731,-2310.2164 727.7761,-2399.0554 770.8336,-2401.2294 819.7932,-2484.2164 956.4951,-2715.9273 1235.1847,-3331.2495 1321.0291,-3586.2164 1344.1487,-3654.8841 1317.2484,-3684.6583 1357.0291,-3745.2164 1402.1114,-3813.8453 1452.1141,-3792.4346 1506.2007,-3854.2164 1560.5342,-3916.2802 1599.7427,-4007.8303 1615.5263,-4048.4726"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1612.2782,-4049.7781 1619.1101,-4057.876 1618.8192,-4047.2851 1612.2782,-4049.7781"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge168" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-1962.2164C342.452,-1881.4715 262.0562,-3117.7502 317.2024,-3250.2164 338.4963,-3301.3663 363.6564,-3301.6178 399.0839,-3344.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-3344.2164C532.7119,-3504.8927 636.1912,-3454.3983 819.7932,-3554.2164 1008.8468,-3656.9983 1107.9307,-3627.8943 1236.8123,-3800.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge181" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-1962.2164C387.7715,-1844.4925 244.9116,-3587.7852 317.2024,-3776.2164 337.9013,-3830.1694 366.7152,-3829.3452 399.0839,-3877.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-3877.2164C423.2917,-3913.0182 467.5946,-3931.9646 506.9624,-3941.9862"/>
<polygon fill="#0000ff" stroke="#0000ff" points="506.3102,-3945.4288 516.8496,-3944.3466 507.9357,-3938.6201 506.3102,-3945.4288"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge154" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-1962.2164C266.276,-1931.7422 631.6365,-2751.2277 654.4731,-2798.2164 870.2523,-3242.2036 996.4922,-3329.4048 1116.5955,-3808.2164 1179.0015,-4057.0084 1097.1511,-4133.7809 1152.5955,-4384.2164 1169.0703,-4458.6314 1207.5255,-4541.1009 1226.2254,-4578.6163"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.3113,-4580.6105 1230.9412,-4587.9614 1229.5607,-4577.4569 1223.3113,-4580.6105"/>
</g>
<!-- sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node58" class="node">
<title>sourcefile~dataroomair.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node58"><a xlink:href="../sourcefile/dataroomair.f90.html" xlink:title="DataRoomAir.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1105.473,-6436.2218 1013.5531,-6436.2218 1013.5531,-6414.2109 1105.473,-6414.2109 1105.473,-6436.2218"/>
<text text-anchor="middle" x="1059.5131" y="-6422.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRoomAir.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge148" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M68.8241,-10636.5323C87.3608,-10695.3718 173.4203,-10972.53 223.8406,-11204.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C328.7915,-11686.4764 265.8614,-10588.5257 281.2024,-10095.2164 282.6828,-10047.6118 286.3027,-6702.46 317.2024,-6666.2164 341.1552,-6638.1212 378.5478,-6682.8977 399.0839,-6652.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6652.2164C424.4744,-6614.2824 445.4408,-6618.8813 480.9653,-6590.2164 576.5031,-6513.1265 575.3619,-6452.8747 690.4731,-6410.2164 799.2944,-6369.889 938.7011,-6394.0804 1011.0551,-6411.7199"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1010.2591,-6415.1286 1020.8094,-6414.1581 1011.9566,-6408.3375 1010.2591,-6415.1286"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge232" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C236.8868,-11264.1202 429.1038,-11136.9128 480.9653,-11104.2164 731.3729,-10946.3454 757.4825,-10857.9014 966.4307,-10648.2164 1035.4984,-10578.9051 1077.0191,-10576.7045 1116.5955,-10487.2164 1195.4174,-10308.988 1096.2385,-10236.7698 1152.5955,-10050.2164 1197.3769,-9901.9805 1271.7194,-9892.008 1321.0291,-9745.2164 1356.635,-9639.2196 1316.7383,-9600.5225 1357.0291,-9496.2164 1366.1578,-9472.5835 1856.7066,-8763.2652 1867.2231,-8740.2164 1892.8215,-8684.113 1857.4642,-8647.5562 1903.2231,-8606.2164 1932.0122,-8580.2076 1967.4143,-8624.1916 1989.3882,-8592.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge205" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-6652.2164C755.3775,-6609.5346 860.7379,-6612.8079 966.4307,-6752.2164 1076.6423,-6897.5852 1069.2314,-6958.0478 1116.5955,-7134.2164 1144.2576,-7237.1043 1103.005,-7276.9195 1152.5955,-7371.2164 1319.2382,-7688.0898 1413.996,-7774.7166 1740.2205,-7922.2164 1841.5937,-7968.0515 1884.4973,-7909.1313 1989.3882,-7946.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6652.2164C445.9138,-6583.751 502.8357,-6648.9192 585.7192,-6652.2164"/>
</g>
<!-- sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node61" class="node">
<title>sourcefile~datawater.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node61"><a xlink:href="../sourcefile/datawater.f90.html" xlink:title="DataWater.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="2028.6262,-7215.2218 1950.1502,-7215.2218 1950.1502,-7193.2109 2028.6262,-7193.2109 2028.6262,-7215.2218"/>
<text text-anchor="middle" x="1989.3882" y="-7201.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataWater.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge213" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M911.1119,-1178.2164C935.8451,-1170.213 949.6836,-1177.3337 966.4307,-1197.2164 1031.1068,-1274.0018 976.3538,-1323.2679 1002.4307,-1420.2164 1142.1046,-1939.4947 1766.7291,-3151.9553 1867.2231,-3680.2164 1902.7642,-3867.043 1836.5118,-6925.1238 1903.2231,-7103.2164 1916.071,-7137.5149 1946.1684,-7168.1489 1967.1506,-7186.4524"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1965.0699,-7189.2769 1974.9627,-7193.0694 1969.5942,-7183.9354 1965.0699,-7189.2769"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge279" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1623.2106,-610.2164C1660.2755,-642.3663 1672.2274,-648.0159 1704.2205,-685.2164 1722.7879,-706.806 1723.3219,-715.2969 1740.2205,-738.2164 1793.8925,-811.012 1829.3079,-815.1047 1867.2231,-897.2164 1902.5217,-973.6611 1861.5342,-1010.0603 1903.2231,-1083.2164 1953.9335,-1172.2033 2029.5949,-1144.6848 2075.5532,-1236.2164 2159.2234,-1402.8558 2060.8007,-1474.7907 2111.5532,-1654.2164 2162.7221,-1835.1141 2200.6418,-1873.4933 2301.3853,-2032.2164 2341.6614,-2095.6722 2447.9876,-2256.147 2510.269,-2298.2164 2516.698,-2302.5589 2523.8882,-2306.1586 2531.2981,-2309.1398"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2530.1671,-2312.4528 2540.761,-2312.5948 2532.5679,-2305.8773 2530.1671,-2312.4528"/>
</g>
<!-- sourcefile~dataconvergparams.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node64" class="node">
<title>sourcefile~dataconvergparams.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node64"><a xlink:href="../sourcefile/dataconvergparams.f90.html" xlink:title="DataConvergParams.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="462.641,-430.2218 335.5267,-430.2218 335.5267,-408.2109 462.641,-408.2109 462.641,-430.2218"/>
<text text-anchor="middle" x="399.0839" y="-416.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataConvergParams.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataconvergparams.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge284" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataconvergparams.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.8406,-1962.2164C361.0995,-1863.6465 212.5371,-576.886 317.2024,-444.2164 319.9469,-440.7375 323.1627,-437.7299 326.7027,-435.1309"/>
<polygon fill="#00ff00" stroke="#00ff00" points="328.7655,-437.9725 335.4821,-429.7787 325.1217,-431.9956 328.7655,-437.9725"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge287" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-1217.2164C788.0378,-1202.2123 829.0595,-1202.8625 860.7748,-1206.9175"/>
<polygon fill="#00ffff" stroke="#00ffff" points="860.3285,-1210.3892 870.7229,-1208.3381 861.3182,-1203.4595 860.3285,-1210.3892"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge617" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1431.6149,-268.2164C1585.7955,-208.3902 1642.4204,-231.7103 1803.7218,-268.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1236.8123,-382.2164C1336.1125,-367.9869 1336.0904,-298.8448 1431.6149,-268.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.8406,-1962.2164C361.3921,-1871.5016 214.3225,-610.9227 317.2024,-482.2164 340.8806,-452.5941 373.7535,-486.4389 399.0839,-458.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.7218,-268.2164C1847.8191,-272.7732 1858.9184,-262.7729 1903.2231,-261.2164 1979.7671,-258.5272 2002.9097,-236.9447 2075.5532,-261.2164 2304.8583,-337.8319 2299.9264,-469.0244 2510.269,-588.2164 2737.1602,-716.7856 2830.7016,-674.2214 3053.8293,-809.2164 3345.2277,-985.5159 3485.8399,-1033.4621 3588.4519,-1358.2164 3638.4496,-1516.4529 3548.1825,-7184.8341 3624.4519,-7332.2164 3625.8004,-7334.8223 3627.5595,-7337.218 3629.571,-7339.4065"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3256,-7342.0926 3637.1522,-7346.0535 3631.9405,-7336.8292 3627.3256,-7342.0926"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-458.2164C400.7726,-456.3348 752.6049,-382.2164 755.1332,-382.2164 755.1332,-382.2164 755.1332,-382.2164 911.1119,-382.2164 1055.8676,-382.2164 1093.5203,-402.7498 1236.8123,-382.2164"/>
</g>
<!-- sourcefile~datarootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node67" class="node">
<title>sourcefile~datarootfinder.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node67"><a xlink:href="../sourcefile/datarootfinder.f90.html" xlink:title="DataRootFinder.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="806.693,-128.2218 703.5733,-128.2218 703.5733,-106.2109 806.693,-106.2109 806.693,-128.2218"/>
<text text-anchor="middle" x="755.1332" y="-114.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataRootFinder.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datarootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge624" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datarootfinder.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M585.7192,-117.2164C619.1914,-102.2879 660.2174,-101.8924 693.5129,-105.419"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="693.235,-108.9107 703.5809,-106.6276 694.0694,-101.9606 693.235,-108.9107"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~faultsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge291" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~faultsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-16155.2164C268.24,-16221.7625 756.1277,-15799.6561 819.7932,-15751.2164 931.1299,-15666.5062 919.7839,-15554.1044 1059.5131,-15547.2164"/>
</g>
<!-- sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node69" class="node">
<title>sourcefile~datadefineequip.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node69"><a xlink:href="../sourcefile/datadefineequip.f90.html" xlink:title="Datadefineequip.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="452.0763,-16452.2218 346.0914,-16452.2218 346.0914,-16430.2109 452.0763,-16430.2109 452.0763,-16452.2218"/>
<text text-anchor="middle" x="399.0839" y="-16438.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Datadefineequip.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge296" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M223.8406,-16155.2164C296.688,-16254.5694 228.057,-16331.1819 317.2024,-16416.2164 322.674,-16421.4357 329.2047,-16425.5678 336.1574,-16428.8389"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="335.2588,-16432.2522 345.8401,-16432.7868 337.9017,-16425.7702 335.2588,-16432.2522"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge329" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1803.7218,-268.2164C1922.086,-294.0029 1967.2495,-233.9454 2075.5532,-288.2164 2109.7633,-305.359 2275.7232,-519.8323 2301.3853,-548.2164 2392.2417,-648.71 2415.6431,-673.2638 2510.269,-770.2164 2512.8228,-772.833 3257.8393,-1506.9178 3259.4165,-1510.2164 3328.2091,-1654.0868 3255.2381,-1712.8894 3295.4165,-1867.2164 3313.8441,-1937.9974 3331.2657,-1951.3243 3360.8456,-2018.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3360.8456,-2018.2164C3405.2044,-2115.8113 3511.0571,-3834.2328 3524.0488,-4047.5471"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3520.57,-4048.0042 3524.6706,-4057.7733 3527.5571,-4047.5793 3520.57,-4048.0042"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge357" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1059.5131,-16990.2164C1512.5775,-16942.2095 1669.1618,-17060.1728 2075.5532,-16854.2164 2605.7714,-16585.5054 2833.7702,-16494.4037 3053.8293,-15942.2164 3081.0291,-15873.9649 3087.6826,-14693.6567 3089.8293,-14620.2164 3122.626,-13498.2474 3167.736,-12115.6319 3173.9119,-11926.9176"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3177.419,-11926.7568 3174.2482,-11916.6476 3170.4227,-11926.5277 3177.419,-11926.7568"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge448" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1236.8123,-382.2164C1527.2574,-340.5962 1611.1522,-434.9742 1867.2231,-578.2164 1960.8671,-630.5994 2018.8997,-609.0925 2075.5532,-700.2164 2134.7222,-795.3862 2055.1049,-1106.408 2111.5532,-1203.2164 2135.9264,-1245.0162 2440.314,-1409.7441 2474.269,-1444.2164 2495.0323,-1465.2959 2487.4602,-1481.3692 2510.269,-1500.2164 2573.7329,-1552.6573 2611.0938,-1527.6786 2682.1736,-1569.2164 2966.1255,-1735.1529 3114.678,-1736.8955 3259.4165,-2032.2164 3312.3815,-2140.2849 3268.1808,-4080.9887 3295.4165,-4198.2164 3305.8992,-4243.336 3332.2716,-4291.2094 3348.1498,-4317.3346"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3345.2337,-4319.2734 3353.476,-4325.9303 3351.184,-4315.5863 3345.2337,-4319.2734"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge511" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M399.0839,-16402.2164C476.9062,-16433.1523 453.493,-16309.8479 516.9653,-16255.2164 634.9506,-16153.6649 687.7198,-16161.6169 819.7932,-16079.2164 886.298,-16037.724 901.3228,-16024.8681 966.4307,-15981.2164 1033.2368,-15936.4261 1053.1797,-15929.6902 1116.5955,-15880.2164 1393.6587,-15664.0654 1540.7004,-15662.2573 1704.2205,-15351.2164 1761.5797,-15242.1101 1695.0778,-15190.9178 1740.2205,-15076.2164 1775.8115,-14985.7843 1825.0379,-14985.7668 1867.2231,-14898.2164 1892.5042,-14845.7486 1881.1103,-14826.0961 1903.2231,-14772.2164 1963.8128,-14624.5847 2007.206,-14601.4206 2075.5532,-14457.2164 2171.8637,-14254.0129 2208.3934,-14205.7463 2265.3853,-13988.2164 2297.1842,-13866.844 2262.4436,-13827.489 2301.3853,-13708.2164 2350.8302,-13556.7736 2433.1187,-13548.1201 2474.269,-13394.2164 2527.9774,-13193.3453 2460.1015,-11725.0009 2510.269,-11523.2164 2524.804,-11464.7538 2562.172,-11403.418 2582.5204,-11372.8975"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2585.5311,-11374.6936 2588.2448,-11364.4522 2579.7368,-11370.766 2585.5311,-11374.6936"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M223.8406,-16155.2164C280.9042,-16246.2577 237.1154,-16306.5865 317.2024,-16378.2164 345.4687,-16403.4978 363.9902,-16387.8437 399.0839,-16402.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge538" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1431.6149,-16686.2164C1515.8817,-16663.0428 2558.0186,-15543.8132 2682.1736,-15208.2164 2716.9546,-15114.2016 2711.8504,-13504.2589 2718.1736,-13404.2164 2736.2093,-13118.8634 2782.0616,-12773.8729 2794.1606,-12685.5904"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2797.6548,-12685.8717 2795.5519,-12675.4877 2790.7203,-12684.9167 2797.6548,-12685.8717"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M911.1119,-16572.2164C1025.3533,-16563.9838 1040.8505,-16637.0782 1152.5955,-16662.2164 1274.0272,-16689.5337 1309.8793,-16712.1464 1431.6149,-16686.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge549" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M585.7192,-16611.2164C656.332,-16642.5793 678.3627,-16580.9388 755.1332,-16572.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M755.1332,-16572.2164C906.8832,-16554.975 1200.2532,-16275.6964 1321.0291,-16182.2164 1499.2262,-16044.2925 1546.1015,-16010.7642 1704.2205,-15850.2164 1976.3003,-15573.9571 2046.7604,-15502.4504 2265.3853,-15182.2164 2284.2248,-15154.6208 2279.2536,-15141.249 2301.3853,-15116.2164 2332.7011,-15080.7958 2348.2074,-15080.0151 2387.8271,-15054.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M399.0839,-16402.2164C433.263,-16417.2981 453.9462,-16395.4165 480.9653,-16421.2164 523.7058,-16462.0281 485.7956,-16499.0089 516.9653,-16549.2164 538.6679,-16584.1743 548.1148,-16594.5142 585.7192,-16611.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge576" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M399.0839,-3877.2164C498.6905,-4024.5282 586.0387,-4021.0854 654.4731,-4185.2164 717.5458,-4336.4879 642.7916,-4395.4117 690.4731,-4552.2164 764.9973,-4797.2952 854.3192,-4827.8937 966.4307,-5058.2164 984.5657,-5095.473 981.5999,-5108.3971 1002.4307,-5144.2164 1044.1936,-5216.0294 1087.9791,-5214.2269 1116.5955,-5292.2164 1146.3665,-5373.3529 1096.8296,-6003.189 1152.5955,-6069.2164 1256.377,-6192.095 1364.5028,-6070.1147 1506.2007,-6146.2164 1525.8601,-6156.7749 1525.7755,-6166.1105 1542.2007,-6181.2164 1698.7237,-6325.1675 1715.9689,-6394.4334 1903.2231,-6495.2164 1938.2284,-6514.0567 1967.1427,-6486.2699 1989.3882,-6519.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge433" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-458.2164C425.8459,-429.081 715.5721,-458.2164 755.1332,-458.2164 755.1332,-458.2164 755.1332,-458.2164 1059.5131,-458.2164 1429.6594,-458.2164 1562.2327,-451.4805 1867.2231,-661.2164 1886.6599,-674.5826 1885.3786,-684.7886 1903.2231,-700.2164 1973.4434,-760.9266 2029.3037,-737.7328 2075.5532,-818.2164 2130.394,-913.6504 2057.6868,-1216.229 2111.5532,-1312.2164 2152.6867,-1385.5143 2197.0918,-1373.2209 2265.3853,-1422.2164 2450.8322,-1555.2607 2530.1549,-1551.9763 2682.1736,-1722.2164 2907.1732,-1974.185 2963.431,-2059.7304 3053.8293,-2385.2164 3088.4857,-2509.9994 3078.6766,-3421.1913 3089.8293,-3550.2164 3109.3564,-3776.1228 3156.8329,-4047.248 3170.7365,-4124.0352"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3167.3026,-4124.7144 3172.537,-4133.9259 3174.1894,-4123.4607 3167.3026,-4124.7144"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge406" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-1178.2164C1065.9761,-1126.2684 927.99,-967.6127 1002.4307,-822.2164 1049.9099,-729.4805 1059.7893,-689.558 1152.5955,-642.2164 1339.3464,-546.9524 1462.7971,-475.2399 1623.2106,-610.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-1217.2164C820.1508,-1187.5692 841.3035,-1193.4815 911.1119,-1178.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-610.2164C1730.5602,-673.4559 1780.8887,-658.3856 1867.2231,-748.2164 1891.465,-773.44 1885.6644,-787.9576 1903.2231,-818.2164 1973.7364,-939.7306 2029.8754,-950.358 2075.5532,-1083.2164 2136.3225,-1259.9699 2031.0611,-1333.5281 2111.5532,-1502.2164 2152.4109,-1587.8423 2205.258,-1576.828 2265.3853,-1650.2164 2483.5878,-1916.5436 2572.662,-1976.7968 2682.1736,-2303.2164 2746.4136,-2494.6957 2684.1743,-2557.1306 2718.1736,-2756.2164 2764.3034,-3026.3335 2832.0268,-3081.7522 2876.0764,-3352.2164 2883.0415,-3394.9818 2969.8832,-4809.0277 2981.639,-5000.7737"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.1588,-5001.2055 2982.2642,-5010.9726 2985.1457,-5000.7771 2978.1588,-5001.2055"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-1369.2164C660.0894,-1349.2556 625.5356,-1272.5984 690.4731,-1231.2164 715.2699,-1215.4145 728.3796,-1229.4157 755.1332,-1217.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-1962.2164C400.2965,-1842.1933 190.5415,-1662.9698 317.2024,-1491.2164 377.1053,-1409.9874 422.0958,-1417.6589 516.9653,-1383.2164 546.2777,-1372.5745 555.6008,-1377.3001 585.7192,-1369.2164"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge371" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-2970.2164C2264.4406,-3106.7538 2246.5145,-3517.9176 2301.3853,-3664.2164 2318.7929,-3710.6294 2352.6113,-3758.3275 2372.3945,-3784.0107"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2369.8369,-3786.4217 2378.7568,-3792.1389 2375.3491,-3782.107 2369.8369,-3786.4217"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-1178.2164C998.6496,-1148.338 1028.4264,-1183.2564 1116.5955,-1211.2164 1325.6933,-1277.525 1383.4717,-1332.4023 1506.2007,-1514.2164 1619.8678,-1682.6058 1647.3086,-1731.1875 1704.2205,-1926.2164 1741.7153,-2054.706 1686.7204,-2102.5249 1740.2205,-2225.2164 1775.1359,-2305.288 1816.3619,-2304.1975 1867.2231,-2375.2164 1885.3302,-2400.4997 1887.1359,-2408.6022 1903.2231,-2435.2164 1979.4021,-2561.2442 2022.6977,-2580.7662 2075.5532,-2718.2164 2106.4013,-2798.4365 2067.379,-2834.4905 2111.5532,-2908.2164 2134.1207,-2945.881 2167.1204,-2931.8478 2188.4692,-2970.2164"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node80" class="node">
<title>sourcefile~dataphotovoltaics.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node80"><a xlink:href="../sourcefile/dataphotovoltaics.f90.html" xlink:title="DataPhotovoltaics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="456.2282,-15635.2218 341.9395,-15635.2218 341.9395,-15613.2109 456.2282,-15613.2109 456.2282,-15635.2218"/>
<text text-anchor="middle" x="399.0839" y="-15621.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataPhotovoltaics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge461" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C249.8152,-11323.5327 243.5114,-15501.8474 317.2024,-15599.2164 321.3607,-15604.7108 326.6981,-15609.0351 332.6513,-15612.4328"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.2161,-15615.626 341.7483,-15616.7764 334.2323,-15609.3091 331.2161,-15615.626"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge478" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-16155.2164C265.2049,-16221.2104 321.5904,-16163.0253 399.0839,-16155.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-16155.2164C791.5618,-16115.6667 803.6857,-15870.2411 1152.5955,-15686.2164 1224.9181,-15648.0714 1271.8916,-15677.5701 1321.0291,-15612.2164 1393.7819,-15515.4537 1326.4242,-15459.346 1357.0291,-15342.2164 1402.3741,-15168.6736 1442.1183,-15134.7476 1506.2007,-14967.2164 1692.597,-14479.9186 1767.7845,-14362.383 1867.2231,-13850.2164 1895.3428,-13705.3841 1855.1652,-13659.7067 1903.2231,-13520.2164 1919.2728,-13473.6317 1953.1582,-13426.3305 1973.3228,-13400.6914"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1976.3133,-13402.5563 1979.8314,-13392.5626 1970.849,-13398.1811 1976.3133,-13402.5563"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge464" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-16155.2164C273.8919,-16223.479 261.9246,-16053.3201 317.2024,-15989.2164 501.8432,-15775.0949 676.6625,-15843.048 819.7932,-15599.2164 873.728,-15507.3352 821.6812,-15463.1494 855.7932,-15362.2164 865.961,-15332.1312 884.8086,-15300.4958 897.65,-15280.8167"/>
<polygon fill="#ff0000" stroke="#ff0000" points="900.6118,-15282.6836 903.2409,-15272.4202 894.7853,-15278.804 900.6118,-15282.6836"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M65.2532,-10636.2303C65.5325,-10822.7452 71.04,-13341.2557 166.4788,-15368.2164 182.9733,-15718.5339 29.1971,-15863.483 223.8406,-16155.2164"/>
</g>
<!-- sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node83" class="node">
<title>sourcefile~dataerrortracking.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node83"><a xlink:href="../sourcefile/dataerrortracking.f90.html" xlink:title="DataErrorTracking.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1489.018,-6257.2218 1374.2118,-6257.2218 1374.2118,-6235.2109 1489.018,-6235.2109 1489.018,-6257.2218"/>
<text text-anchor="middle" x="1431.6149" y="-6243.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataErrorTracking.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge468" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataerrortracking.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-3610.2164C513.4154,-3753.1156 585.2807,-3763.793 654.4731,-3933.2164 711.424,-4072.6652 656.9212,-4123.3707 690.4731,-4270.2164 713.4407,-4370.7376 965.3821,-5047.9905 1002.4307,-5144.2164 1050.1271,-5268.0981 1087.2858,-5290.7459 1116.5955,-5420.2164 1133.2521,-5493.794 1112.0082,-6034.6256 1152.5955,-6098.2164 1201.4208,-6174.7145 1303.7345,-6214.1589 1369.969,-6232.4868"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1369.3065,-6235.9328 1379.872,-6235.1446 1371.121,-6229.172 1369.3065,-6235.9328"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node84" class="node">
<title>sourcefile~dataheatbalsurface.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node84"><a xlink:href="../sourcefile/dataheatbalsurface.f90.html" xlink:title="DataHeatBalSurface.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1866.4559,-15254.2218 1740.9877,-15254.2218 1740.9877,-15232.2109 1866.4559,-15232.2109 1866.4559,-15254.2218"/>
<text text-anchor="middle" x="1803.7218" y="-15240.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHeatBalSurface.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge469" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataheatbalsurface.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-16402.2164C486.7354,-16439.3885 726.695,-16341.1481 819.7932,-16321.2164 952.3212,-16292.843 994.3408,-16309.7186 1116.5955,-16251.2164 1259.8884,-16182.6467 1687.2781,-15779.947 1704.2205,-15750.2164 1753.2055,-15664.257 1791.6523,-15349.9775 1801.3496,-15264.6931"/>
<polygon fill="#0000ff" stroke="#0000ff" points="1804.8415,-15264.9604 1802.4803,-15254.6321 1797.8853,-15264.1786 1804.8415,-15264.9604"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node85" class="node">
<title>sourcefile~datacomplexfenestration.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node85"><a xlink:href="../sourcefile/datacomplexfenestration.f90.html" xlink:title="DataComplexFenestration.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="475.0737,-5103.2218 323.0941,-5103.2218 323.0941,-5081.2109 475.0737,-5081.2109 475.0737,-5103.2218"/>
<text text-anchor="middle" x="399.0839" y="-5089.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataComplexFenestration.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge689" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-4597.2164C384.6915,-4457.6337 174.3433,-4909.2682 317.2024,-5067.2164 320.315,-5070.6577 323.8861,-5073.6315 327.7576,-5076.2006"/>
<polygon fill="#ff0000" stroke="#ff0000" points="326.2199,-5079.3513 336.6517,-5081.2028 329.6513,-5073.25 326.2199,-5079.3513"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node86" class="node">
<title>sourcefile~dataequivalentlayerwindow.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node86"><a xlink:href="../sourcefile/dataequivalentlayerwindow.f90.html" xlink:title="DataEquivalentLayerWindow.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="480.847,-4647.2218 317.3208,-4647.2218 317.3208,-4625.2109 480.847,-4625.2109 480.847,-4647.2218"/>
<text text-anchor="middle" x="399.0839" y="-4633.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataEquivalentLayerWindow.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge691" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.8406,-4597.2164C233.6686,-4588.6879 305.2453,-4607.8817 353.8283,-4622.259"/>
<polygon fill="#00ffff" stroke="#00ffff" points="352.9309,-4625.6437 363.5143,-4625.1513 354.9338,-4618.9363 352.9309,-4625.6437"/>
</g>
<!-- sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge759" class="edge">
<title>sourcefile~dataprecisionglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-15585.2164C440.0438,-15626.8461 602.0483,-15548.9533 654.4731,-15523.2164 667.3287,-15516.9052 843.4681,-15369.5092 855.7932,-15362.2164 901.6241,-15335.0979 933.9931,-15358.4501 966.4307,-15316.2164 978.2951,-15300.7689 1149.1923,-13945.3947 1152.5955,-13926.2164 1213.043,-13585.5643 1279.1881,-13509.6506 1321.0291,-13166.2164 1360.735,-12840.3065 1281.7866,-12008.798 1357.0291,-11689.2164 1449.0354,-11298.4325 1554.7128,-11227.2559 1740.2205,-10871.2164 1826.9532,-10704.7528 1803.5968,-10556.9421 1989.3882,-10530.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8406,-11204.2164C249.5961,-11322.5003 243.5995,-15465.1067 317.2024,-15561.2164 340.2598,-15591.3244 371.2846,-15559.4222 399.0839,-15585.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge915" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3659.3423,-384.2164C3673.9647,-396.0665 3682.99,-393.1219 3694.2327,-408.2164 3772.3413,-513.0856 3717.8756,-575.7438 3784.5721,-688.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3174.6229,-194.2164C3212.275,-205.0022 3222.9686,-203.8788 3259.4165,-218.2164 3306.5588,-236.7609 3310.48,-264.7761 3360.8456,-270.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9572,-10064.0611C227.5578,-9719.7542 313.342,-1520.1414 317.2024,-1491.2164 328.0997,-1409.5652 631.8057,-114.0419 690.4731,-56.2164 762.3738,14.6525 810.156,-2.2164 911.1119,-2.2164 911.1119,-2.2164 911.1119,-2.2164 2387.8271,-2.2164 2519.0819,-2.2164 2555.1001,6.6491 2682.1736,-26.2164 2736.461,-40.2569 2741.7148,-69.6157 2797.125,-78.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3360.8456,-270.2164C3464.1096,-281.3704 3495.8337,-276.2085 3588.4519,-323.2164 3625.5167,-342.0284 3627.0496,-358.0462 3659.3423,-384.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3784.5721,-688.2164C3872.7402,-836.8972 3919.8662,-6708.5646 3922.9637,-7106.977"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3919.4651,-7107.1841 3923.0424,-7117.1567 3926.4648,-7107.1298 3919.4651,-7107.1841"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-78.2164C2913.4586,-94.5628 2942.5805,-103.4751 3053.8293,-141.2164 3109.3479,-160.0511 3118.2634,-178.0715 3174.6229,-194.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge48" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.3047,-10086.319C228.77,-10191.4801 265.0898,-11010.3025 317.2024,-11104.2164 361.4988,-11184.0444 438.3525,-11147.4771 480.9653,-11228.2164 519.4408,-11301.1164 457.2807,-11912.361 516.9653,-11969.2164 561.216,-12011.3694 601.2021,-11999.1694 654.4731,-11969.2164 887.0725,-11838.4313 856.4361,-11699.3386 966.4307,-11456.2164 988.5069,-11407.421 971.5619,-11384.9824 1002.4307,-11341.2164 1039.045,-11289.3043 1078.644,-11306.1591 1116.5955,-11255.2164 1144.0676,-11218.3402 1122.112,-11192.6449 1152.5955,-11158.2164 1208.4493,-11095.134 1275.1722,-11141.9001 1321.0291,-11071.2164 1397.4702,-10953.3901 1285.3462,-10560.9965 1357.0291,-10440.2164 1380.2172,-10401.1461 1665.9213,-10248.657 1704.2205,-10224.2164 1745.7864,-10197.6911 2038.5863,-10013.8471 2075.5532,-9981.2164 2133.6866,-9929.902 2124.6409,-9892.2458 2188.4692,-9848.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge52" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datahvacglobals.f90</title>
<path fill="none" stroke="#ff2800" stroke-dasharray="5,2" d="M399.0839,-11090.2164C426.8898,-11126.4172 446.2039,-11122.6307 480.9653,-11152.2164 512.7138,-11179.2377 547.2826,-11213.2087 567.6984,-11233.7898"/>
<polygon fill="#ff2800" stroke="#ff2800" points="565.279,-11236.321 574.7946,-11240.9798 570.2611,-11231.4038 565.279,-11236.321"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge71" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M399.0839,-14918.2164C419.3342,-14949.6105 455.4614,-14909.9177 480.9653,-14937.2164 549.5023,-15010.5764 452.4816,-15083.2692 516.9653,-15160.2164 537.7539,-15185.0229 558.822,-15166.2145 585.7192,-15184.2164"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M755.1332,-15184.2164C931.3794,-15163.057 1362.0608,-15015.822 1506.2007,-14912.2164 2026.9251,-14537.9272 1945.7637,-14241.8639 2301.3853,-13708.2164 2371.711,-13602.6852 2432.456,-13600.9419 2474.269,-13481.2164 2536.745,-13302.3255 2474.993,-11962.3905 2510.269,-11776.2164 2525.7754,-11694.3795 2566.8249,-11603.3713 2586.0365,-11563.6361"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.2728,-11564.9853 2590.5258,-11554.4648 2582.9856,-11561.9077 2589.2728,-11564.9853"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M585.7192,-15184.2164C617.0061,-15205.1561 717.5411,-15186.2589 755.1332,-15184.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge100" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M224.471,-10086.3126C233.5923,-10244.9158 341.2344,-12052.6452 516.9653,-12197.2164 564.1611,-12236.0436 601.7875,-12228.1876 654.4731,-12197.2164 906.1282,-12049.2811 871.476,-11895.2575 966.4307,-11619.2164 995.2402,-11535.4646 960.7051,-11501.3401 1002.4307,-11423.2164 1035.771,-11360.7925 1079.9487,-11372.7583 1116.5955,-11312.2164 1145.6498,-11264.2175 1114.3083,-11232.2303 1152.5955,-11191.2164 1207.1351,-11132.7925 1273.6776,-11192.604 1321.0291,-11128.2164 1406.7367,-11011.6728 1266.2199,-10590.8303 1357.0291,-10478.2164 1409.0114,-10413.7522 1999.4358,-10312.8344 2075.5532,-10280.2164 2166.0118,-10241.4528 2189.772,-10229.2085 2265.3853,-10166.2164 2495.6237,-9974.4085 2577.6861,-9917.0764 2682.1736,-9636.2164 2711.518,-9557.3391 2663.9529,-9323.5812 2718.1736,-9259.2164 2765.034,-9203.5888 2829.4164,-9272.0122 2876.0764,-9216.2164 2934.466,-9146.3945 2870.8508,-8889.3637 2912.0764,-8808.2164 2931.0327,-8770.9034 2973.1269,-8786.8987 2982.9529,-8746.2164"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2982.9529,-8746.2164C2992.7979,-8705.5387 3034.9558,-8721.5713 3053.8293,-8684.2164 3120.831,-8551.6049 3167.1514,-7432.7227 3173.7985,-7263.5958"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3177.3011,-7263.5942 3174.1936,-7253.4654 3170.3064,-7263.3214 3177.3011,-7263.5942"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge112" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M399.0839,-2622.2164C415.2004,-2596.8099 629.2344,-2695.8384 654.4731,-2712.2164 673.9887,-2724.8804 672.1815,-2735.841 690.4731,-2750.2164 742.5387,-2791.1345 766.9281,-2784.3365 819.7932,-2824.2164 892.4656,-2879.0383 902.477,-2902.4348 966.4307,-2967.2164 1034.4919,-3036.1587 1067.8819,-3041.4765 1116.5955,-3125.2164 1144.38,-3172.9788 1123.001,-3197.5537 1152.5955,-3244.2164 1206.6014,-3329.3694 1266.719,-3311.257 1321.0291,-3396.2164 1350.1036,-3441.6988 1332.1274,-3464.3219 1357.0291,-3512.2164 1407.04,-3608.4048 1448.79,-3613.2526 1506.2007,-3705.2164 1525.3575,-3735.9028 1514.5402,-3754.9025 1542.2007,-3778.2164 1599.6261,-3826.6178 1642.2741,-3783.7544 1704.2205,-3826.2164 1745.9581,-3854.826 1777.9548,-3906.4507 1793.441,-3934.9495"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1790.4518,-3936.7841 1798.2191,-3943.9897 1796.6406,-3933.5131 1790.4518,-3936.7841"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge119" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataipshortcuts.f90</title>
<path fill="none" stroke="#ffc900" stroke-dasharray="5,2" d="M224.2109,-10086.4645C226.7478,-10156.7965 243.722,-10535.8103 317.2024,-10619.2164 322.2011,-10624.8903 328.4468,-10629.2963 335.2465,-10632.7144"/>
<polygon fill="#ffc900" stroke="#ffc900" points="334.2257,-10636.0841 344.797,-10636.7894 336.9728,-10629.6457 334.2257,-10636.0841"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge127" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M399.0839,-5053.2164C493.5977,-4891.7767 653.7397,-4954.0662 819.7932,-5040.2164 943.8556,-5104.5812 914.3406,-5187.7062 1002.4307,-5296.2164 1049.6454,-5354.376 1087.2905,-5351.2744 1116.5955,-5420.2164 1169.0219,-5543.5532 1067.519,-5918.6669 1152.5955,-6022.2164 1281.0337,-6178.543 1940.3054,-6264.2633 2134.5508,-6286.3991"/>
<polygon fill="#fff100" stroke="#fff100" points="2134.1953,-6289.8812 2144.5251,-6287.5263 2134.9814,-6282.9254 2134.1953,-6289.8812"/>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M223.8559,-10064.0498C224.2313,-9806.4498 232.1589,-5177.2266 317.2024,-5072.2164 340.7143,-5043.1843 375.5712,-5082.2478 399.0839,-5053.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge130" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasizing.f90</title>
<path fill="none" stroke="#e4ff00" stroke-dasharray="5,2" d="M224.5817,-10086.4694C230.2063,-10172.382 266.3468,-10733.4981 281.2024,-11190.2164 283.5876,-11263.5455 284.3477,-13765.6159 317.2024,-13831.2164 327.462,-13851.7016 347.8688,-13867.4288 365.7424,-13878.0461"/>
<polygon fill="#e4ff00" stroke="#e4ff00" points="364.3585,-13881.2831 374.791,-13883.1306 367.7876,-13875.1806 364.3585,-13881.2831"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge191" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M2188.4692,-4488.2164C2207.2997,-4518.9987 2241.4869,-4487.1792 2265.3853,-4514.2164 2317.9743,-4573.7124 2248.4188,-4630.0561 2301.3853,-4689.2164 2309.3592,-4698.1228 2320.187,-4704.2099 2331.4803,-4708.3663"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2330.4327,-4711.7058 2341.0237,-4711.4231 2332.568,-4705.0394 2330.4327,-4711.7058"/>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M585.7192,-2095.2164C616.5379,-2099.9782 626.2675,-2095.9158 654.4731,-2109.2164 893.4581,-2221.9113 974.1574,-2260.6735 1116.5955,-2483.2164 1151.6939,-2538.0535 1117.0284,-2570.682 1152.5955,-2625.2164 1237.5769,-2755.5168 1600.7323,-2940.0688 1704.2205,-3056.2164 1796.7116,-3160.0217 1825.6489,-3190.5449 1867.2231,-3323.2164 1907.6291,-3452.1596 1828.7671,-3817.4542 1903.2231,-3930.2164 1950.3891,-4001.6483 2027.3948,-3945.4498 2075.5532,-4016.2164 2127.2593,-4092.196 2067.6742,-4347.4634 2111.5532,-4428.2164 2132.2531,-4466.3114 2165.8448,-4451.2319 2188.4692,-4488.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge199" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datazonecontrols.f90</title>
<path fill="none" stroke="#6bff00" stroke-dasharray="5,2" d="M399.0839,-1710.2164C414.7208,-1675.6675 451.4368,-1710.0114 480.9653,-1686.2164 506.9825,-1665.2509 496.264,-1646.4442 516.9653,-1620.2164 567.9507,-1555.6198 603.4877,-1560.8129 654.4731,-1496.2164 675.1745,-1469.9886 667.1566,-1454.1493 690.4731,-1430.2164 789.4049,-1328.6695 884.0191,-1385.5749 966.4307,-1270.2164 1014.3622,-1203.1225 969.9729,-1164.0155 1002.4307,-1088.2164 1037.1032,-1007.2451 1083.267,-1007.7501 1116.5955,-926.2164 1154.0845,-834.5045 1095.0535,-786.8725 1152.5955,-706.2164 1212.518,-622.2233 1260.0374,-631.4039 1357.0291,-596.2164 1436.0059,-567.5645 1458.617,-566.7042 1542.2007,-558.2164 1591.6582,-553.194 1953.9371,-537.3668 1989.3882,-572.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge259" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M755.1332,-15184.2164C1378.0354,-15150.3718 1495.0704,-15888.6727 2075.5532,-15660.2164 2418.3941,-15525.287 2491.2207,-15410.3081 2682.1736,-15095.2164 2850.3757,-14817.6658 2830.2806,-14712.5091 2876.0764,-14391.2164 2885.8767,-14322.4597 2871.5505,-11947.6184 2912.0764,-11891.2164 2914.3415,-11888.064 2917.0373,-11885.3066 2920.0331,-11882.8951"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2922.1371,-11885.7007 2928.5742,-11877.2855 2918.2944,-11879.8497 2922.1371,-11885.7007"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge646" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M224.6097,-10086.4685C230.4426,-10172.3747 267.8403,-10733.4519 281.2024,-11190.2164 283.2644,-11260.7019 285.2182,-16204.3715 317.2024,-16267.2164 358.249,-16347.8679 414.8944,-16326.3768 480.9653,-16388.2164 546.4376,-16449.4956 937.6177,-16942.2403 1002.4307,-17004.2164 1063.3827,-17062.5005 1072.7812,-17092.9789 1152.5955,-17120.2164 1601.32,-17273.3485 2839.3372,-17003.072 3259.4165,-16783.2164 3491.7989,-16661.5951 3591.6539,-16625.61 3694.2327,-16384.2164 3743.097,-16269.2263 3782.3081,-7635.6459 3784.4775,-7149.5446"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3787.9784,-7149.3371 3784.523,-7139.3215 3780.9785,-7149.3058 3787.9784,-7149.3371"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge652" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M585.7192,-1900.2164C631.6325,-1871.6005 643.3327,-1864.7619 690.4731,-1838.2164 877.6324,-1732.824 995.1953,-1787.4116 1116.5955,-1610.2164 1190.9992,-1501.6169 1078.7299,-1425.1827 1152.5955,-1316.2164 1210.7269,-1230.461 1256.6637,-1229.9077 1357.0291,-1204.2164 1421.2567,-1187.7755 1442.2409,-1186.7624 1506.2007,-1204.2164 1622.6873,-1236.0044 1635.692,-1281.7729 1740.2205,-1342.2164 1796.391,-1374.6969 1834.256,-1358.3301 1867.2231,-1414.2164 1914.0259,-1493.5571 1891.3248,-4638.8715 1903.2231,-4730.2164 1943.4943,-5039.3809 2032.3145,-5101.4529 2075.5532,-5410.2164 2112.4601,-5673.765 2062.127,-6345.7263 2111.5532,-6607.2164 2125.5519,-6681.2764 2161.182,-6763.9182 2178.592,-6801.5458"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="2175.5728,-6803.3513 2182.9863,-6810.9205 2181.9111,-6800.3803 2175.5728,-6803.3513"/>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M399.0839,-2076.2164C420.1994,-2035.7466 449.3817,-2047.1731 480.9653,-2014.2164 500.4142,-1993.9219 498.4037,-1983.3253 516.9653,-1962.2164 544.1363,-1931.3166 551.1939,-1922.6007 585.7192,-1900.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge656" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataloopnode.f90</title>
<path fill="none" stroke="#00ff35" stroke-dasharray="5,2" d="M223.9117,-10063.8536C225.6943,-9781.182 260.8642,-4317.8167 317.2024,-4168.2164 365.5136,-4039.9308 392.5433,-3990.7517 516.9653,-3933.2164 572.4362,-3907.5654 609.0214,-3892.3614 654.4731,-3933.2164 710.4859,-3983.5643 667.7892,-4198.3986 690.4731,-4270.2164 808.277,-4643.1855 1010.591,-4663.7236 1116.5955,-5040.2164 1141.5529,-5128.8568 1109.583,-5786.792 1152.5955,-5868.2164 1163.4665,-5888.7957 1184.3905,-5904.5003 1202.6614,-5915.0826"/>
<polygon fill="#00ff35" stroke="#00ff35" points="1201.183,-5918.2637 1211.6335,-5920.0065 1204.5507,-5912.127 1201.183,-5918.2637"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge658" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairsystems.f90</title>
<path fill="none" stroke="#00ff5d" stroke-dasharray="5,2" d="M585.7192,-2095.2164C841.658,-2142.2966 959.2014,-2134.9766 1116.5955,-2342.2164 1166.4666,-2407.8813 1108.8938,-2454.2937 1152.5955,-2524.2164 1363.8684,-2862.253 1670.8968,-2719.2856 1867.2231,-3066.2164 1940.3208,-3195.3882 1872.5843,-3252.9927 1903.2231,-3398.2164 1955.4036,-3645.5438 2002.5121,-3698.2274 2075.5532,-3940.2164 2118.5364,-4082.6217 2166.4274,-4255.1611 2182.7014,-4314.2198"/>
<polygon fill="#00ff5d" stroke="#00ff5d" points="2179.4162,-4315.4733 2185.4442,-4324.1861 2186.1653,-4313.6158 2179.4162,-4315.4733"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge668" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1623.2106,-1408.2164C1660.1476,-1414.9803 1674.7027,-1409.0044 1704.2205,-1432.2164 1729.2676,-1451.9128 1716.0539,-1473.449 1740.2205,-1494.2164 1744.4326,-1497.8361 1749.2313,-1500.9684 1754.2605,-1503.6705"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1752.9536,-1506.9251 1763.4851,-1508.0819 1755.9736,-1500.61 1752.9536,-1506.9251"/>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M585.7192,-1900.2164C742.0415,-1817.164 815.1109,-1875.0679 966.4307,-1783.2164 1043.1486,-1736.6484 1067.9039,-1723.6044 1116.5955,-1648.2164 1145.193,-1603.9394 1118.6992,-1575.5811 1152.5955,-1535.2164 1291.915,-1369.3101 1410.1096,-1369.1931 1623.2106,-1408.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge678" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M399.0839,-2622.2164C569.1939,-2351.0793 905.7338,-2443.405 1116.5955,-2684.2164 1173.7904,-2749.535 1113.1487,-2798.8747 1152.5955,-2876.2164 1205.0766,-2979.114 1822.1822,-3524.8514 1867.2231,-3631.2164 1939.472,-3801.8336 1810.6874,-4303.6945 1903.2231,-4464.2164 1948.6032,-4542.9373 2029.8159,-4495.7025 2075.5532,-4574.2164 2152.6163,-4706.505 2042.435,-5125.6086 2111.5532,-5262.2164 2121.5474,-5281.9693 2140.8321,-5297.7423 2157.5903,-5308.5655"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2156.2098,-5311.8243 2166.5654,-5314.063 2159.8661,-5305.8551 2156.2098,-5311.8243"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge685" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataenvironment.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-6576.2164C495.648,-6413.7451 690.1016,-6500.7331 819.7932,-6638.2164 882.2498,-6704.4253 803.1175,-6971.9889 855.7932,-7046.2164 858.029,-7049.3669 860.7587,-7052.1278 863.7951,-7054.546"/>
<polygon fill="#00ffff" stroke="#00ffff" points="862.1336,-7057.6412 872.42,-7060.1791 865.9613,-7051.7804 862.1336,-7057.6412"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge696" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M399.0839,-5510.2164C517.3601,-5282.2133 786.7151,-5553.4941 911.1119,-5778.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge705" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~psychroutines.f90</title>
<path fill="none" stroke="#00aeff" stroke-dasharray="5,2" d="M224.58,-10086.4694C230.1917,-10172.3824 266.2546,-10733.5011 281.2024,-11190.2164 283.5333,-11261.4353 284.4101,-13691.9532 317.2024,-13755.2164 358.6065,-13835.0936 429.5508,-13800.384 480.9653,-13874.2164 514.7364,-13922.7124 469.8597,-13966.5316 516.9653,-14002.2164 627.5745,-14086.0081 724.5883,-14027.1692 819.7932,-13926.2164 850.8922,-13893.2398 1102.803,-13209.3947 1116.5955,-13166.2164 1230.0973,-12810.8913 1258.3561,-12719.9264 1321.0291,-12352.2164 1350.4247,-12179.7482 1323.9507,-12132.0163 1357.0291,-11960.2164 1373.8267,-11872.9736 1408.447,-11772.6497 1423.8873,-11730.0646"/>
<polygon fill="#00aeff" stroke="#00aeff" points="1427.2285,-11731.1188 1427.3771,-11720.525 1420.6545,-11728.7139 1427.2285,-11731.1188"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge713" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M224.3045,-10086.2873C228.1791,-10176.2896 256.5328,-10789.0468 317.2024,-10962.2164 339.5317,-11025.951 357.9462,-11036.6589 399.0839,-11090.2164"/>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M399.0839,-11090.2164C475.9069,-11190.233 850.5751,-11126.0419 966.4307,-11076.2164 1074.1647,-11029.8836 1052.8809,-10950.9444 1152.5955,-10889.2164 1186.1335,-10868.4547 1213.6002,-10893.1075 1236.8123,-10861.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge716" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairloop.f90</title>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M223.9594,-10063.9181C227.309,-9745.696 300.479,-2810.1977 317.2024,-2608.2164 336.9422,-2369.8035 288.421,-2288.3109 399.0839,-2076.2164"/>
<path fill="none" stroke="#0035ff" stroke-dasharray="5,2" d="M399.0839,-2076.2164C420.1994,-2035.7466 455.2499,-2051.9309 480.9653,-2014.2164 514.2572,-1965.3902 481.3811,-1933.398 516.9653,-1886.2164 653.0735,-1705.7489 801.046,-1802.3003 966.4307,-1648.2164 1016.0958,-1601.9449 1092.6751,-1445.7419 1116.5955,-1382.2164 1144.1177,-1309.1255 1094.7017,-1262.6383 1152.5955,-1210.2164 1183.4155,-1182.3093 1787.1208,-1143.978 1803.7218,-1180.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge721" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M585.7192,-10644.2164C598.5301,-10644.1678 931.5264,-10452.9427 1031.4361,-10395.4035"/>
<polygon fill="#000dff" stroke="#000dff" points="1033.4407,-10398.288 1040.3586,-10390.2634 1029.9464,-10392.2225 1033.4407,-10398.288"/>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M399.0839,-10605.2164C403.035,-10608.7433 580.5274,-10645.2632 585.7192,-10644.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge750" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2596.2213,-7789.2164C2630.9303,-7716.7706 2658.1154,-7706.8604 2682.1736,-7630.2164 2724.7715,-7494.5088 2660.2814,-7442.1379 2718.1736,-7312.2164 2730.9891,-7283.4559 2756.5373,-7257.3892 2775.11,-7241.0063"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2777.5146,-7243.5551 2782.8332,-7234.392 2772.9612,-7238.2384 2777.5146,-7243.5551"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M399.0839,-6234.2164C499.8082,-6059.3082 628.8751,-5997.7296 819.7932,-6063.2164 917.0508,-6096.5767 919.8961,-6143.8977 1002.4307,-6205.2164 1052.3702,-6242.3187 1086.7226,-6231.6439 1116.5955,-6286.2164 1196.7151,-6432.5811 1070.5314,-6890.933 1152.5955,-7036.2164 1155.6097,-7041.5527 1520.1697,-7284.1358 1740.2205,-7428.2164 1812.3162,-7475.4218 1827.5994,-7491.8981 1903.2231,-7533.2164 1975.2582,-7572.5739 2560.7543,-7863.2444 2596.2213,-7789.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge789" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M399.0839,-13741.2164C424.4089,-13768.0812 450.2545,-13734.7244 480.9653,-13755.2164 505.8892,-13771.847 490.7243,-13797.7531 516.9653,-13812.2164 635.0016,-13877.2742 721.4775,-13888.407 819.7932,-13796.2164 856.2502,-13762.0306 842.1035,-13622.2827 855.7932,-13574.2164 890.8657,-13451.0729 927.7361,-13430.2702 966.4307,-13308.2164 989.5519,-13235.2855 1103.4932,-12711.5943 1116.5955,-12636.2164 1138.6864,-12509.1259 1089.242,-12460.5833 1152.5955,-12348.2164 1199.441,-12265.1288 1276.5289,-12299.5833 1321.0291,-12215.2164 1375.6898,-12111.5862 1296.0746,-11789.2742 1357.0291,-11689.2164 1393.9477,-11628.6137 1838.0166,-11386.2123 1903.2231,-11358.2164 1976.1724,-11326.8962 2007.6995,-11352.4283 2075.5532,-11311.2164 2095.7149,-11298.9709 2090.8826,-11283.5817 2111.5532,-11272.2164 2142.0009,-11255.4754 2159.974,-11278.0996 2188.4692,-11258.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge795" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M267.689,-10080.9492C312.7269,-10085.8513 378.9975,-10090.0127 399.0839,-10075.2164"/>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M399.0839,-10075.2164C499.5041,-10001.2429 641.1961,-9954.1729 711.7259,-9933.8334"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="712.94,-9937.127 721.6022,-9931.0264 711.0262,-9930.3937 712.94,-9937.127"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge805" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M399.0839,-2622.2164C489.0212,-2477.3985 379.1388,-2357.5398 516.9653,-2257.2164 566.3762,-2221.2504 596.5538,-2237.7142 654.4731,-2257.2164 776.6885,-2298.3679 1047.9323,-2499.0587 1116.5955,-2608.2164 1159.1071,-2675.7995 1108.7374,-2717.4991 1152.5955,-2784.2164 1268.6001,-2960.6836 1365.6188,-2940.3863 1542.2007,-3056.2164 1684.0237,-3149.2461 1781.9682,-3109.5879 1867.2231,-3256.2164 1926.1229,-3357.517 1831.2604,-4217.7373 1903.2231,-4310.2164 1912.472,-4322.102 1927.0256,-4328.5757 1941.5577,-4332.0301"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1941.0658,-4335.4999 1951.5494,-4333.9686 1942.3991,-4328.628 1941.0658,-4335.4999"/>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M223.9543,-10063.8041C226.9644,-9762.2203 288.9559,-3581.2548 317.2024,-3210.2164 337.2312,-2947.1226 258.8562,-2845.7241 399.0839,-2622.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge819" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1236.8123,-6350.2164C1255.4116,-6383.2884 1289.4184,-6343.2291 1321.0291,-6364.2164 1345.9912,-6380.7895 1336.2313,-6399.6471 1357.0291,-6421.2164 1429.976,-6496.8693 1539.076,-6559.438 1592.0787,-6587.4298"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1590.5155,-6590.562 1600.9991,-6592.0932 1593.7586,-6584.3585 1590.5155,-6590.562"/>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M223.9495,-10064.1377C226.1603,-9841.0967 261.8664,-6320.2167 317.2024,-5871.2164 337.326,-5707.9319 330.3759,-5659.7022 399.0839,-5510.2164"/>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M399.0839,-5510.2164C485.8686,-5321.4014 650.518,-5185.6818 819.7932,-5306.2164 859.6373,-5334.5879 832.1494,-5367.3974 855.7932,-5410.2164 893.7925,-5479.033 925.1701,-5481.3041 966.4307,-5548.2164 1050.5827,-5684.6855 1076.2178,-5721.0551 1116.5955,-5876.2164 1141.8602,-5973.3024 1089.0093,-6248.6226 1152.5955,-6326.2164 1177.2643,-6356.3196 1212.8972,-6319.5109 1236.8123,-6350.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge824" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataairflownetwork.f90</title>
<path fill="none" stroke="#ff00c9" stroke-dasharray="5,2" d="M223.9588,-10064.0576C227.5248,-9727.6935 310.5855,-1899.2921 317.2024,-1872.2164 336.3543,-1793.8482 367.764,-1784.563 399.0839,-1710.2164"/>
<path fill="none" stroke="#ff00c9" stroke-dasharray="5,2" d="M399.0839,-1710.2164C413.8065,-1675.2681 455.4936,-1714.3114 480.9653,-1686.2164 538.6935,-1622.5428 462.5455,-1562.7396 516.9653,-1496.2164 558.7478,-1445.1412 607.3909,-1486.4517 654.4731,-1440.2164 683.4535,-1411.7573 662.8461,-1385.9909 690.4731,-1356.2164 746.8073,-1295.5034 779.0263,-1301.3039 855.7932,-1270.2164 903.3543,-1250.956 933.4492,-1276.5259 966.4307,-1237.2164 1055.8664,-1130.6207 929.7782,-1044.8882 1002.4307,-926.2164 1034.2572,-874.2303 1083.9608,-901.6989 1116.5955,-850.2164 1175.2843,-757.6323 1078.4118,-686.9194 1152.5955,-606.2164 1430.5735,-303.809 1775.4162,-277.7886 2075.5532,-558.2164 2123.1268,-602.6659 2086.0046,-640.3308 2111.5532,-700.2164 2174.0595,-846.73 2207.1491,-875.792 2301.3853,-1004.2164 2323.5866,-1034.4722 2352.4574,-1067.0388 2370.5692,-1086.7753"/>
<polygon fill="#ff00c9" stroke="#ff00c9" points="2368.0393,-1089.1946 2377.3971,-1094.1628 2373.1799,-1084.4434 2368.0393,-1089.1946"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge837" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M585.7192,-14918.2164C811.4936,-14854.4458 1327.7677,-14553.5397 1506.2007,-14401.2164 1601.3368,-14320.0013 1632.8093,-14303.916 1704.2205,-14201.2164 1802.4145,-14059.9991 1821.0615,-14015.9073 1867.2231,-13850.2164 1906.819,-13708.0922 1827.6787,-13646.945 1903.2231,-13520.2164 1950.8824,-13440.2662 2029.0726,-13481.8575 2075.5532,-13401.2164 2125.9821,-13313.7252 2084.8684,-13045.6109 2111.5532,-12948.2164 2152.6182,-12798.3369 2217.8339,-12782.1659 2265.3853,-12634.2164 2287.8084,-12564.45 2367.6877,-12038.8639 2384.6476,-11926.3687"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2388.1393,-11926.6848 2386.1674,-11916.2751 2381.2174,-11925.6425 2388.1393,-11926.6848"/>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M399.0839,-14918.2164C421.5652,-14953.0693 544.4421,-14922.2583 585.7192,-14918.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge847" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M399.0839,-10605.2164C431.7642,-10634.388 1092.2099,-10314.6078 1116.5955,-10278.2164 1175.8915,-10189.7268 1129.4586,-9424.1928 1152.5955,-9320.2164 1194.3161,-9132.725 1269.939,-9107.3742 1321.0291,-8922.2164 1351.9415,-8810.1852 1322.4113,-8774.1586 1357.0291,-8663.2164 1372.1323,-8614.8137 1401.785,-8562.9186 1418.7997,-8535.2751"/>
<polygon fill="#ff0078" stroke="#ff0078" points="1421.9177,-8536.8899 1424.2463,-8526.5541 1415.9805,-8533.1818 1421.9177,-8536.8899"/>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M225.9207,-10086.3898C239.1462,-10156.2249 313.6851,-10532.1056 399.0839,-10605.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge871" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1989.3882,-4716.2164C1993.7684,-4735.1143 2062.5576,-4715.8139 2075.5532,-4730.2164 2121.4093,-4781.0363 2079.6154,-5284.6737 2111.5532,-5345.2164 2151.8842,-5421.6695 2222.1203,-5389.3845 2265.3853,-5464.2164 2324.4369,-5566.3531 2261.3524,-5616.2372 2301.3853,-5727.2164 2318.2055,-5773.8455 2352.237,-5821.4652 2372.2156,-5847.0765"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2369.6877,-5849.5216 2378.645,-5855.18 2375.1714,-5845.1708 2369.6877,-5849.5216"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M399.0839,-2622.2164C508.6281,-2468.9309 658.762,-2576.4139 819.7932,-2674.2164 955.5365,-2756.6602 1021.7766,-2745.8091 1116.5955,-2873.2164 1147.0548,-2914.1443 1121.4918,-2941.776 1152.5955,-2982.2164 1207.1046,-3053.0881 1264.8783,-3022.6381 1321.0291,-3092.2164 1349.1246,-3127.0305 1333.0008,-3148.4801 1357.0291,-3186.2164 1400.846,-3255.0307 1835.0831,-3639.234 1867.2231,-3714.2164 1942.9308,-3890.8413 1846.4525,-4394.6269 1903.2231,-4578.2164 1924.5844,-4647.2962 1973.0888,-4645.7702 1989.3882,-4716.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge878" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M223.9857,-10064.1892C226.6685,-9861.7566 266.245,-6935.6904 317.2024,-6562.2164 337.5147,-6413.3442 320.989,-6362.5781 399.0839,-6234.2164"/>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M399.0839,-6234.2164C467.8807,-6121.1374 545.7824,-5982.7464 574.404,-5931.5291"/>
<polygon fill="#ff0028" stroke="#ff0028" points="577.6365,-5932.919 579.454,-5922.4812 571.5241,-5929.5074 577.6365,-5932.919"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.7129,-10086.465C230.4383,-10158.5633 264.062,-10556.2252 317.2024,-10664.2164 393.8977,-10820.0756 412.0118,-10948.2164 585.7192,-10948.2164 585.7192,-10948.2164 585.7192,-10948.2164 755.1332,-10948.2164 1073.1772,-10948.2164 1194.9765,-10802.2143 1321.0291,-10510.2164 1384.2582,-10363.7473 1273.7794,-9929.3068 1357.0291,-9793.2164 1396.9633,-9727.9348 1461.5399,-9769.3601 1506.2007,-9707.2164 1553.5584,-9641.32 1481.8349,-9582.4479 1542.2007,-9528.2164 1585.6142,-9489.2144 1751.9759,-9531.2025 1803.7218,-9504.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-9504.2164C1829.3867,-9488.354 1848.1808,-9503.6192 1867.2231,-9480.2164 1931.9712,-9400.6416 1830.8443,-9324.9195 1903.2231,-9252.2164 1930.5959,-9224.721 1966.68,-9269.6744 1989.3882,-9238.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M399.0839,-2622.2164C434.7721,-2566.7976 462.7677,-2674.6996 516.9653,-2712.2164 576.2336,-2753.2432 599.0091,-2752.1765 654.4731,-2798.2164 887.8112,-2991.9069 957.723,-3041.9099 1116.5955,-3300.2164 1140.4682,-3339.0305 1118.5847,-3365.8896 1152.5955,-3396.2164 1210.1794,-3447.5628 1269.4336,-3380.8554 1321.0291,-3438.2164 1398.4558,-3524.2951 1285.1959,-3605.4175 1357.0291,-3696.2164 1361.3727,-3701.7069 1366.8962,-3706.1595 1372.9668,-3709.7701"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1371.6816,-3713.0439 1382.1787,-3714.4804 1374.8685,-3706.8114 1371.6816,-3713.0439"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge18" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputreportpredefined.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.4422,-10086.475C229.0308,-10172.4298 258.9168,-10733.8003 281.2024,-11190.2164 288.1215,-11331.921 299.7723,-13639.8986 399.0839,-13741.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-13608.2164C612.9965,-13569.6716 633.4803,-13569.5135 654.4731,-13527.2164 668.7206,-13498.5102 1135.2191,-11301.144 1152.5955,-11274.2164 1165.4102,-11254.3577 1186.796,-11238.475 1204.8096,-11227.6244"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1206.9388,-11230.4372 1213.8588,-11222.4146 1203.4461,-11224.3708 1206.9388,-11230.4372"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-13741.2164C470.3832,-13813.9561 515.276,-13681.7856 585.7192,-13608.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge28" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M399.0839,-3762.2164C433.9706,-3668.6414 737.5537,-3863.5594 819.7932,-3920.2164 1122.8242,-4128.9824 1215.7515,-4226.6151 1321.0291,-4579.2164 1368.1321,-4736.9765 1339.9663,-10342.461 1357.0291,-10506.2164 1370.8537,-10638.8955 1410.8156,-10794.7045 1425.8255,-10850.2523"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1422.4727,-10851.2611 1428.4797,-10859.9885 1429.2263,-10849.42 1422.4727,-10851.2611"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchairloopplant.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2095.2164C632.6979,-2100.864 643.6452,-2083.0012 690.4731,-2076.2164 788.0939,-2062.0722 812.9781,-2042.2355 911.1119,-2052.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2052.2164C1001.4255,-2037.2958 1048.8068,-1976.7033 1116.5955,-2038.2164 1177.773,-2093.7304 1100.0356,-2344.4829 1152.5955,-2408.2164 1155.2488,-2411.4338 1158.2961,-2414.2491 1161.623,-2416.7115"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1160.0559,-2419.8573 1170.4033,-2422.1335 1163.7338,-2413.9013 1160.0559,-2419.8573"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-2076.2164C418.3684,-2039.256 544.7183,-2087.6742 585.7192,-2095.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge24" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-14918.2164C421.4696,-14948.1254 455.7768,-14909.6264 480.9653,-14937.2164 559.917,-15023.6955 443.3753,-15107.1312 516.9653,-15198.2164 520.5572,-15202.6622 525.0107,-15206.3175 529.912,-15209.3228"/>
<polygon fill="#ff0000" stroke="#ff0000" points="528.6346,-15212.6015 539.1285,-15214.0608 531.8351,-15206.3759 528.6346,-15212.6015"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge21" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.5989,-10086.4688C230.3512,-10172.3774 267.2626,-10733.4692 281.2024,-11190.2164 282.7879,-11242.1668 286.0783,-14890.5913 317.2024,-14932.2164 321.1159,-14937.4503 326.1005,-14941.6238 331.6729,-14944.9467"/>
<polygon fill="#00ffff" stroke="#00ffff" points="330.3303,-14948.1877 340.8438,-14949.4986 333.4425,-14941.9176 330.3303,-14948.1877"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge84" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-15852.2164C2833.0174,-15808.4177 2856.7338,-15805.4371 2876.0764,-15752.2164 2923.3862,-15622.0448 2905.232,-14644.5494 2912.0764,-14506.2164 2931.7705,-14108.178 2972.0971,-13623.0712 2981.1305,-13516.5447"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2984.6306,-13516.6912 2981.9908,-13506.4306 2977.6558,-13516.0979 2984.6306,-13516.6912"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.6055,-10086.4686C230.4067,-10172.3757 267.6138,-10733.4586 281.2024,-11190.2164 283.042,-11252.0521 284.3534,-15591.7951 317.2024,-15644.2164 360.3191,-15713.0233 415.3532,-15677.3782 480.9653,-15725.2164 589.0313,-15804.0077 584.9889,-15859.0008 690.4731,-15941.2164 839.8399,-16057.6345 870.1362,-16154.2164 1059.5131,-16154.2164 1059.5131,-16154.2164 1059.5131,-16154.2164 1236.8123,-16154.2164 1325.105,-16154.2164 2741.1613,-15920.5075 2797.125,-15852.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge138" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9046,-10064.1458C225.5734,-9777.5601 259.7958,-4021.3992 317.2024,-3863.2164 336.9161,-3808.8956 378.2393,-3816.1133 399.0839,-3762.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-3762.2164C541.6822,-3393.5069 1165.526,-3639.8115 1321.0291,-3786.2164 1372.206,-3834.399 1313.1282,-3885.3223 1357.0291,-3940.2164 1408.4508,-4004.5147 1499.8646,-4038.8724 1561.0106,-4055.5726"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1560.3663,-4059.0225 1570.9291,-4058.1996 1562.1586,-4052.2559 1560.3663,-4059.0225"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge169" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M399.0839,-4182.2164C415.4977,-4143.6567 1190.4282,-4024.3454 1236.8123,-4066.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge179" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataruntimelanguage.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-4182.2164C434.5248,-4098.9577 457.0771,-4084.0504 516.9653,-4016.2164 531.5653,-3999.6793 550.1012,-3982.8984 564.2471,-3970.8182"/>
<polygon fill="#0000ff" stroke="#0000ff" points="566.61,-3973.4041 572.0057,-3964.2861 562.1017,-3968.0492 566.61,-3973.4041"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M223.9142,-10064.1292C225.6294,-9808.2334 257.2756,-5202.9239 317.2024,-4616.2164 337.148,-4420.9405 322.2033,-4362.8261 399.0839,-4182.2164"/>
</g>
<!-- sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node54" class="node">
<title>sourcefile~sortandstringutilities.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node54"><a xlink:href="../sourcefile/sortandstringutilities.f90.html" xlink:title="SortAndStringUtilities.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.3044,-5902.2218 334.8633,-5902.2218 334.8633,-5880.2109 463.3044,-5880.2109 463.3044,-5902.2218"/>
<text text-anchor="middle" x="399.0839" y="-5888.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SortAndStringUtilities.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge145" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sortandstringutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9023,-10063.8898C225.2072,-9828.4354 247.4888,-6000.0152 317.2024,-5912.2164 319.7476,-5909.0108 322.7102,-5906.2545 325.9689,-5903.8876"/>
<polygon fill="#ff0000" stroke="#ff0000" points="327.788,-5906.8781 334.6102,-5898.772 324.222,-5900.8544 327.788,-5906.8781"/>
</g>
<!-- sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node55" class="node">
<title>sourcefile~dataoutputs.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node55"><a xlink:href="../sourcefile/dataoutputs.f90.html" xlink:title="DataOutputs.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="443.5485,-5943.2218 354.6193,-5943.2218 354.6193,-5921.2109 443.5485,-5921.2109 443.5485,-5943.2218"/>
<text text-anchor="middle" x="399.0839" y="-5929.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataOutputs.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge146" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataoutputs.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M223.937,-10064.1033C225.8102,-9850.6665 255.0514,-6629.7601 317.2024,-6220.2164 332.7952,-6117.4678 373.973,-5999.5525 391.2638,-5952.8267"/>
<polygon fill="#7fff00" stroke="#7fff00" points="394.6228,-5953.8368 394.8462,-5943.2443 388.066,-5951.3855 394.6228,-5953.8368"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge156" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.9137,-10064.1248C225.8184,-9777.0157 264.7144,-4011.5143 317.2024,-3947.2164 374.6927,-3876.7905 426.5873,-3913.0519 516.9653,-3903.2164 577.7212,-3896.6045 599.1028,-3877.3491 654.4731,-3903.2164 817.6274,-3979.4368 1153.7532,-4474.5205 1223.8347,-4579.6239"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1220.9884,-4581.6645 1229.441,-4588.0524 1226.8168,-4577.7877 1220.9884,-4581.6645"/>
</g>
<!-- sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node57" class="node">
<title>sourcefile~dataglobalconstants.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node57"><a xlink:href="../sourcefile/dataglobalconstants.f90.html" xlink:title="DataGlobalConstants.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="819.9536,-10124.2218 690.3127,-10124.2218 690.3127,-10102.2109 819.9536,-10102.2109 819.9536,-10124.2218"/>
<text text-anchor="middle" x="755.1332" y="-10110.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataGlobalConstants.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge161" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M267.9006,-10082.694C283.4409,-10085.1002 301.0604,-10087.5675 317.2024,-10089.2164 444.3511,-10102.2046 593.0355,-10108.4786 680.3514,-10111.2592"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="680.3249,-10114.76 690.4291,-10111.5733 680.5431,-10107.7634 680.3249,-10114.76"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge147" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataroomair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6234.2164C413.6714,-6210.2394 404.6994,-6145.3473 966.4307,-6372.2164 990.5115,-6381.942 1016.0204,-6396.8294 1034.2327,-6408.3524"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1032.7425,-6411.5556 1043.0452,-6414.0263 1036.5319,-6405.67 1032.7425,-6411.5556"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge233" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-10605.2164C427.4631,-10629.5122 451.6267,-10601.0882 480.9653,-10624.2164 509.0619,-10646.3655 486.5315,-10677.4072 516.9653,-10696.2164 568.9525,-10728.3462 595.8343,-10713.4349 654.4731,-10696.2164 683.7553,-10687.6181 1101.2686,-10425.607 1116.5955,-10399.2164 1192.8149,-10267.9773 1093.9147,-9857.1794 1152.5955,-9717.2164 1195.4624,-9614.9718 1264.5633,-9628.6268 1321.0291,-9533.2164 1398.8453,-9401.7298 1446.5213,-9001.3363 1542.2007,-8882.2164 1647.9808,-8750.5212 1754.9885,-8811.456 1867.2231,-8685.2164 1892.8603,-8656.3801 1872.5565,-8629.6332 1903.2231,-8606.2164 1934.059,-8582.6703 1969.5119,-8625.536 1989.3882,-8592.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge206" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-7946.2164C2025.467,-7960.4848 2038.8691,-7947.5854 2075.5532,-7960.2164 2107.8915,-7971.351 2141.8889,-7991.308 2164.0228,-8005.5732"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2162.1791,-8008.5495 2172.4605,-8011.1073 2166.0182,-8002.6962 2162.1791,-8008.5495"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-6576.2164C483.9643,-6408.571 567.2246,-6348.2164 755.1332,-6348.2164 755.1332,-6348.2164 755.1332,-6348.2164 911.1119,-6348.2164 1005.8865,-6348.2164 1057.7496,-6330.9238 1116.5955,-6405.2164 1179.3558,-6484.4511 1098.1223,-7229.0713 1152.5955,-7314.2164 1197.8928,-7385.019 1248.7908,-7357.2455 1321.0291,-7400.2164 1406.7967,-7451.2352 1429.7056,-7463.1264 1506.2007,-7527.2164 1681.5834,-7674.1577 1708.3098,-7729.6034 1867.2231,-7894.2164 1883.3813,-7910.954 1882.6606,-7921.3344 1903.2231,-7932.2164 1937.5149,-7950.3641 1953.3094,-7931.9479 1989.3882,-7946.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.8647,-10064.02C224.3468,-9855.496 232.8409,-6802.2842 317.2024,-6638.2164 338.0759,-6597.6212 377.2365,-6616.2958 399.0839,-6576.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge212" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datawater.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-2622.2164C459.4947,-2525.6253 549.1158,-2600.8675 654.4731,-2644.2164 673.7339,-2652.1411 673.4383,-2662.2334 690.4731,-2674.2164 745.0001,-2712.5726 763.3181,-2714.7912 819.7932,-2750.2164 886.1973,-2791.8697 905.659,-2798.7057 966.4307,-2848.2164 1039.0794,-2907.4033 1065.5784,-2917.6149 1116.5955,-2996.2164 1141.4043,-3034.439 1130.5409,-3052.341 1152.5955,-3092.2164 1225.102,-3223.3105 1258.9439,-3246.9813 1357.0291,-3360.2164 1419.0016,-3431.7611 1452.0397,-3434.5901 1506.2007,-3512.2164 1527.5872,-3542.8686 1517.0985,-3560.5249 1542.2007,-3588.2164 1655.3403,-3713.0267 1783.4282,-3637.0774 1867.2231,-3783.2164 1913.0993,-3863.2246 1870.857,-7016.8545 1903.2231,-7103.2164 1916.0766,-7137.5128 1946.1727,-7168.1473 1967.153,-7186.4515"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1965.0718,-7189.2756 1974.9644,-7193.0687 1969.5965,-7183.9344 1965.0718,-7189.2756"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge280" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2387.8271,-2322.2164C2435.5964,-2325.1965 2489.6442,-2325.3636 2530.7256,-2324.8293"/>
<polygon fill="#ffff00" stroke="#ffff00" points="2530.9317,-2328.3267 2540.879,-2324.6796 2530.8284,-2321.3275 2530.9317,-2328.3267"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M223.9535,-10064.0657C227.321,-9731.8345 304.9432,-2086.5197 317.2024,-2062.2164 358.3187,-1980.7048 431.6969,-2015.0753 480.9653,-1938.2164 521.0032,-1875.7571 468.2408,-1831.1638 516.9653,-1775.2164 559.7741,-1726.0617 597.9135,-1756.6166 654.4731,-1724.2164 809.8581,-1635.2042 859.6417,-1612.9653 966.4307,-1469.2164 991.3852,-1435.625 975.8618,-1414.546 1002.4307,-1382.2164 1041.1318,-1335.1239 1080.6922,-1355.4752 1116.5955,-1306.2164 1151.152,-1258.8052 1106.9412,-1216.0629 1152.5955,-1179.2164 1399.7944,-979.7078 1632.1144,-952.5932 1867.2231,-1166.2164 1916.5916,-1211.0732 1878.2509,-1402.3636 1903.2231,-1464.2164 1950.7772,-1582.0012 2031.1537,-1573.2066 2075.5532,-1692.2164 2117.3588,-1804.2732 2034.7073,-2137.5695 2111.5532,-2229.2164 2134.1779,-2256.1986 2158.0553,-2230.4707 2188.4692,-2248.2164"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M2188.4692,-2248.2164C2218.0617,-2266.4265 2234.609,-2246.0873 2265.3853,-2262.2164 2285.4271,-2272.7198 2281.8406,-2286.8144 2301.3853,-2298.2164 2335.825,-2318.3079 2348.0326,-2319.7338 2387.8271,-2322.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataconvergparams.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge283" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataconvergparams.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M223.9652,-10064.1192C226.2265,-9862.5308 258.782,-6954.3077 281.2024,-4611.2164 281.7562,-4553.3419 282.5664,-490.5857 317.2024,-444.2164 319.8542,-440.6663 322.9988,-437.604 326.4855,-434.9641"/>
<polygon fill="#00ff00" stroke="#00ff00" points="328.5431,-437.8056 335.171,-429.5399 324.8351,-431.8683 328.5431,-437.8056"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge288" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.9574,-10064.0035C227.5219,-9722.0126 311.4909,-1671.3299 317.2024,-1658.2164 366.1297,-1545.8799 419.9438,-1543.0508 516.9653,-1468.2164 573.8565,-1424.3352 609.5647,-1439.3001 654.4731,-1383.2164 685.0462,-1345.0354 654.8761,-1312.7625 690.4731,-1279.2164 714.9216,-1256.1765 803.115,-1236.5558 860.3218,-1225.8681"/>
<polygon fill="#00ffff" stroke="#00ffff" points="861.0674,-1229.2898 870.2705,-1224.0408 859.8027,-1222.405 861.0674,-1229.2898"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge618" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M224.6091,-10086.4685C230.4375,-10172.3748 267.8084,-10733.4529 281.2024,-11190.2164 283.2294,-11259.3412 289.7106,-16105.7612 317.2024,-16169.2164 360.2939,-16268.678 599.3927,-16424.4471 690.4731,-16483.2164 746.3021,-16519.2398 773.4311,-16510.6232 819.7932,-16558.2164 843.1084,-16582.1506 839.0238,-16595.316 855.7932,-16624.2164 918.1481,-16731.679 898.5503,-16794.0606 1002.4307,-16862.2164 1598.2065,-17253.1042 1952.7846,-16994.3722 2596.2213,-16688.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~faultsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge292" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~faultsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.5994,-10086.4688C230.3553,-10172.3773 267.2887,-10733.4684 281.2024,-11190.2164 306.8276,-12031.4197 253.2267,-14138.0579 317.2024,-14977.2164 336.6578,-15232.4097 275.6495,-15323.0153 399.0839,-15547.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-15547.2164C416.7793,-15579.3577 1022.8558,-15548.778 1059.5131,-15547.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge295" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datadefineequip.f90</title>
<path fill="none" stroke="#ffaa00" stroke-dasharray="5,2" d="M224.6106,-10086.4685C230.4499,-10172.3745 267.8865,-10733.4506 281.2024,-11190.2164 283.3175,-11262.7706 273.8155,-16358.0256 317.2024,-16416.2164 322.1374,-16422.8352 328.7858,-16427.7588 336.1718,-16431.4111"/>
<polygon fill="#ffaa00" stroke="#ffaa00" points="335.2685,-16434.824 345.8482,-16435.3894 337.9303,-16428.3498 335.2685,-16434.824"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge330" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M911.1119,-1370.2164C935.7236,-1349.8027 949.9113,-1351.5945 966.4307,-1324.2164 1006.3298,-1258.0899 950.9805,-1211.8143 1002.4307,-1154.2164 1038.0561,-1114.334 1083.0151,-1157.8352 1116.5955,-1116.2164 1209.5176,-1001.0506 1067.3709,-906.1893 1152.5955,-785.2164 1208.0158,-706.5494 1448.4156,-617.7635 1542.2007,-596.2164 1660.3232,-569.0777 2000.0136,-615.4367 2075.5532,-710.2164 2144.0171,-796.1181 2039.4371,-1120.3569 2111.5532,-1203.2164 2157.46,-1255.962 2203.494,-1203.6738 2265.3853,-1236.2164 2284.8645,-1246.4586 2281.9574,-1259.8768 2301.3853,-1270.2164 2384.5663,-1314.4856 2624.2039,-1341.2491 2718.1736,-1348.2164 2788.1605,-1353.4055 2806.0462,-1352.7836 2876.0764,-1348.2164 2923.8813,-1345.0987 2938.7684,-1315.7025 2982.9529,-1334.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M399.0839,-1924.2164C410.9568,-1888.2001 456.1373,-1928.8818 480.9653,-1900.2164 555.0362,-1814.6974 452.7205,-1741.3431 516.9653,-1648.2164 556.6171,-1590.7388 606.401,-1622.8622 654.4731,-1572.2164 679.6522,-1545.6892 666.6344,-1525.9543 690.4731,-1498.2164 748.6461,-1430.5283 774.5108,-1421.0802 855.7932,-1384.2164 878.8901,-1373.7413 891.6384,-1386.4636 911.1119,-1370.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M223.9556,-10064.1247C227.4235,-9729.7874 308.2285,-1948.7319 317.2024,-1938.2164 341.1689,-1910.1328 387.8901,-1959.3984 399.0839,-1924.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge358" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.6063,-10086.4686C230.4137,-10172.3755 267.6579,-10733.4573 281.2024,-11190.2164 283.0809,-11253.5655 287.7123,-15697.1185 317.2024,-15753.2164 607.054,-16304.5893 932.7691,-16305.3009 1542.2007,-16434.2164 1683.6782,-16464.1437 1727.2852,-16455.6704 1867.2231,-16419.2164 2104.6014,-16357.379 2690.4816,-16131.6123 2876.0764,-15971.2164 2898.7464,-15951.6243 2888.5349,-15932.7521 2912.0764,-15914.2164 2938.2065,-15893.6424 2964.6483,-15917.9835 2982.9529,-15890.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge449" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M911.1119,-1370.2164C936.018,-1350.1629 947.8144,-1350.2142 966.4307,-1324.2164 992.4764,-1287.8433 974.4886,-1265.1538 1002.4307,-1230.2164 1040.5022,-1182.6135 1084.4059,-1205.9784 1116.5955,-1154.2164 1182.156,-1048.7926 1061.5608,-961.6263 1152.5955,-877.2164 1332.4577,-710.443 1474.9022,-807.1709 1704.2205,-894.2164 1889.3023,-964.4704 1973.3623,-970.6642 2075.5532,-1140.2164 2159.014,-1278.6921 2023.1739,-1366.8268 2111.5532,-1502.2164 2131.4568,-1532.707 3240.6,-2104.0431 3259.4165,-2135.2164 3318.6526,-2233.353 3269.4293,-4086.5724 3295.4165,-4198.2164 3305.9179,-4243.3316 3332.2836,-4291.2066 3348.1556,-4317.3332"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3345.2387,-4319.2708 3353.4796,-4325.9294 3351.1898,-4315.585 3345.2387,-4319.2708"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge512" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M585.7192,-14918.2164C1029.833,-14874.7278 1150.7807,-14787.0403 1506.2007,-14517.2164 1610.4545,-14438.0701 1624.6476,-14403.145 1704.2205,-14299.2164 1890.295,-14056.188 1952.1329,-13999.3127 2075.5532,-13719.2164 2100.5922,-13662.3916 2074.515,-13634.0578 2111.5532,-13584.2164 2159.4827,-13519.719 2222.4099,-13557.1153 2265.3853,-13489.2164 2342.6355,-13367.1648 2254.6207,-13302.8812 2301.3853,-13166.2164 2349.1037,-13026.764 2432.4856,-13024.5605 2474.269,-12883.2164 2559.9753,-12593.291 2436.2655,-11816.3473 2510.269,-11523.2164 2525.0151,-11464.8067 2562.2938,-11403.4485 2582.5731,-11372.9107"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2585.5833,-11374.7069 2588.2771,-11364.4603 2579.7813,-11370.7906 2585.5833,-11374.7069"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge539" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M399.0839,-15547.2164C417.394,-15580.426 450.1146,-15549.1625 480.9653,-15571.2164 503.5362,-15587.3513 498.889,-15601.1682 516.9653,-15622.2164 586.698,-15703.4134 594.9082,-15741.0196 690.4731,-15789.2164 1158.4446,-16025.231 1389.7212,-16082.2999 1867.2231,-15866.2164 1923.6245,-15840.6931 2656.8899,-15162.7255 2682.1736,-15106.2164 2720.7996,-15019.8869 2712.1514,-13498.6011 2718.1736,-13404.2164 2736.3799,-13118.8743 2782.1079,-12773.8758 2794.17,-12685.591"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2797.6643,-12685.8712 2795.557,-12675.488 2790.7293,-12684.9191 2797.6643,-12685.8712"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge551" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M399.0839,-15547.2164C417.0919,-15580.5907 444.8279,-15559.7174 480.9653,-15571.2164 574.7897,-15601.0713 594.1305,-15622.9081 690.4731,-15643.2164 965.2454,-15701.1361 1050.4088,-15678.1775 1321.0291,-15603.2164 1508.1869,-15551.3741 1598.0052,-15555.8018 1704.2205,-15393.2164 1746.4599,-15328.5598 1689.9098,-15281.8123 1740.2205,-15223.2164 1748.889,-15213.1203 2175.1726,-15053.694 2188.4692,-15054.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge577" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M399.0839,-5053.2164C404.5728,-5046.4391 536.9965,-5075.0596 654.4731,-5115.2164 730.4755,-5141.1961 756.821,-5138.3585 819.7932,-5188.2164 908.6854,-5258.5962 1079.8491,-5495.9557 1116.5955,-5603.2164 1157.5859,-5722.8652 1083.0142,-6065.6015 1152.5955,-6171.2164 1267.2824,-6345.2957 1800.3549,-6507.3352 1989.3882,-6595.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1989.3882,-6595.2164C2023.1777,-6614.2831 2048.718,-6581.1961 2075.5532,-6609.2164 2169.6585,-6707.4773 2024.6235,-6808.5539 2111.5532,-6913.2164 2134.4336,-6940.7641 2158.8378,-6917.1075 2188.4692,-6937.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge435" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-1924.2164C411.3539,-1888.3334 455.2905,-1928.1259 480.9653,-1900.2164 535.0206,-1841.4563 469.6806,-1788.5504 516.9653,-1724.2164 558.3195,-1667.9513 597.4736,-1688.5523 654.4731,-1648.2164 703.3396,-1613.6359 809.6588,-1507.3655 855.7932,-1469.2164 903.5801,-1429.7008 927.7274,-1432.6635 966.4307,-1384.2164 990.2616,-1354.3858 977.603,-1335.2226 1002.4307,-1306.2164 1042.0674,-1259.9087 1084.1354,-1281.8092 1116.5955,-1230.2164 1177.7815,-1132.9659 1065.8783,-1049.5922 1152.5955,-974.2164 1396.8015,-761.949 1619.2785,-905.3281 1867.2231,-1113.2164 1974.6904,-1203.3219 2018.4328,-1222.1325 2075.5532,-1350.2164 2130.9678,-1474.4751 2037.306,-1540.206 2111.5532,-1654.2164 2154.9029,-1720.782 2201.5761,-1697.9028 2265.3853,-1745.2164 2571.0284,-1971.8467 2641.2499,-2045.8245 2876.0764,-2345.2164 2962.0132,-2454.7815 3009.9425,-2471.0665 3053.8293,-2603.2164 3087.0165,-2703.148 3080.3887,-3445.3422 3089.8293,-3550.2164 3110.1588,-3776.052 3157.0754,-4047.2266 3170.7915,-4124.0304"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3167.3555,-4124.6989 3172.5672,-4133.9232 3174.2454,-4123.4621 3167.3555,-4124.6989"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge408" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-2894.2164C2212.4568,-2919.3544 2239.041,-2885.5602 2265.3853,-2908.2164 2302.789,-2940.3837 2268.7789,-2976.1947 2301.3853,-3013.2164 2357.9762,-3077.4704 2424.246,-3028.7267 2474.269,-3098.2164 2544.2252,-3195.3962 2459.1182,-3256.9511 2510.269,-3365.2164 2558.2158,-3466.6997 2634.6521,-3448.5332 2682.1736,-3550.2164 2736.2294,-3665.8814 2638.3898,-3735.5419 2718.1736,-3835.2164 2764.7988,-3893.4656 2830.37,-3833.2435 2876.0764,-3892.2164 2946.74,-3983.3902 2977.5498,-4853.1167 2982.2944,-5000.9182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.7979,-5001.089 2982.6124,-5010.9734 2985.7944,-5000.8677 2978.7979,-5001.089"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M911.1119,-2052.2164C1011.9237,-2043.5839 1057.6398,-2067.9864 1116.5955,-2150.2164 1195.6145,-2260.4303 1060.3753,-2353.7853 1152.5955,-2453.2164 1204.4692,-2509.1462 1246.5245,-2469.8423 1321.0291,-2486.2164 1658.1548,-2560.3072 1833.9978,-2423.6515 2075.5532,-2670.2164 2127.1689,-2722.9025 2072.6555,-2769.5509 2111.5532,-2832.2164 2134.7095,-2869.5219 2156.8802,-2863.7197 2188.4692,-2894.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge372" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-2095.2164C755.5319,-2111.0006 806.1196,-2085.0285 966.4307,-2143.2164 1036.743,-2168.7375 1073.2464,-2158.2572 1116.5955,-2219.2164 1185.9882,-2316.7993 1071.7266,-2397.91 1152.5955,-2486.2164 1204.4238,-2542.8113 1247.9681,-2500.7376 1321.0291,-2524.2164 1573.1294,-2605.2309 1635.5355,-2634.0026 1867.2231,-2762.2164 1904.4289,-2782.8057 2164.1663,-2935.3229 2188.4692,-2970.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge460" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataphotovoltaics.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M224.6051,-10086.4686C230.4037,-10172.3758 267.595,-10733.4592 281.2024,-11190.2164 283.026,-11251.4274 280.5667,-15550.1457 317.2024,-15599.2164 321.3247,-15604.7378 326.6392,-15609.0794 332.5789,-15612.4873"/>
<polygon fill="#ff0000" stroke="#ff0000" points="331.1321,-15615.675 341.6626,-15616.8409 334.1575,-15609.3626 331.1321,-15615.675"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge480" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.5835,-10086.4693C230.2213,-10172.3815 266.4417,-10733.495 281.2024,-11190.2164 287.8959,-11397.3229 274.9186,-14752.3222 399.0839,-14918.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M399.0839,-14918.2164C449.0577,-14984.9852 457.4371,-14830.6274 516.9653,-14772.2164 576.5739,-14713.7264 1661.7468,-13922.1208 1704.2205,-13850.2164 1756.3964,-13761.8868 1672.7036,-13699.4557 1740.2205,-13622.2164 1778.9964,-13577.8568 1826.3828,-13626.683 1867.2231,-13584.2164 1911.7569,-13537.9092 1867.1817,-13497.4011 1903.2231,-13444.2164 1916.7409,-13424.2688 1938.7568,-13408.3315 1957.1502,-13397.477"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1959.121,-13400.3835 1966.1043,-13392.4158 1955.6764,-13394.2896 1959.121,-13400.3835"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge465" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-15184.2164C612.0656,-15201.8495 626.7398,-15187.8567 654.4731,-15203.2164 673.4607,-15213.7323 671.954,-15224.8959 690.4731,-15236.2164 716.6272,-15252.204 730.7018,-15241.703 755.1332,-15260.2164"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge688" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~datacomplexfenestration.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M223.9462,-10063.8756C226.1596,-9827.9948 262.9696,-5986.4551 317.2024,-5496.2164 333.6478,-5347.558 377.8134,-5172.3682 393.4787,-5113.0424"/>
<polygon fill="#ff0000" stroke="#ff0000" points="396.8697,-5113.9097 396.059,-5103.3459 390.1051,-5112.1095 396.8697,-5113.9097"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge690" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~dataequivalentlayerwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M223.9234,-10063.8928C225.7525,-9816.1014 257.838,-5579.2188 317.2024,-5039.2164 333.5073,-4890.9003 377.7618,-4716.1604 393.4645,-4656.9883"/>
<polygon fill="#00ffff" stroke="#00ffff" points="396.8485,-4657.8817 396.0511,-4647.3169 390.0862,-4656.0731 396.8485,-4657.8817"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node87" class="node">
<title>sourcefile~databranchnodeconnections.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node87"><a xlink:href="../sourcefile/databranchnodeconnections.f90.html" xlink:title="DataBranchNodeConnections.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1321.2464,-11338.2218 1152.3781,-11338.2218 1152.3781,-11316.2109 1321.2464,-11316.2109 1321.2464,-11338.2218"/>
<text text-anchor="middle" x="1236.8123" y="-11324.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataBranchNodeConnections.f90</text>
</a>
</g>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge709" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~databranchnodeconnections.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-13608.2164C722.8275,-13465.0238 933.6511,-13209.3405 966.4307,-13128.2164 975.7224,-13105.2209 1136.7445,-11371.2919 1152.5955,-11352.2164 1155.2608,-11349.0089 1158.3175,-11346.2014 1161.6516,-11343.745"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1163.7627,-11346.5556 1170.4458,-11338.3345 1160.0946,-11340.5935 1163.7627,-11346.5556"/>
</g>
<!-- sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge761" class="edge">
<title>sourcefile~dataglobals.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-13741.2164C404.786,-13747.0337 682.3402,-13773.7573 690.4731,-13774.2164 747.8574,-13777.4554 777.4034,-13813.0306 819.7932,-13774.2164 886.9222,-13712.7497 822.6039,-13450.9684 855.7932,-13366.2164 885.0947,-13291.3923 934.76,-13297.0688 966.4307,-13223.2164 977.3065,-13197.8551 1112.7562,-12268.5429 1116.5955,-12241.2164 1134.113,-12116.5313 1126.9614,-12083.489 1152.5955,-11960.2164 1207.2449,-11697.4108 1275.0051,-11644.6688 1321.0291,-11380.2164 1343.1706,-11252.9918 1291.0728,-10911.2394 1357.0291,-10800.2164 1450.0891,-10643.5702 1583.2249,-10718.4451 1704.2205,-10582.2164 1729.0404,-10554.2716 1710.9876,-10529.5054 1740.2205,-10506.2164 1762.8247,-10488.2082 1775.2918,-10497.4104 1803.7218,-10492.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge916" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1625.0082,-6591.7949C1635.2887,-6525.8551 1686.786,-6187.0681 1704.2205,-5908.2164 1718.3305,-5682.5371 1694.1333,-2059.5898 1740.2205,-1838.2164 1769.6476,-1696.8671 1827.582,-1678.0477 1867.2231,-1539.2164 1895.7517,-1439.3036 1880.6327,-1409.6369 1903.2231,-1308.2164 1962.7083,-1041.1555 2002.7182,-980.9493 2075.5532,-717.2164 2092.4268,-656.1176 2067.1356,-624.4364 2111.5532,-579.2164 2211.7555,-477.2038 3219.0776,-251.5376 3360.8456,-270.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge49" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1629.8097,-6614.3404C1645.618,-6641.5661 1685.7125,-6714.1568 1704.2205,-6780.2164 1741.1639,-6912.0768 1688.0318,-6959.6133 1740.2205,-7086.2164 1775.0877,-7170.8 1831.8043,-7163.8623 1867.2231,-7248.2164 1914.9441,-7361.8693 1856.4989,-7409.1501 1903.2231,-7523.2164 2004.389,-7770.1892 2177.2601,-7750.2956 2265.3853,-8002.2164 2316.9123,-8149.5153 2276.9561,-9252.0891 2301.3853,-9406.2164 2317.9147,-9510.5031 2361.5155,-9629.7889 2379.6913,-9676.7239"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2376.4539,-9678.0557 2383.3562,-9686.0937 2382.973,-9675.5058 2376.4539,-9678.0557"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge72" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1803.7218,-7908.2164C1807.9877,-7936.8004 1848.6172,-7900.1016 1867.2231,-7922.2164 1924.3639,-7990.1333 1883.9208,-8633.5838 1903.2231,-8720.2164 1955.7565,-8955.9958 1999.9447,-9007.9847 2111.5532,-9222.2164 2184.1079,-9361.4845 2200.1785,-9400.1456 2301.3853,-9520.2164 2368.2783,-9599.5777 2431.2495,-9582.7589 2474.269,-9677.2164 2552.3923,-9848.7508 2464.6105,-11190.3432 2510.269,-11373.2164 2524.862,-11431.6645 2562.2054,-11493.0064 2582.5348,-11523.5317"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2579.749,-11525.66 2588.2537,-11531.9783 2585.5455,-11521.7355 2579.749,-11525.66"/>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1630.138,-6614.2552C1646.6753,-6641.2917 1688.2658,-6713.4941 1704.2205,-6780.2164 1750.5123,-6973.8084 1709.8572,-7478.4961 1740.2205,-7675.2164 1756.5931,-7781.2928 1788.2712,-7802.0017 1803.7218,-7908.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge101" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1803.7218,-6768.2164C1821.9735,-6790.6244 1840.9154,-6770.252 1867.2231,-6782.2164 2085.6682,-6881.5616 2076.7043,-7018.9182 2301.3853,-7103.2164 2424.4783,-7149.3997 2464.7496,-7127.2164 2596.2213,-7127.2164 2596.2213,-7127.2164 2596.2213,-7127.2164 2797.125,-7127.2164 2933.2265,-7127.2164 2959.5089,-7177.9711 3089.8293,-7217.2164 3101.7696,-7220.8121 3114.672,-7224.6437 3126.7231,-7228.1992"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3126.0244,-7231.642 3136.6059,-7231.1097 3128.002,-7224.9272 3126.0244,-7231.642"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1679.1573,-6614.3705C1688.1303,-6617.8187 1696.8691,-6622.3262 1704.2205,-6628.2164 1729.3876,-6648.3811 1721.8948,-6664.6801 1740.2205,-6691.2164 1765.4274,-6727.717 1775.8277,-6733.7257 1803.7218,-6768.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge113" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M1625.0257,-6592.0106C1635.1898,-6528.7014 1685.2653,-6209.2902 1704.2205,-5946.2164 1731.3761,-5569.3309 1695.7318,-4621.4507 1740.2205,-4246.2164 1752.3924,-4143.5539 1784.2824,-4023.7605 1797.6686,-3976.2078"/>
<polygon fill="#ffa100" stroke="#ffa100" points="1801.0738,-3977.0287 1800.4418,-3966.4527 1794.3406,-3975.1145 1801.0738,-3977.0287"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge260" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1629.927,-6614.3084C1645.9959,-6641.463 1686.625,-6713.9079 1704.2205,-6780.2164 1750.115,-6953.1697 1708.5715,-7005.0985 1740.2205,-7181.2164 1759.2044,-7286.8568 1779.5431,-7309.6426 1803.7218,-7414.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1803.7218,-7414.2164C1810.2322,-7442.3741 1848.2101,-7406.4506 1867.2231,-7428.2164 1931.3268,-7501.6009 1885.667,-7769.3709 1903.2231,-7865.2164 1953.1349,-8137.7036 2023.8703,-8192.0595 2075.5532,-8464.2164 2106.9558,-8629.5788 2040.5912,-8688.5885 2111.5532,-8841.2164 2152.739,-8929.8002 2216.0023,-8913.9271 2265.3853,-8998.2164 2294.1789,-9047.3628 2275.2596,-9070.6012 2301.3853,-9121.2164 2358.2632,-9231.41 2429.1261,-9224.7181 2474.269,-9340.2164 2550.0508,-9534.104 2419.5988,-9619.8285 2510.269,-9807.2164 2555.5984,-9900.8983 2638.634,-9871.6894 2682.1736,-9966.2164 2725.2041,-10059.6382 2655.3312,-10809.7909 2718.1736,-10891.2164 2740.5811,-10920.25 2790.2946,-10879.1831 2797.125,-10915.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge647" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M1625.0069,-6591.7948C1635.2804,-6525.8546 1686.7453,-6187.0656 1704.2205,-5908.2164 1711.0661,-5798.9817 1698.4638,-2069.3869 1740.2205,-1968.2164 1771.0369,-1893.5523 1823.267,-1905.9824 1867.2231,-1838.2164 1869.3612,-1834.9202 2074.6752,-1316.0459 2075.5532,-1312.2164 2087.7032,-1259.2218 2075.5626,-864.9684 2111.5532,-824.2164 2168.5108,-759.7235 2215.7611,-794.7022 2301.3853,-786.2164 2469.8018,-769.5254 2516.9091,-751.7423 2682.1736,-788.2164 2791.6856,-812.3858 2805.9207,-856.0499 2912.0764,-892.2164 3025.5674,-930.882 3057.0806,-930.5721 3174.6229,-954.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge669" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1625.0088,-6591.795C1635.2927,-6525.8554 1686.8056,-6187.0693 1704.2205,-5908.2164 1732.8657,-5449.537 1681.8708,-2228.0701 1740.2205,-1772.2164 1751.4576,-1684.4268 1782.5472,-1583.2253 1796.6282,-1540.2556"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1799.9948,-1541.2227 1799.8192,-1530.6293 1793.3504,-1539.0201 1799.9948,-1541.2227"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge679" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M1626.5337,-6592.1032C1655.1803,-6496.4046 1860.3951,-5812.9045 1903.2231,-5728.2164 1962.1594,-5611.676 2005.1297,-5600.1967 2075.5532,-5490.2164 2093.152,-5462.7324 2093.6239,-5453.4859 2111.5532,-5426.2164 2131.0664,-5396.5378 2156.4921,-5364.2012 2172.6539,-5344.3138"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2175.5455,-5346.3069 2179.1711,-5336.3517 2170.1287,-5341.8731 2175.5455,-5346.3069"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge751" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1803.7218,-6768.2164C1828.8296,-6798.6373 1850.3961,-6794.5416 1867.2231,-6830.2164 1907.8468,-6916.342 1833.1171,-7192.7722 1903.2231,-7257.2164 2130.6128,-7466.2417 2288.5737,-7232.6127 2596.2213,-7205.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge790" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1630.0124,-6614.3331C1647.5203,-6642.7855 1695.8786,-6720.3572 1740.2205,-6782.2164 1793.5216,-6856.5743 1833.1973,-6859.2908 1867.2231,-6944.2164 1897.8649,-7020.6957 1853.1015,-7247.8266 1903.2231,-7313.2164 2068.2023,-7528.4517 2316.2533,-7307.8181 2474.269,-7528.2164 2544.2288,-7625.7952 2466.6655,-8496.3471 2510.269,-8608.2164 2552.8357,-8717.4253 2636.6371,-8700.2121 2682.1736,-8808.2164 2752.8951,-8975.955 2632.0758,-9055.8264 2718.1736,-9216.2164 2728.909,-9236.2151 2748.9721,-9252.0963 2766.186,-9262.911"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2764.4846,-9265.9717 2774.8635,-9268.0996 2768.0769,-9259.9637 2764.4846,-9265.9717"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge838" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1625.609,-6614.332C1636.8107,-6666.7633 1684.271,-6894.7268 1704.2205,-7084.2164 1743.2518,-7454.9554 1694.5539,-7552.2361 1740.2205,-7922.2164 1774.5703,-8200.5111 1832.4948,-8261.9686 1867.2231,-8540.2164 1888.9333,-8714.1605 1857.9903,-9158.8591 1903.2231,-9328.2164 1946.3259,-9489.5983 2014.7173,-9506.6498 2075.5532,-9662.2164 2191.0797,-9957.6346 2218.5978,-10036.482 2265.3853,-10350.2164 2309.3232,-10644.8434 2240.8716,-11398.5424 2301.3853,-11690.2164 2316.9897,-11765.4294 2357.4039,-11848.0499 2376.9386,-11885.1878"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2373.8514,-11886.837 2381.6427,-11894.0166 2380.0292,-11883.5453 2373.8514,-11886.837"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge872" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1629.6166,-6591.9013C1657.8918,-6542.4714 1775.7794,-6341.6895 1903.2231,-6201.2164 1959.1749,-6139.5443 2107.2503,-5976.5883 2188.4692,-5958.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge85" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-7414.2164C1809.7595,-7442.4792 1848.7281,-7406.0087 1867.2231,-7428.2164 1940.2226,-7515.8695 1853.7977,-8351.4101 1903.2231,-8454.2164 1946.9681,-8545.207 2028.5053,-8512.8888 2075.5532,-8602.2164 2144.5121,-8733.1452 2041.3245,-8802.9643 2111.5532,-8933.2164 2153.6296,-9011.2547 2220.036,-8984.0334 2265.3853,-9060.2164 2308.0079,-9131.8188 2257.6658,-9173.2783 2301.3853,-9244.2164 2352.3908,-9326.9767 2428.5046,-9292.4467 2474.269,-9378.2164 2529.0061,-9480.8022 2494.7222,-9784.9849 2510.269,-9900.2164 2572.6535,-10362.6016 2618.8975,-10473.3258 2718.1736,-10929.2164 2783.8219,-11230.6832 2837.7985,-11299.0681 2876.0764,-11605.2164 2888.9333,-11708.0461 2851.4007,-13386.2061 2912.0764,-13470.2164 2915.6981,-13475.2308 2920.4089,-13479.2454 2925.6813,-13482.4585"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2924.4854,-13485.7749 2934.9914,-13487.1442 2927.6324,-13479.5221 2924.4854,-13485.7749"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge234" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-7072.2164C1818.8166,-7108.6579 1849.5791,-7098.9386 1867.2231,-7134.2164 1922.3618,-7244.4615 1839.9942,-7303.4035 1903.2231,-7409.2164 1927.4237,-7449.7157 1957.9591,-7436.0301 1989.3882,-7471.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1628.7241,-6614.23C1642.4205,-6641.7979 1678.7242,-6716.163 1704.2205,-6780.2164 1754.9256,-6907.6013 1751.253,-6945.5477 1803.7218,-7072.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge281" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1803.7218,-5248.2164C1876.9186,-4771.7734 1822.7972,-4643.4924 1903.2231,-4168.2164 1956.2492,-3854.8597 2031.158,-3788.9118 2075.5532,-3474.2164 2105.8401,-3259.5279 2038.4564,-2703.3372 2111.5532,-2499.2164 2130.5759,-2446.0961 2145.7917,-2435.125 2188.4692,-2398.2164"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1627.5313,-6592.099C1641.6891,-6555.0701 1686.771,-6432.2649 1704.2205,-6326.2164 1766.6206,-5946.9826 1677.0736,-5841.3265 1740.2205,-5462.2164 1756.5209,-5364.3545 1789.5203,-5346.4048 1803.7218,-5248.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge619" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1625.0046,-6591.7947C1635.2654,-6525.8537 1686.671,-6187.0609 1704.2205,-5908.2164 1710.7166,-5804.9991 1702.4206,-2281.4825 1740.2205,-2185.2164 1831.1003,-1953.7699 2170.19,-1600.5083 2510.269,-1472.2164 2581.7537,-1445.2494 2605.8128,-1469.7057 2682.1736,-1472.2164 2939.1424,-1480.6654 3012.7828,-1437.5791 3259.4165,-1510.2164 3276.9742,-1515.3874 3278.0579,-1524.4121 3295.4165,-1530.2164 3344.3454,-1546.5769 3491.0927,-1523.6518 3525.3633,-1562.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge332" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1625.532,-6591.9034C1636.5839,-6537.524 1684.1606,-6297.4406 1704.2205,-6098.2164 1742.7242,-5715.8168 1712.9215,-5617.5788 1740.2205,-5234.2164 1780.167,-4673.2415 1822.288,-4535.8137 1867.2231,-3975.2164 1888.7453,-3706.7131 1872.1676,-3637.7847 1903.2231,-3370.2164 1954.9164,-2924.8383 2000.235,-2818.2129 2075.5532,-2376.2164 2083.6908,-2328.4618 2075.8063,-2193.91 2111.5532,-2161.2164 2183.211,-2095.6792 2887.8233,-2113.718 2982.9529,-2094.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge359" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1803.7218,-7072.2164C1814.7817,-7098.917 1848.1255,-7064.5248 1867.2231,-7086.2164 1926.0525,-7153.0361 1844.395,-7418.3955 1903.2231,-7485.2164 1955.0497,-7544.0844 2009.8241,-7480.4248 2075.5532,-7523.2164 2098.2003,-7537.9603 2094.6713,-7551.1149 2111.5532,-7572.2164 2265.0036,-7764.0213 2332.3148,-7788.7541 2474.269,-7989.2164 2701.9992,-8310.808 2608.2676,-8509.2534 2912.0764,-8760.2164 2963.3579,-8802.5777 3014.7454,-8754.3952 3053.8293,-8808.2164 3103.3539,-8876.4151 3051.5207,-11767.1418 3089.8293,-11842.2164 3100.503,-11863.1338 3121.713,-11878.8876 3140.2488,-11889.4102"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.6102,-11892.503 3149.0755,-11894.1553 3141.9248,-11886.3375 3138.6102,-11892.503"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge451" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M1628.0542,-6592.0836C1642.7958,-6557.5829 1687.1477,-6449.0661 1704.2205,-6354.2164 1738.2631,-6165.0892 1688.0505,-5675.1658 1740.2205,-5490.2164 1771.7108,-5378.5789 1835.2377,-5373.7129 1867.2231,-5262.2164 1910.9089,-5109.9343 1843.4114,-4696.9161 1903.2231,-4550.2164 1946.8897,-4443.1157 2022.8414,-4458.1667 2075.5532,-4355.2164 2108.5745,-4290.7232 2076.3705,-4259.5563 2111.5532,-4196.2164 2158.2248,-4112.1929 2198.1795,-4112.93 2265.3853,-4044.2164 2359.8869,-3947.5944 2416.6057,-3945.451 2474.269,-3823.2164 2501.7873,-3764.8833 2461.9163,-3577.9014 2510.269,-3535.2164 2649.5216,-3412.2867 3022.9545,-3185.5516 3174.6229,-3536.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge513" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1630.0725,-6614.2712C1646.4642,-6641.343 1687.7559,-6713.6181 1704.2205,-6780.2164 1773.4459,-7060.2304 1694.0419,-7143.4927 1740.2205,-7428.2164 1774.5873,-7640.1127 1833.384,-7682.2352 1867.2231,-7894.2164 1892.1967,-8050.66 1844.3325,-8459.1444 1903.2231,-8606.2164 1946.8397,-8715.1431 2027.1812,-8699.3165 2075.5532,-8806.2164 2123.2833,-8911.6976 2074.8389,-8954.4143 2111.5532,-9064.2164 2166.6815,-9229.0895 2201.8284,-9263.7008 2301.3853,-9406.2164 2368.6719,-9502.5372 2432.1257,-9496.539 2474.269,-9606.2164 2508.5903,-9695.5369 2452.0313,-11252.2922 2510.269,-11328.2164 2512.6307,-11331.2952 2515.3493,-11334.0113 2518.3328,-11336.4061"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.5198,-11339.4037 2526.7857,-11342.0234 2520.3942,-11333.5736 2516.5198,-11339.4037"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge540" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1803.7218,-7908.2164C1807.8821,-7936.8159 1848.8173,-7899.9348 1867.2231,-7922.2164 1961.3727,-8036.1906 1820.8217,-9129.4798 1903.2231,-9252.2164 1949.8823,-9321.715 2012.7641,-9272.8569 2075.5532,-9328.2164 2198.4467,-9436.5681 2206.4038,-9491.3632 2265.3853,-9644.2164 2299.4342,-9732.4558 2583.4819,-11220.4974 2596.2213,-11314.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge554" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1625.183,-6614.5133C1635.5561,-6674.4462 1684.0776,-6961.3776 1704.2205,-7198.2164 1743.6775,-7662.1498 1697.5007,-7781.572 1740.2205,-8245.2164 1784.8804,-8729.918 1753.4089,-8865.0902 1903.2231,-9328.2164 1954.6346,-9487.1466 2009.3116,-9508.8736 2075.5532,-9662.2164 2176.1058,-9894.9857 2217.4979,-9951.22 2265.3853,-10200.2164 2339.4802,-10585.4824 2251.9166,-10693.0212 2301.3853,-11082.2164 2347.4167,-11444.3693 2432.8484,-11522.5072 2474.269,-11885.2164 2533.4016,-12403.0234 2451.8965,-13712.3231 2510.269,-14230.2164 2527.0941,-14379.4917 2573.7326,-14554.9576 2590.2932,-14614.3639"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2586.9467,-14615.393 2593.0214,-14624.0733 2593.6857,-14613.4993 2586.9467,-14615.393"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge578" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1673.9107,-6614.2638C1684.4019,-6617.7878 1695.0427,-6622.3511 1704.2205,-6628.2164 1724.374,-6641.096 1718.3718,-6658.4858 1740.2205,-6668.2164 1791.7836,-6691.1806 1816.8618,-6693.7084 1867.2231,-6668.2164 1891.3338,-6656.012 1880.9871,-6634.5731 1903.2231,-6619.2164 1935.9338,-6596.6256 1953.0208,-6579.162 1989.3882,-6595.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge436" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1627.9723,-6592.0685C1642.4781,-6557.5242 1686.2234,-6448.8951 1704.2205,-6354.2164 1753.1136,-6096.9994 1676.4071,-6020.1435 1740.2205,-5766.2164 1773.1311,-5635.2579 1825.8126,-5618.7402 1867.2231,-5490.2164 1872.6732,-5473.3013 2099.3052,-4247.0931 2111.5532,-4234.2164 2160.0896,-4183.1881 2213.9035,-4244.2715 2265.3853,-4196.2164 2303.6072,-4160.5385 2262.706,-4119.398 2301.3853,-4084.2164 2359.5834,-4031.2809 2418.067,-4101.2666 2474.269,-4046.2164 2522.9388,-3998.5442 2461.3044,-3944.5857 2510.269,-3897.2164 2586.3107,-3823.6522 2892.2235,-3785.7903 2982.9529,-3840.2164"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge409" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1636.3824,-6592.0416C1706.0571,-6532.5873 2037.0563,-6245.8329 2265.3853,-5972.2164 2283.6298,-5950.3531 2277.5879,-5934.8544 2301.3853,-5919.2164 2366.7582,-5876.2576 2420.0996,-5942.6499 2474.269,-5886.2164 2549.5695,-5807.7687 2463.7995,-5742.526 2510.269,-5644.2164 2558.9345,-5541.261 2611.2947,-5543.3472 2682.1736,-5454.2164 2803.3659,-5301.816 2931.172,-5103.855 2970.6351,-5041.7364"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2973.6049,-5043.5887 2976.0013,-5033.2684 2967.6921,-5039.8417 2973.6049,-5043.5887"/>
</g>
<!-- sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge375" class="edge">
<title>sourcefile~nodeinputmanager.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-5248.2164C1821.2607,-5134.0546 1849.982,-5110.4235 1867.2231,-4996.2164 1878.5338,-4921.293 1854.219,-4373.0094 1903.2231,-4315.2164 1928.585,-4285.3059 1973.8111,-4332.2054 1989.3882,-4296.2164"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge917" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2448.9548,-1098.2479C2561.006,-1085.3629 2795.216,-1057.8845 2876.0764,-1044.2164 2955.7328,-1030.7517 2989.0806,-1054.5283 3053.8293,-1006.2164 3080.6094,-986.2346 3061.5776,-958.0569 3089.8293,-940.2164 3253.7464,-836.7052 3340.7792,-975.4794 3525.3633,-916.2164"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge73" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M2388.9576,-1116.3994C2397.7671,-1204.1639 2455.5828,-1791.4353 2474.269,-2270.2164 2479.1998,-2396.5517 2480.7029,-11250.2905 2510.269,-11373.2164 2524.3568,-11431.7883 2561.914,-11493.0779 2582.4087,-11523.5626"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2579.6427,-11525.7183 2588.1765,-11531.9973 2585.421,-11521.767 2579.6427,-11525.7183"/>
</g>
<!-- sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge331" class="edge">
<title>sourcefile~dataairflownetwork.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2405.763,-1116.2288C2454.3318,-1145.6121 2593.1688,-1226.7224 2718.1736,-1272.2164 2831.7486,-1313.5507 2871.1893,-1288.2086 2982.9529,-1334.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3174.6229,-1524.2164C3213.7235,-1567.4216 3235.3801,-1571.1334 3259.4165,-1624.2164 3304.4517,-1723.674 3265.4562,-1762.2288 3295.4165,-1867.2164 3315.4873,-1937.549 3332.5062,-1950.7893 3360.8456,-2018.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-1334.2164C3093.5821,-1380.5715 3094.1365,-1435.2806 3174.6229,-1524.2164"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge918" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3659.3423,-16346.2164C3763.2575,-16315.7573 3676.2941,-16138.6245 3784.5721,-16137.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2982.9529,-11905.2164C3105.9884,-11898.9738 3171.9123,-11798.4999 3259.4165,-11885.2164 3298.6916,-11924.1379 3278.0015,-15813.7365 3295.4165,-15866.2164 3334.9655,-15985.3965 3380.144,-15999.2291 3462.2747,-16094.2164 3513.7007,-16153.6926 3546.4424,-16151.7538 3588.4519,-16218.2164 3623.1976,-16273.187 3596.9369,-16364.5083 3659.3423,-16346.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2797.125,-11905.2164C2878.9534,-11894.0247 2900.4635,-11909.2949 2982.9529,-11905.2164"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge620" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2467.9776,-11912.3122C2550.8861,-11917.9977 2683.8514,-11922.4829 2797.125,-11905.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2797.125,-11905.2164C2853.6374,-11895.0136 2857.6779,-11864.616 2912.0764,-11846.2164 3102.4796,-11781.8147 3163.4745,-11752.1956 3360.8456,-11790.2164"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge333" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2406.2676,-11894.0991C2424.6621,-11882.4992 2453.1483,-11863.1143 2474.269,-11842.2164 2584.1957,-11733.4493 2600.257,-11694.3797 2682.1736,-11563.2164 2910.7636,-11197.2024 2944.8086,-11083.7498 3053.8293,-10666.2164 3181.356,-10177.8078 3195.8984,-10049.9872 3259.4165,-9549.2164 3392.2323,-8502.1087 3382.9437,-8234.8239 3426.2747,-7180.2164 3429.7507,-7095.6152 3429.3831,-4210.2394 3462.2747,-4132.2164 3470.0425,-4113.79 3486.0366,-4097.9174 3499.9762,-4086.7135"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3502.4739,-4089.2101 3508.2982,-4080.3598 3498.226,-4083.6463 3502.4739,-4089.2101"/>
</g>
<!-- sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge360" class="edge">
<title>sourcefile~hvacsteamcoilcomponent.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M2982.9529,-11905.2164C3019.3953,-11903.3674 3059.7853,-11903.1024 3094.0547,-11903.4037"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3094.4458,-11906.9079 3104.4824,-11903.5142 3094.5201,-11899.9083 3094.4458,-11906.9079"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge919" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.3937,-8526.3093C1439.0244,-8621.2387 1486.2418,-9306.9094 1506.2007,-9864.2164 1523.7004,-10352.8574 1479.1797,-11579.3404 1542.2007,-12064.2164 1580.9083,-12362.0278 1665.8797,-12422.3575 1704.2205,-12720.2164 1713.4063,-12791.579 1702.6365,-15248.8612 1740.2205,-15310.2164 1825.5037,-15449.4398 1927.5338,-15391.3204 2075.5532,-15460.2164 2260.2235,-15546.1715 2304.8891,-15573.0711 2474.269,-15686.2164 2802.464,-15905.4496 2779.9394,-16232.2164 3174.6229,-16232.2164 3174.6229,-16232.2164 3174.6229,-16232.2164 3360.8456,-16232.2164 3396.3484,-16232.2164 3625.5794,-16357.1943 3659.3423,-16346.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge50" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-9732.2164C2048.002,-9750.6219 2206.9296,-9767.1182 2265.3853,-9748.2164 2284.1644,-9742.144 2283.6438,-9730.8634 2301.3853,-9722.2164 2310.036,-9718.0001 2319.5288,-9714.3653 2328.9574,-9711.2764"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2330.2042,-9714.5544 2338.7218,-9708.2535 2328.134,-9707.8675 2330.2042,-9714.5544"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1435.1741,-8526.3306C1448.4123,-8567.4758 1496.4032,-8714.9239 1542.2007,-8834.2164 1675.3341,-9180.9996 1723.2782,-9261.7795 1867.2231,-9604.2164 1883.28,-9642.4147 1874.7719,-9660.0922 1903.2231,-9690.2164 1932.4755,-9721.1888 1948.165,-9721.4624 1989.3882,-9732.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge122" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M1434.1227,-8504.0664C1444.6418,-8456.8784 1485.6103,-8268.8293 1506.2007,-8112.2164 1532.8163,-7909.7751 1501.7143,-7854.3456 1542.2007,-7654.2164 1597.5472,-7380.6319 1637.7192,-7317.8414 1740.2205,-7058.2164 1789.8065,-6932.62 1829.8739,-6911.9787 1867.2231,-6782.2164 1901.5619,-6662.9134 1839.5916,-6611.8155 1903.2231,-6505.2164 1927.4049,-6464.7058 1958.6924,-6479.0442 1989.3882,-6443.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge648" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3659.3423,-15890.2164C3754.3813,-15673.8439 3782.9199,-7618.5267 3784.5015,-7149.5268"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3788.002,-7149.3651 3784.5356,-7139.3534 3781.002,-7149.3416 3788.002,-7149.3651"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M1432.2504,-8526.3157C1437.6846,-8621.298 1476.8447,-9307.3253 1506.2007,-9864.2164 1514.6104,-10023.7509 1491.3565,-10430.7672 1542.2007,-10582.2164 1582.926,-10703.5245 1666.0511,-10698.08 1704.2205,-10820.2164 1741.0353,-10938.0185 1670.456,-15161.4048 1740.2205,-15263.2164 1785.811,-15329.7495 3014.0211,-15770.6798 3089.8293,-15798.2164 3180.2871,-15831.0742 3200.9563,-15847.7908 3295.4165,-15866.2164 3335.1909,-15873.9748 3643.0454,-15927.319 3659.3423,-15890.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge752" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1623.2106,-8515.2164C1731.212,-8526.0261 1760.1426,-8542.9621 1867.2231,-8525.2164 1963.7275,-8509.2234 2000.733,-8517.2308 2075.5532,-8454.2164 2101.11,-8432.6921 2085.368,-8408.9716 2111.5532,-8388.2164 2242.6009,-8284.3437 2367.5702,-8416.9734 2474.269,-8288.2164 2536.4425,-8213.1895 2462.3573,-7936.0635 2510.269,-7851.2164 2533.4294,-7810.2015 2576.1629,-7831.8343 2596.2213,-7789.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge813" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1434.3392,-8504.092C1445.7286,-8457.0069 1489.7021,-8269.3131 1506.2007,-8112.2164 1522.1054,-7960.7745 1500.5615,-6888.6875 1542.2007,-6742.2164 1555.4551,-6695.5922 1587.9661,-6648.3051 1607.5352,-6622.6791"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1610.4798,-6624.5944 1613.8646,-6614.5548 1604.9578,-6620.2924 1610.4798,-6624.5944"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge829" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1432.4349,-8526.4008C1436.9139,-8583.2873 1461.2675,-8845.4603 1542.2007,-9041.2164 1592.6464,-9163.2312 1660.0818,-9165.781 1704.2205,-9290.2164 1755.3153,-9434.2626 1690.471,-9487.7 1740.2205,-9632.2164 1811.9394,-9840.5515 2201.5596,-10262.3292 2265.3853,-10473.2164 2343.761,-10732.1786 2246.0627,-11425.37 2301.3853,-11690.2164 2317.0917,-11765.4082 2357.4558,-11848.0391 2376.9583,-11885.1837"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2373.8688,-11886.8284 2381.6544,-11894.0141 2380.0492,-11883.5416 2373.8688,-11886.8284"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge873" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1434.2938,-8504.0871C1445.5005,-8456.9823 1488.843,-8269.2205 1506.2007,-8112.2164 1529.8304,-7898.4808 1479.3968,-7350.8785 1542.2007,-7145.2164 1582.0765,-7014.6362 1649.4404,-7009.278 1704.2205,-6884.2164 1728.2746,-6829.3013 1709.7185,-6805.8294 1740.2205,-6754.2164 1780.3565,-6686.3014 1830.2849,-6699.9223 1867.2231,-6630.2164 1909.7178,-6550.025 1855.7012,-6506.5346 1903.2231,-6429.2164 1963.9328,-6330.4419 2006.8544,-6322.0181 2111.5532,-6272.2164 2143.3516,-6257.091 2162.2274,-6276.6957 2188.4692,-6253.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge235" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-8515.2164C1789.3341,-8515.6765 1855.673,-8538.7937 1989.3882,-8440.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-8440.2164C2037.6256,-8399.162 2160.9141,-8293.2516 2188.4692,-8236.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-8236.2164C2228.8178,-8152.7006 2240.9409,-8131.689 2265.3853,-8042.2164 2292.5378,-7942.831 2277.3337,-7913.3974 2301.3853,-7813.2164 2323.7145,-7720.2089 2363.0931,-7612.8498 2379.883,-7568.7439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2383.1552,-7569.9861 2383.4651,-7559.3958 2376.6186,-7567.4813 2383.1552,-7569.9861"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1481.7738,-8512.4921C1520.5056,-8511.0465 1575.3843,-8510.4295 1623.2106,-8515.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge334" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1434.3836,-8504.0965C1445.9514,-8457.0297 1490.5408,-8269.3989 1506.2007,-8112.2164 1607.9067,-7091.3677 1446.1212,-6825.6099 1542.2007,-5804.2164 1590.3624,-5292.2231 1649.6042,-5170.4232 1740.2205,-4664.2164 1795.0887,-4357.7076 1829.6817,-4284.3261 1867.2231,-3975.2164 1899.6989,-3707.8167 1859.6125,-3636.0271 1903.2231,-3370.2164 1950.4294,-3082.4904 2018.3354,-3023.1198 2075.5532,-2737.2164 2087.7344,-2676.3501 2066.7362,-2503.1643 2111.5532,-2460.2164 2200.5406,-2374.9402 2264.5763,-2436.2164 2387.8271,-2436.2164 2387.8271,-2436.2164 2387.8271,-2436.2164 2596.2213,-2436.2164 2768.102,-2436.2164 2834.6519,-2523.1059 2982.9529,-2436.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge362" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1455.212,-8526.3101C1584.6381,-8588.5399 2212.0422,-8908.3341 2474.269,-9378.2164 2530.6897,-9479.3161 2469.3304,-9527.9183 2510.269,-9636.2164 2559.2526,-9765.7963 2629.7744,-9767.9796 2682.1736,-9896.2164 2707.5396,-9958.2948 2893.1096,-11016.8936 2912.0764,-11081.2164 2959.8933,-11243.3794 3014.4748,-11269.7946 3053.8293,-11434.2164 3075.0164,-11522.735 3045.4035,-11762.7759 3089.8293,-11842.2164 3101.3159,-11862.7561 3122.5917,-11878.5336 3140.9571,-11889.1624"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3139.5055,-11892.3583 3149.9551,-11894.1068 3142.8767,-11886.2235 3139.5055,-11892.3583"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge514" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1439.3215,-8526.4623C1491.8223,-8602.715 1804.0081,-9050.4715 2111.5532,-9368.2164 2148.3743,-9406.2587 2451.5509,-9629.3949 2474.269,-9677.2164 2513.6366,-9760.0847 2454.3988,-11255.4463 2510.269,-11328.2164 2512.6321,-11331.2942 2515.3518,-11334.0094 2518.3362,-11336.4036"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2516.5245,-11339.4019 2526.7909,-11342.0194 2520.3976,-11333.571 2516.5245,-11339.4019"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge580" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1444.2069,-8503.9123C1505.2434,-8448.1945 1771.2872,-8194.5101 1867.2231,-7922.2164 1897.492,-7836.3048 1842.6951,-7171.2852 1903.2231,-7103.2164 1929.0043,-7074.2233 1957.6146,-7111.4808 1989.3882,-7089.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge437" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2982.9529,-5637.2164C2996.1952,-5597.5145 3036.0033,-5613.0823 3053.8293,-5575.2164 3114.9504,-5445.3837 3049.0952,-4421.8138 3089.8293,-4284.2164 3103.8151,-4236.9734 3138.0628,-4189.6271 3158.4988,-4164.2177"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.215,-4166.4251 3164.8505,-4156.4735 3155.8026,-4161.9859 3161.215,-4166.4251"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1433.9188,-8504.0481C1449.3753,-8429.1718 1537.5115,-8002.9986 1542.2007,-7998.2164 1593.9839,-7945.4054 1653.8851,-8014.4091 1704.2205,-7960.2164 1774.0371,-7885.0493 1701.8892,-7827.375 1740.2205,-7732.2164 1777.075,-7640.7239 1835.2511,-7643.5272 1867.2231,-7550.2164 1892.6832,-7475.9108 1857.8752,-6908.3497 1903.2231,-6844.2164 1951.0483,-6776.5797 2000.8918,-6809.1 2075.5532,-6773.2164 2162.4535,-6731.4505 2211.2949,-6748.0304 2265.3853,-6668.2164 2337.0112,-6562.5273 2238.1248,-6494.1152 2301.3853,-6383.2164 2359.5977,-6281.167 2409.3781,-6281.4142 2510.269,-6221.2164 2582.0057,-6178.4138 2630.454,-6210.8158 2682.1736,-6145.2164 2737.2797,-6075.3215 2675.1621,-6026.1393 2718.1736,-5948.2164 2764.217,-5864.8006 2827.8878,-5885.4115 2876.0764,-5803.2164 2911.1886,-5743.3257 2862.0732,-5699.3768 2912.0764,-5651.2164 2935.2033,-5628.9418 2972.7933,-5667.676 2982.9529,-5637.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge410" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.0258,-8504.1968C1443.6836,-8459.9002 1480.3017,-8290.459 1506.2007,-8150.2164 1524.0342,-8053.6481 1506.853,-8023.8351 1542.2007,-7932.2164 1638.1419,-7683.5432 1784.5354,-7681.605 1867.2231,-7428.2164 1909.9688,-7297.2265 1830.0258,-6925.954 1903.2231,-6809.2164 2001.132,-6653.0679 2165.8124,-6762.309 2265.3853,-6607.2164 2319.8232,-6522.4249 2257.5364,-6245.9377 2301.3853,-6155.2164 2347.0764,-6060.6834 2417.1125,-6082.2918 2474.269,-5994.2164 2501.1246,-5952.8333 2483.6633,-5930.7605 2510.269,-5889.2164 2567.2163,-5800.2947 2624.8269,-5813.881 2682.1736,-5725.2164 2708.282,-5684.8498 2690.1553,-5662.2815 2718.1736,-5623.2164 2744.1765,-5586.9613 2772.9002,-5598.6829 2797.125,-5561.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge365" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1434.3814,-8504.0963C1445.9403,-8457.0286 1490.499,-8269.3947 1506.2007,-8112.2164 1512.3644,-8050.5154 1504.7014,-5929.6006 1542.2007,-5880.2164 1587.6188,-5820.4036 1657.4975,-5891.0156 1704.2205,-5832.2164 1745.6319,-5780.1015 1732.2146,-5300.2979 1740.2205,-5234.2164 1777.9335,-4922.9258 1814.2267,-4849.2721 1867.2231,-4540.2164 1875.7812,-4490.3089 1868.4783,-4352.0511 1903.2231,-4315.2164 1930.1316,-4286.6893 1973.8111,-4332.2054 1989.3882,-4296.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-4296.2164C2008.243,-4252.9688 2047.3722,-4272.054 2075.5532,-4234.2164 2104.7701,-4194.988 2088.3417,-4173.2712 2111.5532,-4130.2164 2138.1613,-4080.8613 2156.3259,-4076.159 2188.4692,-4030.2164"/>
</g>
<!-- sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge754" class="edge">
<title>sourcefile~fluidproperties.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.2165,-8526.3378C1436.2169,-8596.5728 1461.3428,-8985.4455 1542.2007,-9290.2164 1598.0955,-9500.8961 1784.4701,-10019.4381 1903.2231,-10202.2164 1980.9901,-10321.911 2113.3636,-10433.6955 2165.959,-10475.6859"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2163.9664,-10478.5725 2173.9781,-10482.0391 2168.3134,-10473.0858 2163.9664,-10478.5725"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge920" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-6131.2164C2631.3131,-6158.0811 2648.1478,-6153.0137 2682.1736,-6181.2164 3156.0137,-6573.964 3196.5411,-6753.6838 3588.4519,-7228.2164 3620.8762,-7267.4763 3632.683,-7274.8348 3659.3423,-7318.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M3659.3423,-7318.2164C3670.0765,-7332.2359 3685.1364,-7322.0827 3694.2327,-7337.2164 3757.2007,-7441.9774 3662.3533,-16138.7647 3784.5721,-16137.2164"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge335" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3360.8456,-6477.2164C3551.4399,-6299.1994 3357.2033,-4370.9133 3462.2747,-4132.2164 3470.331,-4113.9143 3486.3224,-4098.0405 3500.1886,-4086.805"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3502.676,-4089.3067 3508.4577,-4080.4285 3498.4014,-4083.7634 3502.676,-4089.3067"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3174.6229,-6321.2164C3267.3724,-6376.4866 3281.9411,-6550.914 3360.8456,-6477.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2393.2329,-5877.3044C2413.6364,-5917.9614 2490.2302,-6060.1833 2596.2213,-6131.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2596.2213,-6131.2164C2769.1574,-6247.1145 2864.4046,-6144.8592 3053.8293,-6231.2164 3114.7467,-6258.9881 3117.111,-6286.9445 3174.6229,-6321.2164"/>
</g>
<!-- sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge456" class="edge">
<title>sourcefile~hvacwatertoairmultispeedhp.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M2474.4789,-5864.6024C2611.6775,-5857.7521 2881.0357,-5826.3291 3053.8293,-5689.2164 3143.3528,-5618.179 3080.6308,-5527.2258 3174.6229,-5462.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge921" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfurnace.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.4241,-5899.9191C592.6069,-5800.2677 637.7719,-5060.8325 654.4731,-4460.2164 656.1576,-4399.6405 649.3185,-141.6975 690.4731,-97.2164 757.316,-24.9707 812.6873,-78.2164 911.1119,-78.2164 911.1119,-78.2164 911.1119,-78.2164 2387.8271,-78.2164 2569.7373,-78.2164 2617.1085,-52.0372 2797.125,-78.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge51" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-9848.2164C2259.7946,-9808.5826 2333.837,-9745.7626 2368.1681,-9715.1588"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2370.5378,-9717.7349 2375.6374,-9708.448 2365.8595,-9712.5277 2370.5378,-9717.7349"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-10074.2164C765.8609,-10118.0924 810.8008,-10064.1999 855.7932,-10060.2164 1066.0715,-10041.5989 1645.7597,-10138.2577 1803.7218,-9998.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-9998.2164C1942.8832,-9878.5537 2028.039,-9937.3635 2188.4692,-9848.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge74" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M755.1332,-10074.2164C762.2471,-10103.3121 801.3063,-10069.6494 819.7932,-10093.2164 874.2315,-10162.614 827.8572,-10802.5555 855.7932,-10886.2164 883.4084,-10968.9165 939.6749,-10965.2342 966.4307,-11048.2164 1016.2953,-11202.8699 980.6352,-12349.191 1002.4307,-12510.2164 1039.4179,-12783.4784 1036.8022,-12861.9523 1152.5955,-13112.2164 1218.0536,-13253.6911 1242.3643,-13291.614 1357.0291,-13397.2164 1427.6093,-13462.2183 1449.7249,-13482.6224 1542.2007,-13508.2164 1775.21,-13572.7049 1896.3969,-13563.559 2075.5532,-13401.2164 2104.7462,-13374.7632 2090.3126,-13353.3952 2111.5532,-13320.2164 2243.2688,-13114.4705 2384.5079,-13134.4239 2474.269,-12907.2164 2520.4659,-12790.2807 2486.2012,-11899.6216 2510.269,-11776.2164 2526.2134,-11694.4636 2567.0398,-11603.4126 2586.1156,-11563.6513"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2589.3524,-11564.9981 2590.5719,-11554.4737 2583.0554,-11561.9405 2589.3524,-11564.9981"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge106" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2982.9529,-8670.2164C3089.7295,-8396.2276 3162.0477,-7420.9955 3173.1362,-7263.7052"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3176.6466,-7263.6771 3173.8532,-7253.4572 3169.6637,-7263.1885 3176.6466,-7263.6771"/>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M1236.8123,-7224.2164C1255.1836,-7266.9104 1291.4172,-7250.3914 1321.0291,-7286.2164 1351.4629,-7323.0357 1492.7587,-7628.3776 1506.2007,-7674.2164 1542.2514,-7797.1537 1476.1754,-7850.4261 1542.2007,-7960.2164 1587.5771,-8035.6707 1650.3903,-8004.5408 1704.2205,-8074.2164 1742.8052,-8124.1589 1852.4524,-8568.7281 1903.2231,-8606.2164 1999.904,-8677.6039 2939.3139,-8782.194 2982.9529,-8670.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge118" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~datazoneequipment.f90</title>
<path fill="none" stroke="#ffa100" stroke-dasharray="5,2" d="M614.3426,-5900.1317C628.6348,-5893.1237 644.8813,-5882.634 654.4731,-5868.2164 709.3531,-5785.7258 658.3543,-5741.944 690.4731,-5648.2164 740.3307,-5502.7244 777.5161,-5476.6035 855.7932,-5344.2164 965.1389,-5159.2841 1046.8065,-5140.4057 1116.5955,-4937.2164 1144.9399,-4854.692 1103.6684,-4618.4647 1152.5955,-4546.2164 1199.7261,-4476.6206 1247.5917,-4501.1042 1321.0291,-4460.2164 1405.0633,-4413.4284 1430.4953,-4407.5422 1506.2007,-4348.2164 1524.011,-4334.2595 1522.1122,-4322.6304 1542.2007,-4312.2164 1574.639,-4295.4002 1603.9167,-4329.2451 1623.2106,-4298.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge197" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M587.6505,-5900.0105C601.8333,-5817.7243 689.367,-5309.9753 690.4731,-5306.2164 743.6201,-5125.6104 767.2027,-5082.3333 855.7932,-4916.2164 955.4854,-4729.2827 1039.0475,-4714.3687 1116.5955,-4517.2164 1151.0974,-4429.5011 1098.4701,-4385.3836 1152.5955,-4308.2164 1202.0742,-4237.674 1248.5079,-4258.7466 1321.0291,-4212.2164 1406.3116,-4157.4983 1426.0789,-4141.246 1506.2007,-4079.2164 1522.6694,-4066.4665 1523.6989,-4058.78 1542.2007,-4049.2164 1608.3835,-4015.0062 1651.5569,-4058.9141 1704.2205,-4006.2164 1748.4189,-3961.9893 1690.6728,-3908.355 1740.2205,-3870.2164 1784.9497,-3835.7867 1825.8592,-3831.8089 1867.2231,-3870.2164 1946.4211,-3943.7536 1855.564,-4258.2181 1903.2231,-4355.2164 1958.0909,-4466.886 2005.0398,-4477.9088 2111.5532,-4542.2164 2173.9715,-4579.9014 2213.1713,-4548.3252 2265.3853,-4599.2164 2296.2366,-4629.2862 2269.9152,-4659.7947 2301.3853,-4689.2164 2309.8522,-4697.1322 2320.5798,-4702.8106 2331.5729,-4706.884"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2330.6588,-4710.2677 2341.2517,-4710.0663 2332.8452,-4703.6179 2330.6588,-4710.2677"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge261" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M587.122,-5922.2945C595.514,-5989.1541 639.2256,-6345.7554 654.4731,-6638.2164 696.6127,-7446.4915 630.0097,-9473.1051 690.4731,-10280.2164 710.1878,-10543.3819 811.0122,-11196.1405 855.7932,-11456.2164 897.5119,-11698.5073 938.1723,-11753.9894 966.4307,-11998.2164 998.1159,-12272.0611 945.4796,-12968.4916 1002.4307,-13238.2164 1030.1946,-13369.7083 1075.1299,-13390.3822 1116.5955,-13518.2164 1137.3494,-13582.1985 1119.128,-13606.8694 1152.5955,-13665.2164 1195.0716,-13739.2689 1659.4481,-14132.579 1740.2205,-14160.2164 2097.58,-14282.4919 2296.553,-14091.7494 2682.1736,-13768.2164 2749.2527,-13711.9374 2757.9585,-13686.5293 2797.125,-13608.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge649" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M586.3555,-5899.9169C591.9473,-5800.2467 633.0154,-5060.6814 654.4731,-4460.2164 678.1931,-3796.4473 624.036,-3627.078 690.4731,-2966.2164 732.3782,-2549.3794 757.56,-2445.4747 855.7932,-2038.2164 907.9985,-1821.7823 917.2488,-1764.9179 1002.4307,-1559.2164 1043.8244,-1459.2566 1080.8953,-1446.3482 1116.5955,-1344.2164 1145.3879,-1261.8463 1124.1522,-1233.7076 1152.5955,-1151.2164 1216.7743,-965.0848 1235.4067,-913.0449 1357.0291,-758.2164 1776.3295,-224.4358 2218.1886,-433.1289 2876.0764,-600.2164 3048.3545,-643.9708 3099.9306,-635.7406 3259.4165,-714.2164 3277.1253,-722.9301 3278.5527,-729.9625 3295.4165,-740.2164 3351.0734,-774.0578 3374.0652,-767.2663 3426.2747,-806.2164 3510.4884,-869.0427 3541.8706,-884.0395 3588.4519,-978.2164 3674.7133,-1152.6172 3587.0839,-1229.5637 3659.3423,-1410.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3659.3423,-1410.2164C3722.3886,-1549.7713 3780.2451,-6732.8477 3784.3407,-7106.9386"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3780.8438,-7107.2484 3784.4529,-7117.2096 3787.8434,-7107.1719 3780.8438,-7107.2484"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge673" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M755.1332,-4256.2164C763.2903,-4203.9227 800.0173,-4205.309 819.7932,-4156.2164 978.8158,-3761.4519 895.9978,-3628.2834 1002.4307,-3216.2164 1043.561,-3056.9754 1088.0377,-3026.1851 1116.5955,-2864.2164 1136.2096,-2752.9726 1099.8524,-1948.1067 1152.5955,-1848.2164 1195.9993,-1766.0137 1259.4349,-1793.8391 1321.0291,-1724.2164 1342.6535,-1699.7732 1334.0746,-1683.4151 1357.0291,-1660.2164 1410.8549,-1605.8178 1442.6967,-1616.9208 1506.2007,-1574.2164 1523.021,-1562.9052 1523.3916,-1553.7717 1542.2007,-1546.2164 1602.2844,-1522.0815 1676.0825,-1516.4037 1729.9465,-1516.1386"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1730.0992,-1519.6387 1740.1036,-1516.1513 1730.108,-1512.6387 1730.0992,-1519.6387"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge681" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M594.7209,-5900.1198C629.3951,-5856.8105 755.5709,-5693.9037 819.7932,-5539.2164 847.2433,-5473.0996 819.8687,-5444.1386 855.7932,-5382.2164 889.3551,-5324.3664 923.0271,-5331.1001 966.4307,-5280.2164 1044.6936,-5188.4656 1077.397,-5168.2637 1116.5955,-5054.2164 1133.7996,-5004.1613 1113.7804,-4615.2009 1152.5955,-4579.2164 1224.5338,-4512.5239 1720.184,-4570.7539 1867.2231,-4702.2164 1903.6874,-4734.8178 1885.0396,-4760.8088 1903.2231,-4806.2164 1986.0554,-5013.0634 1975.551,-5085.7219 2111.5532,-5262.2164 2125.5988,-5280.4437 2145.8741,-5296.7717 2162.082,-5308.2356"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2160.3774,-5311.3107 2170.6025,-5314.0852 2164.3393,-5305.5398 2160.3774,-5311.3107"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge701" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M755.1332,-5920.2164C846.3875,-5897.9699 892.2035,-5858.6614 966.4307,-5916.2164 1017.2024,-5955.5843 971.9724,-5999.6487 1002.4307,-6056.2164 1011.6145,-6073.2728 1026.3858,-6089.3996 1038.6012,-6101.0667"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1036.4519,-6103.8459 1046.1749,-6108.0546 1041.1987,-6098.7011 1036.4519,-6103.8459"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge715" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M755.1332,-10074.2164C772.3322,-10144.5158 792.4835,-9981.2834 855.7932,-9946.2164 1012.621,-9859.3501 1230.3243,-9863.4113 1348.0255,-9873.8781"/>
<polygon fill="#005dff" stroke="#005dff" points="1347.7779,-9877.3701 1358.0582,-9874.8075 1348.4237,-9870.3999 1347.7779,-9877.3701"/>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M635.4535,-5914.3877C642.8189,-5917.0353 649.5684,-5921.0957 654.4731,-5927.2164 724.218,-6014.2514 664.8042,-9833.6781 690.4731,-9942.2164 705.5081,-10005.7899 739.6177,-10010.7585 755.1332,-10074.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge725" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M755.1332,-10074.2164C762.4064,-10103.2727 795.4679,-10075.7393 819.7932,-10093.2164 934.7736,-10175.8265 892.9242,-10264.4764 1002.4307,-10354.2164 1006.7716,-10357.7737 1011.6971,-10360.9159 1016.7921,-10363.6651"/>
<polygon fill="#000dff" stroke="#000dff" points="1015.5353,-10366.9465 1026.0564,-10368.1941 1018.6097,-10360.6577 1015.5353,-10366.9465"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge753" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1431.6149,-7047.2164C1522.6719,-7080.1586 1795.835,-6992.7923 1867.2231,-7058.2164 1972.4097,-7154.6152 1796.8282,-7282.153 1903.2231,-7377.2164 1960.3373,-7428.2476 1999.3746,-7385.1551 2075.5532,-7377.2164 2333.4086,-7350.3447 2634.5554,-7269.7066 2749.3731,-7237.1124"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2750.5965,-7240.4031 2759.2535,-7234.2953 2748.6771,-7233.6714 2750.5965,-7240.4031"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge791" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M755.1332,-10074.2164C758.0474,-10085.922 957.9125,-10115.675 966.4307,-10124.2164 1016.0654,-10173.9862 947.3613,-10234.5357 1002.4307,-10278.2164 1042.1835,-10309.7481 1066.4878,-10286.2016 1116.5955,-10278.2164 1841.7633,-10162.6519 2247.8421,-10342.314 2682.1736,-9750.2164 2742.1653,-9668.4334 2650.9211,-9371.1411 2718.1736,-9295.2164 2727.4845,-9284.7048 2741.6368,-9279.9775 2755.4005,-9278.1141"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2756.11,-9281.5652 2765.7634,-9277.199 2755.4942,-9274.5923 2756.11,-9281.5652"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge799" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M589.0008,-5922.305C600.6117,-5962.1316 639.8341,-6101.8599 654.4731,-6220.2164 702.5898,-6609.2394 750.3797,-9616.5624 754.8007,-9900.6885"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="751.3046,-9900.9753 754.9594,-9910.9197 758.3038,-9900.8666 751.3046,-9900.9753"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge808" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataplant.f90</title>
<path fill="none" stroke="#9300ff" stroke-dasharray="5,2" d="M586.2619,-5900.143C590.8461,-5808.7985 624.5549,-5178.7552 690.4731,-5002.2164 776.3688,-4772.1752 832.8029,-4723.7647 1002.4307,-4546.2164 1046.3137,-4500.2843 1082.7821,-4513.9949 1116.5955,-4460.2164 1160.0212,-4391.1497 1107.4545,-4348.1744 1152.5955,-4280.2164 1268.3284,-4105.9848 1353.1156,-4105.6457 1542.2007,-4016.2164 1610.0927,-3984.1063 1653.5751,-4023.6729 1704.2205,-3968.2164 1759.2369,-3907.9736 1677.1279,-3839.9399 1740.2205,-3788.2164 1783.8722,-3752.4305 1825.9598,-3749.7008 1867.2231,-3788.2164 1952.2237,-3867.5568 1830.2336,-4219.7038 1903.2231,-4310.2164 1912.5974,-4321.8412 1927.0356,-4328.2652 1941.4298,-4331.7535"/>
<polygon fill="#9300ff" stroke="#9300ff" points="1940.8338,-4335.2035 1951.3252,-4333.7272 1942.2031,-4328.3387 1940.8338,-4335.2035"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge822" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M755.1332,-5920.2164C835.6576,-5902.2055 783.336,-5803.6947 855.7932,-5764.2164 898.9722,-5740.6902 922.5296,-5742.0668 966.4307,-5764.2164 997.5108,-5779.8973 1044.7109,-5858.7082 1059.5131,-5890.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge843" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M755.1332,-10074.2164C762.123,-10103.3422 799.1847,-10071.4803 819.7932,-10093.2164 867.5596,-10143.5962 839.6925,-10177.6848 855.7932,-10245.2164 904.6598,-10450.1784 934.8368,-10497.8916 966.4307,-10706.2164 1003.0952,-10947.976 946.9597,-11017.0673 1002.4307,-11255.2164 1032.5446,-11384.5021 1087.7267,-11401.6469 1116.5955,-11531.2164 1154.2343,-11700.148 1078.3364,-12152.8829 1152.5955,-12309.2164 1239.7557,-12492.71 1341.2444,-12518.4943 1542.2007,-12548.2164 1685.1114,-12569.3533 1724.4338,-12566.1585 1867.2231,-12544.2164 1962.46,-12529.5815 2006.4729,-12551.3889 2075.5532,-12484.2164 2113.3425,-12447.4707 2071.9682,-12406.0201 2111.5532,-12371.2164 2137.6481,-12348.2734 2166.8856,-12384.4463 2188.4692,-12357.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge849" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~fluidproperties.f90</title>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M1236.8123,-8908.2164C1407.5306,-8929.6735 1235.8306,-8662.3478 1357.0291,-8540.2164 1361.4482,-8535.7632 1366.683,-8532.1033 1372.2984,-8529.0952"/>
<polygon fill="#ff0078" stroke="#ff0078" points="1373.7755,-8532.2684 1381.3736,-8524.8846 1370.8293,-8525.9185 1373.7755,-8532.2684"/>
<path fill="none" stroke="#ff0078" stroke-dasharray="5,2" d="M755.1332,-6158.2164C840.6301,-6217.2475 890.8902,-6186.8859 966.4307,-6258.2164 990.7247,-6281.1564 980.2348,-6299.2406 1002.4307,-6324.2164 1043.7582,-6370.7199 1087.2414,-6350.3631 1116.5955,-6405.2164 1149.139,-6466.0297 1149.2986,-7577.3218 1152.5955,-7646.2164 1159.3129,-7786.5898 1097.3752,-8890.6909 1236.8123,-8908.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge874" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M911.1119,-5396.2164C980.0977,-5321.673 1057.5591,-5378.8629 1116.5955,-5296.2164 1154.5982,-5243.0153 1103.6179,-5047.5265 1152.5955,-5004.2164 1208.6741,-4954.6269 1247.1444,-4992.1757 1321.0291,-5004.2164 1406.6882,-5018.1759 1425.5807,-5034.0796 1506.2007,-5066.2164 1670.5975,-5131.7483 1715.6622,-5142.8379 1867.2231,-5234.2164 1876.8196,-5240.0022 2181.9301,-5469.1165 2188.4692,-5478.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~globalnames.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M635.479,-5915.665C642.567,-5918.2043 649.2203,-5921.8971 654.4731,-5927.2164 706.9081,-5980.3141 655.2309,-6025.4382 690.4731,-6091.2164 710.0169,-6127.694 720.901,-6134.9626 755.1332,-6158.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6158.2164C834.1274,-6211.8768 892.4446,-6136.8376 966.4307,-6197.2164 999.4886,-6224.1944 971.323,-6257.011 1002.4307,-6286.2164 1041.4177,-6322.8194 1084.5345,-6281.416 1116.5955,-6324.2164 1182.5873,-6412.3133 1122.3848,-7208.3706 1152.5955,-7314.2164 1239.4484,-7618.5138 1387.6485,-7638.8126 1506.2007,-7932.2164 1530.5921,-7992.5825 1518.1141,-8013.7279 1542.2007,-8074.2164 1663.8788,-8379.7861 1651.82,-8508.1436 1903.2231,-8720.2164 1969.6945,-8776.2888 2069.4688,-8802.0759 2131.6845,-8813.2991"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2131.2623,-8816.7781 2141.7137,-8815.0408 2132.4601,-8809.8813 2131.2623,-8816.7781"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M586.1837,-5900.1084C591.2096,-5781.2639 636.3826,-4746.3593 690.4731,-4622.2164 802.5755,-4364.931 993.9695,-4408.6556 1116.5955,-4156.2164 1159.5035,-4067.8854 1105.9075,-4024.609 1152.5955,-3938.2164 1167.2671,-3911.0676 1330.4577,-3765.9095 1357.0291,-3750.2164 1363.809,-3746.2121 1371.3182,-3742.7435 1378.8844,-3739.7722"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1380.2603,-3742.9958 1388.4481,-3736.2718 1377.8543,-3736.4222 1380.2603,-3742.9958"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge91" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.1269,-5922.2942C595.5476,-5989.1523 639.3973,-6345.7464 654.4731,-6638.2164 678.1139,-7096.8471 631.0761,-10315.8341 690.4731,-10771.2164 720.439,-11000.9571 781.9716,-11047.6376 819.7932,-11276.2164 853.6314,-11480.7209 809.7932,-11539.0998 855.7932,-11741.2164 885.9464,-11873.7046 939.6598,-11893.0035 966.4307,-12026.2164 996.3449,-12175.0708 952.924,-13248.6839 1002.4307,-13392.2164 1030.2117,-13472.7607 1083.296,-13467.7924 1116.5955,-13546.2164 1154.6332,-13635.7995 1101.9878,-13679.0848 1152.5955,-13762.2164 1201.2081,-13842.0708 1256.4478,-13820.6207 1321.0291,-13888.2164 1340.7001,-13908.8056 1338.6449,-13919.4704 1357.0291,-13941.2164 1509.2746,-14121.3027 1525.688,-14210.3101 1740.2205,-14308.2164 2169.3906,-14504.0769 2375.2394,-14617.311 2797.125,-14406.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge143" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5320.2164C772.5136,-5284.3961 798.3142,-5291.7398 819.7932,-5258.2164 846.1809,-5217.0316 837.46,-5199.5638 855.7932,-5154.2164 899.5145,-5046.0716 924.1931,-5024.9492 966.4307,-4916.2164 985.6697,-4866.6889 963.6523,-4838.5393 1002.4307,-4802.2164 1021.4953,-4784.3589 1049.3226,-4812.2685 1059.5131,-4788.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M615.6035,-5900.1424C629.8721,-5893.2308 645.7112,-5882.8255 654.4731,-5868.2164 714.5071,-5768.1202 620.5829,-5437.6972 690.4731,-5344.2164 708.8282,-5319.6658 742.0313,-5347.9288 755.1332,-5320.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1059.5131,-4788.2164C1070.3941,-4762.9376 1100.3727,-4786.4477 1116.5955,-4764.2164 1170.2481,-4690.692 1094.617,-4426.38 1152.5955,-4356.2164 1202.1789,-4296.2121 1253.0866,-4346.2013 1321.0291,-4308.2164 1339.9743,-4297.6245 1340.3304,-4289.0824 1357.0291,-4275.2164 1388.9204,-4248.7349 1392.3927,-4232.631 1431.6149,-4219.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge177" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.1332,-5320.2164C773.6341,-5284.9618 793.1877,-5287.8359 819.7932,-5258.2164 981.3845,-5078.3197 1041.0139,-5031.9162 1116.5955,-4802.2164 1157.7416,-4677.1693 1086.1576,-4621.864 1152.5955,-4508.2164 1199.5098,-4427.9655 1247.3734,-4440.9262 1321.0291,-4384.2164 1352.5424,-4359.9532 1388.2711,-4330.912 1410.3768,-4312.7592"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1412.6465,-4315.4242 1418.1449,-4306.3678 1408.1989,-4310.0187 1412.6465,-4315.4242"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge155" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M911.1119,-5396.2164C929.3152,-5376.5467 946.6467,-5390.2953 966.4307,-5372.2164 991.0964,-5349.6765 977.6376,-5328.6161 1002.4307,-5306.2164 1022.8517,-5287.7666 1052.1962,-5308.747 1059.5131,-5282.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M635.6083,-5920.8986C669.6707,-5925.8038 715.611,-5929.0563 755.1332,-5920.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-5920.2164C960.2164,-5874.3455 765.1265,-5647.8022 855.7932,-5458.2164 871.726,-5424.9007 886.0288,-5423.3202 911.1119,-5396.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1059.5131,-5282.2164C1073.1189,-5232.8826 1101.8853,-5231.2322 1116.5955,-5182.2164 1134.4541,-5122.7095 1113.8524,-4672.7857 1152.5955,-4624.2164 1155.144,-4621.0214 1158.0818,-4618.2214 1161.2994,-4615.7686"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1163.2484,-4618.6771 1169.8115,-4610.3599 1159.4942,-4612.7689 1163.2484,-4618.6771"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge162" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~dataglobalconstants.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M589.0745,-5922.2963C600.9342,-5962.0932 640.8926,-6101.7338 654.4731,-6220.2164 660.591,-6273.5914 659.8908,-10044.0457 690.4731,-10088.2164 692.6569,-10091.3705 695.2994,-10094.1267 698.2523,-10096.5353"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="696.4245,-10099.5228 706.6927,-10102.1333 700.2936,-10093.6892 696.4245,-10099.5228"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge236" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5920.2164C806.0796,-5910.0643 933.7394,-5979.8446 966.4307,-6020.2164 1010.1199,-6074.1701 955.5664,-6120.9963 1002.4307,-6172.2164 1038.5296,-6211.6706 1084.2498,-6167.6308 1116.5955,-6210.2164 1214.0298,-6338.4965 1072.3699,-6794.5271 1152.5955,-6934.2164 1341.4331,-7263.0217 1623.8851,-7109.4257 1867.2231,-7400.2164 1893.5522,-7431.6797 1872.1199,-7458.4629 1903.2231,-7485.2164 2002.4333,-7570.5519 2057.7692,-7551.7121 2188.4692,-7558.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge210" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1236.8123,-7224.2164C1256.1245,-7266.4931 1283.8286,-7258.3522 1321.0291,-7286.2164 1492.404,-7414.581 1550.725,-7428.9314 1704.2205,-7578.2164 1786.9202,-7658.6476 1795.9201,-7689.5285 1867.2231,-7780.2164 1883.4864,-7800.901 1881.4237,-7812.481 1903.2231,-7827.2164 1936.1581,-7849.4789 1961.8308,-7822.5647 1989.3882,-7851.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-5920.2164C795.7115,-5912.0937 791.2997,-5957.2047 819.7932,-5987.2164 885.5335,-6056.4592 910.5414,-6066.8035 966.4307,-6144.2164 985.9892,-6171.3071 980.5934,-6184.9265 1002.4307,-6210.2164 1043.9478,-6258.2976 1086.959,-6240.0278 1116.5955,-6296.2164 1198.5823,-6451.6574 1101.2096,-6918.1591 1152.5955,-7086.2164 1173.6051,-7154.9285 1208.5237,-7158.167 1236.8123,-7224.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge282" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1989.3882,-2020.2164C2014.9804,-2059.8509 2049.1629,-2043.1087 2075.5532,-2082.2164 2113.1784,-2137.9729 2064.0381,-2181.6059 2111.5532,-2229.2164 2136.4272,-2254.1403 2157.9726,-2230.6133 2188.4692,-2248.2164"/>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M755.1332,-4142.2164C777.7275,-3961.7848 798.0927,-3918.7576 819.7932,-3738.2164 843.5256,-3540.7706 798.3715,-3482.6128 855.7932,-3292.2164 885.1248,-3194.96 934.2352,-3188.5626 966.4307,-3092.2164 1002.8458,-2983.2424 982.5783,-2949.3856 1002.4307,-2836.2164 1044.9656,-2593.7442 1084.177,-2538.2472 1116.5955,-2294.2164 1125.9164,-2224.053 1117.6785,-1719.7841 1152.5955,-1658.2164 1255.7812,-1476.2728 1342.2386,-1455.5836 1542.2007,-1394.2164 1611.0406,-1373.0898 1635.3014,-1373.3494 1704.2205,-1394.2164 1722.625,-1399.7888 1724.1132,-1407.7124 1740.2205,-1418.2164 1796.2984,-1454.7864 1832.5627,-1441.9384 1867.2231,-1499.2164 1915.8352,-1579.5501 1866.8084,-1833.6681 1903.2231,-1920.2164 1925.9753,-1974.2922 1957.5641,-1970.9306 1989.3882,-2020.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge623" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M587.134,-5922.2939C595.5959,-5989.1498 639.6451,-6345.7338 654.4731,-6638.2164 668.9065,-6922.9133 646.0068,-11487.6433 690.4731,-11769.2164 720.2119,-11957.5305 787.1523,-11990.3835 819.7932,-12178.2164 855.9636,-12386.3596 796.8838,-12925.3332 855.7932,-13128.2164 883.0413,-13222.0583 937.5711,-13224.8574 966.4307,-13318.2164 1031.8379,-13529.8051 962.0893,-13597.4539 1002.4307,-13815.2164 1034.3204,-13987.3571 1084.6681,-14020.0826 1116.5955,-14192.2164 1156.7419,-14408.6625 1086.3304,-14476.2888 1152.5955,-14686.2164 1205.9012,-14855.0889 1265.8251,-14876.4229 1357.0291,-15028.2164 1423.0784,-15138.1443 1466.268,-15153.3475 1506.2007,-15275.2164 1533.9218,-15359.8173 1497.6707,-15597.1265 1542.2007,-15674.2164 1586.2409,-15750.4583 1656.5962,-15714.1602 1704.2205,-15788.2164 1751.1809,-15861.2403 1681.3068,-15916.4436 1740.2205,-15980.2164 1966.2959,-16224.938 2145.7032,-16187.3824 2474.269,-16132.2164 2799.0499,-16077.6859 2854.2959,-15966.6807 3174.6229,-15890.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~faultsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge294" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~faultsmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M587.1362,-5922.2938C595.6107,-5989.1491 639.7208,-6345.73 654.4731,-6638.2164 685.4815,-7253.0034 644.1917,-11564.3901 690.4731,-12178.2164 728.9653,-12688.7339 767.8216,-12813.8645 855.7932,-13318.2164 898.0389,-13560.416 928.5514,-13617.2955 966.4307,-13860.2164 989.2979,-14006.8647 981.7716,-14045.2407 1002.4307,-14192.2164 1079.1212,-14737.8199 1208.0219,-15400.9153 1232.6706,-15526.2484"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1229.2462,-15526.974 1234.6132,-15536.1089 1236.1142,-15525.6209 1229.2462,-15526.974"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge336" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2982.9529,-1638.2164C3067.7067,-1646.7933 3101.2443,-1594.9457 3174.6229,-1638.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3174.6229,-1638.2164C3208.3604,-1658.111 3233.1693,-1633.1458 3259.4165,-1662.2164 3321.4085,-1730.8766 3268.8438,-1778.6098 3295.4165,-1867.2164 3316.4265,-1937.2742 3331.2657,-1951.3243 3360.8456,-2018.2164"/>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M586.2412,-5900.1946C594.1639,-5732.9122 689.6269,-3717.5009 690.4731,-3710.2164 767.9333,-3043.4012 866.4525,-2889.0287 966.4307,-2225.2164 987.1539,-2087.623 962.6772,-2047.562 1002.4307,-1914.2164 1034.8079,-1805.613 1083.1729,-1794.5026 1116.5955,-1686.2164 1151.7796,-1572.2226 1092.6788,-1523.3788 1152.5955,-1420.2164 1179.9676,-1373.0879 1490.9891,-1140.8629 1542.2007,-1122.2164 1677.9895,-1072.7747 1723.9998,-1093.9767 1867.2231,-1113.2164 1962.3628,-1125.9968 2012.1321,-1098.1562 2075.5532,-1170.2164 2151.4631,-1256.4665 2037.1813,-1338.6367 2111.5532,-1426.2164 2157.9127,-1480.8088 2209.7143,-1429.1577 2265.3853,-1474.2164 2290.753,-1494.7484 2274.4876,-1519.7339 2301.3853,-1538.2164 2317.156,-1549.0531 2963.915,-1636.2898 2982.9529,-1638.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge363" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M587.1315,-5922.294C595.5786,-5989.1507 639.5565,-6345.7383 654.4731,-6638.2164 681.2034,-7162.3282 645.8982,-10838.3198 690.4731,-11361.2164 720.6556,-11715.2779 765.1204,-11799.1018 819.7932,-12150.2164 836.6589,-12258.5296 839.3074,-12285.8447 855.7932,-12394.2164 903.5589,-12708.2113 931.2657,-12784.5618 966.4307,-13100.2164 993.1111,-13339.711 951.7327,-13405.6336 1002.4307,-13641.2164 1042.5565,-13827.6726 1077.0578,-13868.0877 1152.5955,-14043.2164 1372.6739,-14553.4522 1503.4103,-14647.0944 1704.2205,-15165.2164 1724.9589,-15218.7248 1696.5517,-15251.9837 1740.2205,-15289.2164 1825.1394,-15361.6195 1877.7932,-15320.2164 1989.3882,-15320.2164 1989.3882,-15320.2164 1989.3882,-15320.2164 2387.8271,-15320.2164 2606.5694,-15320.2164 2726.9743,-15418.2686 2876.0764,-15258.2164 2925.2297,-15205.4532 2873.3407,-14671.0402 2912.0764,-14610.2164 2950.4759,-14549.9206 3015.7193,-14594.6955 3053.8293,-14534.2164 3127.5614,-14417.2065 3169.8863,-12169.2108 3174.2483,-11926.4226"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3177.7482,-11926.4543 3174.4273,-11916.3934 3170.7493,-11926.3294 3177.7482,-11926.4543"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge450" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M755.1332,-4142.2164C777.7275,-3961.7848 800.3396,-3919.0135 819.7932,-3738.2164 850.5565,-3452.3101 783.6133,-3370.5666 855.7932,-3092.2164 884.0655,-2983.1887 937.7549,-2973.1386 966.4307,-2864.2164 1031.0561,-2618.7427 957.6195,-2544.0678 1002.4307,-2294.2164 1033.5618,-2120.6397 1083.8865,-2087.5026 1116.5955,-1914.2164 1134.8742,-1817.3789 1090.9126,-1549.0723 1152.5955,-1472.2164 1201.6336,-1411.1155 1249.5599,-1452.3132 1321.0291,-1420.2164 1565.2489,-1310.5371 1660.5411,-996.0534 1867.2231,-1166.2164 1931.5538,-1219.1803 1864.4458,-1276.4605 1903.2231,-1350.2164 1954.1683,-1447.1158 2020.7285,-1431.4579 2075.5532,-1526.2164 2105.1481,-1577.368 2075.2819,-1607.5609 2111.5532,-1654.2164 2117.5234,-1661.8957 2709.6659,-1999.5009 2718.1736,-2004.2164 2787.6999,-2042.7517 2806.24,-2050.2459 2876.0764,-2088.2164 2892.1566,-2096.9593 2895.1095,-2101.3508 2912.0764,-2108.2164 3063.4775,-2169.4804 3166.5529,-2093.8589 3259.4165,-2228.2164 3321.6544,-2318.2638 3270.5565,-4091.614 3295.4165,-4198.2164 3305.9365,-4243.3273 3332.2956,-4291.2038 3348.1614,-4317.3319"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3345.2436,-4319.2682 3353.4832,-4325.9286 3351.1955,-4315.5837 3345.2436,-4319.2682"/>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M586.0751,-5900.0377C590.4817,-5763.0255 635.2712,-4409.7289 690.4731,-4242.2164 707.0381,-4191.9494 748.7451,-4194.7555 755.1332,-4142.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge515" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M755.1332,-10074.2164C762.0052,-10103.3702 800.719,-10070.1221 819.7932,-10093.2164 873.1045,-10157.7636 835.4925,-10386.9986 855.7932,-10468.2164 886.8422,-10592.4354 938.0135,-10609.369 966.4307,-10734.2164 1032.9099,-11026.2848 973.8512,-11109.0442 1002.4307,-11407.2164 1037.7063,-11775.2502 1077.5497,-11863.5634 1116.5955,-12231.2164 1128.0325,-12338.9066 1096.8319,-12624.3809 1152.5955,-12717.2164 1287.7563,-12942.233 1448.9698,-12989.4379 1704.2205,-12928.2164 1978.0176,-12862.5465 2082.4593,-12848.2619 2265.3853,-12634.2164 2295.8026,-12598.6244 2273.1004,-12572.5254 2301.3853,-12535.2164 2329.9481,-12497.5406 2373.0646,-12518.1315 2387.8271,-12473.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge541" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M587.1207,-5922.2946C595.5049,-5989.1545 639.1789,-6345.7578 654.4731,-6638.2164 695.4188,-7421.1873 623.8052,-9385.0151 690.4731,-10166.2164 710.073,-10395.8836 788.2028,-10969.8468 855.7932,-11190.2164 889.9981,-11301.7371 939.9848,-11314.6054 966.4307,-11428.2164 1047.9167,-11778.2799 943.3673,-12690.6801 1002.4307,-13045.2164 1029.944,-13210.3694 1069.6423,-13243.5057 1116.5955,-13404.2164 1134.0096,-13463.8213 1124.7311,-13483.7225 1152.5955,-13539.2164 1218.2444,-13669.9607 1248.0271,-13699.6334 1357.0291,-13797.2164 1429.3839,-13861.9913 1448.8644,-13886.3954 1542.2007,-13913.2164 1619.7087,-13935.489 1945.8914,-13923.8771 2075.5532,-13897.2164 2280.659,-13855.0431 2372.4501,-13829.1915 2474.269,-13646.2164 2525.2203,-13554.6537 2458.4918,-13504.3145 2510.269,-13413.2164 2534.7526,-13370.1394 2564.6244,-13380.3832 2596.2213,-13342.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge559" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M587.1311,-5922.294C595.576,-5989.1509 639.5428,-6345.739 654.4731,-6638.2164 657.7771,-6702.9396 659.6404,-11247.2133 690.4731,-11304.2164 723.3121,-11364.9287 785.4819,-11330.3238 819.7932,-11390.2164 854.977,-11451.632 848.3277,-11955.8314 855.7932,-12026.2164 889.4316,-12343.362 934.7247,-12417.8717 966.4307,-12735.2164 984.3651,-12914.7224 944.1229,-13375.4995 1002.4307,-13546.2164 1030.9002,-13629.5712 1081.8374,-13627.2818 1116.5955,-13708.2164 1148.7893,-13783.1801 1122.6193,-13812.3386 1152.5955,-13888.2164 1165.2053,-13920.1353 1771.7535,-14925.7322 1803.7218,-14938.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1989.3882,-15054.2164C2077.7765,-15050.1783 2100.057,-15050.7429 2188.4692,-15054.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1803.7218,-14938.2164C1895.3675,-14970.9017 1892.1897,-15058.6569 1989.3882,-15054.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge581" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1431.6149,-7047.2164C1576.0556,-7053.9093 1597.836,-6969.4073 1740.2205,-6944.2164 1849.3112,-6924.9158 1879.6343,-6922.137 1989.3882,-6937.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M755.1332,-5920.2164C801.3811,-5910.503 931.8748,-5911.9811 966.4307,-5944.2164 1030.8752,-6004.3331 943.2666,-6073.8962 1002.4307,-6139.2164 1037.8877,-6178.3628 1083.5657,-6131.0013 1116.5955,-6172.2164 1197.63,-6273.3327 1101.3007,-6635.2207 1152.5955,-6754.2164 1195.966,-6854.8291 1257.9403,-6844.6411 1321.0291,-6934.2164 1341.1739,-6962.8186 1332.8917,-6978.8927 1357.0291,-7004.2164 1383.429,-7031.9139 1394.3851,-7038.3816 1431.6149,-7047.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge438" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-4256.2164C763.2761,-4203.9205 803.633,-4206.615 819.7932,-4156.2164 924.6708,-3829.1355 753.8407,-3712.2208 855.7932,-3384.2164 883.4412,-3295.2666 936.2029,-3294.3229 966.4307,-3206.2164 1016.0295,-3061.6482 965.6638,-3012.568 1002.4307,-2864.2164 1035.2552,-2731.7719 1087.958,-2712.6288 1116.5955,-2579.2164 1136.6442,-2485.8157 1110.069,-1805.7567 1152.5955,-1720.2164 1195.8033,-1633.3055 1246.5393,-1643.4394 1321.0291,-1581.2164 1419.8213,-1498.6928 1421.3216,-1438.4691 1542.2007,-1394.2164 1684.7536,-1342.029 1750.3025,-1402.3948 1867.2231,-1499.2164 2083.0006,-1677.9009 2101.2375,-1760.1834 2301.3853,-1956.2164 2464.9629,-2116.4311 2538.6871,-2124.7842 2682.1736,-2303.2164 2889.5065,-2561.0446 2958.8298,-2631.2977 3053.8293,-2948.2164 3092.3105,-3076.5896 3076.3642,-3416.8778 3089.8293,-3550.2164 3112.6116,-3775.8178 3157.8168,-4047.1558 3170.9596,-4124.0143"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3167.5176,-4124.651 3172.6595,-4133.9144 3174.4166,-4123.4663 3167.5176,-4124.651"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.1092,-5900.1729C590.3472,-5781.8132 628.8986,-4745.9977 690.4731,-4444.2164 708.1378,-4357.6407 741.6032,-4343.5338 755.1332,-4256.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge411" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.386,-5900.0997C593.6792,-5779.0237 658.9531,-4708.5618 690.4731,-4650.2164 725.1362,-4586.0531 769.4882,-4602.0165 819.7932,-4549.2164 838.9314,-4529.1289 837.643,-4519.2009 855.7932,-4498.2164 900.1411,-4446.9431 921.0921,-4443.6158 966.4307,-4393.2164 984.0283,-4373.6544 984.4462,-4365.4233 1002.4307,-4346.2164 1048.5341,-4296.979 1084.8303,-4305.7212 1116.5955,-4246.2164 1175.0593,-4136.6978 1083.116,-4072.0995 1152.5955,-3969.2164 1156.0695,-3964.0721 1536.4518,-3752.558 1542.2007,-3750.2164 1626.5762,-3715.848 1651.4652,-3717.7812 1740.2205,-3697.2164 1812.1435,-3680.5516 1829.8605,-3673.497 1903.2231,-3665.2164 1956.7539,-3659.1742 2339.0878,-3627.2702 2387.8271,-3650.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge379" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.1647,-5900.0813C590.7523,-5787.1856 630.454,-4851.6632 690.4731,-4745.2164 725.5006,-4683.0936 773.5167,-4704.4809 819.7932,-4650.2164 842.4939,-4623.5972 833.149,-4606.8836 855.7932,-4580.2164 895.4095,-4533.5617 920.6233,-4538.8093 966.4307,-4498.2164 983.8423,-4482.7868 986.1979,-4476.8817 1002.4307,-4460.2164 1052.4629,-4408.8508 1085.1493,-4410.6585 1116.5955,-4346.2164 1174.327,-4227.9081 1070.434,-4155.072 1152.5955,-4052.2164 1233.882,-3950.456 1611.7849,-3945.9679 1704.2205,-3854.2164 1737.1528,-3821.5277 1704.2762,-3785.5608 1740.2205,-3756.2164 1818.2657,-3692.5013 2099.3017,-3641.3143 2188.4692,-3688.2164"/>
</g>
<!-- sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge488" class="edge">
<title>sourcefile~inputprocessor.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-10074.2164C762.2471,-10103.3121 801.18,-10069.749 819.7932,-10093.2164 864.1216,-10149.1055 840.3181,-10664.5807 855.7932,-10734.2164 884.4626,-10863.2244 939.4876,-10880.8367 966.4307,-11010.2164 1021.9537,-11276.8362 969.2475,-11964.9058 1002.4307,-12235.2164 1031.4197,-12471.3617 1067.8939,-12525.3363 1116.5955,-12758.2164 1133.2957,-12838.0731 1124.4932,-12861.6248 1152.5955,-12938.2164 1217.1767,-13114.2297 1241.686,-13159.4077 1357.0291,-13307.2164 1426.3181,-13396.0081 1441.3446,-13430.0867 1542.2007,-13480.2164 1574.92,-13496.4792 1587.2311,-13487.8514 1623.2106,-13494.2164"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge36" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2190.972,-8832.2916C2200.9943,-8876.8132 2238.963,-9047.1246 2265.3853,-9188.2164 2283.4611,-9284.7395 2279.3606,-9310.517 2301.3853,-9406.2164 2325.017,-9508.8989 2364.459,-9628.681 2380.6036,-9676.2278"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2377.3904,-9677.6489 2383.9338,-9685.9816 2384.0149,-9675.3871 2377.3904,-9677.6489"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge243" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2797.125,-10915.2164C2815.9294,-11014.8346 2851.3318,-11030.9051 2876.0764,-11129.2164 2904.1209,-11240.6385 2895.7016,-11271.4919 2912.0764,-11385.2164 2937.663,-11562.917 2969.6586,-11777.3685 2979.7512,-11844.8364"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2976.3357,-11845.6625 2981.2774,-11855.0343 2983.2586,-11844.6264 2976.3357,-11845.6625"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2235.3605,-8827.9731C2246.5707,-8831.6825 2257.5465,-8837.4036 2265.3853,-8846.2164 2319.6067,-8907.1757 2261.7257,-8954.9204 2301.3853,-9026.2164 2352.5731,-9118.2368 2429.3295,-9092.9882 2474.269,-9188.2164 2527.6783,-9301.3919 2441.1174,-9645.9126 2510.269,-9750.2164 2557.4751,-9821.4189 2633.477,-9766.0249 2682.1736,-9836.2164 2819.6253,-10034.34 2752.3972,-10678.2663 2797.125,-10915.2164"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge735" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2201.8321,-8810.0421C2222.7708,-8792.6255 2264.7138,-8758.1098 2301.3853,-8730.2164 2429.8441,-8632.5067 2515.7944,-8658.1462 2596.2213,-8518.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2596.2213,-8518.2164C2618.2063,-8476.5596 2658.7927,-8497.106 2682.1736,-8456.2164 2744.9015,-8346.5146 2789.3695,-7398.2822 2796.2072,-7244.3038"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2799.706,-7244.406 2796.6495,-7234.2616 2792.7128,-7244.0979 2799.706,-7244.406"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge770" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2387.8271,-9012.2164C2478.4668,-9031.265 2519.6473,-8960.1125 2596.2213,-9012.2164"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge826" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M2190.0773,-8832.4407C2199.4858,-8898.6837 2247.5989,-9245.3834 2265.3853,-9530.2164 2280.345,-9769.7831 2253.8224,-11454.9425 2301.3853,-11690.2164 2316.6062,-11765.508 2357.209,-11848.0899 2376.8642,-11885.203"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2373.7861,-11886.8691 2381.5986,-11894.0256 2379.9542,-11883.5591 2373.7861,-11886.8691"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge855" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2189.9403,-8809.807C2198.9514,-8739.3603 2246.9136,-8356.2838 2265.3853,-8042.2164 2290.01,-7623.5303 2236.6963,-6569.6072 2301.3853,-6155.2164 2317.5682,-6051.55 2361.3649,-5933.1385 2379.6422,-5886.5543"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2382.8971,-5887.8408 2383.3282,-5877.2548 2376.3896,-5885.2614 2382.8971,-5887.8408"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge565" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2192.8882,-8809.8041C2223.4533,-8730.2726 2404.2933,-8249.9798 2474.269,-7841.2164 2498.6791,-7698.6248 2466.8863,-7329.2241 2510.269,-7191.2164 2525.0992,-7144.0392 2559.5786,-7096.6691 2580.0765,-7071.2378"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2582.8008,-7073.4354 2586.4433,-7063.4864 2577.3915,-7068.9924 2582.8008,-7073.4354"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge418" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-9012.2164C2620.8877,-9061.1958 2833.862,-8292.5967 2876.0764,-8058.2164 2926.7922,-7776.6353 2877.0293,-7055.1736 2912.0764,-6771.2164 2947.8168,-6481.6417 3019.315,-6419.9397 3053.8293,-6130.2164 3078.097,-5926.5067 3032.4198,-4481.17 3089.8293,-4284.2164 3103.617,-4236.9152 3137.9364,-4189.5899 3158.4383,-4164.1999"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.1555,-4166.4061 3164.8117,-4156.4621 3155.7524,-4161.9556 3161.1555,-4166.4061"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2235.3378,-8824.0002C2246.0358,-8826.4367 2256.7757,-8830.513 2265.3853,-8837.2164 2294.2437,-8859.6856 2281.3315,-8880.63 2301.3853,-8911.2164 2333.7815,-8960.6278 2329.6462,-9001.9216 2387.8271,-9012.2164"/>
</g>
<!-- sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge390" class="edge">
<title>sourcefile~globalnames.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2235.1095,-8810.3592C2337.9245,-8783.6241 2582.8029,-8703.9226 2682.1736,-8532.2164 3045.7214,-7904.0292 2806.3226,-5992.2709 2912.0764,-5274.2164 2925.0183,-5186.3429 2959.5081,-5085.7684 2975.1025,-5043.1001"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.451,-5044.136 2978.6355,-5033.5428 2971.8852,-5041.7089 2978.451,-5044.136"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge39" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1444.8083,-3736.3101C1472.9454,-3759.9364 1536.7386,-3813.315 1542.2007,-3816.2164 1575.3637,-3833.832 1603.2582,-3808.4045 1623.2106,-3840.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3840.2164C1676.1439,-3924.6126 1684.4555,-3951.5741 1704.2205,-4049.2164 1757.7234,-4313.5299 1703.054,-4995.1155 1740.2205,-5262.2164 1772.0572,-5491.0144 1837.0261,-5537.1962 1867.2231,-5766.2164 1935.3809,-6283.137 1847.2055,-7593.8396 1903.2231,-8112.2164 1953.3083,-8575.6946 1964.0197,-8698.001 2111.5532,-9140.2164 2185.4529,-9361.7224 2331.7351,-9606.6053 2375.3017,-9677.1887"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2372.5037,-9679.318 2380.7492,-9685.971 2378.4523,-9675.6281 2372.5037,-9679.318"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge61" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1480.9353,-3726.2651C1490.6693,-3728.8475 1499.8307,-3733.4235 1506.2007,-3741.2164 1563.4622,-3811.2688 1500.0713,-6918.1456 1542.2007,-6998.2164 1583.1985,-7076.1365 1662.3054,-7034.7857 1704.2205,-7112.2164 1759.1579,-7213.7036 1730.1362,-8035.2551 1740.2205,-8150.2164 1785.4833,-8666.2151 1694.6187,-8830.0987 1903.2231,-9304.2164 2005.2255,-9536.048 2175.0413,-9507.5977 2265.3853,-9744.2164 2335.3561,-9927.476 2260.0436,-10434.4591 2301.3853,-10626.2164 2344.6219,-10826.7632 2423.8837,-10855.3451 2474.269,-11054.2164 2509.3102,-11192.5242 2469.4361,-11236.5064 2510.269,-11373.2164 2527.5098,-11430.939 2563.733,-11492.5878 2583.1958,-11523.3506"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2580.3134,-11525.3396 2588.6583,-11531.8675 2586.2056,-11521.5604 2580.3134,-11525.3396"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge246" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1480.927,-3726.2719C1490.6614,-3728.8539 1499.8251,-3733.4281 1506.2007,-3741.2164 1556.9147,-3803.1678 1525.3451,-6544.949 1542.2007,-6623.2164 1580.081,-6799.1103 1664.0319,-6818.8354 1704.2205,-6994.2164 1750.317,-7195.3798 1684.4776,-7723.5097 1740.2205,-7922.2164 1771.5506,-8033.8989 1833.6652,-8039.183 1867.2231,-8150.2164 1926.0387,-8344.8198 1847.5404,-8410.6935 1903.2231,-8606.2164 1958.5569,-8800.5138 2006.2081,-8837.8339 2111.5532,-9010.2164 2256.027,-9246.6274 2377.3529,-9257.6589 2474.269,-9517.2164 2534.0754,-9677.3876 2485.3042,-9731.0763 2510.269,-9900.2164 2578.3966,-10361.7904 2573.4446,-10485.6564 2718.1736,-10929.2164 2770.2312,-11088.7607 2825.724,-11112.1257 2876.0764,-11272.2164 2944.5446,-11489.9043 2973.8682,-11767.1123 2981.0966,-11845.0154"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2977.616,-11845.3892 2982.0048,-11855.0323 2984.5875,-11844.7571 2977.616,-11845.3892"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge664" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1431.8246,-3713.9082C1434.1642,-3592.7199 1456.9235,-2532.348 1542.2007,-2230.2164 1584.8584,-2079.0829 1648.8019,-2063.1511 1704.2205,-1916.2164 1727.501,-1854.4911 1724.1905,-1836.2089 1740.2205,-1772.2164 1761.7821,-1686.1409 1787.5388,-1583.6121 1798.437,-1540.2436"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1801.8898,-1540.8643 1800.9327,-1530.3128 1795.1009,-1539.1582 1801.8898,-1540.8643"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge775" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1623.2106,-3764.2164C1755.4094,-3772.0188 1812.7455,-3814.5118 1867.2231,-3935.2164 1904.8088,-4018.494 1845.6054,-7153.3076 1903.2231,-7224.2164 1927.9533,-7254.6512 1966.0147,-7211.7277 1989.3882,-7243.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1989.3882,-7243.2164C2000.9623,-7258.7842 2056.7583,-7252.4136 2075.5532,-7257.2164 2260.8738,-7304.5726 2368.1456,-7260.0808 2474.269,-7419.2164 2542.9177,-7522.1572 2441.0775,-8429.6397 2510.269,-8532.2164 2556.9829,-8601.4697 2634.5357,-8539.5954 2682.1736,-8608.2164 2759.3583,-8719.3988 2655.8865,-9096.0526 2718.1736,-9216.2164 2728.6192,-9236.368 2748.6856,-9252.2474 2765.9735,-9263.0231"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2764.3073,-9266.1041 2774.695,-9268.1885 2767.8744,-9260.0811 2764.3073,-9266.1041"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge860" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1461.7841,-3736.2678C1499.2307,-3748.839 1565.2442,-3767.2639 1623.2106,-3764.2164"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1623.2106,-3764.2164C1731.6891,-3758.5132 1788.898,-3674.9482 1867.2231,-3750.2164 1939.7048,-3819.869 1855.6094,-4565.6838 1903.2231,-4654.2164 1925.5697,-4695.7674 1978.8838,-4670.2216 1989.3882,-4716.2164"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge135" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1440.8403,-3736.2439C1455.7029,-3754.3134 1485.3841,-3791.6788 1506.2007,-3826.2164 1553.7629,-3905.1285 1597.3402,-4006.2998 1614.9574,-4048.8875"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1611.7376,-4050.2605 1618.7734,-4058.1818 1618.213,-4047.6017 1611.7376,-4050.2605"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge221" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-7243.2164C2012.2368,-7274.5725 2044.2333,-7234.3181 2075.5532,-7257.2164 2104.1142,-7278.0976 2088.9544,-7300.9942 2111.5532,-7328.2164 2166.5921,-7394.5155 2198.0842,-7392.4073 2265.3853,-7446.2164 2301.5325,-7475.1171 2342.7192,-7509.7995 2366.9259,-7530.368"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2364.8601,-7533.2059 2374.7438,-7537.0221 2369.3972,-7527.8753 2364.8601,-7533.2059"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge270" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~setpointmanager.f90</title>
<path fill="none" stroke="#ffff00" stroke-dasharray="5,2" d="M1435.7762,-3713.9912C1467.67,-3628.3521 1678.1717,-3070.1049 1903.2231,-2642.2164 1984.6639,-2487.3736 1994.4899,-2438.2358 2111.5532,-2308.2164 2140.563,-2275.996 2150.0739,-2228.0789 2188.4692,-2248.2164"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge596" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1432.6444,-3714.0682C1441.43,-3619.3084 1504.397,-2947.5849 1542.2007,-2748.2164 1593.9792,-2475.1474 1640.3385,-2414.71 1704.2205,-2144.2164 1722.5717,-2066.5121 1713.8084,-2043.563 1740.2205,-1968.2164 1848.539,-1659.212 1971.688,-1622.746 2075.5532,-1312.2164 2105.0352,-1224.0731 2066.2071,-1187.3468 2111.5532,-1106.2164 2166.5214,-1007.8707 2196.0314,-978.1404 2301.3853,-938.2164 2373.2364,-910.9882 2398.2689,-926.9053 2474.269,-938.2164 2564.4664,-951.6404 3197.8333,-1109.961 3259.4165,-1177.2164 3311.866,-1234.4968 3237.7311,-1296.2125 3295.4165,-1348.2164 3333.576,-1382.6175 3500.1191,-1327.4692 3525.3633,-1372.2164"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge315" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M1433.8824,-3714.0313C1443.4356,-3666.7019 1481.0694,-3478.1651 1506.2007,-3322.2164 1524.9009,-3206.175 1506.2992,-3172.1377 1542.2007,-3060.2164 1589.4448,-2912.9349 1662.393,-2901.1267 1704.2205,-2752.2164 1738.3625,-2630.6667 1675.8151,-2293.8071 1740.2205,-2185.2164 1741.5866,-2182.913 1900.726,-2083.1839 1903.2231,-2082.2164 1990.911,-2048.2403 2018.4381,-2058.3734 2111.5532,-2045.2164 2195.5555,-2033.3469 2216.8445,-2032.2973 2301.3853,-2025.2164 2394.0775,-2017.4527 2417.3121,-2015.5538 2510.269,-2012.2164 2751.6975,-2003.5484 2812.3774,-2002.2296 3053.8293,-2010.2164 3107.6036,-2011.9951 3120.8232,-2017.5709 3174.6229,-2018.2164"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge347" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1480.927,-3726.2719C1490.6614,-3728.8539 1499.8251,-3733.4281 1506.2007,-3741.2164 1556.9147,-3803.1678 1525.4985,-6544.9161 1542.2007,-6623.2164 1580.0765,-6800.7789 1660.0632,-6822.1108 1704.2205,-6998.2164 1750.8639,-7184.2375 1688.9127,-7243.4274 1740.2205,-7428.2164 1785.2964,-7590.5608 2017.271,-7950.1318 2075.5532,-8108.2164 2098.0751,-8169.3047 2085.5381,-8190.532 2111.5532,-8250.2164 2161.8791,-8365.6749 2212.3131,-8373.9942 2265.3853,-8488.2164 2288.4896,-8537.9417 2272.3993,-8559.6735 2301.3853,-8606.2164 2357.051,-8695.5992 2400.4815,-8693.0941 2474.269,-8768.2164 2671.8632,-8969.3847 2762.1187,-9001.2905 2876.0764,-9259.2164 3042.4396,-9635.7539 3009.7412,-9758.9323 3053.8293,-10168.2164 3063.792,-10260.7028 3047.1504,-11759.5634 3089.8293,-11842.2164 3100.6036,-11863.0821 3121.8136,-11878.836 3140.3242,-11889.3715"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3138.6738,-11892.4579 3149.1369,-11894.1238 3141.9964,-11886.2967 3138.6738,-11892.4579"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge423" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1440.0065,-3713.9149C1487.6511,-3651.2142 1731.1497,-3350.1224 1989.3882,-3384.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-3384.2164C2403.0761,-3402.1467 2550.0415,-3414.951 2876.0764,-3670.2164 2958.8386,-3735.0141 2993.9399,-3739.836 3053.8293,-3826.2164 3122.9742,-3925.946 3158.8218,-4070.4187 3170.3737,-4124.0981"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3166.9982,-4125.0553 3172.4733,-4134.1258 3173.8496,-4123.6208 3166.9982,-4125.0553"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge393" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-3384.2164C2201.3628,-3404.2659 2198.2482,-3553.2882 2387.8271,-3650.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2387.8271,-3650.2164C2430.8382,-3670.4657 2436.0431,-3684.9539 2474.269,-3713.2164 2490.3509,-3725.1065 2492.3293,-3731.3751 2510.269,-3740.2164 2545.8455,-3757.7495 2570.6088,-3733.9328 2596.2213,-3764.2164"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge475" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1433.6668,-3736.3918C1444.0095,-3793.3372 1490.5469,-4057.0397 1506.2007,-4275.2164 1540.0279,-4746.688 1495.0888,-8058.8864 1542.2007,-8529.2164 1579.9658,-8906.235 1665.4996,-8989.2947 1704.2205,-9366.2164 1719.3235,-9513.234 1679.0925,-11891.6592 1740.2205,-12026.2164 1771.5928,-12095.2743 1832.9589,-12072.5467 1867.2231,-12140.2164 1924.7078,-12253.7448 1979.6483,-13205.5229 1988.2295,-13360.0543"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1984.7399,-13360.3405 1988.786,-13370.1323 1991.7292,-13359.9545 1984.7399,-13360.3405"/>
</g>
<!-- sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge758" class="edge">
<title>sourcefile~curvemanager.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-3840.2164C1676.5408,-3924.3624 1684.8971,-3951.4858 1704.2205,-4049.2164 1741.8361,-4239.4635 1725.4807,-5600.8472 1740.2205,-5794.2164 1772.9321,-6223.3556 1836.3562,-6324.9405 1867.2231,-6754.2164 1891.0676,-7085.8287 1838.0173,-9420.2049 1903.2231,-9746.2164 1943.4413,-9947.2964 2003.0284,-9982.407 2075.5532,-10174.2164 2117.8411,-10286.0568 2164.2583,-10421.6907 2181.5111,-10472.5975"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2178.2178,-10473.7846 2184.7381,-10482.1354 2184.8486,-10471.5411 2178.2178,-10473.7846"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge41" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1303.8562,-11200.1072C1310.4427,-11196.6086 1316.3908,-11192.0761 1321.0291,-11186.2164 1408.3365,-11075.9165 1293.6855,-10679.8199 1357.0291,-10554.2164 1376.4396,-10515.7273 1397.3796,-10518.4104 1431.6149,-10492.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-10492.2164C1602.9275,-10361.142 1693.1786,-10405.6409 1867.2231,-10278.2164 2073.7224,-10127.0306 2112.9693,-10067.8093 2265.3853,-9862.2164 2284.8212,-9835.9994 2282.6857,-9824.9635 2301.3853,-9798.2164 2322.7715,-9767.6263 2351.6335,-9735.3792 2369.9917,-9715.7761"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2372.6089,-9718.1024 2376.9346,-9708.4309 2367.5218,-9713.2939 2372.6089,-9718.1024"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge63" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1251.3601,-11222.3415C1271.2494,-11238.5293 1306.1545,-11270.6626 1321.0291,-11307.2164 1378.1482,-11447.5844 1269.3377,-11864.6202 1357.0291,-11988.2164 1408.5061,-12060.7705 1454.9215,-12047.0021 1542.2007,-12064.2164 1684.8902,-12092.3593 1731.4845,-12078.4402 1867.2231,-12026.2164 2155.0263,-11915.4876 2236.8128,-11886.9548 2474.269,-11690.2164 2521.013,-11651.4879 2563.2652,-11592.9794 2583.5472,-11562.7836"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2586.5127,-11564.6445 2589.1169,-11554.3747 2580.6767,-11560.779 2586.5127,-11564.6445"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge249" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2387.8271,-13304.2164C2468.0584,-13353.9914 2721.9654,-13475.3622 2797.125,-13418.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1251.3777,-11222.3344C1271.2881,-11238.5136 1306.2179,-11270.6369 1321.0291,-11307.2164 1381.9024,-11457.5574 1293.3666,-11887.035 1357.0291,-12036.2164 1379.8352,-12089.6583 2038.6305,-12751.3513 2075.5532,-12796.2164 2167.8463,-12908.3624 2190.1997,-12937.951 2265.3853,-13062.2164 2327.7837,-13165.3475 2282.9155,-13244.8604 2387.8271,-13304.2164"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge655" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M1237.6067,-11200.1127C1244.4449,-11105.0973 1294.6301,-10418.9159 1357.0291,-9864.2164 1425.3689,-9256.7055 1405.6959,-9097.1242 1542.2007,-8501.2164 1546.1608,-8483.9285 1731.8718,-7909.8642 1740.2205,-7894.2164 1783.2865,-7813.4982 1835.4502,-7818.0103 1867.2231,-7732.2164 1898.4715,-7647.8389 1849.6708,-6995.5224 1903.2231,-6923.2164 1930.3415,-6886.6014 2051.6726,-6853.2347 2127.0915,-6835.525"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="2128.0095,-6838.905 2136.9596,-6833.2354 2126.4273,-6832.0862 2128.0095,-6838.905"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge741" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1431.6149,-10492.2164C1479.1643,-10454.3044 1647.4182,-10489.9365 1704.2205,-10468.2164 2014.3077,-10349.6448 2112.0266,-10269.6555 2265.3853,-9975.2164 2296.8566,-9914.7934 2261.653,-9881.5583 2301.3853,-9826.2164 2354.36,-9752.4295 2428.4163,-9795.6278 2474.269,-9717.2164 2555.0254,-9579.1173 2466.7564,-9152.1631 2510.269,-8998.2164 2553.5431,-8845.1139 2636.723,-8836.6869 2682.1736,-8684.2164 2767.7074,-8397.2806 2793.1287,-7403.0363 2796.6718,-7244.5804"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2800.1775,-7244.353 2796.8973,-7234.2787 2793.1792,-7244.1997 2800.1775,-7244.353"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge779" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1303.244,-11200.1523C1310.027,-11196.654 1316.189,-11192.1093 1321.0291,-11186.2164 1375.7079,-11119.6428 1298.8313,-10863.7369 1357.0291,-10800.2164 1435.677,-10714.3753 2276.743,-10577.3666 2387.8271,-10612.2164"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge863" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2188.4692,-6253.2164C2311.8573,-6153.9157 2200.72,-6037.4937 2301.3853,-5915.2164 2313.3919,-5900.632 2330.9439,-5889.5588 2347.1,-5881.6616"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2348.7816,-5884.7405 2356.3987,-5877.3763 2345.8518,-5878.3831 2348.7816,-5884.7405"/>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1237.61,-11200.1185C1244.7233,-11100.7026 1297.554,-10352.7794 1321.0291,-9745.2164 1336.5873,-9342.5485 1297.8653,-8330.8178 1357.0291,-7932.2164 1392.8942,-7690.5836 1464.3788,-7643.8897 1506.2007,-7403.2164 1525.9937,-7289.3128 1498.4965,-6991.2478 1542.2007,-6884.2164 1584.1536,-6781.4736 1640.7144,-6785.2279 1704.2205,-6694.2164 1722.8959,-6667.4523 1721.6796,-6657.0738 1740.2205,-6630.2164 1790.2336,-6557.7695 1825.9302,-6555.9644 1867.2231,-6478.2164 1894.3412,-6427.1573 1864.2318,-6395.9024 1903.2231,-6353.2164 1970.2235,-6279.8674 2016.8395,-6302.1903 2111.5532,-6272.2164 2145.1246,-6261.592 2161.0371,-6275.2933 2188.4692,-6253.2164"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge175" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1237.6655,-11200.1205C1245.2644,-11100.7217 1301.5118,-10352.9195 1321.0291,-9745.2164 1325.7309,-9598.8162 1327.5245,-4615.6897 1357.0291,-4472.2164 1369.386,-4412.1276 1402.5009,-4346.9943 1420.1578,-4315.0982"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1423.2496,-4316.7407 1425.1012,-4306.3089 1417.1484,-4313.3092 1423.2496,-4316.7407"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge601" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1251.4564,-11222.3029C1271.4603,-11238.4447 1306.5005,-11270.5237 1321.0291,-11307.2164 1364.4542,-11416.8888 1283.0754,-12276.3216 1357.0291,-12368.2164 1399.9227,-12421.5161 1449.6295,-12367.74 1506.2007,-12406.2164 1863.4706,-12649.21 1897.4573,-12800.5547 2075.5532,-13194.2164 2105.2399,-13259.8355 2088.5458,-13283.9681 2111.5532,-13352.2164 2248.461,-13758.3346 2258.3593,-13883.4928 2510.269,-14230.2164 2713.3944,-14509.7941 3009.6217,-14937.858 3174.6229,-14634.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-14634.2164C3293.9421,-14343.5498 3234.9694,-11948.1978 3525.3633,-11828.2164"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge500" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1308.4871,-11219.2191C1406.1055,-11230.0791 1586.3391,-11249.9905 1740.2205,-11266.2164 2015.8626,-11295.2811 2341.6271,-11327.9184 2500.0478,-11343.6802"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2499.9411,-11347.1868 2510.2384,-11344.6938 2500.6339,-11340.2212 2499.9411,-11347.1868"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge426" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1237.5719,-11200.117C1244.3521,-11100.6874 1294.8391,-10352.6685 1321.0291,-9745.2164 1332.9991,-9467.5813 1301.7932,-8767.5645 1357.0291,-8495.2164 1393.3393,-8316.1838 1464.9531,-8290.1763 1506.2007,-8112.2164 1549.2034,-7926.6837 1487.6257,-7867.6806 1542.2007,-7685.2164 1628.9952,-7395.0301 1776.2345,-7375.115 1867.2231,-7086.2164 1909.8187,-6950.971 1822.1665,-6885.5585 1903.2231,-6769.2164 1962.4954,-6684.1417 2016.4953,-6705.6275 2111.5532,-6664.2164 2178.3979,-6635.0961 2220.8851,-6664.974 2265.3853,-6607.2164 2366.2236,-6476.3362 2197.1719,-6365.4254 2301.3853,-6237.2164 2352.1596,-6174.7509 2412.0367,-6234.2761 2474.269,-6183.2164 2500.1005,-6162.0225 2493.0301,-6145.8391 2510.269,-6117.2164 2596.6225,-5973.8394 2622.1891,-5940.3326 2718.1736,-5803.2164 2862.0793,-5597.6435 2971.2786,-5586.1856 3053.8293,-5349.2164 3131.7302,-5125.5949 3021.9396,-4511.0778 3089.8293,-4284.2164 3103.9547,-4237.0149 3138.1519,-4189.6536 3158.5414,-4164.2304"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.257,-4166.4385 3164.8779,-4156.4816 3155.8381,-4162.0073 3161.257,-4166.4385"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge397" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1237.6291,-11200.1193C1244.9095,-11100.7096 1298.9162,-10352.8305 1321.0291,-9745.2164 1325.7616,-9615.176 1319.5174,-7527.8188 1357.0291,-7403.2164 1392.4749,-7285.4758 1467.2323,-7286.8385 1506.2007,-7170.2164 1539.8193,-7069.6046 1480.8554,-6780.7594 1542.2007,-6694.2164 1587.6658,-6630.0763 1653.7274,-6683.478 1704.2205,-6623.2164 1747.9752,-6570.9966 1719.6832,-6539.1749 1740.2205,-6474.2164 1862.7687,-6086.6007 1955.8002,-6011.7048 2075.5532,-5623.2164 2096.8968,-5553.976 2069.3579,-5523.1174 2111.5532,-5464.2164 2154.8687,-5403.7518 2621.3189,-5156.982 2682.1736,-5114.2164 2735.7127,-5076.5918 2731.9065,-5016.8692 2797.125,-5022.2164"/>
</g>
<!-- sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge763" class="edge">
<title>sourcefile~outputreportpredefined.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-10530.2164C2035.0652,-10523.6458 2086.2438,-10514.0851 2125.2718,-10506.3283"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2126.3121,-10509.6896 2135.4309,-10504.2955 2124.9385,-10502.8257 2126.3121,-10509.6896"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1431.6149,-10492.2164C1474.7493,-10459.2135 1491.4432,-10524.8916 1542.2007,-10544.2164 1577.2945,-10557.5775 1586.4023,-10575.649 1623.2106,-10568.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-10568.2164C1708.5363,-10550.9866 1718.0912,-10507.8608 1803.7218,-10492.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1803.7218,-10492.2164C1886.5793,-10477.0786 1906.0174,-10542.2091 1989.3882,-10530.2164"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge45" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoair.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1490.363,-10860.1345C1528.3027,-10852.9128 1578.7115,-10843.1963 1623.2106,-10834.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1623.2106,-10834.2164C1841.2202,-10790.2222 1883.0595,-10731.6158 2075.5532,-10620.2164 2091.7826,-10610.8242 2094.4741,-10605.9564 2111.5532,-10598.2164 2144.1705,-10583.4346 2165.7587,-10601.9042 2188.4692,-10574.2164"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge69" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacfancomponent.f90</title>
<path fill="none" stroke="#ff5000" stroke-dasharray="5,2" d="M1623.2106,-10910.2164C1998.6099,-10987.9357 1964.3231,-11260.5855 2301.3853,-11443.2164 2378.5896,-11485.0481 2476.5404,-11514.0585 2537.8156,-11529.6741"/>
<polygon fill="#ff5000" stroke="#ff5000" points="2537.1468,-11533.1148 2547.6983,-11532.1575 2538.8528,-11526.3259 2537.1468,-11533.1148"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge257" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M1440.5234,-10882.2266C1508.1141,-10965.56 1942.0576,-11496.9473 2111.5532,-11614.2164 2217.7574,-11687.6959 2607.4182,-11836.0724 2797.125,-11866.2164"/>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2797.125,-11866.2164C2835.5982,-11869.4958 2878.7149,-11869.7088 2913.7239,-11869.0058"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2913.9253,-11872.5022 2923.8421,-11868.7729 2913.7642,-11865.5041 2913.9253,-11872.5022"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge675" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~outairnodemanager.f90</title>
<path fill="none" stroke="#00ffae" stroke-dasharray="5,2" d="M1434.7002,-10859.9831C1446.7334,-10815.5565 1490.614,-10647.6507 1506.2007,-10506.2164 1555.0152,-10063.2707 1473.6392,-8941.5379 1542.2007,-8501.2164 1580.8173,-8253.2092 1662.8859,-8207.7851 1704.2205,-7960.2164 1737.2564,-7762.3513 1693.3984,-7253.2796 1740.2205,-7058.2164 1771.7373,-6926.9155 1832.8367,-6912.7951 1867.2231,-6782.2164 1915.9484,-6597.1877 1873.1606,-6542.1767 1903.2231,-6353.2164 1955.6005,-6023.9945 2000.4494,-5948.0083 2075.5532,-5623.2164 2091.8768,-5552.6238 2085.7555,-5531.9235 2111.5532,-5464.2164 2128.6077,-5419.4563 2157.9218,-5371.4547 2175.0126,-5345.2097"/>
<polygon fill="#00ffae" stroke="#00ffae" points="2178.1261,-5346.846 2180.7107,-5336.5712 2172.2828,-5342.9916 2178.1261,-5346.846"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge746" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1623.2106,-10834.2164C1731.7259,-10815.0265 1762.6429,-10824.9553 1867.2231,-10790.2164 1965.4339,-10757.5932 1983.2773,-10733.0646 2075.5532,-10686.2164 2160.2161,-10643.2332 2205.6158,-10661.9928 2265.3853,-10588.2164 2486.437,-10315.3611 2413.4893,-10172.0772 2474.269,-9826.2164 2508.7661,-9629.9146 2467.4475,-9573.8719 2510.269,-9379.2164 2557.7874,-9163.2104 2635.9964,-9128.513 2682.1736,-8912.2164 2754.8307,-8571.8863 2791.4298,-7415.9319 2796.5088,-7244.5311"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2800.0142,-7244.3958 2796.809,-7234.2975 2793.0172,-7244.1905 2800.0142,-7244.3958"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge786" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1623.2106,-10910.2164C1842.5148,-10954.4046 1891.7011,-10829.5922 2111.5532,-10788.2164 2138.2303,-10783.1958 2578.7352,-10746.9795 2596.2213,-10726.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1483.5671,-10882.2805C1522.056,-10890.3582 1575.8228,-10901.3925 1623.2106,-10910.2164"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge815" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1434.7169,-10859.985C1446.8123,-10815.5652 1490.8946,-10647.6814 1506.2007,-10506.2164 1567.7361,-9937.4797 1520.7921,-8503.8716 1542.2007,-7932.2164 1562.1244,-7400.2105 1611.7662,-6749.7917 1621.5288,-6624.6084"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1625.0337,-6624.6821 1622.3244,-6614.4395 1618.055,-6624.136 1625.0337,-6624.6821"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge834" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacsteamcoilcomponent.f90</title>
<path fill="none" stroke="#ff00a1" stroke-dasharray="5,2" d="M1433.5849,-10882.2641C1446.528,-10951.7144 1525.6176,-11331.5235 1740.2205,-11532.2164 1856.9678,-11641.3964 1964.6129,-11547.1404 2075.5532,-11662.2164 2109.5015,-11697.4301 2079.3393,-11729.4093 2111.5532,-11766.2164 2171.049,-11834.1953 2271.6751,-11872.8595 2333.6692,-11891.3787"/>
<polygon fill="#ff00a1" stroke="#ff00a1" points="2332.695,-11894.7403 2343.275,-11894.1794 2334.6544,-11888.0201 2332.695,-11894.7403"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge868" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M1434.5637,-10859.967C1446.0863,-10815.4799 1488.3132,-10647.3782 1506.2007,-10506.2164 1546.032,-10191.8813 1466.5939,-10101.9122 1542.2007,-9794.2164 1583.2963,-9626.9702 1658.4328,-9608.2393 1704.2205,-9442.2164 1884.8571,-8787.24 1816.5483,-8599.7529 1867.2231,-7922.2164 1881.2743,-7734.3489 1848.5001,-7255.4856 1903.2231,-7075.2164 1945.9991,-6934.3034 2022.3585,-6929.5356 2075.5532,-6792.2164 2105.811,-6714.1077 2051.9641,-6666.086 2111.5532,-6607.2164 2136.2715,-6582.7965 2175.9495,-6625.629 2188.4692,-6593.2164"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge81" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~heatrecovery.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1432.1653,-10882.3665C1436.3842,-10964.5387 1465.517,-11476.7603 1542.2007,-11608.2164 1646.1434,-11786.4016 2168.6757,-12008.004 2265.3853,-12190.2164 2327.7214,-12307.6651 2214.4748,-12386.5855 2301.3853,-12487.2164 2474.4517,-12687.6046 2710.8583,-12437.3096 2876.0764,-12644.2164 2933.3989,-12716.0028 2857.3902,-13396.4019 2912.0764,-13470.2164 2915.7586,-13475.1865 2920.5075,-13479.1732 2925.8019,-13482.3703"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2924.6255,-13485.6953 2935.1347,-13487.0394 2927.7574,-13479.435 2924.6255,-13485.6953"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge614" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1623.2106,-11784.2164C1634.0065,-11854.5125 1685.1956,-11853.6879 1704.2205,-11922.2164 1729.0477,-12011.645 1676.9612,-15195.3037 1740.2205,-15263.2164 1780.1256,-15306.057 2208.9914,-15290.485 2265.3853,-15306.2164 2396.3827,-15342.7588 3224.9427,-15857.3242 3360.8456,-15852.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3360.8456,-15852.2164C3589.4713,-15835.4255 3655.5258,-7843.8264 3659.1793,-7378.3685"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3662.6798,-7378.2984 3659.2579,-7368.2714 3655.68,-7378.2438 3662.6798,-7378.2984"/>
</g>
<!-- sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge537" class="edge">
<title>sourcefile~datacontaminantbalance.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1431.9014,-10882.3371C1434.364,-10971.4145 1454.0523,-11569.4643 1542.2007,-11722.2164 1564.8619,-11761.4859 1616.3133,-11739.4051 1623.2106,-11784.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2596.2213,-12777.2164C2669.0796,-12763.4275 2741.7213,-12710.3981 2776.2887,-12682.1581"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2778.7825,-12684.6364 2784.2337,-12675.5515 2774.3069,-12679.2541 2778.7825,-12684.6364"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1623.2106,-11784.2164C1645.1547,-11926.7856 1755.4097,-11907.0831 1867.2231,-11998.2164 2058.7522,-12154.3217 2150.8225,-12167.2926 2265.3853,-12386.2164 2310.3066,-12472.0589 2241.8863,-12524.7524 2301.3853,-12601.2164 2352.9302,-12667.4584 2402.735,-12633.3099 2474.269,-12677.2164 2534.0071,-12713.8827 2527.3506,-12790.2505 2596.2213,-12777.2164"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge125" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantutilities.f90</title>
<path fill="none" stroke="#fff100" stroke-dasharray="5,2" d="M1245.0136,-2444.3468C1308.9337,-2531.8605 1728.5499,-3120.4009 1867.2231,-3674.2164 1914.1933,-3861.7999 1872.9609,-5223.2243 1903.2231,-5414.2164 1944.641,-5675.6137 2020.3664,-5725.3759 2075.5532,-5984.2164 2088.7726,-6046.2185 2071.1246,-6218.3846 2111.5532,-6267.2164 2117.7338,-6274.6816 2126.173,-6279.9386 2135.2037,-6283.6355"/>
<polygon fill="#fff100" stroke="#fff100" points="2134.1639,-6286.9794 2144.7587,-6286.9505 2136.4584,-6280.3661 2134.1639,-6286.9794"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge666" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1239.8811,-2422.098C1251.6387,-2380.3483 1296.2247,-2229.5422 1357.0291,-2116.2164 1495.1385,-1858.8111 1550.7201,-1804.5254 1740.2205,-1582.2164 1753.9027,-1566.1653 1770.9399,-1549.4137 1783.9216,-1537.2224"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1786.4658,-1539.6363 1791.4142,-1530.268 1781.7037,-1534.5057 1786.4658,-1539.6363"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge749" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M1251.4169,-2444.3008C1300.6037,-2481.7199 1459.7338,-2603.5185 1506.2007,-2648.2164 1683.1141,-2818.3946 1769.3286,-2841.1038 1867.2231,-3066.2164 1926.4122,-3202.3241 1872.5843,-3252.9927 1903.2231,-3398.2164 1955.4036,-3645.5438 2026.0322,-3692.3428 2075.5532,-3940.2164 2093.6885,-4030.9911 2067.2178,-4273.9556 2111.5532,-4355.2164 2152.9528,-4431.0961 2219.8452,-4400.7469 2265.3853,-4474.2164 2308.3678,-4543.5597 2245.0496,-4595.2054 2301.3853,-4654.2164 2356.0595,-4711.487 2423.5514,-4636.4141 2474.269,-4697.2164 2514.7049,-4745.6925 2492.4037,-5203.6703 2510.269,-5264.2164 2554.5255,-5414.2021 2640.8739,-5420.3897 2682.1736,-5571.2164 2769.8803,-5891.5217 2638.0254,-6742.9366 2718.1736,-7065.2164 2731.4625,-7118.6519 2764.9535,-7174.8617 2783.7675,-7203.6632"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2780.8664,-7205.6213 2789.3161,-7212.013 2786.6966,-7201.7471 2780.8664,-7205.6213"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M1238.4963,-2444.3858C1256.0011,-2560.4837 1404.5526,-3545.73 1428.3927,-3703.8455"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1424.9923,-3704.7691 1429.9441,-3714.1355 1431.914,-3703.7254 1424.9923,-3704.7691"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge434" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1266.1753,-2422.2092C1290.3451,-2413.39 1325.6169,-2401.07 1357.0291,-2392.2164 1467.6933,-2361.0253 1760.2329,-2264.1148 1867.2231,-2306.2164 1984.956,-2352.5453 2011.0866,-2391.352 2075.5532,-2500.2164 2108.7279,-2556.2382 2066.7787,-2594.9485 2111.5532,-2642.2164 2136.18,-2668.2146 2162.3951,-2641.67 2188.4692,-2666.2164"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge407" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1309.4255,-2422.5669C1465.0773,-2400.4211 1820.5626,-2353.7436 1867.2231,-2382.2164 1897.0866,-2400.4393 1880.3916,-2425.7094 1903.2231,-2452.2164 1964.8033,-2523.7099 2024.4574,-2496.8901 2075.5532,-2576.2164 2119.732,-2644.8038 2069.2669,-2686.4463 2111.5532,-2756.2164 2157.0696,-2831.3158 2204.3839,-2817.046 2265.3853,-2880.2164 2283.9092,-2899.399 2282.9497,-2908.9488 2301.3853,-2928.2164 2370.1268,-3000.0604 2418.1473,-2988.1352 2474.269,-3070.2164 2503.3029,-3112.68 2490.6633,-3132.6586 2510.269,-3180.2164 2575.1082,-3337.4968 2631.455,-3359.8314 2682.1736,-3522.2164 2716.4281,-3631.8886 2652.7399,-3683.7716 2718.1736,-3778.2164 2763.6836,-3843.9041 2832.145,-3797.4626 2876.0764,-3864.2164 2941.1153,-3963.043 2976.652,-4851.6764 2982.1873,-5000.9741"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.6948,-5001.2451 2982.5588,-5011.1102 2985.6901,-5000.9887 2978.6948,-5001.2451"/>
</g>
<!-- sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge760" class="edge">
<title>sourcefile~databranchairloopplant.f90&#45;&gt;sourcefile~standardratings.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1237.0573,-2444.4122C1239.2817,-2538.7839 1258.242,-3211.0356 1357.0291,-3745.2164 1401.5288,-3985.8441 1471.1998,-4033.0246 1506.2007,-4275.2164 1596.3812,-4899.2289 1476.8222,-6485.12 1542.2007,-7112.2164 1580.722,-7481.704 1664.1321,-7562.8955 1704.2205,-7932.2164 1724.6085,-8120.0443 1690.4504,-9449.9585 1740.2205,-9632.2164 1770.5723,-9743.3647 1821.6717,-9752.3851 1867.2231,-9858.2164 1888.5646,-9907.7998 1878.58,-9926.1884 1903.2231,-9974.2164 1961.2105,-10087.2302 2013.6899,-10091.2769 2075.5532,-10202.2164 2128.798,-10297.7001 2168.2475,-10423.411 2182.5779,-10472.4093"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2179.2575,-10473.5268 2185.3934,-10482.164 2185.983,-10471.5855 2179.2575,-10473.5268"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge633" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M400.9504,-3218.9277C410.7871,-3159.0408 457.0624,-2872.3581 480.9653,-2636.2164 493.4121,-2513.2522 471.4886,-2196.138 516.9653,-2081.2164 552.3427,-1991.8163 607.4494,-1998.0776 654.4731,-1914.2164 678.3961,-1871.5527 669.0202,-1854.1739 690.4731,-1810.2164 769.8467,-1647.5779 1060.9675,-1288.4283 1116.5955,-1116.2164 1159.7733,-982.5473 1091.766,-928.832 1152.5955,-802.2164 1208.4528,-685.9503 1257.8233,-678.6546 1357.0291,-596.2164 1433.5894,-532.596 1451.1167,-510.3754 1542.2007,-470.2164 1624.9669,-433.7247 1650.7852,-436.7524 1740.2205,-423.2164 1887.6583,-400.9017 1926.4549,-409.8607 2075.5532,-412.2164 2159.9546,-413.5499 2181.3109,-410.6746 2265.3853,-418.2164 2358.8639,-426.6018 2382.0771,-431.6317 2474.269,-449.2164 2540.6837,-461.8843 3619.7924,-671.3786 3659.3423,-726.2164"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge723" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M412.7872,-3241.392C432.2619,-3258.2504 467.1169,-3292.2753 480.9653,-3330.2164 530.5153,-3465.97 502.1113,-5787.468 516.9653,-5931.2164 549.8683,-6249.6312 622.1664,-6319.7405 654.4731,-6638.2164 664.4707,-6736.7712 651.1461,-10113.2967 690.4731,-10204.2164 706.2794,-10240.7586 731.8413,-10233.9262 755.1332,-10266.2164"/>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M755.1332,-10266.2164C809.563,-10341.557 920.154,-10366.7235 991.9775,-10375.0941"/>
<polygon fill="#000dff" stroke="#000dff" points="991.9629,-10378.6129 1002.2819,-10376.2112 992.7174,-10371.6537 991.9629,-10378.6129"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge882" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M412.697,-3241.4254C432.0594,-3258.3253 466.7758,-3292.4015 480.9653,-3330.2164 525.0976,-3447.8282 511.9924,-4334.6956 516.9653,-4460.2164 540.0779,-5043.5908 577.6137,-5758.4525 584.5859,-5889.9245"/>
<polygon fill="#ff0028" stroke="#ff0028" points="581.091,-5890.1154 585.1165,-5899.9157 588.0812,-5889.7441 581.091,-5890.1154"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~curvemanager.f90</title>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M463.9599,-3232.6824C499.8948,-3233.4291 545.3386,-3233.3555 585.7192,-3230.2164"/>
<path fill="none" stroke="#7fff00" stroke-dasharray="5,2" d="M585.7192,-3230.2164C646.9152,-3225.4591 632.9175,-3161.5455 690.4731,-3140.2164 744.3671,-3120.2442 766.1113,-3119.6811 819.7932,-3140.2164 837.3737,-3146.9415 1310.6545,-3580.5107 1321.0291,-3596.2164 1347.0645,-3635.6304 1324.0523,-3662.3956 1357.0291,-3696.2164 1362.2969,-3701.619 1368.6867,-3706.0346 1375.4853,-3709.6387"/>
<polygon fill="#7fff00" stroke="#7fff00" points="1374.4019,-3712.996 1384.9425,-3714.0669 1377.3703,-3706.6566 1374.4019,-3712.996"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge139" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M585.7192,-3230.2164C690.0501,-3228.831 723.3522,-3172.3922 819.7932,-3212.2164 862.2957,-3229.7673 935.5553,-3324.1398 966.4307,-3358.2164 977.4106,-3370.3347 1139.8705,-3575.9457 1152.5955,-3586.2164 1218.0015,-3639.0076 1270.3626,-3605.1509 1321.0291,-3672.2164 1370.7331,-3738.0079 1314.4006,-3783.6343 1357.0291,-3854.2164 1415.648,-3951.2746 1534.8303,-4023.1225 1591.6761,-4053.397"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1590.088,-4056.5162 1600.5692,-4058.0638 1593.3407,-4050.3178 1590.088,-4056.5162"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge170" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M585.7192,-3230.2164C690.2825,-3228.4424 737.8136,-3189.2859 819.7932,-3254.2164 858.1365,-3284.5855 831.3899,-3315.8257 855.7932,-3358.2164 985.1902,-3582.9906 1092.6867,-3584.5896 1236.8123,-3800.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-3800.2164C1298.0294,-3882.0672 1293.8721,-3915.679 1321.0291,-4014.2164 1347.2371,-4109.3106 1308.0079,-4147.6202 1357.0291,-4233.2164 1367.832,-4252.0794 1386.7061,-4267.6843 1402.7643,-4278.5203"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1401.0253,-4281.5634 1411.3266,-4284.04 1404.8181,-4275.68 1401.0253,-4281.5634"/>
</g>
<!-- sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge159" class="edge">
<title>sourcefile~datasystemvariables.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M585.7192,-3230.2164C728.2984,-3239.1235 894.9807,-3624.5108 966.4307,-3748.2164 1049.4588,-3891.968 1072.6702,-3930.1264 1116.5955,-4090.2164 1151.428,-4217.167 1120.3341,-4256.5881 1152.5955,-4384.2164 1171.2737,-4458.1092 1208.6594,-4540.8321 1226.6631,-4578.5125"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1223.6961,-4580.4172 1231.1955,-4587.9012 1230,-4577.374 1223.6961,-4580.4172"/>
</g>
<!-- sourcefile~datastringglobals.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node46" class="node">
<title>sourcefile~datastringglobals.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node46"><a xlink:href="../sourcefile/datastringglobals.f90.html" xlink:title="DataStringGlobals.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="281.0645,-3964.2218 166.6166,-3964.2218 166.6166,-3942.2109 281.0645,-3942.2109 281.0645,-3964.2218"/>
<text text-anchor="middle" x="223.8406" y="-3950.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataStringGlobals.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge718" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~schedulemanager.f90</title>
<path fill="none" stroke="#000dff" stroke-dasharray="5,2" d="M225.2123,-3964.3788C232.7239,-4026.11 268.9789,-4332.0088 281.2024,-4583.2164 284.9752,-4660.7512 268.2165,-10111.9978 317.2024,-10172.2164 332.9051,-10191.5198 741.383,-10245.4768 755.1332,-10266.2164"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge798" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M225.1487,-3964.3821C232.3218,-4026.1311 267.073,-4332.1088 281.2024,-4583.2164 286.4002,-4675.5919 283.9764,-6161.8666 317.2024,-6248.2164 399.497,-6462.089 571.2144,-6424.7173 654.4731,-6638.2164 717.553,-6799.9711 751.7039,-9625.1958 754.8879,-9900.6572"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="751.3912,-9900.9743 755.0059,-9910.9334 758.3908,-9900.8939 751.3912,-9900.9743"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge881" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M247.0514,-3964.2638C299.8204,-3990.805 428.2872,-4063.791 480.9653,-4168.2164 521.7336,-4249.0326 577.6253,-5696.5766 584.9225,-5889.9341"/>
<polygon fill="#ff0028" stroke="#ff0028" points="581.4349,-5890.3303 585.3084,-5900.1916 588.4299,-5890.0671 581.4349,-5890.3303"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~datasystemvariables.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.7151,-3941.8541C230.5812,-3867.2285 265.5475,-3446.689 317.2024,-3330.2164 331.6739,-3297.5857 359.7788,-3266.8938 378.9849,-3248.3316"/>
<polygon fill="#00ffff" stroke="#00ffff" points="381.4851,-3250.7846 386.3577,-3241.3767 376.6818,-3245.6926 381.4851,-3250.7846"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge164" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M224.9864,-3941.8535C230.8828,-3885.8985 259.776,-3640.556 317.2024,-3596.2164 397.4544,-3534.2528 677.894,-3658.5355 755.1332,-3724.2164"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1236.8123,-4066.2164C1267.2328,-4100.3559 1325.8397,-4199.7777 1357.0291,-4233.2164 1372.6311,-4249.9436 1392.6768,-4266.3764 1408.0569,-4278.1173"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1405.9654,-4280.9236 1416.0636,-4284.1293 1410.1686,-4275.326 1405.9654,-4280.9236"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M755.1332,-3724.2164C846.2013,-3762.5063 884.8752,-3737.4648 966.4307,-3793.2164 1053.2865,-3852.5913 1057.7761,-3888.9833 1116.5955,-3976.2164 1135.2755,-4003.9202 1126.4998,-4021.3487 1152.5955,-4042.2164 1182.9918,-4066.5232 1210.92,-4037.1587 1236.8123,-4066.2164"/>
</g>
<!-- sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge150" class="edge">
<title>sourcefile~datastringglobals.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-3724.2164C782.1099,-3738.7731 797.0593,-3727.6541 819.7932,-3748.2164 890.3397,-3812.0239 1173.7398,-4455.0134 1227.8573,-4578.6964"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1224.7818,-4580.3992 1231.994,-4588.1603 1231.1958,-4577.5956 1224.7818,-4580.3992"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge189" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M755.1332,-6880.2164C774.9859,-6845.705 795.6073,-6849.8425 819.7932,-6818.2164 840.0907,-6791.6748 836.5444,-6779.5281 855.7932,-6752.2164 898.3421,-6691.8447 938.4752,-6696.5803 966.4307,-6628.2164 998.0925,-6550.7886 954.4881,-5944.7659 1002.4307,-5876.2164 1033.9767,-5831.111 1084.7906,-5873.1396 1116.5955,-5828.2164 1194.5466,-5718.1131 1094.1614,-5343.8082 1152.5955,-5222.2164 1196.2724,-5131.3318 1248.3008,-5140.0611 1321.0291,-5070.2164 1422.3954,-4972.8689 1438.5839,-4939.165 1542.2007,-4844.2164 1610.8874,-4781.2757 1636.0465,-4774.7121 1704.2205,-4711.2164 1721.2446,-4695.3604 1721.1838,-4686.5895 1740.2205,-4673.2164 1789.6743,-4638.4754 1945.3696,-4522.804 1989.3882,-4564.2164"/>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M632.3441,-15214.9204C641.0242,-15211.225 649.0549,-15205.8962 654.4731,-15198.2164 696.8778,-15138.1122 689.4364,-9975.7663 690.4731,-9902.2164 695.207,-9566.3951 600.0491,-7178.1212 755.1332,-6880.2164"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge694" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M632.5915,-15214.6955C641.1436,-15211.0114 649.0602,-15205.744 654.4731,-15198.2164 701.5818,-15132.7039 687.3393,-13826.8469 690.4731,-13746.2164 732.6844,-12660.1823 786.4828,-12390.5599 819.7932,-11304.2164 823.4422,-11185.2125 825.5486,-7133.3706 855.7932,-7018.2164 881.5982,-6919.9655 936.7878,-6915.3783 966.4307,-6818.2164 1020.1968,-6641.984 976.3596,-6587.6141 1002.4307,-6405.2164 1016.7239,-6305.2187 1043.4075,-6187.3823 1054.4885,-6140.2439"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1057.941,-6140.8528 1056.8383,-6130.3155 1051.1292,-6139.2406 1057.941,-6140.8528"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge793" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M632.3429,-15214.9195C641.023,-15211.2242 649.0541,-15205.8956 654.4731,-15198.2164 695.6189,-15139.9095 674.7193,-10129.8186 690.4731,-10060.2164 700.6169,-10015.4001 726.7562,-9967.8787 742.5197,-9941.9486"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="745.5143,-9943.7606 747.809,-9933.4172 739.565,-9940.072 745.5143,-9943.7606"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge29" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~datacontaminantbalance.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M632.495,-15213.3134C640.7371,-15209.7307 648.558,-15204.8539 654.4731,-15198.2164 1052.6648,-14751.395 838.8071,-14472.9541 966.4307,-13888.2164 1138.9981,-13097.5577 1217.6757,-12904.8612 1321.0291,-12102.2164 1355.0334,-11838.1377 1333.4407,-11769.4284 1357.0291,-11504.2164 1378.4261,-11263.6418 1417.5553,-10973.1503 1428.6257,-10892.7404"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="1432.1483,-10892.8169 1430.05,-10882.4319 1425.2142,-10891.8587 1432.1483,-10892.8169"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge152" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M632.3589,-15214.9308C641.038,-15211.2348 649.0646,-15205.903 654.4731,-15198.2164 688.2251,-15150.2475 683.9282,-6810.5034 690.4731,-6752.2164 719.9441,-6489.7582 773.5591,-6432.2457 819.7932,-6172.2164 840.986,-6053.0238 833.5264,-6021.213 855.7932,-5902.2164 862.1642,-5868.169 977.9757,-5320.7473 1002.4307,-5296.2164 1020.8729,-5277.7168 1052.5682,-5307.3981 1059.5131,-5282.2164"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge204" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-15376.2164C803.5803,-15389.9447 809.8925,-15344.9218 855.7932,-15324.2164 903.8824,-15302.5238 935.7654,-15324.144 966.4307,-15281.2164 995.1625,-15240.9952 1000.2725,-14441.5986 1002.4307,-14392.2164 1064.6144,-12969.3433 932.3567,-12598.3161 1152.5955,-11191.2164 1197.0163,-10907.4128 1276,-10850.9241 1321.0291,-10567.2164 1345.5496,-10412.7233 1309.2624,-10013.1718 1357.0291,-9864.2164 1394.5763,-9747.129 1447.2055,-9739.0997 1506.2007,-9631.2164 1796.5778,-9100.2091 1885.8374,-8968.9299 2075.5532,-8394.2164 2100.0353,-8320.0518 2089.4647,-8297.1286 2111.5532,-8222.2164 2131.3757,-8154.9895 2163.6806,-8078.3899 2179.359,-8042.6245"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2182.6498,-8043.8366 2183.4879,-8033.275 2176.2464,-8041.0087 2182.6498,-8043.8366"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge508" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M911.1119,-15376.2164C1355.9756,-15274.6359 1421.8731,-15082.6884 1704.2205,-14724.2164 1865.7221,-14519.1717 2190.2502,-13842.428 2265.3853,-13584.2164 2302.1655,-13457.8162 2234.244,-13403.4499 2301.3853,-13290.2164 2349.6123,-13208.8816 2430.1645,-13249.8584 2474.269,-13166.2164 2516.8538,-13085.4564 2488.1226,-11611.7893 2510.269,-11523.2164 2524.882,-11464.7732 2562.217,-11403.4292 2582.5398,-11372.9023"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2585.5504,-11374.6985 2588.2568,-11364.4552 2579.7533,-11370.7751 2585.5504,-11374.6985"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge546" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M755.1332,-15376.2164C997.3945,-15445.2716 1075.7606,-15465.6845 1321.0291,-15408.2164 1506.1097,-15364.8506 1567.2065,-15349.9836 1704.2205,-15218.2164 1728.3038,-15195.0553 1715.1683,-15174.326 1740.2205,-15152.2164 1829.4417,-15073.4746 1870.4819,-15049.5272 1989.3882,-15054.2164"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge405" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-6880.2164C779.1207,-6834.1382 934.6223,-6821.2873 966.4307,-6780.2164 1018.5223,-6712.9557 962.5686,-6667.3732 1002.4307,-6592.2164 1036.0289,-6528.8696 1087.7767,-6543.8756 1116.5955,-6478.2164 1194.8991,-6299.8133 1077.2887,-5781.905 1152.5955,-5602.2164 1201.5512,-5485.4036 1432.5549,-5249.6175 1542.2007,-5186.2164 1606.2298,-5149.1924 1651.7461,-5200.3407 1704.2205,-5148.2164 1752.5549,-5100.2043 1688.9936,-5044.1295 1740.2205,-4999.2164 1884.0593,-4873.1058 2422.3202,-4828.5176 2596.2213,-4908.2164"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge368" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~plantsolarcollectors.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1989.3882,-3916.2164C2028.2546,-3907.8659 2040.1518,-3922.1313 2075.5532,-3940.2164 2132.7034,-3969.4119 2149.1056,-4080.9019 2188.4692,-4030.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M632.3585,-15214.9305C641.0377,-15211.2346 649.0644,-15205.9029 654.4731,-15198.2164 721.0688,-15103.5754 635.5897,-6968.0971 690.4731,-6866.2164 723.209,-6805.4484 781.6001,-6837.7113 819.7932,-6780.2164 834.7529,-6757.6965 995.743,-5850.412 1002.4307,-5824.2164 1043.4275,-5663.6311 1084.6106,-5631.8366 1116.5955,-5469.2164 1136.5971,-5367.5222 1109.6207,-5098.5294 1152.5955,-5004.2164 1196.8283,-4907.1423 1248.9166,-4911.8275 1321.0291,-4833.2164 1423.3544,-4721.6696 1443.338,-4688.8433 1542.2007,-4574.2164 1613.8026,-4491.197 1657.5111,-4487.3994 1704.2205,-4388.2164 1746.0599,-4299.3743 1697.6445,-4258.7078 1740.2205,-4170.2164 1776.7868,-4094.2156 1811.1754,-4092.2392 1867.2231,-4029.2164 1883.3382,-4011.0958 1885.8674,-4005.1524 1903.2231,-3988.2164 1938.9408,-3953.3624 1940.5962,-3926.6993 1989.3882,-3916.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2188.4692,-4030.2164C2204.7791,-4009.2154 2279.9187,-3834.9083 2301.3853,-3819.2164 2305.8517,-3815.9514 2310.7865,-3813.2903 2315.9674,-3811.1275"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2317.2517,-3814.3857 2325.5109,-3807.7497 2314.9161,-3807.7868 2317.2517,-3814.3857"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge474" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1803.7218,-13836.2164C1822.1341,-13786.8927 1849.4564,-13785.7762 1867.2231,-13736.2164 1911.3496,-13613.1265 1836.9991,-13556.9667 1903.2231,-13444.2164 1915.3213,-13423.6186 1937.083,-13407.7906 1955.7088,-13397.1515"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1957.4309,-13400.1991 1964.5443,-13392.3473 1954.0871,-13394.0493 1957.4309,-13400.1991"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.1332,-15376.2164C788.4821,-15385.6664 880.8825,-15393.176 911.1119,-15376.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M911.1119,-15376.2164C934.4851,-15363.1034 947.4165,-15371.1033 966.4307,-15352.2164 1271.1744,-15049.5125 1119.1742,-14825.8803 1357.0291,-14468.2164 1419.1975,-14374.7333 1644.735,-14196.4292 1704.2205,-14101.2164 1770.8796,-13994.5214 1759.7244,-13954.0785 1803.7218,-13836.2164"/>
</g>
<!-- sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge463" class="edge">
<title>sourcefile~datasurfaces.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M592.6952,-15234.5106C612.9538,-15265.9471 675.4415,-15353.6343 755.1332,-15376.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M755.1332,-15376.2164C812.872,-15392.5777 805.4968,-15318.9538 855.7932,-15286.2164 861.1261,-15282.7453 867.0204,-15279.5209 872.9147,-15276.62"/>
<polygon fill="#ff0000" stroke="#ff0000" points="874.5125,-15279.7368 882.0965,-15272.3386 871.5542,-15273.3926 874.5125,-15279.7368"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge697" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M223.9036,-15337.1771C225.0585,-15139.5085 242.5886,-12326.3621 317.2024,-10061.2164 366.9359,-8551.392 409.5254,-8175.1695 480.9653,-6666.2164 483.0037,-6623.1626 490.319,-5925.0949 516.9653,-5891.2164 629.6251,-5747.9796 825.7053,-5617.2359 911.1119,-5778.2164"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge25" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M225.2149,-15359.5786C232.2045,-15415.5748 265.5107,-15661.6288 317.2024,-15715.2164 343.5307,-15742.5103 361.1612,-15739.1233 399.0839,-15739.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-15739.2164C437.0065,-15739.3095 456.4377,-15744.1393 480.9653,-15715.2164 523.8224,-15664.6794 501.9105,-15483.746 516.9653,-15419.2164 532.3265,-15353.3737 562.0663,-15278.8424 576.8835,-15243.6672"/>
<polygon fill="#ff0000" stroke="#ff0000" points="580.1118,-15245.0193 580.807,-15234.4473 573.6707,-15242.2783 580.1118,-15245.0193"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge22" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~databsdfwindow.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M228.8963,-15336.9362C253.1801,-15282.7546 357.9792,-15048.9284 389.8525,-14977.8133"/>
<polygon fill="#00ffff" stroke="#00ffff" points="393.1115,-14979.0992 394.0076,-14968.5423 386.7238,-14976.2362 393.1115,-14979.0992"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge552" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M224.2266,-15359.273C227.6086,-15453.0045 253.5959,-16112.4331 317.2024,-16169.2164 361.9451,-16209.1594 266.5343,-16321.8038 1116.5955,-16168.2164 1211.9858,-16150.9814 1238.0017,-16142.2445 1321.0291,-16092.2164 1516.5513,-15974.4045 1545.6303,-15914.4045 1704.2205,-15750.2164 1937.9966,-15508.1884 1874.9986,-15290.5479 2188.4692,-15168.2164"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge481" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M224.608,-15359.4558C228.9621,-15419.5267 252.6935,-15701.8864 317.2024,-15753.2164 374.156,-15798.5345 408.6133,-15761.1303 480.9653,-15753.2164 575.9995,-15742.8214 1257.7006,-15638.8338 1321.0291,-15567.2164 1376.778,-15504.1706 1338.9583,-15272.4123 1357.0291,-15190.2164 1457.0582,-14735.2285 1565.7165,-14646.0045 1704.2205,-14201.2164 1754.2111,-14040.6778 1743.3226,-13993.1356 1803.7218,-13836.2164"/>
</g>
<!-- sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge466" class="edge">
<title>sourcefile~datavectortypes.f90&#45;&gt;sourcefile~vectorutilities.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M399.0839,-15739.2164C445.0006,-15739.3291 457.3988,-15715.6242 480.9653,-15676.2164 531.5914,-15591.5595 449.1541,-15528.8503 516.9653,-15457.2164 611.7288,-15357.1108 709.6078,-15473.0439 819.7932,-15390.2164 846.5019,-15370.1392 836.653,-15351.6043 855.7932,-15324.2164 866.8735,-15308.3615 881.3568,-15291.9907 892.7243,-15279.9121"/>
<polygon fill="#ff0000" stroke="#ff0000" points="895.2943,-15282.2887 899.6774,-15272.643 890.2359,-15277.4501 895.2943,-15282.2887"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge692" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M457.3321,-14949.5047C466.5587,-14945.7106 475.0069,-14940.1956 480.9653,-14932.2164 516.7169,-14884.3401 508.1402,-10689.3132 516.9653,-10630.2164 548.7328,-10417.4878 622.4866,-10378.9121 654.4731,-10166.2164 682.9948,-9976.5608 636.9561,-6898.3865 690.4731,-6714.2164 764.2984,-6460.1591 979.3502,-6208.0087 1042.1212,-6138.1675"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1044.8857,-6140.3288 1049.0016,-6130.5661 1039.6959,-6135.6313 1044.8857,-6140.3288"/>
</g>
<!-- sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge26" class="edge">
<title>sourcefile~databsdfwindow.f90&#45;&gt;sourcefile~datasurfaces.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.397,-14968.3644C409.815,-15006.2046 442.3243,-15131.1069 516.9653,-15198.2164 521.0384,-15201.8785 525.6903,-15205.0162 530.6104,-15207.7023"/>
<polygon fill="#ff0000" stroke="#ff0000" points="529.1599,-15210.8884 539.6892,-15212.0653 532.192,-15204.5791 529.1599,-15210.8884"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge102" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~hvachxassistedcoolingcoil.f90</title>
<path fill="none" stroke="#ff7800" stroke-dasharray="5,2" d="M2983.605,-13483.9463C2989.6034,-13379.7571 3035.3809,-12573.5479 3053.8293,-11919.2164 3093.2758,-10520.1253 3043.0422,-10169.0812 3089.8293,-8770.2164 3110.4329,-8154.2 3163.3275,-7399.8525 3173.0687,-7263.7641"/>
<polygon fill="#ff7800" stroke="#ff7800" points="3176.5834,-7263.6843 3173.8086,-7253.4593 3169.6014,-7263.1829 3176.5834,-7263.6843"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge621" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3030.856,-13486.2328C3039.5898,-13482.5787 3047.8237,-13477.4406 3053.8293,-13470.2164 3497.2882,-12936.7796 2871.2004,-12477.0799 3295.4165,-11928.2164 3363.5684,-11840.0394 3421.9501,-11869.7563 3525.3633,-11828.2164"/>
</g>
<!-- sourcefile~heatrecovery.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge361" class="edge">
<title>sourcefile~heatrecovery.f90&#45;&gt;sourcefile~desiccantdehumidifiers.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M3002.6604,-13484.1355C3019.6782,-13473.342 3043.1595,-13455.2154 3053.8293,-13432.2164 3122.3072,-13284.6114 3014.9513,-12112.68 3089.8293,-11968.2164 3100.6358,-11947.3673 3121.8458,-11931.6134 3140.3483,-11921.0737"/>
<polygon fill="#00ff00" stroke="#00ff00" points="3142.0192,-11924.1492 3149.1565,-11916.3191 3138.6941,-11917.9893 3142.0192,-11924.1492"/>
</g>
<!-- sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge182" class="edge">
<title>sourcefile~runtimelanguageprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1989.3882,-4564.2164C2017.9511,-4591.8658 2038.232,-4574.525 2075.5532,-4588.2164 2179.2943,-4626.274 2197.8335,-4653.6467 2301.3853,-4692.2164 2312.1421,-4696.2229 2323.8451,-4699.9891 2335.065,-4703.3227"/>
<polygon fill="#bbff00" stroke="#bbff00" points="2334.1855,-4706.7118 2344.7647,-4706.1361 2336.1356,-4699.9889 2334.1855,-4706.7118"/>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1684.2966,-4058.0355C1691.7247,-4054.5856 1698.6442,-4050.0848 1704.2205,-4044.2164 1749.0688,-3997.0185 1688.836,-3942.1994 1740.2205,-3902.2164 1784.7687,-3867.5527 1826.2012,-3863.4439 1867.2231,-3902.2164 1918.8237,-3950.9874 1858.7018,-4484.9074 1903.2231,-4540.2164 1928.1504,-4571.1835 1960.6444,-4536.7551 1989.3882,-4564.2164"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge184" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M1456.1604,-4284.0399C1510.1845,-4258.1115 1639.6958,-4188.4233 1704.2205,-4089.2164 1742.5443,-4030.2933 1685.1511,-3978.8971 1740.2205,-3935.2164 1784.4435,-3900.1389 1826.1417,-3896.5068 1867.2231,-3935.2164 1965.2455,-4027.5794 1818.6102,-4435.431 1903.2231,-4540.2164 1928.1978,-4571.1452 1960.4547,-4536.955 1989.3882,-4564.2164"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge812" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1432.745,-4306.3708C1440.2016,-4380.3018 1482.7525,-4807.4128 1506.2007,-5156.2164 1528.6437,-5490.0678 1514.815,-5574.734 1542.2007,-5908.2164 1564.1105,-6175.017 1608.329,-6497.4875 1620.213,-6582.0806"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1616.7792,-6582.7962 1621.6415,-6592.2094 1623.7106,-6581.8185 1616.7792,-6582.7962"/>
</g>
<!-- sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge132" class="edge">
<title>sourcefile~outputprocessor.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1450.754,-4284.1707C1467.8254,-4273.3349 1492.2187,-4255.2549 1506.2007,-4233.2164 1540.3879,-4179.3301 1498.1235,-4140.365 1542.2007,-4094.2164 1545.5809,-4090.6773 1549.4497,-4087.6358 1553.623,-4085.0224"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1555.3955,-4088.0435 1562.5583,-4080.2368 1552.0905,-4081.8728 1555.3955,-4088.0435"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge192" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~emsmanager.f90</title>
<path fill="none" stroke="#bbff00" stroke-dasharray="5,2" d="M595.1738,-3942.1883C609.9429,-3924.4126 638.452,-3887.8065 654.4731,-3852.2164 681.1987,-3792.8467 661.1125,-3768.328 690.4731,-3710.2164 789.0114,-3515.1859 823.4993,-3455.6365 1002.4307,-3330.2164 1119.9755,-3247.8245 1179.3742,-3253.9973 1321.0291,-3277.2164 1384.2251,-3287.575 1828.0419,-3410.562 1867.2231,-3461.2164 1936.3297,-3550.5588 1848.1841,-3869.5833 1903.2231,-3968.2164 1926.2128,-4009.4151 1975.0102,-3985.2816 1989.3882,-4030.2164"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge797" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~general.f90</title>
<path fill="none" stroke="#6b00ff" stroke-dasharray="5,2" d="M587.8468,-3964.2972C597.7682,-4016.5616 639.6324,-4243.7728 654.4731,-4432.2164 697.432,-4977.697 680.6323,-6347.1353 690.4731,-6894.2164 713.0851,-8151.2785 749.8658,-9701.695 754.6211,-9900.8252"/>
<polygon fill="#6b00ff" stroke="#6b00ff" points="751.1235,-9900.9689 754.8615,-9910.8824 758.1215,-9900.8016 751.1235,-9900.9689"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge140" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~runtimelanguageprocessor.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M654.4983,-3948.3414C709.0524,-3944.7296 787.2578,-3940.1181 855.7932,-3938.2164 904.9465,-3936.8524 917.6356,-3932.1382 966.4307,-3938.2164 1034.7464,-3946.7261 1050.0965,-3958.4024 1116.5955,-3976.2164 1223.8642,-4004.9519 1247.8656,-4023.8288 1357.0291,-4044.2164 1414.6682,-4054.9812 1480.2394,-4061.2096 1531.8784,-4064.7574"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1531.8037,-4068.26 1542.014,-4065.4317 1532.2684,-4061.2755 1531.8037,-4068.26"/>
</g>
<!-- sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge579" class="edge">
<title>sourcefile~dataruntimelanguage.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M637.1226,-3964.2631C643.8229,-3967.7213 649.926,-3972.26 654.4731,-3978.2164 713.7339,-4055.8433 663.0446,-4322.4856 690.4731,-4416.2164 724.9434,-4534.0104 763.8869,-4550.9546 819.7932,-4660.2164 903.3276,-4823.4736 916.3491,-4868.2878 1002.4307,-5030.2164 1050.4741,-5120.5912 1088.1079,-5131.9096 1116.5955,-5230.2164 1141.1139,-5314.8263 1096.6025,-5954.2106 1152.5955,-6022.2164 1255.4013,-6147.0783 1357.2879,-6045.0933 1506.2007,-6108.2164 1593.5628,-6145.2485 1812.4708,-6258.7199 1867.2231,-6336.2164 1909.0319,-6395.3924 1853.2597,-6442.7433 1903.2231,-6495.2164 1930.6361,-6524.0063 1968.0664,-6485.6648 1989.3882,-6519.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M1989.3882,-6519.2164C2015.7889,-6558.317 2051.8028,-6540.4515 2075.5532,-6581.2164 2150.2696,-6709.4587 2017.287,-6798.5756 2111.5532,-6913.2164 2134.2975,-6940.8765 2159.6283,-6915.9894 2188.4692,-6937.2164"/>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2188.4692,-6937.2164C2203.0847,-6947.9734 2437.5636,-7010.5079 2544.1762,-7038.5815"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2543.5213,-7042.0282 2554.0827,-7041.1878 2545.3024,-7035.2586 2543.5213,-7042.0282"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge875" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M463.3132,-5898.0992C483.6061,-5900.2738 505.9381,-5902.667 525.9091,-5904.8071"/>
<polygon fill="#ff0028" stroke="#ff0028" points="525.7981,-5908.3151 536.1141,-5905.9006 526.544,-5901.355 525.7981,-5908.3151"/>
</g>
<!-- sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge165" class="edge">
<title>sourcefile~sortandstringutilities.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M402.4225,-5879.9386C415.4512,-5835.3323 463.0362,-5666.7129 480.9653,-5524.2164 497.1741,-5395.3927 453.5633,-4469.5233 516.9653,-4356.2164 658.8037,-4102.7343 862.3725,-4216.1287 1152.5955,-4204.2164 1227.3919,-4201.1463 1250.5623,-4178.9505 1321.0291,-4204.2164 1322.3718,-4204.6978 1378.6655,-4251.2921 1410.4019,-4277.6107"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1408.3336,-4280.4426 1418.2649,-4284.1333 1412.8028,-4275.0549 1408.3336,-4280.4426"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge876" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~inputprocessor.f90</title>
<path fill="none" stroke="#ff0028" stroke-dasharray="5,2" d="M443.7877,-5927.1863C468.4588,-5924.4104 499.4194,-5920.9267 526.1233,-5917.922"/>
<polygon fill="#ff0028" stroke="#ff0028" points="526.5816,-5921.3927 536.1275,-5916.7964 525.7988,-5914.4365 526.5816,-5921.3927"/>
</g>
<!-- sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge167" class="edge">
<title>sourcefile~dataoutputs.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M443.4937,-5931.0379C457.6251,-5928.3025 471.9199,-5922.586 480.9653,-5911.2164 532.136,-5846.8974 462.5707,-4493.8328 516.9653,-4432.2164 629.1994,-4305.0812 1178.9736,-4294.4777 1367.7982,-4294.6565"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1367.842,-4298.1565 1377.8491,-4294.6766 1367.8561,-4291.1565 1367.842,-4298.1565"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge653" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~reportsizingmanager.f90</title>
<path fill="none" stroke="#00ff0d" stroke-dasharray="5,2" d="M1244.666,-4610.4033C1318.0311,-4715.6494 1884.9093,-5545.1121 2075.5532,-6315.2164 2106.9752,-6442.1452 2081.3464,-6479.9929 2111.5532,-6607.2164 2128.9647,-6680.5491 2162.9384,-6763.5439 2179.27,-6801.4013"/>
<polygon fill="#00ff0d" stroke="#00ff0d" points="2176.1776,-6803.0664 2183.3801,-6810.8365 2182.5951,-6800.2708 2176.1776,-6803.0664"/>
</g>
<!-- sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge172" class="edge">
<title>sourcefile~sqlitefortranroutines.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M1243.9764,-4588.0363C1272.9115,-4542.8815 1381.3895,-4373.5958 1418.8207,-4315.1823"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1421.9371,-4316.8061 1424.3856,-4306.4981 1416.0433,-4313.0294 1421.9371,-4316.8061"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge173" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~outputprocessor.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M803.5648,-10102.1271C809.9391,-10098.6756 815.6775,-10094.15 819.7932,-10088.2164 923.339,-9938.9346 749.4231,-6965.499 855.7932,-6818.2164 886.2338,-6776.0677 935.1158,-6821.7196 966.4307,-6780.2164 1057.7067,-6659.2434 912.9412,-6221.5169 1002.4307,-6099.2164 1034.4482,-6055.4597 1084.9864,-6100.269 1116.5955,-6056.2164 1184.7795,-5961.1903 1122.1575,-5117.1435 1152.5955,-5004.2164 1193.8099,-4851.3077 1270.0106,-4840.139 1321.0291,-4690.2164 1352.6651,-4597.2507 1329.7742,-4566.5595 1357.0291,-4472.2164 1373.9818,-4413.5342 1404.8609,-4348.2087 1421.0573,-4315.7911"/>
<polygon fill="#00ff00" stroke="#00ff00" points="1424.3797,-4316.9765 1425.7637,-4306.4724 1418.1313,-4313.8207 1424.3797,-4316.9765"/>
</g>
<!-- sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge533" class="edge">
<title>sourcefile~dataglobalconstants.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M803.1026,-10124.2345C809.6223,-10127.6947 815.5268,-10132.2416 819.7932,-10138.2164 880.404,-10223.0963 827.7901,-10975.747 855.7932,-11076.2164 883.0671,-11174.0697 939.8681,-11178.1676 966.4307,-11276.2164 1010.3147,-11438.2027 980.1779,-12619.8728 1002.4307,-12786.2164 1011.6573,-12855.1875 1121.8627,-13331.7853 1152.5955,-13394.2164 1213.9591,-13518.8714 1417.1862,-13822.5885 1542.2007,-13883.2164 1672.1774,-13946.2507 1724.078,-13903.6261 1867.2231,-13884.2164 2049.1483,-13859.5482 2113.1805,-13876.8761 2265.3853,-13774.2164 2465.878,-13638.9872 2431.0152,-13518.8266 2596.2213,-13342.2164"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge153" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~sqlitefortranroutines.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1062.4122,-6414.1462C1072.2063,-6376.1805 1104.1452,-6247.6159 1116.5955,-6139.2164 1174.1839,-5637.8146 1092.9967,-5505.3832 1152.5955,-5004.2164 1170.3194,-4855.1755 1215.2325,-4679.5613 1231.1291,-4620.0925"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1234.5258,-4620.9387 1233.7466,-4610.3726 1227.7666,-4619.1185 1234.5258,-4620.9387"/>
</g>
<!-- sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge477" class="edge">
<title>sourcefile~dataroomair.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1623.2106,-13304.2164C1651.9057,-13339.3193 1674.7203,-13331.7872 1704.2205,-13366.2164 1725.961,-13391.5895 1715.021,-13410.2748 1740.2205,-13432.2164 1762.9749,-13452.029 1773.8437,-13460.4122 1803.7218,-13456.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1060.7284,-6436.4545C1067.8361,-6502.7763 1104.1344,-6849.8481 1116.5955,-7134.2164 1122.637,-7272.0877 1113.2258,-11969.9476 1152.5955,-12102.2164 1192.0872,-12234.8951 1271.9204,-12234.7885 1321.0291,-12364.2164 1358.0456,-12461.775 1324.3966,-12497.1052 1357.0291,-12596.2164 1401.7404,-12732.0134 1465.2094,-12744.2505 1506.2007,-12881.2164 1552.4308,-13035.6871 1463.7019,-13101.3747 1542.2007,-13242.2164 1564.2737,-13281.8195 1594.5154,-13269.1135 1623.2106,-13304.2164"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1803.7218,-13456.2164C1833.5999,-13452.0206 1840.6507,-13446.5066 1867.2231,-13432.2164 1884.6055,-13422.8684 1885.4854,-13414.871 1903.2231,-13406.2164 1911.8466,-13402.0088 1921.3091,-13398.3786 1930.7076,-13395.2916"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1931.9283,-13398.5775 1940.4408,-13392.2697 1929.8527,-13391.8923 1931.9283,-13398.5775"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge247" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~hvacheatingcoils.f90</title>
<path fill="none" stroke="#43ff00" stroke-dasharray="5,2" d="M2389.9877,-7559.4848C2400.7092,-7615.7804 2448.7027,-7872.2585 2474.269,-8084.2164 2498.1899,-8282.5318 2447.696,-8342.517 2510.269,-8532.2164 2555.5385,-8669.4573 2615.2417,-8680.1363 2682.1736,-8808.2164 2783.2262,-9001.5895 2829.9746,-9045.9573 2876.0764,-9259.2164 2918.8606,-9457.1286 2900.9656,-10879.0375 2912.0764,-11081.2164 2928.7821,-11385.2033 2969.9836,-11753.7225 2980.4855,-11845.0055"/>
<polygon fill="#43ff00" stroke="#43ff00" points="2977.0352,-11845.6378 2981.6602,-11855.1699 2983.9889,-11844.8341 2977.0352,-11845.6378"/>
</g>
<!-- sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge394" class="edge">
<title>sourcefile~refrigeratedcase.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2397.3043,-7537.0305C2439.1758,-7486.919 2608.7458,-7276.5842 2682.1736,-7072.2164 2722.0657,-6961.1865 2701.3515,-6925.9898 2718.1736,-6809.2164 2785.0859,-6344.734 2823.7906,-6231.5717 2876.0764,-5765.2164 2900.4555,-5547.7707 2874.2644,-5489.7325 2912.0764,-5274.2164 2927.4256,-5186.7312 2960.6471,-5085.9521 2975.5067,-5043.1653"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2978.8615,-5044.175 2978.8669,-5033.5801 2972.2557,-5041.8592 2978.8615,-5044.175"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge738" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2191.0798,-8033.3256C2204.2329,-8086.5692 2267.4088,-8311.554 2387.8271,-8274.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2387.8271,-8274.2164C2574.7648,-8216.2534 2397.5354,-8011.2055 2510.269,-7851.2164 2537.4,-7812.7127 2576.1629,-7831.8343 2596.2213,-7789.2164"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge773" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2190.9838,-8033.6504C2207.9941,-8109.2501 2311.5851,-8543.1445 2510.269,-8836.2164 2569.1789,-8923.1123 2632.8259,-8905.5553 2682.1736,-8998.2164 2728.3338,-9084.8922 2668.4889,-9131.5116 2718.1736,-9216.2164 2729.7331,-9235.9236 2749.9765,-9251.8896 2767.0705,-9262.8178"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2765.3018,-9265.8387 2775.6597,-9268.0665 2768.9518,-9259.8656 2765.3018,-9265.8387"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge859" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2189.2441,-8011.1565C2195.3996,-7923.1364 2236.8905,-7326.9042 2265.3853,-6842.2164 2283.3294,-6536.9911 2249.2068,-6456.4834 2301.3853,-6155.2164 2319.2532,-6052.0508 2361.934,-5933.76 2379.774,-5886.8896"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2383.1476,-5887.8677 2383.4673,-5877.2777 2376.6134,-5885.3569 2383.1476,-5887.8677"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge220" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2192.321,-8011.1148C2203.8696,-7977.7128 2239.035,-7875.1499 2265.3853,-7789.2164 2282.5846,-7733.1258 2275.2086,-7714.7212 2301.3853,-7662.2164 2319.8597,-7625.1606 2350.9285,-7588.0244 2370.3553,-7566.6257"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2372.9718,-7568.9512 2377.1802,-7559.228 2367.8269,-7564.2046 2372.9718,-7568.9512"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge526" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2189.4915,-8033.271C2199.3571,-8139.6668 2277.816,-8979.2299 2301.3853,-9026.2164 2348.5984,-9120.338 2418.6858,-9098.7822 2474.269,-9188.2164 2642.4362,-9458.7994 2632.6962,-9559.4985 2682.1736,-9874.2164 2752.7617,-10323.2164 2690.197,-11465.5633 2718.1736,-11919.2164 2735.8904,-12206.5032 2781.9752,-12553.8205 2794.143,-12642.6982"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2790.7119,-12643.4394 2795.5423,-12652.869 2797.6466,-12642.4853 2790.7119,-12643.4394"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge567" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2193.8975,-8011.0771C2209.449,-7979.4193 2255.9709,-7886.4771 2301.3853,-7813.2164 2371.6021,-7699.9452 2427.9641,-7693.1828 2474.269,-7568.2164 2532.7517,-7410.3853 2456.6024,-7350.7493 2510.269,-7191.2164 2525.9682,-7144.548 2559.8806,-7097.2766 2580.0989,-7071.6653"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2583.0885,-7073.5326 2586.627,-7063.5461 2577.6332,-7069.1464 2583.0885,-7073.5326"/>
</g>
<!-- sourcefile~watermanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge421" class="edge">
<title>sourcefile~watermanager.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2200.8144,-8011.193C2243.468,-7972.5953 2386.7932,-7838.5853 2474.269,-7704.2164 2597.3375,-7515.1746 2620.9286,-7458.3147 2682.1736,-7241.2164 2716.2396,-7120.4607 2656.2144,-7070.3195 2718.1736,-6961.2164 2762.2382,-6883.6236 2831.5533,-6914.547 2876.0764,-6837.2164 2933.4056,-6737.6435 2895.4197,-6694.8999 2912.0764,-6581.2164 2972.6898,-6167.5261 3016.7529,-6067.6764 3053.8293,-5651.2164 3067.3031,-5499.8734 3046.8119,-4429.9412 3089.8293,-4284.2164 3103.7785,-4236.9626 3138.0395,-4189.6201 3158.4876,-4164.2144"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3161.204,-4166.4215 3164.8434,-4156.4714 3155.7933,-4161.9803 3161.204,-4166.4215"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge739" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2387.8271,-7205.2164C2428.6831,-7227.0199 2550.094,-7209.324 2596.2213,-7205.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2028.8227,-7199.7333C2116.8947,-7190.4463 2326.6475,-7172.5667 2387.8271,-7205.2164"/>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2596.2213,-7205.2164C2639.6077,-7201.3528 2688.2619,-7205.493 2726.8224,-7210.7715"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2726.5133,-7214.2627 2736.9071,-7212.2089 2727.5011,-7207.3328 2726.5133,-7214.2627"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge777" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2387.8271,-7205.2164C2422.1733,-7225.4675 2449.1574,-7198.2458 2474.269,-7229.2164 2514.5157,-7278.8532 2501.3401,-7739.9402 2510.269,-7803.2164 2559.688,-8153.4308 2633.8217,-8229.853 2682.1736,-8580.2164 2701.5261,-8720.4469 2653.1911,-9090.4532 2718.1736,-9216.2164 2728.593,-9236.3815 2748.6597,-9252.2608 2765.9543,-9263.0331"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2764.2913,-9266.1158 2774.6798,-9268.1964 2767.8562,-9260.0915 2764.2913,-9266.1158"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge861" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacwatertoairmultispeedhp.f90</title>
<path fill="none" stroke="#ff0050" stroke-dasharray="5,2" d="M2014.3363,-7193.1461C2034.4804,-7182.7921 2061.6781,-7165.3026 2075.5532,-7141.2164 2151.1832,-7009.9283 2054.3895,-6942.533 2111.5532,-6802.2164 2153.2009,-6699.9862 2225.0865,-6709.9858 2265.3853,-6607.2164 2338.9548,-6419.6001 2264.304,-6353.3005 2301.3853,-6155.2164 2320.6507,-6052.3026 2362.5462,-5933.8703 2379.9752,-5886.9258"/>
<polygon fill="#ff0050" stroke="#ff0050" points="2383.3513,-5887.8904 2383.5804,-5877.2981 2376.7958,-5885.4356 2383.3513,-5887.8904"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge222" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~refrigeratedcase.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2028.8068,-7212.185C2043.9336,-7216.1221 2061.0373,-7221.6817 2075.5532,-7229.2164 2171.4834,-7279.01 2190.6007,-7303.1825 2265.3853,-7381.2164 2311.5711,-7429.409 2355.1699,-7495.5426 2375.6391,-7528.2419"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2372.7615,-7530.2429 2381.0049,-7536.8985 2378.7113,-7526.5549 2372.7615,-7530.2429"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge207" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~watermanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2028.996,-7206.1861C2045.829,-7209.1478 2064.1617,-7215.5952 2075.5532,-7229.2164 2124.7207,-7288.0074 2101.0915,-7496.2929 2111.5532,-7572.2164 2134.4151,-7738.1307 2171.9415,-7936.7482 2184.3462,-8001.0341"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2180.9628,-8001.9725 2186.3002,-8011.1246 2187.8351,-8000.6416 2180.9628,-8001.9725"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~hvacevapcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge528" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~hvacevapcomponent.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2028.6315,-7205.6164C2045.8175,-7208.4154 2064.5415,-7214.8914 2075.5532,-7229.2164 2130.1466,-7300.2358 2064.4092,-8765.0479 2111.5532,-8841.2164 2152.219,-8906.9182 2219.7037,-8859.8977 2265.3853,-8922.2164 2318.5228,-8994.7065 2267.5827,-9037.9349 2301.3853,-9121.2164 2353.1578,-9248.7714 2428.6277,-9248.3413 2474.269,-9378.2164 2537.7064,-9558.7309 2491.3238,-9616.8198 2510.269,-9807.2164 2576.4052,-10471.8736 2624.5592,-10634.7663 2682.1736,-11300.2164 2705.9439,-11574.7653 2695.6465,-11644.5627 2718.1736,-11919.2164 2741.7026,-12206.0856 2783.5508,-12553.7073 2794.4634,-12642.6752"/>
<polygon fill="#0000ff" stroke="#0000ff" points="2791.021,-12643.3588 2795.7159,-12652.8566 2797.9686,-12642.504 2791.021,-12643.3588"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~userdefinedcomponents.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge568" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~userdefinedcomponents.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M2028.6825,-7198.638C2112.0491,-7186.2382 2312.2705,-7153.4576 2474.269,-7103.2164 2505.6169,-7093.4943 2540.0002,-7078.718 2564.2439,-7067.5687"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="2565.7412,-7070.7324 2573.3317,-7063.3408 2562.7885,-7064.3857 2565.7412,-7070.7324"/>
</g>
<!-- sourcefile~datawater.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge424" class="edge">
<title>sourcefile~datawater.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1990.0058,-7192.9651C1996.0878,-7081.8944 2045.678,-6170.2346 2075.5532,-5431.2164 2078.0589,-5369.2347 2078.645,-4367.8001 2111.5532,-4315.2164 2152.5443,-4249.717 2214.8601,-4292.677 2265.3853,-4234.2164 2296.8204,-4197.8441 2266.2482,-4165.0264 2301.3853,-4132.2164 2359.6697,-4077.7921 2417.9005,-4140.6226 2474.269,-4084.2164 2516.6475,-4041.8096 2467.1724,-3995.8931 2510.269,-3954.2164 2529.6874,-3935.4378 2959.6477,-3826.5571 2982.9529,-3840.2164"/>
</g>
<!-- sourcefile~datahvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_node62" class="node">
<title>sourcefile~datahvaccontrollers.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~EfferentGraph_node62"><a xlink:href="../sourcefile/datahvaccontrollers.f90.html" xlink:title="DataHVACControllers.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="3426.2038,-1858.2218 3295.4873,-1858.2218 3295.4873,-1836.2109 3426.2038,-1836.2109 3426.2038,-1858.2218"/>
<text text-anchor="middle" x="3360.8456" y="-1844.0664" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DataHVACControllers.f90</text>
</a>
</g>
</g>
<!-- sourcefile~datahvaccontrollers.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge626" class="edge">
<title>sourcefile~datahvaccontrollers.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3368.093,-1836.0882C3413.2573,-1766.8025 3654.3666,-1397.8581 3659.3423,-1410.2164"/>
</g>
<!-- sourcefile~datahvaccontrollers.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge301" class="edge">
<title>sourcefile~datahvaccontrollers.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3367.213,-1858.5742C3380.9918,-1883.8179 3413.3704,-1946.8877 3426.2747,-2004.2164 3473.5101,-2214.0645 3519.1682,-3841.5887 3524.785,-4047.7658"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3521.2904,-4048.0149 3525.0604,-4057.9162 3528.2878,-4047.825 3521.2904,-4048.0149"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge627" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M2597.2761,-2311.7957C2605.1817,-2232.6182 2661.9265,-1761.166 2912.0764,-1510.2164 3063.3274,-1358.4819 3149.4739,-1369.1763 3360.8456,-1334.2164"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge728" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacwatercoilcomponent.f90</title>
<path fill="none" stroke="#1a00ff" stroke-dasharray="5,2" d="M2597.1807,-2334.3022C2605.2214,-2427.7709 2661.5978,-3094.0634 2682.1736,-3636.2164 2689.3986,-3826.5898 2673.4534,-6880.029 2718.1736,-7065.2164 2731.0991,-7118.741 2764.7364,-7174.9149 2783.6703,-7203.687"/>
<polygon fill="#1a00ff" stroke="#1a00ff" points="2780.7835,-7205.6664 2789.2562,-7212.0277 2786.5997,-7201.7713 2780.7835,-7205.6664"/>
</g>
<!-- sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge303" class="edge">
<title>sourcefile~setpointmanager.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M2640.0468,-2312.2016C2653.7235,-2308.3051 2668.7401,-2303.5479 2682.1736,-2298.2164 2854.6035,-2229.7814 2897.327,-2207.8277 3053.8293,-2108.2164 3110.3087,-2072.2681 3107.7262,-2020.8648 3174.6229,-2018.2164"/>
</g>
<!-- sourcefile~dataconvergparams.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge629" class="edge">
<title>sourcefile~dataconvergparams.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M418.4585,-408.167C508.2833,-358.0138 894.355,-154.2164 1236.8123,-154.2164 1236.8123,-154.2164 1236.8123,-154.2164 1803.7218,-154.2164 1925.0057,-154.2164 1955.638,-160.0472 2075.5532,-178.2164 2348.2646,-219.5367 2415.2421,-239.7438 2682.1736,-309.2164 2698.3645,-313.4303 2702.1005,-315.5734 2718.1736,-320.2164 2788.0513,-340.4015 2806.4792,-342.0845 2876.0764,-363.2164 3195.6261,-460.2415 3306.2764,-423.6026 3588.4519,-602.2164 3617.1069,-620.3546 3681.3404,-680.8493 3694.2327,-712.2164 3759.6588,-871.3993 3782.9639,-6705.0406 3784.4909,-7106.4956"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3780.9919,-7106.7907 3784.5298,-7116.7774 3787.9919,-7106.7642 3780.9919,-7106.7907"/>
</g>
<!-- sourcefile~rootfinder.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge637" class="edge">
<title>sourcefile~rootfinder.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M949.7613,-1206.1487C956.2246,-1202.6689 962.1955,-1198.1279 966.4307,-1192.2164 1014.5423,-1125.0616 982.3846,-902.3578 1002.4307,-822.2164 1044.6973,-653.2401 1027.5908,-581.5147 1152.5955,-460.2164 1210.0671,-404.4488 1248.4095,-429.9715 1321.0291,-396.2164 1337.627,-388.5013 1339.7124,-382.1448 1357.0291,-376.2164 1589.3958,-296.6647 1658.3308,-310.9375 1903.2231,-292.2164 2515.8444,-245.3837 2680.6822,-353.904 3259.4165,-560.2164 3440.6907,-624.8386 3541.8066,-573.8296 3659.3423,-726.2164"/>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3659.3423,-726.2164C3759.8552,-865.5821 3783.0386,-6710.468 3784.4965,-7107.0732"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3780.9969,-7107.2195 3784.5334,-7117.2067 3787.9969,-7107.194 3780.9969,-7107.2195"/>
</g>
<!-- sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge638" class="edge">
<title>sourcefile~mixedair.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M3665.3824,-7346.1712C3685.1329,-7310.0547 3747.996,-7195.1009 3773.5811,-7148.315"/>
<polygon fill="#1aff00" stroke="#1aff00" points="3776.7187,-7149.8721 3778.4459,-7139.419 3770.5771,-7146.5134 3776.7187,-7149.8721"/>
</g>
<!-- sourcefile~datarootfinder.f90&#45;&gt;sourcefile~hvaccontrollers.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge640" class="edge">
<title>sourcefile~datarootfinder.f90&#45;&gt;sourcefile~hvaccontrollers.f90</title>
<path fill="none" stroke="#1aff00" stroke-dasharray="5,2" d="M806.8352,-116.9431C867.3927,-116.647 970.7351,-116.2164 1059.5131,-116.2164 1059.5131,-116.2164 1059.5131,-116.2164 1989.3882,-116.2164 2056.9681,-116.2164 3621.0582,-370.9198 3659.3423,-422.2164"/>
</g>
<!-- sourcefile~datarootfinder.f90&#45;&gt;sourcefile~rootfinder.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge285" class="edge">
<title>sourcefile~datarootfinder.f90&#45;&gt;sourcefile~rootfinder.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M755.5095,-128.5555C759.2209,-237.7496 790.5263,-1100.766 855.7932,-1192.2164 858.0374,-1195.3609 860.7732,-1198.1175 863.8136,-1200.5328"/>
<polygon fill="#00ffff" stroke="#00ffff" points="862.157,-1203.6309 872.4454,-1206.161 865.9804,-1197.7673 862.157,-1203.6309"/>
</g>
<!-- sourcefile~faultsmanager.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge597" class="edge">
<title>sourcefile~faultsmanager.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M1286.6524,-15551.7948C1299.6929,-15555.4416 1312.4773,-15561.6751 1321.0291,-15572.2164 1383.3941,-15649.091 1317.3392,-15925.5311 1357.0291,-16016.2164 1396.2716,-16105.8797 1455.9872,-16094.2039 1506.2007,-16178.2164 1531.295,-16220.2017 1511.1766,-16244.4011 1542.2007,-16282.2164 1606.8947,-16361.0719 1641.7821,-16371.5065 1740.2205,-16398.2164 2055.3224,-16483.7148 2857.8914,-16159.4654 3174.6229,-16080.2164"/>
</g>
<!-- sourcefile~datadefineequip.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge598" class="edge">
<title>sourcefile~datadefineequip.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M452.1979,-16448.6395C462.9375,-16452.3744 473.2773,-16457.9401 480.9653,-16466.2164 530.2775,-16519.302 492.7197,-16556.9381 516.9653,-16625.2164 596.7907,-16850.0131 516.5841,-17106.2164 755.1332,-17106.2164 755.1332,-17106.2164 755.1332,-17106.2164 1623.2106,-17106.2164 1826.7826,-17106.2164 1885.3064,-17106.6573 2075.5532,-17034.2164 2165.4578,-16999.9831 2184.9752,-16983.0271 2265.3853,-16930.2164 2282.3277,-16919.0891 2283.2762,-16911.3227 2301.3853,-16902.2164 2372.6286,-16866.391 2399.2978,-16881.3897 2474.269,-16854.2164 2569.6076,-16819.6609 2590.5187,-16803.6088 2682.1736,-16760.2164 3119.2235,-16553.3023 3364.8888,-16586.9886 3588.4519,-16158.2164 3643.3352,-16052.9556 3658.4768,-7852.1498 3659.3056,-7378.5512"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3662.806,-7378.2983 3659.3235,-7368.2922 3655.806,-7378.2861 3662.806,-7378.2983"/>
</g>
<!-- sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge603" class="edge">
<title>sourcefile~hvacunitarysystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3542.4312,-4080.3585C3557.7014,-4091.4367 3579.0781,-4109.9631 3588.4519,-4132.2164 3657.4692,-4296.0625 3542.328,-7174.5312 3624.4519,-7332.2164 3625.8072,-7334.8187 3627.5711,-7337.212 3629.5856,-7339.3989"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3627.3432,-7342.0875 3637.1719,-7346.0433 3631.9553,-7336.8217 3627.3432,-7342.0875"/>
</g>
<!-- sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge604" class="edge">
<title>sourcefile~desiccantdehumidifiers.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3189.7648,-11894.196C3230.643,-11864.6852 3341.4681,-11786.3519 3360.8456,-11790.2164"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge609" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3361.0312,-4348.4077C3363.9539,-4522.743 3401.2489,-6679.092 3462.2747,-6951.2164 3472.3424,-6996.1103 3595.6742,-7296.3184 3624.4519,-7332.2164 3626.6629,-7334.9745 3629.2526,-7337.5689 3632.0046,-7339.9655"/>
<polygon fill="#0000ff" stroke="#0000ff" points="3629.9621,-7342.8105 3640.011,-7346.1678 3634.249,-7337.2767 3629.9621,-7342.8105"/>
</g>
<!-- sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge323" class="edge">
<title>sourcefile~hvacdxsystem.f90&#45;&gt;sourcefile~hvacunitarysystem.f90</title>
<path fill="none" stroke="#aaff00" stroke-dasharray="5,2" d="M3366.0523,-4326.1685C3384.975,-4286.0924 3449.6515,-4149.7945 3462.2747,-4132.2164 3474.3873,-4115.3491 3491.1305,-4098.8589 3504.3246,-4086.9828"/>
<polygon fill="#aaff00" stroke="#aaff00" points="3506.8124,-4089.4558 3512.008,-4080.2223 3502.1883,-4084.2004 3506.8124,-4089.4558"/>
</g>
<!-- sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge612" class="edge">
<title>sourcefile~photovoltaicthermalcollectors.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2620.2446,-11342.1684C2707.7142,-11303.7727 3012.5323,-11186.2638 3174.6229,-11333.2164"/>
</g>
<!-- sourcefile~hvacevapcomponent.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge613" class="edge">
<title>sourcefile~hvacevapcomponent.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2797.2516,-12675.3118C2798.439,-12760.4601 2810.0248,-13310.1762 2912.0764,-13432.2164 2933.4108,-13457.7294 2950.1008,-13461.3944 2982.9529,-13456.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2982.9529,-13456.2164C3015.8049,-13451.0383 3034.1107,-13458.9978 3053.8293,-13432.2164 3148.5923,-13303.5116 2998.9641,-12125.7019 3089.8293,-11994.2164 3136.0909,-11927.2741 3200.147,-11980.9705 3259.4165,-11925.2164 3286.3479,-11899.8823 3273.3923,-11879.9156 3295.4165,-11850.2164 3318.9186,-11818.5243 3322.1521,-11782.4998 3360.8456,-11790.2164"/>
</g>
<!-- sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge616" class="edge">
<title>sourcefile~hvactranspiredcollector.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2596.5628,-14646.4128C2599.1704,-14723.6073 2618.6196,-15176.2606 2718.1736,-15258.2164 3049.2459,-15530.7647 2784.1776,-14932.8904 3174.6229,-14634.2164"/>
</g>
<!-- sourcefile~userdefinedcomponents.f90&#45;&gt;sourcefile~mixedair.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge622" class="edge">
<title>sourcefile~userdefinedcomponents.f90&#45;&gt;sourcefile~mixedair.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M3174.6229,-7203.2164C3210.7744,-7216.8038 3225.3155,-7204.0871 3259.4165,-7222.2164 3278.8489,-7232.5473 3276.7028,-7244.6344 3295.4165,-7256.2164 3321.7545,-7272.517 3332.3831,-7267.9981 3360.8456,-7280.2164"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M2635.0502,-7041.1749C2690.2777,-7027.4432 2793.9269,-7009.0302 2876.0764,-7037.2164 2895.2491,-7043.7947 2894.2278,-7055.6095 2912.0764,-7065.2164 2970.6465,-7096.7412 2994.9361,-7082.2995 3053.8293,-7113.2164 3113.1069,-7144.335 3111.954,-7179.6623 3174.6229,-7203.2164"/>
</g>
<!-- sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge442" class="edge">
<title>sourcefile~packagedthermalstoragecoil.f90&#45;&gt;sourcefile~hvacdxsystem.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M3185.44,-4156.369C3216.1677,-4188.05 3304.2281,-4278.8424 3342.6026,-4318.4074"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="3340.524,-4321.2915 3349.9987,-4326.033 3345.5488,-4316.4179 3340.524,-4321.2915"/>
</g>
<!-- sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge439" class="edge">
<title>sourcefile~plantwaterthermaltank.f90&#45;&gt;sourcefile~packagedthermalstoragecoil.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2983.9516,-5011.0219C2991.3093,-4929.5839 3038.2708,-4427.3296 3089.8293,-4284.2164 3106.5419,-4237.8267 3139.8472,-4190.1201 3159.374,-4164.4291"/>
<polygon fill="#ff0000" stroke="#ff0000" points="3162.3118,-4166.3514 3165.6564,-4156.2983 3156.7726,-4162.0714 3162.3118,-4166.3514"/>
</g>
<!-- sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge387" class="edge">
<title>sourcefile~plantsolarcollectors.f90&#45;&gt;sourcefile~plantwaterthermaltank.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2409.925,-3814.3274C2429.3756,-3825.1411 2457.1872,-3843.2806 2474.269,-3866.2164 2502.9841,-3904.7722 2481.4595,-3929.731 2510.269,-3968.2164 2538.4963,-4005.9238 2565.582,-3994.4413 2596.2213,-4030.2164"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M2596.2213,-4030.2164C2735.4009,-4192.7252 2939.1164,-4872.5478 2976.8301,-5001.1677"/>
<polygon fill="#ff0000" stroke="#ff0000" points="2973.5339,-5002.3663 2979.6989,-5010.9827 2980.2528,-5000.4024 2973.5339,-5002.3663"/>
</g>
<!-- sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge504" class="edge">
<title>sourcefile~dataphotovoltaics.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M443.7461,-15635.2743C456.0813,-15639.0151 469.2808,-15643.6768 480.9653,-15649.2164 582.1596,-15697.1919 583.3053,-15756.7052 690.4731,-15789.2164 745.4735,-15805.9017 763.1435,-15798.9249 819.7932,-15789.2164 1052.6516,-15749.3096 1122.6867,-15740.5748 1321.0291,-15612.2164 1440.6279,-15534.8173 1428.674,-15466.2756 1542.2007,-15380.2164 1607.1681,-15330.9676 1657.4336,-15360.9786 1704.2205,-15294.2164 1770.1601,-15200.1241 1709.6992,-15148.9857 1740.2205,-15038.2164 1760.216,-14965.6476 2245.6671,-13861.861 2265.3853,-13789.2164 2297.2134,-13671.9567 2260.1982,-13632.5251 2301.3853,-13518.2164 2350.451,-13382.0414 2432.8416,-13380.9061 2474.269,-13242.2164 2528.9471,-13059.1664 2464.0179,-11708.575 2510.269,-11523.2164 2524.8537,-11464.7661 2562.2006,-11403.4251 2582.5328,-11372.9006"/>
<polygon fill="#00a9ff" stroke="#00a9ff" points="2585.5434,-11374.6967 2588.2524,-11364.4541 2579.7473,-11370.7718 2585.5434,-11374.6967"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge510" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~photovoltaicthermalcollectors.f90</title>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M1998.0472,-13369.9813C2015.2452,-13347.152 2053.9112,-13293.1764 2075.5532,-13242.2164 2101.0035,-13182.289 2087.5012,-13160.7185 2111.5532,-13100.2164 2137.4926,-13034.9666 2160.6963,-13026.7071 2188.4692,-12962.2164"/>
<path fill="none" stroke="#00a9ff" stroke-dasharray="5,2" d="M2188.4692,-12962.2164C2216.2422,-12897.7257 2243.5506,-12890.9519 2265.3853,-12824.2164 2305.6351,-12701.1964 2235.2527,-12646.4839 2301.3853,-12535.2164 2325.5412,-12494.5742 2372.4852,-12517.9369 2387.8271,-12473.2164"/>
</g>
<!-- sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge550" class="edge">
<title>sourcefile~heatbalanceconvectioncoeffs.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1990.4273,-13392.3283C1996.629,-13456.4224 2031.239,-13784.9261 2111.5532,-14040.2164 2172.7849,-14234.8502 2165.5902,-14305.9293 2301.3853,-14458.2164 2374.3664,-14540.061 2494.3964,-14595.5771 2556.3937,-14620.4136"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="2555.2428,-14623.722 2565.8296,-14624.1356 2557.8114,-14617.2103 2555.2428,-14623.722"/>
</g>
<!-- sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge472" class="edge">
<title>sourcefile~vectorutilities.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M912.1098,-15249.9229C919.166,-15175.2818 966.7823,-14747.349 1152.5955,-14468.2164 1330.4379,-14201.0577 1536.9438,-14276.1146 1704.2205,-14002.2164 1746.7431,-13932.59 1709.8394,-13897.9329 1740.2205,-13822.2164 1779.4317,-13724.4932 1827.9064,-13719.8972 1867.2231,-13622.2164 1897.3606,-13547.3411 1859.7012,-13512.1899 1903.2231,-13444.2164 1916.1899,-13423.9647 1938.1506,-13408.0565 1956.6556,-13397.292"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1958.3697,-13400.3437 1965.4077,-13392.4243 1954.9672,-13394.2262 1958.3697,-13400.3437"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge665" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~branchinputmanager.f90</title>
<path fill="none" stroke="#00ff86" stroke-dasharray="5,2" d="M1434.8638,-6234.9657C1446.9348,-6192.5956 1489.3698,-6038.4348 1506.2007,-5908.2164 1557.6296,-5510.3182 1499.1997,-5405.1134 1542.2007,-5006.2164 1586.5585,-4594.7323 1664.8764,-4501.2101 1704.2205,-4089.2164 1753.1738,-3576.5975 1673.0952,-2282.7737 1740.2205,-1772.2164 1751.7574,-1684.4657 1782.6891,-1583.2437 1796.6786,-1540.2621"/>
<polygon fill="#00ff86" stroke="#00ff86" points="1800.0459,-1541.2261 1799.848,-1530.6331 1793.3969,-1539.0374 1800.0459,-1541.2261"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge816" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~nodeinputmanager.f90</title>
<path fill="none" stroke="#ff00f1" stroke-dasharray="5,2" d="M1437.559,-6257.2921C1464.6545,-6307.779 1576.6718,-6516.5007 1612.2868,-6582.8622"/>
<polygon fill="#ff00f1" stroke="#ff00f1" points="1609.333,-6584.7599 1617.1459,-6591.916 1615.5009,-6581.4496 1609.333,-6584.7599"/>
</g>
<!-- sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge476" class="edge">
<title>sourcefile~dataerrortracking.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1433.2437,-6257.2817C1442.5631,-6321.1644 1489.3014,-6649.3671 1506.2007,-6919.2164 1523.1962,-7190.603 1491.3017,-9099.1043 1542.2007,-9366.2164 1580.2732,-9566.0169 1666.0846,-9594.4279 1704.2205,-9794.2164 1753.1001,-10050.2904 1706.6205,-11881.6933 1740.2205,-12140.2164 1770.4377,-12372.7127 1819.5905,-12422.6542 1867.2231,-12652.2164 1924.9199,-12930.2817 1974.1557,-13272.3641 1986.4432,-13359.9921"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1982.9943,-13360.6017 1987.8436,-13370.0216 1989.927,-13359.6336 1982.9943,-13360.6017"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge547" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~hvactranspiredcollector.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M1836.4116,-15232.1453C1846.5305,-15228.2462 1857.5547,-15223.5017 1867.2231,-15218.2164 1884.541,-15208.7495 1884.7153,-15199.0713 1903.2231,-15192.2164 2022.527,-15148.0288 2069.1353,-15212.3226 2188.4692,-15168.2164"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M2188.4692,-15168.2164C2248.2538,-15144.8855 2244.223,-15107.3883 2301.3853,-15078.2164 2336.8997,-15060.0921 2354.4145,-15075.9733 2387.8271,-15054.2164"/>
</g>
<!-- sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge485" class="edge">
<title>sourcefile~dataheatbalsurface.f90&#45;&gt;sourcefile~heatbalanceconvectioncoeffs.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1804.8593,-15231.8086C1819.3433,-15086.5522 1967.6046,-13599.6784 1987.244,-13402.7195"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1990.7529,-13402.8034 1988.2625,-13392.5054 1983.7875,-13402.1088 1990.7529,-13402.8034"/>
</g>
<!-- sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge698" class="edge">
<title>sourcefile~datacomplexfenestration.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M455.8838,-5103.2926C548.8998,-5124.673 732.1119,-5181.0414 819.7932,-5306.2164 857.5563,-5360.1274 841.9704,-5535.8629 855.7932,-5600.2164 873.1907,-5681.2125 874.381,-5703.9608 911.1119,-5778.2164"/>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M911.1119,-5778.2164C936.4675,-5824.021 948.654,-5832.9725 966.4307,-5882.2164 993.245,-5956.4958 966.6595,-5985.8113 1002.4307,-6056.2164 1011.2054,-6073.4868 1025.9871,-6089.6082 1038.3097,-6101.2192"/>
<polygon fill="#00d6ff" stroke="#00d6ff" points="1036.2068,-6104.0371 1045.9645,-6108.1647 1040.9105,-6098.853 1036.2068,-6104.0371"/>
</g>
<!-- sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge702" class="edge">
<title>sourcefile~dataequivalentlayerwindow.f90&#45;&gt;sourcefile~dataheatbalance.f90</title>
<path fill="none" stroke="#00d6ff" stroke-dasharray="5,2" d="M401.4395,-4625.0783C409.7135,-4589.1265 441.149,-4475.97 516.9653,-4432.2164 569.8978,-4401.669 609.2145,-4391.1476 654.4731,-4432.2164 715.6507,-4487.7304 673.2415,-4721.423 690.4731,-4802.2164 728.2127,-4979.164 776.4317,-5012.5618 819.7932,-5188.2164 843.7488,-5285.2588 832.7479,-5312.9537 855.7932,-5410.2164 874.6976,-5490.0024 891.8616,-5506.5131 911.1119,-5586.2164"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge712" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~branchnodeconnections.f90</title>
<path fill="none" stroke="#005dff" stroke-dasharray="5,2" d="M1251.3857,-11316.1016C1271.3056,-11299.9262 1306.2467,-11267.8075 1321.0291,-11231.2164 1352.4044,-11153.5524 1349.8058,-10561.6666 1357.0291,-10478.2164 1376.5063,-10253.1945 1416.6619,-9982.1727 1428.354,-9905.3965"/>
<polygon fill="#005dff" stroke="#005dff" points="1431.8144,-9905.9212 1429.8667,-9895.5069 1424.8948,-9904.8627 1431.8144,-9905.9212"/>
</g>
<!-- sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge788" class="edge">
<title>sourcefile~databranchnodeconnections.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1989.3882,-10954.2164C2094.8776,-10908.1938 2370.8267,-10822.6721 2474.269,-10772.2164 2491.1222,-10763.9959 2493.0751,-10757.698 2510.269,-10750.2164 2546.6375,-10734.3914 2571.1985,-10756.989 2596.2213,-10726.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M1301.819,-11316.0398C1309.0231,-11312.5743 1315.6762,-11308.0683 1321.0291,-11302.2164 1375.5059,-11242.661 1310.8406,-11190.407 1357.0291,-11124.2164 1412.3344,-11044.9606 1451.0311,-11042.283 1542.2007,-11010.2164 1731.1558,-10943.756 1796.1032,-11006.7705 1989.3882,-10954.2164"/>
</g>
<!-- sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~EfferentGraph_edge776" class="edge">
<title>sourcefile~standardratings.f90&#45;&gt;sourcefile~dxcoil.f90</title>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2596.2213,-10726.2164C2692.9438,-10611.3675 2782.6341,-9470.8152 2795.5378,-9300.4565"/>
<polygon fill="#4300ff" stroke="#4300ff" points="2799.0437,-9300.509 2796.3048,-9290.2743 2792.0635,-9299.9831 2799.0437,-9300.509"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2201.8723,-10504.3439C2232.4965,-10529.027 2310.9078,-10588.0849 2387.8271,-10612.2164"/>
<path fill="none" stroke="#4300ff" stroke-dasharray="5,2" d="M2387.8271,-10612.2164C2488.5586,-10643.8182 2528.2153,-10806.9672 2596.2213,-10726.2164"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacfurnacef90EfferentGraph = svgPanZoom('#sourcefilehvacfurnacef90EfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <h3>Files Dependent On This One</h3>

                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~hvacfurnace.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilehvacfurnacef90AfferentGraph" width="641pt" height="61pt"
 viewBox="0.00 0.00 641.00 60.73" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph" class="graph" transform="scale(.4672 .4672) rotate(0) translate(4 125.9768)">
<title>sourcefile~~hvacfurnace.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-125.9768 1367.9585,-125.9768 1367.9585,4 -4,4"/>
<!-- sourcefile~hvacfurnace.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~hvacfurnace.f90</title>
<polygon fill="none" stroke="#000000" points="96.647,-74.9823 -.2163,-74.9823 -.2163,-52.9714 96.647,-52.9714 96.647,-74.9823"/>
<text text-anchor="middle" x="48.2153" y="-60.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">HVACFurnace.f90</text>
</g>
<!-- sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~simairservingzones.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/simairservingzones.f90.html" xlink:title="SimAirServingZones.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="257.7509,-74.9823 132.3238,-74.9823 132.3238,-52.9714 257.7509,-52.9714 257.7509,-74.9823"/>
<text text-anchor="middle" x="195.0374" y="-60.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimAirServingZones.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~hvacfurnace.f90&#45;&gt;sourcefile~simairservingzones.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M96.6973,-63.9768C104.8621,-63.9768 113.4937,-63.9768 122.1163,-63.9768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="122.2059,-67.4769 132.2059,-63.9768 122.2059,-60.4769 122.2059,-67.4769"/>
</g>
<!-- sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~sizingmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node3"><a xlink:href="../sourcefile/sizingmanager.f90.html" xlink:title="SizingManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1075.923,-93.9823 976.9655,-93.9823 976.9655,-71.9714 1075.923,-71.9714 1075.923,-93.9823"/>
<text text-anchor="middle" x="1026.4442" y="-79.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SizingManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M229.8574,-75.0227C286.0829,-91.8509 400.6283,-121.9768 500.0914,-121.9768 500.0914,-121.9768 500.0914,-121.9768 691.1052,-121.9768 802.4701,-121.9768 830.8884,-119.9335 940.9548,-102.9768 952.0276,-101.271 963.7892,-98.896 974.9313,-96.3768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="976.0096,-99.7193 984.9523,-94.0377 974.4184,-92.9025 976.0096,-99.7193"/>
</g>
<!-- sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~hvacmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node4"><a xlink:href="../sourcefile/hvacmanager.f90.html" xlink:title="HVACManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="392.3125,-35.9823 293.7544,-35.9823 293.7544,-13.9714 392.3125,-13.9714 392.3125,-35.9823"/>
<text text-anchor="middle" x="343.0334" y="-21.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HVACManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~simairservingzones.f90&#45;&gt;sourcefile~hvacmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M237.0512,-52.9053C253.8389,-48.4814 273.3462,-43.3409 291.0148,-38.6848"/>
<polygon fill="#ff0000" stroke="#ff0000" points="292.3929,-41.9412 301.1709,-36.0085 290.6091,-35.1723 292.3929,-41.9412"/>
</g>
<!-- sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~simulationmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node5"><a xlink:href="../sourcefile/simulationmanager.f90.html" xlink:title="SimulationManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1231.5411,-73.9823 1111.7306,-73.9823 1111.7306,-51.9714 1231.5411,-51.9714 1231.5411,-73.9823"/>
<text text-anchor="middle" x="1171.6359" y="-59.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">SimulationManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~sizingmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1076.0049,-76.1499C1084.2712,-75.0112 1092.9821,-73.8113 1101.6436,-72.6182"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1102.3302,-76.0568 1111.759,-71.2248 1101.3749,-69.1222 1102.3302,-76.0568"/>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M875.7026,-43.9768C942.6988,-43.8861 959.448,-43.9274 1026.4442,-43.9768"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M1026.4442,-43.9768C1051.8025,-43.9955 1079.4429,-46.8844 1103.7371,-50.4038"/>
<polygon fill="#00ffff" stroke="#00ffff" points="1103.5168,-53.9102 1113.9276,-51.9442 1104.5631,-46.9888 1103.5168,-53.9102"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M381.8091,-13.9071C396.3057,-10.2966 412.9952,-6.7594 428.4229,-4.9768 491.7072,2.3355 508.274,.3059 571.76,-4.9768 625.3567,-9.4366 637.6036,-19.4926 691.1052,-24.9768"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M691.1052,-24.9768C773.3179,-31.5716 793.226,-44.0885 875.7026,-43.9768"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~heatbalanceairmanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node8"><a xlink:href="../sourcefile/heatbalanceairmanager.f90.html" xlink:title="HeatBalanceAirManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="571.929,-35.9823 428.2539,-35.9823 428.2539,-13.9714 571.929,-13.9714 571.929,-35.9823"/>
<text text-anchor="middle" x="500.0914" y="-21.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceAirManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~hvacmanager.f90&#45;&gt;sourcefile~heatbalanceairmanager.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M392.7276,-24.9768C400.8664,-24.9768 409.485,-24.9768 418.1591,-24.9768"/>
<polygon fill="#00ffff" stroke="#00ffff" points="418.3419,-28.4769 428.3419,-24.9768 418.3418,-21.4769 418.3419,-28.4769"/>
</g>
<!-- sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~energyplus.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node6"><a xlink:href="../sourcefile/energyplus.f90.html" xlink:title="EnergyPlus.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1357.3568,-94.9823 1273.9398,-94.9823 1273.9398,-72.9714 1357.3568,-72.9714 1357.3568,-94.9823"/>
<text text-anchor="middle" x="1315.6483" y="-80.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">EnergyPlus.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~energyplus.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1231.459,-71.7003C1242.1236,-73.2554 1253.1554,-74.8641 1263.5818,-76.3844"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1263.3698,-79.8905 1273.7703,-77.8701 1264.38,-72.9637 1263.3698,-79.8905"/>
</g>
<!-- sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~utilityroutines.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node7"><a xlink:href="../sourcefile/utilityroutines.f90.html" xlink:title="UtilityRoutines.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1363.7694,-53.9823 1267.5272,-53.9823 1267.5272,-31.9714 1363.7694,-31.9714 1363.7694,-53.9823"/>
<text text-anchor="middle" x="1315.6483" y="-39.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">UtilityRoutines.f90</text>
</a>
</g>
</g>
<!-- sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~simulationmanager.f90&#45;&gt;sourcefile~utilityroutines.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1231.459,-54.6688C1239.9199,-53.4938 1248.612,-52.2866 1257.0495,-51.1149"/>
<polygon fill="#ff0000" stroke="#ff0000" points="1257.7589,-54.55 1267.1824,-49.7076 1256.796,-47.6166 1257.7589,-54.55"/>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M571.9258,-21.5194C607.8135,-20.6698 651.848,-20.9527 691.1052,-24.9768"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~heatbalancesurfacemanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node9"><a xlink:href="../sourcefile/heatbalancesurfacemanager.f90.html" xlink:title="HeatBalanceSurfaceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="774.2959,-74.9823 607.9145,-74.9823 607.9145,-52.9714 774.2959,-52.9714 774.2959,-74.9823"/>
<text text-anchor="middle" x="691.1052" y="-60.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceSurfaceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~heatbalanceairmanager.f90&#45;&gt;sourcefile~heatbalancesurfacemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M554.0624,-35.9963C576.7474,-40.628 603.3151,-46.0524 626.988,-50.8858"/>
<polygon fill="#ff0000" stroke="#ff0000" points="626.4385,-54.3457 636.9366,-52.917 627.8389,-47.4872 626.4385,-54.3457"/>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M760.1641,-52.9685C794.7572,-48.354 837.3422,-44.0288 875.7026,-43.9768"/>
</g>
<!-- sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~heatbalancemanager.f90</title>
<g id="a_sourcefile~~hvacfurnace.f90~~AfferentGraph_node10"><a xlink:href="../sourcefile/heatbalancemanager.f90.html" xlink:title="HeatBalanceManager.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="940.708,-93.9823 810.6973,-93.9823 810.6973,-71.9714 940.708,-71.9714 940.708,-93.9823"/>
<text text-anchor="middle" x="875.7026" y="-79.8268" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">HeatBalanceManager.f90</text>
</a>
</g>
</g>
<!-- sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~heatbalancesurfacemanager.f90&#45;&gt;sourcefile~heatbalancemanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M774.4929,-72.5596C783.2145,-73.4573 792.0432,-74.366 800.6636,-75.2533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="800.3628,-78.7408 810.6687,-76.2831 801.0796,-71.7775 800.3628,-78.7408"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~sizingmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M940.9434,-82.9768C949.4287,-82.9768 958.0885,-82.9768 966.482,-82.9768"/>
<polygon fill="#ff0000" stroke="#ff0000" points="966.5586,-86.4769 976.5585,-82.9768 966.5585,-79.4769 966.5586,-86.4769"/>
</g>
<!-- sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90 -->
<g id="sourcefile~~hvacfurnace.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~heatbalancemanager.f90&#45;&gt;sourcefile~simulationmanager.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M901.8574,-71.893C931.5102,-60.3519 981.5709,-43.9437 1026.4442,-43.9768"/>
</g>
</g>
</svg>
</div>
                <script>var pansourcefilehvacfurnacef90AfferentGraph = svgPanZoom('#sourcefilehvacfurnacef90AfferentGraph', {
                    zoomEnabled: true,
                    controlIconsEnabled: true,
                    fit: true,
                    center: true,});
                    </script>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">

    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="186pt" height="31pt"
 viewBox="0.00 0.00 186.41 30.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 26.5)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-26.5 182.4064,-26.5 182.4064,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="65.1576,-22.2554 -.0526,-22.2554 -.0526,-.2446 65.1576,-.2446 65.1576,-22.2554"/>
<text text-anchor="middle" x="32.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="178.2607,-22.2554 82.8443,-22.2554 82.8443,-.2446 178.2607,-.2446 178.2607,-22.2554"/>
<text text-anchor="middle" x="130.5525" y="-8.1" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>


    <p>Solid arrows point from a file to a file which depends upon it. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>

                      </div>
                    </div>
                  </div>
                </div>


      <br>

    <section class="visible-xs visible-sm hidden-md">


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../module/furnaces.html">Furnaces</a>

    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html#src">HVACFurnace.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">Module </span><span class="n">Furnaces</span>
<a name="ln-2"></a>  <span class="c">! Module containing the Furnace and Unitary System simulation routines</span>
<a name="ln-3"></a>
<a name="ln-4"></a>
<a name="ln-5"></a>  <span class="c">! MODULE INFORMATION:</span>
<a name="ln-6"></a>  <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-7"></a>  <span class="c">!       DATE WRITTEN   Jan 2001</span>
<a name="ln-8"></a>  <span class="c">!       MODIFIED       Richard Liesen, Feb 2001; Don Shirey, Mar/Oct 2001, Oct 2003</span>
<a name="ln-9"></a>  <span class="c">!                      Richard Raustad, Nov 2006 - allow draw through fan and alternate air flow in cooling,</span>
<a name="ln-10"></a>  <span class="c">!                      heating, and when no cooling or heating is required.</span>
<a name="ln-11"></a>  <span class="c">!                      Bereket Nigusse, FSEC, June 2010 - deprecated supply air flow fraction through controlled</span>
<a name="ln-12"></a>  <span class="c">!                      zone from the furnace object input field. Now, the flow fraction is calculated internally</span>
<a name="ln-13"></a>  <span class="c">!                      B. Nigusse, FSEC, Jan 2012 - added steam and hot water heating coils as an option</span>
<a name="ln-14"></a>  <span class="c">!                      Bo Shen, ORNL, March 2012 - added variable-speed water source heat pump cooling and heating coils, using curve-fits</span>
<a name="ln-15"></a>  <span class="c">!                      Bo Shen, ORNL, July 2012 - added variable-speed air source heat pump cooling and heating coils, using curve-fits</span>
<a name="ln-16"></a>  <span class="c">!</span>
<a name="ln-17"></a>  <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-18"></a>
<a name="ln-19"></a>
<a name="ln-20"></a>  <span class="c">! PURPOSE OF THIS MODULE:</span>
<a name="ln-21"></a>  <span class="c">! To encapsulate the data and algorithms required to</span>
<a name="ln-22"></a>  <span class="c">! manage the Furnace/Unitary System Compound Component</span>
<a name="ln-23"></a>
<a name="ln-24"></a>
<a name="ln-25"></a>  <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-26"></a>  <span class="c">! Calculates the part-load ratio of the HVAC system to meet the zone sensible load. For non-heat pump HVAC systems,</span>
<a name="ln-27"></a>  <span class="c">! if humidity control is specified and the latent capacity at the sensible PLR is insufficient to meet the latent load,</span>
<a name="ln-28"></a>  <span class="c">! calculate a latent part-load ratio to meet the zone sensible load (MultiMode dehumidificaiton control) or the zone</span>
<a name="ln-29"></a>  <span class="c">! latent load (CoolReheat dehumidification control). Use the greater of the sensible PLR and latent PLR to control</span>
<a name="ln-30"></a>  <span class="c">! the HVAC system.</span>
<a name="ln-31"></a>  <span class="c">!</span>
<a name="ln-32"></a>  <span class="c">! Subroutines:</span>
<a name="ln-33"></a>  <span class="c">!</span>
<a name="ln-34"></a>  <span class="c">! SimFurnace - Top level simulate routine CALLed by other modules. Each child object is simulated a final time after</span>
<a name="ln-35"></a>  <span class="c">!              the part-load ratio for child components has been determined.</span>
<a name="ln-36"></a>  <span class="c">!</span>
<a name="ln-37"></a>  <span class="c">!  Note: A supplemental heater augments the heating capacity for both air-to-air and water-to-air heat pump systems.</span>
<a name="ln-38"></a>  <span class="c">!        A reheat coil is used for the HeatCool furnace/unitarysystem to offset the sensible cooling when the</span>
<a name="ln-39"></a>  <span class="c">!        dehumidification control type is COOLREHEAT. Both the supplemental and reheat heating coil load is calculated</span>
<a name="ln-40"></a>  <span class="c">!        in the Calc routines. The actual simulation of these coils is performed in the SimFurnace routine (i.e. the</span>
<a name="ln-41"></a>  <span class="c">!        supplemental and reheat coil loads are passed as 0 to CalcFurnaceOutput).</span>
<a name="ln-42"></a>  <span class="c">!</span>
<a name="ln-43"></a>  <span class="c">! CalcNewZoneHeatOnlyFlowRates - HeatOnly furnace/unitarysystem routine.</span>
<a name="ln-44"></a>  <span class="c">!                                Calculates a part-load ratio to meet the sensible load.</span>
<a name="ln-45"></a>  <span class="c">!</span>
<a name="ln-46"></a>  <span class="c">! CalcNewZoneHeatCoolFlowRates - HeatCool furnace/unitarysystem and air-to-air HeatPump routine.</span>
<a name="ln-47"></a>  <span class="c">!                                Calculates a part-load ratio for the system (sensible and/or latent).</span>
<a name="ln-48"></a>  <span class="c">!                                For dehumidification control type COOLREHEAT, both a sensible and latent PLR</span>
<a name="ln-49"></a>  <span class="c">!                                may exist for a single time step (heating and dehumidificaiton can occur). For all</span>
<a name="ln-50"></a>  <span class="c">!                                other system types, only a single PLR is allowed for any given time step.</span>
<a name="ln-51"></a>  <span class="c">!                                Order of simulation depends on dehumidification control option as described below.</span>
<a name="ln-52"></a>  <span class="c">!</span>
<a name="ln-53"></a>  <span class="c">! Dehumidificaiton control options (non-heat pump versions):</span>
<a name="ln-54"></a>  <span class="c">!</span>
<a name="ln-55"></a>  <span class="c">! Dehumidification Control NONE:   Cooling performance is simulated first and then heating performance. If a HX</span>
<a name="ln-56"></a>  <span class="c">!                                  assisted cooling coil is selected, the HX is always active (cooling).</span>
<a name="ln-57"></a>  <span class="c">!</span>
<a name="ln-58"></a>  <span class="c">! Dehumidification Control COOLREHEAT: For cooling operation, the sensible capacity is calculated to</span>
<a name="ln-59"></a>  <span class="c">!                                      meet the thermostat setpoint. If a HX assisted cooling coil is selected,</span>
<a name="ln-60"></a>  <span class="c">!                                      the HX is always active. If the latent load is not met by operating the</span>
<a name="ln-61"></a>  <span class="c">!                                      system at the sensible PLR, a new PLR is calculated to meet the humidistat</span>
<a name="ln-62"></a>  <span class="c">!                                      setpoint. The reheat coil load is then calculated to meet the HEATING</span>
<a name="ln-63"></a>  <span class="c">!                                      setpoint temperature.</span>
<a name="ln-64"></a>  <span class="c">!</span>
<a name="ln-65"></a>  <span class="c">! Dehumidification Control MULTIMODE: For cooling operation, the sensible capacity is calculated to</span>
<a name="ln-66"></a>  <span class="c">!                                     meet the thermostat setpoint. If a HX assisted cooling coil is selected,</span>
<a name="ln-67"></a>  <span class="c">!                                     the HX is off for this calculation. If the latent load is not met by operating</span>
<a name="ln-68"></a>  <span class="c">!                                     the system at the sensible PLR, a new PLR is calculated with the HX operating</span>
<a name="ln-69"></a>  <span class="c">!                                     and the target is the zone SENSIBLE load (thermostat setpoint). Humidity is not</span>
<a name="ln-70"></a>  <span class="c">!                                     controlled in this mode. No reheat coil is used in this configuration.</span>
<a name="ln-71"></a>  <span class="c">!</span>
<a name="ln-72"></a>  <span class="c">! CalcWaterToAirHeatPump - Water-to-air HeatPump routine.</span>
<a name="ln-73"></a>  <span class="c">!                          Calculates a part-load ratio to meet the sensible load.</span>
<a name="ln-74"></a>  <span class="c">!</span>
<a name="ln-75"></a>  <span class="c">!</span>
<a name="ln-76"></a>  <span class="c">! CalcFurnaceOutput - Simulates each child component in order.</span>
<a name="ln-77"></a>  <span class="c">!                     For cooling operation, the heating coil is off.</span>
<a name="ln-78"></a>  <span class="c">!                     For heating operation, the cooling coil is off.</span>
<a name="ln-79"></a>  <span class="c">!                     Reheat or supplemental heating coil is simulated here just to pass the inlet node conditions</span>
<a name="ln-80"></a>  <span class="c">!                     to the output node (actual simulation of these coils is done on the final simulation of the</span>
<a name="ln-81"></a>  <span class="c">!                     child components in SimFurnace).</span>
<a name="ln-82"></a>  <span class="c">!                     Fan is simulated based on placement (drawthru or blowthru).</span>
<a name="ln-83"></a>  <span class="c">!</span>
<a name="ln-84"></a>  <span class="c">! REFERENCES:</span>
<a name="ln-85"></a>
<a name="ln-86"></a>
<a name="ln-87"></a>
<a name="ln-88"></a>  <span class="c">! OTHER NOTES:</span>
<a name="ln-89"></a>  <span class="c">!</span>
<a name="ln-90"></a>
<a name="ln-91"></a>
<a name="ln-92"></a>  <span class="c">! USE STATEMENTS:</span>
<a name="ln-93"></a>  <span class="c">! Use statements for data only modules</span>
<a name="ln-94"></a><span class="k">USE </span><span class="n">DataPrecisionGlobals</span>
<a name="ln-95"></a><span class="k">USE </span><span class="n">DataLoopNode</span>
<a name="ln-96"></a><span class="k">USE </span><span class="n">DataGlobals</span>
<a name="ln-97"></a><span class="k">USE </span><span class="n">DataHVACGlobals</span>
<a name="ln-98"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">StdBaroPress</span><span class="p">,</span> <span class="n">OutDryBulbTemp</span><span class="p">,</span> <span class="n">StdRhoAir</span>
<a name="ln-99"></a>
<a name="ln-100"></a><span class="k">USE </span><span class="n">DataZoneEquipment</span>
<a name="ln-101"></a><span class="k">USE </span><span class="n">DataInterfaces</span>
<a name="ln-102"></a><span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">PsyHfgAirFnWTdb</span><span class="p">,</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">,</span> <span class="n">PsyHFnTdbW</span><span class="p">,</span> <span class="n">PsyTdbFnHW</span><span class="p">,</span><span class="n">PsyRhoAirFnPbTdbW</span>
<a name="ln-103"></a>
<a name="ln-104"></a>
<a name="ln-105"></a>  <span class="c">! Use statements for access to subroutines in other modules</span>
<a name="ln-106"></a><span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-107"></a><span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-108"></a><span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimDXCoil</span>
<a name="ln-109"></a><span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span><span class="n">MaxSpedLevels</span>
<a name="ln-110"></a>
<a name="ln-111"></a>
<a name="ln-112"></a><span class="k">IMPLICIT NONE</span>         <span class="c">! Enforce explicit typing of all variables</span>
<a name="ln-113"></a>
<a name="ln-114"></a>
<a name="ln-115"></a><span class="k">PRIVATE</span> <span class="c">! Everything private unless explicitly made public</span>
<a name="ln-116"></a>
<a name="ln-117"></a>
<a name="ln-118"></a>  <span class="c">!MODULE PARAMETER DEFINITIONS</span>
<a name="ln-119"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Blank</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-120"></a>
<a name="ln-121"></a><span class="c">! Last mode of operation</span>
<a name="ln-122"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">CoolingMode</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! last compressor operating mode was in cooling</span>
<a name="ln-123"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">HeatingMode</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! last compressor operating mode was in heating</span>
<a name="ln-124"></a><span class="c">! Airflow control for contant fan mode</span>
<a name="ln-125"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseCompressorOnFlow</span> <span class="o">=</span> <span class="mi">1</span> <span class="c">! set compressor OFF air flow rate equal to compressor ON air flow rate</span>
<a name="ln-126"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">UseCompressorOffFlow</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! set compressor OFF air flow rate equal to user defined value</span>
<a name="ln-127"></a><span class="c">! Compressor operation</span>
<a name="ln-128"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">On</span> <span class="o">=</span>  <span class="mi">1</span>              <span class="c">! normal compressor operation</span>
<a name="ln-129"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Off</span> <span class="o">=</span> <span class="mi">0</span>              <span class="c">! signal DXCoil that compressor shouldn&#39;t run</span>
<a name="ln-130"></a>
<a name="ln-131"></a>
<a name="ln-132"></a><span class="c">! Dehumidification control modes (DehumidControlMode)</span>
<a name="ln-133"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DehumidControl_None</span>       <span class="o">=</span> <span class="mi">0</span>
<a name="ln-134"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DehumidControl_Multimode</span>  <span class="o">=</span> <span class="mi">1</span>
<a name="ln-135"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">DehumidControl_CoolReheat</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-136"></a>
<a name="ln-137"></a>  <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-138"></a><span class="k">TYPE </span><span class="n">FurnaceEquipConditions</span>
<a name="ln-139"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Name</span>             <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! Name of the Furnace</span>
<a name="ln-140"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FurnaceType_Num</span>                  <span class="o">=</span><span class="mi">0</span> <span class="c">! Numeric Equivalent for Furnace Type</span>
<a name="ln-141"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FurnaceIndex</span>                     <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to furnace</span>
<a name="ln-142"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SchedPtr</span>                         <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to furnace operating schedule</span>
<a name="ln-143"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FanSchedPtr</span>                      <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to fan operating mode schedule</span>
<a name="ln-144"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FanAvailSchedPtr</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to fan availability schedule</span>
<a name="ln-145"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ControlZoneNum</span>                   <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to controlled zone</span>
<a name="ln-146"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneSequenceCoolingNum</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to cooling sequence/priority for this zone</span>
<a name="ln-147"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneSequenceHeatingNum</span>           <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to heating sequence/priority for this zone</span>
<a name="ln-148"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolingCoilType_Num</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! Numeric Equivalent for Cooling Coil Type</span>
<a name="ln-149"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoolingCoilIndex</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to cooling coil</span>
<a name="ln-150"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ActualDXCoilIndexforHXAssisted</span>   <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to DX cooling coil when HX assisted</span>
<a name="ln-151"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">CoolingCoilUpstream</span>         <span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Indicates if cooling coil is upstream of heating coil</span>
<a name="ln-152"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatingCoilType_Num</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! Numeric Equivalent for Heating Coil Type</span>
<a name="ln-153"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatingCoilIndex</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to heating coil</span>
<a name="ln-154"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ReheatingCoilType_Num</span>            <span class="o">=</span><span class="mi">0</span> <span class="c">! Numeric Equivalent for Reheat Coil Type</span>
<a name="ln-155"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ReheatingCoilIndex</span>               <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to reheat coil</span>
<a name="ln-156"></a>
<a name="ln-157"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! name of heating coil</span>
<a name="ln-158"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilType</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! type of heating coil</span>
<a name="ln-159"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilControlNode</span>                  <span class="o">=</span><span class="mi">0</span> <span class="c">! control node for hot water and steam heating coils</span>
<a name="ln-160"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HWCoilAirInletNode</span>               <span class="o">=</span><span class="mi">0</span> <span class="c">! air inlet node number of HW coil for PTAC, PTHP, HeatCool, HeatOnly</span>
<a name="ln-161"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HWCoilAirOutletNode</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! air outlet node number of HW coil for PTAC, PTHP, HeatCool, HeatOnly</span>
<a name="ln-162"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilAirInletNode</span>             <span class="o">=</span><span class="mi">0</span> <span class="c">! air inlet node number of HW coil for HeatCool Reheat Coil</span>
<a name="ln-163"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilAirOutletNode</span>            <span class="o">=</span><span class="mi">0</span> <span class="c">! air outlet node number of HW coil for HeatCool Reheat Coil</span>
<a name="ln-164"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilType_Num</span>             <span class="o">=</span><span class="mi">0</span> <span class="c">! Numeric Equivalent for Supplemental Heat Coil Type</span>
<a name="ln-165"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppHeatCoilIndex</span>                <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to supplemental heater</span>
<a name="ln-166"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilControlNode</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! control node for steam and hot water heating coil</span>
<a name="ln-167"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppHeatCoilName</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! name of supplemental heating coil</span>
<a name="ln-168"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SuppHeatCoilType</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! type of supplemental heating coil</span>
<a name="ln-169"></a>
<a name="ln-170"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FanType_Num</span>                      <span class="o">=</span><span class="mi">0</span> <span class="c">! Integer equivalent of fan type (1=OnOff, 2 = ConstVolume)</span>
<a name="ln-171"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FanIndex</span>                         <span class="o">=</span><span class="mi">0</span> <span class="c">! Index to fan object</span>
<a name="ln-172"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FurnaceInletNodeNum</span>              <span class="o">=</span><span class="mi">0</span> <span class="c">! Furnace inlet node number</span>
<a name="ln-173"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FurnaceOutletNodeNum</span>             <span class="o">=</span><span class="mi">0</span> <span class="c">! Furnace inlet node number</span>
<a name="ln-174"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">OpMode</span>                           <span class="o">=</span><span class="mi">0</span> <span class="c">! operation mode: 1 = cycling fan, cycling coils</span>
<a name="ln-175"></a>                                                      <span class="c">!                 2 = continuous fan, cycling coils</span>
<a name="ln-176"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LastMode</span>                         <span class="o">=</span><span class="mi">0</span> <span class="c">! last mode of operation, coolingmode or heatingmode</span>
<a name="ln-177"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirFlowControl</span>                   <span class="o">=</span><span class="mi">0</span> <span class="c">! fan control mode, UseCompressorOnFlow or UseCompressorOffFlow</span>
<a name="ln-178"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">FanPlace</span>                         <span class="o">=</span><span class="mi">0</span> <span class="c">! fan placement; 1=blow through, 2=draw through</span>
<a name="ln-179"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">NodeNumofControlledZone</span>          <span class="o">=</span><span class="mi">0</span> <span class="c">! Node number of controlled zone air node</span>
<a name="ln-180"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">WatertoAirHPType</span>                 <span class="o">=</span><span class="mi">0</span> <span class="c">!Type of water to air heat pump model used</span>
<a name="ln-181"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolingConvergenceTolerance</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Convergence tolerance for cooling,</span>
<a name="ln-182"></a>                                                        <span class="c">!   ratio (CoolingCoilLoad - FurnaceCoolingOutput)/CoolingCoilLoad</span>
<a name="ln-183"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatingConvergenceTolerance</span>      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Convergence tolerance for heating,</span>
<a name="ln-184"></a>                                                        <span class="c">!   ratio (HeatingCoilLoad - HeatPumpheatingOutput)/HeatingCoilLoad</span>
<a name="ln-185"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignHeatingCapacity</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal Capacity of Heating Coil [W]</span>
<a name="ln-186"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignCoolingCapacity</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal Capacity of Cooling Coil [W]</span>
<a name="ln-187"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolingCoilSensDemand</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible demand on Cooling Coil [W]</span>
<a name="ln-188"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatingCoilSensDemand</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Sensible demand on Heating Coil [W]</span>
<a name="ln-189"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolingCoilLatentDemand</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Latent demand on Cooling Coil [W]</span>
<a name="ln-190"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignSuppHeatingCapacity</span>        <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Nominal Capacity of Supplemental Heating Coil [W]</span>
<a name="ln-191"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignFanVolFlowRate</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Vol Flow through the Furnace being Simulated [m**3/Sec]</span>
<a name="ln-192"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, then EMS is calling to override autosize fan flow</span>
<a name="ln-193"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignFanVolFlowRateEMSOverrideValue</span><span class="o">=</span><span class="mf">0.d0</span> <span class="c">! EMS value for override of fan flow rate autosize [m3/s]</span>
<a name="ln-194"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignMassFlowRate</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Design mass flow rate through furnace [kg/s]</span>
<a name="ln-195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCoolAirVolFlow</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! supply air volumetric flow rate during cooling operation [m3/s]</span>
<a name="ln-196"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MaxCoolAirVolFlowEMSOverrideOn</span>   <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">!if true, EMS is calling to override autosize flow during cooling</span>
<a name="ln-197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCoolAirVolFlowEMSOverrideValue</span><span class="o">=</span><span class="mf">0.d0</span> <span class="c">! EMS value for override of flow during cooling [m3/s]</span>
<a name="ln-198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxHeatAirVolFlow</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! supply air volumetric flow rate during cooling operation [m3/s]</span>
<a name="ln-199"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MaxHeatAirVolFlowEMSOverrideOn</span>   <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, EMS is calling to override autosize flow during heating</span>
<a name="ln-200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxHeatAirVolFlowEMSOverrideValue</span><span class="o">=</span><span class="mf">0.d0</span>  <span class="c">! EMS value for override of flow during heating operation [m3/s]</span>
<a name="ln-201"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirVolFlow</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! supply air volumetric flow rate when no cooling or heating [m3/s]</span>
<a name="ln-202"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, EMS is calling to override autosize no heatcool rate</span>
<a name="ln-203"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span><span class="o">=</span><span class="mf">0.d0</span> <span class="c">! EMS value for override of flow during no heat cool [m3/s]</span>
<a name="ln-204"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxCoolAirMassFlow</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! supply air mass flow rate during cooling operation [kg/s]</span>
<a name="ln-205"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxHeatAirMassFlow</span>               <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! supply air mass flow rate during heating operation [kg/s]</span>
<a name="ln-206"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxNoCoolHeatAirMassFlow</span>         <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! supply air mass flow rate when no cooling or heating [kg/s]</span>
<a name="ln-207"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxHeatCoilFluidFlow</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! water or steam mass flow rate for heating coil [kg/s]</span>
<a name="ln-208"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxSuppCoilFluidFlow</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! water or steam mass flow rate for supplemental heating coil [kg/s]</span>
<a name="ln-209"></a>
<a name="ln-210"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ControlZoneMassFlowFrac</span>          <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fraction of furnace flow to control zone</span>
<a name="ln-211"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DesignMaxOutletTemp</span>              <span class="o">=</span><span class="mi">999</span><span class="mf">9.0d0</span> <span class="c">! Maximum supply air temperature from furnace heater [C]</span>
<a name="ln-212"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MdotFurnace</span>                      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Mass flow rate through furnace [kg/s]</span>
<a name="ln-213"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanPartLoadRatio</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Part load ratio of furnace fan (mdot actual/mdot design)</span>
<a name="ln-214"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompPartLoadRatio</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Part load ratio of furnace compressor (load / steady-state output)</span>
<a name="ln-215"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">WSHPRuntimeFrac</span>                  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Runtime fraction of water source heat pump</span>
<a name="ln-216"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPartLoadRatio</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Cooling part load ratio</span>
<a name="ln-217"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPartLoadRatio</span>                <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Heating part load ratio</span>
<a name="ln-218"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinOATCompressor</span>                 <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Minimum outdoor operating temperature for heat pump compressor</span>
<a name="ln-219"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxOATSuppHeat</span>                   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Maximum outdoor dry-bulb temperature for</span>
<a name="ln-220"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CondenserNodeNum</span>                 <span class="o">=</span><span class="mi">0</span>   <span class="c">! Node number of outdoor condenser/compressor</span>
<a name="ln-221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MaxONOFFCyclesperHour</span>            <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Maximum ON/OFF Cycling Rate [cycles/hr]</span>
<a name="ln-222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HPTimeConstant</span>                   <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Heat Pump Time Constant [s]</span>
<a name="ln-223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnCyclePowerFraction</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fraction of on-cycle power use [~]</span>
<a name="ln-224"></a>                                                        <span class="c">! supplemental heating coil operation</span>
<a name="ln-225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanDelayTime</span>                     <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Fan delay time, time delay for the HP&#39;s fan to</span>
<a name="ln-226"></a>                                                        <span class="c">! shut off after compressor cycle off  [s]</span>
<a name="ln-227"></a>  <span class="kt">Logical</span>      <span class="kd">::</span> <span class="n">Humidistat</span>                       <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Humidistat control (heatcool units only and not heatpump)</span>
<a name="ln-228"></a>  <span class="kt">Logical</span>      <span class="kd">::</span> <span class="n">InitHeatPump</span>                     <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Heat pump initialization flag (for error reporting)</span>
<a name="ln-229"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">DehumidControlType_Num</span>           <span class="o">=</span><span class="mi">0</span>   <span class="c">! 0 = None, 1=MultiMode, 2=CoolReheat</span>
<a name="ln-230"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">LatentMaxIterIndex</span>               <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-231"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">LatentRegulaFalsiFailedIndex</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-232"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">LatentRegulaFalsiFailedIndex2</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-233"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">SensibleMaxIterIndex</span>             <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-234"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">SensibleRegulaFalsiFailedIndex</span>   <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-235"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">WSHPHeatMaxIterIndex</span>             <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-236"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">WSHPHeatRegulaFalsiFailedIndex</span>   <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-237"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">DXHeatingMaxIterIndex</span>            <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-238"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">DXHeatingRegulaFalsiFailedIndex</span>  <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning messages</span>
<a name="ln-239"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HeatingMaxIterIndex</span>              <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-240"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HeatingMaxIterIndex2</span>             <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning message</span>
<a name="ln-241"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HeatingRegulaFalsiFailedIndex</span>    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Index to recurring warning messages</span>
<a name="ln-242"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ActualFanVolFlowRate</span>             <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Volumetric flow rate from fan object</span>
<a name="ln-243"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatingSpeedRatio</span>                <span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Fan speed ratio in heating mode</span>
<a name="ln-244"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolingSpeedRatio</span>                <span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Fan speed ratio in cooling mode</span>
<a name="ln-245"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">NoHeatCoolSpeedRatio</span>             <span class="o">=</span><span class="mf">1.0d0</span> <span class="c">! Fan speed ratio when no cooling or heating</span>
<a name="ln-246"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">ZoneInletNode</span>                    <span class="o">=</span><span class="mi">0</span>   <span class="c">! Zone inlet node number in the controlled zone</span>
<a name="ln-247"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SenLoadLoss</span>                      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air distribution system sensible loss</span>
<a name="ln-248"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatLoadLoss</span>                      <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Air distribution system latent loss</span>
<a name="ln-249"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SensibleLoadMet</span>                  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! System sensible load</span>
<a name="ln-250"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LatentLoadMet</span>                    <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! System latent load</span>
<a name="ln-251"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">DehumidInducedHeatingDemandRate</span>  <span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! Additional heating demand on supplemental heater</span>
<a name="ln-252"></a>                                                        <span class="c">! when heat pumps operate on dehumidification mode</span>
<a name="ln-253"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilOutletNode</span>                   <span class="o">=</span> <span class="mi">0</span>  <span class="c">! outlet node for hot water and steam heating coil</span>
<a name="ln-254"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopNum</span>                          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop index for water and steam heating coil</span>
<a name="ln-255"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopSide</span>                         <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop side  index for water and steam heating coil</span>
<a name="ln-256"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">BranchNum</span>                        <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop branch index for water and steam heating coil</span>
<a name="ln-257"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompNum</span>                          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop component index for water and steam heating coil</span>
<a name="ln-258"></a>
<a name="ln-259"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">SuppCoilOutletNode</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! outlet node for hot water and steam supplemental heating coil</span>
<a name="ln-260"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopNumSupp</span>                      <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop index for water and steam supplemental heating coil</span>
<a name="ln-261"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopSideSupp</span>                     <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop side  index for  water and steam supplemental heating coil</span>
<a name="ln-262"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">BranchNumSupp</span>                    <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop branch index for water and steam supplemental heating coil</span>
<a name="ln-263"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompNumSupp</span>                      <span class="o">=</span> <span class="mi">0</span>  <span class="c">! plant loop component index for water and steam supplemental heating coil</span>
<a name="ln-264"></a>
<a name="ln-265"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HotWaterCoilMaxIterIndex</span>         <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Index to recurring warning message</span>
<a name="ln-266"></a>  <span class="kt">Integer</span>      <span class="kd">::</span> <span class="n">HotWaterCoilMaxIterIndex2</span>        <span class="o">=</span> <span class="mi">0</span>  <span class="c">! Index to recurring warning message</span>
<a name="ln-267"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EMSOverrideSensZoneLoadRequest</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, then EMS is calling to override zone load</span>
<a name="ln-268"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EMSSensibleZoneLoadValue</span>         <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Value EMS is directing to use</span>
<a name="ln-269"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EMSOverrideMoistZoneLoadRequest</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if true, then EMS is calling to override zone load</span>
<a name="ln-270"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">EMSMoistureZoneLoadValue</span>         <span class="o">=</span> <span class="mf">0.0D0</span> <span class="c">! Value EMS is directing to use</span>
<a name="ln-271"></a>
<a name="ln-272"></a><span class="c">! starting added varibles for variable speed water source heat pump, Bo Shen, ORNL, March 2012</span>
<a name="ln-273"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">HeatCoolMode</span>          <span class="o">=</span> <span class="mi">0</span>  <span class="c">! System operating mode (0 = floating, 1 = cooling, 2 = heating)</span>
<a name="ln-274"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! The number of speeds for cooling</span>
<a name="ln-275"></a>  <span class="kt">INTEGER</span>  <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>     <span class="o">=</span><span class="mi">0</span>   <span class="c">! The number of speeds for heating</span>
<a name="ln-276"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">IdleSpeedRatio</span>        <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">!idle air fan ratio</span>
<a name="ln-277"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! idle air flow rate</span>
<a name="ln-278"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">IdleMassFlowRate</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! idle air flow rate</span>
<a name="ln-279"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">FanVolFlow</span>            <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! fan volumetric flow rate</span>
<a name="ln-280"></a>  <span class="kt">LOGICAL</span>  <span class="kd">::</span> <span class="n">CheckFanFlow</span>      <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! Supply airflow check</span>
<a name="ln-281"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Supply air volume flow rate during heating operation</span>
<a name="ln-282"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Supply air mass flow rate during heating operation</span>
<a name="ln-283"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Supply air volume flow rate during cooling operation</span>
<a name="ln-284"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Supply air mass flow rate during cooling operation</span>
<a name="ln-285"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Fan speed ratio in heating mode</span>
<a name="ln-286"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span><span class="kd">::</span> <span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">MaxSpedLevels</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Fan speed ratio in cooling mode</span>
<a name="ln-287"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompSpeedNum</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-288"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompSpeedRatio</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-289"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrIndexCyc</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-290"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ErrIndexVar</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-291"></a> <span class="c">! end of the additional variables for variable speed water source heat pump</span>
<a name="ln-292"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! Heat Pump Coil water flow mode; See definitions in DataHVACGlobals,</span>
<a name="ln-293"></a>                                     <span class="c">! 1=water cycling, 2=water constant, 3=water constant on demand (old mode)</span>
<a name="ln-294"></a><span class="k">END TYPE </span><span class="n">FurnaceEquipConditions</span>
<a name="ln-295"></a>
<a name="ln-296"></a>  <span class="c">!MODULE VARIABLE DECLARATIONS:</span>
<a name="ln-297"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumFurnaces</span><span class="o">=</span><span class="mi">0</span>                          <span class="c">! The number of furnaces found in the input data file</span>
<a name="ln-298"></a>  <span class="k">TYPE</span> <span class="p">(</span><span class="n">FurnaceEquipConditions</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Furnace</span>
<a name="ln-299"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySizeFlag</span>
<a name="ln-300"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">CheckEquipName</span>
<a name="ln-301"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ModifiedHeatCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span> <span class="c">! used to adjust heating coil capacity if outlet temp &gt; DesignMaxOutletTemp,</span>
<a name="ln-302"></a>                                      <span class="c">! used for Coil:Gas:Heating and Coil:Electric:Heating coils only.</span>
<a name="ln-303"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowRatioSave</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Saves the OnOffAirFlowRatio calculated in RegulaFalsi CALLs.</span>
<a name="ln-304"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffFanPartLoadFractionSave</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Global part-load fraction passed to fan object</span>
<a name="ln-305"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOnMassFlow</span>    <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Supply air mass flow rate w/ compressor ON [kg/s]</span>
<a name="ln-306"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOffMassFlow</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! Supply air mass flow rate w/ compressor OFF [kg/s]</span>
<a name="ln-307"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOnFlowRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! fan flow ratio when coil on</span>
<a name="ln-308"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOffFlowRatio</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! fan flow ratio when coil off</span>
<a name="ln-309"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! ratio of air flow ratio passed to fan object</span>
<a name="ln-310"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolHeatPLRRat</span>    <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! ratio of cooling to heating PLR, used for cycling fan RH control</span>
<a name="ln-311"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">HeatingLoad</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-312"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">CoolingLoad</span>       <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-313"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">EconomizerFlag</span>    <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! holds air loop economizer status</span>
<a name="ln-314"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Number of air loop pass</span>
<a name="ln-315"></a>  <span class="kt">LOGICAL</span>      <span class="kd">::</span> <span class="n">HPDehumidificationLoadFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! true if there is dehumidification load (heat pumps only)</span>
<a name="ln-316"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">TempSteamIn</span>       <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>   <span class="c">!  steam coil steam inlet temperature</span>
<a name="ln-317"></a>  <span class="c">!starting add variables for variable speed water source heat pump</span>
<a name="ln-318"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveCompressorPLR</span>      <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! holds compressor PLR from active DX coil</span>
<a name="ln-319"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CurrentModuleObject</span>   <span class="c">! Object type for getting and error messages</span>
<a name="ln-320"></a>  <span class="c">!ending varibles for variable speed water source heat pump</span>
<a name="ln-321"></a>
<a name="ln-322"></a><span class="c">! Subroutine Specifications for the Module</span>
<a name="ln-323"></a>          <span class="c">! Driver/Manager Routines</span>
<a name="ln-324"></a><span class="k">Public  </span><span class="n">SimFurnace</span>
<a name="ln-325"></a>
<a name="ln-326"></a>
<a name="ln-327"></a>          <span class="c">! Get Input routines for module</span>
<a name="ln-328"></a><span class="k">PRIVATE </span><span class="n">GetFurnaceInput</span>
<a name="ln-329"></a>
<a name="ln-330"></a>
<a name="ln-331"></a>          <span class="c">! Initialization routines for module</span>
<a name="ln-332"></a><span class="k">PRIVATE </span><span class="n">InitFurnace</span>
<a name="ln-333"></a><span class="k">PRIVATE </span><span class="n">SizeFurnace</span>
<a name="ln-334"></a><span class="k">PRIVATE </span><span class="n">SetOnOffMassFlowRate</span>
<a name="ln-335"></a>
<a name="ln-336"></a>
<a name="ln-337"></a>          <span class="c">! Calculate routines to check convergence</span>
<a name="ln-338"></a><span class="k">Private </span><span class="n">CalcNewZoneHeatOnlyFlowRates</span>
<a name="ln-339"></a><span class="k">Private </span><span class="n">CalcNewZoneHeatCoolFlowRates</span>
<a name="ln-340"></a><span class="k">Private </span><span class="n">CalcWaterToAirHeatPump</span>
<a name="ln-341"></a>
<a name="ln-342"></a>
<a name="ln-343"></a>          <span class="c">! Supporting routines for module</span>
<a name="ln-344"></a><span class="k">Private </span><span class="n">CalcFurnaceOutput</span>
<a name="ln-345"></a><span class="k">Private </span><span class="n">CalcFurnaceResidual</span>
<a name="ln-346"></a><span class="k">Private </span><span class="n">CalcWaterToAirResidual</span>
<a name="ln-347"></a><span class="k">Private </span><span class="n">SetAverageAirFlow</span>
<a name="ln-348"></a><span class="k">Private </span><span class="n">HeatPumpRunFrac</span>
<a name="ln-349"></a><span class="k">Private </span><span class="n">CalcNonDXHeatingCoils</span>
<a name="ln-350"></a><span class="k">Private </span><span class="n">HotWaterCoilResidual</span>
<a name="ln-351"></a>
<a name="ln-352"></a>        <span class="c">! modules for variable speed heat pump</span>
<a name="ln-353"></a><span class="k">Private </span><span class="n">SimVariableSpeedHP</span>
<a name="ln-354"></a><span class="k">Private </span><span class="n">SetOnOffMassFlowRateVSCoil</span>
<a name="ln-355"></a><span class="k">Private </span><span class="n">CalcVarSpeedHeatPump</span>
<a name="ln-356"></a><span class="k">Private </span><span class="n">SetVSHPAirFlow</span>
<a name="ln-357"></a><span class="k">Private </span><span class="n">VSHPSpeedResidual</span>
<a name="ln-358"></a><span class="k">Private </span><span class="n">VSHPCyclingResidual</span>
<a name="ln-359"></a><span class="k">Private </span><span class="n">ControlVSHPOutput</span>
<a name="ln-360"></a>
<a name="ln-361"></a>          <span class="c">! Reporting routines for module</span>
<a name="ln-362"></a><span class="k">Private </span><span class="n">ReportFurnace</span>
<a name="ln-363"></a>
<a name="ln-364"></a>
<a name="ln-365"></a>          <span class="c">! Utility routines for module</span>
<a name="ln-366"></a>          <span class="c">! na</span>
<a name="ln-367"></a>
<a name="ln-368"></a><span class="k">CONTAINS</span>
<a name="ln-369"></a>
<a name="ln-370"></a>
<a name="ln-371"></a><span class="c">! MODULE SUBROUTINES:</span>
<a name="ln-372"></a><span class="c">!*************************************************************************</span>
<a name="ln-373"></a><span class="k">SUBROUTINE </span><span class="n">SimFurnace</span><span class="p">(</span><span class="n">FurnaceName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">CompIndex</span><span class="p">)</span>
<a name="ln-374"></a>
<a name="ln-375"></a>
<a name="ln-376"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-377"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-378"></a>          <span class="c">!       DATE WRITTEN   Jan 2001</span>
<a name="ln-379"></a>          <span class="c">!       MODIFIED       Richard Liesen, Oct 2001 - Richard Raustad; Bo Shen, March 2012, for VS WSHP</span>
<a name="ln-380"></a>          <span class="c">!       RE-ENGINEERED  Feb 2001</span>
<a name="ln-381"></a>
<a name="ln-382"></a>
<a name="ln-383"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-384"></a>          <span class="c">! This subroutine manages Furnace component simulation.</span>
<a name="ln-385"></a>
<a name="ln-386"></a>
<a name="ln-387"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-388"></a>          <span class="c">! CALL the calc routine to determine an operating PLR. Resimulate child components at this PLR.</span>
<a name="ln-389"></a>          <span class="c">! A supplemental heater augments the heating capacity for both air-to-air and water-to-air heat pump systems.</span>
<a name="ln-390"></a>          <span class="c">! A reheat coil is used for the HeatCool furnace/unitarysystem to offset the sensible cooling when the</span>
<a name="ln-391"></a>          <span class="c">! dehumidification control type is COOLREHEAT. Both the supplemental and reheat heating coil load is calculated</span>
<a name="ln-392"></a>          <span class="c">! in the Calc routines and returned here through subroutine arguments. The actual simulation of these coils is</span>
<a name="ln-393"></a>          <span class="c">! performed here (i.e. the supplemental and reheat coil loads are passed as 0 to CalcFurnaceOutput).</span>
<a name="ln-394"></a>
<a name="ln-395"></a>
<a name="ln-396"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-397"></a>          <span class="c">! na</span>
<a name="ln-398"></a>
<a name="ln-399"></a>
<a name="ln-400"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-401"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-402"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>     <span class="n">Only</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-403"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimHXAssistedCoolingCoil</span>
<a name="ln-404"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span><span class="p">,</span> <span class="n">AirLoopFlow</span>
<a name="ln-405"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-406"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-407"></a>  <span class="k">USE </span><span class="n">WatertoAirheatPumpSimple</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-408"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlType</span>
<a name="ln-409"></a>  <span class="c">!USE WaterCoils,               ONLY: SimulateWaterCoilComponents</span>
<a name="ln-410"></a>  <span class="c">!USE PlantUtilities,           ONLY: SetComponentFlowRate</span>
<a name="ln-411"></a>  <span class="c">!USE SteamCoils,               ONLY: SimulateSteamCoilComponents</span>
<a name="ln-412"></a>
<a name="ln-413"></a>
<a name="ln-414"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-415"></a>
<a name="ln-416"></a>
<a name="ln-417"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-418"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span><span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-419"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FurnaceName</span>
<a name="ln-420"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span>  <span class="n">AirLoopNum</span>         <span class="c">! Primary air loop number</span>
<a name="ln-421"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompIndex</span>        <span class="c">! Pointer to which furnace</span>
<a name="ln-422"></a>
<a name="ln-423"></a>
<a name="ln-424"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-425"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">25</span>          <span class="c">! maximum number of iterations for controlling output</span>
<a name="ln-426"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIterCycl</span> <span class="o">=</span> <span class="mi">100</span>
<a name="ln-427"></a>
<a name="ln-428"></a>
<a name="ln-429"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-430"></a>          <span class="c">! na</span>
<a name="ln-431"></a>
<a name="ln-432"></a>
<a name="ln-433"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-434"></a>          <span class="c">! na</span>
<a name="ln-435"></a>
<a name="ln-436"></a>
<a name="ln-437"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DEFINITIONS:</span>
<a name="ln-438"></a>          <span class="c">! na</span>
<a name="ln-439"></a>
<a name="ln-440"></a>
<a name="ln-441"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-442"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">FurnaceNum</span>             <span class="c">! Furnace number</span>
<a name="ln-443"></a>  <span class="kt">LOGICAL</span><span class="p">,</span><span class="k">SAVE</span>                  <span class="kd">::</span> <span class="n">GetInputFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">True</span><span class="p">.</span>  <span class="c">! Logical to allow &quot;GetInput&quot; only once per simulation</span>
<a name="ln-444"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">HeatCoilLoad</span>           <span class="c">! Zone heating coil load</span>
<a name="ln-445"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ReheatCoilLoad</span>         <span class="c">! Load to be met by the reheat coil (if high humidity control)</span>
<a name="ln-446"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ZoneLoad</span>               <span class="c">! Control zone sensible load</span>
<a name="ln-447"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MoistureLoad</span>           <span class="c">! Control zone latent load</span>
<a name="ln-448"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">H2OHtOfVap</span>             <span class="c">! Heat of vaporization of air</span>
<a name="ln-449"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">FurnaceInletNode</span>       <span class="c">! Inlet node to furnace or unitary system</span>
<a name="ln-450"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">FurnaceSavMdot</span>         <span class="c">! saved furnace inlet air mass flow rate [m3/s]</span>
<a name="ln-451"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-452"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">CompOp</span>                 <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-453"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>      <span class="c">! Ratio of compressor ON air flow to AVERAGE air flow over time step</span>
<a name="ln-454"></a>  <span class="kt">INTEGER</span>                       <span class="kd">::</span> <span class="n">FanOpMode</span>              <span class="c">! Fan operating mode (1=CycFanCycCoil, 2=ContFanCycCoil)</span>
<a name="ln-455"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">HXUnitOn</span>               <span class="c">! flag to control HX assisted cooling coil</span>
<a name="ln-456"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ZoneLoadToCoolSPSequenced</span>
<a name="ln-457"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">ZoneLoadToHeatSPSequenced</span>
<a name="ln-458"></a>
<a name="ln-459"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QCoilReq</span>                 <span class="c">! load passed to heating coil (W)</span>
<a name="ln-460"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QActual</span>                  <span class="c">! actual heating coil output (W)</span>
<a name="ln-461"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">mdot</span>                     <span class="c">! local temporary for mass flow rate</span>
<a name="ln-462"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">QCoilMax</span>                 <span class="c">! heating coil maximum capacity (W)</span>
<a name="ln-463"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">MinWaterFlow</span>             <span class="c">! minimum fluid flow rates</span>
<a name="ln-464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                     <span class="kd">::</span> <span class="n">PartLoadRatioHeatingCoil</span> <span class="c">! Heating Coil Part Load Ratio</span>
<a name="ln-465"></a>  <span class="kt">LOGICAL</span>                       <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span>      <span class="c">! true if supplemental heating coil</span>
<a name="ln-466"></a>
<a name="ln-467"></a>
<a name="ln-468"></a>    <span class="c">! Obtains and Allocates Furnace related parameters from input file</span>
<a name="ln-469"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetInputFlag</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!First time subroutine has been entered</span>
<a name="ln-470"></a>        <span class="c">!Get the furnace input</span>
<a name="ln-471"></a>    <span class="k">CALL </span><span class="n">GetFurnaceInput</span>
<a name="ln-472"></a>    <span class="n">GetInputFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-473"></a>  <span class="k">End If</span>
<a name="ln-474"></a>
<a name="ln-475"></a>    <span class="c">! Find the correct Furnace</span>
<a name="ln-476"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">CompIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-477"></a><span class="k">    </span><span class="n">FurnaceNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">FurnaceName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumFurnaces</span><span class="p">)</span>
<a name="ln-478"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FurnaceNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-479"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFurnace: Unit not found=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FurnaceName</span><span class="p">))</span>
<a name="ln-480"></a>    <span class="n">ENDIF</span>
<a name="ln-481"></a>    <span class="n">CompIndex</span><span class="o">=</span><span class="n">FurnaceNum</span>
<a name="ln-482"></a>  <span class="k">ELSE</span>
<a name="ln-483"></a><span class="k">    </span><span class="n">FurnaceNum</span><span class="o">=</span><span class="n">CompIndex</span>
<a name="ln-484"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FurnaceNum</span> <span class="o">&gt;</span> <span class="n">NumFurnaces</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">FurnaceNum</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-485"></a><span class="k">      CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFurnace:  Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-486"></a>                          <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-487"></a>                          <span class="s1">&#39;, Number of Units=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-488"></a>                          <span class="s1">&#39;, Entered Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FurnaceName</span><span class="p">))</span>
<a name="ln-489"></a>    <span class="n">ENDIF</span>
<a name="ln-490"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-491"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">FurnaceName</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-492"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;SimFurnace: Invalid CompIndex passed=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-493"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-494"></a>                            <span class="s1">&#39;, Unit name=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FurnaceName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;, stored Unit Name for that index=&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-495"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-496"></a>      <span class="n">ENDIF</span>
<a name="ln-497"></a>      <span class="n">CheckEquipName</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-498"></a>    <span class="n">ENDIF</span>
<a name="ln-499"></a>  <span class="n">ENDIF</span>
<a name="ln-500"></a>
<a name="ln-501"></a>  <span class="n">HXUnitOn</span>   <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-502"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-503"></a>  <span class="c">! here we need to deal with sequenced zone equip</span>
<a name="ln-504"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-505"></a><span class="k">    </span><span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%&amp;</span>
<a name="ln-506"></a>                  <span class="n">SequencedOutputRequiredToCoolingSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span><span class="p">)</span>
<a name="ln-507"></a>    <span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%&amp;</span>
<a name="ln-508"></a>                  <span class="n">SequencedOutputRequiredToHeatingSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span><span class="p">)</span>
<a name="ln-509"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-510"></a>        <span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SingleCoolingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-511"></a><span class="k">      </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">ZoneLoadToHeatSPSequenced</span>
<a name="ln-512"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&gt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-513"></a>        <span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SingleCoolingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-514"></a><span class="k">      </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-515"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-516"></a>        <span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">SingleHeatingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-517"></a><span class="k">      </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">ZoneLoadToCoolSPSequenced</span>
<a name="ln-518"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&lt;</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-519"></a>        <span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SingleHeatingSetPoint</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-520"></a><span class="k">      </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-521"></a>    <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">ZoneLoadToHeatSPSequenced</span> <span class="o">&lt;=</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ZoneLoadToCoolSPSequenced</span> <span class="o">&gt;=</span> <span class="mf">0.d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-522"></a><span class="k">      </span><span class="n">ZoneLoad</span> <span class="o">=</span> <span class="mf">0.d0</span>
<a name="ln-523"></a>    <span class="n">ENDIF</span>
<a name="ln-524"></a>    <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">ZoneSysMoistureDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-525"></a>                     <span class="n">SequencedOutputRequiredToDehumidSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span><span class="p">)</span>
<a name="ln-526"></a>  <span class="k">ELSE</span>
<a name="ln-527"></a><span class="k">    </span><span class="n">ZoneLoad</span><span class="o">=</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">RemainingOutputRequired</span>
<a name="ln-528"></a>    <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">ZoneSysMoistureDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToDehumidifyingSP</span>
<a name="ln-529"></a>  <span class="n">ENDIF</span>
<a name="ln-530"></a>
<a name="ln-531"></a>  <span class="n">H2OHtOfVap</span> <span class="o">=</span> <span class="n">PsyHfgAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,&amp;</span>
<a name="ln-532"></a>                        <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="s1">&#39;SimFurnace&#39;</span><span class="p">)</span>
<a name="ln-533"></a>
<a name="ln-534"></a>  <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span> <span class="o">*</span> <span class="n">H2OHtOfVap</span>
<a name="ln-535"></a>
<a name="ln-536"></a>    <span class="c">! Initialize Furnace Flows</span>
<a name="ln-537"></a>  <span class="k">Call </span><span class="n">InitFurnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-538"></a>
<a name="ln-539"></a>  <span class="n">FurnaceInletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-540"></a>  <span class="n">FurnaceSavMdot</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-541"></a>  <span class="n">CompOp</span> <span class="o">=</span> <span class="n">On</span>
<a name="ln-542"></a>  <span class="n">CoolHeatPLRRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-543"></a>
<a name="ln-544"></a>  <span class="c">! Simulate correct system type (1 of 4 choices)</span>
<a name="ln-545"></a>  <span class="k">SELECT CASE</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">)</span>
<a name="ln-546"></a>
<a name="ln-547"></a>  <span class="c">! Simulate HeatOnly systems:</span>
<a name="ln-548"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">Furnace_HeatOnly</span><span class="p">,</span> <span class="n">UnitarySys_HeatOnly</span><span class="p">)</span>
<a name="ln-549"></a>
<a name="ln-550"></a>
<a name="ln-551"></a>     <span class="c">! Update the furnace flow rates</span>
<a name="ln-552"></a>     <span class="k">Call </span><span class="n">CalcNewZoneHeatOnlyFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-553"></a>
<a name="ln-554"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-555"></a>       <span class="c">! simulate fan</span>
<a name="ln-556"></a>       <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-557"></a>     <span class="k">END IF</span>
<a name="ln-558"></a>
<a name="ln-559"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-560"></a>     <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-561"></a>     <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-562"></a>
<a name="ln-563"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-564"></a>       <span class="c">! simulate fan</span>
<a name="ln-565"></a>       <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-566"></a>     <span class="k">END IF</span>
<a name="ln-567"></a>
<a name="ln-568"></a>  <span class="c">! Simulate HeatCool sytems:</span>
<a name="ln-569"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">Furnace_HeatCool</span><span class="p">,</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span>
<a name="ln-570"></a>
<a name="ln-571"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-572"></a>       <span class="c">! variable speed cooling coil</span>
<a name="ln-573"></a>       <span class="n">HeatCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-574"></a>       <span class="k">Call </span><span class="n">SimVariableSpeedHP</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-575"></a>   <span class="k">ELSE</span>
<a name="ln-576"></a>     <span class="c">! calculate the system flow rate</span>
<a name="ln-577"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">&amp;</span>
<a name="ln-578"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-579"></a>       <span class="c">! for cycling fan, cooling load, check whether furnace can meet load with compressor off</span>
<a name="ln-580"></a>       <span class="n">CompOp</span> <span class="o">=</span> <span class="n">Off</span>
<a name="ln-581"></a>       <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-582"></a>                                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-583"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">&amp;</span>
<a name="ln-584"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-585"></a>         <span class="c">! compressor on (reset inlet air mass flow rate to starting value)</span>
<a name="ln-586"></a>         <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">FurnaceSavMdot</span>
<a name="ln-587"></a>         <span class="n">CompOp</span> <span class="o">=</span> <span class="n">On</span>
<a name="ln-588"></a>         <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-589"></a>                                           <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-590"></a>        <span class="k">END IF</span>
<a name="ln-591"></a><span class="k">     ELSE</span>
<a name="ln-592"></a>       <span class="c">! compressor on</span>
<a name="ln-593"></a>       <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-594"></a>                                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-595"></a>     <span class="k">END IF</span>
<a name="ln-596"></a>
<a name="ln-597"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-598"></a>       <span class="c">! simulate fan</span>
<a name="ln-599"></a>       <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-600"></a>     <span class="k">END IF</span>
<a name="ln-601"></a>
<a name="ln-602"></a><span class="k">     IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-603"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-604"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-605"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-606"></a>     <span class="k">END IF</span>
<a name="ln-607"></a>
<a name="ln-608"></a>     <span class="c">! simulate furnace DX cooling coil</span>
<a name="ln-609"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-610"></a><span class="k">      CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-611"></a>                                    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-612"></a>                                    <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-613"></a>     <span class="k">ELSE</span>
<a name="ln-614"></a><span class="k">       CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-615"></a>                      <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">CoilCoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="n">CoolHeatPLRRat</span><span class="p">)</span>
<a name="ln-616"></a>     <span class="k">END IF</span>
<a name="ln-617"></a>
<a name="ln-618"></a>
<a name="ln-619"></a><span class="k">     IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-620"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-621"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-622"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-623"></a>     <span class="k">END IF</span>
<a name="ln-624"></a>
<a name="ln-625"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-626"></a>       <span class="c">! simulate fan</span>
<a name="ln-627"></a>       <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-628"></a>     <span class="k">END IF</span>
<a name="ln-629"></a>
<a name="ln-630"></a>     <span class="c">! Simulate furnace reheat coil if a humidistat is used or if the reheat coil is present</span>
<a name="ln-631"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-632"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-633"></a><span class="k">        </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if truee simulates supplemental heating coil</span>
<a name="ln-634"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-635"></a>     <span class="k">END IF</span>
<a name="ln-636"></a><span class="k">   END IF</span>
<a name="ln-637"></a>
<a name="ln-638"></a>  <span class="c">! Simulate air-to-air heat pumps:</span>
<a name="ln-639"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">UnitarySys_HeatPump_AirToAir</span><span class="p">)</span>
<a name="ln-640"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-641"></a>       <span class="c">! variable speed heat pump</span>
<a name="ln-642"></a>       <span class="n">HeatCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-643"></a>       <span class="k">Call </span><span class="n">SimVariableSpeedHP</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-644"></a>   <span class="k">ELSE</span>
<a name="ln-645"></a>     <span class="c">! Update the furnace flow rates</span>
<a name="ln-646"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">&amp;</span>
<a name="ln-647"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-648"></a>       <span class="c">! for cycling fan, cooling load, check whether furnace can meet load with compressor off</span>
<a name="ln-649"></a>       <span class="n">CompOp</span> <span class="o">=</span> <span class="n">Off</span>
<a name="ln-650"></a>       <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-651"></a>                                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-652"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">&amp;</span>
<a name="ln-653"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-654"></a>         <span class="c">! compressor on (reset inlet air mass flow rate to starting value)</span>
<a name="ln-655"></a>         <span class="n">CompOp</span> <span class="o">=</span> <span class="n">On</span>
<a name="ln-656"></a>         <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">FurnaceSavMdot</span>
<a name="ln-657"></a>         <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-658"></a>                                           <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-659"></a>        <span class="k">END IF</span>
<a name="ln-660"></a><span class="k">     ELSE</span>
<a name="ln-661"></a>       <span class="c">! compressor on</span>
<a name="ln-662"></a>       <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-663"></a>                                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-664"></a>     <span class="k">END IF</span>
<a name="ln-665"></a>
<a name="ln-666"></a>
<a name="ln-667"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-668"></a><span class="k">       CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-669"></a>     <span class="k">END IF</span>
<a name="ln-670"></a>
<a name="ln-671"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-672"></a><span class="k">      CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-673"></a>                                    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-674"></a>                                    <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-675"></a>     <span class="k">ELSE</span>
<a name="ln-676"></a><span class="k">      CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-677"></a>                     <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-678"></a>     <span class="k">END IF</span>
<a name="ln-679"></a><span class="k">     CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-680"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-681"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-682"></a><span class="k">       CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-683"></a>     <span class="k">END IF</span>
<a name="ln-684"></a>
<a name="ln-685"></a>     <span class="c">! Simulate furnace reheat coil if a humidistat is present, the dehumidification type of coolreheat and</span>
<a name="ln-686"></a>     <span class="c">! reheat coil load exists</span>
<a name="ln-687"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ReheatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-688"></a><span class="k">        </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if truee simulates supplemental heating coil</span>
<a name="ln-689"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-690"></a>     <span class="k">ELSE</span>
<a name="ln-691"></a><span class="k">        </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-692"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-693"></a>     <span class="n">ENDIF</span>
<a name="ln-694"></a>
<a name="ln-695"></a>   <span class="k">END IF</span>
<a name="ln-696"></a>  <span class="c">! Simulate water-to-air systems:</span>
<a name="ln-697"></a>  <span class="k">CASE</span><span class="p">(</span><span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span>
<a name="ln-698"></a>
<a name="ln-699"></a>     <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-700"></a>     <span class="c">! Update the furnace flow rates</span>
<a name="ln-701"></a><span class="c">!</span>
<a name="ln-702"></a><span class="c">!   When CompOp logic is added to the child cooling coil (COIL:WaterToAirHP:EquationFit:Cooling), then this logic</span>
<a name="ln-703"></a><span class="c">!   needs to be reinstated.. to align with Unitary/Furnace HeatCool and Unitary Air-to-Air Heat Pump (see above).</span>
<a name="ln-704"></a><span class="c">!</span>
<a name="ln-705"></a>     <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span> <span class="p">&amp;</span>
<a name="ln-706"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-707"></a>       <span class="c">! for cycling fan, cooling load, check whether furnace can meet load with compressor off</span>
<a name="ln-708"></a>       <span class="n">CompOp</span> <span class="o">=</span> <span class="n">Off</span>
<a name="ln-709"></a>       <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-710"></a>                                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-711"></a>       <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&gt;=</span> <span class="mf">1.0d0</span> <span class="p">&amp;</span>
<a name="ln-712"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-713"></a>         <span class="c">! compressor on (reset inlet air mass flow rate to starting value)</span>
<a name="ln-714"></a>         <span class="n">CompOp</span> <span class="o">=</span> <span class="n">On</span>
<a name="ln-715"></a>         <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">FurnaceSavMdot</span>
<a name="ln-716"></a>         <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-717"></a>                                           <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-718"></a>        <span class="k">END IF</span>
<a name="ln-719"></a><span class="k">      ELSE</span>
<a name="ln-720"></a>       <span class="c">! compressor on</span>
<a name="ln-721"></a>       <span class="k">Call </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-722"></a>                                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-723"></a>      <span class="k">END IF</span>
<a name="ln-724"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-725"></a><span class="k">        CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-726"></a>      <span class="k">END IF</span>
<a name="ln-727"></a>
<a name="ln-728"></a><span class="k">      CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-729"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-730"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-731"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-732"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-733"></a>      <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-734"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-735"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-736"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-737"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-738"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-739"></a>
<a name="ln-740"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-741"></a><span class="k">        CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-742"></a>      <span class="k">END IF</span>
<a name="ln-743"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ReheatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-744"></a><span class="k">        </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-745"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-746"></a>      <span class="k">ELSE</span>
<a name="ln-747"></a><span class="k">        </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-748"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-749"></a>      <span class="n">ENDIF</span>
<a name="ln-750"></a>     <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_ParEst</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-751"></a>
<a name="ln-752"></a>      <span class="c">! simulate the heat pump</span>
<a name="ln-753"></a>       <span class="n">HeatCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-754"></a>       <span class="k">CALL </span><span class="n">CalcWaterToAirHeatpump</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">)</span>
<a name="ln-755"></a>     <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_VarSpeedEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-756"></a>       <span class="c">! simulate the heat pump</span>
<a name="ln-757"></a>       <span class="n">HeatCoilLoad</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-758"></a>       <span class="k">Call </span><span class="n">SimVariableSpeedHP</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-759"></a>
<a name="ln-760"></a>     <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_VarSpeedLooUpTable</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-761"></a>
<a name="ln-762"></a><span class="k">     END IF</span>
<a name="ln-763"></a>
<a name="ln-764"></a><span class="k">  CASE </span><span class="n">DEFAULT</span>
<a name="ln-765"></a>  <span class="c">! will never get here, all system types are simulated above</span>
<a name="ln-766"></a>
<a name="ln-767"></a>  <span class="k">END SELECT</span>
<a name="ln-768"></a>
<a name="ln-769"></a>  <span class="c">! set the econo lockout flags</span>
<a name="ln-770"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-771"></a>      <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CanLockoutEconoWithCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-772"></a><span class="k">    </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithCompressor</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-773"></a>  <span class="k">ELSE</span>
<a name="ln-774"></a><span class="k">    </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithCompressor</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-775"></a>  <span class="k">END IF</span>
<a name="ln-776"></a>
<a name="ln-777"></a><span class="k">  IF</span> <span class="p">((</span><span class="n">HeatCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-778"></a>      <span class="p">(</span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CanLockoutEconoWithCompressor</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-779"></a>       <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CanLockoutEconoWithHeating</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-780"></a><span class="k">    </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithHeating</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-781"></a>  <span class="k">ELSE</span>
<a name="ln-782"></a><span class="k">    </span><span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">ReqstEconoLockoutWithHeating</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-783"></a>  <span class="k">END IF</span>
<a name="ln-784"></a>
<a name="ln-785"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-786"></a><span class="k">    </span><span class="n">AirLoopflow</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">FanPLR</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span>
<a name="ln-787"></a>  <span class="k">END IF</span>
<a name="ln-788"></a>
<a name="ln-789"></a>  <span class="c">! Report the current Furnace output</span>
<a name="ln-790"></a>  <span class="k">Call </span><span class="n">ReportFurnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span>
<a name="ln-791"></a>
<a name="ln-792"></a>  <span class="c">! Reset OnOffFanPartLoadFraction to 1 in case another on/off fan is called without a part-load curve</span>
<a name="ln-793"></a>  <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-794"></a>
<a name="ln-795"></a>  <span class="k">RETURN</span>
<a name="ln-796"></a>
<a name="ln-797"></a>
<a name="ln-798"></a><span class="k">END SUBROUTINE </span><span class="n">SimFurnace</span>
<a name="ln-799"></a>
<a name="ln-800"></a>
<a name="ln-801"></a><span class="c">! Get Input Section of the Module</span>
<a name="ln-802"></a><span class="c">!******************************************************************************</span>
<a name="ln-803"></a><span class="k">SUBROUTINE </span><span class="n">GetFurnaceInput</span>
<a name="ln-804"></a>
<a name="ln-805"></a>
<a name="ln-806"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-807"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-808"></a>          <span class="c">!       DATE WRITTEN   Feb 2001</span>
<a name="ln-809"></a>          <span class="c">!       MODIFIED       Don Shirey and Rich Raustad, Mar/Oct 2001, Mar 2003</span>
<a name="ln-810"></a>          <span class="c">!                      Bereket Nigusse, April 2010 - deprecated supply air flow fraction through</span>
<a name="ln-811"></a>          <span class="c">!                      controlled zone from the input field.</span>
<a name="ln-812"></a>          <span class="c">!                      Bo Shen, March 2012, add inputs for VS WSHP,</span>
<a name="ln-813"></a>          <span class="c">!                      Bo Shen, ORNL, July 2012 - added variable-speed air source heat pump cooling and heating coils, using curve-fits</span>
<a name="ln-814"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-815"></a>
<a name="ln-816"></a>
<a name="ln-817"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-818"></a>          <span class="c">! Obtains input data for fans and coils and stores it in the Furnace data structures</span>
<a name="ln-819"></a>
<a name="ln-820"></a>
<a name="ln-821"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-822"></a>          <span class="c">! Uses &quot;Get&quot; routines to read in data.</span>
<a name="ln-823"></a>
<a name="ln-824"></a>
<a name="ln-825"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-826"></a>
<a name="ln-827"></a>
<a name="ln-828"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-829"></a>    <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetNumObjectsFound</span><span class="p">,</span> <span class="n">GetObjectItem</span><span class="p">,</span> <span class="n">VerifyName</span><span class="p">,</span> <span class="n">SameString</span><span class="p">,</span> <span class="n">FindItemInList</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-830"></a>                                          <span class="n">GetObjectDefMaxArgs</span>
<a name="ln-831"></a>    <span class="k">USE </span><span class="n">NodeInputManager</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetOnlySingleNode</span>
<a name="ln-832"></a>    <span class="k">USE </span><span class="n">DataLoopNode</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">NodeID</span>
<a name="ln-833"></a>    <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-834"></a>    <span class="k">USE </span><span class="n">BranchNodeConnections</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetUpCompSets</span><span class="p">,</span> <span class="n">TestCompSet</span>
<a name="ln-835"></a>    <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-836"></a>    <span class="k">USE </span><span class="n">DataZoneControls</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlledZone</span><span class="p">,</span> <span class="n">NumTempControlledZones</span><span class="p">,</span> <span class="n">HumidityControlZone</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-837"></a>                                          <span class="n">NumHumidityControlZones</span><span class="p">,</span> <span class="n">ComfortControlledZone</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-838"></a>    <span class="k">USE </span><span class="n">WaterToAirHeatPumpSimple</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetWtoAHPSimpleCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-839"></a>                                          <span class="n">GetWtoAHPSimpleCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-840"></a>                                          <span class="n">GetWtoAHPSimpleCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-841"></a>                                          <span class="n">GetWtoAHPSimpleCoilIndex</span><span class="o">=&gt;</span><span class="n">GetCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-842"></a>                                          <span class="n">SetSimpleWSHPData</span><span class="p">,</span> <span class="n">GetWtoAHPSimpleCoilAirFlow</span><span class="o">=&gt;</span><span class="n">GetCoilAirFlowRate</span>
<a name="ln-843"></a>    <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-844"></a>                                          <span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-845"></a>                                          <span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-846"></a>                                          <span class="n">GetCoilIndexVariableSpeed</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-847"></a>                                          <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">,&amp;</span>
<a name="ln-848"></a>                                          <span class="n">SetVarSpeedCoilData</span><span class="p">,</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-849"></a>                                          <span class="n">GetVSCoilMinOATCompressor</span>
<a name="ln-850"></a>    <span class="k">USE </span><span class="n">WaterToAirHeatPump</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetWtoAHPCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-851"></a>                                          <span class="n">GetWtoAHPCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-852"></a>                                          <span class="n">GetWtoAHPCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span><span class="n">GetWtoAHPCoilIndex</span><span class="o">=&gt;</span><span class="n">GetCoilIndex</span>
<a name="ln-853"></a>    <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetHeatingCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetHeatingCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-854"></a>                                          <span class="n">GetHeatingCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="n">GetHeatingCoilIndex</span><span class="o">=&gt;</span><span class="n">GetCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-855"></a>                                          <span class="n">GetHeatingCoilTypeNum</span><span class="p">,</span> <span class="n">GetHeatingCoilPLFCurveIndex</span>
<a name="ln-856"></a>    <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDXCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetMinOATDXCoilCompressor</span><span class="o">=&gt;</span><span class="n">GetMinOATCompressor</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-857"></a>                                          <span class="n">GetDXCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="n">GetDXCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-858"></a>                                          <span class="n">GetDXCoilCondenserInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilCondenserInletNode</span><span class="p">,</span><span class="n">GetDXCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-859"></a>                                          <span class="n">GetDXCoilTypeNum</span><span class="o">=&gt;</span><span class="n">GetCoilTypeNum</span><span class="p">,</span> <span class="n">SetDXCoolingCoilData</span>
<a name="ln-860"></a>    <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDXHXAsstdCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span><span class="p">,</span><span class="n">GetDXHXAsstdCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-861"></a>                                          <span class="n">GetDXHXAsstdCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span><span class="p">,</span><span class="n">GetHXDXCoilName</span><span class="p">,</span><span class="n">GetHXDXCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-862"></a>                                          <span class="n">GetHXAssistedCoilTypeNum</span><span class="o">=&gt;</span><span class="n">GetCoilGroupTypeNum</span><span class="p">,</span> <span class="n">GetActualDXCoilIndex</span>
<a name="ln-863"></a>    <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilWaterInletNode</span><span class="p">,</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-864"></a>                                          <span class="n">GetWaterCoilInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilInletNode</span><span class="p">,</span><span class="n">GetWaterCoilOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilOutletNode</span>
<a name="ln-865"></a>    <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSteamCoilAirInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilAirInletNode</span><span class="p">,</span> <span class="n">GetSteamCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-866"></a>                                          <span class="n">GetSteamCoilAirOutletNode</span><span class="o">=&gt;</span><span class="n">GetCoilAirOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-867"></a>                                          <span class="n">GetSteamCoilSteamInletNode</span><span class="o">=&gt;</span><span class="n">GetCoilSteamInletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-868"></a>                                          <span class="n">GetCoilMaxSteamFlowRate</span><span class="o">=&gt;</span><span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="n">GetTypeOfCoil</span><span class="p">,</span> <span class="n">ZoneLoadControl</span>
<a name="ln-869"></a>    <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">,</span><span class="n">GetFanInletNode</span><span class="p">,</span><span class="n">GetFanOutletNode</span><span class="p">,</span><span class="n">GetFanIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-870"></a>                                          <span class="n">GetFanAvailSchPtr</span><span class="p">,</span> <span class="n">GetFanType</span>
<a name="ln-871"></a>    <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-872"></a>    <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-873"></a>    <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-874"></a>    <span class="k">USE </span><span class="n">OutAirNodeManager</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckOutAirNodeNumber</span>
<a name="ln-875"></a>    <span class="k">USE </span><span class="n">DataIPShortCuts</span>
<a name="ln-876"></a>    <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>                 <span class="n">ONLY</span><span class="p">:</span> <span class="n">ManageEMS</span>
<a name="ln-877"></a>    <span class="k">USE </span><span class="n">HVACControllers</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckCoilWaterInletNode</span>
<a name="ln-878"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-879"></a>
<a name="ln-880"></a>
<a name="ln-881"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-882"></a>          <span class="c">! na</span>
<a name="ln-883"></a>
<a name="ln-884"></a>
<a name="ln-885"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-886"></a>          <span class="c">! na</span>
<a name="ln-887"></a>
<a name="ln-888"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-889"></a>          <span class="c">! na</span>
<a name="ln-890"></a>
<a name="ln-891"></a>
<a name="ln-892"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-893"></a>          <span class="c">! na</span>
<a name="ln-894"></a>
<a name="ln-895"></a>
<a name="ln-896"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-897"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FurnaceNum</span>      <span class="c">! The Furnace that you are currently loading input into</span>
<a name="ln-898"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">GetObjectNum</span>    <span class="c">! The index to each specific object name</span>
<a name="ln-899"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumFields</span>       <span class="c">! Total number of fields in object</span>
<a name="ln-900"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAlphas</span>       <span class="c">! Total number of alpha fields in object</span>
<a name="ln-901"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxAlphas</span>       <span class="c">! Maximum number of alpha fields in all objects</span>
<a name="ln-902"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumNumbers</span>      <span class="c">! Total number of numeric fields in object</span>
<a name="ln-903"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">MaxNumbers</span>      <span class="c">! Maximum number of numeric fields in all objects</span>
<a name="ln-904"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">IOStatus</span>        <span class="c">! Function call status</span>
<a name="ln-905"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>                    <span class="kd">::</span> <span class="n">Numbers</span>        <span class="c">! Numeric data</span>
<a name="ln-906"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">Alphas</span>         <span class="c">! Alpha data</span>
<a name="ln-907"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cAlphaFields</span>   <span class="c">! Alpha field names</span>
<a name="ln-908"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">Len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">cNumericFields</span> <span class="c">! Numeric field names</span>
<a name="ln-909"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lAlphaBlanks</span>      <span class="c">! Logical array, alpha field input BLANK = .TRUE.</span>
<a name="ln-910"></a>    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span>   <span class="kd">::</span> <span class="n">lNumericBlanks</span>    <span class="c">! Logical array, numeric field input BLANK = .TRUE.</span>
<a name="ln-911"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompSetFanInlet</span><span class="p">,</span> <span class="n">CompSetFanOutlet</span><span class="p">,</span> <span class="n">CompSetCoolInlet</span><span class="p">,</span> <span class="n">CompSetHeatInlet</span><span class="p">,</span> <span class="n">CompSetHeatOutlet</span>
<a name="ln-912"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CurrentModuleObject</span> <span class="c">! Object type for getting and error messages</span>
<a name="ln-913"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! If errors detected in input</span>
<a name="ln-914"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsNotOK</span>               <span class="c">! Flag to verify name</span>
<a name="ln-915"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">IsBlank</span>               <span class="c">! Flag for blank name</span>
<a name="ln-916"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">NumHeatOnly</span>           <span class="c">! Number of heat only furnaces</span>
<a name="ln-917"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">NumHeatCool</span>           <span class="c">! Number of heat/cool furnaces</span>
<a name="ln-918"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">HeatOnlyNum</span>           <span class="c">! Index to heat only furnaces</span>
<a name="ln-919"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">HeatCoolNum</span>           <span class="c">! Index to heat/cool furnaces</span>
<a name="ln-920"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">NumUnitaryHeatOnly</span>    <span class="c">! Number of heat only unitary systems</span>
<a name="ln-921"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">NumUnitaryHeatCool</span>    <span class="c">! Number of heat/cool unitary systems</span>
<a name="ln-922"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">UnitaryHeatOnlyNum</span>    <span class="c">! Index to heat only furnaces</span>
<a name="ln-923"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">UnitaryHeatCoolNum</span>    <span class="c">! Index to heat/cool unitary systems</span>
<a name="ln-924"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">NumWaterToAirHeatPump</span> <span class="c">! Number of water-to-air heat pumps</span>
<a name="ln-925"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">NumHeatPump</span>           <span class="c">! Number of air-to-air or water-to-air heat pumps</span>
<a name="ln-926"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">HeatPumpNum</span>           <span class="c">! Index to air-to-air heat pumps</span>
<a name="ln-927"></a>    <span class="kt">Integer</span> <span class="kd">::</span> <span class="n">ControlledZoneNum</span>     <span class="c">! Index to controlled zones</span>
<a name="ln-928"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">AirNodeFound</span>          <span class="c">! Used to determine if control zone is valid</span>
<a name="ln-929"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">AirLoopFound</span>          <span class="c">! Used to determine if control zone is served by furnace air loop</span>
<a name="ln-930"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirLoopNumber</span>         <span class="c">! Used to determine if control zone is served by furnace air loop</span>
<a name="ln-931"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">BranchNum</span>             <span class="c">! Used to determine if control zone is served by furnace air loop</span>
<a name="ln-932"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompNum</span>               <span class="c">! Used to determine if control zone is served by furnace air loop</span>
<a name="ln-933"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">TstatZoneNum</span>          <span class="c">! Used to determine if control zone has a thermostat object</span>
<a name="ln-934"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HstatZoneNum</span>          <span class="c">! Used to determine if control zone has a humidistat object</span>
<a name="ln-935"></a>    <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrFlag</span>               <span class="c">! Mining function error flag</span>
<a name="ln-936"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FanInletNode</span>          <span class="c">! Used for node checking warning messages</span>
<a name="ln-937"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FanOutletNode</span>         <span class="c">! Used for node checking warning messages</span>
<a name="ln-938"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoolingCoilInletNode</span>  <span class="c">! Used for node checking warning messages</span>
<a name="ln-939"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CoolingCoilOutletNode</span> <span class="c">! Used for node checking warning messages</span>
<a name="ln-940"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatingCoilInletNode</span>  <span class="c">! Used for node checking warning messages</span>
<a name="ln-941"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">HeatingCoilOutletNode</span> <span class="c">! Used for node checking warning messages</span>
<a name="ln-942"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SupHeatCoilInletNode</span>  <span class="c">! Used for node checking warning messages</span>
<a name="ln-943"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SupHeatCoilOutletNode</span> <span class="c">! Used for node checking warning messages</span>
<a name="ln-944"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ReHeatCoilInletNode</span>   <span class="c">! Used for node checking warning messages</span>
<a name="ln-945"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ReHeatCoilOutletNode</span>  <span class="c">! Used for node checking warning messages</span>
<a name="ln-946"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanVolFlowRate</span>        <span class="c">! Fan Max Flow Rate from Fan object (for comparisons to validity)</span>
<a name="ln-947"></a>    <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FurnaceType_Num</span>       <span class="c">! Integer equivalent of Furnace or UnitarySystem &quot;type&quot;</span>
<a name="ln-948"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CoolingCoilType</span>     <span class="c">! Used in mining function CALLS</span>
<a name="ln-949"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">CoolingCoilName</span>     <span class="c">! Used in mining function CALLS</span>
<a name="ln-950"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HeatingCoilType</span>     <span class="c">! Used in mining function CALLS</span>
<a name="ln-951"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HeatingCoilName</span>     <span class="c">! Used in mining function CALLS</span>
<a name="ln-952"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ReheatingCoilType</span>   <span class="c">! Used in mining function CALLS</span>
<a name="ln-953"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ReheatingCoilName</span>   <span class="c">! Used in mining function CALLS</span>
<a name="ln-954"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SuppHeatCoilType</span>    <span class="c">! Used in mining function CALLS</span>
<a name="ln-955"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SuppHeatCoilName</span>    <span class="c">! Used in mining function CALLS</span>
<a name="ln-956"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FanType</span>             <span class="c">! Used in mining function CALLS</span>
<a name="ln-957"></a>    <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FanName</span>             <span class="c">! Used in mining function CALLS</span>
<a name="ln-958"></a>    <span class="kt">LOGICAL</span>                        <span class="kd">::</span> <span class="n">PrintMessage</span>        <span class="c">! Used in mining function CALLS</span>
<a name="ln-959"></a>    <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">TotalZonesOnAirLoop</span> <span class="c">! number of zones attached to air loop</span>
<a name="ln-960"></a>    <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">HeatingCoilPLFCurveIndex</span> <span class="c">! index of heating coil PLF curve</span>
<a name="ln-961"></a>    <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">SteamIndex</span>          <span class="c">!  steam coil index</span>
<a name="ln-962"></a>    <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                      <span class="kd">::</span> <span class="n">SteamDensity</span>        <span class="c">!  density of steam at 100C</span>
<a name="ln-963"></a>    <span class="kt">INTEGER</span>                        <span class="kd">::</span> <span class="n">DXCoilIndex</span>         <span class="c">! Index to DX coil in HXAssited object</span>
<a name="ln-964"></a>
<a name="ln-965"></a>
<a name="ln-966"></a>          <span class="c">! Flow</span>
<a name="ln-967"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-968"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="mi">0</span>
<a name="ln-969"></a>
<a name="ln-970"></a>    <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatOnly&#39;</span>
<a name="ln-971"></a>    <span class="n">NumHeatOnly</span>          <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-972"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumFields</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-973"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-974"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-975"></a>
<a name="ln-976"></a>    <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatCool&#39;</span>
<a name="ln-977"></a>    <span class="n">NumHeatCool</span>          <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-978"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumFields</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-979"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-980"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-981"></a>
<a name="ln-982"></a>    <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatOnly&#39;</span>
<a name="ln-983"></a>    <span class="n">NumUnitaryHeatOnly</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-984"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumFields</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-985"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-986"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-987"></a>
<a name="ln-988"></a>    <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool&#39;</span>
<a name="ln-989"></a>    <span class="n">NumUnitaryHeatCool</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-990"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumFields</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-991"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-992"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-993"></a>
<a name="ln-994"></a>    <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir&#39;</span>
<a name="ln-995"></a>    <span class="n">NumHeatPump</span>   <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-996"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumFields</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-997"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-998"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-999"></a>
<a name="ln-1000"></a>    <span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:WaterToAir&#39;</span>
<a name="ln-1001"></a>    <span class="n">NumWaterToAirHeatPump</span> <span class="o">=</span> <span class="n">GetNumObjectsFound</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span>
<a name="ln-1002"></a>    <span class="k">CALL </span><span class="n">GetObjectDefMaxArgs</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">NumFields</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1003"></a>    <span class="n">MaxNumbers</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">)</span>
<a name="ln-1004"></a>    <span class="n">MaxAlphas</span><span class="o">=</span><span class="nb">MAX</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">)</span>
<a name="ln-1005"></a>
<a name="ln-1006"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1007"></a>    <span class="n">Alphas</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1008"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1009"></a>    <span class="n">Numbers</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-1010"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1011"></a>    <span class="n">cAlphaFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1012"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1013"></a>    <span class="n">cNumericFields</span><span class="o">=</span><span class="s1">&#39; &#39;</span>
<a name="ln-1014"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="n">MaxAlphas</span><span class="p">))</span>
<a name="ln-1015"></a>    <span class="n">lAlphaBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1016"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">lNumericBlanks</span><span class="p">(</span><span class="n">MaxNumbers</span><span class="p">))</span>
<a name="ln-1017"></a>    <span class="n">lNumericBlanks</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1018"></a>
<a name="ln-1019"></a>    <span class="n">NumFurnaces</span> <span class="o">=</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumHeatCool</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatCool</span> <span class="o">+</span> <span class="n">NumHeatPump</span> <span class="o">+</span> <span class="n">NumWaterToAirHeatPump</span>
<a name="ln-1020"></a>
<a name="ln-1021"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">NumFurnaces</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1022"></a><span class="k">      ALLOCATE</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-1023"></a>    <span class="n">ENDIF</span>
<a name="ln-1024"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">CheckEquipName</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-1025"></a>    <span class="n">CheckEquipName</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-1026"></a>
<a name="ln-1027"></a>      <span class="c">! Get the data for the HeatOnly Furnace</span>
<a name="ln-1028"></a>      <span class="k">DO </span><span class="n">HeatOnlyNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span>
<a name="ln-1029"></a>
<a name="ln-1030"></a>        <span class="n">FanInletNode</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1031"></a>        <span class="n">FanOutletNode</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1032"></a>        <span class="n">FanVolFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1033"></a>        <span class="n">HeatingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1034"></a>        <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1035"></a>
<a name="ln-1036"></a><span class="c">!       Furnace and UnitarySystem objects are both read in here.</span>
<a name="ln-1037"></a><span class="c">!       Will still have 2 differently named objects for the user, but read in with 1 DO loop.</span>
<a name="ln-1038"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HeatOnlyNum</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">NumHeatOnly</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1039"></a><span class="k">          </span><span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatOnly&#39;</span>
<a name="ln-1040"></a>          <span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">Furnace_HeatOnly</span>
<a name="ln-1041"></a>          <span class="n">GetObjectNum</span>    <span class="o">=</span> <span class="n">HeatOnlyNum</span>
<a name="ln-1042"></a>        <span class="k">ELSE</span>
<a name="ln-1043"></a><span class="k">          </span><span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatOnly&#39;</span>
<a name="ln-1044"></a>          <span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">UnitarySys_HeatOnly</span>
<a name="ln-1045"></a>          <span class="n">GetObjectNum</span>    <span class="o">=</span> <span class="n">HeatOnlyNum</span> <span class="o">-</span> <span class="n">NumHeatOnly</span>
<a name="ln-1046"></a>        <span class="k">END IF</span>
<a name="ln-1047"></a>
<a name="ln-1048"></a><span class="k">        </span><span class="n">FurnaceNum</span>  <span class="o">=</span> <span class="n">HeatOnlyNum</span>
<a name="ln-1049"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">FurnaceType_Num</span>
<a name="ln-1050"></a>
<a name="ln-1051"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">GetObjectNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1052"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1053"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1054"></a>
<a name="ln-1055"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1056"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1057"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Furnace</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FurnaceNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1058"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1059"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1060"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1061"></a>        <span class="n">ENDIF</span>
<a name="ln-1062"></a>
<a name="ln-1063"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1064"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1065"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1066"></a>        <span class="k">ELSE</span>
<a name="ln-1067"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1068"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1069"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1070"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1071"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1072"></a>          <span class="n">ENDIF</span>
<a name="ln-1073"></a>        <span class="n">ENDIF</span>
<a name="ln-1074"></a>
<a name="ln-1075"></a>
<a name="ln-1076"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1077"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1078"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1079"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1080"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1081"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1082"></a>
<a name="ln-1083"></a>
<a name="ln-1084"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1085"></a>
<a name="ln-1086"></a>
<a name="ln-1087"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span>     <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1088"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1089"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1090"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1091"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1092"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1093"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-1094"></a>        <span class="n">ENDIF</span>
<a name="ln-1095"></a>
<a name="ln-1096"></a>         <span class="c">!Get the Controlling Zone or Location of the Furnace Thermostat</span>
<a name="ln-1097"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1098"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1099"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1100"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1101"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1102"></a>        <span class="n">ENDIF</span>
<a name="ln-1103"></a>
<a name="ln-1104"></a>        <span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1105"></a>
<a name="ln-1106"></a>        <span class="c">! Get the node number for the zone with the thermostat</span>
<a name="ln-1107"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span>  <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1108"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1109"></a>          <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1110"></a>          <span class="k">DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1111"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1112"></a><span class="c">!             Find the controlled zone number for the specified thermostat location</span>
<a name="ln-1113"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-1114"></a><span class="c">!             Determine if furnace is on air loop served by the thermostat location specified</span>
<a name="ln-1115"></a>              <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-1116"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1117"></a><span class="k">                DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-1118"></a>                  <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-1119"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1120"></a>                             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1121"></a>                       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1122"></a>                             <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-1123"></a><span class="k">                    </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1124"></a>                    <span class="k">EXIT</span>
<a name="ln-1125"></a><span class="k">                  END DO</span>
<a name="ln-1126"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-1127"></a><span class="k">                END DO</span>
<a name="ln-1128"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTempControlledZones</span>
<a name="ln-1129"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-1130"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1131"></a>                <span class="k">END DO</span>
<a name="ln-1132"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-1133"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-1134"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1135"></a>                <span class="k">END DO</span>
<a name="ln-1136"></a><span class="k">              ELSE</span>
<a name="ln-1137"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1138"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find an AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-1139"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1140"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1141"></a>              <span class="k">END IF</span>
<a name="ln-1142"></a><span class="k">            EXIT</span>
<a name="ln-1143"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-1144"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1145"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1146"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (Zone with Thermostat).&#39;</span><span class="p">)</span>
<a name="ln-1147"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1148"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Both a ZoneHVAC:EquipmentConnections object and a ZoneControl:Thermostat object&#39;</span> <span class="p">&amp;</span>
<a name="ln-1149"></a>                                <span class="o">//</span><span class="s1">&#39; must be specified for this zone.&#39;</span><span class="p">)</span>
<a name="ln-1150"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1151"></a>          <span class="n">ENDIF</span>
<a name="ln-1152"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1153"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1154"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find correct Primary Air Loop.&#39;</span><span class="p">)</span>
<a name="ln-1155"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1156"></a>                                   <span class="s1">&#39; is not served by this AirLoopHVAC equipment.&#39;</span><span class="p">)</span>
<a name="ln-1157"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1158"></a>          <span class="n">ENDIF</span>
<a name="ln-1159"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1160"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1161"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span> <span class="o">==</span> <span class="n">AirLoopNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1162"></a><span class="k">                </span><span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="n">TotalZonesOnAirLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1163"></a>              <span class="k">END IF</span>
<a name="ln-1164"></a><span class="k">            END DO</span>
<a name="ln-1165"></a><span class="k">          END IF</span>
<a name="ln-1166"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1167"></a>
<a name="ln-1168"></a>
<a name="ln-1169"></a>         <span class="c">!Get fan data</span>
<a name="ln-1170"></a>        <span class="n">FanType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1171"></a>        <span class="n">FanName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1172"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1173"></a>        <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1174"></a>           <span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1175"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1176"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1177"></a>        <span class="k">END IF</span>
<a name="ln-1178"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleOnOff</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1179"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1180"></a>
<a name="ln-1181"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1182"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1183"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1184"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1185"></a>
<a name="ln-1186"></a>          <span class="k">ELSE</span> <span class="c">! mine data from fan object</span>
<a name="ln-1187"></a>
<a name="ln-1188"></a>            <span class="c">! Get the fan index</span>
<a name="ln-1189"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1190"></a>            <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1191"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1192"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1193"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1194"></a>            <span class="n">ENDIF</span>
<a name="ln-1195"></a>
<a name="ln-1196"></a>            <span class="c">!Set the Design Fan Volume Flow Rate</span>
<a name="ln-1197"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1198"></a>            <span class="n">FanVolFlowRate</span> <span class="o">=</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1199"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>    <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-1200"></a>
<a name="ln-1201"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1202"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1203"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1204"></a>            <span class="n">ENDIF</span>
<a name="ln-1205"></a>
<a name="ln-1206"></a>            <span class="c">! Get the Fan Inlet Node</span>
<a name="ln-1207"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1208"></a>            <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1209"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1210"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1211"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1212"></a>            <span class="n">ENDIF</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a>            <span class="c">! Get the Fan Outlet Node</span>
<a name="ln-1215"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1216"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1217"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1218"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1219"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1220"></a>            <span class="n">ENDIF</span>
<a name="ln-1221"></a>
<a name="ln-1222"></a>            <span class="c">! Get the fan&#39;s availabitlity schedule</span>
<a name="ln-1223"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1224"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span> <span class="o">=</span> <span class="n">GetFanAvailSchPtr</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1225"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1226"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1227"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1228"></a>            <span class="n">ENDIF</span>
<a name="ln-1229"></a>
<a name="ln-1230"></a>            <span class="c">! Check fan&#39;s schedule for cycling fan operation if constant volume fan is used</span>
<a name="ln-1231"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1232"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1233"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1234"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1235"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan operating mode must be continuous (fan operating mode schedule values &gt; 0).&#39;</span><span class="p">)</span>
<a name="ln-1236"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1237"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...schedule values must be (&gt;0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-1238"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1239"></a>              <span class="k">END IF</span>
<a name="ln-1240"></a><span class="k">            ELSE IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">/=</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1241"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1242"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1243"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan type must be Fan:OnOff when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1244"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Blank.&#39;</span><span class="p">)</span>
<a name="ln-1245"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1246"></a>            <span class="k">END IF</span>
<a name="ln-1247"></a>
<a name="ln-1248"></a><span class="k">          </span><span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-1249"></a>
<a name="ln-1250"></a>        <span class="k">ELSE</span> <span class="c">! wrong fan type</span>
<a name="ln-1251"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1252"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1253"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1254"></a>        <span class="k">END IF</span> <span class="c">! IF (Furnace(FurnaceNum)%FanType_Num == FanType_SimpleOnOff .OR. &amp;</span>
<a name="ln-1255"></a>
<a name="ln-1256"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span> <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-1257"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-1258"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">)</span> <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-1259"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-1260"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1261"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1262"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-1263"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1264"></a>        <span class="k">END IF</span>
<a name="ln-1265"></a>
<a name="ln-1266"></a>            <span class="c">!Get coil data</span>
<a name="ln-1267"></a>        <span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1268"></a>        <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1269"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">HeatingCoilType</span>
<a name="ln-1270"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">HeatingCoilName</span>
<a name="ln-1271"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1272"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1273"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1274"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1275"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1276"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1277"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1278"></a>            <span class="k">ELSE</span>
<a name="ln-1279"></a><span class="k">              CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1280"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1281"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1282"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1283"></a>
<a name="ln-1284"></a>              <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1285"></a>
<a name="ln-1286"></a>                <span class="c">! Get index to Heating Coil</span>
<a name="ln-1287"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1288"></a>                <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1289"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1290"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1291"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1292"></a>                <span class="n">ENDIF</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a>                <span class="c">! Get the furnace design capacity</span>
<a name="ln-1295"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1296"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>  <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1297"></a>                   <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1298"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1299"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1300"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1301"></a>                <span class="n">ENDIF</span>
<a name="ln-1302"></a>
<a name="ln-1303"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-1304"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1305"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1306"></a>                   <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1307"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-1308"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1309"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1310"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1311"></a>                <span class="n">ENDIF</span>
<a name="ln-1312"></a>
<a name="ln-1313"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-1314"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1315"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1316"></a>                   <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1317"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1318"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1319"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1320"></a>                <span class="n">ENDIF</span>
<a name="ln-1321"></a>
<a name="ln-1322"></a>              <span class="n">ENDIF</span>           <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-1323"></a>
<a name="ln-1324"></a>            <span class="n">ENDIF</span>
<a name="ln-1325"></a>
<a name="ln-1326"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1327"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-1328"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1329"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1330"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1331"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1332"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1333"></a>
<a name="ln-1334"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-1335"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1336"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1337"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1338"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1339"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1340"></a>                <span class="k">END IF</span>
<a name="ln-1341"></a>
<a name="ln-1342"></a>                <span class="c">! Get the Heating Coil hot water max volume flow rate</span>
<a name="ln-1343"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1344"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1345"></a>                                                           <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1346"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1347"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1348"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1349"></a>                <span class="k">END IF</span>
<a name="ln-1350"></a>
<a name="ln-1351"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-1352"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1353"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1354"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-1355"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1356"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1357"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1358"></a>                <span class="k">END IF</span>
<a name="ln-1359"></a>
<a name="ln-1360"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-1361"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1362"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1363"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirOutletNode</span> <span class="o">=</span> <span class="n">HeatingCoilOutletNode</span>
<a name="ln-1364"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1365"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1366"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1367"></a>                <span class="k">END IF</span>
<a name="ln-1368"></a>
<a name="ln-1369"></a>                <span class="c">! check if user has also used a water coil controller, which they should not do</span>
<a name="ln-1370"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1371"></a>                <span class="k">CALL </span><span class="n">CheckCoilWaterInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1372"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! then did find a controller so that is bad</span>
<a name="ln-1373"></a>                  <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1374"></a>                                      <span class="o">//</span><span class="s1">&#39; has a conflicting Controller:WaterCoil object&#39;</span> <span class="p">)</span>
<a name="ln-1375"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Hot water coils are controlled directly by unitary and furnace systems.&#39;</span><span class="p">)</span>
<a name="ln-1376"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;No water coil controller should be input for the coil.&#39;</span><span class="p">)</span>
<a name="ln-1377"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1378"></a>                <span class="n">ENDIF</span>
<a name="ln-1379"></a>
<a name="ln-1380"></a>            <span class="n">ENDIF</span>
<a name="ln-1381"></a>
<a name="ln-1382"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1383"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-1384"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1385"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1386"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1387"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1388"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1391"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1392"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1393"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1394"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-1395"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1396"></a>                    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1397"></a>                <span class="k">END IF</span>
<a name="ln-1398"></a>
<a name="ln-1399"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-1400"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1401"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1402"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1403"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1404"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1405"></a>                <span class="k">END IF</span>
<a name="ln-1406"></a>
<a name="ln-1407"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-1408"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1409"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1410"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1411"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetUnitaryHeatOnly&#39;</span><span class="p">)</span>
<a name="ln-1412"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1413"></a>                <span class="k">END IF</span>
<a name="ln-1414"></a>
<a name="ln-1415"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-1416"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1417"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1418"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1419"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-1420"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1421"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1422"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1423"></a>                <span class="k">END IF</span>
<a name="ln-1424"></a>
<a name="ln-1425"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-1426"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1427"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1428"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1429"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirOutletNode</span> <span class="o">=</span> <span class="n">HeatingCoilOutletNode</span>
<a name="ln-1430"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1431"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1432"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1433"></a>                <span class="k">END IF</span>
<a name="ln-1434"></a>
<a name="ln-1435"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-1436"></a>
<a name="ln-1437"></a>        <span class="k">ELSE</span>
<a name="ln-1438"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1439"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-1440"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1441"></a>        <span class="k">END IF</span> <span class="c">! IF (Furnace(FurnaceNum)%HeatingCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-1442"></a>
<a name="ln-1443"></a>        <span class="c">! Add component sets array</span>
<a name="ln-1444"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1445"></a><span class="k">          </span><span class="n">CompSetFanInlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1446"></a>          <span class="n">CompSetFanOutlet</span> <span class="o">=</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)</span>
<a name="ln-1447"></a>          <span class="n">CompSetHeatInlet</span> <span class="o">=</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)</span>
<a name="ln-1448"></a>          <span class="n">CompSetHeatOutlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1449"></a>          <span class="c">! Fan inlet node name must not be the same as the furnace inlet node name</span>
<a name="ln-1450"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FanInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1451"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1452"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1453"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1454"></a>                                 <span class="s1">&#39;the fan inlet node name must be the same as the furnace inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1455"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-1456"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-1457"></a>            <span class="k">ELSE</span>
<a name="ln-1458"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1459"></a>                                 <span class="s1">&#39;the fan inlet node name must be the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1460"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name            = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-1461"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary System inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-1462"></a>            <span class="k">END IF</span>
<a name="ln-1463"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1464"></a>          <span class="k">END IF</span>
<a name="ln-1465"></a>          <span class="c">! Fan outlet node name must be the same as the heating coil inlet node name</span>
<a name="ln-1466"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1467"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1468"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1469"></a>                                 <span class="s1">&#39;the fan outlet node name must be the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1470"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-1471"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1472"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1473"></a>          <span class="k">END IF</span>
<a name="ln-1474"></a>          <span class="c">! Heating coil outlet node name must be the same as the furnace outlet node name</span>
<a name="ln-1475"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1476"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1477"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1478"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1479"></a>                           <span class="s1">&#39;the heating coil outlet node name must be the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1480"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1481"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1482"></a>                                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-1483"></a>            <span class="k">ELSE</span>
<a name="ln-1484"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1485"></a>                           <span class="s1">&#39;the heating coil outlet node name must be the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1486"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1487"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1488"></a>                                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-1489"></a>            <span class="k">END IF</span>
<a name="ln-1490"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1491"></a>          <span class="k">END IF</span>
<a name="ln-1492"></a><span class="k">        ELSE</span> <span class="c">! draw through fan</span>
<a name="ln-1493"></a>          <span class="n">CompSetHeatInlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-1494"></a>          <span class="n">CompSetHeatOutlet</span> <span class="o">=</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)</span>
<a name="ln-1495"></a>          <span class="n">CompSetFanInlet</span> <span class="o">=</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)</span>
<a name="ln-1496"></a>          <span class="n">CompSetFanOutlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1497"></a>          <span class="c">! Heating coil inlet node name must not be the same as the furnace inlet node name</span>
<a name="ln-1498"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingCoilInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1499"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1500"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1501"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1502"></a>                          <span class="s1">&#39;the heating coil inlet node name must be the same as the furnace inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1503"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1504"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace inlet node name      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1505"></a>                                                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-1506"></a>            <span class="k">ELSE</span>
<a name="ln-1507"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1508"></a>                          <span class="s1">&#39;the heating coil inlet node name must be the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1509"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-1510"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1511"></a>                                                                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-1512"></a>            <span class="k">END IF</span>
<a name="ln-1513"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1514"></a>          <span class="k">END IF</span>
<a name="ln-1515"></a>          <span class="c">! Heating coil outlet node name must be the same as the fan inlet node name</span>
<a name="ln-1516"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1517"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1518"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1519"></a>                                 <span class="s1">&#39;the heating coil outlet node name must be the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1520"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-1521"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-1522"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1523"></a>          <span class="k">END IF</span>
<a name="ln-1524"></a>          <span class="c">! Fan coil outlet node name must be the same as the furnace outlet node name</span>
<a name="ln-1525"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1526"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1527"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1528"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1529"></a>                                 <span class="s1">&#39;the fan outlet node name must be the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1530"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-1531"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1532"></a>                                                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-1533"></a>            <span class="k">ELSE</span>
<a name="ln-1534"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-1535"></a>                                 <span class="s1">&#39;the fan outlet node name must be the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-1536"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-1537"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1538"></a>                                                          <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-1539"></a>            <span class="k">END IF</span>
<a name="ln-1540"></a><span class="k">            </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1541"></a>          <span class="k">END IF</span>
<a name="ln-1542"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1543"></a>
<a name="ln-1544"></a>        <span class="c">! Add fan to component sets array</span>
<a name="ln-1545"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1546"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">CompSetFanInlet</span><span class="p">,</span><span class="n">CompSetFanOutlet</span><span class="p">)</span>
<a name="ln-1547"></a>        <span class="c">! Add heating coil to component sets array</span>
<a name="ln-1548"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1549"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">CompSetHeatInlet</span><span class="p">,</span><span class="n">CompSetHeatOutlet</span><span class="p">)</span>
<a name="ln-1550"></a>
<a name="ln-1551"></a>        <span class="c">! Set the furnace max outlet temperature</span>
<a name="ln-1552"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1553"></a>
<a name="ln-1554"></a>        <span class="c">! Set the furnace design fan volumetric flow rate</span>
<a name="ln-1555"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a>        <span class="c">! Compare the flow rates.</span>
<a name="ln-1558"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1559"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&gt;</span> <span class="n">FanVolFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1560"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1561"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &gt; Max Volume Flow Rate defined &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1562"></a>                                   <span class="s1">&#39;in the associated fan object, should be &lt;=.&#39;</span><span class="p">)</span>
<a name="ln-1563"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Entered value = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1564"></a>                <span class="s1">&#39;... Fan [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1565"></a>                <span class="s1">&#39;] Max Value = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
<a name="ln-1566"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The HVAC system  flow rate is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-1567"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-1568"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-1569"></a>          <span class="n">ENDIF</span>
<a name="ln-1570"></a>        <span class="n">ENDIF</span>
<a name="ln-1571"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1572"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1573"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1574"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &lt;= 0.0, it must be &gt; 0.0.&#39;</span><span class="p">)</span>
<a name="ln-1575"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Entered value = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1576"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1577"></a>          <span class="n">ENDIF</span>
<a name="ln-1578"></a>        <span class="n">ENDIF</span>
<a name="ln-1579"></a>
<a name="ln-1580"></a><span class="c">!       HeatOnly furnace has only 1 flow rate, initialize other variables used in this module</span>
<a name="ln-1581"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>       <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>
<a name="ln-1582"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>
<a name="ln-1583"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span>
<a name="ln-1584"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span>          <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-1585"></a>
<a name="ln-1586"></a>        <span class="c">!Set heating convergence tolerance</span>
<a name="ln-1587"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-1588"></a>
<a name="ln-1589"></a>       <span class="k">END DO</span>  <span class="c">!End of the HeatOnly Furnace Loop</span>
<a name="ln-1590"></a>
<a name="ln-1591"></a>
<a name="ln-1592"></a>
<a name="ln-1593"></a>      <span class="c">! Get the data for the HeatCool Furnace or UnitarySystem</span>
<a name="ln-1594"></a>      <span class="k">DO </span><span class="n">HeatCoolNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumHeatCool</span> <span class="o">+</span> <span class="n">NumUnitaryHeatCool</span>
<a name="ln-1595"></a>
<a name="ln-1596"></a>        <span class="n">FanInletNode</span>          <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1597"></a>        <span class="n">FanOutletNode</span>         <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1598"></a>        <span class="n">FanVolFlowRate</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-1599"></a>        <span class="n">CoolingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1600"></a>        <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1601"></a>        <span class="n">HeatingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1602"></a>        <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1603"></a>        <span class="n">ReHeatCoilInletNode</span>   <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1604"></a>        <span class="n">ReHeatCoilOutletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1605"></a>
<a name="ln-1606"></a><span class="c">!      Furnace and UnitarySystem objects are both read in here.</span>
<a name="ln-1607"></a><span class="c">!      Will still have 2 differently named objects for the user, but read in with 1 DO loop.</span>
<a name="ln-1608"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HeatCoolNum</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">NumHeatCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1609"></a><span class="k">          </span><span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatCool&#39;</span>
<a name="ln-1610"></a>          <span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">Furnace_HeatCool</span>
<a name="ln-1611"></a>          <span class="n">GetObjectNum</span>    <span class="o">=</span> <span class="n">HeatCoolNum</span>
<a name="ln-1612"></a>        <span class="k">ELSE</span>
<a name="ln-1613"></a><span class="k">          </span><span class="n">CurrentModuleObject</span>  <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool&#39;</span>
<a name="ln-1614"></a>          <span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">UnitarySys_HeatCool</span>
<a name="ln-1615"></a>          <span class="n">GetObjectNum</span>    <span class="o">=</span> <span class="n">HeatCoolNum</span> <span class="o">-</span> <span class="n">NumHeatCool</span>
<a name="ln-1616"></a>        <span class="k">END IF</span>
<a name="ln-1617"></a>
<a name="ln-1618"></a><span class="k">        </span><span class="n">FurnaceNum</span>  <span class="o">=</span> <span class="n">HeatCoolNum</span> <span class="o">+</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span>
<a name="ln-1619"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">FurnaceType_Num</span>
<a name="ln-1620"></a>
<a name="ln-1621"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">GetObjectNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1622"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1623"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-1624"></a>
<a name="ln-1625"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1626"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1627"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Furnace</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FurnaceNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-1628"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1629"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1630"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-1631"></a>        <span class="n">ENDIF</span>
<a name="ln-1632"></a>
<a name="ln-1633"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1634"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1635"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-1636"></a>        <span class="k">ELSE</span>
<a name="ln-1637"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-1638"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1639"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1640"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-1641"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1642"></a>          <span class="n">ENDIF</span>
<a name="ln-1643"></a>        <span class="n">ENDIF</span>
<a name="ln-1644"></a>
<a name="ln-1645"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1646"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1647"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1648"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1649"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-1650"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-1651"></a>
<a name="ln-1652"></a>
<a name="ln-1653"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-1654"></a>
<a name="ln-1655"></a>
<a name="ln-1656"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span>     <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<a name="ln-1657"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1658"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1659"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1660"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1661"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1662"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-1663"></a>        <span class="n">ENDIF</span>
<a name="ln-1664"></a>
<a name="ln-1665"></a>         <span class="c">!Get the Controlling Zone or Location of the Furnace Thermostat</span>
<a name="ln-1666"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-1667"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1668"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1669"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1670"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1671"></a>        <span class="n">ENDIF</span>
<a name="ln-1672"></a>
<a name="ln-1673"></a>        <span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1674"></a>
<a name="ln-1675"></a>        <span class="c">! Get the node number for the zone with the thermostat</span>
<a name="ln-1676"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span>  <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1677"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1678"></a>          <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1679"></a>          <span class="k">DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1680"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-1681"></a><span class="c">!             Find the controlled zone number for the specified thermostat location</span>
<a name="ln-1682"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-1683"></a><span class="c">!             Determine if system is on air loop served by the thermostat location specified</span>
<a name="ln-1684"></a>              <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-1685"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1686"></a><span class="k">                DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-1687"></a>                  <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-1688"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1689"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1690"></a>                       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1691"></a>                             <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-1692"></a><span class="k">                    </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1693"></a>                    <span class="k">EXIT</span>
<a name="ln-1694"></a><span class="k">                  END DO</span>
<a name="ln-1695"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-1696"></a><span class="k">                END DO</span>
<a name="ln-1697"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTempControlledZones</span>
<a name="ln-1698"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-1699"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1700"></a>                <span class="k">END DO</span>
<a name="ln-1701"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-1702"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-1703"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1704"></a>                <span class="k">END DO</span>
<a name="ln-1705"></a><span class="k">              ELSE</span>
<a name="ln-1706"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1707"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find an AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-1708"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1709"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1710"></a>              <span class="k">END IF</span>
<a name="ln-1711"></a><span class="k">            EXIT</span>
<a name="ln-1712"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-1713"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1714"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1715"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find air node (zone with thermostat).&#39;</span><span class="p">)</span>
<a name="ln-1716"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1717"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Both a ZoneHVAC:EquipmentConnections object and a ZoneControl:Thermostat object&#39;</span> <span class="p">&amp;</span>
<a name="ln-1718"></a>                                <span class="o">//</span><span class="s1">&#39; must be specified for this zone.&#39;</span><span class="p">)</span>
<a name="ln-1719"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1720"></a>          <span class="n">ENDIF</span>
<a name="ln-1721"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1722"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1723"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find correct AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-1724"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-1725"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1726"></a>          <span class="n">ENDIF</span>
<a name="ln-1727"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1728"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-1729"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span> <span class="o">==</span> <span class="n">AirLoopNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1730"></a><span class="k">                </span><span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="n">TotalZonesOnAirLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1731"></a>              <span class="k">END IF</span>
<a name="ln-1732"></a><span class="k">            END DO</span>
<a name="ln-1733"></a><span class="k">          END IF</span>
<a name="ln-1734"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-1735"></a>
<a name="ln-1736"></a>         <span class="c">!Get fan data</span>
<a name="ln-1737"></a>        <span class="n">FanType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-1738"></a>        <span class="n">FanName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1739"></a>
<a name="ln-1740"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1741"></a>        <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1742"></a>           <span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-1743"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1744"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1745"></a>        <span class="k">END IF</span>
<a name="ln-1746"></a>
<a name="ln-1747"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleOnOff</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1748"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1749"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1750"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1751"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;In Furnace=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1752"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1753"></a>
<a name="ln-1754"></a>          <span class="k">ELSE</span> <span class="c">! mine data from fan object</span>
<a name="ln-1755"></a>
<a name="ln-1756"></a>            <span class="c">! Get the fan index</span>
<a name="ln-1757"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1758"></a>            <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1759"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1760"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1761"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1762"></a>            <span class="n">ENDIF</span>
<a name="ln-1763"></a>
<a name="ln-1764"></a>            <span class="c">! Get the Design Fan Volume Flow Rate</span>
<a name="ln-1765"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1766"></a>            <span class="n">FanVolFlowRate</span> <span class="o">=</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1767"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-1768"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1769"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-1770"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1771"></a>            <span class="n">ENDIF</span>
<a name="ln-1772"></a>
<a name="ln-1773"></a>            <span class="c">! Get the Fan Inlet Node</span>
<a name="ln-1774"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1775"></a>            <span class="n">FanInletNode</span> <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1776"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1777"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1778"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1779"></a>            <span class="n">ENDIF</span>
<a name="ln-1780"></a>
<a name="ln-1781"></a>            <span class="c">! Get the Fan Outlet Node</span>
<a name="ln-1782"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1783"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1784"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1785"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1786"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1787"></a>            <span class="n">ENDIF</span>
<a name="ln-1788"></a>
<a name="ln-1789"></a>            <span class="c">! Get the fan&#39;s availability schedule</span>
<a name="ln-1790"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1791"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span> <span class="o">=</span> <span class="n">GetFanAvailSchPtr</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1792"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1793"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1794"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1795"></a>            <span class="n">ENDIF</span>
<a name="ln-1796"></a>
<a name="ln-1797"></a>            <span class="c">! Check fan&#39;s schedule for cycling fan operation if constant volume fan is used</span>
<a name="ln-1798"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1799"></a><span class="k">              IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1800"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1801"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1802"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan operating mode must be continuous (fan operating mode schedule values &gt; 0).&#39;</span><span class="p">)</span>
<a name="ln-1803"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-1804"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...schedule values must be (&gt;0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-1805"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1806"></a>              <span class="k">END IF</span>
<a name="ln-1807"></a><span class="k">            ELSE IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">/=</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1808"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1809"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1810"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan type must be Fan:OnOff when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-1811"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Blank.&#39;</span><span class="p">)</span>
<a name="ln-1812"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1813"></a>            <span class="k">END IF</span>
<a name="ln-1814"></a>
<a name="ln-1815"></a><span class="k">          </span><span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-1816"></a>
<a name="ln-1817"></a>        <span class="k">ELSE</span>
<a name="ln-1818"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1819"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-1820"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1821"></a>        <span class="k">END IF</span> <span class="c">!  IF (TFurnace(FurnaceNum)%FanType_Num == FanType_SimpleOnOff .OR. &amp;, etc.</span>
<a name="ln-1822"></a>
<a name="ln-1823"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span> <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-1824"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-1825"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">)</span> <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-1826"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-1827"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1828"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1829"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)))</span>
<a name="ln-1830"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1831"></a>        <span class="k">END IF</span>
<a name="ln-1832"></a>
<a name="ln-1833"></a>            <span class="c">!Get coil data</span>
<a name="ln-1834"></a>        <span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1835"></a>        <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-1836"></a>        <span class="n">HeatingCoilPLFCurveIndex</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-1837"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">HeatingCoilType</span>
<a name="ln-1838"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">HeatingCoilName</span>
<a name="ln-1839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-1840"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1841"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1842"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1843"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1844"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1845"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1846"></a>            <span class="k">ELSE</span>
<a name="ln-1847"></a>
<a name="ln-1848"></a><span class="k">              CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1849"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1850"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1851"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1852"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1853"></a>
<a name="ln-1854"></a>              <span class="k">ELSE</span> <span class="c">! mine data from heating coil</span>
<a name="ln-1855"></a>
<a name="ln-1856"></a>                <span class="c">! Get heating coil index</span>
<a name="ln-1857"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1858"></a>                <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1859"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1860"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1861"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1862"></a>                <span class="n">ENDIF</span>
<a name="ln-1863"></a>
<a name="ln-1864"></a>                <span class="c">! Get the design heating capacity</span>
<a name="ln-1865"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1866"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-1867"></a>                   <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1868"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1869"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1870"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1871"></a>                <span class="n">ENDIF</span>
<a name="ln-1872"></a>
<a name="ln-1873"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-1874"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1875"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1876"></a>                       <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1877"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1878"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1879"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1880"></a>                <span class="n">ENDIF</span>
<a name="ln-1881"></a>
<a name="ln-1882"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-1883"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1884"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1885"></a>                       <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1886"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1887"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1888"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1889"></a>                <span class="n">ENDIF</span>
<a name="ln-1890"></a>
<a name="ln-1891"></a>                <span class="c">! Get the Heating Coil PLF Curve Index</span>
<a name="ln-1892"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1893"></a>                <span class="n">HeatingCoilPLFCurveIndex</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1894"></a>                       <span class="n">GetHeatingCoilPLFCurveIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1895"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1896"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1897"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1898"></a>                <span class="n">ENDIF</span>
<a name="ln-1899"></a>
<a name="ln-1900"></a>              <span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-1901"></a>
<a name="ln-1902"></a>            <span class="n">ENDIF</span>
<a name="ln-1903"></a>
<a name="ln-1904"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1905"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-1906"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1907"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1908"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1909"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1910"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1911"></a>
<a name="ln-1912"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-1913"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1914"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1915"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1916"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1917"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1918"></a>                <span class="k">END IF</span>
<a name="ln-1919"></a>
<a name="ln-1920"></a>                <span class="c">! Get the Heating Coil hot water max volume flow rate</span>
<a name="ln-1921"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1922"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1923"></a>                                                           <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1924"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1925"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1926"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1927"></a>                <span class="k">END IF</span>
<a name="ln-1928"></a>
<a name="ln-1929"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-1930"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1931"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1932"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-1933"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1934"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1935"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1936"></a>                <span class="k">END IF</span>
<a name="ln-1937"></a>
<a name="ln-1938"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-1939"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1940"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1941"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirOutletNode</span> <span class="o">=</span> <span class="n">HeatingCoilOutletNode</span>
<a name="ln-1942"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1943"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1944"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1945"></a>                <span class="k">END IF</span>
<a name="ln-1946"></a>
<a name="ln-1947"></a>                <span class="c">! check if user has also used a water coil controller, which they should not do</span>
<a name="ln-1948"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1949"></a>                <span class="k">CALL </span><span class="n">CheckCoilWaterInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1950"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! then did find a controller so that is bad</span>
<a name="ln-1951"></a>                  <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1952"></a>                                      <span class="o">//</span><span class="s1">&#39; has a conflicting Controller:WaterCoil object&#39;</span> <span class="p">)</span>
<a name="ln-1953"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Hot water coils are controlled directly by unitary and furnace systems.&#39;</span><span class="p">)</span>
<a name="ln-1954"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;No water coil controller should be input for the coil.&#39;</span><span class="p">)</span>
<a name="ln-1955"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1956"></a>                <span class="n">ENDIF</span>
<a name="ln-1957"></a>            <span class="n">ENDIF</span>
<a name="ln-1958"></a>
<a name="ln-1959"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-1960"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-1961"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-1962"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1963"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-1964"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1965"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-1966"></a>
<a name="ln-1967"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1968"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1969"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1970"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-1971"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">))</span>
<a name="ln-1972"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1973"></a>                    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1974"></a>                <span class="k">END IF</span>
<a name="ln-1975"></a>
<a name="ln-1976"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-1977"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1978"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1979"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1980"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1981"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-1982"></a>                <span class="k">END IF</span>
<a name="ln-1983"></a>
<a name="ln-1984"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-1985"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1986"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1987"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-1988"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetAirLoopHVACHeatCoolInput&#39;</span><span class="p">)</span>
<a name="ln-1989"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-1990"></a>                <span class="k">END IF</span>
<a name="ln-1991"></a>
<a name="ln-1992"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-1993"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-1994"></a>                <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-1995"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-1996"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span> <span class="o">=</span> <span class="n">HeatingCoilInletNode</span>
<a name="ln-1997"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-1998"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-1999"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2000"></a>                <span class="k">END IF</span>
<a name="ln-2001"></a>
<a name="ln-2002"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-2003"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2004"></a>                <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2005"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2006"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirOutletNode</span> <span class="o">=</span> <span class="n">HeatingCoilOutletNode</span>
<a name="ln-2007"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2008"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2009"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2010"></a>                <span class="k">END IF</span>
<a name="ln-2011"></a>
<a name="ln-2012"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-2013"></a>
<a name="ln-2014"></a>        <span class="k">ELSE</span>
<a name="ln-2015"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2016"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<a name="ln-2017"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2018"></a>        <span class="k">END IF</span> <span class="c">! IF (Furnace(FurnaceNum)%HeatingCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-2019"></a>
<a name="ln-2020"></a>
<a name="ln-2021"></a>        <span class="c">! Get Cooling Coil Information if available</span>
<a name="ln-2022"></a>        <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-2023"></a>        <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-2024"></a><span class="c">!       Find the type of coil. Do not print message since this may not be the correct coil type.</span>
<a name="ln-2025"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2026"></a>        <span class="n">PrintMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2027"></a>
<a name="ln-2028"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="s1">&#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2029"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span>
<a name="ln-2030"></a>        <span class="k">ELSE</span>
<a name="ln-2031"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2032"></a>                 <span class="n">GetDXCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-2033"></a>        <span class="k">END IF</span>
<a name="ln-2034"></a>
<a name="ln-2035"></a>
<a name="ln-2036"></a>        <span class="c">! If coil type not found, check to see if a HX assisted cooling coil is used.</span>
<a name="ln-2037"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2038"></a><span class="k">          </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2039"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2040"></a>                 <span class="n">GetHXAssistedCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-2041"></a>        <span class="k">END IF</span>
<a name="ln-2042"></a>
<a name="ln-2043"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2044"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2045"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2046"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2047"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2048"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2049"></a>
<a name="ln-2050"></a>          <span class="k">ELSE</span> <span class="c">! mine data from DX cooling coil</span>
<a name="ln-2051"></a>
<a name="ln-2052"></a>            <span class="c">! Get DX cooling coil index</span>
<a name="ln-2053"></a>            <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-2054"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2055"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2056"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2057"></a>            <span class="k">END IF</span>
<a name="ln-2058"></a>
<a name="ln-2059"></a>            <span class="c">! Get DX cooling coil capacity</span>
<a name="ln-2060"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2061"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-2062"></a>               <span class="n">GetDXCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2063"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2064"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2065"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2066"></a>            <span class="n">ENDIF</span>
<a name="ln-2067"></a>
<a name="ln-2068"></a>            <span class="c">! Get the Cooling Coil Nodes</span>
<a name="ln-2069"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2070"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2071"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2072"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2073"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2074"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2075"></a>            <span class="n">ENDIF</span>
<a name="ln-2076"></a>
<a name="ln-2077"></a>            <span class="c">! Get outdoor condenser node from DX coil object</span>
<a name="ln-2078"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2079"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2080"></a><span class="k">                </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2081"></a>            <span class="k">ELSE</span>
<a name="ln-2082"></a><span class="k">                </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2083"></a>                    <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2084"></a>            <span class="k">END IF</span>
<a name="ln-2085"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2086"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2087"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2088"></a>            <span class="n">ENDIF</span>
<a name="ln-2089"></a>
<a name="ln-2090"></a>          <span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-2091"></a>
<a name="ln-2092"></a>          <span class="c">! Push heating coil PLF curve index to DX coil</span>
<a name="ln-2093"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2094"></a><span class="k">            CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2095"></a>                                      <span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurveIndex</span><span class="p">)</span>
<a name="ln-2096"></a>          <span class="k">END IF</span>
<a name="ln-2097"></a>
<a name="ln-2098"></a><span class="k">        </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2099"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2100"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2101"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2102"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2103"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2104"></a>
<a name="ln-2105"></a>          <span class="k">ELSE</span> <span class="c">! mine data from heat exchanger assisted cooling coil</span>
<a name="ln-2106"></a>
<a name="ln-2107"></a>            <span class="c">! Get DX heat exchanger assisted cooling coil index</span>
<a name="ln-2108"></a>            <span class="k">CALL </span><span class="n">GetHXDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-2109"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2110"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2111"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2112"></a>            <span class="k">END IF</span>
<a name="ln-2113"></a>
<a name="ln-2114"></a>            <span class="c">! Get DX cooling coil capacity</span>
<a name="ln-2115"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-2116"></a>               <span class="n">GetDXHXAsstdCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2117"></a>            <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2118"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2119"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2120"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2121"></a>            <span class="n">ENDIF</span>
<a name="ln-2122"></a>
<a name="ln-2123"></a>            <span class="c">! Get the Cooling Coil Nodes</span>
<a name="ln-2124"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2125"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2126"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2127"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2128"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2129"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2130"></a>            <span class="n">ENDIF</span>
<a name="ln-2131"></a>
<a name="ln-2132"></a>            <span class="c">! Get outdoor condenser node from heat exchanger assisted DX coil object</span>
<a name="ln-2133"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2134"></a>           <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2135"></a><span class="k">                </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2136"></a>           <span class="k">ELSE</span>
<a name="ln-2137"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2138"></a>                <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="s1">&#39;COIL:COOLING:DX:SINGLESPEED&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2139"></a>                <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">),</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2140"></a>           <span class="k">END IF</span>
<a name="ln-2141"></a>
<a name="ln-2142"></a><span class="k">            IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2143"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2144"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2145"></a>            <span class="n">ENDIF</span>
<a name="ln-2146"></a>
<a name="ln-2147"></a>            <span class="c">! Push heating coil PLF curve index to DX coil</span>
<a name="ln-2148"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilPLFCurveIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2149"></a>              <span class="c">! get the actual index to the DX cooling coil object</span>
<a name="ln-2150"></a>              <span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="n">GetActualDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-2151"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualDXCoilIndexforHXAssisted</span> <span class="o">=</span> <span class="n">DXCoilIndex</span>
<a name="ln-2152"></a>              <span class="k">CALL </span><span class="n">SetDXCoolingCoilData</span><span class="p">(</span><span class="n">DXCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2153"></a>                                        <span class="n">HeatingCoilPLFCurvePTR</span><span class="o">=</span><span class="n">HeatingCoilPLFCurveIndex</span><span class="p">)</span>
<a name="ln-2154"></a>            <span class="k">END IF</span>
<a name="ln-2155"></a>
<a name="ln-2156"></a><span class="k">          </span><span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-2157"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-2158"></a>        <span class="c">! BOS ADDED, AUG/2012, VARIIABLE SPEED DX COOLING COIL</span>
<a name="ln-2159"></a>        <span class="c">!  Furnace(FurnaceNum)%DXCoolCoilType = &#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span>
<a name="ln-2160"></a>        <span class="c">!  Furnace(FurnaceNum)%DXCoolCoilName = CoolingCoilName</span>
<a name="ln-2161"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2162"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2163"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2164"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...specified in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2165"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2166"></a>          <span class="k">ELSE</span>
<a name="ln-2167"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2168"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2169"></a>                        <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2170"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2171"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...specified in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-2172"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2173"></a>            <span class="k">END IF</span>
<a name="ln-2174"></a><span class="k">            </span><span class="n">CoolingCoilInletNode</span> <span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2175"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2176"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2177"></a>
<a name="ln-2178"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2179"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2180"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2181"></a>            <span class="n">ENDIF</span>
<a name="ln-2182"></a>          <span class="n">ENDIF</span>
<a name="ln-2183"></a>        <span class="k">ELSE</span>
<a name="ln-2184"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2185"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-2186"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2187"></a>        <span class="k">END IF</span>
<a name="ln-2188"></a>
<a name="ln-2189"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;Multimode&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2190"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2191"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2192"></a>          <span class="k">If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;Multimode&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2193"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_Multimode</span>
<a name="ln-2194"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2195"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2196"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2197"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-2198"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Multimode control must be used with a Heat Exchanger Assisted Cooling Coil.&#39;</span><span class="p">)</span>
<a name="ln-2199"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2200"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dehumidification control type is assumed to be None since a reheat coil has not been &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2201"></a>                                     <span class="s1">&#39;specified and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2202"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2203"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-2204"></a>              <span class="k">ELSE</span>
<a name="ln-2205"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dehumidification control type is assumed to be CoolReheat and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2206"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_CoolReheat</span>
<a name="ln-2207"></a>              <span class="k">END IF</span>
<a name="ln-2208"></a><span class="k">            END IF</span>
<a name="ln-2209"></a><span class="k">          END IF</span>
<a name="ln-2210"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2211"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_CoolReheat</span>
<a name="ln-2212"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2213"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2214"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2215"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dehumidification control type is assumed to be None since a reheat coil has not been &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2216"></a>                                     <span class="s1">&#39;specified and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2217"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2218"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-2219"></a>            <span class="k">END IF</span>
<a name="ln-2220"></a><span class="k">          END IF</span>
<a name="ln-2221"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2222"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-2223"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2224"></a>          <span class="k">END IF</span>
<a name="ln-2225"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2226"></a><span class="k">            DO </span><span class="n">HstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHumidityControlZones</span>
<a name="ln-2227"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">HumidityControlZone</span><span class="p">(</span><span class="n">HstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-2228"></a><span class="k">              </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2229"></a>            <span class="k">END DO</span>
<a name="ln-2230"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2231"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2232"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (Zone with Humidistat).&#39;</span><span class="p">)</span>
<a name="ln-2233"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-2234"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2235"></a>            <span class="n">ENDIF</span>
<a name="ln-2236"></a>          <span class="k">END IF</span>
<a name="ln-2237"></a><span class="k">        ELSE</span> <span class="c">! invalid input</span>
<a name="ln-2238"></a>          <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2239"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-2240"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2241"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2242"></a>        <span class="k">END IF</span>
<a name="ln-2243"></a>
<a name="ln-2244"></a><span class="c">!       Check placement of cooling coil with respect to fan placement and dehumidification control type</span>
<a name="ln-2245"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2246"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">==</span> <span class="n">HeatingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2247"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">/=</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2248"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2249"></a>          <span class="k">END IF</span>
<a name="ln-2250"></a><span class="k">        ELSE</span>
<a name="ln-2251"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">==</span> <span class="n">CoolingCoilInletNode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2252"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">/=</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2253"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2254"></a>          <span class="k">END IF</span>
<a name="ln-2255"></a><span class="k">        END IF</span>
<a name="ln-2256"></a>
<a name="ln-2257"></a>
<a name="ln-2258"></a>        <span class="c">!Get reheat coil data if humidistat is used</span>
<a name="ln-2259"></a>        <span class="n">ReheatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a name="ln-2260"></a>        <span class="n">ReheatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a name="ln-2261"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">ReheatingCoilType</span>
<a name="ln-2262"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">ReheatingCoilName</span>
<a name="ln-2263"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2264"></a>        <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-2265"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2266"></a>              <span class="n">SameString</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2267"></a>              <span class="n">SameString</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Desuperheater&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2268"></a>
<a name="ln-2269"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2270"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2271"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2272"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2273"></a>            <span class="k">ELSE</span>
<a name="ln-2274"></a>
<a name="ln-2275"></a><span class="k">              CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">ReHeatingCoilType</span><span class="p">,</span><span class="n">ReHeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2276"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2277"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2278"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;In &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2279"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2280"></a>
<a name="ln-2281"></a>              <span class="k">ELSE</span> <span class="c">! mine data from reheat coil</span>
<a name="ln-2282"></a>
<a name="ln-2283"></a>                <span class="c">! Get the heating coil index</span>
<a name="ln-2284"></a>                <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-2285"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2286"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2287"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2288"></a>                <span class="n">ENDIF</span>
<a name="ln-2289"></a>
<a name="ln-2290"></a>                <span class="c">! Get the design supplemental heating capacity</span>
<a name="ln-2291"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2292"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2293"></a>                    <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">ReHeatingCoilType</span><span class="p">,</span><span class="n">ReHeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2294"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2295"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2296"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2297"></a>                <span class="n">ENDIF</span>
<a name="ln-2298"></a>
<a name="ln-2299"></a>                <span class="c">! Get the Reheat Coil Inlet Node</span>
<a name="ln-2300"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2301"></a>                <span class="n">ReheatCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2302"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2303"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2304"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2305"></a>                <span class="n">ENDIF</span>
<a name="ln-2306"></a>
<a name="ln-2307"></a>                <span class="c">! Get the Reheat Coil Outlet Node</span>
<a name="ln-2308"></a>                <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2309"></a>                <span class="n">ReheatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2310"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2311"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-2312"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2313"></a>                <span class="n">ENDIF</span>
<a name="ln-2314"></a>
<a name="ln-2315"></a>              <span class="n">ENDIF</span>  <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-2316"></a>            <span class="n">ENDIF</span>
<a name="ln-2317"></a>
<a name="ln-2318"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2319"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-2320"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2321"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2322"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2323"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2324"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-2325"></a>
<a name="ln-2326"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-2327"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2328"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2329"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2330"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2331"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2332"></a>                <span class="k">END IF</span>
<a name="ln-2333"></a>
<a name="ln-2334"></a>                <span class="c">! Get the ReHeat Coil hot water max volume flow rate</span>
<a name="ln-2335"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2336"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-2337"></a>                                                           <span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2338"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2339"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2340"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2341"></a>                <span class="k">END IF</span>
<a name="ln-2342"></a>
<a name="ln-2343"></a>                <span class="c">! Get the ReHeat Coil Inlet Node</span>
<a name="ln-2344"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2345"></a>                <span class="n">ReheatCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2346"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">ReheatCoilInletNode</span>
<a name="ln-2347"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2348"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2349"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2350"></a>                <span class="k">END IF</span>
<a name="ln-2351"></a>
<a name="ln-2352"></a>                <span class="c">! Get the ReHeat Coil Outlet Node</span>
<a name="ln-2353"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2354"></a>                <span class="n">ReheatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2355"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">ReheatCoilOutletNode</span>
<a name="ln-2356"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2357"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2358"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2359"></a>                <span class="k">END IF</span>
<a name="ln-2360"></a>
<a name="ln-2361"></a>                <span class="c">! check if user has also used a water coil controller, which they should not do</span>
<a name="ln-2362"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2363"></a>                <span class="k">CALL </span><span class="n">CheckCoilWaterInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2364"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! then did find a controller so that is bad</span>
<a name="ln-2365"></a>                  <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-2366"></a>                                      <span class="o">//</span><span class="s1">&#39; has a conflicting Controller:WaterCoil object&#39;</span> <span class="p">)</span>
<a name="ln-2367"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Hot water coils are controlled directly by unitary and furnace systems.&#39;</span><span class="p">)</span>
<a name="ln-2368"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;No water coil controller should be input for the coil.&#39;</span><span class="p">)</span>
<a name="ln-2369"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2370"></a>                <span class="n">ENDIF</span>
<a name="ln-2371"></a>
<a name="ln-2372"></a>            <span class="n">ENDIF</span>
<a name="ln-2373"></a>
<a name="ln-2374"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2375"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-2376"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">ReheatingCoilType</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2377"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2378"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2379"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2380"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-2381"></a>
<a name="ln-2382"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2383"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2384"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2385"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2386"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">ReheatingCoilName</span><span class="p">))</span>
<a name="ln-2387"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2388"></a>                    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2389"></a>                <span class="k">END IF</span>
<a name="ln-2390"></a>
<a name="ln-2391"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-2392"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2393"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2394"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2395"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2396"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2397"></a>                <span class="k">END IF</span>
<a name="ln-2398"></a>
<a name="ln-2399"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-2400"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2401"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2402"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-2403"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetAirLoopHVACHeatCoolInput&#39;</span><span class="p">)</span>
<a name="ln-2404"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2405"></a>                                     <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-2406"></a>                <span class="k">END IF</span>
<a name="ln-2407"></a>
<a name="ln-2408"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-2409"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2410"></a>                <span class="n">ReheatCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2411"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2412"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">ReheatCoilInletNode</span>
<a name="ln-2413"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2414"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2415"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2416"></a>                <span class="k">END IF</span>
<a name="ln-2417"></a>
<a name="ln-2418"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-2419"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2420"></a>                <span class="n">ReheatCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2421"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ReheatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2422"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">ReheatCoilOutletNode</span>
<a name="ln-2423"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2424"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-2425"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2426"></a>                <span class="k">END IF</span>
<a name="ln-2427"></a>
<a name="ln-2428"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-2429"></a>
<a name="ln-2430"></a>          <span class="k">ELSE</span>  <span class="c">! Illeagal heating coil</span>
<a name="ln-2431"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2432"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-2433"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2434"></a>          <span class="k">END IF</span> <span class="c">! IF (Furnace(FurnaceNum)%SuppHeatCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-2435"></a>
<a name="ln-2436"></a>        <span class="k">END IF</span> <span class="c">! IF(.NOT. lAlphaBlanks(15))THEN</span>
<a name="ln-2437"></a>
<a name="ln-2438"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2439"></a>
<a name="ln-2440"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2441"></a><span class="k">             CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2442"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2443"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2444"></a>                                      <span class="s1">&#39;the same as the furnace inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2445"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-2446"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2447"></a>                                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-2448"></a>             <span class="k">ELSE</span>
<a name="ln-2449"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2450"></a>                                      <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2451"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-2452"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2453"></a>                                                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-2454"></a>             <span class="k">END IF</span>
<a name="ln-2455"></a><span class="k">             </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2456"></a>          <span class="k">END IF</span>
<a name="ln-2457"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2458"></a><span class="k">            IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2459"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2460"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2461"></a>                                      <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2462"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-2463"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2464"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2465"></a>            <span class="k">END IF</span>
<a name="ln-2466"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2467"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2468"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2469"></a>                                      <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2470"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2471"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2472"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2473"></a>            <span class="k">END IF</span>
<a name="ln-2474"></a><span class="k">            IF</span><span class="p">((</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2475"></a>               <span class="n">ReHeatCoilInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2476"></a><span class="k">              IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">ReHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2477"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2478"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2479"></a>                                       <span class="s1">&#39;the same as the reheat coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2480"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2481"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil inlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-2482"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2483"></a>              <span class="k">END IF</span>
<a name="ln-2484"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ReHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2485"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2486"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2487"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2488"></a>                                         <span class="s1">&#39;the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2489"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2490"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name     = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2491"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2492"></a>                <span class="k">ELSE</span>
<a name="ln-2493"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2494"></a>                                         <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2495"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2496"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2497"></a>                                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2498"></a>                <span class="k">END IF</span>
<a name="ln-2499"></a><span class="k">                </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2500"></a>              <span class="k">END IF</span>
<a name="ln-2501"></a><span class="k">            ELSE</span> <span class="c">! IF((Furnace(FurnaceNum)%Humidistat ...</span>
<a name="ln-2502"></a>              <span class="c">! Heating coil outlet node name must be the same as the furnace outlet node name</span>
<a name="ln-2503"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2504"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2505"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2506"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2507"></a>                               <span class="s1">&#39;the heating coil outlet node name must be the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2508"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2509"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2510"></a>                                                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2511"></a>                <span class="k">ELSE</span>
<a name="ln-2512"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, &#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2513"></a>                               <span class="s1">&#39;the heating coil outlet node name must be the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2514"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2515"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2516"></a>                                                                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2517"></a>                <span class="k">END IF</span>
<a name="ln-2518"></a><span class="k">                </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2519"></a>              <span class="k">END IF</span>
<a name="ln-2520"></a><span class="k">            END IF</span>
<a name="ln-2521"></a><span class="k">          ELSE</span> <span class="c">! IF(Furnace(FurnaceNum)%CoolingCoilUpstream)THEN</span>
<a name="ln-2522"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2523"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2524"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2525"></a>                                      <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2526"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-2527"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2528"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2529"></a>            <span class="k">END IF</span>
<a name="ln-2530"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2531"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2532"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2533"></a>                                      <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2534"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2535"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2536"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2537"></a>            <span class="k">END IF</span>
<a name="ln-2538"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2539"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2540"></a>               <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2541"></a><span class="k">                 CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2542"></a>                                        <span class="s1">&#39;the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2543"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2544"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2545"></a>                                                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2546"></a>               <span class="k">ELSE</span>
<a name="ln-2547"></a><span class="k">                 CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2548"></a>                                        <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2549"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2550"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name  = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2551"></a>                                                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2552"></a>               <span class="k">END IF</span>
<a name="ln-2553"></a><span class="k">               </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2554"></a>            <span class="k">END IF</span>
<a name="ln-2555"></a><span class="k">          END IF</span>
<a name="ln-2556"></a>
<a name="ln-2557"></a><span class="k">        ELSE</span> <span class="c">! ELSE from IF(Furnace(FurnaceNum)%FanPlace .EQ. BlowThru)THEN</span>
<a name="ln-2558"></a>
<a name="ln-2559"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2560"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2561"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2562"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2563"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2564"></a>                                       <span class="s1">&#39;the same as the furnace inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2565"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2566"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace inlet node name      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2567"></a>                                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-2568"></a>              <span class="k">ELSE</span>
<a name="ln-2569"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2570"></a>                                       <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2571"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2572"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2573"></a>                                                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-2574"></a>              <span class="k">END IF</span>
<a name="ln-2575"></a><span class="k">              </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2576"></a>            <span class="k">END IF</span>
<a name="ln-2577"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2578"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2579"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2580"></a>                                     <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2581"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2582"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2583"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2584"></a>            <span class="k">END IF</span>
<a name="ln-2585"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2586"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2587"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2588"></a>                                     <span class="s1">&#39;the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2589"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2590"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-2591"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2592"></a>            <span class="k">END IF</span>
<a name="ln-2593"></a><span class="k">            IF</span><span class="p">((</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2594"></a>               <span class="n">ReHeatCoilInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2595"></a><span class="k">              IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">ReHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2596"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2597"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2598"></a>                                       <span class="s1">&#39;the same as the reheat coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2599"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name        = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-2600"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReheatCoilInletNode</span><span class="p">)))</span>
<a name="ln-2601"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2602"></a>              <span class="k">END IF</span>
<a name="ln-2603"></a><span class="k">              IF</span><span class="p">(</span><span class="n">ReHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2604"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2605"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2606"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2607"></a>                                         <span class="s1">&#39;the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2608"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2609"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name     = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2610"></a>                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2611"></a>                <span class="k">ELSE</span>
<a name="ln-2612"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The reheat coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2613"></a>                                         <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2614"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Reheat coil outlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2615"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2616"></a>                                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2617"></a>                <span class="k">END IF</span>
<a name="ln-2618"></a><span class="k">                </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2619"></a>              <span class="k">END IF</span>
<a name="ln-2620"></a><span class="k">            ELSE</span>
<a name="ln-2621"></a><span class="k">              IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2622"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2623"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2624"></a>                                       <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2625"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name        = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-2626"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system outlet node name = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2627"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2628"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2629"></a>              <span class="k">END IF</span>
<a name="ln-2630"></a><span class="k">            END IF</span>
<a name="ln-2631"></a><span class="k">          ELSE</span> <span class="c">! IF(Furnace(FurnaceNum)%CoolingCoilUpstream)THEN</span>
<a name="ln-2632"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2633"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2634"></a>               <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2635"></a><span class="k">                 CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2636"></a>                                        <span class="s1">&#39;the same as the furnace inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2637"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2638"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace inlet node name      = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2639"></a>                                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-2640"></a>               <span class="k">ELSE</span>
<a name="ln-2641"></a><span class="k">                 CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2642"></a>                                        <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2643"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2644"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem inlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2645"></a>                                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-2646"></a>               <span class="k">END IF</span>
<a name="ln-2647"></a><span class="k">               </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2648"></a>            <span class="k">END IF</span>
<a name="ln-2649"></a><span class="k">            IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2650"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2651"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2652"></a>                                      <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2653"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2654"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-2655"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2656"></a>            <span class="k">END IF</span>
<a name="ln-2657"></a><span class="k">            IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2658"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2659"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2660"></a>                                      <span class="s1">&#39;the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2661"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-2662"></a>               <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-2663"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2664"></a>            <span class="k">END IF</span>
<a name="ln-2665"></a><span class="k">            IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2666"></a><span class="k">               CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2667"></a>               <span class="k">IF</span><span class="p">(</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">Furnace_HeatCool</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2668"></a><span class="k">                 CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2669"></a>                                        <span class="s1">&#39;the same as the furnace outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2670"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-2671"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Furnace outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2672"></a>                                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2673"></a>               <span class="k">ELSE</span>
<a name="ln-2674"></a><span class="k">                 CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-2675"></a>                                        <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-2676"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-2677"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...UnitarySystem outlet node name = &#39;</span> <span class="p">&amp;</span>
<a name="ln-2678"></a>                                                         <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-2679"></a>               <span class="k">END IF</span>
<a name="ln-2680"></a><span class="k">               </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2681"></a>            <span class="k">END IF</span>
<a name="ln-2682"></a><span class="k">          END IF</span>
<a name="ln-2683"></a><span class="k">        END IF</span> <span class="c">! ELSE from IF(Furnace(FurnaceNum)%FanPlace .EQ. BlowThru)THEN</span>
<a name="ln-2684"></a>
<a name="ln-2685"></a>        <span class="c">! Add fan to component sets array</span>
<a name="ln-2686"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2687"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">))</span>
<a name="ln-2688"></a>
<a name="ln-2689"></a>        <span class="c">! Add DX cooling coil to component sets array</span>
<a name="ln-2690"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2691"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">))</span>
<a name="ln-2692"></a>
<a name="ln-2693"></a>        <span class="c">! Add heating coil to component sets array</span>
<a name="ln-2694"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2695"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">),</span> <span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">))</span>
<a name="ln-2696"></a>
<a name="ln-2697"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ReheatCoilInletNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2698"></a>
<a name="ln-2699"></a>          <span class="c">! Add reheating coil to component sets array</span>
<a name="ln-2700"></a>          <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2701"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReheatCoilInletNode</span><span class="p">),</span><span class="n">NodeID</span><span class="p">(</span><span class="n">ReheatCoilOutletNode</span><span class="p">))</span>
<a name="ln-2702"></a>
<a name="ln-2703"></a>        <span class="k">END IF</span>
<a name="ln-2704"></a>
<a name="ln-2705"></a>        <span class="c">!Set the furnace max outlet temperature</span>
<a name="ln-2706"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2707"></a>
<a name="ln-2708"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-2709"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2710"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2711"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-2712"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2713"></a>        <span class="k">END IF</span>
<a name="ln-2714"></a>
<a name="ln-2715"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>       <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-2716"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2717"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2718"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-2719"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2720"></a>        <span class="k">END IF</span>
<a name="ln-2721"></a>
<a name="ln-2722"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-2723"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2724"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2725"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-2726"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2727"></a>        <span class="k">END IF</span>
<a name="ln-2728"></a>
<a name="ln-2729"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2730"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-2731"></a>        <span class="k">ELSE</span>
<a name="ln-2732"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2733"></a>        <span class="k">END IF</span>
<a name="ln-2734"></a>
<a name="ln-2735"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2736"></a><span class="k">             </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2737"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="p">&amp;</span>
<a name="ln-2738"></a>                <span class="o">=</span> <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2739"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2740"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2741"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2742"></a>             <span class="n">ENDIF</span>
<a name="ln-2743"></a>
<a name="ln-2744"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2745"></a>                 <span class="nb">MIN</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-2746"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2747"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2748"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2749"></a>                 <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-2750"></a>            <span class="k">ELSE</span>
<a name="ln-2751"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-2752"></a>            <span class="k">END IF</span>
<a name="ln-2753"></a><span class="k">        END IF</span>
<a name="ln-2754"></a>
<a name="ln-2755"></a><span class="k">        IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2756"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2757"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2758"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2759"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... air flow rate = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2760"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2761"></a>              <span class="s1">&#39; in fan object &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the maximum HVAC system air flow rate in &#39;</span> <span class="p">&amp;</span>
<a name="ln-2762"></a>                              <span class="o">//</span><span class="s1">&#39;cooling mode.&#39;</span><span class="p">)</span>
<a name="ln-2763"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2764"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2765"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-2766"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-2767"></a>          <span class="k">END IF</span>
<a name="ln-2768"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2769"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2770"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2771"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... air flow rate = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-2772"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-2773"></a>              <span class="s1">&#39; in fan object &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the maximum HVAC system air flow rate in &#39;</span> <span class="p">&amp;</span>
<a name="ln-2774"></a>                              <span class="o">//</span><span class="s1">&#39;heating mode.&#39;</span><span class="p">)</span>
<a name="ln-2775"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-2776"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-2777"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-2778"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-2779"></a>          <span class="k">END IF</span>
<a name="ln-2780"></a><span class="k">        END IF</span>
<a name="ln-2781"></a>
<a name="ln-2782"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2783"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2784"></a><span class="c">!           set air flow control mode:</span>
<a name="ln-2785"></a><span class="c">!             UseCompressorOnFlow = operate at last cooling or heating air flow requested when compressor is off</span>
<a name="ln-2786"></a><span class="c">!             UseCompressorOffFlow = operate at value specified by user</span>
<a name="ln-2787"></a><span class="c">!           AirFlowControl only valid if fan opmode = ContFanCycComp</span>
<a name="ln-2788"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2789"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-2790"></a>            <span class="k">ELSE</span>
<a name="ln-2791"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOffFlow</span>
<a name="ln-2792"></a>            <span class="k">END IF</span>
<a name="ln-2793"></a><span class="k">          END IF</span>
<a name="ln-2794"></a><span class="k">        END IF</span>
<a name="ln-2795"></a>
<a name="ln-2796"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2797"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2798"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-2799"></a>             <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2800"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2801"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2802"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2803"></a>          <span class="n">ENDIF</span>
<a name="ln-2804"></a>        <span class="n">ENDIF</span>
<a name="ln-2805"></a>
<a name="ln-2806"></a>        <span class="c">!Set heating convergence tolerance</span>
<a name="ln-2807"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-2808"></a>
<a name="ln-2809"></a>        <span class="c">!Set cooling convergence tolerance</span>
<a name="ln-2810"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingConvergenceTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-2811"></a>
<a name="ln-2812"></a>      <span class="k">END DO</span>  <span class="c">!End of the HeatCool Furnace Loop</span>
<a name="ln-2813"></a>
<a name="ln-2814"></a>
<a name="ln-2815"></a>
<a name="ln-2816"></a>      <span class="c">! Get the data for the Unitary System HeatPump AirToAir (UnitarySystem:HeatPump:AirToAir)</span>
<a name="ln-2817"></a>      <span class="k">DO </span><span class="n">HeatPumpNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumHeatPump</span>
<a name="ln-2818"></a>
<a name="ln-2819"></a>        <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir&#39;</span>
<a name="ln-2820"></a>        <span class="n">FanInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2821"></a>        <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2822"></a>        <span class="n">CoolingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2823"></a>        <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2824"></a>        <span class="n">HeatingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2825"></a>        <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2826"></a>        <span class="n">SupHeatCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2827"></a>        <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2828"></a>
<a name="ln-2829"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumHeatCool</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatCool</span> <span class="o">+</span> <span class="n">HeatPumpNum</span>
<a name="ln-2830"></a>
<a name="ln-2831"></a>
<a name="ln-2832"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">HeatPumpNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2833"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2834"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-2835"></a>
<a name="ln-2836"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2837"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2838"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Furnace</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FurnaceNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-2839"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2840"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2841"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-2842"></a>        <span class="n">ENDIF</span>
<a name="ln-2843"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">UnitarySys_HeatPump_AirToAir</span>
<a name="ln-2844"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-2845"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-2846"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-2847"></a>        <span class="k">ELSE</span>
<a name="ln-2848"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-2849"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2850"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2851"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-2852"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2853"></a>          <span class="n">ENDIF</span>
<a name="ln-2854"></a>        <span class="n">ENDIF</span>
<a name="ln-2855"></a>
<a name="ln-2856"></a>
<a name="ln-2857"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2858"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2859"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2860"></a>
<a name="ln-2861"></a>
<a name="ln-2862"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-2863"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-2864"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-2865"></a>
<a name="ln-2866"></a>
<a name="ln-2867"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-2868"></a>
<a name="ln-2869"></a>
<a name="ln-2870"></a>        <span class="c">!Get the Controlling Zone or Location of the Furnace Thermostat</span>
<a name="ln-2871"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-2872"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2873"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2874"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2875"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2876"></a>        <span class="n">ENDIF</span>
<a name="ln-2877"></a>
<a name="ln-2878"></a>        <span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-2879"></a>
<a name="ln-2880"></a>        <span class="c">! Get the node number for the zone with the thermostat</span>
<a name="ln-2881"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span>  <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2882"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2883"></a>          <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2884"></a>          <span class="k">DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2885"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-2886"></a><span class="c">!             Find the controlled zone number for the specified thermostat location</span>
<a name="ln-2887"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-2888"></a><span class="c">!             Determine if furnace is on air loop served by the thermostat location specified</span>
<a name="ln-2889"></a>              <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-2890"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2891"></a><span class="k">                DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-2892"></a>                  <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-2893"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2894"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2895"></a>                       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-2896"></a>                             <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-2897"></a><span class="k">                    </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2898"></a>                    <span class="k">EXIT</span>
<a name="ln-2899"></a><span class="k">                  END DO</span>
<a name="ln-2900"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-2901"></a><span class="k">                END DO</span>
<a name="ln-2902"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTempControlledZones</span>
<a name="ln-2903"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-2904"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2905"></a>                <span class="k">END DO</span>
<a name="ln-2906"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-2907"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-2908"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2909"></a>                <span class="k">END DO</span>
<a name="ln-2910"></a><span class="k">              ELSE</span>
<a name="ln-2911"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2912"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find an AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-2913"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2914"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2915"></a>              <span class="k">END IF</span>
<a name="ln-2916"></a><span class="k">            EXIT</span>
<a name="ln-2917"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-2918"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2919"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2920"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find air node (zone with thermostat).&#39;</span><span class="p">)</span>
<a name="ln-2921"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2922"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Both a ZoneHVAC:EquipmentConnections object and a ZoneControl:Thermostat object&#39;</span> <span class="p">&amp;</span>
<a name="ln-2923"></a>                                <span class="o">//</span><span class="s1">&#39; must be specified for this zone.&#39;</span><span class="p">)</span>
<a name="ln-2924"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2925"></a>          <span class="n">ENDIF</span>
<a name="ln-2926"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2927"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2928"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find correct AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-2929"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-2930"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2931"></a>          <span class="n">ENDIF</span>
<a name="ln-2932"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2933"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-2934"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span> <span class="o">==</span> <span class="n">AirLoopNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2935"></a><span class="k">                </span><span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="n">TotalZonesOnAirLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-2936"></a>              <span class="k">END IF</span>
<a name="ln-2937"></a><span class="k">            END DO</span>
<a name="ln-2938"></a><span class="k">          END IF</span>
<a name="ln-2939"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-2940"></a>
<a name="ln-2941"></a>         <span class="c">!Get fan data</span>
<a name="ln-2942"></a>        <span class="n">FanType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-2943"></a>        <span class="n">FanName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-2944"></a>
<a name="ln-2945"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2946"></a>        <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-2947"></a>           <span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-2948"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2949"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2950"></a>        <span class="k">END IF</span>
<a name="ln-2951"></a>
<a name="ln-2952"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleOnOff</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-2953"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-2954"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-2955"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2956"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2957"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2958"></a>
<a name="ln-2959"></a>          <span class="k">ELSE</span> <span class="c">! mine data from fan object</span>
<a name="ln-2960"></a>
<a name="ln-2961"></a>            <span class="c">! Get the fan index</span>
<a name="ln-2962"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2963"></a>            <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2964"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2965"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2966"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2967"></a>            <span class="n">ENDIF</span>
<a name="ln-2968"></a>
<a name="ln-2969"></a>            <span class="c">! Get the fan inlet node number</span>
<a name="ln-2970"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2971"></a>            <span class="n">FanInletNode</span>  <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2972"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2973"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2974"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2975"></a>            <span class="n">ENDIF</span>
<a name="ln-2976"></a>
<a name="ln-2977"></a>            <span class="c">! Get the fan outlet node number</span>
<a name="ln-2978"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2979"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2980"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2981"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2982"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2983"></a>            <span class="n">ENDIF</span>
<a name="ln-2984"></a>
<a name="ln-2985"></a>            <span class="c">! Get the fan availability schedule</span>
<a name="ln-2986"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2987"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span> <span class="o">=</span> <span class="n">GetFanAvailSchPtr</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2988"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2989"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2990"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-2991"></a>            <span class="n">ENDIF</span>
<a name="ln-2992"></a>
<a name="ln-2993"></a>            <span class="c">! Get the Design Fan Volume Flow Rate</span>
<a name="ln-2994"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-2995"></a>            <span class="n">FanVolFlowRate</span> <span class="o">=</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-2996"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-2997"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-2998"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-2999"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3000"></a>            <span class="n">ENDIF</span>
<a name="ln-3001"></a>
<a name="ln-3002"></a>          <span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-3003"></a>
<a name="ln-3004"></a>        <span class="k">ELSE</span>
<a name="ln-3005"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3006"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3007"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3008"></a>        <span class="k">END IF</span>
<a name="ln-3009"></a>
<a name="ln-3010"></a>
<a name="ln-3011"></a>            <span class="c">!Get heating coil type and name data</span>
<a name="ln-3012"></a>        <span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3013"></a>        <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3014"></a>
<a name="ln-3015"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3016"></a>
<a name="ln-3017"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="s1">&#39;COIL:HEATING:DX:VARIABLESPEED&#39;</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3018"></a><span class="k">           </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span>
<a name="ln-3019"></a>        <span class="k">ELSE</span>
<a name="ln-3020"></a><span class="k">           </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">GetDXCoilTypeNum</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3021"></a>        <span class="k">END IF</span>
<a name="ln-3022"></a>
<a name="ln-3023"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3024"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3025"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3026"></a>        <span class="k">END IF</span>
<a name="ln-3027"></a>
<a name="ln-3028"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_HeatingEmpirical</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3029"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3030"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3031"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3032"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3033"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3034"></a>
<a name="ln-3035"></a>          <span class="k">ELSE</span> <span class="c">! mine data from DX heating coil</span>
<a name="ln-3036"></a>
<a name="ln-3037"></a>            <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-3038"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3039"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3040"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3041"></a>            <span class="k">END IF</span>
<a name="ln-3042"></a>
<a name="ln-3043"></a>            <span class="c">! Get the Heating Coil Node Names</span>
<a name="ln-3044"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3045"></a>            <span class="n">HeatingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3046"></a>            <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3047"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3048"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3049"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3050"></a>            <span class="n">ENDIF</span>
<a name="ln-3051"></a>
<a name="ln-3052"></a>            <span class="c">! Get the design heating capacity</span>
<a name="ln-3053"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3054"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">GetDXCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3055"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3056"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3057"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3058"></a>            <span class="n">ENDIF</span>
<a name="ln-3059"></a>
<a name="ln-3060"></a>          <span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-3061"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3062"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3063"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3064"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3065"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3066"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3067"></a>          <span class="k">ELSE</span>
<a name="ln-3068"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3069"></a>            <span class="n">HeatingCoilInletNode</span><span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3070"></a>            <span class="n">HeatingCoilOutletNode</span><span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3071"></a>          <span class="n">ENDIF</span>
<a name="ln-3072"></a>        <span class="k">ELSE</span>
<a name="ln-3073"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3074"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-3075"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3076"></a>        <span class="k">END IF</span>
<a name="ln-3077"></a>
<a name="ln-3078"></a>
<a name="ln-3079"></a>        <span class="c">! Get Cooling Coil Information if available</span>
<a name="ln-3080"></a>        <span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3081"></a>        <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3082"></a>
<a name="ln-3083"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="s1">&#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3084"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span>
<a name="ln-3085"></a>        <span class="k">END IF</span>
<a name="ln-3086"></a>
<a name="ln-3087"></a><span class="k">        CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3088"></a>                               <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3089"></a>
<a name="ln-3090"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3091"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3092"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3093"></a>
<a name="ln-3094"></a>        <span class="k">ELSE</span> <span class="c">! mine data from DX cooling coil</span>
<a name="ln-3095"></a>
<a name="ln-3096"></a>          <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3097"></a>          <span class="n">PrintMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3098"></a>
<a name="ln-3099"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3100"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3101"></a>                     <span class="n">GetDXCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-3102"></a>          <span class="k">END IF</span>
<a name="ln-3103"></a>
<a name="ln-3104"></a>          <span class="c">! If coil type not found, check to see if a HX assisted cooling coil is used.</span>
<a name="ln-3105"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3106"></a><span class="k">            </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3107"></a>            <span class="n">PrintMessage</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3108"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3109"></a>                 <span class="n">GetHXAssistedCoilTypeNum</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">PrintMessage</span><span class="p">)</span>
<a name="ln-3110"></a>          <span class="k">END IF</span>
<a name="ln-3111"></a>
<a name="ln-3112"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3113"></a>
<a name="ln-3114"></a>            <span class="c">! Get the cooling coil node numbers</span>
<a name="ln-3115"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3116"></a>            <span class="k">CALL </span><span class="n">GetDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3117"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3118"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3119"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3120"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3121"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3122"></a>            <span class="n">ENDIF</span>
<a name="ln-3123"></a>
<a name="ln-3124"></a>            <span class="c">! Get the DX cooling coil design capacity</span>
<a name="ln-3125"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3126"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">GetDXCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3127"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3128"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3129"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3130"></a>            <span class="n">ENDIF</span>
<a name="ln-3131"></a>
<a name="ln-3132"></a>          <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3133"></a>
<a name="ln-3134"></a>            <span class="c">! Get the cooling coil node numbers</span>
<a name="ln-3135"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3136"></a>            <span class="k">CALL </span><span class="n">GetHXDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3137"></a>            <span class="n">CoolingCoilInletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3138"></a>            <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3139"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3140"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3141"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3142"></a>            <span class="n">ENDIF</span>
<a name="ln-3143"></a>
<a name="ln-3144"></a>            <span class="c">! Get the heat exchanger assisted cooling coil design capacity</span>
<a name="ln-3145"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3146"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">GetDXHXAsstdCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3147"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3148"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3149"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3150"></a>            <span class="n">ENDIF</span>
<a name="ln-3151"></a>
<a name="ln-3152"></a>            <span class="c">! get the actual index to the DX cooling coil object</span>
<a name="ln-3153"></a>            <span class="n">DXCoilIndex</span> <span class="o">=</span> <span class="n">GetActualDXCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-3154"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualDXCoilIndexforHXAssisted</span> <span class="o">=</span> <span class="n">DXCoilIndex</span>
<a name="ln-3155"></a>
<a name="ln-3156"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3157"></a>            <span class="c">! BOS ADDED, AUG/2012, VARIIABLE SPEED DX COOLING COIL</span>
<a name="ln-3158"></a>            <span class="c">!  Furnace(FurnaceNum)%DXCoolCoilType = &#39;COIL:COOLING:DX:VARIABLESPEED&#39;</span>
<a name="ln-3159"></a>            <span class="c">!  Furnace(FurnaceNum)%DXCoolCoilName = CoolingCoilName</span>
<a name="ln-3160"></a>              <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3161"></a>                                     <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3162"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3163"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...specified in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3164"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3165"></a>              <span class="k">ELSE</span>
<a name="ln-3166"></a><span class="k">                </span><span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3167"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3168"></a>                            <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3169"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3170"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...specified in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;.&#39;</span><span class="p">)</span>
<a name="ln-3171"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3172"></a>                <span class="k">END IF</span>
<a name="ln-3173"></a><span class="k">                </span><span class="n">CoolingCoilInletNode</span> <span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3174"></a>                <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3175"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3176"></a>
<a name="ln-3177"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3178"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3179"></a>                  <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3180"></a>                <span class="n">ENDIF</span>
<a name="ln-3181"></a>              <span class="n">ENDIF</span>
<a name="ln-3182"></a>          <span class="k">ELSE</span>
<a name="ln-3183"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3184"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-3185"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3186"></a>          <span class="k">END IF</span>
<a name="ln-3187"></a>
<a name="ln-3188"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3189"></a>
<a name="ln-3190"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3191"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3192"></a>          <span class="c">!Furnace(FurnaceNum)%WatertoAirHPType = WatertoAir_VarSpeedEquationFit</span>
<a name="ln-3193"></a>          <span class="k">CALL </span><span class="n">SetVarSpeedCoilData</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3194"></a>                                <span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-3195"></a>        <span class="k">END IF</span>
<a name="ln-3196"></a>
<a name="ln-3197"></a>        <span class="c">! Get supplemental heating coil information</span>
<a name="ln-3198"></a>        <span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-3199"></a>        <span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-3200"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">SuppHeatCoilType</span>
<a name="ln-3201"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">SuppHeatCoilName</span>
<a name="ln-3202"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3203"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3204"></a>              <span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3205"></a>
<a name="ln-3206"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3207"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3208"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3209"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3210"></a>            <span class="k">ELSE</span>
<a name="ln-3211"></a><span class="k">              </span><span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3212"></a>              <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3213"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3214"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3215"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;In &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3216"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3217"></a>
<a name="ln-3218"></a>               <span class="k">ELSE</span> <span class="c">! mine data from the supplemental heating coil</span>
<a name="ln-3219"></a>
<a name="ln-3220"></a>                  <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-3221"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3222"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3223"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3224"></a>                  <span class="n">ENDIF</span>
<a name="ln-3225"></a>
<a name="ln-3226"></a>                  <span class="c">! Get the Supplemental Heating Coil Inlet Node Number</span>
<a name="ln-3227"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3228"></a>                  <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3229"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3230"></a><span class="k">                     CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3231"></a>                     <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3232"></a>                  <span class="n">ENDIF</span>
<a name="ln-3233"></a>
<a name="ln-3234"></a>                  <span class="c">! Get the Supplemental Heating Coil Outlet Node Number</span>
<a name="ln-3235"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3236"></a>                  <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3237"></a>
<a name="ln-3238"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3239"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3240"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3241"></a>                  <span class="n">ENDIF</span>
<a name="ln-3242"></a>
<a name="ln-3243"></a>                  <span class="c">! Get the supplemental heating coil design capacity</span>
<a name="ln-3244"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3245"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3246"></a>                     <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3247"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3248"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3249"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3250"></a>                  <span class="n">ENDIF</span>
<a name="ln-3251"></a>
<a name="ln-3252"></a>               <span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-3253"></a>            <span class="n">ENDIF</span>
<a name="ln-3254"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3255"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-3256"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3257"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3258"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3259"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3260"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-3261"></a>
<a name="ln-3262"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-3263"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3264"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3265"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3266"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3267"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3268"></a>                <span class="k">END IF</span>
<a name="ln-3269"></a>
<a name="ln-3270"></a>                <span class="c">! Get the ReHeat Coil hot water max volume flow rate</span>
<a name="ln-3271"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3272"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3273"></a>                                                           <span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3274"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3275"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3276"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3277"></a>                <span class="k">END IF</span>
<a name="ln-3278"></a>
<a name="ln-3279"></a>                <span class="c">! Get the ReHeat Coil Inlet Node</span>
<a name="ln-3280"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3281"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3282"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-3283"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3284"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3285"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3286"></a>                <span class="k">END IF</span>
<a name="ln-3287"></a>
<a name="ln-3288"></a>                <span class="c">! Get the ReHeat Coil Outlet Node</span>
<a name="ln-3289"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3290"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3291"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-3292"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3293"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3294"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3295"></a>                <span class="k">END IF</span>
<a name="ln-3296"></a>
<a name="ln-3297"></a>                <span class="c">! check if user has also used a water coil controller, which they should not do</span>
<a name="ln-3298"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3299"></a>                <span class="k">CALL </span><span class="n">CheckCoilWaterInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3300"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! then did find a controller so that is bad</span>
<a name="ln-3301"></a>                  <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-3302"></a>                                      <span class="o">//</span><span class="s1">&#39; has a conflicting Controller:WaterCoil object&#39;</span> <span class="p">)</span>
<a name="ln-3303"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Hot water coils are controlled directly by unitary and furnace systems.&#39;</span><span class="p">)</span>
<a name="ln-3304"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;No water coil controller should be input for the coil.&#39;</span><span class="p">)</span>
<a name="ln-3305"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3306"></a>                <span class="n">ENDIF</span>
<a name="ln-3307"></a>
<a name="ln-3308"></a>            <span class="n">ENDIF</span>
<a name="ln-3309"></a>
<a name="ln-3310"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3311"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-3312"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3313"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3314"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3315"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3316"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-3317"></a>
<a name="ln-3318"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3319"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="s1">&#39;COIL:HEATING:STEAM&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3320"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3321"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3322"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SuppHeatCoilName</span><span class="p">))</span>
<a name="ln-3323"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3324"></a>                    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3325"></a>                <span class="k">END IF</span>
<a name="ln-3326"></a>
<a name="ln-3327"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-3328"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3329"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3330"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3331"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3332"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3333"></a>                <span class="k">END IF</span>
<a name="ln-3334"></a>
<a name="ln-3335"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-3336"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3337"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3338"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-3339"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetAirLoopHVACHeatCoolInput&#39;</span><span class="p">)</span>
<a name="ln-3340"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3341"></a>                                     <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-3342"></a>                <span class="k">END IF</span>
<a name="ln-3343"></a>
<a name="ln-3344"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-3345"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3346"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3347"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3348"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-3349"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3350"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3351"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3352"></a>                <span class="k">END IF</span>
<a name="ln-3353"></a>
<a name="ln-3354"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-3355"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3356"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3357"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3358"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-3359"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3360"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3361"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3362"></a>                <span class="k">END IF</span>
<a name="ln-3363"></a>
<a name="ln-3364"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-3365"></a>
<a name="ln-3366"></a>        <span class="k">ELSE</span>
<a name="ln-3367"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3368"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-3369"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3370"></a>        <span class="k">END IF</span> <span class="c">! IF (Furnace(FurnaceNum)%HeatingCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-3371"></a>
<a name="ln-3372"></a>
<a name="ln-3373"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">)</span>  <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-3374"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-3375"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">)</span>  <span class="p">)</span>      <span class="p">&amp;</span>
<a name="ln-3376"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-3377"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3378"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3379"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-3380"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3381"></a>        <span class="k">END IF</span>
<a name="ln-3382"></a>
<a name="ln-3383"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span>     <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<a name="ln-3384"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3385"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3386"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-3387"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3388"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3389"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-3390"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">/=</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3391"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-3392"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3393"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan type must be Fan:OnOff when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3394"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Blank.&#39;</span><span class="p">)</span>
<a name="ln-3395"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3396"></a>          <span class="k">END IF</span>
<a name="ln-3397"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3398"></a>
<a name="ln-3399"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleConstVolume</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3400"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3401"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3402"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3403"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3404"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan operating mode must be continuous (fan operating mode schedule values &gt; 0).&#39;</span><span class="p">)</span>
<a name="ln-3405"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Error found in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-3406"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...schedule values must be (&gt;0., &lt;=1.)&#39;</span><span class="p">)</span>
<a name="ln-3407"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3408"></a>            <span class="k">END IF</span>
<a name="ln-3409"></a><span class="k">          END IF</span>
<a name="ln-3410"></a><span class="k">        END IF</span>
<a name="ln-3411"></a>
<a name="ln-3412"></a>        <span class="c">! Dehumidification Control Type</span>
<a name="ln-3413"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;Multimode&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3414"></a>            <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3415"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3416"></a>          <span class="k">If</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;Multimode&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3417"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_Multimode</span>
<a name="ln-3418"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3419"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">/=</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3420"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3421"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">)))</span>
<a name="ln-3422"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Multimode control must be used with a Heat Exchanger Assisted Cooling Coil.&#39;</span><span class="p">)</span>
<a name="ln-3423"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3424"></a>            <span class="k">END IF</span>
<a name="ln-3425"></a><span class="k">          END IF</span>
<a name="ln-3426"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3427"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_CoolReheat</span>
<a name="ln-3428"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3429"></a>          <span class="k">END IF</span>
<a name="ln-3430"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-3431"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-3432"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3433"></a>          <span class="k">END IF</span>
<a name="ln-3434"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3435"></a><span class="k">            DO </span><span class="n">HstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHumidityControlZones</span>
<a name="ln-3436"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">HumidityControlZone</span><span class="p">(</span><span class="n">HstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-3437"></a><span class="k">              </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3438"></a>            <span class="k">END DO</span>
<a name="ln-3439"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3440"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3441"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (Zone with Humidistat).&#39;</span><span class="p">)</span>
<a name="ln-3442"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3443"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3444"></a>            <span class="n">ENDIF</span>
<a name="ln-3445"></a>          <span class="k">END IF</span>
<a name="ln-3446"></a><span class="k">        ELSE</span> <span class="c">! invalid input or blank</span>
<a name="ln-3447"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3448"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3449"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">)))</span>
<a name="ln-3450"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3451"></a>          <span class="k">ELSE</span>
<a name="ln-3452"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3453"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-3454"></a>          <span class="n">ENDIF</span>
<a name="ln-3455"></a>        <span class="k">END IF</span>
<a name="ln-3456"></a>
<a name="ln-3457"></a>        <span class="c">! Check node names for child components</span>
<a name="ln-3458"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3459"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3460"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3461"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3462"></a>                                     <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3463"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name            = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-3464"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-3465"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3466"></a>          <span class="k">END IF</span>
<a name="ln-3467"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3468"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3469"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3470"></a>                                     <span class="s1">&#39;the same as the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3471"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-3472"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-3473"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3474"></a>          <span class="k">END IF</span>
<a name="ln-3475"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3476"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3477"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3478"></a>                                     <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3479"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-3480"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-3481"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3482"></a>          <span class="k">END IF</span>
<a name="ln-3483"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">SupHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3484"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3485"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a blow through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3486"></a>                                     <span class="s1">&#39;the same as the supplemental heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3487"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name              = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-3488"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Supplemental heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-3489"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3490"></a>          <span class="k">END IF</span>
<a name="ln-3491"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3492"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3493"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The supplemental heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3494"></a>                                     <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3495"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Supplemental heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-3496"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system outlet node name            = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3497"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-3498"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3499"></a>          <span class="k">END IF</span>
<a name="ln-3500"></a><span class="k">        ELSE</span>
<a name="ln-3501"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3502"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3503"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the cooling coil inlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3504"></a>                                     <span class="s1">&#39;the same as the unitary system inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3505"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil inlet node name   = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-3506"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system inlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-3507"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3508"></a>          <span class="k">END IF</span>
<a name="ln-3509"></a><span class="k">          IF</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3510"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3511"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The cooling coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3512"></a>                                     <span class="s1">&#39;the same as the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3513"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Cooling coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-3514"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-3515"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3516"></a>          <span class="k">END IF</span>
<a name="ln-3517"></a><span class="k">          IF</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3518"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3519"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3520"></a>                                     <span class="s1">&#39;the same as the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3521"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-3522"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan inlet node name           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-3523"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3524"></a>          <span class="k">END IF</span>
<a name="ln-3525"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">SupHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3526"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3527"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;When a draw through fan is specified, the fan outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3528"></a>                                     <span class="s1">&#39;the same as the supplemental heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3529"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan outlet node name                       = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-3530"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Supplemental heating coil inlet node name  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-3531"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3532"></a>          <span class="k">END IF</span>
<a name="ln-3533"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3534"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-3535"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;The supplemental heating coil outlet node name must be &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-3536"></a>                                     <span class="s1">&#39;the same as the unitary system outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-3537"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Supplemental heating coil outlet node name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-3538"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system outlet node name            = &#39;</span> <span class="p">&amp;</span>
<a name="ln-3539"></a>                                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-3540"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3541"></a>          <span class="k">END IF</span>
<a name="ln-3542"></a><span class="k">        END IF</span>
<a name="ln-3543"></a>
<a name="ln-3544"></a>        <span class="c">! Add component sets array</span>
<a name="ln-3545"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3546"></a><span class="k">          </span><span class="n">CompSetFanInlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3547"></a>          <span class="n">CompSetCoolInlet</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-3548"></a>        <span class="k">ELSE</span>
<a name="ln-3549"></a><span class="k">          </span><span class="n">CompSetFanInlet</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-3550"></a>          <span class="n">CompSetCoolInlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3551"></a>        <span class="n">ENDIF</span>
<a name="ln-3552"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3553"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">CompSetFanInlet</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-3554"></a>
<a name="ln-3555"></a>
<a name="ln-3556"></a>        <span class="c">! Add DX cooling coil to component sets array</span>
<a name="ln-3557"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3558"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">CompSetCoolInlet</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-3559"></a>
<a name="ln-3560"></a>
<a name="ln-3561"></a>        <span class="c">! Add DX heating coil to component sets array</span>
<a name="ln-3562"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3563"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-3564"></a>
<a name="ln-3565"></a>
<a name="ln-3566"></a>        <span class="c">! Add supplemental heating coil to component sets array</span>
<a name="ln-3567"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3568"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-3569"></a>
<a name="ln-3570"></a>
<a name="ln-3571"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3572"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3573"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3574"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3575"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3576"></a>        <span class="k">END IF</span>
<a name="ln-3577"></a>
<a name="ln-3578"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>       <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-3579"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3580"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3581"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3582"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3583"></a>        <span class="k">END IF</span>
<a name="ln-3584"></a>
<a name="ln-3585"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-3586"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3587"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3588"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">7</span><span class="p">)))</span>
<a name="ln-3589"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3590"></a>        <span class="k">END IF</span>
<a name="ln-3591"></a>
<a name="ln-3592"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3593"></a><span class="k">          IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CheckScheduleValueMinMax</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">,</span><span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">!Objexx Range is 0 to 0?</span>
<a name="ln-3594"></a><span class="c">!           set air flow control mode:</span>
<a name="ln-3595"></a><span class="c">!             UseCompressorOnFlow = operate at last cooling or heating air flow requested when compressor is off</span>
<a name="ln-3596"></a><span class="c">!             UseCompressorOffFlow = operate at value specified by user</span>
<a name="ln-3597"></a><span class="c">!           AirFlowControl only valid if fan opmode = ContFanCycComp</span>
<a name="ln-3598"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3599"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-3600"></a>            <span class="k">ELSE</span>
<a name="ln-3601"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="o">=</span> <span class="n">UseCompressorOffFlow</span>
<a name="ln-3602"></a>            <span class="k">END IF</span>
<a name="ln-3603"></a><span class="k">          END IF</span>
<a name="ln-3604"></a><span class="k">        END IF</span>
<a name="ln-3605"></a>
<a name="ln-3606"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3607"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-3608"></a>        <span class="k">ELSE</span>
<a name="ln-3609"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3610"></a>        <span class="k">END IF</span>
<a name="ln-3611"></a>
<a name="ln-3612"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3613"></a><span class="k">             </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3614"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>       <span class="p">&amp;</span>
<a name="ln-3615"></a>                <span class="o">=</span> <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3616"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="p">&amp;</span>
<a name="ln-3617"></a>                <span class="o">=</span> <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3618"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3619"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3620"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3621"></a>             <span class="n">ENDIF</span>
<a name="ln-3622"></a>
<a name="ln-3623"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3624"></a>                 <span class="nb">MIN</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-3625"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3626"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3627"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3628"></a>                 <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-3629"></a>            <span class="k">ELSE</span>
<a name="ln-3630"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-3631"></a>            <span class="k">END IF</span>
<a name="ln-3632"></a><span class="k">        END IF</span>
<a name="ln-3633"></a>
<a name="ln-3634"></a><span class="k">        IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3635"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3636"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3637"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3638"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... air flow rate = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3639"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3640"></a>              <span class="s1">&#39; in fan object &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the maximum HVAC system air flow rate in &#39;</span> <span class="p">&amp;</span>
<a name="ln-3641"></a>                              <span class="o">//</span><span class="s1">&#39;cooling mode.&#39;</span><span class="p">)</span>
<a name="ln-3642"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-3643"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3644"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-3645"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-3646"></a>          <span class="k">END IF</span>
<a name="ln-3647"></a><span class="k">          IF</span><span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3648"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3649"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3650"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... air flow rate = &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-3651"></a>               <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-3652"></a>              <span class="s1">&#39; in fan object &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; is less than the maximum HVAC system air flow rate in &#39;</span> <span class="p">&amp;</span>
<a name="ln-3653"></a>                              <span class="o">//</span><span class="s1">&#39;heating mode.&#39;</span><span class="p">)</span>
<a name="ln-3654"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cNumericFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-3655"></a>                                 <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-3656"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-3657"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-3658"></a>          <span class="k">END IF</span>
<a name="ln-3659"></a><span class="k">        END IF</span>
<a name="ln-3660"></a>
<a name="ln-3661"></a>        <span class="c">!Set heating convergence tolerance</span>
<a name="ln-3662"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-3663"></a>
<a name="ln-3664"></a>
<a name="ln-3665"></a>        <span class="c">!Set minimum OAT for heat pump compressor operation</span>
<a name="ln-3666"></a>        <span class="c">! get from coil module</span>
<a name="ln-3667"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3668"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3669"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span> <span class="n">GetVSCoilMinOATCompressor</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3670"></a>        <span class="k">ELSE</span>
<a name="ln-3671"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-3672"></a>               <span class="n">GetMinOATDXCoilCompressor</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3673"></a>        <span class="k">END IF</span>
<a name="ln-3674"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3675"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3676"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3677"></a>        <span class="n">ENDIF</span>
<a name="ln-3678"></a>
<a name="ln-3679"></a>
<a name="ln-3680"></a><span class="c">!       Mine heatpump outdoor condenser node from DX coil object</span>
<a name="ln-3681"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3682"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3683"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3684"></a>            <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3685"></a>        <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3686"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="n">GetVSCoilCondenserInletNode</span><span class="p">(</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3687"></a>        <span class="k">ELSE</span>
<a name="ln-3688"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3689"></a>            <span class="n">GetDXCoilCondenserInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Cooling:DX:SingleSpeed&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3690"></a>            <span class="n">GetHXDXCoilName</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3691"></a>            <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3692"></a>        <span class="k">END IF</span>
<a name="ln-3693"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3694"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3695"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3696"></a>        <span class="n">ENDIF</span>
<a name="ln-3697"></a>
<a name="ln-3698"></a>
<a name="ln-3699"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3700"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3701"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3702"></a>             <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3703"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3704"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3705"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3706"></a>          <span class="n">ENDIF</span>
<a name="ln-3707"></a>        <span class="n">ENDIF</span>
<a name="ln-3708"></a>
<a name="ln-3709"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3710"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3711"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-3712"></a>             <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3713"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3714"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3715"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3716"></a>          <span class="n">ENDIF</span>
<a name="ln-3717"></a>        <span class="n">ENDIF</span>
<a name="ln-3718"></a>
<a name="ln-3719"></a>        <span class="c">!Set cooling convergence tolerance</span>
<a name="ln-3720"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingConvergenceTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-3721"></a>
<a name="ln-3722"></a>        <span class="c">!Set the furnace max outlet temperature</span>
<a name="ln-3723"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-3724"></a>
<a name="ln-3725"></a>
<a name="ln-3726"></a>        <span class="c">!Set maximum supply air temperature for supplemental heating coil</span>
<a name="ln-3727"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-3728"></a>
<a name="ln-3729"></a>      <span class="k">END DO</span>  <span class="c">!End of the Unitary System HeatPump Loop</span>
<a name="ln-3730"></a>
<a name="ln-3731"></a>
<a name="ln-3732"></a>            <span class="c">!Get the Input for the Water to Air Heat Pump (UnitarySystem:HeatPump:WaterToAir)</span>
<a name="ln-3733"></a>      <span class="k">DO </span><span class="n">HeatPumpNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumWatertoAirHeatPump</span>
<a name="ln-3734"></a>
<a name="ln-3735"></a>        <span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:WaterToAir&#39;</span>
<a name="ln-3736"></a>        <span class="n">FanInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3737"></a>        <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3738"></a>        <span class="n">CoolingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3739"></a>        <span class="n">CoolingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3740"></a>        <span class="n">HeatingCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3741"></a>        <span class="n">HeatingCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3742"></a>        <span class="n">SupHeatCoilInletNode</span>  <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3743"></a>        <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3744"></a>
<a name="ln-3745"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumHeatCool</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatCool</span> <span class="o">+</span> <span class="n">NumHeatPump</span> <span class="o">+</span> <span class="n">HeatPumpNum</span>
<a name="ln-3746"></a>
<a name="ln-3747"></a>        <span class="k">CALL </span><span class="n">GetObjectItem</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">HeatPumpNum</span><span class="p">,</span><span class="n">Alphas</span><span class="p">,</span><span class="n">NumAlphas</span><span class="p">,</span><span class="n">Numbers</span><span class="p">,</span><span class="n">NumNumbers</span><span class="p">,</span><span class="n">IOStatus</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3748"></a>                           <span class="n">NumBlank</span><span class="o">=</span><span class="n">lNumericBlanks</span><span class="p">,</span><span class="n">AlphaBlank</span><span class="o">=</span><span class="n">lAlphaBlanks</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3749"></a>                           <span class="n">AlphaFieldNames</span><span class="o">=</span><span class="n">cAlphaFields</span><span class="p">,</span><span class="n">NumericFieldNames</span><span class="o">=</span><span class="n">cNumericFields</span><span class="p">)</span>
<a name="ln-3750"></a>
<a name="ln-3751"></a>        <span class="n">IsNotOK</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3752"></a>        <span class="n">IsBlank</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3753"></a>        <span class="k">CALL </span><span class="n">VerifyName</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Furnace</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">FurnaceNum</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="n">IsBlank</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; Name&#39;</span><span class="p">)</span>
<a name="ln-3754"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3755"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3756"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsBlank</span><span class="p">)</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">&#39;xxxxx&#39;</span>
<a name="ln-3757"></a>        <span class="n">ENDIF</span>
<a name="ln-3758"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">=</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span>
<a name="ln-3759"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span>            <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-3760"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-3761"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">ScheduleAlwaysOn</span>
<a name="ln-3762"></a>        <span class="k">ELSE</span>
<a name="ln-3763"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span>        <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-3764"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3765"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3766"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-3767"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3768"></a>          <span class="n">ENDIF</span>
<a name="ln-3769"></a>        <span class="n">ENDIF</span>
<a name="ln-3770"></a>
<a name="ln-3771"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3772"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3773"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Inlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-3774"></a>
<a name="ln-3775"></a>
<a name="ln-3776"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-3777"></a>               <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-3778"></a>                            <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_Outlet</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsParent</span><span class="p">)</span>
<a name="ln-3779"></a>
<a name="ln-3780"></a>
<a name="ln-3781"></a>        <span class="k">CALL </span><span class="n">TestCompSet</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="s1">&#39;Air Nodes&#39;</span><span class="p">)</span>
<a name="ln-3782"></a>
<a name="ln-3783"></a>
<a name="ln-3784"></a>        <span class="c">!Get the Controlling Zone or Location of the Furnace Thermostat</span>
<a name="ln-3785"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">=</span> <span class="n">FindItemInList</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">Zone</span><span class="p">%</span><span class="n">Name</span><span class="p">,</span><span class="n">NumOfZones</span><span class="p">)</span>
<a name="ln-3786"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3787"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3788"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3789"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3790"></a>        <span class="n">ENDIF</span>
<a name="ln-3791"></a>
<a name="ln-3792"></a>        <span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-3793"></a>
<a name="ln-3794"></a>        <span class="c">! Get the node number for the zone with the thermostat</span>
<a name="ln-3795"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="o">&gt;</span>  <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3796"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3797"></a>          <span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3798"></a>          <span class="k">DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-3799"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-3800"></a><span class="c">!             Find the controlled zone number for the specified thermostat location</span>
<a name="ln-3801"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="o">=</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">ZoneNode</span>
<a name="ln-3802"></a><span class="c">!             Determine if furnace is on air loop served by the thermostat location specified</span>
<a name="ln-3803"></a>              <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-3804"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3805"></a><span class="k">                DO </span><span class="n">BranchNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumBranches</span>
<a name="ln-3806"></a>                  <span class="k">DO </span><span class="n">CompNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">TotalComponents</span>
<a name="ln-3807"></a>                    <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3808"></a>                             <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-3809"></a>                       <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">Branch</span><span class="p">(</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">TypeOf</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3810"></a>                             <span class="n">CurrentModuleObject</span><span class="p">))</span><span class="k">CYCLE</span>
<a name="ln-3811"></a><span class="k">                    </span><span class="n">AirLoopFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3812"></a>                    <span class="k">EXIT</span>
<a name="ln-3813"></a><span class="k">                  END DO</span>
<a name="ln-3814"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">AirLoopFound</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-3815"></a><span class="k">                END DO</span>
<a name="ln-3816"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumTempControlledZones</span>
<a name="ln-3817"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">TempControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-3818"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3819"></a>                <span class="k">END DO</span>
<a name="ln-3820"></a><span class="k">                DO </span><span class="n">TstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumComfortControlledZones</span>
<a name="ln-3821"></a>                  <span class="k">IF</span><span class="p">(</span><span class="n">ComfortControlledZone</span><span class="p">(</span><span class="n">TstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-3822"></a><span class="k">                  </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3823"></a>                <span class="k">END DO</span>
<a name="ln-3824"></a><span class="k">              ELSE</span>
<a name="ln-3825"></a><span class="k">                CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3826"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find an AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-3827"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3828"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3829"></a>              <span class="k">END IF</span>
<a name="ln-3830"></a><span class="k">            EXIT</span>
<a name="ln-3831"></a><span class="k">          </span><span class="n">ENDDO</span>
<a name="ln-3832"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3833"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3834"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find air node (zone with thermostat).&#39;</span><span class="p">)</span>
<a name="ln-3835"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3836"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Both a ZoneHVAC:EquipmentConnections object and a ZoneControl:Thermostat object&#39;</span> <span class="p">&amp;</span>
<a name="ln-3837"></a>                                <span class="o">//</span><span class="s1">&#39; must be specified for this zone.&#39;</span><span class="p">)</span>
<a name="ln-3838"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3839"></a>          <span class="n">ENDIF</span>
<a name="ln-3840"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirLoopFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3841"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3842"></a>            <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;Did not find correct AirLoopHVAC.&#39;</span><span class="p">)</span>
<a name="ln-3843"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-3844"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3845"></a>          <span class="n">ENDIF</span>
<a name="ln-3846"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3847"></a><span class="k">            DO </span><span class="n">ControlledZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-3848"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">ControlledZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span> <span class="o">==</span> <span class="n">AirLoopNumber</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3849"></a><span class="k">                </span><span class="n">TotalZonesOnAirLoop</span> <span class="o">=</span> <span class="n">TotalZonesOnAirLoop</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-3850"></a>              <span class="k">END IF</span>
<a name="ln-3851"></a><span class="k">            END DO</span>
<a name="ln-3852"></a><span class="k">          END IF</span>
<a name="ln-3853"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-3854"></a>
<a name="ln-3855"></a>
<a name="ln-3856"></a>         <span class="c">!Get fan data</span>
<a name="ln-3857"></a>        <span class="n">FanType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-3858"></a>        <span class="n">FanName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-3859"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3860"></a>        <span class="k">CALL </span><span class="n">GetFanType</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-3861"></a>           <span class="n">CurrentModuleObject</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-3862"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3863"></a><span class="k">          </span><span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3864"></a>        <span class="k">END IF</span>
<a name="ln-3865"></a>
<a name="ln-3866"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-3867"></a><span class="k">          CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3868"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3869"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3870"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3871"></a>          <span class="k">ELSE</span>
<a name="ln-3872"></a><span class="k">            </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3873"></a>            <span class="k">CALL </span><span class="n">GetFanIndex</span><span class="p">(</span><span class="n">FanName</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3874"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3875"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3876"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3877"></a>            <span class="n">ENDIF</span>
<a name="ln-3878"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3879"></a>            <span class="n">FanInletNode</span>  <span class="o">=</span> <span class="n">GetFanInletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3880"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3881"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3882"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3883"></a>            <span class="n">ENDIF</span>
<a name="ln-3884"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3885"></a>            <span class="n">FanOutletNode</span> <span class="o">=</span> <span class="n">GetFanOutletNode</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3886"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3887"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3888"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3889"></a>            <span class="n">ENDIF</span>
<a name="ln-3890"></a>            <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-3891"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span> <span class="o">=</span> <span class="n">GetFanAvailSchPtr</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3892"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3893"></a><span class="k">              CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3894"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3895"></a>            <span class="n">ENDIF</span>
<a name="ln-3896"></a>          <span class="n">ENDIF</span>
<a name="ln-3897"></a>        <span class="k">ELSE</span>
<a name="ln-3898"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3899"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-3900"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3901"></a>        <span class="k">END IF</span>
<a name="ln-3902"></a>
<a name="ln-3903"></a>
<a name="ln-3904"></a>            <span class="c">!Get heating coil type and name data</span>
<a name="ln-3905"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3906"></a><span class="k">          </span><span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3907"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWaterToAirHP</span>
<a name="ln-3908"></a>          <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3909"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-3910"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3911"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3912"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3913"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3914"></a>          <span class="k">ELSE</span>
<a name="ln-3915"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetWtoAHPCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3916"></a>            <span class="n">HeatingCoilInletNode</span><span class="o">=</span><span class="n">GetWtoAHPCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3917"></a>            <span class="n">HeatingCoilOutletNode</span><span class="o">=</span><span class="n">GetWtoAHPCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3918"></a>          <span class="n">ENDIF</span>
<a name="ln-3919"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3920"></a><span class="k">          </span><span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3921"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span>
<a name="ln-3922"></a>          <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3923"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3924"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3925"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3926"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3927"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3928"></a>          <span class="k">ELSE</span>
<a name="ln-3929"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilIndex</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3930"></a>            <span class="n">HeatingCoilInletNode</span><span class="o">=</span><span class="n">GetWtoAHPSimpleCoilInletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3931"></a>            <span class="n">HeatingCoilOutletNode</span><span class="o">=</span><span class="n">GetWtoAHPSimpleCoilOutletNode</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3932"></a>          <span class="n">ENDIF</span>
<a name="ln-3933"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3934"></a><span class="k">          </span><span class="n">HeatingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-3935"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span>
<a name="ln-3936"></a>          <span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-3937"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3938"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3939"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3940"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3941"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3942"></a>          <span class="k">ELSE</span>
<a name="ln-3943"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3944"></a>            <span class="n">HeatingCoilInletNode</span><span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3945"></a>            <span class="n">HeatingCoilOutletNode</span><span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3946"></a>          <span class="n">ENDIF</span>
<a name="ln-3947"></a>        <span class="k">ELSE</span>
<a name="ln-3948"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3949"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)))</span>
<a name="ln-3950"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3951"></a>        <span class="k">END IF</span>
<a name="ln-3952"></a>
<a name="ln-3953"></a>
<a name="ln-3954"></a>        <span class="c">! Get Cooling Coil Information if available</span>
<a name="ln-3955"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3956"></a><span class="k">          </span><span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3957"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterToAirHP</span>
<a name="ln-3958"></a>          <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3959"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3960"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3961"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3962"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3963"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3964"></a>          <span class="k">ELSE</span>
<a name="ln-3965"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetWtoAHPCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3966"></a>            <span class="n">CoolingCoilInletNode</span><span class="o">=</span><span class="n">GetWtoAHPCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3967"></a>                                                          <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3968"></a>            <span class="n">CoolingCoilOutletNode</span><span class="o">=</span><span class="n">GetWtoAHPCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3969"></a>                                                          <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3970"></a>          <span class="n">ENDIF</span>
<a name="ln-3971"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3972"></a><span class="k">          </span><span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3973"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span>
<a name="ln-3974"></a>          <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3975"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3976"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3977"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3978"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3979"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3980"></a>          <span class="k">ELSE</span>
<a name="ln-3981"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilIndex</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3982"></a>            <span class="n">CoolingCoilInletNode</span><span class="o">=</span><span class="n">GetWtoAHPSimpleCoilInletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3983"></a>                                                                <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3984"></a>            <span class="n">CoolingCoilOutletNode</span><span class="o">=</span><span class="n">GetWtoAHPSimpleCoilOutletNode</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3985"></a>                                                                <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3986"></a>          <span class="n">ENDIF</span>
<a name="ln-3987"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-3988"></a><span class="k">          </span><span class="n">CoolingCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-3989"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span>
<a name="ln-3990"></a>          <span class="n">CoolingCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a name="ln-3991"></a>          <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3992"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-3993"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-3994"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-3995"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-3996"></a>          <span class="k">ELSE</span>
<a name="ln-3997"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span> <span class="o">=</span> <span class="n">GetCoilIndexVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span> <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-3998"></a>            <span class="n">CoolingCoilInletNode</span><span class="o">=</span><span class="n">GetCoilInletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-3999"></a>                                                                <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4000"></a>            <span class="n">CoolingCoilOutletNode</span><span class="o">=</span><span class="n">GetCoilOutletNodeVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4001"></a>                                                                <span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4002"></a>          <span class="n">ENDIF</span>
<a name="ln-4003"></a>        <span class="k">ELSE</span>
<a name="ln-4004"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4005"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<a name="ln-4006"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4007"></a>        <span class="k">END IF</span>
<a name="ln-4008"></a>
<a name="ln-4009"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">NumAlphas</span> <span class="o">&gt;=</span> <span class="mi">18</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4010"></a>          <span class="c">! get water flow mode info before CALL SetSimpleWSHPData</span>
<a name="ln-4011"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="s1">&#39;Constant&#39;</span><span class="p">))</span>   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterConstant</span>
<a name="ln-4012"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="s1">&#39;Cycling&#39;</span><span class="p">))</span>   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCycling</span>
<a name="ln-4013"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="p">),</span><span class="s1">&#39;ConstantOnDemand&#39;</span><span class="p">))</span>   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterConstantOnDemand</span>
<a name="ln-4014"></a>             <span class="c">!default to draw through if not specified in input</span>
<a name="ln-4015"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCycling</span>
<a name="ln-4016"></a>        <span class="k">ELSE</span>
<a name="ln-4017"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="o">=</span> <span class="n">WaterCycling</span>
<a name="ln-4018"></a>        <span class="n">ENDIF</span>
<a name="ln-4019"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4020"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">18</span><span class="p">)))</span>
<a name="ln-4021"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4022"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4023"></a>        <span class="k">END IF</span>
<a name="ln-4024"></a>
<a name="ln-4025"></a>        <span class="c">! end get water flow mode info</span>
<a name="ln-4026"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-4027"></a>            <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:EQUATIONFIT&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4028"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">=</span> <span class="n">WatertoAir_Simple</span>
<a name="ln-4029"></a>          <span class="k">CALL </span><span class="n">SetSimpleWSHPData</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WaterCyclingMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4030"></a>                                <span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-4031"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4032"></a>                <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:PARAMETERESTIMATION&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4033"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">=</span> <span class="n">WatertoAir_ParEst</span>
<a name="ln-4034"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:HEATING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4035"></a>                <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;COIL:COOLING:WATERTOAIRHEATPUMP:VARIABLESPEEDEQUATIONFIT&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4036"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">=</span> <span class="n">WatertoAir_VarSpeedEquationFit</span>
<a name="ln-4037"></a>          <span class="k">CALL </span><span class="n">SetVarSpeedCoilData</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4038"></a>                                <span class="n">CompanionHeatingCoilNum</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-4039"></a>        <span class="k">ELSE</span>
<a name="ln-4040"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4041"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Cooling coil and heating coil should be of same general type&#39;</span><span class="p">)</span>
<a name="ln-4042"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4043"></a>        <span class="k">END IF</span>
<a name="ln-4044"></a>
<a name="ln-4045"></a>        <span class="c">! Get supplemental heating coil information</span>
<a name="ln-4046"></a>
<a name="ln-4047"></a>        <span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a name="ln-4048"></a>        <span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a name="ln-4049"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span> <span class="o">=</span> <span class="n">SuppHeatCoilType</span>
<a name="ln-4050"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span> <span class="o">=</span> <span class="n">SuppHeatCoilName</span>
<a name="ln-4051"></a>        <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4052"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Gas&#39;</span><span class="p">)</span>      <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4053"></a>              <span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Electric&#39;</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4054"></a>
<a name="ln-4055"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">GetHeatingCoilTypeNum</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4056"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4057"></a><span class="k">               CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4058"></a>               <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4059"></a>            <span class="k">ELSE</span>
<a name="ln-4060"></a><span class="k">              </span><span class="n">IsNotOK</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4061"></a>              <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4062"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4063"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;In &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4064"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4065"></a>
<a name="ln-4066"></a>               <span class="k">ELSE</span> <span class="c">! mine data from the supplemental heating coil</span>
<a name="ln-4067"></a>
<a name="ln-4068"></a>                  <span class="k">CALL </span><span class="n">GetHeatingCoilIndex</span><span class="p">(</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">)</span>
<a name="ln-4069"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4070"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4071"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4072"></a>                  <span class="n">ENDIF</span>
<a name="ln-4073"></a>
<a name="ln-4074"></a>                  <span class="c">! Get the Supplemental Heating Coil Inlet Node Number</span>
<a name="ln-4075"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4076"></a>                  <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilInletNode</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4077"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4078"></a><span class="k">                     CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4079"></a>                     <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4080"></a>                  <span class="n">ENDIF</span>
<a name="ln-4081"></a>
<a name="ln-4082"></a>                  <span class="c">! Get the Supplemental Heating Coil Outlet Node Number</span>
<a name="ln-4083"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4084"></a>                  <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetHeatingCoilOutletNode</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4085"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4086"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4087"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4088"></a>                  <span class="n">ENDIF</span>
<a name="ln-4089"></a>
<a name="ln-4090"></a>                  <span class="c">! Get the supplemental heating coil design capacity</span>
<a name="ln-4091"></a>                  <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4092"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4093"></a>                     <span class="n">GetHeatingCoilCapacity</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4094"></a>                  <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4095"></a><span class="k">                    CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4096"></a>                    <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4097"></a>                  <span class="n">ENDIF</span>
<a name="ln-4098"></a>
<a name="ln-4099"></a>               <span class="n">ENDIF</span> <span class="c">! IF (IsNotOK) THEN</span>
<a name="ln-4100"></a>            <span class="n">ENDIF</span>
<a name="ln-4101"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4102"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingWater</span>
<a name="ln-4103"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4104"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4105"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4106"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4107"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-4108"></a>
<a name="ln-4109"></a>                <span class="c">! Get the Heating Coil water Inlet or control Node number</span>
<a name="ln-4110"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4111"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetCoilWaterInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4112"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4113"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4114"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4115"></a>                <span class="k">END IF</span>
<a name="ln-4116"></a>
<a name="ln-4117"></a>                <span class="c">! Get the ReHeat Coil hot water max volume flow rate</span>
<a name="ln-4118"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4119"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4120"></a>                                                           <span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4121"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4122"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4123"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4124"></a>                <span class="k">END IF</span>
<a name="ln-4125"></a>
<a name="ln-4126"></a>                <span class="c">! Get the ReHeat Coil Inlet Node</span>
<a name="ln-4127"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4128"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span>  <span class="n">GetWaterCoilInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4129"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-4130"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4131"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4132"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4133"></a>                <span class="k">END IF</span>
<a name="ln-4134"></a>
<a name="ln-4135"></a>                <span class="c">! Get the ReHeat Coil Outlet Node</span>
<a name="ln-4136"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4137"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="n">GetWaterCoilOutletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4138"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-4139"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4140"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4141"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4142"></a>                <span class="k">END IF</span>
<a name="ln-4143"></a>                <span class="c">! check if user has also used a water coil controller, which they should not do</span>
<a name="ln-4144"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4145"></a>                <span class="k">CALL </span><span class="n">CheckCoilWaterInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4146"></a>                <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">! then did find a controller so that is bad</span>
<a name="ln-4147"></a>                  <span class="k">CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4148"></a>                                      <span class="o">//</span><span class="s1">&#39; has a conflicting Controller:WaterCoil object&#39;</span> <span class="p">)</span>
<a name="ln-4149"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Hot water coils are controlled directly by unitary and furnace systems.&#39;</span><span class="p">)</span>
<a name="ln-4150"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;No water coil controller should be input for the coil.&#39;</span><span class="p">)</span>
<a name="ln-4151"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4152"></a>                <span class="n">ENDIF</span>
<a name="ln-4153"></a>
<a name="ln-4154"></a>
<a name="ln-4155"></a>            <span class="n">ENDIF</span>
<a name="ln-4156"></a>
<a name="ln-4157"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4158"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">=</span> <span class="n">Coil_HeatingSteam</span>
<a name="ln-4159"></a>            <span class="k">CALL </span><span class="n">ValidateComponent</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">IsNotOK</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">))</span>
<a name="ln-4160"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">IsNotOK</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4161"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4162"></a>                <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4163"></a>            <span class="k">ELSE</span> <span class="c">! mine data from heating coil object</span>
<a name="ln-4164"></a>
<a name="ln-4165"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4166"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="o">=</span> <span class="n">GetSTeamCoilIndex</span><span class="p">(</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4167"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4168"></a><span class="k">                    CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4169"></a>                                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">SuppHeatCoilName</span><span class="p">))</span>
<a name="ln-4170"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4171"></a>                    <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4172"></a>                <span class="k">END IF</span>
<a name="ln-4173"></a>
<a name="ln-4174"></a>                <span class="c">! Get the Heating Coil steam inlet node number</span>
<a name="ln-4175"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4176"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="o">=</span> <span class="n">GetSteamCoilSteamInletNode</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Steam&#39;</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4177"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4178"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4179"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4180"></a>                <span class="k">END IF</span>
<a name="ln-4181"></a>
<a name="ln-4182"></a>                <span class="c">! Get the Heating Coil steam max volume flow rate</span>
<a name="ln-4183"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4184"></a>                <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4185"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span>      <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-4186"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s2">&quot;STEAM&quot;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;GetAirLoopHVACHeatCoolInput&#39;</span><span class="p">)</span>
<a name="ln-4187"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4188"></a>                                     <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-4189"></a>                <span class="k">END IF</span>
<a name="ln-4190"></a>
<a name="ln-4191"></a>                <span class="c">! Get the Heating Coil Inlet Node</span>
<a name="ln-4192"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4193"></a>                <span class="n">SupHeatCoilInletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4194"></a>                         <span class="n">GetSteamCoilAirInletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4195"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilInletNode</span>
<a name="ln-4196"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4197"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4198"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4199"></a>                <span class="k">END IF</span>
<a name="ln-4200"></a>
<a name="ln-4201"></a>                <span class="c">! Get the Heating Coil Outlet Node</span>
<a name="ln-4202"></a>                <span class="n">ErrFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4203"></a>                <span class="n">SupHeatCoilOutletNode</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4204"></a>                         <span class="n">GetSteamCoilAirOutletNode</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4205"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirOutletNode</span> <span class="o">=</span> <span class="n">SupHeatCoilOutletNode</span>
<a name="ln-4206"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4207"></a><span class="k">                  CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4208"></a>                  <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4209"></a>                <span class="k">END IF</span>
<a name="ln-4210"></a>
<a name="ln-4211"></a><span class="k">            </span><span class="n">ENDIF</span>
<a name="ln-4212"></a>
<a name="ln-4213"></a>        <span class="k">ELSE</span>
<a name="ln-4214"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4215"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">)))</span>
<a name="ln-4216"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4217"></a>        <span class="k">END IF</span> <span class="c">! IF (Furnace(FurnaceNum)%HeatingCoilType_Num == Coil_HeatingGas .OR. &amp;, etc.</span>
<a name="ln-4218"></a>
<a name="ln-4219"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4220"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4221"></a>        <span class="k">ELSE</span>
<a name="ln-4222"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4223"></a>              <span class="n">GetOnlySingleNode</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">ErrorsFound</span><span class="p">,</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4224"></a>                                <span class="n">NodeType_Air</span><span class="p">,</span><span class="n">NodeConnectionType_OutsideAirReference</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ObjectIsNotParent</span><span class="p">)</span>
<a name="ln-4225"></a>         <span class="c">! need better verification.</span>
<a name="ln-4226"></a>         <span class="k">IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">CheckOutAirNodeNumber</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4227"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4228"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Node name of outdoor dry-bulb temperature sensor not valid outdoor air node= &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4229"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">14</span><span class="p">)))</span>
<a name="ln-4230"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...does not appear in an OutdoorAir:NodeList or as an OutdoorAir:Node.&#39;</span><span class="p">)</span>
<a name="ln-4231"></a>           <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4232"></a>         <span class="k">END IF</span>
<a name="ln-4233"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4234"></a>
<a name="ln-4235"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">&#39;BlowThrough&#39;</span><span class="p">))</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">BlowThru</span>
<a name="ln-4236"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span><span class="s1">&#39;DrawThrough&#39;</span><span class="p">))</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">=</span> <span class="n">DrawThru</span>
<a name="ln-4237"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4238"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4239"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">15</span><span class="p">)))</span>
<a name="ln-4240"></a>          <span class="n">ErrorsFound</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4241"></a>        <span class="k">END IF</span>
<a name="ln-4242"></a>
<a name="ln-4243"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span>     <span class="o">=</span> <span class="n">GetScheduleIndex</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<a name="ln-4244"></a>        <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4245"></a><span class="k">          CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4246"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">16</span><span class="p">)))</span>
<a name="ln-4247"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4248"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4249"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-4250"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">/=</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4251"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4252"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
<a name="ln-4253"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Fan type must be Fan:OnOff when &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4254"></a>                                   <span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = Blank.&#39;</span><span class="p">)</span>
<a name="ln-4255"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4256"></a>          <span class="k">END IF</span>
<a name="ln-4257"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-4258"></a>
<a name="ln-4259"></a>        <span class="c">! add the Dehumidification Type</span>
<a name="ln-4260"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4261"></a><span class="k">          </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4262"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;CoolReheat&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4263"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_CoolReheat</span>
<a name="ln-4264"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4265"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4266"></a><span class="k">              CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-4267"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Dehumidification control type is assumed to be None since a supplemental reheat coil &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4268"></a>                                     <span class="s1">&#39;has not been specified and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-4269"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4270"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-4271"></a>            <span class="k">END IF</span>
<a name="ln-4272"></a><span class="k">          END IF</span>
<a name="ln-4273"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SameString</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;None&#39;</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-4274"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-4275"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4276"></a>          <span class="k">END IF</span>
<a name="ln-4277"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4278"></a><span class="k">            DO </span><span class="n">HstatZoneNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHumidityControlZones</span>
<a name="ln-4279"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">HumidityControlZone</span><span class="p">(</span><span class="n">HstatZoneNum</span><span class="p">)%</span><span class="n">ActualZoneNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span><span class="k">CYCLE</span>
<a name="ln-4280"></a><span class="k">              </span><span class="n">AirNodeFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4281"></a>            <span class="k">END DO</span>
<a name="ln-4282"></a><span class="k">            IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">AirNodeFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4283"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4284"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Did not find Air Node (Zone with Humidistat).&#39;</span><span class="p">)</span>
<a name="ln-4285"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Specified &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<a name="ln-4286"></a>              <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4287"></a>            <span class="n">ENDIF</span>
<a name="ln-4288"></a>          <span class="k">END IF</span>
<a name="ln-4289"></a><span class="k">        ELSE</span> <span class="c">! invalid input or blank</span>
<a name="ln-4290"></a>          <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">lAlphaBlanks</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4291"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4292"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;Illegal &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cAlphaFields</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">17</span><span class="p">)))</span>
<a name="ln-4293"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4294"></a>          <span class="k">ELSE</span>
<a name="ln-4295"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4296"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">=</span> <span class="n">DehumidControl_None</span>
<a name="ln-4297"></a>          <span class="n">ENDIF</span>
<a name="ln-4298"></a>        <span class="k">END IF</span>
<a name="ln-4299"></a>
<a name="ln-4300"></a>        <span class="c">! Add fan to component sets array</span>
<a name="ln-4301"></a>
<a name="ln-4302"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="o">==</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4303"></a><span class="k">          </span><span class="n">CompSetFanInlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4304"></a>          <span class="n">CompSetCoolInlet</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-4305"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FanInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4306"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4307"></a>                                <span class="s1">&#39;, Mismatch between unitary system inlet node and fan inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4308"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..For &quot;BlowThrough&quot; fan, the inlet node name for the HeatPump should match the &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4309"></a>                                   <span class="s1">&#39;fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4310"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..HeatPump Inlet Node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-4311"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Fan Inlet Node      = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-4312"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4313"></a>          <span class="n">ENDIF</span>
<a name="ln-4314"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">CoolingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4315"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4316"></a>                                <span class="s1">&#39;, Mismatch between fan outlet node and cooling coil inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4317"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..For &quot;BlowThrough&quot; fan, the fan outlet node name must match the cooling coil &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4318"></a>                                   <span class="s1">&#39;inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4319"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Fan outlet node         = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-4320"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Cooling coil inlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-4321"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4322"></a>          <span class="n">ENDIF</span>
<a name="ln-4323"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4324"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4325"></a>                                <span class="s1">&#39;, Mismatch between cooling coil outlet node and heating coil inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4326"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..The cooling coil outlet node name must match the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4327"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Cooling coil outlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-4328"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Heating coil inlet node  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-4329"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4330"></a>          <span class="n">ENDIF</span>
<a name="ln-4331"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">SupHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4332"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4333"></a>                                <span class="s1">&#39;, Mismatch between heating coil outlet node and supplemental heating coil inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4334"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..For &quot;BlowThrough&quot; fan, the heating coil outlet node name must match the supplemental &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4335"></a>                                   <span class="s1">&#39;heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4336"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Heating coil outlet node             = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-4337"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Supplemental heating coil inlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-4338"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4339"></a>          <span class="n">ENDIF</span>
<a name="ln-4340"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SupHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4341"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4342"></a>                                <span class="s1">&#39;, Mismatch between supplemental heating coil outlet node and HeatPump outlet node.&#39;</span><span class="p">)</span>
<a name="ln-4343"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..The supplemental heating coil outlet node name must match the &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4344"></a>                                   <span class="s1">&#39;HeatPump outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4345"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Supplemental heating coil outlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-4346"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..HeatPump outlet node                  = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4347"></a>                                                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-4348"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4349"></a>          <span class="n">ENDIF</span>
<a name="ln-4350"></a>        <span class="k">ELSE</span>
<a name="ln-4351"></a><span class="k">          </span><span class="n">CompSetFanInlet</span> <span class="o">=</span> <span class="s1">&#39;UNDEFINED&#39;</span>
<a name="ln-4352"></a>          <span class="n">CompSetCoolInlet</span> <span class="o">=</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4353"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingCoilInletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4354"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4355"></a>                                <span class="s1">&#39;, Mismatch between unitary system inlet node and cooling coil inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4356"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..For &quot;DrawThrough&quot; fan, the inlet node name for the HeatPump should match&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4357"></a>                                   <span class="s1">&#39; the cooling coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4358"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..HeatPump inlet node     = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)))</span>
<a name="ln-4359"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Cooling coil inlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilInletNode</span><span class="p">)))</span>
<a name="ln-4360"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4361"></a>          <span class="n">ENDIF</span>
<a name="ln-4362"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingCoilOutletNode</span> <span class="o">/=</span> <span class="n">HeatingCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4363"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4364"></a>                                <span class="s1">&#39;, Mismatch between cooling coil outlet node and heating coil inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4365"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..The outlet node name for the cooling coil should match&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4366"></a>                                   <span class="s1">&#39; the heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4367"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Cooling coil outlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">CoolingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-4368"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Heating coil inlet node  = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilInletNode</span><span class="p">)))</span>
<a name="ln-4369"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4370"></a>          <span class="n">ENDIF</span>
<a name="ln-4371"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HeatingCoilOutletNode</span> <span class="o">/=</span> <span class="n">FanInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4372"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4373"></a>                                <span class="s1">&#39;, Mismatch between heating coil outlet node and fan inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4374"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..For &quot;DrawThrough&quot; fan, the outlet node name for the heating coil should match&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4375"></a>                                   <span class="s1">&#39; the fan inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4376"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Heating coil outlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">HeatingCoilOutletNode</span><span class="p">)))</span>
<a name="ln-4377"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Fan inlet node           = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanInletNode</span><span class="p">)))</span>
<a name="ln-4378"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4379"></a>          <span class="n">ENDIF</span>
<a name="ln-4380"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">FanOutletNode</span> <span class="o">/=</span> <span class="n">SupHeatCoilInletNode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4381"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4382"></a>                                <span class="s1">&#39;, Mismatch between fan outlet node and supplemental heating coil inlet node.&#39;</span><span class="p">)</span>
<a name="ln-4383"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..For &quot;DrawThrough&quot; fan, the outlet node name for the fan should match the &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4384"></a>                                   <span class="s1">&#39;supplemental heating coil inlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4385"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Fan outlet node                      = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">FanOutletNode</span><span class="p">)))</span>
<a name="ln-4386"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Supplemental heating coil inlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilInletNode</span><span class="p">)))</span>
<a name="ln-4387"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4388"></a>          <span class="n">ENDIF</span>
<a name="ln-4389"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SupHeatCoilOutletNode</span> <span class="o">/=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4390"></a><span class="k">            CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="s1">&#39;For &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4391"></a>                                <span class="s1">&#39;, Mismatch between supplemental heating coil outlet node and HeatPump outlet node.&#39;</span><span class="p">)</span>
<a name="ln-4392"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..The supplemental heating coil outlet node name must match the &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-4393"></a>                                   <span class="s1">&#39;HeatPump outlet node name.&#39;</span><span class="p">)</span>
<a name="ln-4394"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..Supplemental heating coil outlet node = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">SupHeatCoilOutletNode</span><span class="p">)))</span>
<a name="ln-4395"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;..HeatPump outlet node                  = &#39;</span> <span class="p">&amp;</span>
<a name="ln-4396"></a>                                                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">NodeID</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)))</span>
<a name="ln-4397"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4398"></a>          <span class="n">ENDIF</span>
<a name="ln-4399"></a>        <span class="n">ENDIF</span>
<a name="ln-4400"></a>        <span class="c">!  (Set up validation here for the fan or cooling coil inlet?)</span>
<a name="ln-4401"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4402"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="n">CompSetFanInlet</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-4403"></a>
<a name="ln-4404"></a>        <span class="c">! Add DX heating coil to component sets array</span>
<a name="ln-4405"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4406"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-4407"></a>
<a name="ln-4408"></a>        <span class="c">! Add DX cooling coil to component sets array</span>
<a name="ln-4409"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4410"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">CompSetCoolInlet</span><span class="p">,</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">)</span>
<a name="ln-4411"></a>
<a name="ln-4412"></a>        <span class="c">! Add supplemental heating coil to component sets array</span>
<a name="ln-4413"></a>        <span class="k">CALL </span><span class="n">SetUpCompSets</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">,</span> <span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-4414"></a>                           <span class="n">Alphas</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;UNDEFINED&#39;</span><span class="p">,</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-4415"></a>
<a name="ln-4416"></a>
<a name="ln-4417"></a>
<a name="ln-4418"></a>        <span class="c">!Set the Design Fan Volume Flow Rate</span>
<a name="ln-4419"></a>        <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4420"></a>        <span class="n">FanVolFlowRate</span> <span class="o">=</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4421"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-4422"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4423"></a><span class="k">          CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4424"></a>          <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4425"></a>        <span class="n">ENDIF</span>
<a name="ln-4426"></a>
<a name="ln-4427"></a><span class="c">! CR8094 - simple water to air heat pump MUST operate at the same flow rate specified in the coil objects</span>
<a name="ln-4428"></a><span class="c">!        Furnace(FurnaceNum)%DesignFanVolFlowRate = Numbers(1)</span>
<a name="ln-4429"></a><span class="c">!        Furnace(FurnaceNum)%MaxHeatAirVolFlow    = Furnace(FurnaceNum)%DesignFanVolFlowRate</span>
<a name="ln-4430"></a><span class="c">!        Furnace(FurnaceNum)%MaxCoolAirVolFlow    = Furnace(FurnaceNum)%DesignFanVolFlowRate</span>
<a name="ln-4431"></a>
<a name="ln-4432"></a>        <span class="c">! parameter estimate model only specifies air flow rate in parent object</span>
<a name="ln-4433"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span>  <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4434"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4435"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>    <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-4436"></a>        <span class="c">! simple HP model specifies air flow rate in both the parent and child coils. Use coil air flow rates.</span>
<a name="ln-4437"></a>        <span class="c">! simple HP model air flow rate input will not be used.</span>
<a name="ln-4438"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4439"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4440"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>       <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilAirFlow</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4441"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="o">=</span> <span class="n">GetWtoAHPSimpleCoilAirFlow</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4442"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4443"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4444"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4445"></a>          <span class="n">ENDIF</span>
<a name="ln-4446"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4447"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4448"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span>       <span class="o">=</span> <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4449"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span>       <span class="o">=</span> <span class="n">GetCoilAirFlowRateVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4450"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4451"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4452"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4453"></a>          <span class="n">ENDIF</span>
<a name="ln-4454"></a>        <span class="n">ENDIF</span>
<a name="ln-4455"></a>
<a name="ln-4456"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4457"></a>             <span class="nb">MIN</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-4458"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4459"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4460"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4461"></a>             <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-4462"></a>        <span class="k">ELSE</span>
<a name="ln-4463"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Autosize</span>
<a name="ln-4464"></a>        <span class="k">END IF</span>
<a name="ln-4465"></a>
<a name="ln-4466"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span>          <span class="o">=</span> <span class="n">UseCompressorOnFlow</span>
<a name="ln-4467"></a>
<a name="ln-4468"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4469"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&gt;</span> <span class="n">FanVolFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4470"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4471"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... has a Cooling or Heating Air Flow Rate &gt; Max Fan Volume Flow Rate, should be &lt;=.&#39;</span><span class="p">)</span>
<a name="ln-4472"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Entered value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4473"></a>                <span class="s1">&#39;... Fan [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4474"></a>                <span class="s1">&#39;] Max Value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4475"></a>          <span class="n">ENDIF</span>
<a name="ln-4476"></a>        <span class="n">ENDIF</span>
<a name="ln-4477"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4478"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4479"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4480"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... has a Design Fan Flow Rate &lt;= 0.0, it must be &gt;0.0&#39;</span><span class="p">)</span>
<a name="ln-4481"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Entered value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4482"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4483"></a>          <span class="n">ENDIF</span>
<a name="ln-4484"></a>        <span class="n">ENDIF</span>
<a name="ln-4485"></a>
<a name="ln-4486"></a>        <span class="c">!Set the heat pump heating coil capacity</span>
<a name="ln-4487"></a>        <span class="c">!  Get from coil module.</span>
<a name="ln-4488"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span>  <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHP</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4489"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4490"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4491"></a>             <span class="n">GetWtoAHPCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4492"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4493"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4494"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4495"></a>          <span class="n">ENDIF</span>
<a name="ln-4496"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4497"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4498"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4499"></a>             <span class="n">GetWtoAHPSimpleCoilCapacity</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4500"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4501"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4502"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4503"></a>          <span class="n">ENDIF</span>
<a name="ln-4504"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4505"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4506"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4507"></a>             <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">HeatingCoilType</span><span class="p">,</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4508"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4509"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4510"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4511"></a>          <span class="n">ENDIF</span>
<a name="ln-4512"></a>        <span class="n">ENDIF</span>
<a name="ln-4513"></a>        <span class="c">!Set the heat pump heating coil convergence</span>
<a name="ln-4514"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-4515"></a>        <span class="c">!Set the heat pump cooling coil capacity (Total capacity)</span>
<a name="ln-4516"></a>        <span class="c">!  Get from coil module.</span>
<a name="ln-4517"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span>  <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHP</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4518"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4519"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4520"></a>             <span class="n">GetWtoAHPCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4521"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4522"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4523"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4524"></a>          <span class="n">ENDIF</span>
<a name="ln-4525"></a>        <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4526"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4527"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4528"></a>             <span class="n">GetWtoAHPSimpleCoilCapacity</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4529"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4530"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4531"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4532"></a>          <span class="n">ENDIF</span>
<a name="ln-4533"></a>       <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4534"></a><span class="k">          </span><span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4535"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-4536"></a>             <span class="n">GetCoilCapacityVariableSpeed</span><span class="p">(</span><span class="n">CoolingCoilType</span><span class="p">,</span><span class="n">CoolingCoilName</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">)</span>
<a name="ln-4537"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4538"></a><span class="k">            CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Alphas</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<a name="ln-4539"></a>            <span class="n">ErrorsFound</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4540"></a>          <span class="n">ENDIF</span>
<a name="ln-4541"></a>        <span class="n">ENDIF</span>
<a name="ln-4542"></a>        <span class="c">!Set the heat pump cooling coil convergence</span>
<a name="ln-4543"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingConvergenceTolerance</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-4544"></a>        <span class="c">!Set the heatpump cycling rate</span>
<a name="ln-4545"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-4546"></a>
<a name="ln-4547"></a>        <span class="c">!Set the heat pump time constant</span>
<a name="ln-4548"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-4549"></a>
<a name="ln-4550"></a>        <span class="c">!Set the heat pump on-cycle power use fraction</span>
<a name="ln-4551"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OnCyclePowerFraction</span> <span class="o">=</span> <span class="n">Numbers</span> <span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-4552"></a>
<a name="ln-4553"></a>        <span class="c">!Set the heat pump fan delay time</span>
<a name="ln-4554"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-4555"></a>
<a name="ln-4556"></a>        <span class="c">!Set the heatpump design supplemental heating capacity</span>
<a name="ln-4557"></a>        <span class="c">!  Get from coil module.</span>
<a name="ln-4558"></a>
<a name="ln-4559"></a>
<a name="ln-4560"></a>        <span class="c">!Set the heatpump max outlet temperature</span>
<a name="ln-4561"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-4562"></a>
<a name="ln-4563"></a>
<a name="ln-4564"></a>        <span class="c">!Set maximum supply air temperature for supplemental heating coil</span>
<a name="ln-4565"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span> <span class="o">=</span> <span class="n">Numbers</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a name="ln-4566"></a>
<a name="ln-4567"></a>      <span class="k">END DO</span>  <span class="c">!End of the Unitary System WatertoAirHeatPump Loop</span>
<a name="ln-4568"></a>
<a name="ln-4569"></a>
<a name="ln-4570"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Alphas</span><span class="p">)</span>
<a name="ln-4571"></a>      <span class="k">DEALLOCATE</span><span class="p">(</span><span class="n">Numbers</span><span class="p">)</span>
<a name="ln-4572"></a>
<a name="ln-4573"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">ErrorsFound</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4574"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Errors found in getting Furnace or Unitary System input.&#39;</span><span class="p">)</span>
<a name="ln-4575"></a>      <span class="n">ENDIF</span>
<a name="ln-4576"></a>
<a name="ln-4577"></a>
<a name="ln-4578"></a>      <span class="k">DO </span><span class="n">HeatOnlyNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumHeatOnly</span>
<a name="ln-4579"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">HeatOnlyNum</span>
<a name="ln-4580"></a>        <span class="c">! Setup Report variables for the Furnace that are not reported in the components themselves</span>
<a name="ln-4581"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4582"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4583"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4584"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatOnly&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4585"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4586"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4587"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4588"></a>        <span class="n">ENDIF</span>
<a name="ln-4589"></a>      <span class="k">END DO</span>
<a name="ln-4590"></a>
<a name="ln-4591"></a>
<a name="ln-4592"></a><span class="k">      DO </span><span class="n">UnitaryHeatOnlyNum</span> <span class="o">=</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span>
<a name="ln-4593"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">UnitaryHeatOnlyNum</span>
<a name="ln-4594"></a>        <span class="c">! Setup Report variables for Unitary System that are not reported in the components themselves</span>
<a name="ln-4595"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4596"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4597"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4598"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatOnly&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4599"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4600"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4601"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4602"></a>        <span class="n">ENDIF</span>
<a name="ln-4603"></a>      <span class="k">END DO</span>
<a name="ln-4604"></a>
<a name="ln-4605"></a>
<a name="ln-4606"></a><span class="k">      DO </span><span class="n">HeatCoolNum</span> <span class="o">=</span> <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>  <span class="n">NumHeatOnly</span> <span class="o">+</span> <span class="n">NumUnitaryHeatOnly</span> <span class="o">+</span> <span class="n">NumHeatCool</span>
<a name="ln-4607"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">HeatCoolNum</span>
<a name="ln-4608"></a>        <span class="c">! Setup Report variables for the Furnace that are not reported in the components themselves</span>
<a name="ln-4609"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4610"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4611"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4612"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4613"></a>
<a name="ln-4614"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4615"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4616"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span>                         <span class="p">&amp;</span>
<a name="ln-4617"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>              <span class="p">&amp;</span>
<a name="ln-4618"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4619"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-4620"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During Cooling Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4621"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4622"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4623"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-4624"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During Heating Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4625"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4626"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4627"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:Unitary:Furnace:HeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4628"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During No Heating or Cooling Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4629"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4630"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4631"></a>        <span class="n">ENDIF</span>
<a name="ln-4632"></a>      <span class="k">END DO</span>
<a name="ln-4633"></a>
<a name="ln-4634"></a>
<a name="ln-4635"></a><span class="k">      DO </span><span class="n">UnitaryHeatCoolNum</span> <span class="o">=</span> <span class="n">NumHeatOnly</span><span class="o">+</span><span class="n">NumHeatCool</span><span class="o">+</span><span class="n">NumUnitaryHeatOnly</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4636"></a>                              <span class="n">NumHeatOnly</span><span class="o">+</span><span class="n">NumHeatCool</span><span class="o">+</span><span class="n">NumUnitaryHeatOnly</span><span class="o">+</span><span class="n">NumUnitaryHeatCool</span>
<a name="ln-4637"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">UnitaryHeatCoolNum</span>
<a name="ln-4638"></a>        <span class="c">! Setup Report variables for Unitary System that are not reported in the components themselves</span>
<a name="ln-4639"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4640"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4641"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4642"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4643"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4644"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4645"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span>                         <span class="p">&amp;</span>
<a name="ln-4646"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>              <span class="p">&amp;</span>
<a name="ln-4647"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4648"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4649"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During Cooling Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4650"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4651"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4652"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4653"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During Heating Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4654"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4655"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4656"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatCool&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4657"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate During No Heating or Cooling Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4658"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4659"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4660"></a>        <span class="n">ENDIF</span>
<a name="ln-4661"></a>
<a name="ln-4662"></a>      <span class="k">END DO</span>
<a name="ln-4663"></a>
<a name="ln-4664"></a>
<a name="ln-4665"></a><span class="k">      DO </span><span class="n">HeatPumpNum</span> <span class="o">=</span> <span class="n">NumHeatOnly</span><span class="o">+</span><span class="n">NumHeatCool</span><span class="o">+</span><span class="n">NumUnitaryHeatOnly</span><span class="o">+</span><span class="n">NumUnitaryHeatCool</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFurnaces</span><span class="o">-</span><span class="n">NumWaterToAirHeatPump</span>
<a name="ln-4666"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">HeatPumpNum</span>
<a name="ln-4667"></a>        <span class="c">! Setup Report variables for Unitary System that are not reported in the components themselves</span>
<a name="ln-4668"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4669"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4670"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4671"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4672"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Dehumidification Induced Heating Demand Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4673"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4674"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4675"></a>
<a name="ln-4676"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4677"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:AirToAir&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4678"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4679"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4680"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4681"></a>        <span class="n">ENDIF</span>
<a name="ln-4682"></a>      <span class="k">END DO</span>
<a name="ln-4683"></a>
<a name="ln-4684"></a><span class="k">      DO </span><span class="n">HeatPumpNum</span> <span class="o">=</span> <span class="n">NumHeatOnly</span><span class="o">+</span><span class="n">NumHeatCool</span><span class="o">+</span><span class="n">NumUnitaryHeatOnly</span><span class="o">+</span><span class="n">NumUnitaryHeatCool</span><span class="o">+</span><span class="n">NumHeatPump</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">NumFurnaces</span>
<a name="ln-4685"></a>        <span class="n">FurnaceNum</span><span class="o">=</span> <span class="n">HeatPumpNum</span>
<a name="ln-4686"></a>        <span class="c">! Setup Report variables for Unitary System that are not reported in the components themselves</span>
<a name="ln-4687"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Fan Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4688"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4689"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Compressor Part Load Ratio []&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4690"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4691"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Requested Sensible Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4692"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4693"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Requested Latent Cooling Rate [W]&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4694"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4695"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Requested Heating Rate [W]&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4696"></a>                              <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4697"></a>        <span class="k">CALL </span><span class="n">SetupOutputVariable</span><span class="p">(</span><span class="s1">&#39;Unitary System Dehumidification Induced Heating Demand Rate [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4698"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span><span class="p">,</span> <span class="s1">&#39;System&#39;</span><span class="p">,</span><span class="s1">&#39;Average&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4699"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-4700"></a>
<a name="ln-4701"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4702"></a><span class="k">          CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:WaterToAir&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-4703"></a>                                <span class="s1">&#39;Autosized Supply Air Flow Rate&#39;</span><span class="p">,</span> <span class="s1">&#39;[m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4704"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">,</span>                  <span class="p">&amp;</span>
<a name="ln-4705"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span> <span class="p">)</span>
<a name="ln-4706"></a>        <span class="n">ENDIF</span>
<a name="ln-4707"></a>      <span class="k">END DO</span>
<a name="ln-4708"></a>
<a name="ln-4709"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">AnyEnergyManagementSystemInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4710"></a><span class="k">        DO </span><span class="n">FurnaceNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumFurnaces</span>
<a name="ln-4711"></a>          <span class="k">CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC Design Heating Capacity&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4712"></a>                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>  <span class="p">)</span>
<a name="ln-4713"></a>          <span class="k">CALL </span><span class="n">SetupEMSInternalVariable</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC Design Cooling Capacity&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4714"></a>                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span>  <span class="p">)</span>
<a name="ln-4715"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;Sensible Load Request&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4716"></a>                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideSensZoneLoadRequest</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSSensibleZoneLoadValue</span> <span class="p">)</span>
<a name="ln-4717"></a>          <span class="k">CALL </span><span class="n">SetupEMSActuator</span><span class="p">(</span><span class="s1">&#39;Unitary HVAC&#39;</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="s1">&#39;Moisture Load Request&#39;</span> <span class="p">,</span> <span class="s1">&#39;[W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4718"></a>                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideMoistZoneLoadRequest</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSMoistureZoneLoadValue</span> <span class="p">)</span>
<a name="ln-4719"></a>
<a name="ln-4720"></a>        <span class="n">ENDDO</span>
<a name="ln-4721"></a>      <span class="n">ENDIF</span>
<a name="ln-4722"></a>
<a name="ln-4723"></a>      <span class="k">CALL </span><span class="n">ManageEMS</span><span class="p">(</span><span class="n">emsCallFromComponentGetInput</span><span class="p">)</span>
<a name="ln-4724"></a>  <span class="k">RETURN</span>
<a name="ln-4725"></a>
<a name="ln-4726"></a>
<a name="ln-4727"></a><span class="k">END SUBROUTINE </span><span class="n">GetFurnaceInput</span>
<a name="ln-4728"></a>
<a name="ln-4729"></a>
<a name="ln-4730"></a>
<a name="ln-4731"></a><span class="c">! End of Get Input subroutines for this Module</span>
<a name="ln-4732"></a><span class="c">!******************************************************************************</span>
<a name="ln-4733"></a>
<a name="ln-4734"></a>
<a name="ln-4735"></a>
<a name="ln-4736"></a> <span class="c">! Beginning Initialization Section of the Module</span>
<a name="ln-4737"></a><span class="c">!******************************************************************************</span>
<a name="ln-4738"></a>
<a name="ln-4739"></a>
<a name="ln-4740"></a><span class="k">SUBROUTINE </span><span class="n">InitFurnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4741"></a>
<a name="ln-4742"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-4743"></a>          <span class="c">!       AUTHOR         Richard J. Liesen</span>
<a name="ln-4744"></a>          <span class="c">!       DATE WRITTEN   Feb 2001</span>
<a name="ln-4745"></a>          <span class="c">!       MODIFIED       Oct 2001, Richard Raustad</span>
<a name="ln-4746"></a>          <span class="c">!                      Sep 2008, R. Raustad - revised logic to determine load to be met</span>
<a name="ln-4747"></a>          <span class="c">!                      Bereket Nigusse, June 2010 - added a procedure to calculate supply air flow fraction</span>
<a name="ln-4748"></a>          <span class="c">!                      through controlled zone</span>
<a name="ln-4749"></a>          <span class="c">!                      Bo Shen, March 2012 - for VS WSHP</span>
<a name="ln-4750"></a>          <span class="c">!                      Bo Shen, ORNL, July 2012 - added variable-speed air source heat pump cooling and heating coils, using curve-fits</span>
<a name="ln-4751"></a>
<a name="ln-4752"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-4753"></a>
<a name="ln-4754"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-4755"></a>          <span class="c">! This subroutine is for initializations of the Furnace Components.</span>
<a name="ln-4756"></a>
<a name="ln-4757"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-4758"></a>          <span class="c">! Uses the status flags to trigger initializations.</span>
<a name="ln-4759"></a>          <span class="c">! The HeatCool furnace/unitarysystem and air-to-air heat pump may have alternate air flow rates</span>
<a name="ln-4760"></a>          <span class="c">! in cooling, heating, and when no cooling or heating is needed. Set up the coil (comp) ON and OFF</span>
<a name="ln-4761"></a>          <span class="c">! air flow rates during InitFurnace. Use these flow rates during the Calc routines to set the</span>
<a name="ln-4762"></a>          <span class="c">! average mass flow rates based on PLR.</span>
<a name="ln-4763"></a>
<a name="ln-4764"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-4765"></a>
<a name="ln-4766"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-4767"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">,</span> <span class="n">GetFanSpeedRatioCurveIndex</span>
<a name="ln-4768"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-4769"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-4770"></a>  <span class="k">USE </span><span class="n">DataSizing</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">AutoSize</span>
<a name="ln-4771"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopHeatingCoilMaxRTF</span><span class="p">,</span> <span class="n">AirLoopControlInfo</span>
<a name="ln-4772"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneSysEnergyDemand</span><span class="p">,</span> <span class="n">ZoneSysMoistureDemand</span><span class="p">,</span> <span class="n">CurDeadbandOrSetback</span>
<a name="ln-4773"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">TempControlType</span>
<a name="ln-4774"></a>  <span class="k">USE </span><span class="n">DataHeatBalance</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">Zone</span>
<a name="ln-4775"></a>  <span class="k">USE </span><span class="n">DataAirflowNetwork</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateAirflowNetwork</span><span class="p">,</span> <span class="n">AirflowNetworkControlMultizone</span>
<a name="ln-4776"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span> <span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirToZoneNodeInfo</span>
<a name="ln-4777"></a>  <span class="k">USE </span><span class="n">DataPlant</span><span class="p">,</span>             <span class="n">ONLY</span><span class="p">:</span> <span class="n">TypeOf_CoilSteamAirHeating</span><span class="p">,</span> <span class="n">ScanPlantLoopsForObject</span><span class="p">,</span> <span class="n">TypeOf_CoilWaterSimpleHeating</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4778"></a>                                   <span class="n">PlantLoop</span>
<a name="ln-4779"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span><span class="p">,</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="o">=&gt;</span><span class="n">GetCoilMaxSteamFlowRate</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4780"></a>                                   <span class="n">GetSteamCoilCapacity</span><span class="o">=&gt;</span><span class="n">GetCoilCapacity</span>
<a name="ln-4781"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">,</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-4782"></a>  <span class="k">USE </span><span class="n">FluidProperties</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetDensityGlycol</span><span class="p">,</span> <span class="n">GetSatDensityRefrig</span>
<a name="ln-4783"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span><span class="p">,</span> <span class="n">InitComponentNodes</span>
<a name="ln-4784"></a>  <span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">GetFanVolFlow</span>
<a name="ln-4785"></a>
<a name="ln-4786"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-4787"></a>
<a name="ln-4788"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-4789"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>        <span class="c">! index to Furnace</span>
<a name="ln-4790"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirLoopNum</span>        <span class="c">! index to air loop</span>
<a name="ln-4791"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! ratio of on to off air mass flow rate</span>
<a name="ln-4792"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OpMode</span>            <span class="c">! fan operating mode</span>
<a name="ln-4793"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneLoad</span>          <span class="c">! zone sensible load to be met (modified here as needed) (W)</span>
<a name="ln-4794"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MoistureLoad</span>      <span class="c">! zone moisture load (W)</span>
<a name="ln-4795"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if first HVAC iteration</span>
<a name="ln-4796"></a>
<a name="ln-4797"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-4798"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">Small5WLoad</span> <span class="o">=</span> <span class="mf">5.0D0</span>
<a name="ln-4799"></a>
<a name="ln-4800"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-4801"></a>          <span class="c">! na</span>
<a name="ln-4802"></a>
<a name="ln-4803"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-4804"></a>          <span class="c">! na</span>
<a name="ln-4805"></a>
<a name="ln-4806"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-4807"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>                           <span class="kd">::</span> <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time allocation flag</span>
<a name="ln-4808"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyEnvrnFlag</span>             <span class="c">! environment flag</span>
<a name="ln-4809"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySecondOneTimeFlag</span>     <span class="c">! additional one time flag</span>
<a name="ln-4810"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyFanFlag</span>               <span class="c">! used for sizing fan inputs one time</span>
<a name="ln-4811"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyCheckFlag</span> <span class="c">! Used to obtain the zone inlet node number in the controlled zone</span>
<a name="ln-4812"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyFlowFracFlag</span>          <span class="c">! Used for calculatig flow fraction once</span>
<a name="ln-4813"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MyPlantScanFlag</span> <span class="c">! used to initializa plant comp for water and steam heating coils</span>
<a name="ln-4814"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">ALLOCATABLE</span><span class="p">,</span><span class="k">SAVE</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">MySuppCoilPlantScanFlag</span> <span class="c">! used to initialize plant comp for water and steam heating coils</span>
<a name="ln-4815"></a>  <span class="kt">LOGICAL</span>                                 <span class="kd">::</span> <span class="n">ErrFlag</span>                 <span class="c">! error flag for mining functions</span>
<a name="ln-4816"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">FanVolFlowRate</span>          <span class="c">! fan volumetric flow rate (m3/s)</span>
<a name="ln-4817"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">QZnReq</span>                  <span class="c">! furnace load based on control zone frac (W)</span>
<a name="ln-4818"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">PartLoadRatio</span>           <span class="c">! furnace part-load ratio</span>
<a name="ln-4819"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">SensibleOutput</span>          <span class="c">! no load sensible output (coils off) (W)</span>
<a name="ln-4820"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">LatentOutput</span>            <span class="c">! no load latent output (coils off) (W)</span>
<a name="ln-4821"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">QToCoolSetPt</span>            <span class="c">! sensible load to cooling setpoint (W)</span>
<a name="ln-4822"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">QToHeatSetPt</span>            <span class="c">! sensible load to heating setpoint (W)</span>
<a name="ln-4823"></a>  <span class="kt">INTEGER</span>                                 <span class="kd">::</span> <span class="n">ZoneInNode</span>              <span class="c">! Zone inlet node number in the controlled zone</span>
<a name="ln-4824"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">MinHumRat</span>               <span class="c">! Minimum humidity ratio for sensible capacity</span>
<a name="ln-4825"></a>                                                                     <span class="c">! calculation (kg/kg)</span>
<a name="ln-4826"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">DeltaMassRate</span>           <span class="c">! Difference of mass flow rate between</span>
<a name="ln-4827"></a>                                                                     <span class="c">! inlet node and system outlet node</span>
<a name="ln-4828"></a>  <span class="kt">INTEGER</span>                                 <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span>                   <span class="c">! index to get the zone inlet node</span>
<a name="ln-4829"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">MassFlowRate</span>            <span class="c">! mass flow rate to calculate loss</span>
<a name="ln-4830"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                               <span class="kd">::</span> <span class="n">MaxTemp</span>                 <span class="c">! Maximum temperature used in latent loss calculation</span>
<a name="ln-4831"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">FanType</span>                 <span class="c">! used in warning messages</span>
<a name="ln-4832"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">FanName</span>                 <span class="c">! used in warning messages</span>
<a name="ln-4833"></a>
<a name="ln-4834"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">0</span>                        <span class="c">! number of zone inlet nodes counter in an airloop</span>
<a name="ln-4835"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">NumAirLoopZones</span> <span class="o">=</span> <span class="mi">0</span>                       <span class="c">! number of zone inlet nodes in an air loop</span>
<a name="ln-4836"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneInletNodeNum</span> <span class="o">=</span> <span class="mi">0</span>                      <span class="c">! zone inlet nodes node number</span>
<a name="ln-4837"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>                <span class="c">! one time flag for calculating flow fraction through controlled zone</span>
<a name="ln-4838"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>              <span class="c">! the sum of mass flow rates at inlet to zones in an airloop</span>
<a name="ln-4839"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! Maximum mass flow rate through controlled zone terminal unit</span>
<a name="ln-4840"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c">! local do loop index for equipment listed for a zone</span>
<a name="ln-4841"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNodeNum</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! local do loop index for inlet nodes to a zone</span>
<a name="ln-4842"></a>
<a name="ln-4843"></a>  <span class="kt">LOGICAL</span>             <span class="kd">::</span> <span class="n">ErrorsFound</span>        <span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>   <span class="c">! flag returned from mining call</span>
<a name="ln-4844"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">mdot</span>               <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! local temporary for mass flow rate (kg/s)</span>
<a name="ln-4845"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">rho</span>                <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! local for fluid density</span>
<a name="ln-4846"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">SteamIndex</span>         <span class="o">=</span><span class="mi">0</span>         <span class="c">! index of steam quality for steam heating coil</span>
<a name="ln-4847"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SteamDensity</span>       <span class="o">=</span><span class="mf">0.0d0</span>       <span class="c">! density of steam at 100C, used for steam heating coils</span>
<a name="ln-4848"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! coil fluid maximum volume flow rate</span>
<a name="ln-4849"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">QACTUAL</span>            <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! coil actual capacity</span>
<a name="ln-4850"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">SUPHEATERLOAD</span>      <span class="o">=</span><span class="mf">0.0d0</span>     <span class="c">! SUPPLEMENTAL HEATER LOAD</span>
<a name="ln-4851"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NumOfSpeedCooling</span>                <span class="c">! Number of speeds for cooling</span>
<a name="ln-4852"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">NumOfSpeedHeating</span>                <span class="c">! Number of speeds for heating</span>
<a name="ln-4853"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InNode</span>                           <span class="c">! Inlet node number in MSHP loop</span>
<a name="ln-4854"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutNode</span>                          <span class="c">! Outlet node number in MSHP loop</span>
<a name="ln-4855"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">RhoAir</span>                           <span class="c">! Air density at InNode</span>
<a name="ln-4856"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">MyAirLoopPass</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>  <span class="c">! one time allocation flag</span>
<a name="ln-4857"></a>
<a name="ln-4858"></a>  <span class="n">InNode</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-4859"></a>  <span class="n">OutNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-4860"></a>
<a name="ln-4861"></a>          <span class="c">! FLOW:</span>
<a name="ln-4862"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyOneTimeFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4863"></a>    <span class="c">! initialize the environment and sizing flags</span>
<a name="ln-4864"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4865"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySizeFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4866"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySecondOneTimeFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4867"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyFanFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4868"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4869"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4870"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4871"></a>    <span class="k">ALLOCATE</span><span class="p">(</span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">NumFurnaces</span><span class="p">))</span>
<a name="ln-4872"></a>    <span class="n">MyEnvrnFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4873"></a>    <span class="n">MySizeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4874"></a>    <span class="n">MySecondOneTimeFlag</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4875"></a>    <span class="n">MyFanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4876"></a>    <span class="n">MyCheckFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4877"></a>    <span class="n">MyFlowFracFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4878"></a>    <span class="n">MyOneTimeFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4879"></a>    <span class="n">MyPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4880"></a>    <span class="n">MySuppCoilPlantScanFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4881"></a>  <span class="k">END IF</span>
<a name="ln-4882"></a>
<a name="ln-4883"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyAirLoopPass</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4884"></a><span class="k">    </span><span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-4885"></a>    <span class="n">MyAirLoopPass</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4886"></a>  <span class="k">End If</span>
<a name="ln-4887"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4888"></a><span class="k">    </span><span class="n">MyAirLoopPass</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4889"></a>  <span class="k">End If</span>
<a name="ln-4890"></a>
<a name="ln-4891"></a><span class="k">  </span><span class="n">AirLoopPass</span> <span class="o">=</span> <span class="n">AirLoopPass</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-4892"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">AirLoopPass</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="n">AirLoopPass</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-4893"></a>
<a name="ln-4894"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SysSizingCalc</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4895"></a>    <span class="c">! for each furnace, do the sizing once.</span>
<a name="ln-4896"></a>    <span class="k">CALL </span><span class="n">SizeFurnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-4897"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-4898"></a>
<a name="ln-4899"></a>    <span class="n">MySizeFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4900"></a>    <span class="c">! Pass the fan cycling schedule index up to the air loop. Set the air loop unitary system flag.</span>
<a name="ln-4901"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CycFanSchedPtr</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span>
<a name="ln-4902"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">UnitarySys</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-4903"></a>    <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">FanOpMode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-4904"></a>
<a name="ln-4905"></a>    <span class="c">!Check that heat pump heating capacity is within 20% of cooling capacity</span>
<a name="ln-4906"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4907"></a><span class="k">      IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span><span class="o">-</span><span class="p">&amp;</span>
<a name="ln-4908"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="p">)</span><span class="o">/</span><span class="p">&amp;</span>
<a name="ln-4909"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.2d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4910"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-4911"></a>                              <span class="s1">&#39;&quot; heating capacity is disproportionate (&gt; 20% different) to total cooling capacity&#39;</span><span class="p">)</span>
<a name="ln-4912"></a>      <span class="k">END IF</span>
<a name="ln-4913"></a><span class="k">    END IF</span>
<a name="ln-4914"></a>
<a name="ln-4915"></a><span class="k">  END IF</span>
<a name="ln-4916"></a>
<a name="ln-4917"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">DoingSizing</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MySecondOneTimeFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4918"></a>    <span class="c">! sizing all done.  check fan air flow rates</span>
<a name="ln-4919"></a>    <span class="n">ErrFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4920"></a>    <span class="n">FanVolFlowRate</span> <span class="o">=</span>    <span class="p">&amp;</span>
<a name="ln-4921"></a>        <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Blank</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">)</span>
<a name="ln-4922"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="n">FanVolFlowRate</span>
<a name="ln-4923"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">ErrFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4924"></a><span class="k">      CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4925"></a>                <span class="s1">&#39; =&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-4926"></a>    <span class="n">ENDIF</span>
<a name="ln-4927"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FanVolFlowRate</span> <span class="o">/=</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4928"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&gt;</span> <span class="n">FanVolFlowRate</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4929"></a><span class="k">        CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4930"></a>             <span class="s1">&#39; has a Design Fan Volume Flow Rate &gt; Max Fan Volume Flow Rate, should be &lt;=&#39;</span><span class="p">)</span>
<a name="ln-4931"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Entered value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4932"></a>             <span class="s1">&#39;... Fan [&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFanTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4933"></a>             <span class="s1">&#39;] Max Value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">FanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4934"></a>      <span class="n">ENDIF</span>
<a name="ln-4935"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4936"></a><span class="k">        CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-4937"></a>             <span class="s1">&#39; has a Design Fan Volume Flow Rate &lt;= 0.0, it must be &gt;0.0&#39;</span><span class="p">)</span>
<a name="ln-4938"></a>        <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;... Entered value=&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-4939"></a>      <span class="n">ENDIF</span>
<a name="ln-4940"></a>
<a name="ln-4941"></a>      <span class="n">MySecondOneTimeFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4942"></a>    <span class="n">ENDIF</span>
<a name="ln-4943"></a>  <span class="n">ENDIF</span>
<a name="ln-4944"></a>
<a name="ln-4945"></a>  <span class="c">! Scan hot water and steam heating coil plant components for one time initializations</span>
<a name="ln-4946"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-4947"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-4948"></a>         <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4949"></a>
<a name="ln-4950"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4951"></a>
<a name="ln-4952"></a><span class="k">        </span><span class="n">ERRFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4953"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4954"></a>                                          <span class="n">TypeOf_CoilWaterSimpleHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4955"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4956"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4957"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4958"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4959"></a>                                          <span class="n">ERRFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-4960"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4961"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitFurnace: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-4962"></a>        <span class="n">ENDIF</span>
<a name="ln-4963"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-4964"></a>                                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4965"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4966"></a><span class="k">          </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4967"></a>                                 <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4968"></a>                                 <span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4969"></a>                                <span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-4970"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-4971"></a>        <span class="k">END IF</span>
<a name="ln-4972"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4973"></a>
<a name="ln-4974"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-4975"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4976"></a>                                          <span class="n">TypeOf_CoilSteamAirHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4977"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4978"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4979"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-4980"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-4981"></a>                                          <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-4982"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-4983"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitFurnace: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-4984"></a>        <span class="n">ENDIF</span>
<a name="ln-4985"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-4986"></a>                   <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-4987"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-4988"></a><span class="k">          </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-4989"></a>          <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-4990"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-4991"></a>        <span class="k">END IF</span>
<a name="ln-4992"></a>
<a name="ln-4993"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-4994"></a>      <span class="c">! fill outlet node for coil</span>
<a name="ln-4995"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-4996"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-4997"></a>                       <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-4998"></a>      <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-4999"></a>    <span class="k">ELSE</span> <span class="c">! pthp not connected to plant</span>
<a name="ln-5000"></a>      <span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5001"></a>    <span class="n">ENDIF</span>
<a name="ln-5002"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyPlantInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5003"></a><span class="k">    </span><span class="n">MyPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5004"></a>  <span class="n">ENDIF</span>
<a name="ln-5005"></a>
<a name="ln-5006"></a>  <span class="c">! Scan Supplemental hot water and steam heating coil plant components for one time initializations</span>
<a name="ln-5007"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5008"></a><span class="k">    IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5009"></a>             <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5010"></a>
<a name="ln-5011"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5012"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5013"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5014"></a>                                          <span class="n">TypeOf_CoilWaterSimpleHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5015"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5016"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5017"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5018"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5019"></a>                                          <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-5020"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5021"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitFurnace: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-5022"></a>        <span class="n">ENDIF</span>
<a name="ln-5023"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5024"></a>                                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5025"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5026"></a><span class="k">            </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">)%</span><span class="n">FluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5027"></a>                                   <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5028"></a>                                   <span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">)%</span><span class="n">FluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5029"></a>                                   <span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-5030"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5031"></a>        <span class="k">END IF</span>
<a name="ln-5032"></a><span class="k">      </span><span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5033"></a><span class="k">        </span><span class="n">errFlag</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-5034"></a>        <span class="k">CALL </span><span class="n">ScanPlantLoopsForObject</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5035"></a>                                          <span class="n">TypeOf_CoilSteamAirHeating</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5036"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5037"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5038"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5039"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-5040"></a>                                          <span class="n">errFlag</span><span class="o">=</span><span class="n">errFlag</span><span class="p">)</span>
<a name="ln-5041"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">errFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5042"></a><span class="k">          CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;InitFurnace: Program terminated for previous conditions.&#39;</span><span class="p">)</span>
<a name="ln-5043"></a>        <span class="n">ENDIF</span>
<a name="ln-5044"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5045"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5046"></a><span class="k">          </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-5047"></a>          <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-5048"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-5049"></a>        <span class="k">END IF</span>
<a name="ln-5050"></a>
<a name="ln-5051"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-5052"></a>      <span class="c">! fill outlet node for coil</span>
<a name="ln-5053"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span> <span class="o">=</span>  <span class="p">&amp;</span>
<a name="ln-5054"></a>            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5055"></a>                       <span class="p">%</span><span class="n">Branch</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">)%</span><span class="n">Comp</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span><span class="p">)%</span><span class="n">NodeNumOut</span>
<a name="ln-5056"></a>      <span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5057"></a>    <span class="k">ELSE</span> <span class="c">! pthp not connected to plant</span>
<a name="ln-5058"></a>      <span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5059"></a>    <span class="n">ENDIF</span>
<a name="ln-5060"></a>
<a name="ln-5061"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">AnyPlantInModel</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5062"></a><span class="k">    </span><span class="n">MySuppCoilPlantScanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5063"></a>  <span class="n">ENDIF</span>
<a name="ln-5064"></a>
<a name="ln-5065"></a><span class="c">! Do the Begin Environment initializations</span>
<a name="ln-5066"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">BeginEnvrnFlag</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5067"></a>    <span class="c">!Change the Volume Flow Rates to Mass Flow Rates</span>
<a name="ln-5068"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-5069"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-5070"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">*</span>  <span class="n">StdRhoAir</span>
<a name="ln-5071"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">*</span> <span class="n">StdRhoAir</span>
<a name="ln-5072"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5073"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5074"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5075"></a>    <span class="k">END IF</span>
<a name="ln-5076"></a>
<a name="ln-5077"></a><span class="c">!   set fluid-side hardware limits</span>
<a name="ln-5078"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5079"></a>
<a name="ln-5080"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5081"></a>            <span class="c">! If water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-5082"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5083"></a><span class="k">                CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5084"></a>                                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)</span>
<a name="ln-5085"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5086"></a>                                                             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5087"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5088"></a><span class="k">                    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5089"></a>                                            <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5090"></a>                                            <span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5091"></a>                                            <span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-5092"></a>                    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5093"></a>                <span class="n">ENDIF</span>
<a name="ln-5094"></a>            <span class="n">ENDIF</span>
<a name="ln-5095"></a>            <span class="c">! If steam coil max steam flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-5096"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5097"></a><span class="k">                CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5098"></a>                                                <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-5099"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-5100"></a>                                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-5101"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5102"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5103"></a><span class="k">                   </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-5104"></a>                   <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-5105"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-5106"></a>                <span class="n">ENDIF</span>
<a name="ln-5107"></a>            <span class="n">ENDIF</span>
<a name="ln-5108"></a>        <span class="n">ENDIF</span>
<a name="ln-5109"></a>
<a name="ln-5110"></a>        <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5111"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5112"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5113"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5114"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5115"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5116"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-5117"></a>    <span class="n">ENDIF</span>
<a name="ln-5118"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5119"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5120"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5121"></a>                <span class="c">! If water coil max water flow rate is autosized, simulate once in order to mine max flow rate</span>
<a name="ln-5122"></a>                <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5123"></a>                                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">)</span>
<a name="ln-5124"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxWaterFlowRate</span><span class="p">(</span><span class="s1">&#39;Coil:Heating:Water&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5125"></a>                                                            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5126"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5127"></a><span class="k">                    </span><span class="n">rho</span> <span class="o">=</span> <span class="n">GetDensityGlycol</span><span class="p">(</span><span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">)%</span><span class="n">fluidName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5128"></a>                                        <span class="n">InitConvTemp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5129"></a>                                        <span class="n">PlantLoop</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">)%</span><span class="n">fluidIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5130"></a>                                        <span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-5131"></a>                    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">rho</span>
<a name="ln-5132"></a>                <span class="n">ENDIF</span>
<a name="ln-5133"></a>            <span class="n">ENDIF</span>
<a name="ln-5134"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5135"></a><span class="k">                CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5136"></a>                                                <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-5137"></a>                                                <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity</span>
<a name="ln-5138"></a>                                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-5139"></a>                <span class="n">CoilMaxVolFlowRate</span> <span class="o">=</span> <span class="n">GetCoilMaxSteamFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5140"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">CoilMaxVolFlowRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Autosize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5141"></a><span class="k">                </span><span class="n">SteamIndex</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! Function GetSatDensityRefrig will look up steam index if 0 is passed</span>
<a name="ln-5142"></a>                <span class="n">SteamDensity</span><span class="o">=</span><span class="n">GetSatDensityRefrig</span><span class="p">(</span><span class="s1">&#39;STEAM&#39;</span><span class="p">,</span><span class="n">TempSteamIn</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">SteamIndex</span><span class="p">,</span><span class="s1">&#39;InitFurnace&#39;</span><span class="p">)</span>
<a name="ln-5143"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span> <span class="o">=</span> <span class="n">CoilMaxVolFlowRate</span> <span class="o">*</span> <span class="n">SteamDensity</span>
<a name="ln-5144"></a>                <span class="n">ENDIF</span>
<a name="ln-5145"></a>            <span class="n">ENDIF</span>
<a name="ln-5146"></a>            <span class="k">Call </span><span class="n">InitComponentNodes</span><span class="p">(</span><span class="mf">0.d0</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5147"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5148"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5149"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5150"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5151"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5152"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span> <span class="p">)</span>
<a name="ln-5153"></a>        <span class="n">ENDIF</span>
<a name="ln-5154"></a>    <span class="n">ENDIF</span>
<a name="ln-5155"></a>    <span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5156"></a>  <span class="k">END IF</span>
<a name="ln-5157"></a>
<a name="ln-5158"></a><span class="k">  IF</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">BeginEnvrnFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5159"></a><span class="k">    </span><span class="n">MyEnvrnFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5160"></a>  <span class="n">ENDIF</span>
<a name="ln-5161"></a>
<a name="ln-5162"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">MyFanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5163"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">/=</span> <span class="n">Autosize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5164"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5165"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>
<a name="ln-5166"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>
<a name="ln-5167"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NoHeatCoolSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5168"></a>                                        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span>
<a name="ln-5169"></a>      <span class="k">END IF</span>
<a name="ln-5170"></a><span class="k">      IF</span><span class="p">(</span><span class="n">GetFanSpeedRatioCurveIndex</span><span class="p">(</span><span class="n">FanType</span><span class="p">,</span><span class="n">FanName</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5171"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5172"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5173"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5174"></a><span class="k">          CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5175"></a>                                <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5176"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...For fan type and name = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanType</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FanName</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-5177"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan power ratio function of speed ratio curve has no impact if fan volumetric &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5178"></a>                                 <span class="s1">&#39;flow rate is the same as the unitary system volumetric flow rate.&#39;</span><span class="p">)</span>
<a name="ln-5179"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Fan volumetric flow rate            = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5180"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s.&#39;</span><span class="p">)</span>
<a name="ln-5181"></a>          <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Unitary system volumetric flow rate = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5182"></a>                                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; m3/s.&#39;</span><span class="p">)</span>
<a name="ln-5183"></a>        <span class="k">END IF</span>
<a name="ln-5184"></a><span class="k">      END IF</span>
<a name="ln-5185"></a><span class="k">      </span><span class="n">MyFanFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5186"></a>    <span class="k">ELSE</span>
<a name="ln-5187"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualFanVolFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5188"></a>        <span class="n">GetFanDesignVolumeFlowRate</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Blank</span><span class="p">,</span><span class="n">ErrFlag</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">)</span>
<a name="ln-5189"></a>    <span class="k">END IF</span>
<a name="ln-5190"></a><span class="k">  END IF</span>
<a name="ln-5191"></a>
<a name="ln-5192"></a>  <span class="c">! Get the zone inlet node</span>
<a name="ln-5193"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5194"></a><span class="k">    DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfZones</span>
<a name="ln-5195"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">AirLoopNum</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirLoopNum</span><span class="p">)</span> <span class="k">CYCLE</span>
<a name="ln-5196"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">ActualZoneNum</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5197"></a><span class="k">        Do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-5198"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5199"></a><span class="k">            Do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-5200"></a>              <span class="k">If</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirDistUnitCool</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5201"></a><span class="k">                </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-5202"></a>                <span class="k">Exit</span>
<a name="ln-5203"></a><span class="k">              End If</span>
<a name="ln-5204"></a><span class="k">            end do</span>
<a name="ln-5205"></a><span class="k">          End If</span>
<a name="ln-5206"></a><span class="k">          If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5207"></a><span class="k">            Do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">NumInletNodes</span>
<a name="ln-5208"></a>              <span class="k">If</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">AirDistUnitHeat</span><span class="p">(</span><span class="n">k</span><span class="p">)%</span><span class="n">OutNode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5209"></a><span class="k">                </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">InletNode</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-5210"></a>                <span class="k">Exit</span>
<a name="ln-5211"></a><span class="k">              End If</span>
<a name="ln-5212"></a><span class="k">            End do</span>
<a name="ln-5213"></a><span class="k">          End If</span>
<a name="ln-5214"></a><span class="k">        End Do</span>
<a name="ln-5215"></a>        <span class="c">!setup furnace zone equipment sequence information based on finding an air terminal</span>
<a name="ln-5216"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5217"></a><span class="k">          DO </span><span class="n">EquipNum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">NumOfEquipTypes</span>
<a name="ln-5218"></a>            <span class="k">IF</span> <span class="p">((</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">==</span> <span class="n">AirDistUnit_Num</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5219"></a>                <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">EquipType_Num</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span> <span class="o">==</span> <span class="n">DirectAir_Num</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5220"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5221"></a>                         <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">CoolingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-5222"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5223"></a>                         <span class="n">ZoneEquipList</span><span class="p">(</span><span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">i</span><span class="p">)%</span><span class="n">EquipListIndex</span><span class="p">)%</span><span class="n">HeatingPriority</span><span class="p">(</span><span class="n">EquipNum</span><span class="p">)</span>
<a name="ln-5224"></a>            <span class="n">ENDIF</span>
<a name="ln-5225"></a>          <span class="n">ENDDO</span>
<a name="ln-5226"></a>        <span class="n">ENDIF</span>
<a name="ln-5227"></a>      <span class="k">END IF</span>
<a name="ln-5228"></a><span class="k">    END DO</span>
<a name="ln-5229"></a><span class="k">    </span><span class="n">MyCheckFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5230"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5231"></a><span class="k">      CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5232"></a>                             <span class="s1">&#39;&quot;: The zone inlet node in the controlled zone (&#39;</span> <span class="p">&amp;</span>
<a name="ln-5233"></a>                            <span class="o">//</span><span class="nb">Trim</span><span class="p">(</span><span class="n">Zone</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span> <span class="o">//</span><span class="s1">&#39;) is not found.&#39;</span><span class="p">)</span>
<a name="ln-5234"></a>      <span class="k">CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;Subroutine InitFurnace: &#39;</span><span class="o">//</span><span class="s1">&#39;Errors found in getting &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5235"></a>           <span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; input.  &#39;</span><span class="o">//</span><span class="s1">&#39;Preceding condition(s) causes termination.&#39;</span><span class="p">)</span>
<a name="ln-5236"></a>    <span class="k">End If</span>
<a name="ln-5237"></a><span class="k">  END IF</span>
<a name="ln-5238"></a>
<a name="ln-5239"></a>  <span class="c">! Find the number of zones (zone Inlet Nodes) attached to an air loop from the air loop number</span>
<a name="ln-5240"></a>  <span class="n">NumAirLoopZones</span> <span class="o">=</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesCooled</span> <span class="o">+</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesHeated</span>
<a name="ln-5241"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5242"></a><span class="k">      </span><span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5243"></a>      <span class="n">ZonesLoop</span><span class="p">:</span> <span class="k">DO </span><span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAirLoopZones</span>
<a name="ln-5244"></a>        <span class="c">! zone inlet nodes for cooling</span>
<a name="ln-5245"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesCooled</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5246"></a><span class="k">           IF</span><span class="p">(</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitCoolInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-5247"></a>               <span class="c">! the data structure for the zones inlet nodes has not been filled</span>
<a name="ln-5248"></a>               <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5249"></a>           <span class="n">ENDIF</span>
<a name="ln-5250"></a>        <span class="n">ENDIF</span>
<a name="ln-5251"></a>        <span class="c">! zone inlet nodes for heating</span>
<a name="ln-5252"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">NumZonesHeated</span>  <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5253"></a><span class="k">           IF</span><span class="p">(</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitHeatInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5254"></a>               <span class="c">! the data structure for the zones inlet nodes has not been filled</span>
<a name="ln-5255"></a>               <span class="n">FlowFracFlagReady</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5256"></a>           <span class="n">ENDIF</span>
<a name="ln-5257"></a>        <span class="n">ENDIF</span>
<a name="ln-5258"></a>      <span class="k">END DO </span><span class="n">ZonesLoop</span>
<a name="ln-5259"></a>  <span class="n">ENDIF</span>
<a name="ln-5260"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">ALLOCATED</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">FlowFracFlagReady</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5261"></a><span class="k">      </span><span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! initialize the sum of the maximum flows</span>
<a name="ln-5262"></a>      <span class="k">DO </span><span class="n">ZoneInSysIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">NumAirLoopZones</span>
<a name="ln-5263"></a>         <span class="n">ZoneInletNodeNum</span> <span class="o">=</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">TermUnitCoolInletNodes</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span>
<a name="ln-5264"></a>         <span class="n">SumOfMassFlowRateMax</span> <span class="o">=</span> <span class="n">SumOfMassFlowRateMax</span> <span class="o">+</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-5265"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">CoolCtrlZoneNums</span><span class="p">(</span><span class="n">ZoneInSysIndex</span><span class="p">)</span> <span class="o">==</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-5266"></a><span class="k">            </span><span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMax</span>
<a name="ln-5267"></a>         <span class="n">ENDIF</span>
<a name="ln-5268"></a>      <span class="k">END DO</span>
<a name="ln-5269"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">SumOfMassFlowRateMax</span> <span class="o">/=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5270"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5271"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="o">=</span> <span class="n">CntrlZoneTerminalUnitMassFlowRateMax</span><span class="o">/</span><span class="n">SumOfMassFlowRateMax</span>
<a name="ln-5272"></a>          <span class="k">ELSE</span>
<a name="ln-5273"></a><span class="k">              CALL </span><span class="n">ShowSevereError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5274"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The Fraction of Supply Air Flow That Goes Through the Controlling Zone is set to 1.&#39;</span><span class="p">)</span>
<a name="ln-5275"></a>          <span class="k">END IF</span>
<a name="ln-5276"></a><span class="k">          CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5277"></a>                                  <span class="s1">&#39;Fraction of Supply Air Flow That Goes Through the Controlling Zone&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5278"></a>                                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span>
<a name="ln-5279"></a>          <span class="n">MyFlowFracFlag</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5280"></a>      <span class="n">ENDIF</span>
<a name="ln-5281"></a>  <span class="n">ENDIF</span>
<a name="ln-5282"></a>
<a name="ln-5283"></a>  <span class="c">! Calcuate air distribution losses</span>
<a name="ln-5284"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopPass</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5285"></a><span class="k">    </span><span class="n">ZoneInNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneInletNode</span>
<a name="ln-5286"></a>    <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-5287"></a>    <span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5288"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5289"></a>      <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-5290"></a>    <span class="k">If</span> <span class="p">(</span><span class="n">SimulateAirflowNetwork</span> <span class="o">&gt;</span> <span class="n">AirflowNetworkControlMultizone</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5291"></a><span class="k">      </span><span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowrate</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5292"></a>                    <span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">MassFlowrate</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5293"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">DeltaMassRate</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5294"></a>    <span class="k">Else</span>
<a name="ln-5295"></a><span class="k">      </span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">MassFlowrate</span>
<a name="ln-5296"></a>      <span class="n">DeltaMassRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5297"></a>    <span class="k">End If</span>
<a name="ln-5298"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="n">MassFlowRate</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5299"></a>       <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span> <span class="o">+</span> <span class="n">DeltaMassRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5300"></a>      <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5301"></a>       <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span>
<a name="ln-5302"></a>    <span class="k">If</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5303"></a><span class="k">      If</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-5304"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5305"></a>    <span class="k">End If</span>
<a name="ln-5306"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5307"></a><span class="k">      </span><span class="n">MaxTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-5308"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="n">MassFlowRate</span><span class="o">*</span><span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span><span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5309"></a>        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">ZoneInNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span> <span class="o">+</span> <span class="n">DeltaMassRate</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-5310"></a>        <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-5311"></a>        <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span>
<a name="ln-5312"></a>      <span class="k">If</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-5313"></a><span class="k">        If</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001d0</span><span class="p">)</span>   <span class="p">&amp;</span>
<a name="ln-5314"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5315"></a>      <span class="k">End If</span>
<a name="ln-5316"></a><span class="k">    End If</span>
<a name="ln-5317"></a><span class="k">  End If</span>
<a name="ln-5318"></a>
<a name="ln-5319"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5320"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5321"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">CycFanCycCoil</span>
<a name="ln-5322"></a>    <span class="k">ELSE</span>
<a name="ln-5323"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">ContFanCycCoil</span>
<a name="ln-5324"></a>    <span class="k">END IF</span>
<a name="ln-5325"></a><span class="k">  END IF</span>
<a name="ln-5326"></a>
<a name="ln-5327"></a><span class="k">  </span><span class="n">OpMode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-5328"></a>  <span class="n">EconomizerFlag</span> <span class="o">=</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">EconoActive</span>
<a name="ln-5329"></a>
<a name="ln-5330"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5331"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5332"></a>    <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5333"></a>    <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-5334"></a>  <span class="k">ELSE</span>
<a name="ln-5335"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-5336"></a>  <span class="k">END IF</span>
<a name="ln-5337"></a>
<a name="ln-5338"></a><span class="c">! Original thermostat control logic (works only for cycling fan systems)</span>
<a name="ln-5339"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5340"></a>     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5341"></a><span class="k">    </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5342"></a>    <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5343"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span> <span class="o">*</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">QZnReq</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5344"></a>    <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5345"></a><span class="k">    </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5346"></a>    <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5347"></a>  <span class="k">ELSE</span>
<a name="ln-5348"></a><span class="k">    </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5349"></a>    <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5350"></a>  <span class="k">END IF</span>
<a name="ln-5351"></a>
<a name="ln-5352"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span>   <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5353"></a>     <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5354"></a>      <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>   <span class="p">&amp;</span>
<a name="ln-5355"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_VarSpeedEquationFit</span><span class="p">)</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5356"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5357"></a><span class="k">         </span><span class="n">HPDehumidificationLoadFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5358"></a>         <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5359"></a>         <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5360"></a>      <span class="k">ELSE</span>
<a name="ln-5361"></a><span class="k">         </span><span class="n">HPDehumidificationLoadFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5362"></a>      <span class="n">ENDIF</span>
<a name="ln-5363"></a>  <span class="n">ENDIF</span>
<a name="ln-5364"></a>
<a name="ln-5365"></a><span class="c">! Check for heat only furnace</span>
<a name="ln-5366"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace_HeatOnly</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5367"></a>     <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySys_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5368"></a>
<a name="ln-5369"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5370"></a><span class="k">      IF</span> <span class="p">(</span> <span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5371"></a>           <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5372"></a><span class="k">        </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5373"></a>      <span class="k">ELSE</span>
<a name="ln-5374"></a><span class="k">        </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5375"></a>      <span class="k">END IF</span>
<a name="ln-5376"></a><span class="k">    ELSE</span>
<a name="ln-5377"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5378"></a>    <span class="k">END IF</span>
<a name="ln-5379"></a><span class="k">  ELSE</span>
<a name="ln-5380"></a><span class="k">    </span><span class="n">PartLoadRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-5381"></a>  <span class="k">END IF</span>
<a name="ln-5382"></a>
<a name="ln-5383"></a>  <span class="c">! get current time step operating capacity of water and steam coils</span>
<a name="ln-5384"></a>  <span class="c">! (dependent on entering water and steam temperature)</span>
<a name="ln-5385"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5386"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5387"></a>      <span class="c">! set water-side mass flow rates</span>
<a name="ln-5388"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-5389"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span>
<a name="ln-5390"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5391"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5392"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5393"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5394"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5395"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5396"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-5397"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-5398"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5399"></a>                                       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-5400"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-5401"></a>
<a name="ln-5402"></a>    <span class="k">END IF</span> <span class="c">! from IF(Furnace(FurnaceNum)%HeatingCoilType_Num == Coil_HeatingWater) THEN</span>
<a name="ln-5403"></a>
<a name="ln-5404"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5405"></a>      <span class="c">! set air-side and steam-side mass flow rates</span>
<a name="ln-5406"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HWCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-5407"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span>
<a name="ln-5408"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5409"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5410"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5411"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5412"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5413"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5414"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span> <span class="p">)</span>
<a name="ln-5415"></a>
<a name="ln-5416"></a>      <span class="c">!     simulate steam coil to find operating capacity</span>
<a name="ln-5417"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5418"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-5419"></a>                                       <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-5420"></a>                                       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-5421"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">GetSteamCoilCapacity</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5422"></a>                                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5423"></a>
<a name="ln-5424"></a>    <span class="k">END IF</span> <span class="c">! from IF(Furnace(FurnaceNum)%HeatingCoilType_Num == Coil_HeatingSteam) THEN</span>
<a name="ln-5425"></a>
<a name="ln-5426"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWater</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5427"></a>
<a name="ln-5428"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-5429"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-5430"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span>
<a name="ln-5431"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5432"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5433"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5434"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5435"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5436"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5437"></a>                                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span> <span class="p">)</span>
<a name="ln-5438"></a>
<a name="ln-5439"></a>      <span class="c">!     simulate water coil to find operating capacity</span>
<a name="ln-5440"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5441"></a>                                       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-5442"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-5443"></a>
<a name="ln-5444"></a>    <span class="k">END IF</span> <span class="c">! from IF(Furnace(FurnaceNum)%SuppHeatCoilType_Num == Coil_HeatingWater) THEN</span>
<a name="ln-5445"></a>    <span class="c">!</span>
<a name="ln-5446"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingSteam</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5447"></a>      <span class="c">!     set air-side and steam-side mass flow rates</span>
<a name="ln-5448"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilAirInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-5449"></a>      <span class="n">mdot</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span>
<a name="ln-5450"></a>      <span class="k">CALL </span><span class="n">SetComponentFlowRate</span><span class="p">(</span><span class="n">mdot</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5451"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5452"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5453"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5454"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5455"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5456"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span> <span class="p">)</span>
<a name="ln-5457"></a>
<a name="ln-5458"></a><span class="c">!     simulate steam coil to find operating capacity</span>
<a name="ln-5459"></a>      <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5460"></a>                                       <span class="n">FirstHVACIteration</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-5461"></a>                                       <span class="mf">1.0d0</span><span class="p">,</span> <span class="p">&amp;</span> <span class="c">!QCoilReq, simulate any load &gt; 0 to get max capacity of steam coil</span>
<a name="ln-5462"></a>                                       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-5463"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5464"></a>          <span class="n">GetSteamCoilCapacity</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">ErrorsFound</span><span class="p">)</span>
<a name="ln-5465"></a>
<a name="ln-5466"></a>    <span class="k">END IF</span> <span class="c">! from IF(Furnace(FurnaceNum)%SuppHeatCoilType_Num == Coil_HeatingSteam) THEN</span>
<a name="ln-5467"></a>  <span class="k">END IF</span> <span class="c">! from IF( FirstHVACIteration ) THEN</span>
<a name="ln-5468"></a>
<a name="ln-5469"></a>  <span class="k">IF</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="p">)</span> <span class="k">THEN</span> <span class="c">!BoS, variable-speed water source hp</span>
<a name="ln-5470"></a>    <span class="c">!Furnace(FurnaceNum)%IdleMassFlowRate = RhoAir*Furnace(FurnaceNum)%IdleVolumeAirRate</span>
<a name="ln-5471"></a>      <span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-5472"></a>      <span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-5473"></a>    <span class="c">! IF MSHP system was not autosized and the fan is autosized, check that fan volumetric flow rate is greater than MSHP flow rates</span>
<a name="ln-5474"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CheckFanFlow</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5475"></a><span class="k">        </span><span class="n">CurrentModuleObject</span> <span class="o">=</span> <span class="s1">&#39;AirLoopHVAC:UnitaryHeatPump:VariableSpeed&#39;</span>
<a name="ln-5476"></a>        <span class="k">CALL </span><span class="n">GetFanVolFlow</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">)</span>
<a name="ln-5477"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">AutoSize</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5478"></a>    <span class="c">!     Check fan versus system supply air flow rates</span>
<a name="ln-5479"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="o">+</span> <span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">10</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5480"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5481"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5482"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span> <span class="p">&amp;</span>
<a name="ln-5483"></a>                            <span class="o">//</span><span class="s1">&#39; is less than the MSHP system air flow rate&#39;</span> <span class="p">&amp;</span>
<a name="ln-5484"></a>                            <span class="o">//</span><span class="s1">&#39; when cooling is required (&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5485"></a>            <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-5486"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when cooling is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-5487"></a>                                  <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-5488"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5489"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-5490"></a>            <span class="c">! Check flow rates in other speeds and ensure flow rates are not above the max flow rate</span>
<a name="ln-5491"></a>            <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="n">NumOfSpeedCooling</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5492"></a>              <span class="k">If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-5493"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when cooling is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-5494"></a>                     <span class="o">//</span><span class="s1">&#39; flow rate at higher speed and the simulation continues at Speed&#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-5495"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5496"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5497"></a>              <span class="k">End If</span>
<a name="ln-5498"></a><span class="k">            End Do</span>
<a name="ln-5499"></a><span class="k">          END IF</span>
<a name="ln-5500"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="o">+</span> <span class="mi">1</span><span class="n">d</span><span class="o">-</span><span class="mi">10</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5501"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5502"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5503"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span> <span class="p">&amp;</span>
<a name="ln-5504"></a>                            <span class="o">//</span><span class="s1">&#39; is less than the MSHP system air flow rate&#39;</span> <span class="p">&amp;</span>
<a name="ln-5505"></a>                            <span class="o">//</span><span class="s1">&#39; when heating is required (&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-5506"></a>              <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">),</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-5507"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when heating is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-5508"></a>                                  <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-5509"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5510"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-5511"></a>            <span class="k">Do </span><span class="n">i</span><span class="o">=</span><span class="n">NumOfSpeedHeating</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-5512"></a>              <span class="k">If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-5513"></a><span class="k">                CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when heating is required is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-5514"></a>                     <span class="o">//</span><span class="s1">&#39; flow rate at higher speed and the simulation continues at Speed&#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-5515"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; system = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5516"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-5517"></a>              <span class="k">End If</span>
<a name="ln-5518"></a><span class="k">            End Do</span>
<a name="ln-5519"></a><span class="k">          END IF</span>
<a name="ln-5520"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5521"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5522"></a><span class="k">            CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; - air flow rate = &#39;</span> <span class="p">&amp;</span>
<a name="ln-5523"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; in fan object &#39;</span> <span class="p">&amp;</span>
<a name="ln-5524"></a>                       <span class="o">//</span><span class="s1">&#39; is less than the MSHP system air flow rate when no &#39;</span> <span class="p">&amp;</span>
<a name="ln-5525"></a>                       <span class="o">//</span><span class="s1">&#39;heating or cooling is needed (&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;).&#39;</span><span class="p">)</span>
<a name="ln-5526"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; The MSHP system flow rate when no heating or cooling is needed is reset to the&#39;</span> <span class="p">&amp;</span>
<a name="ln-5527"></a>                                  <span class="o">//</span><span class="s1">&#39; fan flow rate and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-5528"></a>            <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39; Occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">CurrentModuleObject</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-5529"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-5530"></a>          <span class="k">END IF</span>
<a name="ln-5531"></a><span class="k">          </span><span class="n">RhoAir</span> <span class="o">=</span> <span class="n">StdRhoAir</span>
<a name="ln-5532"></a>          <span class="c">! set the mass flow rates from the reset volume flow rates</span>
<a name="ln-5533"></a>          <span class="k">Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-5534"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-5535"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5536"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5537"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-5538"></a>            <span class="k">END IF</span>
<a name="ln-5539"></a><span class="k">          End Do</span>
<a name="ln-5540"></a><span class="k">          Do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-5541"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-5542"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5543"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5544"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-5545"></a>            <span class="k">END IF</span>
<a name="ln-5546"></a><span class="k">          End Do</span>
<a name="ln-5547"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="n">RhoAir</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span>
<a name="ln-5548"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5549"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-5550"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">/</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanVolFlow</span>
<a name="ln-5551"></a>          <span class="k">END IF</span>
<a name="ln-5552"></a>          <span class="c">! set the node max and min mass flow rates based on reset volume flow rates</span>
<a name="ln-5553"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMax</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5554"></a>                                             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-5555"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedCooling</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-5556"></a>                                                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">NumOfSpeedHeating</span><span class="p">))</span>
<a name="ln-5557"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMin</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5558"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRateMinAvail</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5559"></a>          <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)</span>
<a name="ln-5560"></a>        <span class="k">END IF</span>
<a name="ln-5561"></a><span class="k">      END IF</span>
<a name="ln-5562"></a>
<a name="ln-5563"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CheckFanFlow</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5564"></a>
<a name="ln-5565"></a>    <span class="c">! CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5566"></a>    <span class="c">!        AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5567"></a>    <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5568"></a>  <span class="k">ELSE</span>
<a name="ln-5569"></a><span class="k">    CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5570"></a>  <span class="k">END IF</span>
<a name="ln-5571"></a>
<a name="ln-5572"></a>
<a name="ln-5573"></a><span class="c">! Check ventilation/fan load for constant fan systems to see if load to be met changes</span>
<a name="ln-5574"></a><span class="c">! Same IF logic used in Subroutine SetAverageAirFlow to determine if unit is ON or OFF</span>
<a name="ln-5575"></a>
<a name="ln-5576"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5577"></a>     <span class="p">(</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TurnFansOn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-5578"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">TurnFansOff</span><span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-5579"></a>
<a name="ln-5580"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5581"></a><span class="k">        CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SensibleOutput</span><span class="p">,</span><span class="n">LatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5582"></a>                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SUPHEATERLOAD</span><span class="p">)</span>
<a name="ln-5583"></a>    <span class="k">ELSE</span>
<a name="ln-5584"></a><span class="k">        CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="mi">0</span><span class="p">,</span><span class="n">Off</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SensibleOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-5585"></a>           <span class="n">LatentOutput</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-5586"></a>    <span class="k">END IF</span>
<a name="ln-5587"></a>
<a name="ln-5588"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5589"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5590"></a><span class="k">        </span><span class="n">QToCoolSetPt</span><span class="o">=</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5591"></a>                       <span class="n">SequencedOutputRequiredToCoolingSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceCoolingNum</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5592"></a>                       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5593"></a>        <span class="n">QToHeatSetPt</span><span class="o">=</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-5594"></a>                       <span class="n">SequencedOutputRequiredToHeatingSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5595"></a>                       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5596"></a>      <span class="k">ELSE</span>
<a name="ln-5597"></a><span class="k">        </span><span class="n">QToCoolSetPt</span><span class="o">=</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToCoolingSP</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5598"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5599"></a>        <span class="n">QToHeatSetPt</span><span class="o">=</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToHeatingSP</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-5600"></a>                   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span>
<a name="ln-5601"></a>      <span class="n">ENDIF</span>
<a name="ln-5602"></a><span class="c">!     If the furnace has a net cooling capacity (SensibleOutput &lt; 0) and</span>
<a name="ln-5603"></a><span class="c">!     the zone temp is above the Tstat heating setpoint (QToHeatSetPt &lt; 0) and</span>
<a name="ln-5604"></a><span class="c">!     the net cooling capacity does not just offset the cooling load</span>
<a name="ln-5605"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5606"></a>         <span class="nb">ABS</span><span class="p">(</span><span class="n">QToCoolSetPt</span> <span class="o">-</span> <span class="n">SensibleOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5607"></a><span class="c">!       Only switch modes when humidistat is not used or no moisture load exists, otherwise let</span>
<a name="ln-5608"></a><span class="c">!       reheat coil pick up load</span>
<a name="ln-5609"></a><span class="c">!        IF((SensibleOutput .LT. QToHeatSetPt .AND. .NOT. Furnace(FurnaceNum)%Humidistat) .OR. &amp;</span>
<a name="ln-5610"></a><span class="c">!           (SensibleOutput .LT. QToHeatSetPt .AND. Furnace(FurnaceNum)%Humidistat .AND. MoistureLoad .GE. 0.0))THEN</span>
<a name="ln-5611"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5612"></a>           <span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5613"></a><span class="k">          </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">QToHeatSetPt</span>
<a name="ln-5614"></a>          <span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5615"></a><span class="c">!         Don&#39;t set mode TRUE unless mode is allowed. Also check for floating zone.</span>
<a name="ln-5616"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SingleCoolingSetPoint</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5617"></a>             <span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5618"></a><span class="k">            </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5619"></a>          <span class="k">ELSE</span>
<a name="ln-5620"></a><span class="k">            </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5621"></a>          <span class="k">END IF</span>
<a name="ln-5622"></a>
<a name="ln-5623"></a><span class="k">         IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5624"></a>           <span class="c">!CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5625"></a>           <span class="c">!         AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5626"></a>           <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5627"></a>           <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SensibleOutput</span><span class="p">,</span><span class="n">LatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5628"></a>                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SUPHEATERLOAD</span><span class="p">)</span>
<a name="ln-5629"></a>         <span class="k">ELSE</span>
<a name="ln-5630"></a><span class="k">          CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5631"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="mi">0</span><span class="p">,</span><span class="n">Off</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SensibleOutput</span><span class="p">,</span><span class="n">LatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5632"></a>                                 <span class="n">OnOffAirFlowRatio</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-5633"></a>         <span class="k">END IF</span>
<a name="ln-5634"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">QToHeatSetPt</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5635"></a><span class="c">!           If changing operating mode (flow rates) does not overshoot heating setpoint, turn off heating</span>
<a name="ln-5636"></a>            <span class="n">QZnReq</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5637"></a>            <span class="n">HeatingLoad</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5638"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5639"></a><span class="k">                CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5640"></a><span class="c">!               CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5641"></a><span class="c">!                    AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5642"></a>            <span class="k">ELSE</span>
<a name="ln-5643"></a><span class="k">              CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5644"></a>            <span class="k">END IF</span>
<a name="ln-5645"></a><span class="k">          END IF</span>
<a name="ln-5646"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">QZnReq</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5647"></a><span class="c">!         If the net cooling capacity meets the zone cooling load but does not overshoot heating setpoint, turn off cooling</span>
<a name="ln-5648"></a><span class="c">!         (dehumidification may still occur)</span>
<a name="ln-5649"></a>          <span class="n">QZnReq</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5650"></a>          <span class="n">CoolingLoad</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5651"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">HPDehumidificationLoadFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5652"></a><span class="k">             </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5653"></a>             <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5654"></a>           <span class="n">ENDIF</span>
<a name="ln-5655"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5656"></a><span class="k">                CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5657"></a>                    <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5658"></a><span class="c">!               CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5659"></a><span class="c">!                    AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5660"></a>           <span class="k">ELSE</span>
<a name="ln-5661"></a><span class="k">               CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5662"></a>           <span class="k">END IF</span>
<a name="ln-5663"></a><span class="k">        END IF</span>
<a name="ln-5664"></a><span class="c">!     the net cooling capacity just offsets the cooling load, turn off cooling</span>
<a name="ln-5665"></a>      <span class="k">ELSE IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5666"></a>              <span class="nb">ABS</span><span class="p">(</span><span class="n">QToCoolSetPt</span> <span class="o">-</span> <span class="n">SensibleOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5667"></a><span class="k">        </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5668"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">HPDehumidificationLoadFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5669"></a><span class="k">            </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5670"></a>            <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5671"></a>         <span class="n">ENDIF</span>
<a name="ln-5672"></a>      <span class="k">END IF</span> <span class="c">! SensibleOutput .LT. 0.0d0 .AND. QToHeatSetPt .LT. 0.0d0</span>
<a name="ln-5673"></a>
<a name="ln-5674"></a><span class="c">!     If the furnace has a net heating capacity and the zone temp is below the Tstat cooling setpoint and</span>
<a name="ln-5675"></a><span class="c">!     the net heating capacity does not just offset the heating load</span>
<a name="ln-5676"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToCoolSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5677"></a>         <span class="nb">ABS</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="o">-</span> <span class="n">QToHeatSetPt</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="p">(</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5678"></a><span class="k">        IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">QToCoolSetPt</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5679"></a><span class="k">          </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">QToCoolSetPt</span>
<a name="ln-5680"></a><span class="c">!         Don&#39;t set mode TRUE unless mode is allowed. Also check for floating zone.</span>
<a name="ln-5681"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">SingleHeatingSetPoint</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5682"></a>             <span class="n">TempControlType</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5683"></a><span class="k">            </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5684"></a>          <span class="k">ELSE</span>
<a name="ln-5685"></a><span class="k">            </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5686"></a>          <span class="k">END IF</span>
<a name="ln-5687"></a><span class="k">          </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5688"></a>
<a name="ln-5689"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5690"></a><span class="k">            CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5691"></a>             <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5692"></a><span class="c">!           CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5693"></a><span class="c">!                    AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5694"></a>           <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="n">off</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SensibleOutput</span><span class="p">,</span><span class="n">LatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5695"></a>                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">SUPHEATERLOAD</span><span class="p">)</span>
<a name="ln-5696"></a>         <span class="k">ELSE</span>
<a name="ln-5697"></a><span class="k">          CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5698"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.,</span><span class="mi">0</span><span class="p">,</span><span class="n">Off</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SensibleOutput</span><span class="p">,</span><span class="n">LatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5699"></a>                                 <span class="n">OnOffAirFlowRatio</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-5700"></a>         <span class="k">END IF</span>
<a name="ln-5701"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">QToCoolSetPt</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5702"></a><span class="c">!           If changing operating mode (flow rates) does not overshoot cooling setpoint, turn off cooling</span>
<a name="ln-5703"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">HPDehumidificationLoadFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5704"></a><span class="k">                </span><span class="n">CoolingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-5705"></a>                <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5706"></a>            <span class="k">ELSE</span>
<a name="ln-5707"></a><span class="k">                </span><span class="n">QZnReq</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5708"></a>                <span class="n">CoolingLoad</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5709"></a>            <span class="n">ENDIF</span>
<a name="ln-5710"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5711"></a><span class="k">                CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5712"></a>                    <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5713"></a><span class="c">!               CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5714"></a><span class="c">!                     AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5715"></a>            <span class="k">ELSE</span>
<a name="ln-5716"></a><span class="k">             CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5717"></a>            <span class="k">END IF</span>
<a name="ln-5718"></a><span class="k">          END IF</span>
<a name="ln-5719"></a><span class="k">        ELSE IF</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">QZnReq</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5720"></a><span class="c">!         If the net heating capacity meets the zone heating load but does not overshoot, turn off heating</span>
<a name="ln-5721"></a>          <span class="n">QZnReq</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5722"></a>          <span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5723"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5724"></a><span class="c">!            CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5725"></a><span class="c">!                        AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5726"></a>            <span class="k">CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5727"></a>                 <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5728"></a>          <span class="k">ELSE</span>
<a name="ln-5729"></a><span class="k">            CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5730"></a>          <span class="k">END IF</span>
<a name="ln-5731"></a><span class="k">        END IF</span>
<a name="ln-5732"></a><span class="c">!     the net heating capacity just offsets the heating load, turn off heating</span>
<a name="ln-5733"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SensibleOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-5734"></a>               <span class="nb">ABS</span><span class="p">(</span><span class="n">SensibleOutput</span> <span class="o">-</span> <span class="n">QToHeatSetPt</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="n">Small5WLoad</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-5735"></a><span class="k">        </span><span class="n">HeatingLoad</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-5736"></a>      <span class="k">END IF</span> <span class="c">! SensibleOutput .GT. 0.0d0 .AND. QToCoolSetPt .GT. 0.0d0</span>
<a name="ln-5737"></a>    <span class="k">END IF</span> <span class="c">! Furnace(FurnaceNum)%ControlZoneMassFlowFrac .GT. 0.0d0</span>
<a name="ln-5738"></a>    <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-5739"></a>  <span class="k">END IF</span> <span class="c">! OpMode .EQ. ContFanCycCoil</span>
<a name="ln-5740"></a>
<a name="ln-5741"></a>  <span class="c">! EMS override point</span>
<a name="ln-5742"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideSensZoneLoadRequest</span><span class="p">)</span> <span class="n">ZoneLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSSensibleZoneLoadValue</span>
<a name="ln-5743"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideMoistZoneLoadRequest</span><span class="p">)</span> <span class="n">MoistureLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSMoistureZoneLoadValue</span>
<a name="ln-5744"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideSensZoneLoadRequest</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideMoistZoneLoadRequest</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5745"></a><span class="k">    IF</span> <span class="p">((</span><span class="n">ZoneLoad</span> <span class="o">/=</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideSensZoneLoadRequest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5746"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-5747"></a>    <span class="n">ELSEIF</span> <span class="p">((</span><span class="n">MoistureLoad</span> <span class="o">/=</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">EMSOverrideMoistZoneLoadRequest</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-5748"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0D0</span>
<a name="ln-5749"></a>    <span class="k">ELSE</span>
<a name="ln-5750"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0D0</span>
<a name="ln-5751"></a>    <span class="n">ENDIF</span>
<a name="ln-5752"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5753"></a><span class="k">        CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-5754"></a>         <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5755"></a><span class="c">!       CALL SetOnOffMassFlowRateVSCoil(FurnaceNum, Furnace(FurnaceNum)%ControlZoneNum, FirstHVACIteration, &amp;</span>
<a name="ln-5756"></a><span class="c">!                AirLoopNum, OnOffAirFlowRatio, OpMode, QZnReq, MoistureLoad, PartLoadRatio)</span>
<a name="ln-5757"></a>    <span class="k">ELSE</span>
<a name="ln-5758"></a><span class="k">       CALL </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5759"></a>    <span class="k">END IF</span>
<a name="ln-5760"></a><span class="k">  </span><span class="n">ENDIF</span>
<a name="ln-5761"></a>
<a name="ln-5762"></a>
<a name="ln-5763"></a><span class="c">! AirflowNetwork global variable</span>
<a name="ln-5764"></a>  <span class="n">LoopHeatingCoilMaxRTF</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5765"></a>  <span class="k">RETURN</span>
<a name="ln-5766"></a>
<a name="ln-5767"></a><span class="k">END SUBROUTINE </span><span class="n">InitFurnace</span>
<a name="ln-5768"></a>
<a name="ln-5769"></a><span class="k">SUBROUTINE </span><span class="n">SetOnOffMassFlowRate</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span> <span class="n">ZoneLoad</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-5770"></a>
<a name="ln-5771"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5772"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-5773"></a>          <span class="c">!       DATE WRITTEN   Sep 2008</span>
<a name="ln-5774"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-5775"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5776"></a>
<a name="ln-5777"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5778"></a>          <span class="c">! This subroutine is for initializations of the Furnace Components.</span>
<a name="ln-5779"></a>
<a name="ln-5780"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5781"></a>          <span class="c">! The HeatCool furnace/unitarysystem and air-to-air heat pump may have alternate air flow rates</span>
<a name="ln-5782"></a>          <span class="c">! in cooling, heating, and when no cooling or heating is needed. Set up the coil (comp) ON and OFF</span>
<a name="ln-5783"></a>          <span class="c">! air flow rates. Use these flow rates during the Calc routines to set the average mass flow rates</span>
<a name="ln-5784"></a>          <span class="c">! based on PLR.</span>
<a name="ln-5785"></a>
<a name="ln-5786"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5787"></a>          <span class="c">! na</span>
<a name="ln-5788"></a>
<a name="ln-5789"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5790"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-5791"></a>
<a name="ln-5792"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5793"></a>
<a name="ln-5794"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5795"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>        <span class="c">! index to furnace</span>
<a name="ln-5796"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirLoopNum</span>        <span class="c">! index to air loop !unused1208</span>
<a name="ln-5797"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! ratio of coil on to coil off air flow rate</span>
<a name="ln-5798"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OpMode</span>            <span class="c">! fan operating mode</span>
<a name="ln-5799"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneLoad</span>          <span class="c">! sensible load to be met (W) !unused1208</span>
<a name="ln-5800"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MoistureLoad</span>      <span class="c">! moisture load to be met (W)</span>
<a name="ln-5801"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>     <span class="c">! coil part-load ratio</span>
<a name="ln-5802"></a>
<a name="ln-5803"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5804"></a>          <span class="c">! na</span>
<a name="ln-5805"></a>
<a name="ln-5806"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5807"></a>          <span class="c">! na</span>
<a name="ln-5808"></a>
<a name="ln-5809"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5810"></a>          <span class="c">! na</span>
<a name="ln-5811"></a>
<a name="ln-5812"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5813"></a>          <span class="c">! na</span>
<a name="ln-5814"></a>
<a name="ln-5815"></a>          <span class="c">! FLOW:</span>
<a name="ln-5816"></a><span class="c">! Check for heat only furnace</span>
<a name="ln-5817"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">Furnace_HeatOnly</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5818"></a>     <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySys_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5819"></a>
<a name="ln-5820"></a>    <span class="c">! Set the system mass flow rates</span>
<a name="ln-5821"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5822"></a>    <span class="c">! Set the compressor or coil ON mass flow rate</span>
<a name="ln-5823"></a>    <span class="c">! constant fan mode</span>
<a name="ln-5824"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">HeatingLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5825"></a><span class="c">!       IF a heating and moisture load exists, operate at the cooling mass flow rate ELSE operate at the heating flow rate</span>
<a name="ln-5826"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5827"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5828"></a><span class="k">          </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5829"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5830"></a>        <span class="k">ELSE</span>
<a name="ln-5831"></a><span class="k">          </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-5832"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5833"></a>        <span class="k">END IF</span>
<a name="ln-5834"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-5835"></a><span class="c">!     IF a cooling load exists, operate at the cooling mass flow rate</span>
<a name="ln-5836"></a>      <span class="k">ELSE IF</span> <span class="p">(</span> <span class="n">CoolingLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5837"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5838"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5839"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-5840"></a><span class="c">!     If no load exists, set the compressor on mass flow rate.</span>
<a name="ln-5841"></a><span class="c">!     Set equal the mass flow rate when no heating or cooling is needed if no moisture load exists.</span>
<a name="ln-5842"></a><span class="c">!     If the user has set the off mass flow rate to 0, set according to the last operating mode.</span>
<a name="ln-5843"></a>      <span class="k">ELSE</span>
<a name="ln-5844"></a><span class="k">        IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5845"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5846"></a><span class="k">          </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5847"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5848"></a>        <span class="k">ELSE</span>
<a name="ln-5849"></a><span class="k">          </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-5850"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5851"></a><span class="c">!         User may have entered a 0 for MaxNoCoolHeatAirMassFlow</span>
<a name="ln-5852"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CompOnMassFlow</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5853"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5854"></a><span class="k">              </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-5855"></a>              <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5856"></a>            <span class="k">ELSE</span>
<a name="ln-5857"></a><span class="k">              </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5858"></a>              <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5859"></a>            <span class="k">END IF</span>
<a name="ln-5860"></a><span class="k">          END IF</span>
<a name="ln-5861"></a><span class="k">        END IF</span>
<a name="ln-5862"></a><span class="k">      END IF</span>
<a name="ln-5863"></a>
<a name="ln-5864"></a><span class="c">!     Set the compressor or coil OFF mass flow rate based on LOGICAL flag</span>
<a name="ln-5865"></a><span class="c">!     UseCompressorOnFlow is used when the user does not enter a value for no cooling or heating flow rate</span>
<a name="ln-5866"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5867"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5868"></a><span class="k">          IF</span><span class="p">(</span><span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5869"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5870"></a><span class="k">            </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5871"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5872"></a>          <span class="k">ELSE</span>
<a name="ln-5873"></a><span class="k">            </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-5874"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5875"></a>          <span class="k">END IF</span>
<a name="ln-5876"></a><span class="k">        ELSE</span>
<a name="ln-5877"></a><span class="k">          </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5878"></a>          <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5879"></a>        <span class="k">END IF</span>
<a name="ln-5880"></a><span class="c">!     ELSE use the user specified value</span>
<a name="ln-5881"></a>      <span class="k">ELSE</span>
<a name="ln-5882"></a><span class="k">        </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-5883"></a>        <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NoHeatCoolSpeedRatio</span>
<a name="ln-5884"></a>      <span class="k">END IF</span>
<a name="ln-5885"></a><span class="k">    ELSE</span>
<a name="ln-5886"></a><span class="c">!     cycling fan mode</span>
<a name="ln-5887"></a>      <span class="k">IF</span> <span class="p">(</span> <span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5888"></a>           <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5889"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5890"></a>
<a name="ln-5891"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">MoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-5892"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5893"></a><span class="k">          </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5894"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5895"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-5896"></a>        <span class="k">ELSE</span>
<a name="ln-5897"></a><span class="k">          </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirMassFlow</span>
<a name="ln-5898"></a>          <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5899"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-5900"></a>        <span class="k">END IF</span>
<a name="ln-5901"></a><span class="k">      ELSE IF</span> <span class="p">(</span> <span class="n">CoolingLoad</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-5902"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirMassFlow</span>
<a name="ln-5903"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingSpeedRatio</span>
<a name="ln-5904"></a>      <span class="k">ELSE</span>
<a name="ln-5905"></a><span class="k">        </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5906"></a>        <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5907"></a>      <span class="k">END IF</span>
<a name="ln-5908"></a><span class="k">      </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5909"></a>      <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5910"></a>    <span class="k">END IF</span>
<a name="ln-5911"></a><span class="k">  ELSE</span> <span class="c">!  Is a HeatOnly furnace</span>
<a name="ln-5912"></a>
<a name="ln-5913"></a>    <span class="n">CompOnMassFlow</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-5914"></a>    <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5915"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-5916"></a><span class="k">      </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span>
<a name="ln-5917"></a>      <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingSpeedRatio</span>
<a name="ln-5918"></a>    <span class="k">ELSE</span>
<a name="ln-5919"></a><span class="k">      </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5920"></a>      <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5921"></a>    <span class="k">END IF</span>
<a name="ln-5922"></a>
<a name="ln-5923"></a><span class="k">  END IF</span> <span class="c">! End check for heat only furnace or water-to-air heat pump</span>
<a name="ln-5924"></a>
<a name="ln-5925"></a>
<a name="ln-5926"></a><span class="c">! Set the system mass flow rates</span>
<a name="ln-5927"></a>  <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-5928"></a>
<a name="ln-5929"></a><span class="k">END SUBROUTINE </span><span class="n">SetOnOffMassFlowRate</span>
<a name="ln-5930"></a>
<a name="ln-5931"></a><span class="k">SUBROUTINE </span><span class="n">SizeFurnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-5932"></a>
<a name="ln-5933"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-5934"></a>          <span class="c">!       AUTHOR         Fred Buhl</span>
<a name="ln-5935"></a>          <span class="c">!       DATE WRITTEN   January 2002</span>
<a name="ln-5936"></a>          <span class="c">!       MODIFIED       Bereket Nigusse, May 2010, removed the autosize option for the input field supply air</span>
<a name="ln-5937"></a>          <span class="c">!                                                 flow fraction through controlled zone.</span>
<a name="ln-5938"></a>          <span class="c">!                      Bo Shen, March 2012, size the air flow rates at individual speed levels for VS WSHP</span>
<a name="ln-5939"></a>          <span class="c">!                      Bo Shen, ORNL, July 2012 - added variable-speed air source heat pump cooling and heating coils, using curve-fits</span>
<a name="ln-5940"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-5941"></a>
<a name="ln-5942"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-5943"></a>          <span class="c">! This subroutine is for sizing Furnace Components for which nominal cpacities</span>
<a name="ln-5944"></a>          <span class="c">! and flow rates have not been specified in the input</span>
<a name="ln-5945"></a>
<a name="ln-5946"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-5947"></a>          <span class="c">! Obtains heating capacities and flow rates from the zone or system sizing arrays.</span>
<a name="ln-5948"></a>          <span class="c">!</span>
<a name="ln-5949"></a>          <span class="c">! NOTE: In UNITARYSYSTEM:HEATPUMP:AIRTOAIR we are sizing the heating capacity to be</span>
<a name="ln-5950"></a>          <span class="c">! equal to the cooling capacity.  Thus the cooling and</span>
<a name="ln-5951"></a>          <span class="c">! and heating capacities of a DX heat pump system will be identical. In real life the ARI</span>
<a name="ln-5952"></a>          <span class="c">! heating and cooling capacities are close but not identical.</span>
<a name="ln-5953"></a>
<a name="ln-5954"></a>
<a name="ln-5955"></a>
<a name="ln-5956"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-5957"></a>          <span class="c">! na</span>
<a name="ln-5958"></a>
<a name="ln-5959"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-5960"></a>  <span class="k">USE </span><span class="n">DataSizing</span>
<a name="ln-5961"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-5962"></a>  <span class="k">USE </span><span class="n">BranchInputManager</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">CheckSystemBranchFlow</span>
<a name="ln-5963"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimHXAssistedCoolingCoil</span>
<a name="ln-5964"></a>  <span class="k">USE </span><span class="n">WatertoAirheatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-5965"></a>  <span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span><span class="p">,</span> <span class="n">VarSpeedCoil</span>
<a name="ln-5966"></a>  <span class="k">USE </span><span class="n">ReportSizingManager</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">ReportSizingOutput</span>
<a name="ln-5967"></a>  <span class="k">USE </span><span class="n">EMSManager</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">ManageEMS</span>
<a name="ln-5968"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">emsCallFromUnitarySystemSizing</span>
<a name="ln-5969"></a>
<a name="ln-5970"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-5971"></a>
<a name="ln-5972"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-5973"></a>  <span class="kt">Integer</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FurnaceNum</span>
<a name="ln-5974"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-5975"></a>
<a name="ln-5976"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-5977"></a>          <span class="c">! na</span>
<a name="ln-5978"></a>
<a name="ln-5979"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-5980"></a>          <span class="c">! na</span>
<a name="ln-5981"></a>
<a name="ln-5982"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-5983"></a>          <span class="c">! na</span>
<a name="ln-5984"></a>
<a name="ln-5985"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-5986"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ControlZoneVolFlow</span>
<a name="ln-5987"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ThisCtrlZoneNum</span> <span class="c">! the controlled zone number of the control zone !!!</span>
<a name="ln-5988"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ControlledZoneNum</span>
<a name="ln-5989"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">Iter</span> <span class="c">!iteration count</span>
<a name="ln-5990"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MulSpeedFlowScale</span> <span class="c">! variable speed air flow scaling factor</span>
<a name="ln-5991"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">ErrFound</span> <span class="c">! flag returned from mining functions</span>
<a name="ln-5992"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">BranchFlow</span> <span class="c">! branch volumetric flow rate [m3/s]</span>
<a name="ln-5993"></a>
<a name="ln-5994"></a>  <span class="k">CALL </span><span class="n">ManageEMS</span><span class="p">(</span><span class="n">emsCallFromUnitarySystemSizing</span><span class="p">)</span> <span class="c">! calling point</span>
<a name="ln-5995"></a>
<a name="ln-5996"></a>  <span class="n">ThisCtrlZoneNum</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-5997"></a>  <span class="n">DXCoolCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5998"></a>  <span class="n">UnitaryHeatCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-5999"></a>  <span class="n">SuppHeatCap</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6000"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingSingleSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6001"></a><span class="k">    CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">On</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-6002"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6003"></a><span class="k">    CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="n">On</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6004"></a>                                  <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6005"></a>                                  <span class="n">HXUnitEnable</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6006"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPSimple</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6007"></a><span class="k">    CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6008"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6009"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6010"></a>           <span class="mi">0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>  <span class="c">!CoolPartLoadRatio</span>
<a name="ln-6011"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-6012"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6013"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_CoolingAirToAirVariableSpeed</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6014"></a><span class="k">    CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-6015"></a>           <span class="mi">0</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6016"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-6017"></a>           <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>     <span class="c">!conduct the sizing operation in the VS WSHP</span>
<a name="ln-6018"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-6019"></a>
<a name="ln-6020"></a>    <span class="n">MulSpeedFlowScale</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6021"></a>       <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-6022"></a>          <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-6023"></a>    <span class="k">Do </span><span class="n">Iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-6024"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6025"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">*</span> <span class="n">MulSpeedFlowScale</span>
<a name="ln-6026"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6027"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">*</span> <span class="n">MulSpeedFlowScale</span>
<a name="ln-6028"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6029"></a>         <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6030"></a>                   <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-6031"></a>    <span class="k">End Do</span>
<a name="ln-6032"></a>
<a name="ln-6033"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingWaterToAirHPVSEquationFit</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6034"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="o">==</span> <span class="n">Coil_HeatingAirToAirVariableSpeed</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6035"></a><span class="k">        CALL </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-6036"></a>               <span class="mi">0</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6037"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-6038"></a>               <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span> <span class="c">!conduct the sizing operation in the VS WSHP</span>
<a name="ln-6039"></a>
<a name="ln-6040"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">NumOfSpeeds</span>
<a name="ln-6041"></a>
<a name="ln-6042"></a>        <span class="n">MulSpeedFlowScale</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">RatedAirVolFlowRate</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6043"></a>                        <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-6044"></a>                           <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">NormSpedLevel</span><span class="p">)</span>
<a name="ln-6045"></a>        <span class="k">Do </span><span class="n">Iter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-6046"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6047"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">*</span> <span class="n">MulSpeedFlowScale</span>
<a name="ln-6048"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6049"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirMassFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">*</span> <span class="n">MulSpeedFlowScale</span>
<a name="ln-6050"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span> <span class="o">=</span>   <span class="p">&amp;</span>
<a name="ln-6051"></a>             <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">(</span><span class="n">Iter</span><span class="p">)</span><span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-6052"></a>                <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">MSRatedAirVolFlowRate</span><span class="p">&amp;</span>
<a name="ln-6053"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span><span class="p">)</span>
<a name="ln-6054"></a>        <span class="k">End Do</span>
<a name="ln-6055"></a><span class="k">    END IF</span>
<a name="ln-6056"></a>
<a name="ln-6057"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6058"></a><span class="k">       </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6059"></a>            <span class="nb">min</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6060"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6061"></a>            <span class="nb">min</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6062"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-6063"></a>            <span class="nb">min</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-6064"></a>    <span class="k">ELSE</span>
<a name="ln-6065"></a><span class="k">       </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6066"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span> <span class="o">=</span>   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6067"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolVolumeFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-6068"></a>    <span class="k">END IF</span>
<a name="ln-6069"></a>
<a name="ln-6070"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6071"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleVolumeAirRate</span>
<a name="ln-6072"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-6073"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NoHeatCoolSpeedRatio</span><span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-6074"></a>    <span class="k">END IF</span>
<a name="ln-6075"></a>
<a name="ln-6076"></a><span class="k">  END IF</span>
<a name="ln-6077"></a>
<a name="ln-6078"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6079"></a>
<a name="ln-6080"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6081"></a>
<a name="ln-6082"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6083"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6084"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-6085"></a>      <span class="k">ELSE</span>
<a name="ln-6086"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6087"></a>      <span class="k">END IF</span>
<a name="ln-6088"></a>
<a name="ln-6089"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6090"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRateEMSOverrideValue</span>
<a name="ln-6091"></a>      <span class="n">ENDIF</span>
<a name="ln-6092"></a>
<a name="ln-6093"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6094"></a>                              <span class="s1">&#39;Supply Air Flow Rate [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6095"></a>                              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">)</span>
<a name="ln-6096"></a>
<a name="ln-6097"></a>    <span class="k">END IF</span>
<a name="ln-6098"></a>
<a name="ln-6099"></a><span class="k">  END IF</span>
<a name="ln-6100"></a>
<a name="ln-6101"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6102"></a>
<a name="ln-6103"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6104"></a>
<a name="ln-6105"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6106"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6107"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-6108"></a>      <span class="k">ELSE</span>
<a name="ln-6109"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6110"></a>      <span class="k">END IF</span>
<a name="ln-6111"></a>
<a name="ln-6112"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6113"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlowEMSOverrideValue</span>
<a name="ln-6114"></a>      <span class="n">ENDIF</span>
<a name="ln-6115"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6116"></a>                               <span class="s1">&#39;Supply Air Flow Rate During Heating Operation [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6117"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-6118"></a>
<a name="ln-6119"></a>    <span class="k">END IF</span>
<a name="ln-6120"></a>
<a name="ln-6121"></a><span class="k">  END IF</span>
<a name="ln-6122"></a>
<a name="ln-6123"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6124"></a>
<a name="ln-6125"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6126"></a>
<a name="ln-6127"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6128"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6129"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-6130"></a>      <span class="k">ELSE</span>
<a name="ln-6131"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6132"></a>      <span class="k">END IF</span>
<a name="ln-6133"></a>
<a name="ln-6134"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6135"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlowEMSOverrideValue</span>
<a name="ln-6136"></a>      <span class="n">ENDIF</span>
<a name="ln-6137"></a>
<a name="ln-6138"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6139"></a>                               <span class="s1">&#39;Supply Air Flow Rate During Cooling Operation [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6140"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxCoolAirVolFlow</span><span class="p">)</span>
<a name="ln-6141"></a>
<a name="ln-6142"></a>    <span class="k">END IF</span>
<a name="ln-6143"></a>
<a name="ln-6144"></a><span class="k">  END IF</span>
<a name="ln-6145"></a>
<a name="ln-6146"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6147"></a>
<a name="ln-6148"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6149"></a>
<a name="ln-6150"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6151"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span> <span class="o">&gt;=</span> <span class="n">SmallAirVolFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6152"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">DesMainVolFlow</span>
<a name="ln-6153"></a>      <span class="k">ELSE</span>
<a name="ln-6154"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6155"></a>      <span class="k">END IF</span>
<a name="ln-6156"></a>
<a name="ln-6157"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6158"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlowEMSOverrideValue</span>
<a name="ln-6159"></a>      <span class="n">ENDIF</span>
<a name="ln-6160"></a>
<a name="ln-6161"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6162"></a>                               <span class="s1">&#39;Supply Air Flow Rate When No Cooling or Heating is Needed [m3/s]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6163"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxNoCoolHeatAirVolFlow</span><span class="p">)</span>
<a name="ln-6164"></a>
<a name="ln-6165"></a>    <span class="k">END IF</span>
<a name="ln-6166"></a>
<a name="ln-6167"></a><span class="k">  END IF</span>
<a name="ln-6168"></a>
<a name="ln-6169"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6170"></a>
<a name="ln-6171"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6172"></a>
<a name="ln-6173"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6174"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6175"></a>
<a name="ln-6176"></a><span class="k">        CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6177"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-6178"></a>
<a name="ln-6179"></a>      <span class="k">ELSE</span>
<a name="ln-6180"></a>
<a name="ln-6181"></a><span class="k">        CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6182"></a>
<a name="ln-6183"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatCap</span>
<a name="ln-6184"></a>
<a name="ln-6185"></a>      <span class="k">END IF</span>
<a name="ln-6186"></a>
<a name="ln-6187"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6188"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6189"></a>      <span class="k">END IF</span>
<a name="ln-6190"></a>
<a name="ln-6191"></a><span class="k">      CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6192"></a>                              <span class="s1">&#39;Nominal Heating Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6193"></a>                              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="p">)</span>
<a name="ln-6194"></a>
<a name="ln-6195"></a>    <span class="k">END IF</span>
<a name="ln-6196"></a>
<a name="ln-6197"></a><span class="k">  END IF</span>
<a name="ln-6198"></a>
<a name="ln-6199"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6200"></a>
<a name="ln-6201"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6202"></a>
<a name="ln-6203"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6204"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">DXCoolCap</span> <span class="o">&gt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6205"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="n">DXCoolCap</span>
<a name="ln-6206"></a>      <span class="k">ELSE</span>
<a name="ln-6207"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6208"></a>      <span class="k">END IF</span>
<a name="ln-6209"></a><span class="k">      CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6210"></a>                              <span class="s1">&#39;Nominal Cooling Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6211"></a>                              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesigncoolingCapacity</span><span class="p">)</span>
<a name="ln-6212"></a>
<a name="ln-6213"></a>    <span class="k">END IF</span>
<a name="ln-6214"></a>
<a name="ln-6215"></a><span class="k">  END IF</span>
<a name="ln-6216"></a>
<a name="ln-6217"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6218"></a>
<a name="ln-6219"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6220"></a>
<a name="ln-6221"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6222"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatSupTemp</span>
<a name="ln-6223"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6224"></a>                              <span class="s1">&#39;Maximum Supply Air Temperature from Supplemental Heater [C]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6225"></a>                              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span>
<a name="ln-6226"></a>
<a name="ln-6227"></a>    <span class="k">END IF</span>
<a name="ln-6228"></a>
<a name="ln-6229"></a><span class="k">  END IF</span>
<a name="ln-6230"></a>
<a name="ln-6231"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">==</span> <span class="n">AutoSize</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6232"></a>
<a name="ln-6233"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">CurSysNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6234"></a>
<a name="ln-6235"></a><span class="k">      CALL </span><span class="n">CheckSysSizing</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span>
<a name="ln-6236"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6237"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6238"></a>        <span class="c">! set the supplemental heating capacity to the actual heating load</span>
<a name="ln-6239"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">FinalSysSizing</span><span class="p">(</span><span class="n">CurSysNum</span><span class="p">)%</span><span class="n">HeatCap</span>
<a name="ln-6240"></a>        <span class="c">! if reheat needed for humidity control, make sure supplemental heating is at least as big</span>
<a name="ln-6241"></a>        <span class="c">! as the cooling capacity</span>
<a name="ln-6242"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6243"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6244"></a>                                                              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span><span class="p">)</span>
<a name="ln-6245"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6246"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6247"></a>          <span class="n">ENDIF</span>
<a name="ln-6248"></a>        <span class="k">END IF</span>
<a name="ln-6249"></a>
<a name="ln-6250"></a><span class="k">      ELSE</span>
<a name="ln-6251"></a>
<a name="ln-6252"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6253"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignCoolingCapacity</span>
<a name="ln-6254"></a>        <span class="k">ELSE</span>
<a name="ln-6255"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6256"></a>        <span class="k">END IF</span>
<a name="ln-6257"></a>
<a name="ln-6258"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-6259"></a>
<a name="ln-6260"></a>      <span class="k">CALL </span><span class="n">ReportSizingOutput</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">),</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6261"></a>                              <span class="s1">&#39;Supplemental Heating Coil Nominal Capacity [W]&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6262"></a>                              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">)</span>
<a name="ln-6263"></a>
<a name="ln-6264"></a>    <span class="k">END IF</span>
<a name="ln-6265"></a>
<a name="ln-6266"></a><span class="k">  END IF</span>
<a name="ln-6267"></a>
<a name="ln-6268"></a><span class="k">  </span><span class="n">UnitaryHeatCap</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-6269"></a>  <span class="n">SuppHeatCap</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-6270"></a>
<a name="ln-6271"></a>  <span class="n">BranchFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6272"></a>  <span class="n">ErrFound</span>  <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6273"></a>  <span class="c">! check branch flow rate vs system flow rate. Branch must match system of OA system is present</span>
<a name="ln-6274"></a>  <span class="k">CALL </span><span class="n">CheckSystemBranchFlow</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-6275"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">,</span><span class="n">BranchFlow</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignFanVolFlowRate</span><span class="p">,</span> <span class="n">ErrFound</span><span class="p">)</span>
<a name="ln-6276"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ErrFound</span><span class="p">)</span><span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...occurs in &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6277"></a>                                     <span class="s1">&#39; &quot;&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6278"></a>
<a name="ln-6279"></a>  <span class="k">RETURN</span>
<a name="ln-6280"></a>
<a name="ln-6281"></a><span class="k">END SUBROUTINE </span><span class="n">SizeFurnace</span>
<a name="ln-6282"></a>
<a name="ln-6283"></a> <span class="c">! End Initialization Section of the Module</span>
<a name="ln-6284"></a><span class="c">!******************************************************************************</span>
<a name="ln-6285"></a>
<a name="ln-6286"></a>
<a name="ln-6287"></a>
<a name="ln-6288"></a><span class="c">! Beginning of Update subroutines for the Furnace Module</span>
<a name="ln-6289"></a><span class="c">! *****************************************************************************</span>
<a name="ln-6290"></a>
<a name="ln-6291"></a>
<a name="ln-6292"></a><span class="k">SUBROUTINE </span><span class="n">CalcNewZoneHeatOnlyFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-6293"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6294"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-6295"></a>          <span class="c">!       DATE WRITTEN   Feb 2001</span>
<a name="ln-6296"></a>          <span class="c">!       MODIFIED       Don Shirey and R. Raustad, Mar 2001 &amp; Mar 2003</span>
<a name="ln-6297"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-6298"></a>
<a name="ln-6299"></a>
<a name="ln-6300"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6301"></a>          <span class="c">! This subroutine updates the coil outlet nodes by simulating a heat-only</span>
<a name="ln-6302"></a>          <span class="c">! furnace or unitary system.</span>
<a name="ln-6303"></a>
<a name="ln-6304"></a>
<a name="ln-6305"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6306"></a>          <span class="c">! Determine the operating PLR to meet the zone sensible load.</span>
<a name="ln-6307"></a>
<a name="ln-6308"></a>
<a name="ln-6309"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6310"></a>          <span class="c">! na</span>
<a name="ln-6311"></a>
<a name="ln-6312"></a>
<a name="ln-6313"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6314"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-6315"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-6316"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>    <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-6317"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">TrimSigDigits</span>
<a name="ln-6318"></a>
<a name="ln-6319"></a>
<a name="ln-6320"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6321"></a>
<a name="ln-6322"></a>
<a name="ln-6323"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6324"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>          <span class="c">! Index to furnace</span>
<a name="ln-6325"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! Iteration flag</span>
<a name="ln-6326"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneLoad</span>            <span class="c">! load to be met by furnace (W)</span>
<a name="ln-6327"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCoilLoad</span>        <span class="c">! actual load passed to heating coil (W)</span>
<a name="ln-6328"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! ratio of coil on to coil off air flow rate</span>
<a name="ln-6329"></a>
<a name="ln-6330"></a>
<a name="ln-6331"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6332"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">15</span>           <span class="c">! maximum number of iterations</span>
<a name="ln-6333"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span>  <span class="n">MinPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>           <span class="c">! minimum part load ratio allowed</span>
<a name="ln-6334"></a>
<a name="ln-6335"></a>
<a name="ln-6336"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6337"></a>          <span class="c">! na</span>
<a name="ln-6338"></a>
<a name="ln-6339"></a>
<a name="ln-6340"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6341"></a>          <span class="c">! na</span>
<a name="ln-6342"></a>
<a name="ln-6343"></a>
<a name="ln-6344"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6345"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">cpair</span>
<a name="ln-6346"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6347"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SystemSensibleLoad</span>   <span class="c">! Sensible load to be met by furnace (W)</span>
<a name="ln-6348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FullSensibleOutput</span>   <span class="c">! Full sensible output of furnace (W)</span>
<a name="ln-6349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FullLatentOutput</span>     <span class="c">! Full latent output of furnace = 0 (W)</span>
<a name="ln-6350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NoSensibleOutput</span>     <span class="c">! Sensible output of furnace with no heating allowed (W)</span>
<a name="ln-6351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NoLatentOutput</span>       <span class="c">! Latent output of furnace = 0 (W)</span>
<a name="ln-6352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">PartLoadRatio</span>        <span class="c">! Part load ratio of furnace</span>
<a name="ln-6353"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatErrorToler</span>       <span class="c">! Error tolerance in heating mode</span>
<a name="ln-6354"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">IterRelax</span>            <span class="c">! Relaxation factor for iterations</span>
<a name="ln-6355"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ActualSensibleOutput</span> <span class="c">! Actual furnace sensible capacity</span>
<a name="ln-6356"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ActualLatentOutput</span>   <span class="c">! Actual furnace latent capacity = 0</span>
<a name="ln-6357"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">DeltaT</span>               <span class="c">! Heater outlet temp minus design heater outlet temp</span>
<a name="ln-6358"></a><span class="c">!  CHARACTER(len=20) :: ErrNum = &#39; &#39;         ! For displaying error message in cooling</span>
<a name="ln-6359"></a><span class="c">!  INTEGER,SAVE      :: ErrCount = 0</span>
<a name="ln-6360"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">Iter</span> <span class="o">=</span> <span class="mi">0</span>             <span class="c">! Iteration counter</span>
<a name="ln-6361"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">FurnaceInletNode</span>     <span class="c">! Node number of furnace inlet</span>
<a name="ln-6362"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">FurnaceOutletNode</span>    <span class="c">! Node number of furnace outlet</span>
<a name="ln-6363"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">OpMode</span>               <span class="c">! Mode of Operation (fan cycling or fan continuous)</span>
<a name="ln-6364"></a>      <span class="c">! Set local variables</span>
<a name="ln-6365"></a>
<a name="ln-6366"></a>
<a name="ln-6367"></a>      <span class="c">! Retrieve the load on the controlled zone</span>
<a name="ln-6368"></a>  <span class="n">FurnaceOutletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-6369"></a>  <span class="n">FurnaceInletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-6370"></a>  <span class="n">OpMode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-6371"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-6372"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6373"></a><span class="c">!  OnOffAirFlowRatio = 1.0</span>
<a name="ln-6374"></a>
<a name="ln-6375"></a>
<a name="ln-6376"></a>  <span class="c">!Calculate the Cp Air</span>
<a name="ln-6377"></a>  <span class="n">cpair</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-6378"></a>
<a name="ln-6379"></a>
<a name="ln-6380"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6381"></a><span class="k">    </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6382"></a>    <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6383"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6384"></a>  <span class="k">ELSE</span>
<a name="ln-6385"></a>    <span class="c">! If Furnace runs then set HeatCoilLoad on Heating Coil and the Mass Flow</span>
<a name="ln-6386"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6387"></a>         <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6388"></a>          <span class="p">(</span><span class="n">HeatingLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6389"></a>
<a name="ln-6390"></a>
<a name="ln-6391"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6392"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-6393"></a>      <span class="n">SystemSensibleLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6394"></a>
<a name="ln-6395"></a>
<a name="ln-6396"></a>      <span class="c">! Get no load result</span>
<a name="ln-6397"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6398"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6399"></a>      <span class="k">END IF</span>
<a name="ln-6400"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6401"></a><span class="k">        </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! The on/off fan will not cycle, so set part-load fraction = 1</span>
<a name="ln-6402"></a>      <span class="k">END IF</span>
<a name="ln-6403"></a>
<a name="ln-6404"></a><span class="c">!     Set the inlet mass flow rate based on user specified coil OFF flow rate</span>
<a name="ln-6405"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6406"></a>      <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-6407"></a>
<a name="ln-6408"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">NoSensibleOutput</span><span class="p">,</span><span class="n">NoLatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6409"></a>                             <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6410"></a>
<a name="ln-6411"></a>
<a name="ln-6412"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6413"></a>
<a name="ln-6414"></a>
<a name="ln-6415"></a>      <span class="c">! Set fan part-load fraction equal to 1 while getting full load result</span>
<a name="ln-6416"></a>      <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6417"></a>      <span class="n">OnOffAirFlowRatio</span>        <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6418"></a>
<a name="ln-6419"></a>      <span class="c">! Get full load result</span>
<a name="ln-6420"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6421"></a>                             <span class="n">FullLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6422"></a>
<a name="ln-6423"></a>
<a name="ln-6424"></a>      <span class="c">! Since we are heating, we expect FullSensibleOutput to be &gt; 0 and FullSensibleOutput &gt; NoSensibleOutput</span>
<a name="ln-6425"></a>      <span class="c">! Check that this is the case; if not set PartLoadRatio = 0.0d0 (off) and return</span>
<a name="ln-6426"></a>
<a name="ln-6427"></a>
<a name="ln-6428"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FullSensibleOutput</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">NoSensibleOutput</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6429"></a><span class="k">        </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="o">-</span><span class="n">NoSensibleOutput</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6430"></a>                                           <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">FullSensibleOutput</span><span class="o">-</span><span class="n">NoSensibleOutput</span><span class="p">)))</span>
<a name="ln-6431"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6432"></a><span class="k">          </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-6433"></a>          <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-6434"></a>        <span class="k">ELSE</span> <span class="c">! ContFanCycCoil</span>
<a name="ln-6435"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6436"></a><span class="k">            </span><span class="n">deltaT</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span>
<a name="ln-6437"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6438"></a>              <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-6439"></a>              <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">HeatCoilLoad</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">cpair</span> <span class="o">*</span> <span class="n">deltaT</span>
<a name="ln-6440"></a>          <span class="k">ELSE</span>
<a name="ln-6441"></a><span class="k">          </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">SystemSensibleLoad</span> <span class="o">-</span> <span class="n">NoSensibleOutput</span>
<a name="ln-6442"></a>          <span class="k">END IF</span>
<a name="ln-6443"></a><span class="k">        END IF</span>
<a name="ln-6444"></a>
<a name="ln-6445"></a>
<a name="ln-6446"></a>        <span class="c">! Calculate the part load ratio through iteration</span>
<a name="ln-6447"></a>        <span class="n">HeatErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-6448"></a>        <span class="n">Error</span> <span class="o">=</span> <span class="mf">1.0d0</span>             <span class="c">! initialize error value for comparison against tolerance</span>
<a name="ln-6449"></a>        <span class="n">Iter</span> <span class="o">=</span> <span class="mi">0</span>                  <span class="c">! initialize iteration counter</span>
<a name="ln-6450"></a>        <span class="n">IterRelax</span> <span class="o">=</span> <span class="mf">0.9d0</span>         <span class="c">! relaxation factor for iterations</span>
<a name="ln-6451"></a>        <span class="k">DO WHILE</span> <span class="p">(</span><span class="n">Iter</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">)</span>
<a name="ln-6452"></a>
<a name="ln-6453"></a>         <span class="k">IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-6454"></a>         <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6455"></a>                                <span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ActualSensibleOutput</span><span class="p">,</span><span class="n">ActualLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6456"></a>
<a name="ln-6457"></a>
<a name="ln-6458"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">Error</span><span class="o">=</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>
<a name="ln-6459"></a>         <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">Error</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">HeatErrorToler</span><span class="p">)</span> <span class="k">EXIT</span>
<a name="ln-6460"></a><span class="k">         </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">PartLoadRatio</span> <span class="o">+</span> <span class="n">IterRelax</span><span class="o">*</span><span class="p">&amp;</span>
<a name="ln-6461"></a>                       <span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">FullSensibleOutput</span><span class="o">-</span><span class="n">NoSensibleOutput</span><span class="p">)))</span>
<a name="ln-6462"></a>
<a name="ln-6463"></a>
<a name="ln-6464"></a><span class="c">!        limit the heating coil outlet air temperature to DesignMaxOutletTemp</span>
<a name="ln-6465"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6466"></a><span class="k">           </span><span class="n">deltaT</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span>
<a name="ln-6467"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">HeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-6468"></a>              <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-6469"></a>           <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">HeatCoilLoad</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">cpair</span> <span class="o">*</span> <span class="n">deltaT</span>
<a name="ln-6470"></a>           <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">On</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6471"></a>                                <span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ActualSensibleOutput</span><span class="p">,</span><span class="n">ActualLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6472"></a>
<a name="ln-6473"></a>
<a name="ln-6474"></a>           <span class="k">IF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="n">Error</span><span class="o">=</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>
<a name="ln-6475"></a>           <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">PartLoadRatio</span> <span class="o">+</span> <span class="n">IterRelax</span><span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-6476"></a>                       <span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">FullSensibleOutput</span><span class="o">-</span><span class="n">NoSensibleOutput</span><span class="p">)))</span>
<a name="ln-6477"></a>         <span class="k">ELSE</span>
<a name="ln-6478"></a><span class="k">           </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-6479"></a>         <span class="k">END IF</span>
<a name="ln-6480"></a>
<a name="ln-6481"></a>
<a name="ln-6482"></a><span class="k">         IF</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">MinPLR</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-6483"></a><span class="k">         IF</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mf">1.0d0</span><span class="p">)</span><span class="k">EXIT</span>
<a name="ln-6484"></a><span class="k">         </span><span class="n">Iter</span> <span class="o">=</span> <span class="n">Iter</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-6485"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">Iter</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">7</span><span class="p">)</span><span class="n">IterRelax</span><span class="o">=</span><span class="mf">0.7d0</span>
<a name="ln-6486"></a>         <span class="k">IF</span><span class="p">(</span><span class="n">Iter</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">15</span><span class="p">)</span><span class="n">IterRelax</span><span class="o">=</span><span class="mf">0.4d0</span>
<a name="ln-6487"></a>
<a name="ln-6488"></a>
<a name="ln-6489"></a>        <span class="k">END DO</span>
<a name="ln-6490"></a>
<a name="ln-6491"></a>
<a name="ln-6492"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Iter</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">MaxIter</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6493"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingMaxIterIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6494"></a><span class="k">            CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-6495"></a>                 <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; -- Exceeded max heating iterations (&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6496"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">MaxIter</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6497"></a>                  <span class="s1">&#39;) while adjusting furnace runtime.&#39;</span><span class="p">)</span>
<a name="ln-6498"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-6499"></a>          <span class="n">ENDIF</span>
<a name="ln-6500"></a>          <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-6501"></a>                 <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; -- Exceeded max heating iterations error continues...&#39;</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6502"></a>                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingMaxIterIndex2</span><span class="p">)</span>
<a name="ln-6503"></a>        <span class="k">END IF</span>
<a name="ln-6504"></a>
<a name="ln-6505"></a>
<a name="ln-6506"></a><span class="k">      ELSE</span>  <span class="c">!ELSE from IF(FullSensibleOutput.GT.NoSensibleOutput)THEN above</span>
<a name="ln-6507"></a>        <span class="c">! Set part load ratio to 1 and run heater at design heating capacity</span>
<a name="ln-6508"></a>        <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6509"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-6510"></a>      <span class="k">END IF</span>
<a name="ln-6511"></a>      <span class="c">! Set the final results</span>
<a name="ln-6512"></a><span class="c">!      IF (OpMode .EQ. CycFanCycCoil) THEN</span>
<a name="ln-6513"></a><span class="c">!        Furnace(FurnaceNum)%MdotFurnace = Furnace(FurnaceNum)%MdotFurnace * PartLoadRatio</span>
<a name="ln-6514"></a><span class="c">!      END IF</span>
<a name="ln-6515"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-6516"></a>
<a name="ln-6517"></a>
<a name="ln-6518"></a>    <span class="n">ELSEIF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6519"></a>       <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6520"></a><span class="k">      </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6521"></a>    <span class="k">ELSE</span> <span class="c">! no heating and no flow</span>
<a name="ln-6522"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6523"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6524"></a>    <span class="k">END IF</span>   <span class="c">! End of the Scheduled Furnace If block</span>
<a name="ln-6525"></a>
<a name="ln-6526"></a>
<a name="ln-6527"></a>  <span class="k">END IF</span>   <span class="c">! End of the FirstHVACIteration control of the mass flow If block</span>
<a name="ln-6528"></a>
<a name="ln-6529"></a>
<a name="ln-6530"></a>        <span class="c">! Set the fan inlet node flow rates</span>
<a name="ln-6531"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6532"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6533"></a>
<a name="ln-6534"></a>
<a name="ln-6535"></a><span class="k">RETURN</span>
<a name="ln-6536"></a><span class="k">END Subroutine </span><span class="n">CalcNewZoneHeatOnlyFlowRates</span>
<a name="ln-6537"></a>
<a name="ln-6538"></a>
<a name="ln-6539"></a><span class="k">SUBROUTINE </span><span class="n">CalcNewZoneHeatCoolFlowRates</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6540"></a>                                        <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-6541"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-6542"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-6543"></a>          <span class="c">!       DATE WRITTEN   Feb 2001</span>
<a name="ln-6544"></a>          <span class="c">!       MODIFIED       R. Raustad and D. Shirey, Feb/Mar/Sept/Oct/Dec 2001, Jan/Oct 2002</span>
<a name="ln-6545"></a>          <span class="c">!       RE-ENGINEERED  R. Raustad, Feb. 2005 (added RegulaFalsi for iteration technique)</span>
<a name="ln-6546"></a>
<a name="ln-6547"></a>
<a name="ln-6548"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-6549"></a>          <span class="c">! This subroutine updates the coil outlet nodes.</span>
<a name="ln-6550"></a>
<a name="ln-6551"></a>
<a name="ln-6552"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-6553"></a>          <span class="c">! Determine the operating PLR to meet the zone sensible load. If a humidistat is specified, determine</span>
<a name="ln-6554"></a>          <span class="c">! the operating PLR (greater of the sensible and latent PLR) to meet the zone SENSIBLE load</span>
<a name="ln-6555"></a>          <span class="c">! (Multimode dehumidification control) or zone LATENT load (CoolReheat dehumidification control).</span>
<a name="ln-6556"></a>          <span class="c">!</span>
<a name="ln-6557"></a>          <span class="c">! For dehumidification control type COOLREHEAT, both a sensible and latent PLR may exist for a</span>
<a name="ln-6558"></a>          <span class="c">! single time step (heating and dehumidificaiton can occur). For all other sytem types,</span>
<a name="ln-6559"></a>          <span class="c">! only a single PLR is allowed for any given time step.</span>
<a name="ln-6560"></a>          <span class="c">!</span>
<a name="ln-6561"></a>          <span class="c">! Order of simulation depends on dehumidification control option as described below.</span>
<a name="ln-6562"></a>          <span class="c">!</span>
<a name="ln-6563"></a>          <span class="c">! Dehumidificaiton control options:</span>
<a name="ln-6564"></a>          <span class="c">!</span>
<a name="ln-6565"></a>          <span class="c">! Dehumidification Control NONE:   Cooling performance is simulated first and then heating performance. If a HX</span>
<a name="ln-6566"></a>          <span class="c">!                                  assisted cooling coil is selected, the HX is always active.</span>
<a name="ln-6567"></a>          <span class="c">!</span>
<a name="ln-6568"></a>          <span class="c">! Dehumidification Control COOLREHEAT: Continuous Fan Operation:</span>
<a name="ln-6569"></a>          <span class="c">!                                      For cooling operation, the sensible and latent capacities are calculated to</span>
<a name="ln-6570"></a>          <span class="c">!                                      meet the thermostat setpoint. If a HX assisted cooling coil is selected,</span>
<a name="ln-6571"></a>          <span class="c">!                                      the HX is always active. If the latent load is not met by operating the</span>
<a name="ln-6572"></a>          <span class="c">!                                      system at the sensible PLR, a new PLR is calculated to meet the humidistat</span>
<a name="ln-6573"></a>          <span class="c">!                                      setpoint. The reheat coil load is then calculated to meet the HEATING</span>
<a name="ln-6574"></a>          <span class="c">!                                      setpoint temperature.</span>
<a name="ln-6575"></a>          <span class="c">!</span>
<a name="ln-6576"></a>          <span class="c">!                                      Cycling Fan Operation:</span>
<a name="ln-6577"></a>          <span class="c">!                                      The heating part-load ratio is calculated first. Since the fan will be</span>
<a name="ln-6578"></a>          <span class="c">!                                      controlled at the higher of the heating or cooling PLR&#39;s, a ratio of the</span>
<a name="ln-6579"></a>          <span class="c">!                                      cooling to heating PLR is used to pass to the cooling coil (MAX=1). This allows</span>
<a name="ln-6580"></a>          <span class="c">!                                      the cooling coil to operate at the heating PLR when the heating PLR is</span>
<a name="ln-6581"></a>          <span class="c">!                                      higher than the cooling PLR. The sensible and latent capacities are then</span>
<a name="ln-6582"></a>          <span class="c">!                                      calculated to meet the thermostat setpoint.</span>
<a name="ln-6583"></a>          <span class="c">!                                      If a HX assisted cooling coil is selected, the HX is always active.</span>
<a name="ln-6584"></a>          <span class="c">!                                      If the latent load is not met by operating the system at the sensible PLR,</span>
<a name="ln-6585"></a>          <span class="c">!                                      a new PLR is calculated to meet the humidistat setpoint.</span>
<a name="ln-6586"></a>          <span class="c">!                                      The reheat coil load is then calculated to meet the HEATING setpoint temperature.</span>
<a name="ln-6587"></a>          <span class="c">!</span>
<a name="ln-6588"></a>          <span class="c">! Dehumidification Control MULTIMODE: For cooling operation, the sensible and latent capacities are calculated to</span>
<a name="ln-6589"></a>          <span class="c">!                                     meet the thermostat setpoint. If a HX assisted cooling coil is selected,</span>
<a name="ln-6590"></a>          <span class="c">!                                     the HX is off for this calculation. If the latent load is not met by operating</span>
<a name="ln-6591"></a>          <span class="c">!                                     the system at the sensible PLR, a new PLR is calculated with the HX operating</span>
<a name="ln-6592"></a>          <span class="c">!                                     and the target is the thermostat setpoint. Humidity is not controlled in this</span>
<a name="ln-6593"></a>          <span class="c">!                                     mode. No reheat coil is used in this configuration.</span>
<a name="ln-6594"></a>          <span class="c">!</span>
<a name="ln-6595"></a>          <span class="c">!  Note: A supplemental heater augments the heating capacity for air-to-air heat pumps.</span>
<a name="ln-6596"></a>          <span class="c">!        A reheat coil is used for the HeatCool furnace/unitarysystem to offset the sensible cooling when the</span>
<a name="ln-6597"></a>          <span class="c">!        dehumidification control type is COOLREHEAT. Both the supplemental and reheat heating coil load is calculated</span>
<a name="ln-6598"></a>          <span class="c">!        in the Calc routines. The actual simulation of these coils is performed in the SimFurnace routine (i.e. the</span>
<a name="ln-6599"></a>          <span class="c">!        supplemental and reheat coil loads are passed as 0 to CalcFurnaceOutput).</span>
<a name="ln-6600"></a>
<a name="ln-6601"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-6602"></a>          <span class="c">! na</span>
<a name="ln-6603"></a>
<a name="ln-6604"></a>
<a name="ln-6605"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-6606"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-6607"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-6608"></a>  <span class="k">USE </span><span class="n">ScheduleManager</span>
<a name="ln-6609"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-6610"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-6611"></a>  <span class="k">USE </span><span class="n">DXCoils</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">DXCoilPartLoadRatio</span>
<a name="ln-6612"></a>
<a name="ln-6613"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-6614"></a>
<a name="ln-6615"></a>
<a name="ln-6616"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-6617"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>
<a name="ln-6618"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-6619"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation flag (1=On, 0=Off)</span>
<a name="ln-6620"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneLoad</span>           <span class="c">! the control zone load (watts)</span>
<a name="ln-6621"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MoistureLoad</span>       <span class="c">! the control zone latent load (watts)</span>
<a name="ln-6622"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatCoilLoad</span>       <span class="c">! Heating load to be met by heating coil ( excluding heat pump DX coil)</span>
<a name="ln-6623"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ReheatCoilLoad</span>     <span class="c">! Heating load to be met by reheat coil using hstat (excluding HP DX coil)</span>
<a name="ln-6624"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! Ratio of compressor ON air flow to AVERAGE air flow over time step</span>
<a name="ln-6625"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to control HX based on zone moisture load</span>
<a name="ln-6626"></a>
<a name="ln-6627"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-6628"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">100</span>        <span class="c">! maximum number of iterations</span>
<a name="ln-6629"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>  <span class="kd">::</span>  <span class="n">MinPLR</span>  <span class="o">=</span> <span class="mf">0.0d0</span>        <span class="c">! minimum part load ratio allowed</span>
<a name="ln-6630"></a>
<a name="ln-6631"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-6632"></a>          <span class="c">! na</span>
<a name="ln-6633"></a>
<a name="ln-6634"></a>
<a name="ln-6635"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-6636"></a>          <span class="c">! na</span>
<a name="ln-6637"></a>
<a name="ln-6638"></a>
<a name="ln-6639"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-6640"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SystemMoistureLoad</span>   <span class="c">! Total latent load to be removed by furnace/unitary system</span>
<a name="ln-6641"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">cpair</span>                <span class="c">! Heat capacity of air</span>
<a name="ln-6642"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">deltaT</span>               <span class="c">! Temperature rise across heating coil (C)</span>
<a name="ln-6643"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempOutHeatingCoil</span>   <span class="c">! Temperature leaving heating coil (C)</span>
<a name="ln-6644"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FullSensibleOutput</span>   <span class="c">! Full sensible output of AC (W)</span>
<a name="ln-6645"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">FullLatentOutput</span>     <span class="c">! Full latent output of AC (W)</span>
<a name="ln-6646"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NoCoolOutput</span>         <span class="c">! Sensible output of AC with no cooling allowed (W)</span>
<a name="ln-6647"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NoHeatOutput</span>         <span class="c">! Sensible output of heater with no heating allowed (W)</span>
<a name="ln-6648"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">NoLatentOutput</span>       <span class="c">! Latent output of AC with no cooling allowed (W)</span>
<a name="ln-6649"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">FurnaceInletNode</span>     <span class="c">! Inlet node to furnace or unitary system</span>
<a name="ln-6650"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">FurnaceOutletNode</span>    <span class="c">! Outlet node of furnace or unitary system</span>
<a name="ln-6651"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">OpMode</span>               <span class="c">! Mode of Operation (fan cycling = 1 or fan continuous = 2)</span>
<a name="ln-6652"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>   <span class="kd">::</span> <span class="n">CoolCoilLoad</span>         <span class="c">! Negative value means cooling required</span>
<a name="ln-6653"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>   <span class="kd">::</span> <span class="n">SystemSensibleLoad</span>   <span class="c">! Positive value means heating required</span>
<a name="ln-6654"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CoolErrorToler</span>       <span class="c">! Error tolerance in cooling mode</span>
<a name="ln-6655"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatErrorToler</span>       <span class="c">! Error tolerance in heating mode</span>
<a name="ln-6656"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ActualSensibleOutput</span> <span class="c">! Actual furnace sensible capacity</span>
<a name="ln-6657"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ActualLatentOutput</span>   <span class="c">! Actual furnace latent capacity</span>
<a name="ln-6658"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">PartLoadRatio</span>        <span class="c">! Part load ratio (greater of sensible or latent part load ratio for cooling,</span>
<a name="ln-6659"></a>                                            <span class="c">! or heating PLR)</span>
<a name="ln-6660"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">LatentPartLoadRatio</span>  <span class="c">! Part load ratio to meet dehumidification load</span>
<a name="ln-6661"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempCoolOutput</span>       <span class="c">! Temporary Sensible output of AC while iterating on PLR (W)</span>
<a name="ln-6662"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempHeatOutput</span>       <span class="c">! Temporary Sensible output of heating coil while iterating on PLR (W)</span>
<a name="ln-6663"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempLatentOutput</span>     <span class="c">! Temporary Latent output of AC at increasing PLR (W)</span>
<a name="ln-6664"></a><span class="c">!                                           ! (Temp variables are used to find min PLR for positive latent removal)</span>
<a name="ln-6665"></a>  <span class="kt">LOGICAL</span>           <span class="kd">::</span> <span class="n">HumControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! Logical flag signaling when dehumidification is required</span>
<a name="ln-6666"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>           <span class="c">! parameters passed to RegulaFalsi function</span>
<a name="ln-6667"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">SolFlag</span>              <span class="c">! return flag from RegulaFalsi</span>
<a name="ln-6668"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempMinPLR</span>           <span class="c">! Temporary min latent PLR when hum control is required and iter is exceeded</span>
<a name="ln-6669"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempMinPLR2</span>          <span class="c">! Temporary min latent PLR when cyc fan hum control is required and iter is exceeded</span>
<a name="ln-6670"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">TempMaxPLR</span>           <span class="c">! Temporary max latent PLR when hum control is required and iter is exceeded</span>
<a name="ln-6671"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">QToHeatSetPt</span>         <span class="c">! Load required to meet heating setpoint temp (&gt;0 is a heating load)</span>
<a name="ln-6672"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">CoolingHeatingPLRRatio</span> <span class="c">! ratio of cooling to heating PLR (MAX=1). Used in heating mode.</span>
<a name="ln-6673"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatingSensibleOutput</span>
<a name="ln-6674"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HeatingLatentOutput</span>
<a name="ln-6675"></a>
<a name="ln-6676"></a>
<a name="ln-6677"></a>  <span class="c">! Set local variables</span>
<a name="ln-6678"></a>  <span class="n">FurnaceOutletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-6679"></a>  <span class="n">FurnaceInletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-6680"></a>  <span class="n">OpMode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-6681"></a><span class="c">!  Furnace(FurnaceNum)%MdotFurnace = Furnace(FurnaceNum)%DesignMassFlowRate</span>
<a name="ln-6682"></a>  <span class="n">HumControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-6683"></a>  <span class="c">!Calculate the Cp Air for all conditions</span>
<a name="ln-6684"></a>  <span class="n">cpair</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-6685"></a>  <span class="n">NoHeatOutput</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6686"></a>  <span class="n">SystemSensibleLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6687"></a>  <span class="n">ReHeatCoilLoad</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6688"></a>  <span class="n">HeatCoilLoad</span>       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6689"></a>  <span class="n">ReheatCoilLoad</span>     <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6690"></a>  <span class="n">PartLoadRatio</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6691"></a>
<a name="ln-6692"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6693"></a>  <span class="c">! Set selected values during first HVAC iteration</span>
<a name="ln-6694"></a>
<a name="ln-6695"></a>
<a name="ln-6696"></a>    <span class="c">!Init for heating</span>
<a name="ln-6697"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6698"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6699"></a>          <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WatertoAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6700"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6701"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6702"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6703"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6704"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6705"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6706"></a>      <span class="k">ELSE</span> <span class="c">!for furnaces</span>
<a name="ln-6707"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6708"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6709"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6710"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6711"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6712"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6713"></a>      <span class="n">ENDIF</span>
<a name="ln-6714"></a>      <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6715"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6716"></a>
<a name="ln-6717"></a>
<a name="ln-6718"></a>    <span class="c">!Init for cooling</span>
<a name="ln-6719"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6720"></a>       <span class="c">!air to air heat pumps</span>
<a name="ln-6721"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6722"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6723"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6724"></a>        <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6725"></a>
<a name="ln-6726"></a>
<a name="ln-6727"></a>    <span class="c">!Init for moisture load only</span>
<a name="ln-6728"></a>    <span class="k">ELSE</span>
<a name="ln-6729"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6730"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6731"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6732"></a>      <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6733"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6734"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6735"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6736"></a>    <span class="n">ENDIF</span>
<a name="ln-6737"></a>
<a name="ln-6738"></a>    <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6739"></a>        <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-6740"></a>        <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-6741"></a>    <span class="c">!  if dehumidification load exists (for heat pumps) turn on the supplmental heater</span>
<a name="ln-6742"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">HPDehumidificationLoadFlag</span><span class="p">)</span> <span class="n">HumControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-6743"></a>  <span class="k">ELSE</span>  <span class="c">!not FirstHVACIteration</span>
<a name="ln-6744"></a>    <span class="c">!Init for heating</span>
<a name="ln-6745"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6746"></a><span class="k">      </span><span class="n">CoolCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6747"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6748"></a>          <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WatertoAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6749"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-6750"></a><span class="k">        </span><span class="n">SystemSensibleLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6751"></a>        <span class="n">SystemMoistureLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6752"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6753"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="n">SystemSensibleLoad</span>
<a name="ln-6754"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6755"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6756"></a>      <span class="k">ELSE</span>
<a name="ln-6757"></a><span class="k">        </span><span class="n">SystemMoistureLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-6758"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6759"></a>      <span class="k">END IF</span>
<a name="ln-6760"></a>
<a name="ln-6761"></a>
<a name="ln-6762"></a>    <span class="c">!Init for cooling</span>
<a name="ln-6763"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6764"></a><span class="k">      </span><span class="n">CoolCoilLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6765"></a>      <span class="n">SystemMoistureLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-6766"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6767"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CoolCoilLoad</span><span class="p">)</span>
<a name="ln-6768"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SystemMoistureLoad</span><span class="p">)</span>
<a name="ln-6769"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6770"></a>
<a name="ln-6771"></a>
<a name="ln-6772"></a>    <span class="c">!Init for latent</span>
<a name="ln-6773"></a>    <span class="k">ELSE</span>
<a name="ln-6774"></a><span class="k">      </span><span class="n">SystemMoistureLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-6775"></a>      <span class="n">CoolCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6776"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6777"></a>      <span class="c">!set report variables</span>
<a name="ln-6778"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6779"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="n">SystemMoistureLoad</span>
<a name="ln-6780"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-6781"></a>    <span class="n">ENDIF</span>
<a name="ln-6782"></a>    <span class="n">HeatingSensibleOutput</span>                 <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6783"></a>    <span class="n">HeatingLatentOutput</span>                   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6784"></a>    <span class="n">ReheatCoilLoad</span>                        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6785"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6786"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6787"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6788"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6789"></a>
<a name="ln-6790"></a><span class="c">! When humidity control is used with cycling fan control and a heating load exists, if a moisture load</span>
<a name="ln-6791"></a><span class="c">! also exists, the heating PLR must be available for the cooling coil calculations.</span>
<a name="ln-6792"></a><span class="c">!*********** Heating Section ************</span>
<a name="ln-6793"></a>    <span class="c">! If Furnace runs with a heating load then set HeatCoilLoad on Heating Coil and the Mass Flow</span>
<a name="ln-6794"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6795"></a><span class="c">!         (Node(FurnaceInletNode)%MassFlowRate .gt. 0.0) .and. &amp;</span>
<a name="ln-6796"></a>          <span class="p">(</span><span class="n">HeatingLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6797"></a>
<a name="ln-6798"></a><span class="c">!    Heat pumps only calculate a single PLR each time step (i.e. only cooling or heating allowed in a single time step)</span>
<a name="ln-6799"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6800"></a>        <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-6801"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-6802"></a>
<a name="ln-6803"></a>
<a name="ln-6804"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6805"></a>
<a name="ln-6806"></a>
<a name="ln-6807"></a>      <span class="c">! Get no load result</span>
<a name="ln-6808"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6809"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6810"></a>      <span class="k">END IF</span>
<a name="ln-6811"></a>
<a name="ln-6812"></a><span class="c">!     Set the inlet mass flow rate based on user specified coil OFF flow rate</span>
<a name="ln-6813"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6814"></a>
<a name="ln-6815"></a>      <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-6816"></a>
<a name="ln-6817"></a>         <span class="c">!Set the input parameters for CalcFurnaceOutput</span>
<a name="ln-6818"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">!compressor off</span>
<a name="ln-6819"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6820"></a>
<a name="ln-6821"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">minPLR</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">NoHeatOutput</span><span class="p">,</span> <span class="n">NoLatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6822"></a>                             <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6823"></a>
<a name="ln-6824"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6825"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6826"></a>
<a name="ln-6827"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">!compressor ON</span>
<a name="ln-6828"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6829"></a>
<a name="ln-6830"></a>      <span class="c">! Set fan part-load fraction equal to 1 while getting full load result</span>
<a name="ln-6831"></a>      <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6832"></a>      <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6833"></a>
<a name="ln-6834"></a>      <span class="c">! Get full load result</span>
<a name="ln-6835"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-6836"></a>                             <span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">FullLatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6837"></a>                             <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6838"></a>
<a name="ln-6839"></a>      <span class="c">! Check that SystemSensibleLoad is between FullSensibleOutput and NoHeatOutput</span>
<a name="ln-6840"></a>      <span class="c">! If so then calculate PartLoadRatio for the DX Heating coil</span>
<a name="ln-6841"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">FullSensibleOutput</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">NoHeatOutput</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6842"></a>
<a name="ln-6843"></a><span class="c">!       check bounds on sensible output prior to iteration using RegulaFalsi</span>
<a name="ln-6844"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FullSensibleOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6845"></a><span class="k">          </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6846"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">NoHeatOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6847"></a><span class="k">          </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6848"></a>        <span class="k">ELSE</span>
<a name="ln-6849"></a>
<a name="ln-6850"></a>          <span class="c">! Calculate the part load ratio through iteration</span>
<a name="ln-6851"></a>          <span class="n">HeatErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-6852"></a>
<a name="ln-6853"></a>          <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations if positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-6854"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-6855"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-6856"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-6857"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">OpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-6858"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOp</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-6859"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">SystemSensibleLoad</span>
<a name="ln-6860"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-6861"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-6862"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE mass flow rate over time step</span>
<a name="ln-6863"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HXUnitOn is always false for HX</span>
<a name="ln-6864"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6865"></a><span class="c">!         HeatErrorToler is in fraction of load, MaxIter = 30, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-6866"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HeatErrorToler</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CalcFurnaceResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-6867"></a><span class="c">!         OnOffAirFlowRatio is updated during the above iteration. Reset to correct value based on PLR.</span>
<a name="ln-6868"></a>          <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatioSave</span>
<a name="ln-6869"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6870"></a><span class="k">            CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-6871"></a>                                   <span class="n">PartLoadRatio</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempHeatOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-6872"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="o">-</span> <span class="n">TempHeatOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6873"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DXHeatingMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6874"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Heating coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6875"></a>                       <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6876"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating DX heating coil sensible part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-6877"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by DX heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-6878"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), sensible output of DX heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-6879"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempHeatOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-6880"></a>              <span class="k">END IF</span>
<a name="ln-6881"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-6882"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6883"></a>                  <span class="s1">&#39; DX sensible heating part-load ratio error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-6884"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DXHeatingMaxIterIndex</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>
<a name="ln-6885"></a>            <span class="k">END IF</span>
<a name="ln-6886"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6887"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DXHeatingRegulaFalsiFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-6888"></a><span class="k">              CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Heating coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-6889"></a>                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-6890"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  DX sensible heating part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-6891"></a>              <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by DX heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-6892"></a>                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-6893"></a>            <span class="k">END IF</span>
<a name="ln-6894"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-6895"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-6896"></a>                <span class="s1">&#39; DX sensible heating part-load ratio out of range error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-6897"></a>                <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DXHeatingRegulaFalsiFailedIndex</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>
<a name="ln-6898"></a>          <span class="k">END IF</span>
<a name="ln-6899"></a><span class="k">        END IF</span>
<a name="ln-6900"></a>
<a name="ln-6901"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-6902"></a><span class="c">!       Check if Heat Pump compressor is allowed to run based on outdoor temperature</span>
<a name="ln-6903"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6904"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6905"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-6906"></a>          <span class="k">ELSE</span>
<a name="ln-6907"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6908"></a>          <span class="k">END IF</span>
<a name="ln-6909"></a><span class="k">        ELSE</span>
<a name="ln-6910"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6911"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-6912"></a>          <span class="k">ELSE</span>
<a name="ln-6913"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6914"></a>          <span class="k">END IF</span>
<a name="ln-6915"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6916"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">FullSensibleOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6917"></a><span class="c">!       SystemSensibleLoad is greater than full DX Heating coil output so heat pump runs entire</span>
<a name="ln-6918"></a><span class="c">!       timestep and additional supplemental heating is required</span>
<a name="ln-6919"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6920"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6921"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6922"></a>  <span class="c">!       Check to see if Heat Pump compressor was allowed to run based on outdoor temperature</span>
<a name="ln-6923"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6924"></a>          <span class="k">ELSE</span>
<a name="ln-6925"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6926"></a>          <span class="k">END IF</span>
<a name="ln-6927"></a><span class="k">        ELSE</span>
<a name="ln-6928"></a><span class="k">          IF</span><span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6929"></a>  <span class="c">!       Check to see if Heat Pump compressor was allowed to run based on outdoor temperature</span>
<a name="ln-6930"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6931"></a>          <span class="k">ELSE</span>
<a name="ln-6932"></a><span class="k">            </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6933"></a>          <span class="k">END IF</span>
<a name="ln-6934"></a><span class="k">        </span><span class="n">ENDIF</span>
<a name="ln-6935"></a>      <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">NoHeatOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6936"></a><span class="c">!       SystemSensibleLoad is less than minimum DX Heating coil output so heat pump does not run and</span>
<a name="ln-6937"></a><span class="c">!       the load will be met by the supplemental heater</span>
<a name="ln-6938"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6939"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-6940"></a>      <span class="n">ENDIF</span>
<a name="ln-6941"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6942"></a><span class="c">!       Determine the load on the supplemental heating coil</span>
<a name="ln-6943"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">SystemSensibleLoad</span> <span class="o">-</span> <span class="n">FullSensibleOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6944"></a><span class="k">          </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignSuppHeatingCapacity</span>
<a name="ln-6945"></a>          <span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">HeatCoilLoad</span><span class="o">/</span><span class="p">(</span><span class="n">cpair</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span><span class="p">)</span>
<a name="ln-6946"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">NoHeatOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6947"></a><span class="k">          </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>   <span class="c">!BG 10/22/2008 need a case for when its all suppl heat</span>
<a name="ln-6948"></a>          <span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">HeatCoilLoad</span><span class="o">/</span><span class="p">(</span><span class="n">cpair</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span><span class="p">)</span>
<a name="ln-6949"></a>        <span class="k">ELSE</span>
<a name="ln-6950"></a><span class="k">          </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">SystemSensibleLoad</span> <span class="o">-</span> <span class="n">FullSensibleOutput</span><span class="p">))</span>
<a name="ln-6951"></a>          <span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">+</span> <span class="n">HeatCoilLoad</span><span class="o">/</span><span class="p">(</span><span class="n">cpair</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span><span class="p">)</span>
<a name="ln-6952"></a>        <span class="k">END IF</span>
<a name="ln-6953"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6954"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CondenserNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6955"></a><span class="k">             </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6956"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">NoHeatOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6957"></a><span class="k">               </span><span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6958"></a>             <span class="k">ELSE</span>
<a name="ln-6959"></a><span class="k">               </span><span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6960"></a>             <span class="n">ENDIF</span>
<a name="ln-6961"></a>          <span class="n">ENDIF</span>
<a name="ln-6962"></a>        <span class="k">ELSE</span>
<a name="ln-6963"></a><span class="k">          IF</span><span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6964"></a><span class="k">            </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6965"></a>             <span class="k">IF</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">NoHeatOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6966"></a><span class="k">               </span><span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6967"></a>             <span class="k">ELSE</span>
<a name="ln-6968"></a><span class="k">               </span><span class="n">TempOutHeatingCoil</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-6969"></a>             <span class="n">ENDIF</span>
<a name="ln-6970"></a>          <span class="n">ENDIF</span>
<a name="ln-6971"></a>        <span class="n">ENDIF</span>
<a name="ln-6972"></a>        <span class="n">cpair</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-6973"></a>       <span class="c">! TempOutHeatingCoil = Node(FurnaceOutletNode)%Temp + HeatCoilLoad/(cpair*Furnace(FurnaceNum)%MdotFurnace)</span>
<a name="ln-6974"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">TempOutHeatingCoil</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">HeatCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0D0</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6975"></a>         <span class="c">! deltaT = Furnace(FurnaceNum)%DesignMaxOutletTemp - Node(FurnaceOutletNode)%Temp</span>
<a name="ln-6976"></a>            <span class="c">!BG 10/22/2008 above made no sense if DX heat is off and its all supplemental,</span>
<a name="ln-6977"></a>            <span class="c">!  because Node(FurnaceOutletNode)%Temp will have been calc&#39;d with full DX heat in last faux call to CalcFurnaceOutput</span>
<a name="ln-6978"></a>
<a name="ln-6979"></a>          <span class="n">deltaT</span> <span class="o">=</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="n">TempOutHeatingCoil</span><span class="p">)</span>
<a name="ln-6980"></a>          <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">HeatCoilLoad</span> <span class="o">-</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">cpair</span> <span class="o">*</span> <span class="n">deltaT</span><span class="p">)</span>
<a name="ln-6981"></a>          <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0D0</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">)</span>
<a name="ln-6982"></a>        <span class="k">END IF</span>
<a name="ln-6983"></a><span class="k">      ELSE</span>
<a name="ln-6984"></a><span class="k">        </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6985"></a>      <span class="k">END IF</span>
<a name="ln-6986"></a><span class="k">      </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-6987"></a>
<a name="ln-6988"></a><span class="c">!   HeatCool systems can have both a sensible and latent PLR in a single time step</span>
<a name="ln-6989"></a><span class="c">!   (i.e. both cooling and heating can occur in a single time step)</span>
<a name="ln-6990"></a>    <span class="k">ELSE</span>  <span class="c">! else not a heatpump DX coil</span>
<a name="ln-6991"></a>
<a name="ln-6992"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-6993"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-6994"></a>      <span class="n">SystemSensibleLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-6995"></a>
<a name="ln-6996"></a>
<a name="ln-6997"></a>      <span class="c">! Get no load result</span>
<a name="ln-6998"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-6999"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7000"></a>      <span class="k">END IF</span>
<a name="ln-7001"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7002"></a><span class="k">        </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! The on/off fan will not cycle, so set part-load fraction = 1</span>
<a name="ln-7003"></a>      <span class="k">END IF</span>
<a name="ln-7004"></a>
<a name="ln-7005"></a><span class="c">!     Set the inlet mass flow rate based on user specified coil OFF flow rate</span>
<a name="ln-7006"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7007"></a>      <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7008"></a>
<a name="ln-7009"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">MinPLR</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">NoHeatOutput</span><span class="p">,</span><span class="n">NoLatentOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7010"></a>                             <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7011"></a>
<a name="ln-7012"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NoHeatOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7013"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-7014"></a>
<a name="ln-7015"></a>        <span class="c">! Set fan part-load fraction equal to 1 while getting full load result</span>
<a name="ln-7016"></a>        <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7017"></a>        <span class="n">OnOffAirFlowRatio</span>        <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7018"></a>
<a name="ln-7019"></a>        <span class="c">! Get full load result</span>
<a name="ln-7020"></a>        <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7021"></a>                               <span class="n">FullSensibleOutput</span><span class="p">,</span><span class="n">FullLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7022"></a>      <span class="k">ELSE</span>
<a name="ln-7023"></a><span class="k">        </span><span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">NoHeatOutput</span> <span class="o">+</span> <span class="mf">0.000000001d0</span>
<a name="ln-7024"></a>      <span class="k">END IF</span>
<a name="ln-7025"></a>
<a name="ln-7026"></a>      <span class="c">! Since we are heating, we expect FullSensibleOutput to be &gt; 0 and FullSensibleOutput &gt; NoSensibleOutput</span>
<a name="ln-7027"></a>      <span class="c">! Check that this is the case; if not set PartLoadRatio = 0.0 (off) and return</span>
<a name="ln-7028"></a>
<a name="ln-7029"></a>
<a name="ln-7030"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FullSensibleOutput</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">NoHeatOutput</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7031"></a>
<a name="ln-7032"></a><span class="c">!       check bounds on sensible output prior to iteration using RegulaFalsi</span>
<a name="ln-7033"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">FullSensibleOutput</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7034"></a><span class="k">          </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7035"></a><span class="c">!         save modified HeatCoilLoad in case it was reset because outlet temp &gt; DesignMaxOutletTemp</span>
<a name="ln-7036"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ModifiedHeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7037"></a><span class="k">            </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">ModifiedHeatCoilLoad</span>
<a name="ln-7038"></a>          <span class="k">ELSE</span>
<a name="ln-7039"></a><span class="k">            </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-7040"></a>          <span class="k">END IF</span>
<a name="ln-7041"></a><span class="k">        </span><span class="n">ELSEIF</span><span class="p">(</span><span class="n">NoHeatOutput</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7042"></a><span class="k">          </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7043"></a>          <span class="n">HeatCoilLoad</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7044"></a>        <span class="k">ELSE</span>
<a name="ln-7045"></a>
<a name="ln-7046"></a>          <span class="c">! Calculate the part load ratio through iteration</span>
<a name="ln-7047"></a>          <span class="n">HeatErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-7048"></a>
<a name="ln-7049"></a>          <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations if positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-7050"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7051"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-7052"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-7053"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">OpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7054"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOp</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7055"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">SystemSensibleLoad</span>
<a name="ln-7056"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-7057"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-7058"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE mass flow rate over time step</span>
<a name="ln-7059"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HXUnitOn is always false for HX</span>
<a name="ln-7060"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7061"></a><span class="c">!         HeatErrorToler is in fraction load, MaxIter = 30, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-7062"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HeatErrorToler</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CalcFurnaceResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7063"></a><span class="c">!         OnOffAirFlowRatio is updated during the above iteration. Reset to correct value based on PLR.</span>
<a name="ln-7064"></a>          <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatioSave</span>
<a name="ln-7065"></a><span class="c">!         Reset HeatCoilLoad calculated in CalcFurnaceResidual (in case it was reset because output temp &gt; DesignMaxOutletTemp)</span>
<a name="ln-7066"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">ModifiedHeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7067"></a><span class="k">            </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">ModifiedHeatCoilLoad</span>
<a name="ln-7068"></a>          <span class="k">ELSE</span>
<a name="ln-7069"></a><span class="k">            </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7070"></a>          <span class="k">END IF</span>
<a name="ln-7071"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7072"></a>
<a name="ln-7073"></a><span class="c">!           RegulaFalsi may not find heating PLR when the maximum supply air temperature is exceeded.</span>
<a name="ln-7074"></a><span class="c">!           If iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-7075"></a>            <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-7076"></a>            <span class="n">TempHeatOutput</span> <span class="o">=</span> <span class="n">NoHeatOutput</span>
<a name="ln-7077"></a>            <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempHeatOutput</span> <span class="o">-</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-7078"></a><span class="c">!             find upper limit of HeatingPLR</span>
<a name="ln-7079"></a>              <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-7080"></a>              <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">TempMaxPLR</span>
<a name="ln-7081"></a>              <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7082"></a>                   <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempMaxPLR</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempHeatOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7083"></a>            <span class="k">END DO</span>
<a name="ln-7084"></a><span class="k">            </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-7085"></a>            <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempHeatOutput</span> <span class="o">-</span> <span class="n">SystemSensibleLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7086"></a><span class="c">!             pull upper limit of HeatingPLR down to last valid limit (i.e. heat output still exceeds SystemSensibleLoad)</span>
<a name="ln-7087"></a>              <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-7088"></a><span class="c">!             find minimum limit of HeatingPLR</span>
<a name="ln-7089"></a>              <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.01d0</span>
<a name="ln-7090"></a>
<a name="ln-7091"></a>              <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">TempMinPLR</span>
<a name="ln-7092"></a>              <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7093"></a>                   <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempMinPLR</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempHeatOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7094"></a>            <span class="k">END DO</span>
<a name="ln-7095"></a><span class="c">!           Now solve again with tighter PLR limits</span>
<a name="ln-7096"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HeatErrorToler</span><span class="p">,</span><span class="n">MaxIter</span><span class="p">,</span><span class="n">SolFlag</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">CalcFurnaceResidual</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-7097"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">ModifiedHeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7098"></a><span class="k">              </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">ModifiedHeatCoilLoad</span>
<a name="ln-7099"></a>            <span class="k">ELSE</span>
<a name="ln-7100"></a><span class="k">              </span><span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-7101"></a>            <span class="k">END IF</span>
<a name="ln-7102"></a><span class="k">            CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7103"></a>                    <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempHeatOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7104"></a>
<a name="ln-7105"></a><span class="c">!           After iterating with tighter boundaries, if still out of tolerance, show warning.</span>
<a name="ln-7106"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">SystemSensibleLoad</span> <span class="o">-</span> <span class="n">TempHeatOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7107"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7108"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Heating coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7109"></a>                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7110"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating heating coil sensible part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-7111"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7112"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), sensible output of heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7113"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempHeatOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7114"></a>              <span class="k">END IF</span>
<a name="ln-7115"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7116"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7117"></a>                  <span class="s1">&#39; sensible heating part-load ratio error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7118"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingMaxIterIndex</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>
<a name="ln-7119"></a>            <span class="k">END IF</span>
<a name="ln-7120"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7121"></a><span class="k">            IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingRegulaFalsiFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7122"></a><span class="k">              CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Heating coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7123"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7124"></a>              <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Sensible heating part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-7125"></a>              <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by heating coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7126"></a>                   <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7127"></a>            <span class="k">END IF</span>
<a name="ln-7128"></a><span class="k">            CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7129"></a>                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7130"></a>                <span class="s1">&#39; Sensible heating part-load ratio out of range error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7131"></a>                <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingRegulaFalsiFailedIndex</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">,</span><span class="n">SystemSensibleLoad</span><span class="p">)</span>
<a name="ln-7132"></a>          <span class="k">END IF</span>
<a name="ln-7133"></a><span class="k">        END IF</span>
<a name="ln-7134"></a>
<a name="ln-7135"></a><span class="k">      ELSE</span>  <span class="c">!ELSE from IF(FullSensibleOutput.GT.NoSensibleOutput)THEN above</span>
<a name="ln-7136"></a>        <span class="c">! Set part load ratio to 1 and run heater at design heating capacity</span>
<a name="ln-7137"></a>        <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7138"></a>        <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span>
<a name="ln-7139"></a>      <span class="k">END IF</span>
<a name="ln-7140"></a>
<a name="ln-7141"></a><span class="k">    END IF</span> <span class="c">!End of IF HeatPump</span>
<a name="ln-7142"></a>
<a name="ln-7143"></a>  <span class="k">END IF</span> <span class="c">!End of IF for heating</span>
<a name="ln-7144"></a>
<a name="ln-7145"></a><span class="c">! Non-heat pump systems do not set a heating PLR, set it here for use with the DX cooling coil calculations.</span>
<a name="ln-7146"></a><span class="c">! Set this variable back to 0 for non-heat pump systems at the end of this routine.</span>
<a name="ln-7147"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-7148"></a>  <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7149"></a>                         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-7150"></a>                         <span class="n">HeatingSensibleOutput</span><span class="p">,</span><span class="n">HeatingLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7151"></a>
<a name="ln-7152"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span>  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7153"></a>     <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7154"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span> <span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7155"></a><span class="k">      </span><span class="n">HeatingSensibleOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7156"></a>      <span class="n">HeatingLatentOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7157"></a>  <span class="n">ENDIF</span>
<a name="ln-7158"></a><span class="c">!***********Cooling Section*****************</span>
<a name="ln-7159"></a><span class="c">! Simulate if scheduled ON and cooling load or if a moisture load exists when using a humidistat</span>
<a name="ln-7160"></a><span class="c">! Check of HeatingLatentOutput is used to reduce overshoot during simultaneous heating and cooling</span>
<a name="ln-7161"></a><span class="c">! Setback flag is used to avoid continued RH control when Tstat is setback (RH should float down)</span>
<a name="ln-7162"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7163"></a>       <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7164"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7165"></a>       <span class="p">(</span><span class="n">SystemMoistureLoad</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7166"></a>       <span class="n">HeatingLatentOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Setback</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)))))</span> <span class="k">THEN</span>
<a name="ln-7167"></a>
<a name="ln-7168"></a>
<a name="ln-7169"></a><span class="c">!     For cooling operation, the first step is to set the HX operation flag in case a HX assisted coil is used.</span>
<a name="ln-7170"></a><span class="c">!      (if a HX assisted coil is not used, this flag is not used. It&#39;s only used in the CALL to SimHXAssistedCoolingCoil)</span>
<a name="ln-7171"></a><span class="c">!     Check the dehumidification control type:</span>
<a name="ln-7172"></a><span class="c">!           For dehumidification control options CoolReheat and None, the HX is always active (locked ON).</span>
<a name="ln-7173"></a><span class="c">!           For dehumidification control option Multimode, the system is operated first with the HX off.</span>
<a name="ln-7174"></a><span class="c">!           If the moisture load is not met, the HX will then be turned on and the system is re-simulated.</span>
<a name="ln-7175"></a>
<a name="ln-7176"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7177"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_None</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7178"></a><span class="k">        </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7179"></a>      <span class="k">ELSE</span>
<a name="ln-7180"></a><span class="k">        </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7181"></a>      <span class="k">END IF</span>
<a name="ln-7182"></a>
<a name="ln-7183"></a><span class="c">!     The next step is to determine the system output at no load (PLR=0) and full load (PLR=1)</span>
<a name="ln-7184"></a>
<a name="ln-7185"></a><span class="c">!     Set the inlet mass flow rate based on user specified coil OFF flow rate</span>
<a name="ln-7186"></a>      <span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7187"></a>
<a name="ln-7188"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">!compressor off</span>
<a name="ln-7189"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7190"></a>
<a name="ln-7191"></a><span class="c">!     SetAverageAirFlow calculates the operating mass flow rate based on PLR and the user specified inputs</span>
<a name="ln-7192"></a><span class="c">!     for MaxCoolAirMassFlow and MaxNoCoolHeatAirMassFlow.</span>
<a name="ln-7193"></a><span class="c">!     Air flow rate is set according to max of cooling and heating PLR if heating and latent load exists.</span>
<a name="ln-7194"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7195"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7196"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7197"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7198"></a>        <span class="p">(</span><span class="n">SystemMoistureLoad</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7199"></a>         <span class="n">HeatingLatentOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Setback</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))))</span> <span class="k">THEN</span>
<a name="ln-7200"></a><span class="k">         </span><span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-7201"></a>        <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7202"></a>
<a name="ln-7203"></a>      <span class="k">ELSE</span>
<a name="ln-7204"></a><span class="k">        </span><span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7205"></a>        <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7206"></a>
<a name="ln-7207"></a>      <span class="k">END IF</span>
<a name="ln-7208"></a>
<a name="ln-7209"></a>      <span class="c">! Get no load result (coils simulated OFF)</span>
<a name="ln-7210"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">MinPLR</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7211"></a>                             <span class="n">NoCoolOutput</span><span class="p">,</span> <span class="n">NoLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">CoolingHeatingPLRRatio</span><span class="p">)</span>
<a name="ln-7212"></a>
<a name="ln-7213"></a><span class="c">!     Don&#39;t calculate full load output if no load output can meet sensible load</span>
<a name="ln-7214"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">NoCoolOutput</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">CoolCoilLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">CoolCoilLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HPDehumidificationLoadFlag</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7215"></a><span class="c">!       Set full mass flow rate for full load calculation</span>
<a name="ln-7216"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-7217"></a>
<a name="ln-7218"></a>
<a name="ln-7219"></a>        <span class="c">! Set fan part-load fraction equal to 1 while getting full load result</span>
<a name="ln-7220"></a>        <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7221"></a>        <span class="n">OnOffAirFlowRatio</span>        <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7222"></a>        <span class="n">PartLoadRatio</span>            <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7223"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">!compressor ON</span>
<a name="ln-7224"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7225"></a>
<a name="ln-7226"></a>        <span class="c">! Get full load result (coils simulated full ON)</span>
<a name="ln-7227"></a>        <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7228"></a>                               <span class="n">FullSensibleOutput</span><span class="p">,</span> <span class="n">FullLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7229"></a>      <span class="k">ELSE</span>
<a name="ln-7230"></a><span class="k">        </span><span class="n">FullSensibleOutput</span> <span class="o">=</span> <span class="n">NoCoolOutput</span> <span class="o">-</span> <span class="mf">0.00000001d0</span>
<a name="ln-7231"></a>      <span class="k">END IF</span>
<a name="ln-7232"></a>
<a name="ln-7233"></a><span class="c">!     The next step is to compare the results of the full load and no load results</span>
<a name="ln-7234"></a><span class="c">!</span>
<a name="ln-7235"></a><span class="c">!     1) Since we are cooling, we expect FullSensibleOutput &lt; NoCoolOutput</span>
<a name="ln-7236"></a><span class="c">!        Check that this is the case; if not set PartLoadRatio = 0.0 (off)</span>
<a name="ln-7237"></a><span class="c">!     2) Verify that the load to be met is within the range of available output</span>
<a name="ln-7238"></a><span class="c">!        (i.e. between FullSensibleOutput and NoCoolOutput)</span>
<a name="ln-7239"></a><span class="c">!     3) Set PLR if load is out of range or RegulaFalsi on PLR if system can meet the load</span>
<a name="ln-7240"></a><span class="c">!</span>
<a name="ln-7241"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">FullSensibleOutput</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">NoCoolOutput</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7242"></a><span class="k">        IF</span><span class="p">(</span><span class="n">CoolCoilLoad</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HPDehumidificationLoadFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7243"></a>
<a name="ln-7244"></a><span class="c">!           check bounds on sensible output prior to iteration using RegulaFalsi</span>
<a name="ln-7245"></a><span class="c">!           Negative value represents cooling load, IF FullSensibleOutput .GT. CoolCoilLoad, load is greater than capacity</span>
<a name="ln-7246"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FullSensibleOutput</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="n">CoolCoilLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7247"></a><span class="k">              </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7248"></a><span class="c">!           Likewise IF NoCoolOutput .LT. CoolCoilLoad, then load can be met using only the fan (constant fan mode only)</span>
<a name="ln-7249"></a>            <span class="n">ELSEIF</span><span class="p">(</span><span class="n">NoCoolOutput</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">CoolCoilLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7250"></a><span class="k">              </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7251"></a><span class="c">!           ELSE load is between NoCoolOutput and FullSensibleOuput, find PLR required to meet load</span>
<a name="ln-7252"></a>            <span class="k">ELSE</span>
<a name="ln-7253"></a>
<a name="ln-7254"></a>            <span class="c">! Calculate the sensible part load ratio through iteration</span>
<a name="ln-7255"></a>              <span class="n">CoolErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingConvergenceTolerance</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-7256"></a>              <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations if positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-7257"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7258"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-7259"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-7260"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">OpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7261"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOp</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7262"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">CoolCoilLoad</span>
<a name="ln-7263"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-7264"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-7265"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE mass flow rate over time step</span>
<a name="ln-7266"></a>              <span class="k">IF</span><span class="p">(</span><span class="n">HXUnitOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7267"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7268"></a>              <span class="k">ELSE</span>
<a name="ln-7269"></a><span class="k">                </span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7270"></a>              <span class="k">END IF</span>
<a name="ln-7271"></a><span class="c">!             Par(10) is the heating coil PLR, set this value to 0 for sensible PLR calculations.</span>
<a name="ln-7272"></a>              <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7273"></a><span class="c">!             CoolErrorToler is in fraction of load, MaxIter = 30, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-7274"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">CoolErrorToler</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">CalcFurnaceResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7275"></a><span class="c">!             OnOffAirFlowRatio is updated during the above iteration. Reset to correct value based on PLR.</span>
<a name="ln-7276"></a>              <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatioSave</span>
<a name="ln-7277"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7278"></a><span class="k">                CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7279"></a>                               <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7280"></a>                <span class="k">IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7281"></a><span class="k">                  IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">CoolCoilLoad</span> <span class="o">-</span> <span class="n">TempCoolOutput</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7282"></a><span class="k">                    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7283"></a><span class="k">                      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7284"></a>                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7285"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating DX cooling coil sensible part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-7286"></a>                      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7287"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoolCoilLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), sensible output of DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7288"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempCoolOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7289"></a>                    <span class="k">END IF</span>
<a name="ln-7290"></a><span class="k">                    CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7291"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7292"></a>                        <span class="s1">&#39; sensible cooling part-load ratio error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7293"></a>                        <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleMaxIterIndex</span><span class="p">,</span><span class="n">CoolCoilLoad</span><span class="p">,</span><span class="n">CoolCoilLoad</span><span class="p">)</span>
<a name="ln-7294"></a>                  <span class="k">END IF</span>
<a name="ln-7295"></a><span class="k">                END IF</span>
<a name="ln-7296"></a><span class="k">              ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7297"></a><span class="k">                IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7298"></a><span class="k">                  IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleRegulaFalsiFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7299"></a><span class="k">                    CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7300"></a>                            <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7301"></a>                    <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Cooling sensible part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-7302"></a>                    <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  Cooling sensible load = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoolCoilLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7303"></a>                  <span class="k">END IF</span>
<a name="ln-7304"></a><span class="k">                  CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7305"></a>                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Cooling sensible part-load ratio out of range&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7306"></a>                      <span class="s1">&#39; error continues. Sensible cooling load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7307"></a>                      <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleRegulaFalsiFailedIndex</span><span class="p">,</span><span class="n">CoolCoilLoad</span><span class="p">,</span><span class="n">CoolCoilLoad</span><span class="p">)</span>
<a name="ln-7308"></a>                <span class="k">END IF</span>
<a name="ln-7309"></a><span class="k">              END IF</span>
<a name="ln-7310"></a><span class="k">            END IF</span>
<a name="ln-7311"></a>
<a name="ln-7312"></a><span class="k">        ELSE</span>
<a name="ln-7313"></a><span class="k">          </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7314"></a>        <span class="k">END IF</span> <span class="c">! EndIf for IF(CoolCoilLoad.NE.0.0)</span>
<a name="ln-7315"></a>
<a name="ln-7316"></a><span class="c">!       Calculate the delivered capacity from the PLR caculated above</span>
<a name="ln-7317"></a>        <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7318"></a>                               <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7319"></a>
<a name="ln-7320"></a><span class="c">!       Calculate the latent part load ratio through iteration</span>
<a name="ln-7321"></a><span class="c">!       Negative SystemMoistureLoad means dehumidification load is present</span>
<a name="ln-7322"></a><span class="c">!</span>
<a name="ln-7323"></a><span class="c">!       IF this furnace uses MultiMode control AND there is a moisture load AND the moisture load met by the furnace in</span>
<a name="ln-7324"></a><span class="c">!       cooling only mode above is sufficient to meet the moisture demand OR there is no sensible load (PLR=0 from above)</span>
<a name="ln-7325"></a><span class="c">!       then set LatentPartLoadRatio to 0 (no additional dehumidification is required).</span>
<a name="ln-7326"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_Multimode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">((</span><span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7327"></a>           <span class="n">TempLatentOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">PartLoadRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7328"></a><span class="k">          </span><span class="n">LatentPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7329"></a><span class="c">!       ELSE calculate a new PLR for valid dehumidification control types if a moisture load exists.</span>
<a name="ln-7330"></a>        <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">/=</span> <span class="n">DehumidControl_None</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7331"></a>             <span class="p">(</span><span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempLatentOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span> <span class="p">&amp;</span>
<a name="ln-7332"></a>             <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Setback</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">))))</span><span class="k">THEN</span>
<a name="ln-7333"></a>
<a name="ln-7334"></a><span class="c">!         IF the furnace uses dehumidification control MultiMode, turn on the HX and calculate the latent output with</span>
<a name="ln-7335"></a><span class="c">!         the HX ON to compare to the moisture load predicted by the humidistat.</span>
<a name="ln-7336"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7337"></a><span class="k">            </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7338"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-7339"></a>            <span class="c">! Set fan part-load fraction equal to 1 while getting full load result</span>
<a name="ln-7340"></a>            <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7341"></a>            <span class="n">OnOffAirFlowRatio</span>        <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7342"></a>            <span class="c">! Get full load result</span>
<a name="ln-7343"></a>            <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7344"></a>                             <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7345"></a>          <span class="k">END IF</span>
<a name="ln-7346"></a>
<a name="ln-7347"></a><span class="c">!         Set the global cooling to heating PLR ratio. CoolHeatPLRRat = MIN(1,CoolingPLR/HeatingPLR)</span>
<a name="ln-7348"></a>          <span class="n">CoolHeatPLRRat</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! means cooling dominated operation (applies to cycling fan mode)</span>
<a name="ln-7349"></a>
<a name="ln-7350"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TempLatentOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7351"></a><span class="c">!           Set full mass flow rate for full load calculation</span>
<a name="ln-7352"></a>            <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-7353"></a>
<a name="ln-7354"></a>
<a name="ln-7355"></a>            <span class="c">! Set fan part-load fraction equal to 1 while getting full load result</span>
<a name="ln-7356"></a>            <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7357"></a>            <span class="n">OnOffAirFlowRatio</span>        <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7358"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">!compressor ON</span>
<a name="ln-7359"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7360"></a>
<a name="ln-7361"></a>            <span class="c">! Get full load result (coils simulated full ON)</span>
<a name="ln-7362"></a>            <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7363"></a>                                   <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-7364"></a>          <span class="k">END IF</span>
<a name="ln-7365"></a>
<a name="ln-7366"></a><span class="c">!         check bounds on latent output prior to iteration using RegulaFalsi</span>
<a name="ln-7367"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">TempLatentOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7368"></a>            <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_Multimode</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempCoolOutput</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="n">CoolCoilLoad</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7369"></a><span class="k">            </span><span class="n">LatentPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7370"></a>          <span class="n">ELSEIF</span><span class="p">(</span><span class="n">NoLatentOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">HeatingLatentOutput</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7371"></a><span class="k">            </span><span class="n">LatentPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7372"></a>          <span class="k">ELSE</span>
<a name="ln-7373"></a>
<a name="ln-7374"></a><span class="k">            </span><span class="n">CoolErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingConvergenceTolerance</span> <span class="c">!Error tolerance for convergence</span>
<a name="ln-7375"></a>
<a name="ln-7376"></a>            <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations if positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-7377"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7378"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-7379"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-7380"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">OpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7381"></a>            <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOp</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7382"></a><span class="c">!           Multimode always controls to meet the SENSIBLE load (however, HXUnitOn is now TRUE)</span>
<a name="ln-7383"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7384"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">CoolCoilLoad</span>
<a name="ln-7385"></a>            <span class="k">ELSE</span>
<a name="ln-7386"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">SystemMoistureLoad</span>
<a name="ln-7387"></a>            <span class="k">END IF</span>
<a name="ln-7388"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-7389"></a><span class="c">!           Multimode always controls to meet the SENSIBLE load (however, HXUnitOn is now TRUE)</span>
<a name="ln-7390"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7391"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-7392"></a>            <span class="k">ELSE</span>
<a name="ln-7393"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7394"></a>            <span class="k">END IF</span>
<a name="ln-7395"></a><span class="k">            </span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE mass flow rate over time step</span>
<a name="ln-7396"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">HXUnitOn</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7397"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7398"></a>            <span class="k">ELSE</span>
<a name="ln-7399"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7400"></a>            <span class="k">END IF</span>
<a name="ln-7401"></a><span class="c">!           Par(10) used only with cycling fan.</span>
<a name="ln-7402"></a><span class="c">!           Par(10) is the heating coil PLR, set this value only if there is a heating load (heating PLR &gt; 0)</span>
<a name="ln-7403"></a><span class="c">!           and the latent PLR is being calculated. Otherwise set Par(10) to 0.</span>
<a name="ln-7404"></a>            <span class="k">IF</span><span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7405"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span>
<a name="ln-7406"></a>            <span class="k">ELSE</span>
<a name="ln-7407"></a><span class="k">              </span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7408"></a>            <span class="k">END IF</span>
<a name="ln-7409"></a><span class="c">!           CoolErrorToler is in fraction of load, MaxIter = 30, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-7410"></a>            <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">CoolErrorToler</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">LatentPartLoadRatio</span><span class="p">,</span> <span class="n">CalcFurnaceResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7411"></a><span class="c">!           OnOffAirFlowRatio is updated during the above iteration. Reset to correct value based on PLR.</span>
<a name="ln-7412"></a>            <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatioSave</span>
<a name="ln-7413"></a>            <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7414"></a><span class="c">!             RegulaFalsi may not find latent PLR when the latent degradation model is used.</span>
<a name="ln-7415"></a><span class="c">!             If iteration limit is exceeded, find tighter boundary of solution and repeat RegulaFalsi</span>
<a name="ln-7416"></a>              <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1d0</span>
<a name="ln-7417"></a>              <span class="n">TempLatentOutput</span> <span class="o">=</span> <span class="n">NoLatentOutput</span>
<a name="ln-7418"></a>              <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempLatentOutput</span> <span class="o">-</span> <span class="n">SystemMoistureLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMaxPLR</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span>
<a name="ln-7419"></a><span class="c">!               find upper limit of LatentPLR</span>
<a name="ln-7420"></a>                <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span> <span class="o">+</span> <span class="mf">0.1d0</span>
<a name="ln-7421"></a>
<a name="ln-7422"></a><span class="c">!               Same calculation as is done in Function CalcFurnaceResidual for latent PLR calculation.</span>
<a name="ln-7423"></a><span class="c">!               Set cooling to heating PLR for use with Subroutine CalcFurnaceOutput. IF Par(10) = 0,</span>
<a name="ln-7424"></a><span class="c">!               heating PLR = 0 so set the CoolingHeatingPLRRatio to 1 so the cooling PLR is used in the</span>
<a name="ln-7425"></a><span class="c">!               DX cooling coil calculations.</span>
<a name="ln-7426"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7427"></a><span class="c">!                 Par(10) = Furnace(FurnaceNum)%HeatPartLoadRatio</span>
<a name="ln-7428"></a><span class="c">!                 OpMode = CycFan and Furnace(FurnaceNum)%HeatPartLoadRatio must be &gt; 0 for Part(10) to be greater than 0</span>
<a name="ln-7429"></a>                  <span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-7430"></a>                <span class="k">ELSE</span>
<a name="ln-7431"></a><span class="k">                  </span><span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7432"></a>                <span class="k">END IF</span>
<a name="ln-7433"></a>
<a name="ln-7434"></a><span class="k">                CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7435"></a>                                       <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7436"></a>                                       <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">CoolingHeatingPLRRatio</span><span class="p">)</span>
<a name="ln-7437"></a>              <span class="k">END DO</span>
<a name="ln-7438"></a><span class="k">              </span><span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMaxPLR</span>
<a name="ln-7439"></a>              <span class="k">DO WHILE</span><span class="p">((</span><span class="n">TempLatentOutput</span> <span class="o">-</span> <span class="n">SystemMoistureLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">TempMinPLR</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>
<a name="ln-7440"></a><span class="c">!               pull upper limit of LatentPLR down to last valid limit (i.e. latent output still exceeds SystemMoisuterLoad)</span>
<a name="ln-7441"></a><span class="c">!               CR7558 - relax final limits to allow HX assisted coils to converge</span>
<a name="ln-7442"></a>                <span class="n">TempMaxPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">+</span> <span class="mf">0.001d0</span>
<a name="ln-7443"></a><span class="c">!               find minimum limit of Latent PLR</span>
<a name="ln-7444"></a>                <span class="n">TempMinPLR</span> <span class="o">=</span> <span class="n">TempMinPLR</span> <span class="o">-</span> <span class="mf">0.001d0</span>
<a name="ln-7445"></a>
<a name="ln-7446"></a><span class="c">!               Set cooling to heating PLR for use with Subroutine CalcFurnaceOutput.</span>
<a name="ln-7447"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7448"></a><span class="c">!                 Par(10) = Furnace(FurnaceNum)%HeatPartLoadRatio</span>
<a name="ln-7449"></a><span class="c">!                 OpMode = CycFan and Furnace(FurnaceNum)%HeatPartLoadRatio must be &gt; 0 for Part(10) to be greater than 0</span>
<a name="ln-7450"></a><span class="c">!                 Since the latent output of cycling fan systems is 0 at PLR=0, do not allow the PLR to be 0,</span>
<a name="ln-7451"></a><span class="c">!                 otherwise RegulaFalsi can fail when a heating and moisture load exists and heating PLR &gt; latent PLR.</span>
<a name="ln-7452"></a>                  <span class="n">TempMinPLR2</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0000000001d0</span><span class="p">,</span><span class="n">TempMinPLR</span><span class="p">)</span>
<a name="ln-7453"></a>                  <span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">TempMinPLR2</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-7454"></a>                <span class="k">ELSE</span>
<a name="ln-7455"></a><span class="k">                  </span><span class="n">TempMinPLR2</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-7456"></a>                  <span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7457"></a>                <span class="k">END IF</span>
<a name="ln-7458"></a>
<a name="ln-7459"></a><span class="k">                CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">TempMinPLR2</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7460"></a>                                       <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7461"></a>                                       <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">CoolingHeatingPLRRatio</span><span class="p">)</span>
<a name="ln-7462"></a>              <span class="k">END DO</span>
<a name="ln-7463"></a><span class="c">!             tighter boundary of solution has been found, call RegulaFalsi a second time</span>
<a name="ln-7464"></a>              <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">CoolErrorToler</span><span class="p">,</span><span class="n">MaxIter</span><span class="p">,</span><span class="n">SolFlag</span><span class="p">,</span><span class="n">LatentPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7465"></a>                                    <span class="n">CalcFurnaceResidual</span><span class="p">,</span><span class="n">TempMinPLR2</span><span class="p">,</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-7466"></a><span class="c">!             OnOffAirFlowRatio is updated during the above iteration. Reset to correct value based on PLR.</span>
<a name="ln-7467"></a>              <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatioSave</span>
<a name="ln-7468"></a>              <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7469"></a>
<a name="ln-7470"></a><span class="c">!               Set cooling to heating PLR for use with Subroutine CalcFurnaceOutput.</span>
<a name="ln-7471"></a>                <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7472"></a><span class="c">!                 Par(10) = Furnace(FurnaceNum)%HeatPartLoadRatio</span>
<a name="ln-7473"></a><span class="c">!                 OpMode = CycFan and Furnace(FurnaceNum)%HeatPartLoadRatio must be &gt; 0 for Part(10) to be greater than 0</span>
<a name="ln-7474"></a>                  <span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">LatentPartLoadRatio</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-7475"></a>                <span class="k">ELSE</span>
<a name="ln-7476"></a><span class="k">                  </span><span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7477"></a>                <span class="k">END IF</span>
<a name="ln-7478"></a>
<a name="ln-7479"></a><span class="k">                CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">LatentPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7480"></a>                                       <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">TempCoolOutput</span><span class="p">,</span> <span class="n">TempLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7481"></a>                                       <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">CoolingHeatingPLRRatio</span><span class="p">)</span>
<a name="ln-7482"></a>                <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">((</span><span class="n">SystemMoistureLoad</span> <span class="o">-</span> <span class="n">TempLatentOutput</span><span class="p">)</span><span class="o">/</span><span class="n">SystemMoistureLoad</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CoolErrorToler</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7483"></a>                   <span class="nb">ABS</span><span class="p">(</span><span class="n">SystemMoistureLoad</span> <span class="o">-</span> <span class="n">TempLatentOutput</span><span class="p">).</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7484"></a><span class="k">                  IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7485"></a><span class="k">                    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7486"></a><span class="k">                      CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7487"></a>                             <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7488"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating cooling coil latent part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-7489"></a>                      <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Latent load convergence error (percent) = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7490"></a>                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">((</span><span class="n">SystemMoistureLoad</span> <span class="o">-</span> <span class="n">TempLatentOutput</span><span class="p">)</span><span class="o">/</span><span class="n">SystemMoistureLoad</span><span class="p">),</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7491"></a>                      <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Moisture load to be met by DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7492"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">SystemMoistureLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), Latent output of DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7493"></a>                           <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempLatentOutput</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7494"></a>                    <span class="n">ENDIF</span>
<a name="ln-7495"></a>                    <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7496"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7497"></a>                        <span class="s1">&#39; latent part-load ratio error continues. Latent load convergence error (percent) statistics follow.&#39;</span> <span class="p">&amp;</span>
<a name="ln-7498"></a>                        <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentMaxIterIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7499"></a>                            <span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">((</span><span class="n">SystemMoistureLoad</span> <span class="o">-</span> <span class="n">TempLatentOutput</span><span class="p">)</span><span class="o">/</span><span class="n">SystemMoistureLoad</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-7500"></a>                            <span class="mi">10</span><span class="mf">0.0d0</span><span class="o">*</span><span class="nb">ABS</span><span class="p">((</span><span class="n">SystemMoistureLoad</span> <span class="o">-</span> <span class="n">TempLatentOutput</span><span class="p">)</span><span class="o">/</span><span class="n">SystemMoistureLoad</span><span class="p">))</span>
<a name="ln-7501"></a>                  <span class="k">END IF</span>
<a name="ln-7502"></a><span class="k">                END IF</span>
<a name="ln-7503"></a><span class="k">              ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7504"></a><span class="k">                IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentRegulaFalsiFailedIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7505"></a><span class="k">                  CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7506"></a>                        <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7507"></a>                  <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Latent part-load ratio determined to be outside the range of &#39;</span> <span class="p">&amp;</span>
<a name="ln-7508"></a>                                       <span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempMinPLR</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; to &#39;</span><span class="o">//</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempMaxPLR</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a name="ln-7509"></a>                  <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;A PLR of &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TempMinPLR</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; will be used and the &#39;</span> <span class="p">&amp;</span>
<a name="ln-7510"></a>                                                <span class="o">//</span><span class="s1">&#39;simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7511"></a>                <span class="n">ENDIF</span>
<a name="ln-7512"></a>                <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7513"></a>                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Cooling sensible part-load ratio out of range&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7514"></a>                    <span class="s1">&#39; error continues. System moisture load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7515"></a>                    <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentRegulaFalsiFailedIndex2</span><span class="p">,</span><span class="n">SystemMoistureLoad</span><span class="p">,</span><span class="n">SystemMoistureLoad</span><span class="p">)</span>
<a name="ln-7516"></a>                <span class="n">LatentPartLoadRatio</span> <span class="o">=</span> <span class="n">TempMinPLR</span>
<a name="ln-7517"></a>              <span class="k">END IF</span>
<a name="ln-7518"></a><span class="k">            ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7519"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentRegulaFalsiFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7520"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7521"></a>                      <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7522"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Latent part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-7523"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;A PLR of 0 will be used and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7524"></a>              <span class="n">ENDIF</span>
<a name="ln-7525"></a>              <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7526"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Latent part-load ratio out of range or 0-1&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7527"></a>                  <span class="s1">&#39; error continues. System moisture load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7528"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentRegulaFalsiFailedIndex</span><span class="p">,</span><span class="n">SystemMoistureLoad</span><span class="p">,</span><span class="n">SystemMoistureLoad</span><span class="p">)</span>
<a name="ln-7529"></a>              <span class="n">LatentPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7530"></a>            <span class="k">END IF</span>
<a name="ln-7531"></a><span class="k">          END IF</span>
<a name="ln-7532"></a>
<a name="ln-7533"></a><span class="c">!         Cooling to heating PLR ratio is now known as CoolHeatPLRRat (Module level global set in CalcFurnaceOutput</span>
<a name="ln-7534"></a><span class="c">!         This same variable is use in Subroutine SimFurnace for final calculations.</span>
<a name="ln-7535"></a><span class="c">!         Get the actual output in case reheat needs to be calculated (HumControl=TRUE [latent PLR &gt; sensible PLR])</span>
<a name="ln-7536"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">LatentPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7537"></a>                                <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ActualSensibleOutput</span><span class="p">,</span> <span class="n">ActualLatentOutput</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7538"></a>                                <span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">CoolHeatPLRRat</span><span class="p">)</span>
<a name="ln-7539"></a>
<a name="ln-7540"></a>        <span class="k">ELSE</span>
<a name="ln-7541"></a><span class="k">          </span><span class="n">LatentPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7542"></a>        <span class="k">END IF</span> <span class="c">!ENDIF for valid dehumidification control types</span>
<a name="ln-7543"></a>
<a name="ln-7544"></a><span class="c">!       IF a humidistat is used and there is a moisture load, check if the latent PLR is greater than the (sensible) PLR</span>
<a name="ln-7545"></a><span class="c">!        IF(LatentPartLoadRatio .GT. PartLoadRatio .and. SystemMoistureLoad .lt. 0.0 .and. Furnace(FurnaceNum)%Humidistat) THEN</span>
<a name="ln-7546"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">LatentPartLoadRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">PartLoadRatio</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7547"></a><span class="c">!         For dehumidification mode CoolReheat, compare the Sensible and Latent PLR values, if latentPLR is greater</span>
<a name="ln-7548"></a><span class="c">!         than PLR (sensible), then overcooling is required and reheat will be activated using the HumControl flag.</span>
<a name="ln-7549"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7550"></a><span class="k">            </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">LatentPartLoadRatio</span>
<a name="ln-7551"></a>            <span class="n">HumControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-7552"></a>          <span class="k">END IF</span>
<a name="ln-7553"></a><span class="c">!         For dehumidification mode MultiMode, compare the Sensible and Latent PLR values, if latentPLR is</span>
<a name="ln-7554"></a><span class="c">!         greater than PLR (sensible), then use the latent PLR to control the unit.</span>
<a name="ln-7555"></a><span class="c">!         For MultiMode control, the latent PLR is found by enabling the HX and calculating a PLR required to meet the sensible</span>
<a name="ln-7556"></a><span class="c">!         load. Overcooling is not required, and reheat will not be activated using the HumControl flag.</span>
<a name="ln-7557"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_Multimode</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7558"></a><span class="k">            </span><span class="n">PartLoadRatio</span> <span class="o">=</span> <span class="n">LatentPartLoadRatio</span>
<a name="ln-7559"></a>          <span class="k">END IF</span>
<a name="ln-7560"></a><span class="k">        END IF</span>
<a name="ln-7561"></a>
<a name="ln-7562"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-7563"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">CompOp</span> <span class="o">==</span> <span class="n">Off</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7564"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7565"></a>        <span class="k">ELSE</span>
<a name="ln-7566"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-7567"></a>        <span class="k">END IF</span>
<a name="ln-7568"></a>
<a name="ln-7569"></a>
<a name="ln-7570"></a><span class="k">      ELSE</span>  <span class="c">!ELSE from IF(FullSensibleOutput.LT.NoCoolOutput)THEN above</span>
<a name="ln-7571"></a>      <span class="c">! CR8679 - Unitary Heat Cool control problem, will not run to meeting cooling load</span>
<a name="ln-7572"></a>      <span class="c">! underlying problem is that FullSensibleOutput is greater than 0 due to very high inlet temp, so the system should be on</span>
<a name="ln-7573"></a>      <span class="c">! NoCoolOutput was 0 since the defect file is a cycling fan system and the system was turned off</span>
<a name="ln-7574"></a>
<a name="ln-7575"></a>      <span class="c">! if FullSensibleOutput &gt; NoCoolOutput, it means the system cannot meet the load and will run full out</span>
<a name="ln-7576"></a>      <span class="c">! this same logic for WSHP does not seem to work (only the Unitary Heat Pump Compressor Part-Load Ratio report</span>
<a name="ln-7577"></a>      <span class="c">! variable was affected in the HeatPumpWaterToAirRHControl.idf file while other variables showed very small diffs).</span>
<a name="ln-7578"></a>      <span class="c">! The defect files meter.csv showed 2% diffs so this IF test is used to keep the results the same in that file.</span>
<a name="ln-7579"></a>      <span class="c">! Additional logic is used here to make sure the coil actually turned on, e.g., if DX coil PLR &gt; 0 then set to 1,</span>
<a name="ln-7580"></a>      <span class="c">! otherwise 0 (to make sure coil is actually ON and not off due to schedule, OAT, or other reason).</span>
<a name="ln-7581"></a>      <span class="c">! The global variable DXCoilPartLoadRatio(DXCoilNum) is not yet used for the WSHP to make the same check.</span>
<a name="ln-7582"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7583"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7584"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7585"></a>        <span class="k">ELSE</span>
<a name="ln-7586"></a><span class="k">          IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7587"></a><span class="k">            IF</span><span class="p">(</span><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ActualDXCoilIndexforHXAssisted</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7588"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7589"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7590"></a>            <span class="k">ELSE</span>
<a name="ln-7591"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7592"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7593"></a>            <span class="k">END IF</span>
<a name="ln-7594"></a><span class="k">          ELSE</span>
<a name="ln-7595"></a><span class="k">            IF</span><span class="p">(</span><span class="n">DXCoilPartLoadRatio</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7596"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7597"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7598"></a>            <span class="k">ELSE</span>
<a name="ln-7599"></a><span class="k">              </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7600"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7601"></a>            <span class="k">END IF</span>
<a name="ln-7602"></a><span class="k">          END IF</span>
<a name="ln-7603"></a><span class="k">        END IF</span>
<a name="ln-7604"></a><span class="k">      </span><span class="n">ENDIF</span>
<a name="ln-7605"></a>
<a name="ln-7606"></a><span class="c">!     Calculate the reheat coil output</span>
<a name="ln-7607"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">HumControl</span><span class="p">)</span><span class="k">THEN</span> <span class="c">! HumControl = .TRUE. if a Humidistat is installed and dehumdification control type is CoolReheat</span>
<a name="ln-7608"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7609"></a><span class="k">          </span><span class="n">QToHeatSetPt</span><span class="o">=</span><span class="p">(</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-7610"></a>                         <span class="n">SequencedOutputRequiredToHeatingSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7611"></a>                         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span>
<a name="ln-7612"></a>        <span class="k">ELSE</span>
<a name="ln-7613"></a><span class="k">          </span><span class="n">QToHeatSetPt</span><span class="o">=</span><span class="p">(</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToHeatingSP</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-7614"></a>                      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span>
<a name="ln-7615"></a>        <span class="n">ENDIF</span>
<a name="ln-7616"></a><span class="c">!       Cooling mode or floating condition and dehumidification is required</span>
<a name="ln-7617"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7618"></a><span class="c">!         Calculate the reheat coil load wrt the heating setpoint temperature. Reheat coil picks up</span>
<a name="ln-7619"></a><span class="c">!         the entire excess sensible cooling (DX cooling coil and impact of outdoor air).</span>
<a name="ln-7620"></a>          <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">QToHeatSetPt</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">))</span>
<a name="ln-7621"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="n">ReheatCoilLoad</span>
<a name="ln-7622"></a><span class="c">!       Heating mode and dehumidification is required</span>
<a name="ln-7623"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7624"></a><span class="c">!         Calculate the reheat coil load as the sensible capacity of the DX cooling coil only. Let</span>
<a name="ln-7625"></a><span class="c">!         the heating coil pick up the load due to outdoor air.</span>
<a name="ln-7626"></a>          <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">ActualSensibleOutput</span><span class="o">-</span><span class="n">NoCoolOutput</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-7627"></a><span class="c">!         Dehumidification is not required</span>
<a name="ln-7628"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7629"></a>             <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7630"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span> <span class="p">))</span> <span class="k">THEN</span>
<a name="ln-7631"></a><span class="k">              </span><span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">QToHeatSetPt</span><span class="p">,</span><span class="n">QToHeatSetPt</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">)</span>
<a name="ln-7632"></a>          <span class="n">ENDIF</span>
<a name="ln-7633"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ActualSensibleOutput</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-7634"></a>        <span class="k">ELSE</span>
<a name="ln-7635"></a><span class="k">          </span><span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7636"></a>        <span class="k">END IF</span>
<a name="ln-7637"></a><span class="k">      ELSE</span>
<a name="ln-7638"></a><span class="c">!       No humidistat installed</span>
<a name="ln-7639"></a>        <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7640"></a>      <span class="k">END IF</span>
<a name="ln-7641"></a><span class="k">    END IF</span> <span class="c">!End of cooling section IF statement</span>
<a name="ln-7642"></a>
<a name="ln-7643"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NoHeatOutput</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ReHeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7644"></a>    <span class="c">! Reduce reheat coil load if you are controlling high humidity but outside air</span>
<a name="ln-7645"></a>    <span class="c">! and/or the supply air fan is providing enough heat to meet the system sensible load.</span>
<a name="ln-7646"></a>    <span class="c">! This will bring the zone temp closer to the heating setpoint temp.</span>
<a name="ln-7647"></a>      <span class="n">ReHeatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ReHeatCoilLoad</span><span class="o">-</span><span class="p">(</span><span class="n">NoHeatOutput</span><span class="o">-</span><span class="n">SystemSensibleLoad</span><span class="p">))</span>
<a name="ln-7648"></a>    <span class="k">END IF</span>
<a name="ln-7649"></a>
<a name="ln-7650"></a>    <span class="c">! Set the final air flow. MdotFurnace will be used to set the fan part-load ratio in ReportFurnace</span>
<a name="ln-7651"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">HumControl</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SystemMoistureLoad</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7652"></a><span class="k">      IF</span><span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7653"></a><span class="c">!       set the flow rate at the maximum of the cooling and heating PLR&#39;s</span>
<a name="ln-7654"></a>        <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7655"></a>          <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7656"></a>      <span class="k">ELSE</span>
<a name="ln-7657"></a><span class="c">!       ELSE set the flow rate at the cooling PLR</span>
<a name="ln-7658"></a>        <span class="k">CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7659"></a>      <span class="k">END IF</span>
<a name="ln-7660"></a><span class="k">    ELSE</span>
<a name="ln-7661"></a><span class="k">      CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7662"></a>        <span class="nb">MAX</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-7663"></a>    <span class="k">END IF</span>
<a name="ln-7664"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-7665"></a>
<a name="ln-7666"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7667"></a>       <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WatertoAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7668"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-7669"></a><span class="k">    ELSE</span>
<a name="ln-7670"></a>    <span class="c">! Non-HeatPump (non-DX) heating coils do not set PLR, reset to 0 here. This variable was set for non-DX</span>
<a name="ln-7671"></a>    <span class="c">! coils to allow the SetAverageAirFlow CALL above to set the correct air mass flow rate. See this</span>
<a name="ln-7672"></a>    <span class="c">! IF block above in heating section. HeatPLR is not set in the ELSE part of the IF (only HeatCoilLoad is set).</span>
<a name="ln-7673"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7674"></a>    <span class="k">END IF</span>
<a name="ln-7675"></a>
<a name="ln-7676"></a><span class="c">!*********HVAC Scheduled OFF*************</span>
<a name="ln-7677"></a>    <span class="c">! No heating or cooling or dehumidification</span>
<a name="ln-7678"></a><span class="c">!!!LKL discrepancy with &lt; 0?</span>
<a name="ln-7679"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7680"></a>       <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7681"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7682"></a>      <span class="n">CoolCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7683"></a>      <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7684"></a>      <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7685"></a>      <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! System off, so set on/off fan part-load fraction = 1</span>
<a name="ln-7686"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7687"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7688"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7689"></a>    <span class="c">!set report variables</span>
<a name="ln-7690"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7691"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7692"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-7693"></a>    <span class="k">END IF</span>
<a name="ln-7694"></a>
<a name="ln-7695"></a>
<a name="ln-7696"></a><span class="k">  END IF</span>   <span class="c">! End of the FirstHVACIteration control of the mass flow If block</span>
<a name="ln-7697"></a>
<a name="ln-7698"></a>
<a name="ln-7699"></a>  <span class="c">! Set the fan inlet node flow rates</span>
<a name="ln-7700"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-7701"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-7702"></a><span class="k">RETURN</span>
<a name="ln-7703"></a><span class="k">END Subroutine </span><span class="n">CalcNewZoneHeatCoolFlowRates</span>
<a name="ln-7704"></a>
<a name="ln-7705"></a>
<a name="ln-7706"></a>
<a name="ln-7707"></a>
<a name="ln-7708"></a><span class="k">SUBROUTINE </span><span class="n">CalcWaterToAirHeatpump</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">ZoneLoad</span><span class="p">,</span><span class="n">MoistureLoad</span><span class="p">)</span>
<a name="ln-7709"></a>
<a name="ln-7710"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-7711"></a>          <span class="c">!       AUTHOR         Dan Fisher</span>
<a name="ln-7712"></a>          <span class="c">!       DATE WRITTEN   Feb 2004</span>
<a name="ln-7713"></a>          <span class="c">!       MODIFIED       R. Raustad (Oct 2006) Revised iteration technique</span>
<a name="ln-7714"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-7715"></a>
<a name="ln-7716"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-7717"></a>          <span class="c">! This subroutine manages the heat pump simulation</span>
<a name="ln-7718"></a>
<a name="ln-7719"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-7720"></a>          <span class="c">! Calculate the part-load ratio required to meet the zone sensible load.</span>
<a name="ln-7721"></a>
<a name="ln-7722"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-7723"></a>          <span class="c">! na</span>
<a name="ln-7724"></a>
<a name="ln-7725"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-7726"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-7727"></a>  <span class="k">USE </span><span class="n">InputProcessor</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">FindItemInList</span>
<a name="ln-7728"></a>  <span class="k">USE </span><span class="n">DataHeatBalFanSys</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAT</span>
<a name="ln-7729"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirToOANodeInfo</span>
<a name="ln-7730"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-7731"></a>
<a name="ln-7732"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-7733"></a>
<a name="ln-7734"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-7735"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FurnaceNum</span>          <span class="c">! index to Furnace</span>
<a name="ln-7736"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">AirLoopNum</span>          <span class="c">! index to air loop</span>
<a name="ln-7737"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span>  <span class="c">! TRUE on first HVAC iteration</span>
<a name="ln-7738"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">CompOp</span>              <span class="c">! compressor operation flag (1=On, 0=Off)</span>
<a name="ln-7739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">ZoneLoad</span>            <span class="c">! the control zone load (watts)</span>
<a name="ln-7740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">MoistureLoad</span>        <span class="c">! the control zone latent load (watts)</span>
<a name="ln-7741"></a>
<a name="ln-7742"></a>
<a name="ln-7743"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-7744"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">PARAMETER</span>    <span class="kd">::</span>  <span class="n">MaxIter</span> <span class="o">=</span> <span class="mi">600</span>    <span class="c">! maximum number of iterations</span>
<a name="ln-7745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>    <span class="kd">::</span>  <span class="n">MinPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>     <span class="c">! minimum part load ratio allowed</span>
<a name="ln-7746"></a>
<a name="ln-7747"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-7748"></a>          <span class="c">! na</span>
<a name="ln-7749"></a>
<a name="ln-7750"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-7751"></a>          <span class="c">! na</span>
<a name="ln-7752"></a>
<a name="ln-7753"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-7754"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>   <span class="c">! Ratio of compressor ON air mass flow to AVERAGE air mass flow over time step</span>
<a name="ln-7755"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">TotalZoneLatentLoad</span>  <span class="c">! Total ZONE latent load (not including outside air)</span>
<a name="ln-7756"></a>                                            <span class="c">! to be removed by furnace/unitary system</span>
<a name="ln-7757"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">TotalZoneSensLoad</span>    <span class="c">! Total ZONE heating load (not including outside air)</span>
<a name="ln-7758"></a>                                            <span class="c">! to be removed by furnace/unitary system</span>
<a name="ln-7759"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">cpair</span>                <span class="c">! Heat capacity of air</span>
<a name="ln-7760"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ZoneSensLoadMet</span>      <span class="c">! Actual zone sensible load met by heat pump (W)</span>
<a name="ln-7761"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ZoneLatLoadMet</span>       <span class="c">! Actual zone latent load met by heat pump (W)</span>
<a name="ln-7762"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ZoneSensLoadMetFanONCompON</span> <span class="c">! Max Zone sensible load heat pump can meet (W)</span>
<a name="ln-7763"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ZoneLatLoadMetFanONCompON</span>  <span class="c">!Max Zone latentload heat pump can meet (W)</span>
<a name="ln-7764"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span> <span class="c">! control zone sensible load met using only outside air</span>
<a name="ln-7765"></a>                                                   <span class="c">! and fan heat (no coil output) (W)</span>
<a name="ln-7766"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">ZoneLatLoadMetFanONCompOFF</span>  <span class="c">! control zone Latent   load met using only outside air</span>
<a name="ln-7767"></a>                                                   <span class="c">! and fan heat (no coil output) (W)</span>
<a name="ln-7768"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HPCoilSensDemand</span>     <span class="c">! Heat pump sensible demand</span>
<a name="ln-7769"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">HPCoilSensCapacity</span>   <span class="c">! Heat pump sensible capacity</span>
<a name="ln-7770"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">FurnaceInletNode</span>     <span class="c">! heat pump Inlet node</span>
<a name="ln-7771"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">FurnaceOutletNode</span>    <span class="c">! heat pump Outlet node</span>
<a name="ln-7772"></a>
<a name="ln-7773"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">OASysInletNode</span>       <span class="c">! node number of return air inlet to OA sys</span>
<a name="ln-7774"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">OASysOutletNode</span>      <span class="c">! node number of mixed air outlet of OA sys</span>
<a name="ln-7775"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">OpMode</span>               <span class="c">! Mode of Operation (fan cycling = 1 or fan continuous = 2)</span>
<a name="ln-7776"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>         <span class="kd">::</span> <span class="n">CoolPartLoadRatio</span>    <span class="c">! Part load ratio (greater of sensible or latent part load ratio for cooling)</span>
<a name="ln-7777"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>         <span class="kd">::</span> <span class="n">HeatPartLoadRatio</span>    <span class="c">! Part load ratio (greater of sensible or latent part load ratio for cooling)</span>
<a name="ln-7778"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span><span class="k">SAVE</span>         <span class="kd">::</span> <span class="n">Dummy</span><span class="o">=</span><span class="mf">0.0d0</span>            <span class="c">! Dummy var. for generic calc. furnace output arg. (n/a for heat pump)</span>
<a name="ln-7779"></a>  <span class="kt">LOGICAL</span>           <span class="kd">::</span> <span class="n">HumControl</span>           <span class="c">! Logical flag signaling when dehumidification is required</span>
<a name="ln-7780"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">SuppHeatCoilLoad</span>     <span class="c">! Load passed to supplemental heater (W)</span>
<a name="ln-7781"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolErrorToler</span>       <span class="c">! convergence tolerance used in cooling mode</span>
<a name="ln-7782"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatErrorToler</span>       <span class="c">! convergence tolerance used in heating mode</span>
<a name="ln-7783"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span> <span class="n">SolFlag</span>              <span class="c">! flag returned from iteration routine to denote problems</span>
<a name="ln-7784"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span> <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>               <span class="c">! parameters passed to iteration routine</span>
<a name="ln-7785"></a>
<a name="ln-7786"></a>  <span class="c">! Set local variables</span>
<a name="ln-7787"></a>  <span class="n">Dummy</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7788"></a>  <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7789"></a>  <span class="n">FurnaceOutletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-7790"></a>  <span class="n">FurnaceInletNode</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-7791"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">AirToOANodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">OASysExists</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7792"></a><span class="k">    </span><span class="n">OASysOutletNode</span> <span class="o">=</span> <span class="n">AirToOANodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">OASysOutletNodeNum</span>
<a name="ln-7793"></a>    <span class="n">OASysInletNode</span> <span class="o">=</span> <span class="n">AirToOANodeInfo</span><span class="p">(</span><span class="n">AirLoopNum</span><span class="p">)%</span><span class="n">OASysInletNodeNum</span>
<a name="ln-7794"></a>  <span class="n">ENDIF</span>
<a name="ln-7795"></a>  <span class="n">OpMode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-7796"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-7797"></a>  <span class="n">HumControl</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7798"></a>
<a name="ln-7799"></a>
<a name="ln-7800"></a><span class="c">!*********INITIAL CALCULATIONS****************</span>
<a name="ln-7801"></a>  <span class="c">!Calculate the Cp Air for all conditions</span>
<a name="ln-7802"></a>  <span class="n">cpair</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-7803"></a>
<a name="ln-7804"></a>  <span class="c">!set the fan part load fraction</span>
<a name="ln-7805"></a>  <span class="c">! Note: OnOffFanPartLoadFraction is passed to the</span>
<a name="ln-7806"></a>  <span class="c">!       fan module by DataHVACGlobals.  It should be</span>
<a name="ln-7807"></a>  <span class="c">!     set =1 for all cases except cycling fan/cycling</span>
<a name="ln-7808"></a>  <span class="c">!     coil. For this case it is set to the part load</span>
<a name="ln-7809"></a>  <span class="c">!     factor.  In SimOnOffFan, the part load ratio is</span>
<a name="ln-7810"></a>  <span class="c">!     divided by the part load factor (OnOffFanPartLoadFraction)</span>
<a name="ln-7811"></a>  <span class="c">!     in order to match the run time fraction of the cycling</span>
<a name="ln-7812"></a>  <span class="c">!     fan with the run time fraction of the cycling compressor</span>
<a name="ln-7813"></a> <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7814"></a>
<a name="ln-7815"></a> <span class="c">!Calc Zone sensible loads for heating (+) and cooling (-)</span>
<a name="ln-7816"></a> <span class="n">TotalZoneSensLoad</span> <span class="o">=</span> <span class="n">ZoneLoad</span>
<a name="ln-7817"></a>
<a name="ln-7818"></a> <span class="c">!Set latent load for heating</span>
<a name="ln-7819"></a> <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7820"></a><span class="k">   </span><span class="n">TotalZoneLatentLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7821"></a>
<a name="ln-7822"></a> <span class="c">!Set latent load for cooling and no sensible load condition</span>
<a name="ln-7823"></a> <span class="k">ELSE</span>
<a name="ln-7824"></a><span class="k">   </span><span class="n">TotalZoneLatentLoad</span> <span class="o">=</span> <span class="n">MoistureLoad</span>
<a name="ln-7825"></a> <span class="n">ENDIF</span>
<a name="ln-7826"></a>
<a name="ln-7827"></a><span class="c">!*********COOLING CALCULATIONS****************</span>
<a name="ln-7828"></a>            <span class="c">!IF scheduled on...</span>
<a name="ln-7829"></a>    <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span>                    <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7830"></a>            <span class="c">!AND air flow rate is greater than zero...</span>
<a name="ln-7831"></a>        <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span>                                     <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7832"></a>            <span class="c">!AND the air system has a cooling load and is not set back or in the deadband...</span>
<a name="ln-7833"></a>       <span class="p">((</span><span class="n">CoolingLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>  <span class="p">&amp;</span>
<a name="ln-7834"></a>            <span class="c">!OR the system is controlled by a humidistat and there is a latent load</span>
<a name="ln-7835"></a>       <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-7836"></a>
<a name="ln-7837"></a>         <span class="c">!Set the air flow rate to the design flow rate and set the fan operation fraction to 1 (continuous operation)</span>
<a name="ln-7838"></a>         <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-7839"></a>         <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">!see &#39;Note&#39; under INITIAL CALCULATIONS</span>
<a name="ln-7840"></a>
<a name="ln-7841"></a><span class="c">!         !Set the operation flag to run the fan continuously</span>
<a name="ln-7842"></a><span class="c">!         OpMode = ContFanCycCoil</span>
<a name="ln-7843"></a>
<a name="ln-7844"></a>         <span class="c">!Set the input parameters for CalcFurnaceOutput</span>
<a name="ln-7845"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7846"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7847"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7848"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">!compressor off</span>
<a name="ln-7849"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>      <span class="c">!initialization call to Calc Furnace</span>
<a name="ln-7850"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7851"></a>             <span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7852"></a>
<a name="ln-7853"></a>        <span class="c">!Get no load result in order to calculate the effect of the fan and the mixed air equipment</span>
<a name="ln-7854"></a>         <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7855"></a>                 <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span><span class="p">,</span> <span class="n">ZoneLatLoadMetFanONCompOFF</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7856"></a>
<a name="ln-7857"></a>
<a name="ln-7858"></a>        <span class="c">!Set the input parameters for CalcFurnaceOutput</span>
<a name="ln-7859"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7860"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">!compressor ON</span>
<a name="ln-7861"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7862"></a>             <span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7863"></a>
<a name="ln-7864"></a>        <span class="c">!Get full load result in order to estimate the operating part load ratio for continuous fan operation</span>
<a name="ln-7865"></a>         <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7866"></a>                     <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMetFanONCompON</span><span class="p">,</span> <span class="n">ZoneLatLoadMetFanONCompON</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7867"></a>
<a name="ln-7868"></a>        <span class="c">!Calculate the heating coil demand for continuous fan operation as:</span>
<a name="ln-7869"></a>        <span class="c">!    (the zone sensible load - the zone sensible load met by fan heat and mixed air)</span>
<a name="ln-7870"></a>        <span class="c">!Note; The sensible zone load met by fan heat and mixed air is calculated as:</span>
<a name="ln-7871"></a>        <span class="c">!     mdotsys(control zone inlet enthalpy - control zone outlet enthalpy)</span>
<a name="ln-7872"></a>        <span class="c">!This accounts for the negative sign in the equation.</span>
<a name="ln-7873"></a>         <span class="n">HPCoilSensDemand</span>   <span class="o">=</span> <span class="n">TotalZoneSensLoad</span>  <span class="o">-</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-7874"></a>
<a name="ln-7875"></a>
<a name="ln-7876"></a>        <span class="c">!Calculate the heating coil capacity for continuous fan operation as:</span>
<a name="ln-7877"></a>        <span class="c">!    (the zone sensible load met by fan heat and mixed air and coil</span>
<a name="ln-7878"></a>        <span class="c">!   - the zone sensible load met by fan heat and mixed air)</span>
<a name="ln-7879"></a>        <span class="n">HPCoilSensCapacity</span> <span class="o">=</span> <span class="n">ZoneSensLoadMetFanONCompON</span> <span class="o">-</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-7880"></a>
<a name="ln-7881"></a>        <span class="c">!Calculate the part load ratio for continuous fan operation with cycling coil</span>
<a name="ln-7882"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">HPCoilSensCapacity</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-7883"></a><span class="k">           </span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7884"></a>        <span class="k">Else</span>
<a name="ln-7885"></a><span class="k">           </span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,&amp;</span>
<a name="ln-7886"></a>                   <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensDemand</span><span class="p">)</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensCapacity</span><span class="p">)))</span>
<a name="ln-7887"></a>        <span class="k">End If</span>
<a name="ln-7888"></a>
<a name="ln-7889"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-7890"></a>
<a name="ln-7891"></a><span class="c">!       check bounds on sensible output prior to iteration using RegulaFalsi</span>
<a name="ln-7892"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ZoneSensLoadMetFanONCompON</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7893"></a><span class="k">          </span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7894"></a>          <span class="n">HPCoilSensDemand</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneSensLoadMetFanONCompON</span> <span class="o">-</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span><span class="p">)</span>
<a name="ln-7895"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span> <span class="o">=</span> <span class="n">HPCoilSensDemand</span>
<a name="ln-7896"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">ZoneSensLoadMetFanONCompOFF</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7897"></a><span class="k">          </span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7898"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">!compressor OFF</span>
<a name="ln-7899"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7900"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7901"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7902"></a>               <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span><span class="p">,</span> <span class="n">ZoneLatLoadMetFanONCompOFF</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7903"></a>        <span class="k">ELSE</span>
<a name="ln-7904"></a><span class="c">!         Calculate the sensible part load ratio through iteration</span>
<a name="ln-7905"></a>          <span class="n">CoolErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingConvergenceTolerance</span>
<a name="ln-7906"></a>          <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations if positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-7907"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7908"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-7909"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-7910"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">OpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7911"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOp</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-7912"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">TotalZoneSensLoad</span>
<a name="ln-7913"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-7914"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-7915"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span> <span class="c">! Output with fan ON compressor OFF</span>
<a name="ln-7916"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HX is off for water-to-air HP</span>
<a name="ln-7917"></a><span class="c">!         CoolErrorToler is in fraction of load, MaxIter = 600, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-7918"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">CoolErrorToler</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="n">CalcWaterToAirResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-7919"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7920"></a><span class="k">            </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">OnOffFanPartLoadFractionSave</span>
<a name="ln-7921"></a>            <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7922"></a>                                   <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span> <span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7923"></a>            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="o">/</span><span class="n">TotalZoneSensLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CoolErrorToler</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7924"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7925"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7926"></a>                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7927"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating DX cooling coil sensible part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-7928"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7929"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), sensible output of DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7930"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7931"></a>              <span class="k">END IF</span>
<a name="ln-7932"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7933"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7934"></a>                  <span class="s1">&#39; sensible cooling part-load ratio error continues. Sensible load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7935"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleMaxIterIndex</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">)</span>
<a name="ln-7936"></a>            <span class="k">END IF</span>
<a name="ln-7937"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7938"></a><span class="k">            </span><span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensDemand</span> <span class="p">)</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensCapacity</span><span class="p">)))</span>
<a name="ln-7939"></a>            <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7940"></a>            <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7941"></a>                                   <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span> <span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7942"></a>            <span class="k">IF</span><span class="p">((</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="o">/</span><span class="n">TotalZoneSensLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">CoolErrorToler</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7943"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleRegulaFalsiFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-7944"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Cooling coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-7945"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-7946"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Cooling sensible part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-7947"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  An estimated part-load ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7948"></a>                                       <span class="s1">&#39; will be used and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-7949"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The estimated part-load ratio provides a cooling sensible capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7950"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7951"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  Cooling sensible load required = &#39;</span> <span class="p">&amp;</span>
<a name="ln-7952"></a>                                                <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-7953"></a>              <span class="n">ENDIF</span>
<a name="ln-7954"></a>              <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-7955"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Cooling sensible part-load ratio out of range&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-7956"></a>                  <span class="s1">&#39; error continues. Sensible cooling load statistics:&#39;</span> <span class="p">&amp;</span>
<a name="ln-7957"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleRegulaFalsiFailedIndex</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">)</span>
<a name="ln-7958"></a>            <span class="k">END IF</span>
<a name="ln-7959"></a><span class="k">          END IF</span>
<a name="ln-7960"></a><span class="k">       END IF</span>
<a name="ln-7961"></a>
<a name="ln-7962"></a><span class="k">       IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7963"></a><span class="k">         </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">*</span> <span class="n">CoolPartLoadRatio</span>
<a name="ln-7964"></a>       <span class="k">END IF</span>
<a name="ln-7965"></a>
<a name="ln-7966"></a>
<a name="ln-7967"></a><span class="c">!*********HEATING CALCULATIONS****************</span>
<a name="ln-7968"></a>    <span class="c">! If Furnace runs with a heating load then set HeatCoilLoad on Heating Coil and the Mass Flow</span>
<a name="ln-7969"></a>    <span class="n">ELSEIF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7970"></a>          <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-7971"></a>          <span class="n">HeatingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-7972"></a>
<a name="ln-7973"></a>         <span class="c">!Set the air flow rate to the design flow rate and set the fan operation fraction to 1 (continuous operation)</span>
<a name="ln-7974"></a>         <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-7975"></a>         <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">!see &#39;Note&#39; under INITIAL CALCULATIONS</span>
<a name="ln-7976"></a>
<a name="ln-7977"></a><span class="c">!         !Set the operation flag to run the fan continuously</span>
<a name="ln-7978"></a><span class="c">!         OpMode = ContFanCycCoil</span>
<a name="ln-7979"></a>
<a name="ln-7980"></a>         <span class="c">!Set the input parameters for CalcFurnaceOutput</span>
<a name="ln-7981"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7982"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7983"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7984"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">!compressor off</span>
<a name="ln-7985"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>      <span class="c">!initialization call to Calc Furnace</span>
<a name="ln-7986"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7987"></a>             <span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-7988"></a>
<a name="ln-7989"></a>        <span class="c">!Get no load result in order to calculate the effect of the fan and the mixed air equipment</span>
<a name="ln-7990"></a>         <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-7991"></a>                 <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span><span class="p">,</span> <span class="n">ZoneLatLoadMetFanONCompOFF</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-7992"></a>
<a name="ln-7993"></a>
<a name="ln-7994"></a>        <span class="c">!Set the input parameters for CalcFurnaceOutput</span>
<a name="ln-7995"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7996"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>    <span class="c">!compressor ON</span>
<a name="ln-7997"></a>             <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7998"></a>             <span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-7999"></a>
<a name="ln-8000"></a>        <span class="c">!Get full load result in order to estimate the operating part load ratio for continuous fan operation</span>
<a name="ln-8001"></a>
<a name="ln-8002"></a>         <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8003"></a>                     <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMetFanONCompON</span><span class="p">,</span> <span class="n">ZoneLatLoadMetFanONCompON</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8004"></a>
<a name="ln-8005"></a>        <span class="c">!Calculate the heating coil demand for continuous fan operation as:</span>
<a name="ln-8006"></a>        <span class="c">!    (the zone sensible load - the zone sensible load met by fan heat and mixed air)</span>
<a name="ln-8007"></a>        <span class="c">!Note; The sensible zone load met by fan heat and mixed air is calculated as:</span>
<a name="ln-8008"></a>        <span class="c">!     mdotsys(control zone inlet enthalpy - control zone outlet enthalpy)</span>
<a name="ln-8009"></a>        <span class="c">!This accounts for the negative sign in the equation.</span>
<a name="ln-8010"></a>         <span class="n">HPCoilSensDemand</span>   <span class="o">=</span> <span class="n">TotalZoneSensLoad</span>  <span class="o">-</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8011"></a>
<a name="ln-8012"></a>
<a name="ln-8013"></a>        <span class="c">!Calculate the heating coil capacity for continuous fan operation as:</span>
<a name="ln-8014"></a>        <span class="c">!    (the zone sensible load met by fan heat and mixed air and coil</span>
<a name="ln-8015"></a>        <span class="c">!   - the zone sensible load met by fan heat and mixed air)</span>
<a name="ln-8016"></a>        <span class="n">HPCoilSensCapacity</span> <span class="o">=</span> <span class="n">ZoneSensLoadMetFanONCompON</span> <span class="o">-</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8017"></a>
<a name="ln-8018"></a>        <span class="c">!Calculate the part load ratio for continuous fan operation with cycling coil</span>
<a name="ln-8019"></a>        <span class="k">If</span><span class="p">(</span><span class="n">HPCoilSensCapacity</span> <span class="o">==</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8020"></a><span class="k">           </span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8021"></a>        <span class="k">Else</span>
<a name="ln-8022"></a><span class="k">           </span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,&amp;</span>
<a name="ln-8023"></a>                                           <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensDemand</span><span class="p">)</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensCapacity</span><span class="p">)))</span>
<a name="ln-8024"></a>        <span class="k">End If</span>
<a name="ln-8025"></a>
<a name="ln-8026"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8027"></a>
<a name="ln-8028"></a><span class="c">!       check bounds on sensible output prior to iteration using RegulaFalsi</span>
<a name="ln-8029"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">ZoneSensLoadMetFanONCompON</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8030"></a><span class="k">          </span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8031"></a>          <span class="n">ZoneSensLoadMet</span> <span class="o">=</span> <span class="n">ZoneSensLoadMetFanONCompON</span>
<a name="ln-8032"></a>          <span class="n">HPCoilSensDemand</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneSensLoadMetFanONCompON</span> <span class="o">-</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span><span class="p">)</span>
<a name="ln-8033"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span> <span class="o">=</span> <span class="n">HPCoilSensDemand</span>
<a name="ln-8034"></a>        <span class="n">ELSEIF</span><span class="p">(</span><span class="n">ZoneSensLoadMetFanONCompOFF</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8035"></a><span class="k">          </span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8036"></a>          <span class="n">ZoneSensLoadMet</span> <span class="o">=</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8037"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>    <span class="c">!compressor ON</span>
<a name="ln-8038"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8039"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,&amp;</span>
<a name="ln-8040"></a>                 <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8041"></a>         <span class="k">ELSE</span>
<a name="ln-8042"></a><span class="c">!         Calculate the sensible part load ratio through iteration</span>
<a name="ln-8043"></a>          <span class="n">HeatErrorToler</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingConvergenceTolerance</span>
<a name="ln-8044"></a>          <span class="n">SolFlag</span> <span class="o">=</span> <span class="mi">0</span>    <span class="c">! # of iterations if positive, -1 means failed to converge, -2 means bounds are incorrect</span>
<a name="ln-8045"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8046"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! FLAG, if 1.0 then FirstHVACIteration equals TRUE, if 0.0 then FirstHVACIteration equals false</span>
<a name="ln-8047"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.0d0</span>
<a name="ln-8048"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">OpMode</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8049"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">CompOp</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-8050"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="n">TotalZoneSensLoad</span>
<a name="ln-8051"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-8052"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">! FLAG, 0.0 if latent load, 1.0 if sensible load to be met</span>
<a name="ln-8053"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span> <span class="c">! Output with fan ON compressor OFF</span>
<a name="ln-8054"></a>          <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! HX is OFF for water-to-air HP</span>
<a name="ln-8055"></a><span class="c">!         HeatErrorToler is in fraction of load, MaxIter = 600, SolFalg = # of iterations or error as appropriate</span>
<a name="ln-8056"></a>          <span class="k">CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">HeatErrorToler</span><span class="p">,</span> <span class="n">MaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">CalcWaterToAirResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-8057"></a>          <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">OnOffFanPartLoadFractionSave</span>
<a name="ln-8058"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8059"></a>                                 <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8060"></a>          <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8061"></a><span class="k">            IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="o">/</span><span class="n">TotalZoneSensLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">HeatErrorToler</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8062"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPHeatMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8063"></a><span class="k">                CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;Heating coil control failed to converge for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8064"></a>                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8065"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit exceeded in calculating DX heating coil sensible part-load ratio.&#39;</span><span class="p">)</span>
<a name="ln-8066"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Sensible load to be met by DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8067"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), sensible output of DX coil = &#39;</span> <span class="p">&amp;</span>
<a name="ln-8068"></a>                     <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; (watts), and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8069"></a>              <span class="k">END IF</span>
<a name="ln-8070"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8071"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Iteration limit exceeded in calculating&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8072"></a>                  <span class="s1">&#39; sensible heating part-load ratio error continues.&#39;</span> <span class="p">&amp;</span>
<a name="ln-8073"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPHeatMaxIterIndex</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">)</span>
<a name="ln-8074"></a>            <span class="k">END IF</span>
<a name="ln-8075"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8076"></a><span class="k">            </span><span class="n">HeatPartLoadRatio</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">MinPLR</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensDemand</span> <span class="p">)</span> <span class="o">/</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensCapacity</span><span class="p">)))</span>
<a name="ln-8077"></a>            <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8078"></a>                                   <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8079"></a>            <span class="k">IF</span><span class="p">((</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">TotalZoneSensLoad</span><span class="p">)</span><span class="o">/</span><span class="n">TotalZoneSensLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">HeatErrorToler</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8080"></a><span class="k">              IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPHeatRegulaFalsiFailedIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8081"></a><span class="k">                CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Heating coil control failed for &#39;</span> <span class="p">&amp;</span>
<a name="ln-8082"></a>                    <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;:&#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-8083"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Heating sensible part-load ratio determined to be outside the range of 0-1.&#39;</span><span class="p">)</span>
<a name="ln-8084"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  An estimated part-load ratio = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8085"></a>                                       <span class="s1">&#39; will be used and the simulation continues.&#39;</span><span class="p">)</span>
<a name="ln-8086"></a>                <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  The estimated part-load ratio provides a heating sensible capacity = &#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8087"></a>                                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-8088"></a>                <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;  Heating sensible load required = &#39;</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">TrimSigDigits</span><span class="p">(</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<a name="ln-8089"></a>              <span class="k">END IF</span>
<a name="ln-8090"></a><span class="k">              CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; &quot;&#39;</span><span class="p">&amp;</span>
<a name="ln-8091"></a>                  <span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot; - Heating sensible part-load ratio out of range&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-8092"></a>                  <span class="s1">&#39; error continues.&#39;</span> <span class="p">&amp;</span>
<a name="ln-8093"></a>                  <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPHeatRegulaFalsiFailedIndex</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">,</span><span class="n">TotalZoneSensLoad</span><span class="p">)</span>
<a name="ln-8094"></a>            <span class="k">END IF</span>
<a name="ln-8095"></a><span class="k">          END IF</span>
<a name="ln-8096"></a><span class="k">        END IF</span>
<a name="ln-8097"></a>
<a name="ln-8098"></a><span class="c">!       CALL supplemental heater if required</span>
<a name="ln-8099"></a>        <span class="k">IF</span><span class="p">((</span><span class="n">TotalZoneSensLoad</span> <span class="o">-</span> <span class="n">ZoneSensLoadMet</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">HeatPartLoadRatio</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8100"></a><span class="k">          </span><span class="n">SuppHeatCoilLoad</span> <span class="o">=</span> <span class="n">TotalZoneSensLoad</span> <span class="o">-</span> <span class="n">ZoneSensLoadMet</span>
<a name="ln-8101"></a>          <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,&amp;</span>
<a name="ln-8102"></a>               <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">SuppHeatCoilLoad</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8103"></a>        <span class="k">END IF</span>
<a name="ln-8104"></a>
<a name="ln-8105"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8106"></a><span class="k">          </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">*</span> <span class="n">HeatPartLoadRatio</span>
<a name="ln-8107"></a>        <span class="k">END IF</span>
<a name="ln-8108"></a>
<a name="ln-8109"></a><span class="c">!**********HVAC Scheduled ON, but no cooling, dehumidification or heating load*********</span>
<a name="ln-8110"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8111"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>      <span class="c">!initialization call to Calc Furnace</span>
<a name="ln-8112"></a>      <span class="n">HeatPartLoadRatio</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8113"></a>      <span class="n">CoolPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8114"></a>      <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">!!see &#39;Note&#39; under INITIAL CALCULATIONS</span>
<a name="ln-8115"></a>    <span class="c">!set report variables</span>
<a name="ln-8116"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8117"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8118"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8119"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8120"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8121"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8122"></a>        <span class="n">OnOffFanPartLoadFraction</span>        <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">!see &#39;Note&#39; under INITIAL CALCULATIONS</span>
<a name="ln-8123"></a>        <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,&amp;</span>
<a name="ln-8124"></a>         <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8125"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8126"></a>      <span class="k">ElSE</span> <span class="c">!continuous fan, cycling coil</span>
<a name="ln-8127"></a>        <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,&amp;</span>
<a name="ln-8128"></a>         <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8129"></a>      <span class="n">ENDIF</span>
<a name="ln-8130"></a><span class="c">!*********No heating or cooling or dehumidification*********</span>
<a name="ln-8131"></a>    <span class="k">ELSE</span>
<a name="ln-8132"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>      <span class="c">!initialization call to Calc Furnace</span>
<a name="ln-8133"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8134"></a>      <span class="n">HeatPartLoadRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8135"></a>      <span class="n">CoolPartLoadRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8136"></a>      <span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="c">!see &#39;Note&#39; under INITIAL CALCULATIONS</span>
<a name="ln-8137"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8138"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8139"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8140"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8141"></a>      <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,&amp;</span>
<a name="ln-8142"></a>         <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span>
<a name="ln-8143"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8144"></a>  <span class="k">END IF</span>
<a name="ln-8145"></a>
<a name="ln-8146"></a>
<a name="ln-8147"></a>  <span class="c">! Set the fan inlet node flow rates</span>
<a name="ln-8148"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-8149"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>         <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span>
<a name="ln-8150"></a><span class="k">RETURN</span>
<a name="ln-8151"></a><span class="k">END SUBROUTINE </span><span class="n">CalcWaterToAirHeatpump</span>
<a name="ln-8152"></a>
<a name="ln-8153"></a><span class="k">SUBROUTINE </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8154"></a>                     <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="n">ReHeatCoilLoad</span><span class="p">,</span> <span class="n">SensibleLoadMet</span><span class="p">,</span> <span class="n">LatentLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8155"></a>                     <span class="n">CoolingHeatingPLRRat</span><span class="p">)</span>
<a name="ln-8156"></a>
<a name="ln-8157"></a>
<a name="ln-8158"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8159"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-8160"></a>          <span class="c">!       DATE WRITTEN   Sept 2001</span>
<a name="ln-8161"></a>          <span class="c">!       MODIFIED       Dec 2001</span>
<a name="ln-8162"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8163"></a>
<a name="ln-8164"></a>
<a name="ln-8165"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8166"></a>          <span class="c">! This subroutine calculates to sensible and latent loads met by the DX coils</span>
<a name="ln-8167"></a>          <span class="c">! specified.  Load met is the outlet node with respect to the control zone&#39;s</span>
<a name="ln-8168"></a>          <span class="c">! temperature and humidity ratio.</span>
<a name="ln-8169"></a>
<a name="ln-8170"></a>
<a name="ln-8171"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8172"></a>          <span class="c">! Simulate each child object in the correct order for each system type. This routine is used in the</span>
<a name="ln-8173"></a>          <span class="c">! RegulaFalsi function CALL. Air mass flow rate is set each iteration based on PLR.</span>
<a name="ln-8174"></a>
<a name="ln-8175"></a>
<a name="ln-8176"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8177"></a>          <span class="c">! na</span>
<a name="ln-8178"></a>
<a name="ln-8179"></a>
<a name="ln-8180"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8181"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-8182"></a>  <span class="k">USE </span><span class="n">WatertoAirHeatPump</span><span class="p">,</span>        <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWaterToAirHP</span>
<a name="ln-8183"></a>  <span class="k">USE </span><span class="n">WatertoAirheatPumpSimple</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimWatertoAirHPSimple</span>
<a name="ln-8184"></a>  <span class="k">USE </span><span class="n">HVACHXAssistedCoolingCoil</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimHXAssistedCoolingCoil</span>
<a name="ln-8185"></a>
<a name="ln-8186"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8187"></a>
<a name="ln-8188"></a>
<a name="ln-8189"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8190"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>
<a name="ln-8191"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-8192"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanOpMode</span>          <span class="c">! Cycling fan or constant fan</span>
<a name="ln-8193"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-8194"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">CoolPartLoadRatio</span>  <span class="c">! DX cooling coil part load ratio</span>
<a name="ln-8195"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatPartLoadRatio</span>  <span class="c">! DX heating coil part load ratio (0 for other heating coil types)</span>
<a name="ln-8196"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HeatCoilLoad</span>       <span class="c">! Heating coil load for gas heater</span>
<a name="ln-8197"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ReHeatCoilLoad</span>     <span class="c">! Reheating coil load for gas heater</span>
<a name="ln-8198"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SensibleLoadMet</span>    <span class="c">! Sensible cooling load met (furnace outlet with respect to control zone temp)</span>
<a name="ln-8199"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LatentLoadMet</span> <span class="c">! Latent cooling load met (furnace outlet with respect to control zone humidity ratio)</span>
<a name="ln-8200"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! Ratio of compressor ON mass flow rate to AVERAGE</span>
<a name="ln-8201"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to enable HX based on zone moisture load</span>
<a name="ln-8202"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">OPTIONAL</span>  <span class="kd">::</span> <span class="n">CoolingHeatingPLRRat</span>  <span class="c">! cooling PLR to heating PLR ratio, used for cycling fan RH control</span>
<a name="ln-8203"></a>
<a name="ln-8204"></a>
<a name="ln-8205"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8206"></a>          <span class="c">! na</span>
<a name="ln-8207"></a>
<a name="ln-8208"></a>
<a name="ln-8209"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8210"></a>          <span class="c">! na</span>
<a name="ln-8211"></a>
<a name="ln-8212"></a>
<a name="ln-8213"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8214"></a>          <span class="c">! na</span>
<a name="ln-8215"></a>
<a name="ln-8216"></a>
<a name="ln-8217"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8218"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">FurnaceInletNode</span>    <span class="c">! Furnace inlet node number</span>
<a name="ln-8219"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">FurnaceOutletNode</span>   <span class="c">! Furnace outlet node number</span>
<a name="ln-8220"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">AirMassFlow</span>         <span class="c">! Furnace inlet node temperature</span>
<a name="ln-8221"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">WSHPRuntimeFrac</span>     <span class="c">! Compressor runtime fraction</span>
<a name="ln-8222"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">CompPartLoadRatio</span>   <span class="c">! Compressor part load ratio</span>
<a name="ln-8223"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MinHumRatio</span>         <span class="c">! Minimum humidity ratio for calculating sensible load at a constant humidity ratio</span>
<a name="ln-8224"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MaxTemp</span>             <span class="c">! Maximum temperature for calculating latent load at a constant temperature</span>
<a name="ln-8225"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">dummy</span>               <span class="c">! dummy variable</span>
<a name="ln-8226"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Tout</span>                <span class="c">! Temporary variable used when outlet temp &gt; DesignMaxOutletTemp</span>
<a name="ln-8227"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">Wout</span>                <span class="c">! Temporary variable used when outlet temp &gt; DesignMaxOutletTemp</span>
<a name="ln-8228"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">CoolingCoilType_Num</span> <span class="c">! Numeric Equivalent for CoolingCoilType</span>
<a name="ln-8229"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">HeatingCoilType_Num</span> <span class="c">! Numeric Equivalent for HeatingCoilType</span>
<a name="ln-8230"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">mdot</span>                <span class="c">! hot water or steam heating coil fluid mass flow rates</span>
<a name="ln-8231"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QCoilReq</span>            <span class="c">! heating coil load</span>
<a name="ln-8232"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">QActual</span>             <span class="c">! heating coil load met or delivered</span>
<a name="ln-8233"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MinWaterFlow</span>   <span class="o">=</span> <span class="mf">0.0d0</span>  <span class="c">! minimum fluid flow rates</span>
<a name="ln-8234"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">LoopNumber</span>          <span class="c">! plant loop index for water and steam supplemental heating coil</span>
<a name="ln-8235"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">LoopSideNumber</span>      <span class="c">! plant loop side  index for  water and steam supp. heating coil</span>
<a name="ln-8236"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">BranchNumber</span>        <span class="c">! plant loop branch index for water and steam supp. heating coil</span>
<a name="ln-8237"></a>  <span class="kt">INTEGER</span>          <span class="kd">::</span> <span class="n">CompNumber</span>          <span class="c">! plant loop comp. index for water and steam supp. heating coil</span>
<a name="ln-8238"></a>  <span class="kt">LOGICAL</span>          <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span> <span class="c">! .true. if supplemental heating coil</span>
<a name="ln-8239"></a>
<a name="ln-8240"></a>  <span class="n">FurnaceOutletNode</span>     <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-8241"></a>  <span class="n">FurnaceInletNode</span>      <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-8242"></a>  <span class="n">CoolingCoilType_Num</span>   <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilType_Num</span>
<a name="ln-8243"></a>  <span class="n">HeatingCoilType_Num</span>   <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span>
<a name="ln-8244"></a>  <span class="n">WSHPRuntimeFrac</span>       <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>
<a name="ln-8245"></a>  <span class="n">CompPartLoadRatio</span>     <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span>
<a name="ln-8246"></a>  <span class="n">ModifiedHeatCoilLoad</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8247"></a>
<a name="ln-8248"></a>  <span class="k">IF</span> <span class="p">(</span><span class="nb">PRESENT</span><span class="p">(</span><span class="n">CoolingHeatingPLRRat</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-8249"></a><span class="k">    </span><span class="n">CoolHeatPLRRat</span> <span class="o">=</span> <span class="n">CoolingHeatingPLRRat</span>
<a name="ln-8250"></a>  <span class="k">ELSE</span>
<a name="ln-8251"></a><span class="k">    </span><span class="n">CoolHeatPLRRat</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8252"></a>  <span class="k">END IF</span>
<a name="ln-8253"></a>
<a name="ln-8254"></a><span class="c">! Cooling to Heating PLR Ratio (CoolHeatPLRRat) is used to track the air mass flow rate of both the heating</span>
<a name="ln-8255"></a><span class="c">! and cooling coils when RH control is used and the heating coil operates longer than the cooling coil.</span>
<a name="ln-8256"></a><span class="c">! When CoolPartLoadRatio/CoolHeatPLRRat is used, the PLR calculated is acutally the PLR for the heating</span>
<a name="ln-8257"></a><span class="c">! coil (heating PLR is greater than cooling PLR), it is this PLR that determines the air mass flow rate.</span>
<a name="ln-8258"></a><span class="c">!</span>
<a name="ln-8259"></a><span class="c">! When MAX(HeatPartLoadRatio,CoolPartLoadRatio) is used, only one of these values is non-zero.</span>
<a name="ln-8260"></a><span class="c">!</span>
<a name="ln-8261"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8262"></a><span class="k">    IF</span><span class="p">(</span><span class="n">CoolHeatPLRRat</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8263"></a><span class="k">      IF</span><span class="p">(</span><span class="n">CoolHeatPLRRat</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8264"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">*</span> <span class="n">CoolPartLoadRatio</span><span class="o">/</span><span class="n">CoolHeatPLRRat</span>
<a name="ln-8265"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8266"></a><span class="k">          CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">CoolPartLoadRatio</span><span class="o">/</span><span class="n">CoolHeatPLRRat</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8267"></a>        <span class="k">END IF</span>
<a name="ln-8268"></a><span class="k">      ELSE</span>
<a name="ln-8269"></a><span class="k">        </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">*</span> <span class="n">CoolPartLoadRatio</span>
<a name="ln-8270"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8271"></a><span class="k">          CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8272"></a>        <span class="k">END IF</span>
<a name="ln-8273"></a><span class="k">      END IF</span>
<a name="ln-8274"></a><span class="k">    ELSE</span>
<a name="ln-8275"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">*</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">)</span>
<a name="ln-8276"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8277"></a><span class="k">        CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8278"></a>      <span class="k">END IF</span>
<a name="ln-8279"></a><span class="k">    END IF</span>
<a name="ln-8280"></a><span class="k">  ELSE</span>
<a name="ln-8281"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8282"></a><span class="k">      CALL </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">),</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8283"></a>    <span class="k">END IF</span>
<a name="ln-8284"></a><span class="k">  END IF</span>
<a name="ln-8285"></a>
<a name="ln-8286"></a><span class="k">  </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-8287"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceInletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-8288"></a>
<a name="ln-8289"></a><span class="c">! Simulate the air-to-air heat pump</span>
<a name="ln-8290"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_AirToAir</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8291"></a><span class="c">!   Simulate blow-thru fan and non-linear coils twice to update PLF used by the ONOFF Fan</span>
<a name="ln-8292"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8293"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8294"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8295"></a><span class="k">        CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8296"></a>                                      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8297"></a>                                      <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-8298"></a>      <span class="k">ELSE</span>
<a name="ln-8299"></a><span class="k">        CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8300"></a>                       <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8301"></a>      <span class="k">END IF</span>
<a name="ln-8302"></a><span class="k">      CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8303"></a>                     <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8304"></a>      <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8305"></a>    <span class="k">END IF</span>
<a name="ln-8306"></a><span class="c">!   Simulate cooling and heating coils</span>
<a name="ln-8307"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8308"></a><span class="k">      CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8309"></a>                                    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8310"></a>                                    <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-8311"></a>    <span class="k">ELSE</span>
<a name="ln-8312"></a><span class="k">      CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8313"></a>                     <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8314"></a>    <span class="k">END IF</span>
<a name="ln-8315"></a><span class="k">    CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8316"></a>                   <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8317"></a><span class="c">!   Simulate the draw-thru fan</span>
<a name="ln-8318"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8319"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8320"></a>    <span class="k">END IF</span>
<a name="ln-8321"></a><span class="c">!   Simulate the supplemental heating coil</span>
<a name="ln-8322"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ReHeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8323"></a><span class="k">      </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8324"></a>      <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReHeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8325"></a>    <span class="k">ELSE</span>
<a name="ln-8326"></a>      <span class="c">! equivalent to QCoilReq=0.0d0 or ReHeatCoilLoad = 0.0d0</span>
<a name="ln-8327"></a>      <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8328"></a>      <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReHeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8329"></a>    <span class="n">ENDIF</span>
<a name="ln-8330"></a><span class="c">! Simulate the parameter estimate water-to-air heat pump</span>
<a name="ln-8331"></a>  <span class="n">ELSEIF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8332"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_Simple</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8333"></a><span class="c">!    Simulate blow-thru fan and non-linear coils twice to update PLF used by the ONOFF Fan</span>
<a name="ln-8334"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8335"></a><span class="k">       CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8336"></a>       <span class="c">!COIL:WATERTOAIRHPSIMPLE:COOLING</span>
<a name="ln-8337"></a>       <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8338"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8339"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8340"></a>              <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>  <span class="c">!CoolPartLoadRatio</span>
<a name="ln-8341"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8342"></a>              <span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8343"></a>       <span class="n">Dummy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8344"></a>       <span class="c">!COIL:WATERTOAIRHPSIMPLE:HEATING</span>
<a name="ln-8345"></a>       <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8346"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8347"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8348"></a>              <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>  <span class="c">!HeatPartLoadRatio</span>
<a name="ln-8349"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8350"></a>              <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8351"></a><span class="c">!      Simulate the whole thing a second time so that the correct PLF required by the coils is used by the Fan. *******</span>
<a name="ln-8352"></a>       <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8353"></a>     <span class="k">END IF</span>
<a name="ln-8354"></a><span class="c">!    Simulate the cooling and heating coils</span>
<a name="ln-8355"></a>     <span class="c">!COIL:WATERTOAIRHPSIMPLE:COOLING</span>
<a name="ln-8356"></a>      <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8357"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8358"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8359"></a>              <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>  <span class="c">!CoolPartLoadRatio</span>
<a name="ln-8360"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8361"></a>              <span class="n">CoolPartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8362"></a>      <span class="n">Dummy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8363"></a>     <span class="c">!COIL:WATERTOAIRHPSIMPLE:HEATING</span>
<a name="ln-8364"></a>      <span class="k">CALL </span><span class="n">SimWatertoAirHPSimple</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8365"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8366"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8367"></a>              <span class="n">FanOpMode</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>  <span class="c">!HeatPartLoadRatio</span>
<a name="ln-8368"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="n">CompOp</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-8369"></a>              <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">)</span>
<a name="ln-8370"></a><span class="c">!     Simulate the draw-thru fan</span>
<a name="ln-8371"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8372"></a><span class="k">        CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8373"></a>      <span class="k">END IF</span>
<a name="ln-8374"></a><span class="c">!     Simulate the supplemental heating coil</span>
<a name="ln-8375"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ReHeatCoilLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8376"></a><span class="k">         </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-8377"></a>         <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span> <span class="n">QActual</span><span class="p">)</span>
<a name="ln-8378"></a>       <span class="k">ELSE</span>
<a name="ln-8379"></a><span class="k">         </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span> <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-8380"></a>         <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8381"></a>      <span class="n">ENDIF</span>
<a name="ln-8382"></a><span class="c">! Simulate the detailed water-to-air heat pump</span>
<a name="ln-8383"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8384"></a>          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WatertoAirHPType</span> <span class="o">==</span> <span class="n">WatertoAir_ParEst</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-8385"></a><span class="c">!    Simulate the draw-thru fan</span>
<a name="ln-8386"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8387"></a><span class="k">       CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8388"></a>     <span class="k">END IF</span>
<a name="ln-8389"></a><span class="c">!    Simulate the cooling and heating coils</span>
<a name="ln-8390"></a>     <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8391"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8392"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-8393"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8394"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8395"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8396"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8397"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8398"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span> <span class="n">CoolPartLoadRatio</span><span class="p">)</span>
<a name="ln-8399"></a>     <span class="n">Dummy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8400"></a>     <span class="k">CALL </span><span class="n">SimWatertoAirHP</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8401"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8402"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">WSHPRuntimeFrac</span><span class="p">,&amp;</span>
<a name="ln-8403"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8404"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8405"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8406"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8407"></a>              <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8408"></a>              <span class="n">Dummy</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-8409"></a><span class="c">!    Simulate the draw-thru fan</span>
<a name="ln-8410"></a>     <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8411"></a><span class="k">       CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8412"></a>     <span class="k">END IF</span>
<a name="ln-8413"></a><span class="c">!    Simulate the supplemental heating coil</span>
<a name="ln-8414"></a>     <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">QCoilReq</span><span class="o">=</span><span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8415"></a>                                        <span class="n">CompIndex</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8416"></a>                                        <span class="n">SuppHeat</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span> <span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanOpMode</span><span class="p">)</span>
<a name="ln-8417"></a>
<a name="ln-8418"></a>
<a name="ln-8419"></a>  <span class="k">ELSE</span> <span class="c">! ELSE it&#39;s not a heat pump</span>
<a name="ln-8420"></a><span class="c">!   Simulate blow-thru fan</span>
<a name="ln-8421"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8422"></a>
<a name="ln-8423"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8424"></a>
<a name="ln-8425"></a><span class="c">!     For non-linear coils, simulate coil to update PLF used by the ONOFF Fan</span>
<a name="ln-8426"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanType_Num</span> <span class="o">==</span> <span class="n">FanType_SimpleOnOff</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8427"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">UnitarySys_HeatOnly</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8428"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8429"></a>
<a name="ln-8430"></a><span class="k">          IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8431"></a><span class="k">            </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="c">! if false simulates heating coil</span>
<a name="ln-8432"></a>            <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8433"></a>          <span class="k">END IF</span>
<a name="ln-8434"></a>
<a name="ln-8435"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8436"></a><span class="k">            CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8437"></a>                                          <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8438"></a>                                          <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-8439"></a>          <span class="k">ELSE</span>
<a name="ln-8440"></a><span class="k">            CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8441"></a>                           <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">CoilCoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="n">CoolHeatPLRRat</span><span class="p">)</span>
<a name="ln-8442"></a>          <span class="k">END IF</span>
<a name="ln-8443"></a><span class="k">        END IF</span>
<a name="ln-8444"></a>
<a name="ln-8445"></a><span class="k">        IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8446"></a><span class="k">           </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>      <span class="c">! if false simulates heating coil</span>
<a name="ln-8447"></a>           <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8448"></a>        <span class="k">END IF</span>
<a name="ln-8449"></a><span class="k">        CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8450"></a>      <span class="k">END IF</span> <span class="c">! Simple OnOff fan</span>
<a name="ln-8451"></a>
<a name="ln-8452"></a>    <span class="k">END IF</span> <span class="c">! Blow thru fan</span>
<a name="ln-8453"></a>
<a name="ln-8454"></a><span class="c">!   Simulate the cooling and heating coils</span>
<a name="ln-8455"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">UnitarySys_HeatOnly</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8456"></a>       <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">Furnace_HeatOnly</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8457"></a>
<a name="ln-8458"></a><span class="k">      IF</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8459"></a><span class="k">         </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>      <span class="c">! if false simulates heating coil</span>
<a name="ln-8460"></a>         <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8461"></a>      <span class="k">END IF</span>
<a name="ln-8462"></a>
<a name="ln-8463"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">CoolingCoilType_Num</span> <span class="o">==</span> <span class="n">CoilDX_CoolingHXAssisted</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8464"></a><span class="k">        CALL </span><span class="n">SimHXAssistedCoolingCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8465"></a>                                      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span> <span class="n">FanOpMode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8466"></a>                                      <span class="n">HXUnitEnable</span><span class="o">=</span><span class="n">HXUnitOn</span><span class="p">,</span> <span class="n">OnOffAFR</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">EconomizerFlag</span><span class="o">=</span><span class="n">EconomizerFlag</span><span class="p">)</span>
<a name="ln-8467"></a>      <span class="k">ELSE</span>
<a name="ln-8468"></a><span class="k">        CALL </span><span class="n">SimDXCoil</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-8469"></a>                       <span class="n">FanOpMode</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">CoilCoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="n">CoolHeatPLRRat</span><span class="p">)</span>
<a name="ln-8470"></a>      <span class="k">END IF</span>
<a name="ln-8471"></a>
<a name="ln-8472"></a><span class="k">    END IF</span>
<a name="ln-8473"></a>
<a name="ln-8474"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8475"></a><span class="k">       </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>      <span class="c">! if false simulates heating coil</span>
<a name="ln-8476"></a>       <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8477"></a>    <span class="k">END IF</span>
<a name="ln-8478"></a><span class="c">!   Simulate the draw-thru fan</span>
<a name="ln-8479"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DrawThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8480"></a><span class="k">      CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-8481"></a>    <span class="k">END IF</span>
<a name="ln-8482"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8483"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8484"></a><span class="k">        </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if truee simulates supplemental heating coil</span>
<a name="ln-8485"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">QActual</span><span class="p">)</span>
<a name="ln-8486"></a>    <span class="k">END IF</span>
<a name="ln-8487"></a><span class="k">  END IF</span> <span class="c">! IF(Furnace(FurnaceNum)%FurnaceType_Num == UnitarySys_HeatPump_AirToAir)THEN</span>
<a name="ln-8488"></a>
<a name="ln-8489"></a><span class="c">! check the DesignMaxOutletTemp and reset if necessary (for Coil:Gas:Heating or Coil:Electric:Heating only)</span>
<a name="ln-8490"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8491"></a><span class="k">    </span><span class="n">Wout</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-8492"></a>    <span class="n">Tout</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span>
<a name="ln-8493"></a>    <span class="n">ModifiedHeatCoilLoad</span> <span class="o">=</span> <span class="n">HeatCoilLoad</span> <span class="o">-</span> <span class="p">&amp;</span>
<a name="ln-8494"></a>                         <span class="p">(</span><span class="n">AirMassFlow</span> <span class="o">*</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Wout</span><span class="p">,</span><span class="n">Tout</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="o">-</span><span class="n">Tout</span><span class="p">))</span>
<a name="ln-8495"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="o">=</span> <span class="n">Tout</span>
<a name="ln-8496"></a>  <span class="n">ENDIF</span>
<a name="ln-8497"></a>
<a name="ln-8498"></a>
<a name="ln-8499"></a>  <span class="c">! If the fan runs continually do not allow coils to set OnOffFanPartLoadRatio.</span>
<a name="ln-8500"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">FanOpMode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">ContFanCycCoil</span><span class="p">)</span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8501"></a>
<a name="ln-8502"></a>
<a name="ln-8503"></a> <span class="c">! Check delta T (outlet to space), if positive</span>
<a name="ln-8504"></a> <span class="c">! use space HumRat (next line), else outlet humrat (IF) so psyc routine gives good result</span>
<a name="ln-8505"></a>  <span class="n">MinHumRatio</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-8506"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8507"></a>    <span class="n">MinHumRatio</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-8508"></a>
<a name="ln-8509"></a> <span class="c">! Calculate sensible load met (at constant humidity ratio)</span>
<a name="ln-8510"></a>  <span class="n">SensibleLoadMet</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-8511"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRatio</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-8512"></a>         <span class="o">-</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span>
<a name="ln-8513"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span> <span class="o">=</span> <span class="n">SensibleLoadMet</span>
<a name="ln-8514"></a>
<a name="ln-8515"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8516"></a><span class="k">    </span><span class="n">MaxTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-8517"></a><span class="c">! modified, why does switching between furnace outlet and control zone temp</span>
<a name="ln-8518"></a><span class="c">! cause latent load to change when latent capacity is 0 ?</span>
<a name="ln-8519"></a><span class="c">!    IF(Node(FurnaceOutletNode)%Temp .GT. Node(Furnace(FurnaceNum)%NodeNumofControlledZone)%Temp ) &amp;</span>
<a name="ln-8520"></a><span class="c">!       MaxTemp = Node(FurnaceOutletNode)%Temp</span>
<a name="ln-8521"></a>
<a name="ln-8522"></a>
<a name="ln-8523"></a><span class="c">!   Calculate latent load met (at constant temperature)</span>
<a name="ln-8524"></a>    <span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">FurnaceOutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-8525"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-8526"></a>         <span class="o">-</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span>
<a name="ln-8527"></a>  <span class="k">ELSE</span>
<a name="ln-8528"></a><span class="k">    </span><span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8529"></a>  <span class="k">END IF</span>
<a name="ln-8530"></a><span class="k">  </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="n">LatentLoadMet</span>
<a name="ln-8531"></a>
<a name="ln-8532"></a>
<a name="ln-8533"></a><span class="k">RETURN</span>
<a name="ln-8534"></a><span class="k">END Subroutine </span><span class="n">CalcFurnaceOutput</span>
<a name="ln-8535"></a><span class="c">!        End of Update subroutines for the Furnace Module</span>
<a name="ln-8536"></a><span class="c">! *****************************************************************************</span>
<a name="ln-8537"></a>
<a name="ln-8538"></a>
<a name="ln-8539"></a>
<a name="ln-8540"></a>
<a name="ln-8541"></a><span class="k">FUNCTION </span><span class="n">CalcFurnaceResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-8542"></a>
<a name="ln-8543"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8544"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-8545"></a>          <span class="c">!       DATE WRITTEN   Feb 2005</span>
<a name="ln-8546"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8547"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8548"></a>
<a name="ln-8549"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8550"></a>          <span class="c">! To calculate the part-load ratio for cooling and heating coils</span>
<a name="ln-8551"></a>
<a name="ln-8552"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8553"></a>          <span class="c">! Use SolveRegulaFalsi to call this Function to converge on a solution</span>
<a name="ln-8554"></a>
<a name="ln-8555"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8556"></a>          <span class="c">! na</span>
<a name="ln-8557"></a>
<a name="ln-8558"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8559"></a>          <span class="c">! na</span>
<a name="ln-8560"></a>
<a name="ln-8561"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8562"></a>
<a name="ln-8563"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8564"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! DX cooling coil part load ratio</span>
<a name="ln-8565"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span>            <span class="c">! Function parameters</span>
<a name="ln-8566"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">Residuum</span>       <span class="c">! Result (force to 0)</span>
<a name="ln-8567"></a>
<a name="ln-8568"></a><span class="c">!   Parameter description example:</span>
<a name="ln-8569"></a><span class="c">!       Par(1)  = REAL(FurnaceNum,r64) ! Index to furnace</span>
<a name="ln-8570"></a><span class="c">!       Par(2)  = 0.0                  ! FirstHVACIteration FLAG, if 1.0 then TRUE, if 0.0 then FALSE</span>
<a name="ln-8571"></a><span class="c">!       Par(3)  = REAL(OpMode,r64)     ! Fan control, if 1.0 then cycling fan, if 0.0 then continuous fan</span>
<a name="ln-8572"></a><span class="c">!       Par(4)  = REAL(CompOp,r64)     ! Compressor control, if 1.0 then compressor ON, if 0.0 then compressor OFF</span>
<a name="ln-8573"></a><span class="c">!       Par(5)  = CoolCoilLoad         ! Sensible or Latent load to be met by furnace</span>
<a name="ln-8574"></a><span class="c">!       Par(6)  = 1.0                  ! Type of load FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-8575"></a><span class="c">!       Par(7)  = 1.0                  ! Output calculation FLAG, 0.0 for latent capacity, 1.0 for sensible capacity</span>
<a name="ln-8576"></a><span class="c">!       Par(8)  = OnOffAirFlowRatio    ! Ratio of compressor ON air mass flow to AVERAGE air mass flow over time step</span>
<a name="ln-8577"></a><span class="c">!       Par(9)  = HXUnitOn             ! flag to enable HX, 1=ON and 2=OFF</span>
<a name="ln-8578"></a><span class="c">!       Par(10) = HeatingCoilPLR       ! used to calculate latent degradation for cycling fan RH control</span>
<a name="ln-8579"></a>
<a name="ln-8580"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8581"></a>          <span class="c">! na</span>
<a name="ln-8582"></a>
<a name="ln-8583"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8584"></a>          <span class="c">! na</span>
<a name="ln-8585"></a>
<a name="ln-8586"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8587"></a>          <span class="c">! na</span>
<a name="ln-8588"></a>
<a name="ln-8589"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8590"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>         <span class="c">! Index to furnace</span>
<a name="ln-8591"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-8592"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanOpMode</span>          <span class="c">! Cycling fan or constant fan</span>
<a name="ln-8593"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-8594"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolPartLoadRatio</span>  <span class="c">! DX cooling coil part load ratio</span>
<a name="ln-8595"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatPartLoadRatio</span>  <span class="c">! DX heating coil part load ratio (0 for other heating coil types)</span>
<a name="ln-8596"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatCoilLoad</span>       <span class="c">! Heating coil load for gas heater</span>
<a name="ln-8597"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SensibleLoadMet</span>    <span class="c">! Sensible cooling load met (furnace outlet with respect to control zone temp)</span>
<a name="ln-8598"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LatentLoadMet</span>      <span class="c">! Latent cooling load met (furnace outlet with respect to control zone humidity ratio)</span>
<a name="ln-8599"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LoadToBeMet</span>        <span class="c">! Sensible or Latent load to be met by furnace</span>
<a name="ln-8600"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! Ratio of compressor ON air mass flow to AVERAGE air mass flow over time step</span>
<a name="ln-8601"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RuntimeFrac</span>        <span class="c">! heat pump runtime fraction</span>
<a name="ln-8602"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolingHeatingPLRRatio</span> <span class="c">! ratio of cooling PLR to heating PLR, used for cycling fan RH control</span>
<a name="ln-8603"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to enable HX based on zone moisture load</span>
<a name="ln-8604"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">errflag</span>            <span class="c">! flag denoting error in runtime calculation</span>
<a name="ln-8605"></a>
<a name="ln-8606"></a><span class="c">! Convert parameters to usable variables</span>
<a name="ln-8607"></a>  <span class="n">FurnaceNum</span>           <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8608"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8609"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8610"></a>  <span class="k">ELSE</span>
<a name="ln-8611"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8612"></a>  <span class="k">END IF</span>
<a name="ln-8613"></a><span class="k">  </span><span class="n">FanOpMode</span>            <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8614"></a>  <span class="n">CompOp</span>               <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-8615"></a>  <span class="n">LoadToBeMet</span>          <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-8616"></a>
<a name="ln-8617"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8618"></a><span class="k">   </span><span class="n">CoolPartLoadRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8619"></a>   <span class="n">HeatPartLoadRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8620"></a>   <span class="n">HeatCoilLoad</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8621"></a>  <span class="k">ELSE</span>
<a name="ln-8622"></a><span class="k">   </span><span class="n">CoolPartLoadRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8623"></a>   <span class="n">HeatPartLoadRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8624"></a>
<a name="ln-8625"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingGas</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8626"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingElectric</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8627"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingWater</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span>    <span class="p">&amp;</span>
<a name="ln-8628"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Coil_HeatingSteam</span> <span class="p">)</span><span class="k">THEN</span>
<a name="ln-8629"></a><span class="k">      </span><span class="n">HeatCoilLoad</span>      <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadRatio</span>
<a name="ln-8630"></a>   <span class="k">ELSE</span>
<a name="ln-8631"></a><span class="k">      </span><span class="n">HeatCoilLoad</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8632"></a>   <span class="k">END IF</span>
<a name="ln-8633"></a><span class="k">  END IF</span>
<a name="ln-8634"></a>
<a name="ln-8635"></a><span class="c">!  OnOffAirFlowRatio = Par(8)</span>
<a name="ln-8636"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatPump_WaterToAir</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8637"></a><span class="k">   CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-8638"></a>   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8639"></a>   <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-8640"></a>  <span class="k">END IF</span>
<a name="ln-8641"></a>
<a name="ln-8642"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8643"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8644"></a>  <span class="k">ELSE</span>
<a name="ln-8645"></a><span class="k">    </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8646"></a>  <span class="k">END IF</span>
<a name="ln-8647"></a>
<a name="ln-8648"></a><span class="k">  IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8649"></a><span class="c">!    Par(10) = Furnace(FurnaceNum)%HeatPartLoadRatio</span>
<a name="ln-8650"></a><span class="c">!    FanOpMode = CycFan and Furnace(FurnaceNum)%HeatPartLoadRatio must be &gt; 0 for Part(10) to be greater than 0</span>
<a name="ln-8651"></a><span class="c">!    This variable used when in heating mode and dehumidification (cooling) is required.</span>
<a name="ln-8652"></a>    <span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="nb">MIN</span><span class="p">(</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatPartLoadRatio</span><span class="p">)</span>
<a name="ln-8653"></a>  <span class="k">ELSE</span>
<a name="ln-8654"></a><span class="k">    </span><span class="n">CoolingHeatingPLRRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8655"></a>  <span class="k">END IF</span>
<a name="ln-8656"></a>
<a name="ln-8657"></a><span class="c">! Subroutine arguments</span>
<a name="ln-8658"></a><span class="c">! CALL CalcFurnaceOutput(FurnaceNum,FirstHVACIteration,FanOpMode,CompOp,CoolPartLoadRatio,HeatPartLoadRatio, &amp;</span>
<a name="ln-8659"></a><span class="c">!                    HeatCoilLoad, ReHeatCoilLoad, SensibleLoadMet, LatentLoadMet, OnOffAirFlowRatio, HXUnitOn)</span>
<a name="ln-8660"></a>  <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,</span><span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8661"></a>                         <span class="n">HeatCoilLoad</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">SensibleLoadMet</span><span class="p">,</span> <span class="n">LatentLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-8662"></a>                         <span class="n">CoolingHeatingPLRRatio</span><span class="p">)</span>
<a name="ln-8663"></a>
<a name="ln-8664"></a><span class="c">! Calculate residual based on output calculation flag</span>
<a name="ln-8665"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8666"></a><span class="k">    IF</span><span class="p">(</span><span class="n">LoadToBeMet</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8667"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">SensibleLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-8668"></a>    <span class="k">ELSE</span>
<a name="ln-8669"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">SensibleLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">LoadToBeMet</span>
<a name="ln-8670"></a>    <span class="k">END IF</span>
<a name="ln-8671"></a><span class="k">  ELSE</span>
<a name="ln-8672"></a><span class="k">    IF</span><span class="p">(</span><span class="n">LoadToBeMet</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8673"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">LatentLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-8674"></a>    <span class="k">ELSE</span>
<a name="ln-8675"></a><span class="k">      </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">LatentLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">LoadToBeMet</span>
<a name="ln-8676"></a>    <span class="k">END IF</span>
<a name="ln-8677"></a><span class="k">  END IF</span>
<a name="ln-8678"></a>
<a name="ln-8679"></a><span class="k">RETURN</span>
<a name="ln-8680"></a><span class="k">END FUNCTION </span><span class="n">CalcFurnaceResidual</span>
<a name="ln-8681"></a>
<a name="ln-8682"></a>
<a name="ln-8683"></a><span class="k">FUNCTION </span><span class="n">CalcWaterToAirResidual</span><span class="p">(</span><span class="n">PartLoadRatio</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-8684"></a>
<a name="ln-8685"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-8686"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-8687"></a>          <span class="c">!       DATE WRITTEN   October 2006</span>
<a name="ln-8688"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8689"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8690"></a>
<a name="ln-8691"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8692"></a>          <span class="c">! To calculate the part-load ratio for water to air HP&#39;s</span>
<a name="ln-8693"></a>          <span class="c">! this is used for parameter estimation WAHPs but not equation fit WAHPs</span>
<a name="ln-8694"></a>
<a name="ln-8695"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8696"></a>          <span class="c">! Use SolveRegulaFalsi to call this Function to converge on a solution</span>
<a name="ln-8697"></a>
<a name="ln-8698"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8699"></a>          <span class="c">! na</span>
<a name="ln-8700"></a>
<a name="ln-8701"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8702"></a>          <span class="c">! na</span>
<a name="ln-8703"></a>
<a name="ln-8704"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8705"></a>
<a name="ln-8706"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8707"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">PartLoadRatio</span>  <span class="c">! DX cooling coil part load ratio</span>
<a name="ln-8708"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span>            <span class="c">! Function parameters</span>
<a name="ln-8709"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">Residuum</span>       <span class="c">! Result (force to 0)</span>
<a name="ln-8710"></a>
<a name="ln-8711"></a><span class="c">!   Parameter description example:</span>
<a name="ln-8712"></a><span class="c">!     Par(1)  = REAL(FurnaceNum,r64) ! Index to furnace</span>
<a name="ln-8713"></a><span class="c">!     Par(2)  = 0.0                  ! FirstHVACIteration FLAG, if 1.0 then TRUE, if 0.0 then FALSE</span>
<a name="ln-8714"></a><span class="c">!     Par(3)  = REAL(OpMode,r64)     ! Fan control, if 1.0 then cycling fan, if 0.0 then continuous fan</span>
<a name="ln-8715"></a><span class="c">!     Par(4)  = REAL(CompOp,r64)     ! Compressor control, if 1.0 then compressor ON, if 0.0 then compressor OFF</span>
<a name="ln-8716"></a><span class="c">!     Par(5)  = CoolCoilLoad         ! Sensible or Latent load to be met by furnace</span>
<a name="ln-8717"></a><span class="c">!     Par(6)  = 1.0                  ! Type of load FLAG, 0.0 if heating load, 1.0 if cooling or moisture load</span>
<a name="ln-8718"></a><span class="c">!     Par(7)  = 1.0                  ! Output calculation FLAG, 0.0 for latent capacity, 1.0 for sensible capacity</span>
<a name="ln-8719"></a><span class="c">!     Par(8)  = ZoneSensLoadMetFanONCompOFF  ! Output with fan ON compressor OFF</span>
<a name="ln-8720"></a>
<a name="ln-8721"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8722"></a>          <span class="c">! na</span>
<a name="ln-8723"></a>
<a name="ln-8724"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8725"></a>          <span class="c">! na</span>
<a name="ln-8726"></a>
<a name="ln-8727"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8728"></a>          <span class="c">! na</span>
<a name="ln-8729"></a>
<a name="ln-8730"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8731"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>         <span class="c">! Index to furnace</span>
<a name="ln-8732"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-8733"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">FanOpMode</span>          <span class="c">! Cycling fan or constant fan</span>
<a name="ln-8734"></a>  <span class="kt">INTEGER</span>    <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-8735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CoolPartLoadRatio</span>  <span class="c">! DX cooling coil part load ratio</span>
<a name="ln-8736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatPartLoadRatio</span>  <span class="c">! DX heating coil part load ratio (0 for other heating coil types)</span>
<a name="ln-8737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HeatCoilLoad</span>       <span class="c">! Heating coil load for gas heater</span>
<a name="ln-8738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneSensLoadMet</span>    <span class="c">! Sensible cooling load met (furnace outlet with respect to control zone temp)</span>
<a name="ln-8739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneLatLoadMet</span>     <span class="c">! Latent cooling load met (furnace outlet with respect to control zone humidity ratio)</span>
<a name="ln-8740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">LoadToBeMet</span>        <span class="c">! Sensible or Latent load to be met by furnace</span>
<a name="ln-8741"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">errflag</span>
<a name="ln-8742"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">RuntimeFrac</span>
<a name="ln-8743"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">Dummy</span>
<a name="ln-8744"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">HPCoilSensDemand</span>
<a name="ln-8745"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8746"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-8747"></a>  <span class="kt">LOGICAL</span>    <span class="kd">::</span> <span class="n">HXUnitOn</span>           <span class="c">! flag to enable HX based on zone moisture load (not valid for water-to-air HP&#39;s</span>
<a name="ln-8748"></a>
<a name="ln-8749"></a><span class="c">! Convert parameters to usable variables</span>
<a name="ln-8750"></a>  <span class="n">FurnaceNum</span>           <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-8751"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8752"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8753"></a>  <span class="k">ELSE</span>
<a name="ln-8754"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8755"></a>  <span class="k">END IF</span>
<a name="ln-8756"></a><span class="k">  </span><span class="n">FanOpMode</span>            <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<a name="ln-8757"></a>  <span class="n">CompOp</span>               <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-8758"></a>  <span class="n">LoadToBeMet</span>          <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-8759"></a>
<a name="ln-8760"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8761"></a><span class="k">   </span><span class="n">CoolPartLoadRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8762"></a>   <span class="n">HeatPartLoadRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8763"></a>   <span class="n">HeatCoilLoad</span>        <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8764"></a>  <span class="k">ELSE</span>
<a name="ln-8765"></a><span class="k">   </span><span class="n">CoolPartLoadRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8766"></a>   <span class="n">HeatPartLoadRatio</span>   <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8767"></a>  <span class="k">END IF</span>
<a name="ln-8768"></a><span class="k">  </span><span class="n">ZoneSensLoadMetFanONCompOFF</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-8769"></a>       <span class="c">!calculate the run time fraction</span>
<a name="ln-8770"></a>   <span class="k">CALL </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-8771"></a>
<a name="ln-8772"></a>       <span class="c">!update the fan part load factor</span>
<a name="ln-8773"></a>       <span class="c">!see &#39;Note&#39; under INITIAL CALCULATIONS</span>
<a name="ln-8774"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8775"></a><span class="k">   IF</span><span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8776"></a><span class="k">     </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">CoolPartLoadRatio</span><span class="o">/</span><span class="n">RuntimeFrac</span>
<a name="ln-8777"></a>   <span class="k">ELSE</span>
<a name="ln-8778"></a><span class="k">     </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8779"></a>   <span class="n">ENDIF</span>
<a name="ln-8780"></a>  <span class="k">ELSE</span>
<a name="ln-8781"></a><span class="k">   IF</span><span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8782"></a><span class="k">     </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="n">PartLoadRatio</span><span class="o">/</span><span class="n">RuntimeFrac</span>
<a name="ln-8783"></a><span class="c">!   Else IF(RuntimeFrac == 0.0d0)THEN</span>
<a name="ln-8784"></a><span class="c">!     OnOffFanPartLoadFraction = 0.0</span>
<a name="ln-8785"></a>   <span class="k">ELSE</span>
<a name="ln-8786"></a><span class="k">     </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8787"></a>   <span class="n">ENDIF</span>
<a name="ln-8788"></a>  <span class="k">END IF</span>
<a name="ln-8789"></a><span class="k">  </span><span class="n">OnOffFanPartLoadFractionSave</span> <span class="o">=</span> <span class="n">OnOffFanPartLoadFraction</span>
<a name="ln-8790"></a>       <span class="c">!update fan and compressor run times</span>
<a name="ln-8791"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadRatio</span>
<a name="ln-8792"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">WSHPRuntimeFrac</span>   <span class="o">=</span> <span class="n">RuntimeFrac</span>
<a name="ln-8793"></a>
<a name="ln-8794"></a>       <span class="c">!Calculate the heating coil demand as (the zone sensible load - load met by fan heat and mixed air)</span>
<a name="ln-8795"></a>       <span class="c">!Note; The load met by fan heat and mixed air is calculated as mdot(zoneinletenthalpy-zoneoutletenthalpy)</span>
<a name="ln-8796"></a>       <span class="c">!This accounts for the negative sign in the equation.</span>
<a name="ln-8797"></a>
<a name="ln-8798"></a>       <span class="c">!Calculate the heat coil sensible capacity as the load met by the system with the fan and compressor on less</span>
<a name="ln-8799"></a>       <span class="c">!the load met by the system with the compressor off.</span>
<a name="ln-8800"></a><span class="c">!  HPCoilSensCapacity = ZoneSensLoadMetFanONCompON - ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8801"></a>
<a name="ln-8802"></a>    <span class="c">!Set input parameters for heat pump coil model</span>
<a name="ln-8803"></a>  <span class="n">HPCoilSensDemand</span> <span class="o">=</span> <span class="n">LoadToBeMet</span>  <span class="o">-</span> <span class="n">RuntimeFrac</span><span class="o">*</span><span class="n">ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8804"></a><span class="c">!  HPCoilSensDemand = LoadToBeMet  - PartLoadRatio*ZoneSensLoadMetFanONCompOFF</span>
<a name="ln-8805"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8806"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8807"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">HPCoilSensDemand</span><span class="p">)</span>
<a name="ln-8808"></a>  <span class="k">ELSE</span>
<a name="ln-8809"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span>   <span class="o">=</span> <span class="n">HPCoilSensDemand</span>
<a name="ln-8810"></a>    <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8811"></a>  <span class="k">END IF</span>
<a name="ln-8812"></a><span class="k">  </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">InitHeatPump</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>      <span class="c">!initialization call to Calc Furnace</span>
<a name="ln-8813"></a>
<a name="ln-8814"></a>    <span class="c">!Calculate the zone loads met and the new part load ratio and for the specified run time</span>
<a name="ln-8815"></a>   <span class="n">Dummy</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-8816"></a>   <span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8817"></a>   <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8818"></a><span class="k">     </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-8819"></a>   <span class="k">ELSE</span>
<a name="ln-8820"></a><span class="k">     </span><span class="n">HXUnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8821"></a>   <span class="k">END IF</span>
<a name="ln-8822"></a>
<a name="ln-8823"></a><span class="c">!  Subroutine arguments</span>
<a name="ln-8824"></a><span class="c">!  CALL CalcFurnaceOutput(FurnaceNum,FirstHVACIteration,FanOpMode,CompOp,CoolPartLoadRatio,&amp;</span>
<a name="ln-8825"></a><span class="c">!                         HeatPartLoadRatio, HeatCoilLoad, ReHeatCoilLoad, SensibleLoadMet, LatentLoadMet, HXUnitOn)</span>
<a name="ln-8826"></a>   <span class="k">CALL </span><span class="n">CalcFurnaceOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">FanOpMode</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">CoolPartLoadRatio</span><span class="p">,&amp;</span>
<a name="ln-8827"></a>                          <span class="n">HeatPartLoadRatio</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">Dummy</span><span class="p">,</span> <span class="n">ZoneSensLoadMet</span><span class="p">,</span><span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">HXUnitOn</span><span class="p">)</span>
<a name="ln-8828"></a>
<a name="ln-8829"></a><span class="c">! Calculate residual based on output calculation flag</span>
<a name="ln-8830"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8831"></a><span class="k">    </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">LoadToBeMet</span>
<a name="ln-8832"></a>  <span class="k">ELSE</span>
<a name="ln-8833"></a><span class="k">    </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneLatLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">LoadToBeMet</span>
<a name="ln-8834"></a>  <span class="k">END IF</span>
<a name="ln-8835"></a>
<a name="ln-8836"></a><span class="k">RETURN</span>
<a name="ln-8837"></a><span class="k">END FUNCTION </span><span class="n">CalcWaterToAirResidual</span>
<a name="ln-8838"></a>
<a name="ln-8839"></a>
<a name="ln-8840"></a><span class="k">SUBROUTINE </span><span class="n">SetAverageAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-8841"></a>
<a name="ln-8842"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8843"></a>          <span class="c">!       AUTHOR         Richard Raustad</span>
<a name="ln-8844"></a>          <span class="c">!       DATE WRITTEN   July 2005</span>
<a name="ln-8845"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8846"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8847"></a>
<a name="ln-8848"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8849"></a>          <span class="c">! Set the average air mass flow rates using the part-load fraction of the HVAC system for this time step</span>
<a name="ln-8850"></a>          <span class="c">! Set OnOffAirFlowRatio to be used by DX coils</span>
<a name="ln-8851"></a>
<a name="ln-8852"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8853"></a>          <span class="c">! The air flow rate in cooling, heating, and no cooling or heating can be different.</span>
<a name="ln-8854"></a>          <span class="c">! Calculate the air flow rate based on initializations made in InitFurnace.</span>
<a name="ln-8855"></a>
<a name="ln-8856"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8857"></a>          <span class="c">! na</span>
<a name="ln-8858"></a>
<a name="ln-8859"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8860"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-8861"></a>
<a name="ln-8862"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8863"></a>
<a name="ln-8864"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8865"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>         <span class="c">! Unit index</span>
<a name="ln-8866"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! unit part load ratio</span>
<a name="ln-8867"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-8868"></a>
<a name="ln-8869"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8870"></a>          <span class="c">! na</span>
<a name="ln-8871"></a>
<a name="ln-8872"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8873"></a>          <span class="c">! na</span>
<a name="ln-8874"></a>
<a name="ln-8875"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8876"></a>          <span class="c">! na</span>
<a name="ln-8877"></a>
<a name="ln-8878"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8879"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! inlet node number for furnace</span>
<a name="ln-8880"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AverageUnitMassFlow</span> <span class="c">! average supply air mass flow rate over time step</span>
<a name="ln-8881"></a>
<a name="ln-8882"></a>  <span class="n">InletNode</span>      <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-8883"></a>
<a name="ln-8884"></a>  <span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-8885"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-8886"></a><span class="k">    </span><span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-8887"></a>  <span class="k">ELSE</span>
<a name="ln-8888"></a><span class="k">    </span><span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-8889"></a>  <span class="k">END IF</span>
<a name="ln-8890"></a><span class="c">! IF the furnace is scheduled on or nightime cycle overrides fan schedule. Uses same logic as fan.</span>
<a name="ln-8891"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-8892"></a>     <span class="p">(</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TurnFansOn</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-8893"></a>          <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">TurnFansOff</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8894"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-8895"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>      <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-8896"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AverageUnitMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8897"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">/</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-8898"></a>    <span class="k">ELSE</span>
<a name="ln-8899"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8900"></a>    <span class="k">END IF</span>
<a name="ln-8901"></a><span class="k">  ELSE</span>
<a name="ln-8902"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-8903"></a>    <span class="n">OnOffAirFlowRatio</span>                         <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8904"></a>  <span class="k">END IF</span>
<a name="ln-8905"></a>
<a name="ln-8906"></a><span class="k">  </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-8907"></a>  <span class="n">OnOffAirFlowRatioSave</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-8908"></a>
<a name="ln-8909"></a>  <span class="k">RETURN</span>
<a name="ln-8910"></a><span class="k">END SUBROUTINE </span><span class="n">SetAverageAirFlow</span>
<a name="ln-8911"></a>
<a name="ln-8912"></a>
<a name="ln-8913"></a><span class="k">SUBROUTINE </span><span class="n">HeatPumpRunFrac</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PLR</span><span class="p">,</span><span class="n">errflag</span><span class="p">,</span><span class="n">RuntimeFrac</span><span class="p">)</span>
<a name="ln-8914"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-8915"></a>          <span class="c">!       AUTHOR         Kenneth Tang</span>
<a name="ln-8916"></a>          <span class="c">!       DATE WRITTEN   Apr 2004</span>
<a name="ln-8917"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-8918"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-8919"></a>
<a name="ln-8920"></a>
<a name="ln-8921"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-8922"></a>          <span class="c">! This subroutine calculates the PLF based on the PLR. Parameters required are</span>
<a name="ln-8923"></a>          <span class="c">! thermostat cycling rate (Nmax), heat pump time constant (tau), and the fraction</span>
<a name="ln-8924"></a>          <span class="c">! of on-cycle power use (pr)</span>
<a name="ln-8925"></a>
<a name="ln-8926"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-8927"></a>          <span class="c">! NA</span>
<a name="ln-8928"></a>
<a name="ln-8929"></a>
<a name="ln-8930"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-8931"></a>          <span class="c">! (1) Henderson, H. I., K. Rengarajan.1996. A Model to predict the latent capacity</span>
<a name="ln-8932"></a>          <span class="c">! of air conditioners and heat pumps at part-load conditions with constant fan</span>
<a name="ln-8933"></a>          <span class="c">! operation. ASHRAE Transactions 102 (1): 266-274</span>
<a name="ln-8934"></a>
<a name="ln-8935"></a>          <span class="c">! (2) Henderson, H.I. Jr., Y.J. Huang and Danny Parker. 1999. Residential Equipment</span>
<a name="ln-8936"></a>          <span class="c">! Part Load Curves for Use in DOE-2.  Environmental Energy Technologies Division,</span>
<a name="ln-8937"></a>          <span class="c">! Ernest Orlando Lawrence Berkeley National Laboratory.</span>
<a name="ln-8938"></a>
<a name="ln-8939"></a>
<a name="ln-8940"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-8941"></a>
<a name="ln-8942"></a>
<a name="ln-8943"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-8944"></a>
<a name="ln-8945"></a>
<a name="ln-8946"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-8947"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">FurnaceNum</span>       <span class="c">! Furnace Index Number</span>
<a name="ln-8948"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">PLR</span>              <span class="c">! part load ratio</span>
<a name="ln-8949"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">RuntimeFrac</span>      <span class="c">! the required run time fraction to meet part load</span>
<a name="ln-8950"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">errflag</span>          <span class="c">! part load factor out of range flag</span>
<a name="ln-8951"></a>
<a name="ln-8952"></a>
<a name="ln-8953"></a>
<a name="ln-8954"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-8955"></a>          <span class="c">! na</span>
<a name="ln-8956"></a>
<a name="ln-8957"></a>
<a name="ln-8958"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-8959"></a>          <span class="c">! na</span>
<a name="ln-8960"></a>
<a name="ln-8961"></a>
<a name="ln-8962"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-8963"></a>          <span class="c">! na</span>
<a name="ln-8964"></a>
<a name="ln-8965"></a>
<a name="ln-8966"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-8967"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadFactor</span> <span class="c">! Part load factor</span>
<a name="ln-8968"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Nmax</span>           <span class="c">! Maximum cycling rate [cycles/hr]</span>
<a name="ln-8969"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">tau</span>            <span class="c">! Heat pump time constant [s]</span>
<a name="ln-8970"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">pr</span>             <span class="c">! On-cycle power use fraction [~]</span>
<a name="ln-8971"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">error</span>          <span class="c">! Calculation error</span>
<a name="ln-8972"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF1</span>           <span class="c">! ith term of part load factor</span>
<a name="ln-8973"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PLF2</span>           <span class="c">! (i+1)th term of part load factor</span>
<a name="ln-8974"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">A</span>              <span class="c">! Variable for simplify equation</span>
<a name="ln-8975"></a>  <span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">NumIteration</span>   <span class="c">! Iteration Counter</span>
<a name="ln-8976"></a>
<a name="ln-8977"></a>  <span class="n">Nmax</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span>
<a name="ln-8978"></a>  <span class="n">tau</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span>
<a name="ln-8979"></a>  <span class="n">pr</span><span class="o">=</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OnCyclePowerFraction</span>
<a name="ln-8980"></a>
<a name="ln-8981"></a>  <span class="c">!Initialize</span>
<a name="ln-8982"></a>  <span class="n">errflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-8983"></a>  <span class="n">error</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8984"></a>  <span class="n">NumIteration</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-8985"></a>
<a name="ln-8986"></a>  <span class="c">!Initial guess for part load fraction</span>
<a name="ln-8987"></a>  <span class="n">PLF1</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8988"></a>
<a name="ln-8989"></a>  <span class="c">!Calculate PLF using successive substitution until convergence</span>
<a name="ln-8990"></a>  <span class="c">!is achieved</span>
<a name="ln-8991"></a>  <span class="n">LOOPPLF</span><span class="p">:</span> <span class="k">DO</span>
<a name="ln-8992"></a><span class="k">    </span><span class="n">NumIteration</span><span class="o">=</span><span class="n">NumIteration</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-8993"></a>
<a name="ln-8994"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">PLR</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-8995"></a>        <span class="c">! Set part load fraction, PLF1=1.0 if PLR=1.0 and exit loop</span>
<a name="ln-8996"></a>        <span class="n">PLF1</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-8997"></a>        <span class="k">EXIT </span><span class="n">LOOPPLF</span>
<a name="ln-8998"></a>    <span class="k">END IF</span>
<a name="ln-8999"></a>
<a name="ln-9000"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">NumIteration</span><span class="p">.</span><span class="n">GT</span><span class="p">.</span><span class="mi">100</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9001"></a>        <span class="c">! Exit loop if interation exceed 100</span>
<a name="ln-9002"></a>        <span class="n">errflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9003"></a>        <span class="n">PLF1</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9004"></a>        <span class="k">EXIT </span><span class="n">LOOPPLF</span>
<a name="ln-9005"></a>    <span class="k">END IF</span>
<a name="ln-9006"></a>
<a name="ln-9007"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">error</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">0.00001d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9008"></a>        <span class="c">! Exit loop if convergence is achieved</span>
<a name="ln-9009"></a>        <span class="k">EXIT </span><span class="n">LOOPPLF</span>
<a name="ln-9010"></a>
<a name="ln-9011"></a>    <span class="k">ELSE</span>
<a name="ln-9012"></a>        <span class="c">! Calculate PLF</span>
<a name="ln-9013"></a>        <span class="n">A</span> <span class="o">=</span> <span class="mf">4.d0</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">*</span> <span class="p">(</span><span class="n">Nmax</span><span class="o">/</span><span class="mi">360</span><span class="mf">0.d0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span>
<a name="ln-9014"></a>        <span class="k">IF</span> <span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="mf">1.5d-3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9015"></a>            <span class="c">! A safety check to prevent PLF2 = 1 - A * (1 - Exp(-1 / A))</span>
<a name="ln-9016"></a>            <span class="c">! from &quot;float underflow error&quot;. Occurs when PLR is very close to 1.0,</span>
<a name="ln-9017"></a>            <span class="c">! small A value, thus Exp(-1/A) = 0</span>
<a name="ln-9018"></a>            <span class="n">PLF2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">A</span>
<a name="ln-9019"></a>        <span class="k">ELSE</span>
<a name="ln-9020"></a><span class="k">            </span><span class="n">PLF2</span> <span class="o">=</span> <span class="mf">1.0d0</span> <span class="o">-</span> <span class="n">A</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0d0</span> <span class="o">-</span> <span class="nb">Exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span> <span class="o">/</span> <span class="n">A</span><span class="p">))</span>
<a name="ln-9021"></a>        <span class="k">END IF</span>
<a name="ln-9022"></a><span class="k">        </span><span class="n">error</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">((</span><span class="n">PLF2</span> <span class="o">-</span> <span class="n">PLF1</span><span class="p">)</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span>
<a name="ln-9023"></a>        <span class="n">PLF1</span> <span class="o">=</span> <span class="n">PLF2</span>
<a name="ln-9024"></a>     <span class="k">END IF</span>
<a name="ln-9025"></a><span class="k">  END DO </span><span class="n">LOOPPLF</span>
<a name="ln-9026"></a>
<a name="ln-9027"></a>  <span class="c">!Adjust PLF for the off cycle power consumption if</span>
<a name="ln-9028"></a>  <span class="c">!on-cycle power use is specified by the user</span>
<a name="ln-9029"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">pr</span><span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9030"></a><span class="k">    </span><span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="n">PLR</span> <span class="o">/</span> <span class="p">((</span><span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PLF1</span><span class="p">)</span> <span class="o">*</span> <span class="n">pr</span><span class="p">)</span>
<a name="ln-9031"></a>  <span class="k">ELSE</span>
<a name="ln-9032"></a><span class="k">    </span><span class="n">PartLoadFactor</span><span class="o">=</span><span class="n">PLF1</span>
<a name="ln-9033"></a>  <span class="k">END IF</span>
<a name="ln-9034"></a>
<a name="ln-9035"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">PartLoadFactor</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9036"></a><span class="k">     </span><span class="n">PartLoadFactor</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9037"></a>     <span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9038"></a>     <span class="n">errflag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9039"></a>  <span class="k">ELSE</span>
<a name="ln-9040"></a><span class="k">     </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="n">PLR</span> <span class="o">/</span> <span class="n">PartLoadFactor</span>
<a name="ln-9041"></a>  <span class="n">ENDIF</span>
<a name="ln-9042"></a>
<a name="ln-9043"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">RuntimeFrac</span> <span class="o">&gt;</span> <span class="mf">1.0d0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9044"></a><span class="k">     </span><span class="n">RuntimeFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9045"></a>  <span class="k">END IF</span>
<a name="ln-9046"></a>
<a name="ln-9047"></a><span class="k"> RETURN</span>
<a name="ln-9048"></a>
<a name="ln-9049"></a><span class="k">END SUBROUTINE </span><span class="n">HeatPumpRunFrac</span>
<a name="ln-9050"></a>
<a name="ln-9051"></a>
<a name="ln-9052"></a>
<a name="ln-9053"></a><span class="c">! Beginning of Reporting subroutines for the Furnace Module</span>
<a name="ln-9054"></a><span class="c">! *****************************************************************************</span>
<a name="ln-9055"></a>
<a name="ln-9056"></a>
<a name="ln-9057"></a><span class="k">SUBROUTINE </span><span class="n">ReportFurnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)</span>
<a name="ln-9058"></a>
<a name="ln-9059"></a>
<a name="ln-9060"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9061"></a>          <span class="c">!       AUTHOR         Richard Liesen</span>
<a name="ln-9062"></a>          <span class="c">!       DATE WRITTEN   Feb 2001</span>
<a name="ln-9063"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9064"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9065"></a>
<a name="ln-9066"></a>
<a name="ln-9067"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9068"></a>          <span class="c">! This subroutine updates the report variable for the coils.</span>
<a name="ln-9069"></a>
<a name="ln-9070"></a>
<a name="ln-9071"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9072"></a>          <span class="c">! Update fan part-load ratio based on mass flow rate ratio.</span>
<a name="ln-9073"></a>          <span class="c">! Update global variables used by AirflowNetwork module.</span>
<a name="ln-9074"></a>
<a name="ln-9075"></a>
<a name="ln-9076"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9077"></a>          <span class="c">! na</span>
<a name="ln-9078"></a>
<a name="ln-9079"></a>
<a name="ln-9080"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9081"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">LoopSystemOnMassFlowrate</span><span class="p">,</span><span class="n">LoopSystemOffMassFlowrate</span><span class="p">,</span><span class="n">LoopFanOperationMode</span><span class="p">,</span><span class="n">LoopOnOffFanPartLoadRatio</span>
<a name="ln-9082"></a>
<a name="ln-9083"></a>
<a name="ln-9084"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9085"></a>
<a name="ln-9086"></a>
<a name="ln-9087"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9088"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FurnaceNum</span>
<a name="ln-9089"></a>
<a name="ln-9090"></a>
<a name="ln-9091"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9092"></a>          <span class="c">! na</span>
<a name="ln-9093"></a>
<a name="ln-9094"></a>
<a name="ln-9095"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9096"></a>          <span class="c">! na</span>
<a name="ln-9097"></a>
<a name="ln-9098"></a>
<a name="ln-9099"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9100"></a>          <span class="c">! na</span>
<a name="ln-9101"></a>
<a name="ln-9102"></a>
<a name="ln-9103"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9104"></a>          <span class="c">! na</span>
<a name="ln-9105"></a>
<a name="ln-9106"></a>
<a name="ln-9107"></a>  <span class="c">! Report the Furnace Fan Part Load Ratio</span>
<a name="ln-9108"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9109"></a><span class="k">      IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9110"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span><span class="o">/</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-9111"></a>      <span class="k">ELSE</span>
<a name="ln-9112"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9113"></a>      <span class="k">END IF</span>
<a name="ln-9114"></a><span class="k">  END IF</span>
<a name="ln-9115"></a>
<a name="ln-9116"></a>  <span class="c">! Set mass flow rates during on and off cylce using an OnOff fan</span>
<a name="ln-9117"></a>  <span class="n">LoopSystemOnMassFlowrate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-9118"></a>  <span class="n">LoopSystemOffMassFlowrate</span> <span class="o">=</span> <span class="n">CompOffMassFlow</span>
<a name="ln-9119"></a>  <span class="n">LoopFanOperationMode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-9120"></a>  <span class="n">LoopOnOffFanPartLoadRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span>
<a name="ln-9121"></a>
<a name="ln-9122"></a>  <span class="k">RETURN</span>
<a name="ln-9123"></a><span class="k">END Subroutine </span><span class="n">ReportFurnace</span>
<a name="ln-9124"></a>
<a name="ln-9125"></a><span class="k">SUBROUTINE </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">QCoilLoad</span><span class="p">,</span><span class="n">FanMode</span><span class="p">,</span><span class="n">HeatCoilLoadmet</span><span class="p">)</span>
<a name="ln-9126"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9127"></a>          <span class="c">!       AUTHOR         Bereket Nigusse, FSEC/UCF</span>
<a name="ln-9128"></a>          <span class="c">!       DATE WRITTEN   January 2012</span>
<a name="ln-9129"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9130"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9131"></a>
<a name="ln-9132"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9133"></a>          <span class="c">! This subroutine simulates the four non dx heating coil types: Gas, Electric, hot water and steam.</span>
<a name="ln-9134"></a>
<a name="ln-9135"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9136"></a>          <span class="c">! Simply calls the different heating coil component.  The hot water flow rate matching the coil load</span>
<a name="ln-9137"></a>          <span class="c">! is calculated iteratively.</span>
<a name="ln-9138"></a>
<a name="ln-9139"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9140"></a>          <span class="c">! na</span>
<a name="ln-9141"></a>
<a name="ln-9142"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9143"></a>
<a name="ln-9144"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-9145"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-9146"></a>  <span class="k">USE </span><span class="n">SteamCoils</span><span class="p">,</span>                <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateSteamCoilComponents</span>
<a name="ln-9147"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-9148"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span><span class="n">RoundSigDigits</span>
<a name="ln-9149"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallLoad</span>
<a name="ln-9150"></a>
<a name="ln-9151"></a>  <span class="k">IMPLICIT NONE</span>     <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9152"></a>
<a name="ln-9153"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9154"></a>  <span class="kt">INTEGER</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>                <span class="c">! Furnace Index</span>
<a name="ln-9155"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>        <span class="c">! flag for first HVAC iteration in the time step</span>
<a name="ln-9156"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QCoilLoad</span>                 <span class="c">! load met by unit (watts)</span>
<a name="ln-9157"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">HeatCoilLoadmet</span>           <span class="c">! Heating Load Met</span>
<a name="ln-9158"></a>  <span class="kt">LOGICAL</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span>       <span class="c">! .true. if supplemental heating coil</span>
<a name="ln-9159"></a>  <span class="kt">INTEGER</span><span class="p">,</span>      <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FanMode</span>                   <span class="c">! fan operation mode</span>
<a name="ln-9160"></a>
<a name="ln-9161"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9162"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">ErrTolerance</span> <span class="o">=</span> <span class="mf">0.001d0</span>    <span class="c">! convergence limit for hotwater coil</span>
<a name="ln-9163"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">SolveMaxIter</span><span class="o">=</span><span class="mi">50</span>
<a name="ln-9164"></a>
<a name="ln-9165"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9166"></a>          <span class="c">! na</span>
<a name="ln-9167"></a>
<a name="ln-9168"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9169"></a>          <span class="c">! na</span>
<a name="ln-9170"></a>
<a name="ln-9171"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9172"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">QCoilReq</span>        <span class="c">! Heat addition required from an electric, gas, steam , or hot water heating coil</span>
<a name="ln-9173"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">QActual</span>         <span class="c">! actual heating load</span>
<a name="ln-9174"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">FanOpMode</span>       <span class="c">! cycling fan or constant fan</span>
<a name="ln-9175"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">mdot</span>            <span class="c">! heating coil steam or hot water mass flow rate</span>
<a name="ln-9176"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MinWaterFlow</span>    <span class="c">! coil minimum hot water mass flow rate, kg/s</span>
<a name="ln-9177"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">MaxHotWaterFlow</span> <span class="c">! coil maximum hot water mass flow rate, kg/s</span>
<a name="ln-9178"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">HotWaterMdot</span>    <span class="c">! actual hot water mass flow rate</span>
<a name="ln-9179"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>
<a name="ln-9180"></a>  <span class="kt">INTEGER</span>        <span class="kd">::</span> <span class="n">SolFlag</span>
<a name="ln-9181"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilName</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! name of heating coil</span>
<a name="ln-9182"></a>  <span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">MaxNameLength</span><span class="p">)</span> <span class="kd">::</span> <span class="n">HeatingCoilType</span>  <span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="c">! type of heating coil</span>
<a name="ln-9183"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilTypeNum</span>                      <span class="o">=</span><span class="mi">0</span>   <span class="c">! heating coil type number</span>
<a name="ln-9184"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">HeatingCoilIndex</span>                 <span class="o">=</span><span class="mi">0</span>   <span class="c">! heating coil index</span>
<a name="ln-9185"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilControlNode</span>                  <span class="o">=</span><span class="mi">0</span>   <span class="c">! control node for hot water and steam heating coils</span>
<a name="ln-9186"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CoilOutletNode</span>                   <span class="o">=</span><span class="mi">0</span>   <span class="c">! air outlet node of the heatiing coils</span>
<a name="ln-9187"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopNum</span>                          <span class="o">=</span><span class="mi">0</span>   <span class="c">! plant loop number</span>
<a name="ln-9188"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">LoopSideNum</span>                      <span class="o">=</span><span class="mi">0</span>   <span class="c">! plant loop side number</span>
<a name="ln-9189"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">BranchNum</span>                        <span class="o">=</span><span class="mi">0</span>   <span class="c">! plant branch number</span>
<a name="ln-9190"></a>  <span class="kt">INTEGER</span>      <span class="kd">::</span> <span class="n">CompNum</span>                          <span class="o">=</span><span class="mi">0</span>   <span class="c">! Numeric Equivalent for Supplemental Heat Coil Type</span>
<a name="ln-9191"></a>
<a name="ln-9192"></a> <span class="n">QActual</span><span class="o">=</span><span class="mf">0.0d0</span>
<a name="ln-9193"></a>
<a name="ln-9194"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="n">SuppHeatingCoilFlag</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-9195"></a><span class="k">   </span><span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span>
<a name="ln-9196"></a>   <span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span>
<a name="ln-9197"></a>   <span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span>
<a name="ln-9198"></a>   <span class="n">CoilOutletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span>
<a name="ln-9199"></a>   <span class="n">CoilTypeNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilType_Num</span>
<a name="ln-9200"></a>   <span class="n">LoopNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span>
<a name="ln-9201"></a>   <span class="n">LoopSideNum</span> <span class="o">=</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span>
<a name="ln-9202"></a>   <span class="n">BranchNum</span> <span class="o">=</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span>
<a name="ln-9203"></a>   <span class="n">CompNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span>
<a name="ln-9204"></a>   <span class="n">MaxHotWaterFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxSuppCoilFluidFlow</span>
<a name="ln-9205"></a><span class="k">ELSE</span>
<a name="ln-9206"></a><span class="k">   </span><span class="n">HeatingCoilName</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span>
<a name="ln-9207"></a>   <span class="n">HeatingCoilIndex</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span>
<a name="ln-9208"></a>   <span class="n">CoilControlNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span>
<a name="ln-9209"></a>   <span class="n">CoilOutletNode</span> <span class="o">=</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span>
<a name="ln-9210"></a>   <span class="n">CoilTypeNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilType_Num</span>
<a name="ln-9211"></a>   <span class="n">LoopNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span>
<a name="ln-9212"></a>   <span class="n">LoopSideNum</span> <span class="o">=</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span>
<a name="ln-9213"></a>   <span class="n">BranchNum</span> <span class="o">=</span>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span>
<a name="ln-9214"></a>   <span class="n">CompNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span>
<a name="ln-9215"></a>   <span class="n">MaxHotWaterFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxHeatCoilFluidFlow</span>
<a name="ln-9216"></a><span class="k">END IF</span>
<a name="ln-9217"></a>
<a name="ln-9218"></a><span class="k">Select Case</span> <span class="p">(</span><span class="n">CoilTypeNum</span><span class="p">)</span>
<a name="ln-9219"></a>     <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingGas</span><span class="p">,</span><span class="n">Coil_HeatingElectric</span><span class="p">,</span><span class="n">Coil_HeatingDesuperheater</span> <span class="p">)</span>
<a name="ln-9220"></a>         <span class="k">CALL </span><span class="n">SimulateHeatingCoilComponents</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9221"></a>                                <span class="n">QCoilReq</span><span class="o">=</span><span class="n">QCoilLoad</span><span class="p">,</span> <span class="n">CompIndex</span><span class="o">=</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9222"></a>                                <span class="n">SuppHeat</span><span class="o">=</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FanOpMode</span><span class="o">=</span><span class="n">FanMode</span><span class="p">)</span>
<a name="ln-9223"></a>     <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingWater</span><span class="p">)</span>
<a name="ln-9224"></a>       <span class="k">IF</span> <span class="p">(</span> <span class="n">QCoilLoad</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9225"></a><span class="k">          Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">MaxHotWaterFlow</span><span class="p">,</span> <span class="n">CoilControlNode</span><span class="p">,</span><span class="n">CoilOutletNode</span><span class="p">,</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9226"></a>                                     <span class="n">LoopSideNum</span><span class="p">,</span> <span class="n">BranchNum</span><span class="p">,</span> <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-9227"></a>          <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">,</span><span class="n">FanMode</span><span class="p">)</span>
<a name="ln-9228"></a>
<a name="ln-9229"></a>          <span class="k">IF</span> <span class="p">(</span> <span class="n">QActual</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">QCoilLoad</span> <span class="o">+</span> <span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9230"></a>             <span class="c">! control water flow to obtain output matching QCoilLoad</span>
<a name="ln-9231"></a>             <span class="n">MinWaterFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9232"></a>             <span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">r64</span><span class="p">)</span>
<a name="ln-9233"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9234"></a><span class="k">               </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9235"></a>             <span class="k">ELSE</span>
<a name="ln-9236"></a><span class="k">               </span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9237"></a>             <span class="k">END IF</span>
<a name="ln-9238"></a><span class="k">             </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">QCoilLoad</span>
<a name="ln-9239"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">SuppHeatingCoilFlag</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9240"></a><span class="k">               </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.d0</span>
<a name="ln-9241"></a>             <span class="k">ELSE</span>
<a name="ln-9242"></a><span class="k">               </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9243"></a>             <span class="k">END IF</span>
<a name="ln-9244"></a><span class="k">             CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrTolerance</span><span class="p">,</span> <span class="n">SolveMaxIter</span><span class="p">,</span> <span class="n">SolFlag</span><span class="p">,</span> <span class="n">HotWaterMdot</span><span class="p">,</span> <span class="n">HotWaterCoilResidual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9245"></a>                                   <span class="n">MinWaterFlow</span><span class="p">,</span> <span class="n">MaxHotWaterFlow</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-9246"></a>             <span class="k">IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9247"></a><span class="k">               IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9248"></a><span class="k">                 CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed for &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9249"></a>                    <span class="nb">trim</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9250"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-9251"></a>                 <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9252"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;  Iteration limit [&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SolveMaxIter</span><span class="p">))</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9253"></a>                    <span class="s1">&#39;] exceeded in calculating hot water mass flow rate&#39;</span><span class="p">)</span>
<a name="ln-9254"></a>               <span class="n">ENDIF</span>
<a name="ln-9255"></a>               <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed (iteration limit [&#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9256"></a>                  <span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SolveMaxIter</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;]) for &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9257"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">),</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex</span><span class="p">)</span>
<a name="ln-9258"></a>             <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">SolFlag</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9259"></a><span class="k">               IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9260"></a><span class="k">                 CALL </span><span class="n">ShowWarningMessage</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed (maximum flow limits) for &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9261"></a>                    <span class="nb">trim</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9262"></a>                    <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
<a name="ln-9263"></a>                 <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<a name="ln-9264"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Bad hot water maximum flow rate limits&#39;</span><span class="p">)</span>
<a name="ln-9265"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Given minimum water flow rate=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MinWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-9266"></a>                 <span class="k">CALL </span><span class="n">ShowContinueError</span><span class="p">(</span><span class="s1">&#39;...Given maximum water flow rate=&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">MaxHotWaterFlow</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39; kg/s&#39;</span><span class="p">)</span>
<a name="ln-9267"></a>               <span class="n">ENDIF</span>
<a name="ln-9268"></a>               <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="s1">&#39;CalcNonDXHeatingCoils: Hot water coil control failed (flow limits) for &#39;</span><span class="o">//</span>  <span class="p">&amp;</span>
<a name="ln-9269"></a>                  <span class="nb">trim</span><span class="p">(</span><span class="n">cFurnaceTypes</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;=&quot;&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9270"></a>                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9271"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HotWaterCoilMaxIterIndex2</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9272"></a>                  <span class="n">ReportMinOf</span><span class="o">=</span><span class="n">MinWaterFlow</span><span class="p">,</span><span class="n">ReportMaxOf</span><span class="o">=</span><span class="n">MaxHotWaterFlow</span><span class="p">,</span><span class="n">ReportMinUnits</span><span class="o">=</span><span class="s1">&#39;[kg/s]&#39;</span><span class="p">,</span><span class="n">ReportMaxUnits</span><span class="o">=</span><span class="s1">&#39;[kg/s]&#39;</span><span class="p">)</span>
<a name="ln-9273"></a>             <span class="k">END IF</span>
<a name="ln-9274"></a><span class="k">          </span><span class="n">ENDIF</span>
<a name="ln-9275"></a>       <span class="k">ELSE</span>
<a name="ln-9276"></a><span class="k">          </span><span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9277"></a>          <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span><span class="p">,</span> <span class="n">CoilControlNode</span><span class="p">,</span><span class="n">CoilOutletNode</span><span class="p">,</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9278"></a>                                     <span class="n">LoopSideNum</span><span class="p">,</span> <span class="n">BranchNum</span><span class="p">,</span> <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-9279"></a>       <span class="n">ENDIF</span>
<a name="ln-9280"></a>       <span class="c">! simulate the hot water heating coil</span>
<a name="ln-9281"></a>       <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QActual</span><span class="p">,</span><span class="n">FanMode</span><span class="p">)</span>
<a name="ln-9282"></a>     <span class="k">Case</span> <span class="p">(</span><span class="n">Coil_HeatingSteam</span><span class="p">)</span>
<a name="ln-9283"></a>         <span class="k">IF</span> <span class="p">(</span> <span class="n">QCoilLoad</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9284"></a><span class="k">             Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">MaxHotWaterFlow</span><span class="p">,</span> <span class="n">CoilControlNode</span><span class="p">,</span><span class="n">CoilOutletNode</span><span class="p">,</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9285"></a>                                        <span class="n">LoopSideNum</span><span class="p">,</span> <span class="n">BranchNum</span><span class="p">,</span> <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-9286"></a>             <span class="c">! simulate the steam heating coil</span>
<a name="ln-9287"></a>             <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">QCoilLoad</span><span class="p">,</span> <span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9288"></a>                                              <span class="n">QActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-9289"></a>         <span class="k">ELSE</span>
<a name="ln-9290"></a><span class="k">             </span><span class="n">mdot</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9291"></a>             <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span><span class="p">,</span> <span class="n">CoilControlNode</span><span class="p">,</span><span class="n">CoilOutletNode</span><span class="p">,</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9292"></a>                                        <span class="n">LoopSideNum</span><span class="p">,</span> <span class="n">BranchNum</span><span class="p">,</span> <span class="n">CompNum</span><span class="p">)</span>
<a name="ln-9293"></a>             <span class="c">! simulate the steam heating coil</span>
<a name="ln-9294"></a>             <span class="k">CALL </span><span class="n">SimulateSteamCoilComponents</span><span class="p">(</span><span class="n">HeatingCoilName</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">QCoilLoad</span><span class="p">,</span> <span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9295"></a>                                              <span class="n">QActual</span><span class="p">,</span> <span class="n">FanMode</span><span class="p">)</span>
<a name="ln-9296"></a>         <span class="n">ENDIF</span>
<a name="ln-9297"></a>
<a name="ln-9298"></a><span class="k">END Select</span>
<a name="ln-9299"></a>
<a name="ln-9300"></a><span class="n">HeatCoilLoadmet</span> <span class="o">=</span> <span class="n">QActual</span>
<a name="ln-9301"></a>
<a name="ln-9302"></a><span class="k">RETURN</span>
<a name="ln-9303"></a><span class="k">END SUBROUTINE </span><span class="n">CalcNonDXHeatingCoils</span>
<a name="ln-9304"></a>
<a name="ln-9305"></a><span class="k">FUNCTION </span><span class="n">HotWaterCoilResidual</span><span class="p">(</span><span class="n">HWFlow</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span> <span class="k">RESULT</span> <span class="p">(</span><span class="n">Residuum</span><span class="p">)</span>
<a name="ln-9306"></a>
<a name="ln-9307"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-9308"></a>          <span class="c">!       AUTHOR         Bereket Nigusse, FSEC/UCF</span>
<a name="ln-9309"></a>          <span class="c">!       DATE WRITTEN   January 2011</span>
<a name="ln-9310"></a>          <span class="c">!       MODIFIED</span>
<a name="ln-9311"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-9312"></a>
<a name="ln-9313"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-9314"></a>          <span class="c">! Calculates residual function (QCoilActual - QCoilRequested) / QCoilRequested</span>
<a name="ln-9315"></a>          <span class="c">! the coil actual output depends on the hot water flow rate which is being varied</span>
<a name="ln-9316"></a>          <span class="c">! to minimize the residual.</span>
<a name="ln-9317"></a>
<a name="ln-9318"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9319"></a>          <span class="c">! Calls HotWaterCoilResidual, and calculates the residual as defined above.</span>
<a name="ln-9320"></a>          <span class="c">!</span>
<a name="ln-9321"></a>
<a name="ln-9322"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9323"></a>
<a name="ln-9324"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9325"></a>  <span class="k">USE </span><span class="n">WaterCoils</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateWaterCoilComponents</span>
<a name="ln-9326"></a>  <span class="k">USE </span><span class="n">PlantUtilities</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SetComponentFlowRate</span>
<a name="ln-9327"></a>
<a name="ln-9328"></a>
<a name="ln-9329"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9330"></a>
<a name="ln-9331"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9332"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>                         <span class="kd">::</span> <span class="n">HWFlow</span>   <span class="c">! hot water flow rate in kg/s</span>
<a name="ln-9333"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span>      <span class="c">! Par(5) is the requested coil load</span>
<a name="ln-9334"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>                                     <span class="kd">::</span> <span class="n">Residuum</span> <span class="c">! residual to be minimized to zero</span>
<a name="ln-9335"></a>
<a name="ln-9336"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-9337"></a>          <span class="c">! na</span>
<a name="ln-9338"></a>
<a name="ln-9339"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9340"></a>          <span class="c">! na</span>
<a name="ln-9341"></a>
<a name="ln-9342"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9343"></a>          <span class="c">! na</span>
<a name="ln-9344"></a>
<a name="ln-9345"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9346"></a>  <span class="kt">INTEGER</span>               <span class="kd">::</span> <span class="n">FurnaceNum</span>
<a name="ln-9347"></a>  <span class="kt">LOGICAL</span>               <span class="kd">::</span> <span class="n">FirstHVACIteration</span>
<a name="ln-9348"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">QCoilActual</span>             <span class="c">! delivered coild load, W</span>
<a name="ln-9349"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">QCoilRequested</span>          <span class="c">! requested coild load, W</span>
<a name="ln-9350"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">mdot</span>
<a name="ln-9351"></a>  <span class="kt">LOGICAL</span>               <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span>       <span class="c">! .true. if supplemental heating coil</span>
<a name="ln-9352"></a>
<a name="ln-9353"></a>  <span class="n">FurnaceNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-9354"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9355"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9356"></a>  <span class="k">ELSE</span>
<a name="ln-9357"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9358"></a>  <span class="k">END IF</span>
<a name="ln-9359"></a><span class="k">  </span><span class="n">QCoilRequested</span> <span class="o">=</span>  <span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a name="ln-9360"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9361"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9362"></a>  <span class="k">ELSE</span>
<a name="ln-9363"></a><span class="k">    </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9364"></a>  <span class="k">END IF</span>
<a name="ln-9365"></a><span class="k">  </span><span class="n">QCoilActual</span> <span class="o">=</span> <span class="n">QCoilRequested</span>
<a name="ln-9366"></a>  <span class="n">mdot</span> <span class="o">=</span> <span class="n">HWFlow</span>
<a name="ln-9367"></a>  <span class="k">IF</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">SuppHeatingCoilFlag</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-9368"></a>
<a name="ln-9369"></a><span class="k">      Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9370"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9371"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9372"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9373"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSide</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9374"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNum</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9375"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNum</span><span class="p">)</span>
<a name="ln-9376"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9377"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9378"></a>                                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">)</span>
<a name="ln-9379"></a>  <span class="k">ELSE</span>
<a name="ln-9380"></a>      <span class="c">! supplemental coil</span>
<a name="ln-9381"></a>      <span class="k">Call </span><span class="n">SetComponentFlowRate</span><span class="p">(</span> <span class="n">mdot</span> <span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9382"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilControlNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9383"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppCoilOutletNode</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9384"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9385"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LoopSideSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9386"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">BranchNumSupp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9387"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompNumSupp</span><span class="p">)</span>
<a name="ln-9388"></a>      <span class="c">! simulate the hot water supplemental heating coil</span>
<a name="ln-9389"></a>      <span class="k">CALL </span><span class="n">SimulateWaterCoilComponents</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilName</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9390"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span><span class="p">,</span> <span class="n">QCoilActual</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9391"></a>                                 <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">)</span>
<a name="ln-9392"></a>  <span class="n">ENDIF</span>
<a name="ln-9393"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">QCoilRequested</span> <span class="o">/=</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9394"></a><span class="k">    </span><span class="n">Residuum</span> <span class="o">=</span> <span class="p">(</span><span class="n">QCoilActual</span> <span class="o">-</span> <span class="n">QCoilRequested</span><span class="p">)</span><span class="o">/</span> <span class="n">QCoilRequested</span>
<a name="ln-9395"></a>  <span class="k">ELSE</span> <span class="c">!Objexx:Return ELSE added to assure return value is set</span>
<a name="ln-9396"></a>    <span class="n">Residuum</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9397"></a>  <span class="n">ENDIF</span>
<a name="ln-9398"></a>  <span class="k">RETURN</span>
<a name="ln-9399"></a><span class="k">END FUNCTION </span><span class="n">HotWaterCoilResidual</span>
<a name="ln-9400"></a>
<a name="ln-9401"></a><span class="c">!        End of Reporting subroutines for the Furnace Module</span>
<a name="ln-9402"></a>
<a name="ln-9403"></a><span class="c">!******************************************************************************</span>
<a name="ln-9404"></a>
<a name="ln-9405"></a><span class="k">SUBROUTINE </span><span class="n">SimVariableSpeedHP</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-9406"></a>
<a name="ln-9407"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9408"></a>          <span class="c">!       AUTHOR         Bo Shen, based on HVACMultiSpeedHeatPump:CalcMSHeatPump</span>
<a name="ln-9409"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-9410"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9411"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-9412"></a>
<a name="ln-9413"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9414"></a>          <span class="c">! Simulate a multispeed heat pump; adjust its output to match the</span>
<a name="ln-9415"></a>          <span class="c">! required system load.</span>
<a name="ln-9416"></a>
<a name="ln-9417"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9418"></a>          <span class="c">! Calls ControlMSHPOutput to obtain the desired unit output</span>
<a name="ln-9419"></a>
<a name="ln-9420"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9421"></a>          <span class="c">! na</span>
<a name="ln-9422"></a>
<a name="ln-9423"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9424"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span>
<a name="ln-9425"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">SmallMassFlow</span><span class="p">,</span> <span class="n">SmallLoad</span>
<a name="ln-9426"></a>  <span class="k">USE </span><span class="n">DataZoneEquipment</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">ZoneEquipConfig</span>
<a name="ln-9427"></a>  <span class="k">USE </span><span class="n">DataAirLoop</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">AirLoopControlInfo</span><span class="p">,</span>  <span class="n">AirToZoneNodeInfo</span>
<a name="ln-9428"></a>  <span class="k">USE </span><span class="n">DataAirSystems</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">PrimaryAirSystem</span>
<a name="ln-9429"></a>  <span class="c">! USE DataConvergParams, ONLY: HVACFlowRateToler</span>
<a name="ln-9430"></a>
<a name="ln-9431"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9432"></a>
<a name="ln-9433"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9434"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! TRUE if 1st HVAC simulation of system timestep</span>
<a name="ln-9435"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>      <span class="c">! number of the current engine driven Heat Pump being simulated</span>
<a name="ln-9436"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! required zone load</span>
<a name="ln-9437"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLatReq</span>            <span class="c">! required latent load</span>
<a name="ln-9438"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-9439"></a>
<a name="ln-9440"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9441"></a>          <span class="c">! na</span>
<a name="ln-9442"></a>
<a name="ln-9443"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9444"></a>          <span class="c">! na</span>
<a name="ln-9445"></a>
<a name="ln-9446"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9447"></a>          <span class="c">! na</span>
<a name="ln-9448"></a>
<a name="ln-9449"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9450"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadFrac</span>      <span class="c">! compressor part load fraction</span>
<a name="ln-9451"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedRatio</span>        <span class="c">! compressor speed ratio</span>
<a name="ln-9452"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">UnitOn</span>            <span class="c">! TRUE if unit is on</span>
<a name="ln-9453"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNode</span>        <span class="c">! MSHP air outlet node</span>
<a name="ln-9454"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNode</span>         <span class="c">! MSHP air inlet node</span>
<a name="ln-9455"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirMassFlow</span>       <span class="c">! air mass flow rate [kg/s]</span>
<a name="ln-9456"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpMode</span>            <span class="c">! operating mode (fan cycling or continious; DX coil always cycles)</span>
<a name="ln-9457"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! Controlled zone number</span>
<a name="ln-9458"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QTotUnitOut</span>  <span class="c">! capacity output</span>
<a name="ln-9459"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNum</span>  <span class="o">=</span> <span class="mi">1</span>         <span class="c">! Speed number</span>
<a name="ln-9460"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span> <span class="c">! supplement heater load</span>
<a name="ln-9461"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompOp</span>            <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-9462"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">AirLoopNumber</span>     <span class="c">! Index to air loop</span>
<a name="ln-9463"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveMassFlowRate</span>  <span class="c">! saved inlet air mass flow rate [kg/s]</span>
<a name="ln-9464"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QSensUnitOut</span>    <span class="c">! sensible capacity output</span>
<a name="ln-9465"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLatUnitOut</span>     <span class="c">! latent capacity output</span>
<a name="ln-9466"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">TotalZoneLatentLoad</span>    <span class="c">! Total ZONE latent load</span>
<a name="ln-9467"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>        <span class="kd">::</span> <span class="n">TotalZoneSensibleLoad</span>    <span class="c">! Total ZONE sensible load</span>
<a name="ln-9468"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ActualSensibleOutput</span> <span class="c">! Actual furnace sensible capacity</span>
<a name="ln-9469"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ReheatCoilLoad</span> <span class="c">! reheat coil load due to dehumidification</span>
<a name="ln-9470"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">SAVE</span>   <span class="kd">::</span>  <span class="n">SystemSensibleLoad</span>   <span class="c">! Positive value means heating required</span>
<a name="ln-9471"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>         <span class="kd">::</span>  <span class="n">QToHeatSetPt</span>         <span class="c">! Load required to meet heating setpoint temp (&gt;0 is a heating load)</span>
<a name="ln-9472"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NoCompOutput</span>  <span class="c">! output when no active compressor [W]</span>
<a name="ln-9473"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span>  <span class="n">TotBranchNum</span> <span class="c">! total exit branch number</span>
<a name="ln-9474"></a>  <span class="kt">INTEGER</span>           <span class="kd">::</span>  <span class="n">ZoneSideNodeNum</span> <span class="c">! zone equip supply node</span>
<a name="ln-9475"></a>  <span class="kt">LOGICAL</span>           <span class="kd">::</span>  <span class="n">EconoActive</span>        <span class="c">! TRUE if Economizer is active</span>
<a name="ln-9476"></a>
<a name="ln-9477"></a>                                            <span class="c">! to be removed by furnace/unitary system</span>
<a name="ln-9478"></a>
<a name="ln-9479"></a>  <span class="c">! zero the fan, DX coils, and supplemental electric heater electricity consumption</span>
<a name="ln-9480"></a>  <span class="n">FanElecPower</span>         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9481"></a>  <span class="n">DXElecHeatingPower</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9482"></a>  <span class="n">DXElecCoolingPower</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9483"></a>  <span class="n">SaveCompressorPLR</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9484"></a>  <span class="n">ElecHeatingCoilPower</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9485"></a>
<a name="ln-9486"></a>  <span class="n">SystemSensibleLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9487"></a>  <span class="n">TotalZoneSensibleLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9488"></a>  <span class="n">TotalZoneLatentLoad</span> <span class="o">=</span> <span class="n">QLatReq</span>
<a name="ln-9489"></a>
<a name="ln-9490"></a>  <span class="c">! initialize local variables</span>
<a name="ln-9491"></a>  <span class="n">UnitOn</span>      <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-9492"></a>  <span class="n">OutletNode</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-9493"></a>  <span class="n">InletNode</span>   <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-9494"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMassFlowRate</span>
<a name="ln-9495"></a>  <span class="n">OpMode</span>      <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span>
<a name="ln-9496"></a>  <span class="n">ZoneNum</span>     <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span>
<a name="ln-9497"></a>  <span class="n">CompOp</span>      <span class="o">=</span> <span class="n">On</span>
<a name="ln-9498"></a>
<a name="ln-9499"></a>   <span class="c">!Set latent load for heating</span>
<a name="ln-9500"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9501"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-9502"></a> <span class="c">!Set latent load for cooling and no sensible load condition</span>
<a name="ln-9503"></a>  <span class="k">ELSE IF</span><span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9504"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-9505"></a>  <span class="k">ELSE</span>
<a name="ln-9506"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-9507"></a>  <span class="n">ENDIF</span>
<a name="ln-9508"></a>
<a name="ln-9509"></a>
<a name="ln-9510"></a>  <span class="c">! set the on/off flags</span>
<a name="ln-9511"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OPMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9512"></a>    <span class="c">! cycling unit only runs if there is a cooling or heating load.</span>
<a name="ln-9513"></a>     <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QZnReq</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">AirMassFlow</span> <span class="o">&lt;</span> <span class="n">SmallMassFlow</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9514"></a><span class="k">       </span><span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9515"></a>     <span class="k">END IF</span>
<a name="ln-9516"></a><span class="k">  ELSE IF</span>  <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OPMode</span> <span class="o">==</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9517"></a>    <span class="c">! continuous unit: fan runs if scheduled on; coil runs only if there is a cooling or heating load</span>
<a name="ln-9518"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AirMassFlow</span><span class="p">.</span><span class="n">LT</span><span class="p">.</span><span class="n">SmallMassFlow</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9519"></a><span class="k">      </span><span class="n">UnitOn</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9520"></a>    <span class="k">END IF</span>
<a name="ln-9521"></a><span class="k">  END IF</span>
<a name="ln-9522"></a>
<a name="ln-9523"></a><span class="k">  </span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9524"></a>
<a name="ln-9525"></a>  <span class="n">AirLoopNumber</span> <span class="o">=</span> <span class="n">ZoneEquipConfig</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">AirLoopNum</span>
<a name="ln-9526"></a>
<a name="ln-9527"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">AirLoopNumber</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9528"></a><span class="k">    </span><span class="n">EconoActive</span> <span class="o">=</span> <span class="n">AirLoopControlInfo</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">EconoActive</span>
<a name="ln-9529"></a>  <span class="k">ELSE</span>
<a name="ln-9530"></a><span class="k">    </span><span class="n">EconoActive</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-9531"></a>  <span class="k">END IF</span>
<a name="ln-9532"></a>
<a name="ln-9533"></a><span class="k">  </span><span class="n">SaveMassFlowRate</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9534"></a>  <span class="k">IF</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OPMode</span> <span class="o">==</span> <span class="n">CycFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9535"></a>        <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">TotalZoneLatentLoad</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span>  <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9536"></a>       <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">EconoActive</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9537"></a>       <span class="c">! for cycling fan, cooling load, check whether furnace can meet load with compressor off</span>
<a name="ln-9538"></a>    <span class="n">CompOp</span> <span class="o">=</span> <span class="n">Off</span>
<a name="ln-9539"></a>    <span class="k">CALL </span><span class="n">ControlVSHPOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">TotalZoneSensibleLoad</span><span class="p">,</span> <span class="n">TotalZoneLatentLoad</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9540"></a>       <span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9541"></a>
<a name="ln-9542"></a>     <span class="n">TotalZoneSensibleLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9543"></a>     <span class="n">TotalZoneLatentLoad</span> <span class="o">=</span> <span class="n">QLatReq</span>
<a name="ln-9544"></a>
<a name="ln-9545"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SpeedRatio</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9546"></a>      <span class="c">! compressor on (reset inlet air mass flow rate to starting value)</span>
<a name="ln-9547"></a>      <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">SaveMassFlowRate</span>
<a name="ln-9548"></a>      <span class="n">CompOp</span> <span class="o">=</span> <span class="n">On</span>
<a name="ln-9549"></a>      <span class="k">CALL </span><span class="n">ControlVSHPOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">TotalZoneSensibleLoad</span><span class="p">,</span><span class="n">TotalZoneLatentLoad</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9550"></a>         <span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9551"></a>    <span class="k">END IF</span>
<a name="ln-9552"></a><span class="k">  ELSE</span>
<a name="ln-9553"></a>     <span class="c">! compressor on</span>
<a name="ln-9554"></a>     <span class="n">CompOp</span>      <span class="o">=</span> <span class="n">On</span>
<a name="ln-9555"></a>
<a name="ln-9556"></a><span class="c">!     if(QZnReq &lt; -1000.0 .AND. FurnaceNum == 1 ) then</span>
<a name="ln-9557"></a><span class="c">!       CompOp      = On</span>
<a name="ln-9558"></a><span class="c">!     end if</span>
<a name="ln-9559"></a>     <span class="k">CALL </span><span class="n">ControlVSHPOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">TotalZoneSensibleLoad</span><span class="p">,</span><span class="n">TotalZoneLatentLoad</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9560"></a>        <span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9561"></a>  <span class="k">END IF</span>
<a name="ln-9562"></a>
<a name="ln-9563"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9564"></a><span class="k">    </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-9565"></a>  <span class="k">ELSE</span>
<a name="ln-9566"></a><span class="k">     IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>  <span class="k">THEN</span>
<a name="ln-9567"></a><span class="k">       </span><span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9568"></a>     <span class="k">END IF</span>
<a name="ln-9569"></a>
<a name="ln-9570"></a><span class="k">     IF</span> <span class="p">(</span><span class="n">PartLoadFrac</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mf">1.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">SaveCompressorPLR</span> <span class="o">&lt;</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-9571"></a><span class="k">       </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="n">SaveCompressorPLR</span>
<a name="ln-9572"></a>     <span class="k">End IF</span>
<a name="ln-9573"></a><span class="k">  END IF</span>
<a name="ln-9574"></a>
<a name="ln-9575"></a><span class="k">  </span><span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9576"></a>  <span class="n">TotalZoneSensibleLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9577"></a>  <span class="n">TotalZoneLatentLoad</span> <span class="o">=</span> <span class="n">QLatReq</span>
<a name="ln-9578"></a>  <span class="c">!     Calculate the reheat coil output</span>
<a name="ln-9579"></a>  <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9580"></a>       <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9581"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9582"></a>       <span class="p">(</span><span class="n">QLatReq</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)))</span> <span class="k">THEN</span> <span class="c">! if a Humidistat is installed and dehumdification control type is CoolReheat</span>
<a name="ln-9583"></a>    <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">ActualSensibleOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9584"></a>                    <span class="n">QLatUnitOut</span><span class="p">,</span> <span class="n">TotalZoneSensibleLoad</span><span class="p">,</span><span class="n">TotalZoneLatentLoad</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">ReheatCoilLoad</span><span class="p">)</span>
<a name="ln-9585"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9586"></a><span class="k">      </span><span class="n">QToHeatSetPt</span><span class="o">=</span><span class="p">(</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span> <span class="p">&amp;</span>
<a name="ln-9587"></a>                     <span class="n">SequencedOutputRequiredToHeatingSP</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ZoneSequenceHeatingNum</span><span class="p">)</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-9588"></a>                     <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span>
<a name="ln-9589"></a>    <span class="k">ELSE</span>
<a name="ln-9590"></a><span class="k">      </span><span class="n">QToHeatSetPt</span><span class="o">=</span><span class="p">(</span><span class="n">ZoneSysEnergyDemand</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)%</span><span class="n">OutputRequiredToHeatingSP</span> <span class="o">/</span> <span class="p">&amp;</span>
<a name="ln-9591"></a>                  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneMassFlowFrac</span><span class="p">)</span>
<a name="ln-9592"></a>    <span class="n">ENDIF</span>
<a name="ln-9593"></a><span class="c">!       Cooling mode or floating condition and dehumidification is required</span>
<a name="ln-9594"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9595"></a><span class="c">!         Calculate the reheat coil load wrt the heating setpoint temperature. Reheat coil picks up</span>
<a name="ln-9596"></a><span class="c">!         the entire excess sensible cooling (DX cooling coil and impact of outdoor air).</span>
<a name="ln-9597"></a>      <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,(</span><span class="n">QToHeatSetPt</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">))</span>
<a name="ln-9598"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="n">ReheatCoilLoad</span>
<a name="ln-9599"></a><span class="c">!       Heating mode and dehumidification is required</span>
<a name="ln-9600"></a>    <span class="n">ELSEIF</span><span class="p">(</span><span class="n">QToHeatSetPt</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9601"></a><span class="k">      </span><span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="n">QToHeatSetPt</span><span class="p">,</span><span class="n">QToHeatSetPt</span><span class="o">-</span><span class="n">ActualSensibleOutput</span><span class="p">)</span>
<a name="ln-9602"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ActualSensibleOutput</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0d0</span><span class="p">))</span>
<a name="ln-9603"></a>    <span class="k">ELSE</span>
<a name="ln-9604"></a><span class="k">      </span><span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9605"></a>    <span class="k">END IF</span>
<a name="ln-9606"></a>
<a name="ln-9607"></a><span class="k">   </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9608"></a>   <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">NoCompOutput</span><span class="p">,</span> <span class="n">QLatUnitOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9609"></a>                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9610"></a>
<a name="ln-9611"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">NoCompOutput</span> <span class="o">&gt;</span> <span class="n">SystemSensibleLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">SystemSensibleLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">ReHeatCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9612"></a>     <span class="c">!Reduce reheat coil load if you are controlling high humidity but outside air</span>
<a name="ln-9613"></a><span class="c">! and/or the supply air fan is providing enough heat to meet the system sensible load.</span>
<a name="ln-9614"></a><span class="c">! This will bring the zone temp closer to the heating setpoint temp.</span>
<a name="ln-9615"></a>      <span class="n">ReHeatCoilLoad</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">ReHeatCoilLoad</span><span class="o">-</span><span class="p">(</span><span class="n">NoCompOutput</span><span class="o">-</span><span class="n">SystemSensibleLoad</span><span class="p">))</span>
<a name="ln-9616"></a>    <span class="k">END IF</span>
<a name="ln-9617"></a><span class="k">  ELSE</span>
<a name="ln-9618"></a><span class="c">!       No humidistat installed</span>
<a name="ln-9619"></a>    <span class="n">ReheatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9620"></a>  <span class="k">END IF</span>
<a name="ln-9621"></a>
<a name="ln-9622"></a><span class="k">  </span><span class="n">TotalZoneSensibleLoad</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9623"></a>  <span class="n">TotalZoneLatentLoad</span> <span class="o">=</span> <span class="n">QLatReq</span>
<a name="ln-9624"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">ReHeatCoilLoad</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9625"></a><span class="k">     CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">QSensUnitOut</span><span class="p">,</span> <span class="n">QLatUnitOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9626"></a>                <span class="n">TotalZoneSensibleLoad</span><span class="p">,</span><span class="n">TotalZoneLatentLoad</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">ReHeatCoilLoad</span><span class="p">)</span>
<a name="ln-9627"></a>  <span class="k">ELSE</span>
<a name="ln-9628"></a><span class="k">     CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">QSensUnitOut</span><span class="p">,</span> <span class="n">QLatUnitOut</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9629"></a>                      <span class="n">TotalZoneSensibleLoad</span><span class="p">,</span><span class="n">TotalZoneLatentLoad</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9630"></a>  <span class="k">END IF</span>
<a name="ln-9631"></a>
<a name="ln-9632"></a>
<a name="ln-9633"></a>  <span class="c">! calculate delivered capacity</span>
<a name="ln-9634"></a>  <span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-9635"></a>
<a name="ln-9636"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MdotFurnace</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-9637"></a>
<a name="ln-9638"></a>  <span class="n">QTotUnitOut</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Enthalpy</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Enthalpy</span><span class="p">)</span>
<a name="ln-9639"></a>
<a name="ln-9640"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-9641"></a>  <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-9642"></a>
<a name="ln-9643"></a>  <span class="k">If</span><span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">FirstHVACIteration</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirMassFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">AirLoopNumber</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9644"></a><span class="k">      </span><span class="n">TotBranchNum</span> <span class="o">=</span> <span class="n">PrimaryAirSystem</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">NumOutletBranches</span>
<a name="ln-9645"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">TotBranchNum</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9646"></a><span class="k">         </span><span class="n">ZoneSideNodeNum</span> <span class="o">=</span> <span class="n">AirToZoneNodeInfo</span><span class="p">(</span><span class="n">AirLoopNumber</span><span class="p">)%</span><span class="n">ZoneEquipSupplyNodeNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-9647"></a><span class="c">! THE MASS FLOW PRECISION of the system solver is not enough for some small air flow rate iterations , BY DEBUGGING</span>
<a name="ln-9648"></a><span class="c">! it may cause mass flow rate occilations between airloop and zoneequip</span>
<a name="ln-9649"></a><span class="c">! specify the air flow rate directly for one-to-one system, when the iteration deviation is closing the solver precision level</span>
<a name="ln-9650"></a>         <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">AirMassFlow</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">ZoneSideNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.02d0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9651"></a>         <span class="c">! 0.02 is 2 * HVACFlowRateToler, in order to accomodate the system solver precision level</span>
<a name="ln-9652"></a>           <span class="n">Node</span><span class="p">(</span><span class="n">ZoneSideNodeNum</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-9653"></a>           <span class="n">Node</span><span class="p">(</span><span class="n">ZoneSideNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">AirMassFlow</span>
<a name="ln-9654"></a>      <span class="k">END IF</span>
<a name="ln-9655"></a>
<a name="ln-9656"></a>     <span class="c">! the below might be useful if more divergences occur</span>
<a name="ln-9657"></a>     <span class="c">! Node(PrimaryAirSystem(AirLoopNumber)%Branch(1)%NodeNumIn)%MassFlowRateMaxAvail = AirMassFlow</span>
<a name="ln-9658"></a>     <span class="c">! Node(PrimaryAirSystem(AirLoopNumber)%Branch(1)%NodeNumIn)%MassFlowRate = AirMassFlow</span>
<a name="ln-9659"></a>  <span class="k">END IF</span>
<a name="ln-9660"></a>
<a name="ln-9661"></a>  <span class="c">! report variables</span>
<a name="ln-9662"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidInducedHeatingDemandRate</span> <span class="o">=</span> <span class="n">ReheatCoilLoad</span>
<a name="ln-9663"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!HEATING LOAD</span>
<a name="ln-9664"></a>     <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9665"></a>     <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9666"></a>  <span class="k">ELSE</span>
<a name="ln-9667"></a><span class="k">     </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilSensDemand</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">QZnReq</span><span class="p">)</span>
<a name="ln-9668"></a>     <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilSensDemand</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9669"></a>  <span class="k">END IF</span>
<a name="ln-9670"></a>
<a name="ln-9671"></a><span class="k">  </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">SaveCompressorPLR</span>
<a name="ln-9672"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">CycFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9673"></a><span class="k">    If</span> <span class="p">(</span><span class="n">SupHeaterLoad</span> <span class="o">&gt;</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9674"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9675"></a>    <span class="k">Else</span>
<a name="ln-9676"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9677"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-9678"></a>      <span class="k">Else</span>
<a name="ln-9679"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9680"></a>      <span class="k">End If</span>
<a name="ln-9681"></a><span class="k">    End If</span>
<a name="ln-9682"></a><span class="k">  ELSE</span>
<a name="ln-9683"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">UnitOn</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9684"></a><span class="k">      </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9685"></a>    <span class="k">ELSE</span>
<a name="ln-9686"></a><span class="k">      If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9687"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-9688"></a>      <span class="k">Else</span>
<a name="ln-9689"></a><span class="k">        </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9690"></a>      <span class="k">End If</span>
<a name="ln-9691"></a><span class="k">    END IF</span>
<a name="ln-9692"></a><span class="k">  END IF</span>
<a name="ln-9693"></a>
<a name="ln-9694"></a>
<a name="ln-9695"></a><span class="k">  RETURN</span>
<a name="ln-9696"></a><span class="k">END SUBROUTINE </span><span class="n">SimVariableSpeedHP</span>
<a name="ln-9697"></a><span class="c">!******************************************************************************</span>
<a name="ln-9698"></a>
<a name="ln-9699"></a><span class="k">SUBROUTINE </span><span class="n">ControlVSHPOutput</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span><span class="n">QLatReq</span><span class="p">,</span><span class="n">ZoneNum</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9700"></a>                             <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9701"></a>
<a name="ln-9702"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-9703"></a>          <span class="c">!       AUTHOR         Bo Shen, based on HVACMultiSpeedHeatPump:ControlMSHPOutput</span>
<a name="ln-9704"></a>          <span class="c">!       DATE WRITTEN   March,  2012</span>
<a name="ln-9705"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-9706"></a>          <span class="c">!       RE-ENGINEERED</span>
<a name="ln-9707"></a>
<a name="ln-9708"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-9709"></a>          <span class="c">! Determine the part load fraction at low speed, and speed ratio at high speed for this time step.</span>
<a name="ln-9710"></a>
<a name="ln-9711"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-9712"></a>          <span class="c">! Use RegulaFalsi technique to iterate on part-load ratio until convergence is achieved.</span>
<a name="ln-9713"></a>
<a name="ln-9714"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-9715"></a>          <span class="c">! na</span>
<a name="ln-9716"></a>
<a name="ln-9717"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-9718"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SolveRegulaFalsi</span><span class="p">,</span> <span class="n">RoundSigDigits</span><span class="p">,</span> <span class="n">TrimSigDigits</span>
<a name="ln-9719"></a>  <span class="k">USE </span><span class="n">DataGlobals</span><span class="p">,</span>               <span class="n">ONLY</span><span class="p">:</span> <span class="n">WarmUpFlag</span><span class="p">,</span><span class="n">CurrentTime</span>
<a name="ln-9720"></a>  <span class="k">USE </span><span class="n">HeatingCoils</span><span class="p">,</span>              <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateHeatingCoilComponents</span>
<a name="ln-9721"></a>  <span class="k">USE </span><span class="n">Psychrometrics</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">PsyCpAirFnWTdb</span>
<a name="ln-9722"></a>  <span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-9723"></a>
<a name="ln-9724"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-9725"></a>
<a name="ln-9726"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-9727"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FurnaceNum</span>         <span class="c">! Unit index of engine driven heat pump</span>
<a name="ln-9728"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! flag for 1st HVAC iteration in the time step</span>
<a name="ln-9729"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-9730"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! operating mode: CycFanCycCoil | ContFanCycCoil</span>
<a name="ln-9731"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedNum</span>           <span class="c">! Speed number</span>
<a name="ln-9732"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QZnReq</span>        <span class="c">! cooling or heating output needed by zone [W]</span>
<a name="ln-9733"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">QLatReq</span>       <span class="c">! latent cooling output needed by zone [W]</span>
<a name="ln-9734"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">IN</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Index to zone number</span>
<a name="ln-9735"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>         <span class="c">! unit speed ratio for DX coils</span>
<a name="ln-9736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span>   <span class="p">(</span><span class="n">OUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">PartLoadFrac</span>       <span class="c">! unit part load fraction</span>
<a name="ln-9737"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-9738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHeaterLoad</span>      <span class="c">! Supplemental heater load [W]</span>
<a name="ln-9739"></a>
<a name="ln-9740"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-9741"></a>          <span class="c">!</span>
<a name="ln-9742"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span> <span class="kd">::</span> <span class="n">MaxIte</span>   <span class="o">=</span> <span class="mi">500</span>          <span class="c">! maximum number of iterations</span>
<a name="ln-9743"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">PARAMETER</span>    <span class="kd">::</span> <span class="n">MinPLF</span>   <span class="o">=</span> <span class="mf">0.0d0</span>          <span class="c">! minimum part load factor allowed</span>
<a name="ln-9744"></a>
<a name="ln-9745"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-9746"></a>          <span class="c">! na</span>
<a name="ln-9747"></a>
<a name="ln-9748"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-9749"></a>          <span class="c">! na</span>
<a name="ln-9750"></a>
<a name="ln-9751"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-9752"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">FullOutput</span>    <span class="c">! unit full output when compressor is operating [W]</span>
<a name="ln-9753"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LowOutput</span>     <span class="c">! unit full output at low speed [W]</span>
<a name="ln-9754"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">TempOutput</span>    <span class="c">! unit output when iteration limit exceeded [W]</span>
<a name="ln-9755"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">NoCompOutput</span>  <span class="c">! output when no active compressor [W]</span>
<a name="ln-9756"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">LatOutput</span>     <span class="c">! latent capacity output</span>
<a name="ln-9757"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">ErrorToler</span>    <span class="c">! error tolerance</span>
<a name="ln-9758"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">SolFla</span>        <span class="c">! Flag of RegulaFalsi solver</span>
<a name="ln-9759"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">Par</span>           <span class="c">! Parameters passed to RegulaFalsi</span>
<a name="ln-9760"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">CpAir</span>         <span class="c">! air specific heat</span>
<a name="ln-9761"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">QCoilActual</span>   <span class="c">! coil load actually delivered returned to calling component</span>
<a name="ln-9762"></a>  <span class="kt">INTEGER</span>            <span class="kd">::</span> <span class="n">i</span>             <span class="c">! Speed index</span>
<a name="ln-9763"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">ErrCountCyc</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-9764"></a>  <span class="kt">INTEGER</span><span class="p">,</span><span class="k">SAVE</span>       <span class="kd">::</span> <span class="n">ErrCountVar</span><span class="o">=</span><span class="mi">0</span> <span class="c">! Counter used to minimize the occurrence of output warnings</span>
<a name="ln-9765"></a>
<a name="ln-9766"></a>  <span class="c">! FLOW</span>
<a name="ln-9767"></a>  <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9768"></a>  <span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9769"></a>  <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9770"></a>  <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9771"></a>  <span class="n">LatOutput</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9772"></a>  <span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-9773"></a>
<a name="ln-9774"></a>  <span class="c">!dehumidification load has the priority</span>
<a name="ln-9775"></a> <span class="k">IF</span><span class="p">((</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">CoolingLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9776"></a>       <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9777"></a>        <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DehumidControlType_Num</span> <span class="o">==</span> <span class="n">DehumidControl_CoolReheat</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9778"></a>       <span class="p">(</span><span class="n">QLatReq</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="mf">0.0d0</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-9779"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9780"></a>  <span class="k">ELSE</span>
<a name="ln-9781"></a><span class="k">    </span><span class="n">QLatReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9782"></a>  <span class="k">END IF</span>
<a name="ln-9783"></a>
<a name="ln-9784"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-9785"></a>
<a name="ln-9786"></a>  <span class="c">! Get result when DX coil is off</span>
<a name="ln-9787"></a>  <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9788"></a>  <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">NoCompOutput</span><span class="p">,</span> <span class="n">LatOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9789"></a>                          <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9790"></a>
<a name="ln-9791"></a>  <span class="c">! If cooling and NoCompOutput &lt; QZnReq, the coil needs to be off</span>
<a name="ln-9792"></a>  <span class="c">! If heating and NoCompOutput &gt; QZnReq, the coil needs to be off</span>
<a name="ln-9793"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NoCompOutput</span> <span class="o">&lt;</span> <span class="n">QZnReq</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">NoCompOutput</span> <span class="o">&gt;</span> <span class="n">QZnReq</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9794"></a>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QZnReq</span><span class="p">)</span> <span class="o">&lt;=</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">QLatReq</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9795"></a>    <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">LatOutput</span> <span class="o">&lt;</span> <span class="n">QLatReq</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9796"></a><span class="k">    RETURN</span>
<a name="ln-9797"></a><span class="k">  END IF</span>
<a name="ln-9798"></a>
<a name="ln-9799"></a>  <span class="c">! Get full load result</span>
<a name="ln-9800"></a>  <span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9801"></a>  <span class="n">SpeedRatio</span>    <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9802"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9803"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9804"></a><span class="k">        </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-9805"></a>    <span class="k">ELSE</span>
<a name="ln-9806"></a><span class="k">        </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-9807"></a>    <span class="k">END IF</span>
<a name="ln-9808"></a><span class="k">  Else If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9809"></a><span class="k">    </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-9810"></a>  <span class="k">ELSE</span>
<a name="ln-9811"></a><span class="k">    </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9812"></a>    <span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9813"></a>  <span class="k">End If</span>
<a name="ln-9814"></a>
<a name="ln-9815"></a><span class="k">  CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">FullOutput</span><span class="p">,</span> <span class="n">LatOutput</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-9816"></a>                          <span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9817"></a>
<a name="ln-9818"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!dehumidification mode</span>
<a name="ln-9819"></a>  <span class="c">!  ! If the QLatReq &lt;= LatOutput the unit needs to run full out</span>
<a name="ln-9820"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;=</span> <span class="n">LatOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9821"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9822"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9823"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-9824"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-9825"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-9826"></a>      <span class="k">RETURN</span>
<a name="ln-9827"></a><span class="k">    END IF</span>
<a name="ln-9828"></a><span class="k">    </span><span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-9829"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9830"></a>  <span class="c">! Since we are cooling, we expect FullOutput to be &lt; 0 and FullOutput &lt; NoCompOutput</span>
<a name="ln-9831"></a>  <span class="c">! Check that this is the case; if not set PartLoadFrac = 0.0 (off) and return</span>
<a name="ln-9832"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullOutput</span> <span class="o">&gt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FullOutput</span> <span class="o">&gt;=</span> <span class="n">NoCompOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9833"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9834"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9835"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9836"></a>      <span class="k">RETURN</span>
<a name="ln-9837"></a><span class="k">    END IF</span>
<a name="ln-9838"></a><span class="c">!  ! If the QZnReq &lt;= FullOutput the unit needs to run full out</span>
<a name="ln-9839"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9840"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9841"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9842"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-9843"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-9844"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-9845"></a>      <span class="k">RETURN</span>
<a name="ln-9846"></a><span class="k">    END IF</span>
<a name="ln-9847"></a><span class="k">    </span><span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-9848"></a>  <span class="k">ELSE</span>
<a name="ln-9849"></a>  <span class="c">! Since we are heating, we expect FullOutput to be &gt; 0 and FullOutput &gt; NoCompOutput</span>
<a name="ln-9850"></a>  <span class="c">! Check that this is the case; if not set PartLoadFrac = 0.0 (off)</span>
<a name="ln-9851"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FullOutput</span> <span class="o">&lt;=</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">FullOutput</span> <span class="o">&lt;=</span> <span class="n">NoCompOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9852"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9853"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9854"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9855"></a>  <span class="c">! may need supplemental heating so don&#39;t return in heating mode</span>
<a name="ln-9856"></a>    <span class="k">END IF</span>
<a name="ln-9857"></a><span class="k">    IF</span> <span class="p">(</span><span class="n">QZnReq</span>  <span class="o">&gt;=</span>  <span class="n">FullOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9858"></a><span class="k">      </span><span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9859"></a>      <span class="n">SpeedRatio</span>   <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9860"></a>  <span class="c">! may need supplemental heating so don&#39;t return in heating mode</span>
<a name="ln-9861"></a>    <span class="k">END IF</span>
<a name="ln-9862"></a><span class="k">    </span><span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span> <span class="c">!Error tolerance for convergence from input deck</span>
<a name="ln-9863"></a>  <span class="k">END IF</span>
<a name="ln-9864"></a>
<a name="ln-9865"></a><span class="k">  IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9866"></a>     <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9867"></a>
<a name="ln-9868"></a><span class="k">    </span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">FurnaceNum</span>
<a name="ln-9869"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ZoneNum</span>
<a name="ln-9870"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9871"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9872"></a>    <span class="k">ELSE</span>
<a name="ln-9873"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9874"></a>    <span class="k">END IF</span>
<a name="ln-9875"></a><span class="k">    </span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">OpMode</span>
<a name="ln-9876"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">QZnReq</span>
<a name="ln-9877"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">OnOffAirFlowRatio</span>
<a name="ln-9878"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">SupHeaterLoad</span>
<a name="ln-9879"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">CompOp</span>
<a name="ln-9880"></a>    <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9881"></a>    <span class="c">! Check whether the low speed coil can meet the load or not</span>
<a name="ln-9882"></a>    <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span><span class="n">LowOutput</span><span class="p">,</span> <span class="n">LatOutput</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9883"></a>                        <span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9884"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">LowOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">LowOutput</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9885"></a>              <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QLatReq</span> <span class="o">&gt;</span> <span class="n">LatOutput</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9886"></a>        <span class="c">! Calculate the part load fraction</span>
<a name="ln-9887"></a>      <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9888"></a>      <span class="n">SpeedNum</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-9889"></a>
<a name="ln-9890"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!calculate latent heat residual</span>
<a name="ln-9891"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9892"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">QLatReq</span>
<a name="ln-9893"></a>      <span class="k">END IF</span>
<a name="ln-9894"></a>
<a name="ln-9895"></a><span class="k">      CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrorToler</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">VSHPCyclingResidual</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-9896"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9897"></a><span class="k">        If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9898"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrCountCyc</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9899"></a><span class="k">            </span><span class="n">ErrCountCyc</span> <span class="o">=</span> <span class="n">ErrCountCyc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9900"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating VS WSHP unit cycling ratio, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9901"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9902"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Cycling ratio returned=&#39;</span><span class="o">//</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-9903"></a>          <span class="k">Else</span>
<a name="ln-9904"></a><span class="k">            </span><span class="n">ErrCountCyc</span> <span class="o">=</span> <span class="n">ErrCountCyc</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9905"></a>            <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9906"></a>          <span class="s1">&#39; Iteration limit warning exceeding calculating DX unit cycling ratio  continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9907"></a>          <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ErrIndexCyc</span> <span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">)</span>
<a name="ln-9908"></a>          <span class="k">End If</span>
<a name="ln-9909"></a><span class="k">        End If</span>
<a name="ln-9910"></a><span class="k">      ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9911"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;VS WSHP unit cycling ratio calculation failed: cycling limits exceeded, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9912"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9913"></a>      <span class="k">END IF</span>
<a name="ln-9914"></a><span class="k">    Else</span>
<a name="ln-9915"></a>      <span class="c">! Check to see which speed to meet the load</span>
<a name="ln-9916"></a>      <span class="n">PartLoadFrac</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9917"></a>      <span class="n">SpeedRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9918"></a>      <span class="k">If</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)))</span> <span class="k">Then</span> <span class="c">! Cooling</span>
<a name="ln-9919"></a>        <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span>
<a name="ln-9920"></a>          <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">TempOutput</span><span class="p">,</span> <span class="n">LatOutput</span><span class="p">,&amp;</span>
<a name="ln-9921"></a>                              <span class="n">QZnReq</span><span class="p">,</span><span class="n">QLatReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9922"></a>
<a name="ln-9923"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-9924"></a><span class="k">            IF</span><span class="p">(</span><span class="n">QLatReq</span> <span class="o">&gt;</span> <span class="n">LatOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9925"></a><span class="k">             </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-9926"></a>             <span class="k">Exit</span>
<a name="ln-9927"></a><span class="k">            END IF</span>
<a name="ln-9928"></a><span class="k">          ELSE IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&gt;=</span> <span class="n">TempOutput</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9929"></a><span class="k">            </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-9930"></a>            <span class="k">Exit</span>
<a name="ln-9931"></a><span class="k">          END IF</span>
<a name="ln-9932"></a><span class="k">        END DO</span>
<a name="ln-9933"></a><span class="k">      ELSE</span>
<a name="ln-9934"></a><span class="k">        DO </span><span class="n">I</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span>
<a name="ln-9935"></a>          <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">TempOutput</span><span class="p">,</span> <span class="n">LatOutput</span><span class="p">,&amp;</span>
<a name="ln-9936"></a>               <span class="n">QZnReq</span><span class="p">,</span><span class="n">QLatReq</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9937"></a>          <span class="k">If</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="o">&lt;=</span> <span class="n">TempOutput</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9938"></a><span class="k">            </span><span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-9939"></a>            <span class="k">Exit</span>
<a name="ln-9940"></a><span class="k">          End If</span>
<a name="ln-9941"></a><span class="k">        END DO</span>
<a name="ln-9942"></a><span class="k">      END IF</span>
<a name="ln-9943"></a><span class="k">      </span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-9944"></a>
<a name="ln-9945"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)</span> <span class="p">)</span> <span class="k">THEN</span> <span class="c">!calculate latent heat residual</span>
<a name="ln-9946"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9947"></a>        <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">QLatReq</span>
<a name="ln-9948"></a>      <span class="k">END IF</span>
<a name="ln-9949"></a>
<a name="ln-9950"></a><span class="k">      CALL </span><span class="n">SolveRegulaFalsi</span><span class="p">(</span><span class="n">ErrorToler</span><span class="p">,</span> <span class="n">MaxIte</span><span class="p">,</span> <span class="n">SolFla</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">VSHPSpeedResidual</span><span class="p">,</span> <span class="mf">1.0d-10</span><span class="p">,</span> <span class="mf">1.0d0</span><span class="p">,</span> <span class="n">Par</span><span class="p">)</span>
<a name="ln-9951"></a>      <span class="k">IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9952"></a><span class="k">        If</span> <span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">WarmupFlag</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-9953"></a><span class="k">          IF</span> <span class="p">(</span><span class="n">ErrCountVar</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9954"></a><span class="k">            </span><span class="n">ErrCountVar</span> <span class="o">=</span> <span class="n">ErrCountVar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9955"></a>            <span class="k">CALL </span><span class="n">ShowWarningError</span><span class="p">(</span><span class="s1">&#39;Iteration limit exceeded calculating VS WSHP unit speed ratio, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9956"></a>                            <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9957"></a>            <span class="k">CALL </span><span class="n">ShowContinueErrorTimeStamp</span><span class="p">(</span><span class="s1">&#39;Speed ratio returned=[&#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">//</span><span class="s1">&#39;], Speed number =&#39;</span> <span class="p">&amp;</span>
<a name="ln-9958"></a>                                        <span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">RoundSigDigits</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<a name="ln-9959"></a>          <span class="k">Else</span>
<a name="ln-9960"></a><span class="k">            </span><span class="n">ErrCountVar</span> <span class="o">=</span> <span class="n">ErrCountVar</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-9961"></a>            <span class="k">CALL </span><span class="n">ShowRecurringWarningErrorAtEnd</span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39;&quot;:&#39;</span><span class="o">//</span><span class="p">&amp;</span>
<a name="ln-9962"></a>          <span class="s1">&#39; Iteration limit warning exceeding calculating DX unit speed ratio continues...&#39;</span> <span class="p">&amp;</span>
<a name="ln-9963"></a>          <span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ErrIndexVar</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-9964"></a>          <span class="k">End If</span>
<a name="ln-9965"></a><span class="k">        End If</span>
<a name="ln-9966"></a><span class="k">      ELSE IF</span> <span class="p">(</span><span class="n">SolFla</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9967"></a><span class="k">        CALL </span><span class="n">ShowFatalError</span><span class="p">(</span><span class="s1">&#39;VS WSHP unit compressor speed calculation failed: speed limits exceeded, for unit=&#39;</span><span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-9968"></a>                           <span class="nb">TRIM</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Name</span><span class="p">))</span>
<a name="ln-9969"></a>      <span class="k">END IF</span>
<a name="ln-9970"></a><span class="k">    End If</span>
<a name="ln-9971"></a><span class="k">  End If</span>
<a name="ln-9972"></a>
<a name="ln-9973"></a>  <span class="c">! if the heating coil cannot meet the load, trim with supplemental heater</span>
<a name="ln-9974"></a>  <span class="c">! occurs with constant fan mode when compressor is on or off</span>
<a name="ln-9975"></a>  <span class="c">! occurs with cycling fan mode when compressor PLR is equal to 1</span>
<a name="ln-9976"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">FullOutput</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-9977"></a><span class="k">    </span><span class="n">PartLoadFrac</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9978"></a>    <span class="n">SpeedRatio</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-9979"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-9980"></a>            <span class="n">SpeedNum</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedHeating</span> <span class="c">!maximum heating speed, avoid zero for cooling only mode</span>
<a name="ln-9981"></a>
<a name="ln-9982"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxOATSuppHeat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-9983"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="n">QZnReq</span> <span class="o">-</span> <span class="n">FullOutput</span>
<a name="ln-9984"></a>    <span class="k">ELSE</span>
<a name="ln-9985"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-9986"></a>    <span class="k">END IF</span>
<a name="ln-9987"></a><span class="k">    CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">TempOutput</span><span class="p">,</span> <span class="n">LatOutput</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-9988"></a>                        <span class="n">QLatReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-9989"></a>  <span class="k">END IF</span>
<a name="ln-9990"></a>
<a name="ln-9991"></a><span class="c">! check the outlet of the supplemental heater to be lower than the maximum supplemental heater supply air temperature</span>
<a name="ln-9992"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-9993"></a>                                                             <span class="n">SupHeaterLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-9994"></a>
<a name="ln-9995"></a><span class="c">!   If the supply air temperature is to high, turn off the supplemental heater to recalculate the outlet temperature</span>
<a name="ln-9996"></a>    <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,.</span><span class="n">TRUE</span><span class="p">.,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-9997"></a><span class="c">!   If the outlet temperature is below the maximum supplemental heater supply air temperature, reduce the load passed to</span>
<a name="ln-9998"></a><span class="c">!   the supplemental heater, otherwise leave the supplemental heater off. If the supplemental heater is to be turned on,</span>
<a name="ln-9999"></a><span class="c">!   use the outlet conditions when the supplemental heater was off (CALL above) as the inlet conditions for the calculation</span>
<a name="ln-10000"></a><span class="c">!   of supplemental heater load to just meet the maximum supply air temperature from the supplemental heater.</span>
<a name="ln-10001"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10002"></a><span class="k">      </span><span class="n">CpAir</span> <span class="o">=</span> <span class="n">PsyCpAirFnWTdb</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10003"></a>                             <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-10004"></a>      <span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">*</span> <span class="n">CpAir</span> <span class="o">*</span> <span class="p">&amp;</span>
<a name="ln-10005"></a>                      <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignMaxOutletTemp</span> <span class="o">-</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span><span class="p">)%</span><span class="n">Temp</span><span class="p">)</span>
<a name="ln-10006"></a>
<a name="ln-10007"></a>    <span class="k">ELSE</span>
<a name="ln-10008"></a><span class="k">      </span><span class="n">SupHeaterLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10009"></a>    <span class="k">END IF</span>
<a name="ln-10010"></a><span class="k">  END IF</span>
<a name="ln-10011"></a>
<a name="ln-10012"></a><span class="c">!prepare module level output</span>
<a name="ln-10013"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10014"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10015"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CompSpeedNum</span> <span class="o">=</span> <span class="n">SpeedNum</span>
<a name="ln-10016"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilLatentDemand</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">QLatReq</span><span class="p">)</span>
<a name="ln-10017"></a>
<a name="ln-10018"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10019"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10020"></a>  <span class="k">ELSE</span>
<a name="ln-10021"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPartLoadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10022"></a>  <span class="k">END IF</span>
<a name="ln-10023"></a>
<a name="ln-10024"></a><span class="k">  RETURN</span>
<a name="ln-10025"></a><span class="k">END SUBROUTINE </span><span class="n">ControlVSHPOutput</span>
<a name="ln-10026"></a>
<a name="ln-10027"></a><span class="c">!******************************************************************************</span>
<a name="ln-10028"></a>
<a name="ln-10029"></a><span class="k">SUBROUTINE </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10030"></a>                          <span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">SensibleLoadMet</span><span class="p">,</span> <span class="n">LatentLoadMet</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10031"></a>                          <span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-10032"></a>            <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10033"></a>            <span class="c">!       AUTHOR:          Bo Shen, based on HVACMultiSpeedHeatPump:CalcMSHeatPump</span>
<a name="ln-10034"></a>            <span class="c">!       DATE WRITTEN:    March 2012</span>
<a name="ln-10035"></a>            <span class="c">!       MODIFIED         na</span>
<a name="ln-10036"></a>            <span class="c">!       RE-ENGINEERED    na</span>
<a name="ln-10037"></a>
<a name="ln-10038"></a>            <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10039"></a>            <span class="c">!  This routine will calcultes MSHP performance based on given system load</span>
<a name="ln-10040"></a>
<a name="ln-10041"></a>            <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10042"></a>            <span class="c">! na</span>
<a name="ln-10043"></a>
<a name="ln-10044"></a>            <span class="c">! REFERENCES: na</span>
<a name="ln-10045"></a>
<a name="ln-10046"></a>            <span class="c">! USE STATEMENTS:</span>
<a name="ln-10047"></a><span class="k">USE </span><span class="n">Fans</span><span class="p">,</span>                    <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimulateFanComponents</span>
<a name="ln-10048"></a><span class="k">USE </span><span class="n">VariableSpeedCoils</span><span class="p">,</span>   <span class="n">ONLY</span><span class="p">:</span> <span class="n">SimVariableSpeedCoils</span><span class="p">,</span> <span class="n">VarSpeedCoil</span>
<a name="ln-10049"></a><span class="k">USE </span><span class="n">DataEnvironment</span><span class="p">,</span>           <span class="n">ONLY</span><span class="p">:</span> <span class="n">OutDryBulbTemp</span>
<a name="ln-10050"></a>
<a name="ln-10051"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10052"></a>
<a name="ln-10053"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10054"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>        <span class="c">! Variable speed heat pump number</span>
<a name="ln-10055"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>   <span class="c">! Flag for 1st HVAC iteration</span>
<a name="ln-10056"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedNum</span>             <span class="c">! Speed number</span>
<a name="ln-10057"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SpeedRatio</span>           <span class="c">! Compressor speed ratio</span>
<a name="ln-10058"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadFrac</span>         <span class="c">! Compressor part load fraction</span>
<a name="ln-10059"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SensibleLoadMet</span>    <span class="c">! Sensible cooling load met (furnace outlet with respect to control zone temp)</span>
<a name="ln-10060"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">Intent</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">LatentLoadMet</span> <span class="c">! Latent cooling load met (furnace outlet with respect to control zone humidity ratio)</span>
<a name="ln-10061"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>               <span class="c">! Zone load (W)</span>
<a name="ln-10062"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QLatReq</span>              <span class="c">! Zone latent load []</span>
<a name="ln-10063"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>    <span class="c">! Ratio of compressor ON airflow to AVERAGE airflow over timestep</span>
<a name="ln-10064"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">SupHeaterLoad</span>        <span class="c">! supplemental heater load (W)</span>
<a name="ln-10065"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">CompOp</span>               <span class="c">! Compressor on/off; 1=on, 0=off</span>
<a name="ln-10066"></a>
<a name="ln-10067"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10068"></a><span class="c">!  INTEGER, PARAMETER  ::   On  = 1           ! Compressor on flag</span>
<a name="ln-10069"></a><span class="c">!  INTEGER, PARAMETER  ::   Off = 2           ! Compressor off flag</span>
<a name="ln-10070"></a>
<a name="ln-10071"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10072"></a>          <span class="c">! na</span>
<a name="ln-10073"></a>
<a name="ln-10074"></a>          <span class="c">! DERIVMS TYPE DEFINITIONS</span>
<a name="ln-10075"></a>          <span class="c">! na</span>
<a name="ln-10076"></a>
<a name="ln-10077"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10078"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OutletNode</span>        <span class="c">! MSHP air outlet node</span>
<a name="ln-10079"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">InletNode</span>         <span class="c">! MSHP air inlet node</span>
<a name="ln-10080"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MinHumRat</span>         <span class="c">! Minimum humidity ratio for sensible capacity calculation (kg/kg)</span>
<a name="ln-10081"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirMassFlow</span>       <span class="c">! Air mass flow rate [kg/s]</span>
<a name="ln-10082"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SavePartloadRatio</span> <span class="c">!part-load ratio</span>
<a name="ln-10083"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SaveSpeedRatio</span> <span class="c">!speed ratio</span>
<a name="ln-10084"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QCoilActual</span>   <span class="c">! coil load actually delivered returned to calling component</span>
<a name="ln-10085"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ErrorToler</span>    <span class="c">! supplemental heating coil convergence tollerance</span>
<a name="ln-10086"></a>  <span class="kt">Logical</span>      <span class="kd">::</span> <span class="n">SuppHeatingCoilFlag</span> <span class="c">!whether to turn on the supplemental heater</span>
<a name="ln-10087"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">MaxTemp</span>             <span class="c">! Maximum temperature for calculating latent load at a constant temperature</span>
<a name="ln-10088"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>        <span class="kd">::</span><span class="n">HeatCoilLoad</span>         <span class="c">! REQUIRED HEAT COIL LOAD</span>
<a name="ln-10089"></a>
<a name="ln-10090"></a>  <span class="c">! FLOW</span>
<a name="ln-10091"></a>  <span class="n">InletNode</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-10092"></a>  <span class="n">OutletNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-10093"></a>
<a name="ln-10094"></a>  <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10095"></a>  <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10096"></a>  <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10097"></a>  <span class="n">ErrorToler</span> <span class="o">=</span> <span class="mf">0.001d0</span>
<a name="ln-10098"></a>  <span class="c">! Set inlet air mass flow rate based on PLR and compressor on/off air flow rates</span>
<a name="ln-10099"></a>  <span class="k">CALL </span><span class="n">SetVSHPAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-10100"></a>
<a name="ln-10101"></a>  <span class="k">IF</span> <span class="p">((</span><span class="n">SupHeaterLoad</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.0d-10</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10102"></a>        <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10103"></a>        <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10104"></a>        <span class="c">! ONLY HEATING COIL, NO SUPPLEMENTAL COIL, USED FOR REHEAT DURING DUHMI</span>
<a name="ln-10105"></a>    <span class="n">HeatCoilLoad</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadFrac</span> <span class="c">!REHEAT IN FAN ON TIME</span>
<a name="ln-10106"></a>
<a name="ln-10107"></a>    <span class="k">IF</span><span class="p">(</span> <span class="n">HeatCoilLoad</span>  <span class="o">&gt;</span> <span class="n">SupHeaterLoad</span><span class="p">)</span> <span class="n">HeatCoilLoad</span> <span class="o">=</span> <span class="n">SupHeaterLoad</span> <span class="c">!HEATING COIL RUN TIME &lt; FAN ON TIME</span>
<a name="ln-10108"></a>
<a name="ln-10109"></a>  <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10110"></a>        <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10111"></a><span class="k">    </span><span class="n">HeatCoilLoad</span>      <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">DesignHeatingCapacity</span> <span class="o">*</span> <span class="n">PartLoadFrac</span>
<a name="ln-10112"></a>  <span class="k">ELSE</span>
<a name="ln-10113"></a><span class="k">    </span><span class="n">HeatCoilLoad</span>      <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10114"></a>  <span class="k">END IF</span>
<a name="ln-10115"></a>
<a name="ln-10116"></a><span class="k">  </span><span class="n">AirMassFlow</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-10117"></a>  <span class="c">! if blow through, simulate fan then coils</span>
<a name="ln-10118"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanPlace</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">BlowThru</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10119"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-10120"></a>
<a name="ln-10121"></a>     <span class="k">IF</span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10122"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10123"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-10124"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10125"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,&amp;</span>
<a name="ln-10126"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10127"></a>     <span class="k">END IF</span>
<a name="ln-10128"></a>
<a name="ln-10129"></a>
<a name="ln-10130"></a><span class="k">    IF</span> <span class="p">(((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-10131"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)))</span> <span class="k">THEN</span> <span class="c">!COOLING MODE or dehumidification mode</span>
<a name="ln-10132"></a>        <span class="k">Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10133"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10134"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10135"></a>           <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span> <span class="p">)</span>
<a name="ln-10136"></a>
<a name="ln-10137"></a>        <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10138"></a>        <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10139"></a>
<a name="ln-10140"></a>      <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10141"></a>    <span class="k">ELSE</span>
<a name="ln-10142"></a><span class="k">        Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10143"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10144"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10145"></a>           <span class="n">CompOp</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-10146"></a>    <span class="k">END IF</span>
<a name="ln-10147"></a>
<a name="ln-10148"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10149"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10150"></a><span class="k">            Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10151"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10152"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10153"></a>               <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span> <span class="p">)</span>
<a name="ln-10154"></a>
<a name="ln-10155"></a>            <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10156"></a>            <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10157"></a>
<a name="ln-10158"></a>           <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10159"></a>        <span class="k">ELSE</span>
<a name="ln-10160"></a><span class="k">            Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10161"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10162"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10163"></a>               <span class="n">CompOp</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-10164"></a>        <span class="k">END IF</span>
<a name="ln-10165"></a><span class="k">    ELSE IF</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10166"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10167"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-10168"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10169"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,&amp;</span>
<a name="ln-10170"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10171"></a>    <span class="k">END IF</span>
<a name="ln-10172"></a>
<a name="ln-10173"></a>    <span class="c">! Call twice to ensure the fan outlet conditions are updated</span>
<a name="ln-10174"></a>    <span class="k">CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-10175"></a>
<a name="ln-10176"></a>    <span class="k">IF</span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10177"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10178"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-10179"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10180"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,&amp;</span>
<a name="ln-10181"></a>            <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10182"></a>    <span class="k">END IF</span>
<a name="ln-10183"></a>
<a name="ln-10184"></a><span class="k">    IF</span> <span class="p">(((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-10185"></a>           <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)))</span> <span class="k">THEN</span>
<a name="ln-10186"></a><span class="k">        Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10187"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10188"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10189"></a>           <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span> <span class="p">)</span>
<a name="ln-10190"></a>
<a name="ln-10191"></a>        <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10192"></a>        <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10193"></a>     <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10194"></a>    <span class="k">ELSE</span>
<a name="ln-10195"></a><span class="k">        Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10196"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10197"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10198"></a>           <span class="n">CompOp</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-10199"></a>    <span class="k">END IF</span>
<a name="ln-10200"></a>
<a name="ln-10201"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10202"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10203"></a><span class="k">            Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10204"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10205"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10206"></a>               <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span> <span class="p">)</span>
<a name="ln-10207"></a>
<a name="ln-10208"></a>            <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10209"></a>            <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10210"></a>         <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10211"></a>        <span class="k">ELSE</span>
<a name="ln-10212"></a><span class="k">            Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10213"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10214"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10215"></a>               <span class="n">CompOp</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-10216"></a>        <span class="k">END IF</span>
<a name="ln-10217"></a><span class="k">    ELSE IF</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10218"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10219"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-10220"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10221"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,&amp;</span>
<a name="ln-10222"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10223"></a>    <span class="k">END IF</span>
<a name="ln-10224"></a>
<a name="ln-10225"></a>    <span class="c">!  Simulate supplemental heating coil for blow through fan</span>
<a name="ln-10226"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10227"></a><span class="k">      </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10228"></a>      <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10229"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10230"></a>    <span class="n">ENDIF</span>
<a name="ln-10231"></a>  <span class="k">ELSE</span> <span class="c">! otherwise simulate DX coils then fan then supplemental heater</span>
<a name="ln-10232"></a>
<a name="ln-10233"></a>     <span class="k">IF</span><span class="p">((.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10234"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10235"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-10236"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10237"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,&amp;</span>
<a name="ln-10238"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10239"></a>     <span class="k">END IF</span>
<a name="ln-10240"></a>
<a name="ln-10241"></a><span class="k">    IF</span><span class="p">(((</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">))</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">OutDryBulbTemp</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MinOATCompressor</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-10242"></a>        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">(</span><span class="n">QLatReq</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="o">*</span><span class="n">SmallLoad</span><span class="p">)))</span><span class="k">THEN</span>
<a name="ln-10243"></a><span class="k">        Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10244"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10245"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10246"></a>           <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span> <span class="p">)</span>
<a name="ln-10247"></a>
<a name="ln-10248"></a>        <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10249"></a>        <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10250"></a>
<a name="ln-10251"></a>      <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10252"></a>    <span class="k">ELSE</span>
<a name="ln-10253"></a><span class="k">        Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10254"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10255"></a>           <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10256"></a>           <span class="n">CompOp</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-10257"></a>    <span class="k">END IF</span>
<a name="ln-10258"></a>
<a name="ln-10259"></a><span class="k">    IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">/=</span> <span class="n">UnitarySys_HeatCool</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10260"></a><span class="k">        IF</span><span class="p">(</span><span class="n">QZnReq</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">SmallLoad</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10261"></a><span class="k">             Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10262"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10263"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10264"></a>               <span class="n">CompOp</span><span class="p">,</span> <span class="n">PartLoadFrac</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span> <span class="n">SpeedRatio</span><span class="p">,</span><span class="n">QZnReq</span><span class="p">,</span> <span class="n">QLatReq</span> <span class="p">)</span>
<a name="ln-10265"></a>
<a name="ln-10266"></a>            <span class="n">SavePartloadRatio</span> <span class="o">=</span> <span class="n">PartLoadFrac</span>
<a name="ln-10267"></a>            <span class="n">SaveSpeedRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span>
<a name="ln-10268"></a>          <span class="n">SaveCompressorPLR</span> <span class="o">=</span> <span class="n">VarSpeedCoil</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">)%</span><span class="n">PartLoadRatio</span>
<a name="ln-10269"></a>        <span class="k">ELSE</span>
<a name="ln-10270"></a><span class="k">            Call </span><span class="n">SimVariableSpeedCoils</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatingCoilIndex</span><span class="p">,&amp;</span>
<a name="ln-10271"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MaxONOFFCyclesperHour</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10272"></a>               <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HPTimeConstant</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanDelayTime</span><span class="p">,&amp;</span>
<a name="ln-10273"></a>               <span class="n">CompOp</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0d0</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span> <span class="mf">0.0d0</span> <span class="p">)</span>
<a name="ln-10274"></a>        <span class="k">END IF</span>
<a name="ln-10275"></a><span class="k">    ELSE IF</span><span class="p">(</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolingCoilUpstream</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-10276"></a>                <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10277"></a>       <span class="c">! simulate furnace heating coil</span>
<a name="ln-10278"></a>        <span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10279"></a>        <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">HeatCoilLoad</span><span class="p">,&amp;</span>
<a name="ln-10280"></a>                <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10281"></a>    <span class="k">END IF</span>
<a name="ln-10282"></a>
<a name="ln-10283"></a><span class="k">    CALL </span><span class="n">SimulateFanComponents</span><span class="p">(</span><span class="n">Blank</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanIndex</span><span class="p">,</span><span class="n">FanSpeedRatio</span><span class="p">)</span>
<a name="ln-10284"></a>    <span class="c">!  Simulate supplemental heating coil for draw through fan</span>
<a name="ln-10285"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SuppHeatCoilIndex</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10286"></a><span class="k">      </span><span class="n">SuppHeatingCoilFlag</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>       <span class="c">! if true simulates supplemental heating coil</span>
<a name="ln-10287"></a>      <span class="k">CALL </span><span class="n">CalcNonDXHeatingCoils</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">SuppHeatingCoilFlag</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-10288"></a>         <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">,</span><span class="n">QCoilActual</span><span class="p">)</span>
<a name="ln-10289"></a>    <span class="n">ENDIF</span>
<a name="ln-10290"></a>  <span class="k">END IF</span>
<a name="ln-10291"></a>
<a name="ln-10292"></a>  <span class="c">! If the fan runs continually do not allow coils to set OnOffFanPartLoadRatio.</span>
<a name="ln-10293"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span><span class="p">.</span><span class="n">EQ</span><span class="p">.</span><span class="n">ContFanCycCoil</span><span class="p">)</span><span class="n">OnOffFanPartLoadFraction</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10294"></a>
<a name="ln-10295"></a><span class="c">! Check delta T (outlet to space), if positive</span>
<a name="ln-10296"></a> <span class="c">! use space HumRat (next line), else outlet humrat (IF) so psyc routine gives good result</span>
<a name="ln-10297"></a>  <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-10298"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-10299"></a>    <span class="n">MinHumRat</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span>
<a name="ln-10300"></a>
<a name="ln-10301"></a> <span class="c">! Calculate sensible load met (at constant humidity ratio)</span>
<a name="ln-10302"></a>  <span class="n">SensibleLoadMet</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10303"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span><span class="p">,</span><span class="n">MinHumRat</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-10304"></a>         <span class="o">-</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SenLoadLoss</span>
<a name="ln-10305"></a>  <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SensibleLoadMet</span> <span class="o">=</span> <span class="n">SensibleLoadMet</span>
<a name="ln-10306"></a>
<a name="ln-10307"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">Humidistat</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10308"></a><span class="k">    </span><span class="n">MaxTemp</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">Temp</span>
<a name="ln-10309"></a><span class="c">! modified, why does switching between furnace outlet and control zone temp</span>
<a name="ln-10310"></a><span class="c">! cause latent load to change when latent capacity is 0 ?</span>
<a name="ln-10311"></a><span class="c">!    IF(Node(FurnaceOutletNode)%Temp .GT. Node(Furnace(FurnaceNum)%NodeNumofControlledZone)%Temp ) &amp;</span>
<a name="ln-10312"></a><span class="c">!       MaxTemp = Node(FurnaceOutletNode)%Temp</span>
<a name="ln-10313"></a><span class="c">!   Calculate latent load met (at constant temperature)</span>
<a name="ln-10314"></a>    <span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="n">AirMassFlow</span> <span class="o">*</span> <span class="p">(</span><span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">OutletNode</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">)</span>  <span class="p">&amp;</span>
<a name="ln-10315"></a>         <span class="o">-</span> <span class="n">PsyHFnTdbW</span><span class="p">(</span><span class="n">MaxTemp</span><span class="p">,</span><span class="n">Node</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NodeNumofControlledZone</span><span class="p">)%</span><span class="n">HumRat</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-10316"></a>         <span class="o">-</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatLoadLoss</span>
<a name="ln-10317"></a>  <span class="k">ELSE</span>
<a name="ln-10318"></a><span class="k">    </span><span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10319"></a>  <span class="k">END IF</span>
<a name="ln-10320"></a><span class="k">  </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LatentLoadMet</span> <span class="o">=</span> <span class="n">LatentLoadMet</span>
<a name="ln-10321"></a>
<a name="ln-10322"></a><span class="k">RETURN</span>
<a name="ln-10323"></a><span class="k">END SUBROUTINE </span><span class="n">CalcVarSpeedHeatPump</span>
<a name="ln-10324"></a>
<a name="ln-10325"></a>
<a name="ln-10326"></a><span class="c">!******************************************************************************</span>
<a name="ln-10327"></a>
<a name="ln-10328"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">VSHPCyclingResidual</span><span class="p">(</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-10329"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10330"></a>          <span class="c">!       AUTHOR         Bo Shen, based on HVACMultiSpeedHeatPump:MSHPCyclingResidual</span>
<a name="ln-10331"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-10332"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10333"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10334"></a>
<a name="ln-10335"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10336"></a>          <span class="c">!  Calculates residual function ((ActualOutput - QZnReq)/QZnReq)</span>
<a name="ln-10337"></a>          <span class="c">!  MSHP output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-10338"></a>
<a name="ln-10339"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10340"></a>          <span class="c">!  Calls CalcMSHeatPump to get ActualOutput at the given part load ratio</span>
<a name="ln-10341"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-10342"></a>
<a name="ln-10343"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10344"></a>
<a name="ln-10345"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10346"></a>          <span class="c">! na</span>
<a name="ln-10347"></a>
<a name="ln-10348"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10349"></a>
<a name="ln-10350"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10351"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">PartLoadFrac</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-10352"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = FurnaceNum</span>
<a name="ln-10353"></a>                                                  <span class="c">! par(2) = Zone Num</span>
<a name="ln-10354"></a>                                                  <span class="c">! par(3) = FirstHVACIteration</span>
<a name="ln-10355"></a>                                                  <span class="c">! par(4) = OpMode</span>
<a name="ln-10356"></a>                                                  <span class="c">! par(5) = QZnReq, load to be met</span>
<a name="ln-10357"></a>                                                  <span class="c">! par(6) = OnOffAirFlowRatio</span>
<a name="ln-10358"></a>                                                  <span class="c">! par(7) = SupHeaterLoad</span>
<a name="ln-10359"></a>
<a name="ln-10360"></a>                                                  <span class="c">! par(9) = CompOp</span>
<a name="ln-10361"></a>                                                  <span class="c">! par(10) = 1.0 to meet sensible load</span>
<a name="ln-10362"></a>
<a name="ln-10363"></a>
<a name="ln-10364"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10365"></a>          <span class="c">!  na</span>
<a name="ln-10366"></a>
<a name="ln-10367"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10368"></a>          <span class="c">!  na</span>
<a name="ln-10369"></a>
<a name="ln-10370"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10371"></a>          <span class="c">!  na</span>
<a name="ln-10372"></a>
<a name="ln-10373"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10374"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FurnaceNum</span>       <span class="c">! MSHP index</span>
<a name="ln-10375"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone index</span>
<a name="ln-10376"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-10377"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! Compressor operating mode</span>
<a name="ln-10378"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! zone sensible load (W)</span>
<a name="ln-10379"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnLat</span>             <span class="c">! zone latent load (W)</span>
<a name="ln-10380"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-10381"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneSensLoadMet</span>       <span class="c">! delivered sensible capacity of MSHP</span>
<a name="ln-10382"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneLatLoadMet</span>       <span class="c">! delivered latent capacity of MSHP</span>
<a name="ln-10383"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadToBeMet</span>      <span class="c">! sensible or latent load to be met</span>
<a name="ln-10384"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span>      <span class="c">! Supplemental heater load</span>
<a name="ln-10385"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ResScale</span>        <span class="c">! Residual scale</span>
<a name="ln-10386"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-10387"></a>
<a name="ln-10388"></a>  <span class="n">FurnaceNum</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-10389"></a>  <span class="n">ZoneNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-10390"></a>  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make 1.0=TRUE and 0.0=FALSE</span>
<a name="ln-10391"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10392"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10393"></a>  <span class="k">ELSE</span>
<a name="ln-10394"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10395"></a>  <span class="k">END IF</span>
<a name="ln-10396"></a><span class="k">  </span><span class="n">OpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-10397"></a>
<a name="ln-10398"></a>  <span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10399"></a>  <span class="n">QZnLat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10400"></a>
<a name="ln-10401"></a>  <span class="n">LoadToBeMet</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-10402"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10403"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-10404"></a>  <span class="k">ELSE</span>
<a name="ln-10405"></a><span class="k">    </span><span class="n">QZnLat</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-10406"></a>  <span class="k">END IF</span>
<a name="ln-10407"></a>
<a name="ln-10408"></a><span class="k">  </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-10409"></a>  <span class="n">SupHeaterLoad</span>     <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-10410"></a>  <span class="n">CompOp</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-10411"></a>
<a name="ln-10412"></a>  <span class="k">CALL </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.0d0</span><span class="p">,</span><span class="n">PartLoadFrac</span><span class="p">,</span><span class="n">ZoneSensLoadMet</span><span class="p">,</span> <span class="n">ZoneLatLoadMet</span><span class="p">,&amp;</span>
<a name="ln-10413"></a>                          <span class="n">QZnReq</span><span class="p">,</span> <span class="n">QZnLat</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-10414"></a>
<a name="ln-10415"></a>  <span class="n">ResScale</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">LoadToBeMet</span><span class="p">)</span>
<a name="ln-10416"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ResScale</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10417"></a><span class="k">    </span><span class="n">ResScale</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-10418"></a>  <span class="k">ELSE</span>
<a name="ln-10419"></a><span class="k">    </span><span class="n">ResScale</span> <span class="o">=</span>  <span class="n">LoadToBeMet</span>
<a name="ln-10420"></a>  <span class="k">END IF</span>
<a name="ln-10421"></a>
<a name="ln-10422"></a>  <span class="c">! Calculate residual based on output calculation flag</span>
<a name="ln-10423"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10424"></a><span class="k">    </span><span class="n">VSHPCyclingResidual</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">ResScale</span>
<a name="ln-10425"></a>  <span class="k">ELSE</span>
<a name="ln-10426"></a><span class="k">    </span><span class="n">VSHPCyclingResidual</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneLatLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">ResScale</span>
<a name="ln-10427"></a>  <span class="k">END IF</span>
<a name="ln-10428"></a>
<a name="ln-10429"></a><span class="k">  RETURN</span>
<a name="ln-10430"></a>
<a name="ln-10431"></a><span class="k">END FUNCTION </span><span class="n">VSHPCyclingResidual</span>
<a name="ln-10432"></a>
<a name="ln-10433"></a>
<a name="ln-10434"></a><span class="c">!******************************************************************************</span>
<a name="ln-10435"></a>
<a name="ln-10436"></a><span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span> <span class="k">FUNCTION </span><span class="n">VSHPSpeedResidual</span><span class="p">(</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="n">Par</span><span class="p">)</span>
<a name="ln-10437"></a>          <span class="c">! FUNCTION INFORMATION:</span>
<a name="ln-10438"></a>          <span class="c">!       AUTHOR         Bo Shen, , based on HVACMultiSpeedHeatPump:MSHPVarSpeedgResidual</span>
<a name="ln-10439"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-10440"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10441"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10442"></a>
<a name="ln-10443"></a>          <span class="c">! PURPOSE OF THIS FUNCTION:</span>
<a name="ln-10444"></a>          <span class="c">!  Calculates residual function ((ActualOutput - QZnReq)/QZnReq)</span>
<a name="ln-10445"></a>          <span class="c">!  MSHP output depends on the part load ratio which is being varied to zero the residual.</span>
<a name="ln-10446"></a>
<a name="ln-10447"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10448"></a>          <span class="c">!  Calls CalcMSHeatPump to get ActualOutput at the given speed ratio (partload ratio for high speed)</span>
<a name="ln-10449"></a>          <span class="c">!  and calculates the residual as defined above</span>
<a name="ln-10450"></a>
<a name="ln-10451"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10452"></a>
<a name="ln-10453"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10454"></a>          <span class="c">! na</span>
<a name="ln-10455"></a>
<a name="ln-10456"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10457"></a>
<a name="ln-10458"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10459"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">SpeedRatio</span> <span class="c">! compressor cycling ratio (1.0 is continuous, 0.0 is off)</span>
<a name="ln-10460"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">Par</span> <span class="c">! par(1) = MSHPNum</span>
<a name="ln-10461"></a>                                                  <span class="c">! par(2) = Zone Num</span>
<a name="ln-10462"></a>                                                  <span class="c">! par(3) = FirstHVACIteration</span>
<a name="ln-10463"></a>                                                  <span class="c">! par(4) = OpMode</span>
<a name="ln-10464"></a>                                                  <span class="c">! par(5) = QZnReq</span>
<a name="ln-10465"></a>                                                  <span class="c">! par(6) = OnOffAirFlowRatio</span>
<a name="ln-10466"></a>                                                  <span class="c">! par(7) = SupHeaterLoad</span>
<a name="ln-10467"></a>                                                  <span class="c">! par(8) = SpeedNum</span>
<a name="ln-10468"></a>                                                  <span class="c">! par(9) = CompOp</span>
<a name="ln-10469"></a>                                                  <span class="c">! par(10) = 1.0 to meet sensible load</span>
<a name="ln-10470"></a>
<a name="ln-10471"></a>          <span class="c">! FUNCTION PARAMETER DEFINITIONS:</span>
<a name="ln-10472"></a>          <span class="c">!  na</span>
<a name="ln-10473"></a>
<a name="ln-10474"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10475"></a>          <span class="c">!  na</span>
<a name="ln-10476"></a>
<a name="ln-10477"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10478"></a>          <span class="c">!  na</span>
<a name="ln-10479"></a>
<a name="ln-10480"></a>          <span class="c">! FUNCTION LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10481"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">FurnaceNum</span>      <span class="c">! MSHP index</span>
<a name="ln-10482"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">ZoneNum</span>            <span class="c">! Zone index</span>
<a name="ln-10483"></a>  <span class="kt">LOGICAL</span> <span class="kd">::</span> <span class="n">FirstHVACIteration</span> <span class="c">! FirstHVACIteration flag</span>
<a name="ln-10484"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">OpMode</span>             <span class="c">! Compressor operating mode</span>
<a name="ln-10485"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>             <span class="c">! zone load (W)</span>
<a name="ln-10486"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnLat</span>             <span class="c">! zone latent load (W)</span>
<a name="ln-10487"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-10488"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneSensLoadMet</span>       <span class="c">! delivered sensible capacity of MSHP</span>
<a name="ln-10489"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneLatLoadMet</span>       <span class="c">! delivered latent capacity of MSHP</span>
<a name="ln-10490"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">LoadToBeMet</span>      <span class="c">! sensible or latent load to be met</span>
<a name="ln-10491"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">SupHeaterLoad</span>      <span class="c">! Supplemental heater load</span>
<a name="ln-10492"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ResScale</span>        <span class="c">! Residual scale</span>
<a name="ln-10493"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">SpeedNum</span>           <span class="c">! Speed number</span>
<a name="ln-10494"></a>  <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">CompOp</span>             <span class="c">! compressor operation; 1=on, 0=off</span>
<a name="ln-10495"></a>
<a name="ln-10496"></a>  <span class="n">FurnaceNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-10497"></a>  <span class="n">ZoneNum</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<a name="ln-10498"></a>  <span class="c">! FirstHVACIteration is a logical, Par is REAL(r64), so make 1.0=TRUE and 0.0=FALSE</span>
<a name="ln-10499"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10500"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
<a name="ln-10501"></a>  <span class="k">ELSE</span>
<a name="ln-10502"></a><span class="k">    </span><span class="n">FirstHVACIteration</span> <span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
<a name="ln-10503"></a>  <span class="k">END IF</span>
<a name="ln-10504"></a><span class="k">  </span><span class="n">OpMode</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<a name="ln-10505"></a>
<a name="ln-10506"></a>  <span class="n">QZnReq</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10507"></a>  <span class="n">QZnLat</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10508"></a>
<a name="ln-10509"></a>  <span class="n">LoadToBeMet</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-10510"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10511"></a><span class="k">    </span><span class="n">QZnReq</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-10512"></a>  <span class="k">ELSE</span>
<a name="ln-10513"></a><span class="k">    </span><span class="n">QZnLat</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-10514"></a>  <span class="k">END IF</span>
<a name="ln-10515"></a>
<a name="ln-10516"></a><span class="k">  </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-10517"></a>  <span class="n">SupHeaterLoad</span>     <span class="o">=</span> <span class="n">Par</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a name="ln-10518"></a>  <span class="n">SpeedNum</span>     <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<a name="ln-10519"></a>  <span class="n">CompOp</span> <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<a name="ln-10520"></a>
<a name="ln-10521"></a>  <span class="k">Call </span><span class="n">CalcVarSpeedHeatPump</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">FirstHVACIteration</span><span class="p">,</span><span class="n">CompOp</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">,</span><span class="mf">1.0d0</span><span class="p">,</span><span class="n">ZoneSensLoadMet</span><span class="p">,</span> <span class="n">ZoneLatLoadMet</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-10522"></a>                          <span class="n">QZnReq</span><span class="p">,</span> <span class="n">QZnLat</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SupHeaterLoad</span><span class="p">)</span>
<a name="ln-10523"></a>
<a name="ln-10524"></a>  <span class="n">ResScale</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">LoadToBeMet</span><span class="p">)</span>
<a name="ln-10525"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ResScale</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10526"></a><span class="k">    </span><span class="n">ResScale</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0d0</span>
<a name="ln-10527"></a>  <span class="k">ELSE</span>
<a name="ln-10528"></a><span class="k">    </span><span class="n">ResScale</span> <span class="o">=</span>  <span class="n">LoadToBeMet</span>
<a name="ln-10529"></a>  <span class="k">END IF</span>
<a name="ln-10530"></a>
<a name="ln-10531"></a>    <span class="c">! Calculate residual based on output calculation flag</span>
<a name="ln-10532"></a>  <span class="k">IF</span><span class="p">(</span><span class="n">Par</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">1.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10533"></a><span class="k">    </span><span class="n">VSHPSpeedResidual</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneSensLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">ResScale</span>
<a name="ln-10534"></a>  <span class="k">ELSE</span>
<a name="ln-10535"></a><span class="k">    </span><span class="n">VSHPSpeedResidual</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZoneLatLoadMet</span> <span class="o">-</span> <span class="n">LoadToBeMet</span><span class="p">)</span><span class="o">/</span><span class="n">ResScale</span>
<a name="ln-10536"></a>  <span class="k">END IF</span>
<a name="ln-10537"></a>
<a name="ln-10538"></a><span class="k">  RETURN</span>
<a name="ln-10539"></a>
<a name="ln-10540"></a><span class="k">END FUNCTION </span><span class="n">VSHPSpeedResidual</span>
<a name="ln-10541"></a>
<a name="ln-10542"></a><span class="k">SUBROUTINE </span><span class="n">SetVSHPAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">,</span><span class="n">SpeedNum</span><span class="p">,</span><span class="n">SpeedRatio</span><span class="p">)</span>
<a name="ln-10543"></a>
<a name="ln-10544"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10545"></a>          <span class="c">!       AUTHOR         Bo Shen, based on HVACMultiSpeedHeatPump:SetAverageAirFlow</span>
<a name="ln-10546"></a>          <span class="c">!       DATE WRITTEN   March, 2012</span>
<a name="ln-10547"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10548"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10549"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10550"></a>          <span class="c">! Set the average air mass flow rates using the part load fraction of the heat pump for this time step</span>
<a name="ln-10551"></a>          <span class="c">! Set OnOffAirFlowRatio to be used by DX coils</span>
<a name="ln-10552"></a>
<a name="ln-10553"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10554"></a>          <span class="c">! na</span>
<a name="ln-10555"></a>
<a name="ln-10556"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10557"></a>          <span class="c">! na</span>
<a name="ln-10558"></a>
<a name="ln-10559"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10560"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span>      <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurDeadBandOrSetback</span>
<a name="ln-10561"></a>  <span class="k">USE </span><span class="n">DataHVACGlobals</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">MSHPMassFlowRateLow</span><span class="p">,</span> <span class="n">MSHPMassFlowRateHigh</span>
<a name="ln-10562"></a>
<a name="ln-10563"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10564"></a>
<a name="ln-10565"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10566"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>      <span class="c">! Unit index</span>
<a name="ln-10567"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>      <span class="c">! unit part load ratio</span>
<a name="ln-10568"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>   <span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span>  <span class="c">! ratio of compressor ON airflow to average airflow over timestep</span>
<a name="ln-10569"></a>  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SpeedNum</span>     <span class="c">! Speed number</span>
<a name="ln-10570"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span>    <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="k">OPTIONAL</span> <span class="kd">::</span> <span class="n">SpeedRatio</span>   <span class="c">! Speed ratio</span>
<a name="ln-10571"></a>
<a name="ln-10572"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10573"></a>          <span class="c">! na</span>
<a name="ln-10574"></a>
<a name="ln-10575"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10576"></a>          <span class="c">! na</span>
<a name="ln-10577"></a>
<a name="ln-10578"></a>          <span class="c">! DERIVMS TYPE DEFINITIONS</span>
<a name="ln-10579"></a>          <span class="c">! na</span>
<a name="ln-10580"></a>
<a name="ln-10581"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10582"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InletNode</span>           <span class="c">! inlet node number for PTHPNum</span>
<a name="ln-10583"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">AverageUnitMassFlow</span> <span class="c">! average supply air mass flow rate over time step</span>
<a name="ln-10584"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutNode</span>                          <span class="c">! Outlet node number in MSHP loop</span>
<a name="ln-10585"></a>
<a name="ln-10586"></a>  <span class="n">InletNode</span>      <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-10587"></a>  <span class="n">OutNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-10588"></a>
<a name="ln-10589"></a>  <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="mf">0.0d0</span>             <span class="c">! Mass flow rate at low speed</span>
<a name="ln-10590"></a>  <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="mf">0.0d0</span>            <span class="c">! Mass flow rate at high speed</span>
<a name="ln-10591"></a>
<a name="ln-10592"></a>
<a name="ln-10593"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10594"></a><span class="k">   </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-10595"></a>   <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-10596"></a>  <span class="k">ELSE</span>
<a name="ln-10597"></a><span class="k">   </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10598"></a>   <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10599"></a>  <span class="k">END IF</span>
<a name="ln-10600"></a>
<a name="ln-10601"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">HeatingLoad</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceType_Num</span> <span class="o">==</span> <span class="n">UnitarySys_HeatCool</span><span class="p">))</span><span class="k">THEN</span>
<a name="ln-10602"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-10603"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-10604"></a>      <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-10605"></a>      <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">NumOfSpeedCooling</span><span class="p">)</span>
<a name="ln-10606"></a>      <span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-10607"></a>      <span class="k">IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10608"></a><span class="k">        </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-10609"></a>      <span class="k">ELSE</span>
<a name="ln-10610"></a><span class="k">        </span><span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-10611"></a>      <span class="k">END IF</span>
<a name="ln-10612"></a><span class="k">  ELSE</span>
<a name="ln-10613"></a><span class="k">     If</span> <span class="p">(.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">ControlZoneNum</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">Present</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="p">)</span> <span class="k">Then</span>
<a name="ln-10614"></a><span class="k">        If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10615"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10616"></a><span class="k">            </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10617"></a>            <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10618"></a>            <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10619"></a>            <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10620"></a>          <span class="k">Else If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10621"></a><span class="k">            </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-10622"></a>                             <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10623"></a>            <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-10624"></a>                             <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10625"></a>            <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10626"></a>            <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10627"></a>          <span class="k">End If</span>
<a name="ln-10628"></a><span class="k">        Else If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10629"></a><span class="k">          If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10630"></a><span class="k">            </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10631"></a>            <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10632"></a>            <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10633"></a>            <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10634"></a>          <span class="k">Else If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10635"></a><span class="k">            </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-10636"></a>                             <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10637"></a>            <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">SpeedRatio</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-10638"></a>                             <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">SpeedRatio</span><span class="p">)</span><span class="o">*</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10639"></a>            <span class="n">MSHPMassFlowRateLow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10640"></a>            <span class="n">MSHPMassFlowRateHigh</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10641"></a>          <span class="k">End If</span>
<a name="ln-10642"></a><span class="k">        End If</span>
<a name="ln-10643"></a><span class="k">      End If</span>
<a name="ln-10644"></a>
<a name="ln-10645"></a>      <span class="c">! Set up fan flow rate during compressor off time</span>
<a name="ln-10646"></a>      <span class="k">If</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="nb">Present</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-10647"></a><span class="k">        IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">AirFlowControl</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">UseCompressorOnFlow</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompOnMassFlow</span> <span class="o">&gt;</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10648"></a><span class="k">          IF</span><span class="p">(</span><span class="n">SpeedNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>  <span class="c">!LOWEST SPEED USE IDLE FLOW</span>
<a name="ln-10649"></a>            <span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-10650"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-10651"></a>          <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10652"></a><span class="k">            </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10653"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10654"></a>          <span class="k">ELSE</span>
<a name="ln-10655"></a><span class="k">            </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10656"></a>            <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">)</span>
<a name="ln-10657"></a>          <span class="k">END IF</span>
<a name="ln-10658"></a><span class="k">        END IF</span>
<a name="ln-10659"></a><span class="k">      End If</span>
<a name="ln-10660"></a>
<a name="ln-10661"></a><span class="k">      If</span> <span class="p">(</span><span class="nb">Present</span><span class="p">(</span><span class="n">SpeedNum</span><span class="p">))</span> <span class="k">Then</span>
<a name="ln-10662"></a><span class="k">        If</span> <span class="p">(</span><span class="n">SpeedNum</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">Then</span>
<a name="ln-10663"></a><span class="k">          </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-10664"></a>          <span class="n">FanSpeedRatio</span>       <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-10665"></a>        <span class="k">Else</span>
<a name="ln-10666"></a><span class="k">          </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-10667"></a>          <span class="k">IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10668"></a><span class="k">            </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-10669"></a>          <span class="k">ELSE</span>
<a name="ln-10670"></a><span class="k">            </span><span class="n">FanSpeedRatio</span>     <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-10671"></a>          <span class="k">END IF</span>
<a name="ln-10672"></a><span class="k">        End If</span>
<a name="ln-10673"></a><span class="k">      Else</span>
<a name="ln-10674"></a><span class="k">        </span><span class="n">AverageUnitMassFlow</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnMassFlow</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffMassFlow</span><span class="p">)</span>
<a name="ln-10675"></a>        <span class="k">IF</span><span class="p">(</span><span class="n">CompOffFlowRatio</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10676"></a><span class="k">          </span><span class="n">FanSpeedRatio</span> <span class="o">=</span> <span class="p">(</span><span class="n">PartLoadRatio</span> <span class="o">*</span> <span class="n">CompOnFlowRatio</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">PartLoadRatio</span><span class="p">)</span> <span class="o">*</span> <span class="n">CompOffFlowRatio</span><span class="p">)</span>
<a name="ln-10677"></a>        <span class="k">ELSE</span>
<a name="ln-10678"></a><span class="k">          </span><span class="n">FanSpeedRatio</span>       <span class="o">=</span> <span class="n">CompOnFlowRatio</span>
<a name="ln-10679"></a>        <span class="k">END IF</span>
<a name="ln-10680"></a><span class="k">      End If</span>
<a name="ln-10681"></a><span class="k">  END IF</span>
<a name="ln-10682"></a>
<a name="ln-10683"></a><span class="k">  IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">SchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10684"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10685"></a>    <span class="n">OnOffAirFlowRatio</span>                         <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10686"></a>  <span class="k">ELSE</span>
<a name="ln-10687"></a><span class="k">    </span><span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>              <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-10688"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>      <span class="o">=</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-10689"></a>    <span class="k">IF</span> <span class="p">(</span><span class="n">AverageUnitMassFlow</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10690"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="n">CompOnMassFlow</span> <span class="o">/</span> <span class="n">AverageUnitMassFlow</span>
<a name="ln-10691"></a>    <span class="k">ELSE</span>
<a name="ln-10692"></a><span class="k">      </span><span class="n">OnOffAirFlowRatio</span>                       <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10693"></a>    <span class="k">END IF</span>
<a name="ln-10694"></a><span class="k">  END IF</span>
<a name="ln-10695"></a>
<a name="ln-10696"></a><span class="k">  </span><span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>  <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">InletNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>
<a name="ln-10697"></a>
<a name="ln-10698"></a><span class="c">!  IF(abs(Node(OutNode)%MassFlowRate - 0.435)  &lt; 0.001) THEN</span>
<a name="ln-10699"></a><span class="c">!    Node(OutNode)%MassFlowRate  = Node(InletNode)%MassFlowRate</span>
<a name="ln-10700"></a><span class="c">!  END IF</span>
<a name="ln-10701"></a>
<a name="ln-10702"></a>  <span class="k">RETURN</span>
<a name="ln-10703"></a><span class="k">END SUBROUTINE </span><span class="n">SetVSHPAirFlow</span>
<a name="ln-10704"></a>
<a name="ln-10705"></a><span class="k">SUBROUTINE </span><span class="n">SetOnOffMassFlowRateVSCoil</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span> <span class="n">ZoneNum</span><span class="p">,</span> <span class="n">FirstHVACIteration</span><span class="p">,</span> <span class="n">AirLoopNum</span><span class="p">,</span> <span class="n">OnOffAirFlowRatio</span><span class="p">,</span> <span class="n">OpMode</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-10706"></a>                                        <span class="n">QZnReq</span><span class="p">,</span> <span class="n">MoistureLoad</span><span class="p">,</span> <span class="n">PartLoadRatio</span><span class="p">)</span>
<a name="ln-10707"></a>
<a name="ln-10708"></a>          <span class="c">! SUBROUTINE INFORMATION:</span>
<a name="ln-10709"></a>          <span class="c">!       AUTHOR         Bo Shen</span>
<a name="ln-10710"></a>          <span class="c">!       DATE WRITTEN   March 2012</span>
<a name="ln-10711"></a>          <span class="c">!       MODIFIED       na</span>
<a name="ln-10712"></a>          <span class="c">!       RE-ENGINEERED  na</span>
<a name="ln-10713"></a>
<a name="ln-10714"></a>          <span class="c">! PURPOSE OF THIS SUBROUTINE:</span>
<a name="ln-10715"></a>          <span class="c">! This subroutine is for initializations of the Furnace Components.</span>
<a name="ln-10716"></a>
<a name="ln-10717"></a>          <span class="c">! METHODOLOGY EMPLOYED:</span>
<a name="ln-10718"></a>          <span class="c">! The HeatCool furnace/unitarysystem and air-to-air heat pump may have alternate air flow rates</span>
<a name="ln-10719"></a>          <span class="c">! in cooling, heating, and when no cooling or heating is needed. Set up the coil (comp) ON and OFF</span>
<a name="ln-10720"></a>          <span class="c">! air flow rates. Use these flow rates during the Calc routines to set the average mass flow rates</span>
<a name="ln-10721"></a>          <span class="c">! based on PLR.</span>
<a name="ln-10722"></a>
<a name="ln-10723"></a>          <span class="c">! REFERENCES:</span>
<a name="ln-10724"></a>          <span class="c">! na</span>
<a name="ln-10725"></a>
<a name="ln-10726"></a>          <span class="c">! USE STATEMENTS:</span>
<a name="ln-10727"></a>  <span class="k">USE </span><span class="n">General</span><span class="p">,</span>     <span class="n">ONLY</span><span class="p">:</span> <span class="n">RoundSigDigits</span>
<a name="ln-10728"></a>  <span class="k">USE </span><span class="n">DataZoneEnergyDemands</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">CurDeadbandOrSetback</span>
<a name="ln-10729"></a>
<a name="ln-10730"></a>  <span class="k">IMPLICIT NONE</span>    <span class="c">! Enforce explicit typing of all variables in this routine</span>
<a name="ln-10731"></a>
<a name="ln-10732"></a>          <span class="c">! SUBROUTINE ARGUMENT DEFINITIONS:</span>
<a name="ln-10733"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FurnaceNum</span>        <span class="c">! index to furnace</span>
<a name="ln-10734"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">ZoneNum</span>           <span class="c">! index to zone</span>
<a name="ln-10735"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">AirLoopNum</span>        <span class="c">! index to air loop !unused1208</span>
<a name="ln-10736"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span> <span class="kd">::</span> <span class="n">OnOffAirFlowRatio</span> <span class="c">! ratio of coil on to coil off air flow rate</span>
<a name="ln-10737"></a>  <span class="kt">INTEGER</span><span class="p">,</span>   <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">OpMode</span>            <span class="c">! fan operating mode</span>
<a name="ln-10738"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">QZnReq</span>          <span class="c">! sensible load to be met (W) !unused1208</span>
<a name="ln-10739"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">MoistureLoad</span>      <span class="c">! moisture load to be met (W)</span>
<a name="ln-10740"></a>  <span class="kt">REAL</span><span class="p">(</span><span class="n">r64</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">PartLoadRatio</span>     <span class="c">! coil part-load ratio</span>
<a name="ln-10741"></a>  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">INTENT</span> <span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">FirstHVACIteration</span>   <span class="c">! Flag for 1st HVAC iteration</span>
<a name="ln-10742"></a>
<a name="ln-10743"></a>          <span class="c">! SUBROUTINE PARAMETER DEFINITIONS:</span>
<a name="ln-10744"></a>          <span class="c">! na</span>
<a name="ln-10745"></a>
<a name="ln-10746"></a>          <span class="c">! INTERFACE BLOCK SPECIFICATIONS</span>
<a name="ln-10747"></a>          <span class="c">! na</span>
<a name="ln-10748"></a>
<a name="ln-10749"></a>          <span class="c">! DERIVED TYPE DEFINITIONS</span>
<a name="ln-10750"></a>          <span class="c">! na</span>
<a name="ln-10751"></a>
<a name="ln-10752"></a>          <span class="c">! SUBROUTINE LOCAL VARIABLE DECLARATIONS:</span>
<a name="ln-10753"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">InNode</span>                           <span class="c">! Inlet node number in MSHP loop</span>
<a name="ln-10754"></a>  <span class="kt">INTEGER</span>             <span class="kd">::</span> <span class="n">OutNode</span>                          <span class="c">! Outlet node number in MSHP loop</span>
<a name="ln-10755"></a>
<a name="ln-10756"></a>  <span class="n">InNode</span>  <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceInletNodeNum</span>
<a name="ln-10757"></a>  <span class="n">OutNode</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FurnaceOutletNodeNum</span>
<a name="ln-10758"></a>
<a name="ln-10759"></a>          <span class="c">! FLOW:</span>
<a name="ln-10760"></a>
<a name="ln-10761"></a>  <span class="k">If</span> <span class="p">(</span><span class="n">CoolingLoad</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10762"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-10763"></a>  <span class="k">ELSE If</span> <span class="p">(</span><span class="n">HeatingLoad</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-10764"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-10765"></a>  <span class="k">Else</span>
<a name="ln-10766"></a><span class="k">    </span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-10767"></a>  <span class="k">End If</span>
<a name="ln-10768"></a>
<a name="ln-10769"></a>  <span class="c">! Set the inlet node mass flow rate</span>
<a name="ln-10770"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">OpMode</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">ContFanCycCoil</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10771"></a>  <span class="c">! constant fan mode</span>
<a name="ln-10772"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10773"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10774"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10775"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">HeatingMode</span>
<a name="ln-10776"></a>    <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">)</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10777"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10778"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10779"></a>      <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">LastMode</span> <span class="o">=</span> <span class="n">CoolingMode</span>
<a name="ln-10780"></a>    <span class="k">ELSE</span>
<a name="ln-10781"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-10782"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-10783"></a>    <span class="k">END IF</span>
<a name="ln-10784"></a><span class="k">    </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleMassFlowRate</span>
<a name="ln-10785"></a>    <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">IdleSpeedRatio</span>
<a name="ln-10786"></a>  <span class="k">ELSE</span>
<a name="ln-10787"></a>  <span class="c">! cycling fan mode</span>
<a name="ln-10788"></a>    <span class="k">IF</span> <span class="p">((</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">HeatingMode</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10789"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10790"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSHeatingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10791"></a>    <span class="k">ELSE IF</span> <span class="p">((</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">==</span> <span class="n">CoolingMode</span><span class="p">).</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span> <span class="n">CurDeadbandOrSetback</span><span class="p">(</span><span class="n">ZoneNum</span><span class="p">))</span> <span class="k">THEN</span>
<a name="ln-10792"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">CoolMassFlowRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10793"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">MSCoolingSpeedRatio</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-10794"></a>    <span class="k">ELSE</span>
<a name="ln-10795"></a><span class="k">      </span><span class="n">CompOnMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10796"></a>      <span class="n">CompOnFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10797"></a>    <span class="k">END IF</span>
<a name="ln-10798"></a><span class="k">    </span><span class="n">CompOffMassFlow</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10799"></a>    <span class="n">CompOffFlowRatio</span> <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10800"></a>  <span class="k">END IF</span>
<a name="ln-10801"></a>
<a name="ln-10802"></a>  <span class="c">! Set the inlet node mass flow rate</span>
<a name="ln-10803"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">GetCurrentScheduleValue</span><span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">FanAvailSchedPtr</span><span class="p">)</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mf">0.0d0</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">CompOnMassFlow</span> <span class="p">.</span><span class="n">NE</span><span class="p">.</span> <span class="mf">0.0d0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10804"></a><span class="k">    </span><span class="n">OnOffAirFlowRatio</span> <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10805"></a>    <span class="k">IF</span><span class="p">(</span><span class="n">FirstHVACIteration</span><span class="p">)</span><span class="k">THEN</span>
<a name="ln-10806"></a><span class="k">      </span><span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRate</span> <span class="o">=</span> <span class="n">CompOnMassFlow</span>
<a name="ln-10807"></a>      <span class="n">PartLoadRatio</span>            <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10808"></a>    <span class="k">ELSE</span>
<a name="ln-10809"></a><span class="k">      IF</span> <span class="p">(</span><span class="n">Furnace</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">)%</span><span class="n">HeatCoolMode</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-10810"></a><span class="k">        </span><span class="n">PartLoadRatio</span>  <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10811"></a>      <span class="k">ELSE</span>
<a name="ln-10812"></a><span class="k">        </span><span class="n">PartLoadRatio</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10813"></a>      <span class="k">END IF</span>
<a name="ln-10814"></a><span class="k">    END IF</span>
<a name="ln-10815"></a><span class="k">  ELSE</span>
<a name="ln-10816"></a><span class="k">    </span><span class="n">PartLoadRatio</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10817"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">InNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>           <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10818"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowRate</span>          <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10819"></a>    <span class="n">Node</span><span class="p">(</span><span class="n">OutNode</span><span class="p">)%</span><span class="n">MassFlowRateMaxAvail</span>  <span class="o">=</span> <span class="mf">0.0d0</span>
<a name="ln-10820"></a>    <span class="n">OnOffAirFlowRatio</span>      <span class="o">=</span> <span class="mf">1.0d0</span>
<a name="ln-10821"></a>  <span class="k">END IF</span>
<a name="ln-10822"></a>
<a name="ln-10823"></a><span class="c">! Set the system mass flow rates</span>
<a name="ln-10824"></a>  <span class="k">CALL </span><span class="n">SetVSHPAirFlow</span><span class="p">(</span><span class="n">FurnaceNum</span><span class="p">,</span><span class="n">PartLoadRatio</span><span class="p">,</span><span class="n">OnOffAirFlowRatio</span><span class="p">)</span>
<a name="ln-10825"></a>
<a name="ln-10826"></a><span class="k">END SUBROUTINE </span><span class="n">SetOnOffMassFlowRateVSCoil</span>
<a name="ln-10827"></a>
<a name="ln-10828"></a><span class="c">! *****************************************************************************</span>
<a name="ln-10829"></a>
<a name="ln-10830"></a>
<a name="ln-10831"></a><span class="c">!     NOTICE</span>
<a name="ln-10832"></a><span class="c">!</span>
<a name="ln-10833"></a><span class="c">!     Copyright © 1996-2013 The Board of Trustees of the University of Illinois</span>
<a name="ln-10834"></a><span class="c">!     and The Regents of the University of California through Ernest Orlando Lawrence</span>
<a name="ln-10835"></a><span class="c">!     Berkeley National Laboratory.  All rights reserved.</span>
<a name="ln-10836"></a><span class="c">!</span>
<a name="ln-10837"></a><span class="c">!     Portions of the EnergyPlus software package have been developed and copyrighted</span>
<a name="ln-10838"></a><span class="c">!     by other individuals, companies and institutions.  These portions have been</span>
<a name="ln-10839"></a><span class="c">!     incorporated into the EnergyPlus software package under license.   For a complete</span>
<a name="ln-10840"></a><span class="c">!     list of contributors, see &quot;Notice&quot; located in EnergyPlus.f90.</span>
<a name="ln-10841"></a><span class="c">!</span>
<a name="ln-10842"></a><span class="c">!     NOTICE: The U.S. Government is granted for itself and others acting on its</span>
<a name="ln-10843"></a><span class="c">!     behalf a paid-up, nonexclusive, irrevocable, worldwide license in this data to</span>
<a name="ln-10844"></a><span class="c">!     reproduce, prepare derivative works, and perform publicly and display publicly.</span>
<a name="ln-10845"></a><span class="c">!     Beginning five (5) years after permission to assert copyright is granted,</span>
<a name="ln-10846"></a><span class="c">!     subject to two possible five year renewals, the U.S. Government is granted for</span>
<a name="ln-10847"></a><span class="c">!     itself and others acting on its behalf a paid-up, non-exclusive, irrevocable</span>
<a name="ln-10848"></a><span class="c">!     worldwide license in this data to reproduce, prepare derivative works,</span>
<a name="ln-10849"></a><span class="c">!     distribute copies to the public, perform publicly and display publicly, and to</span>
<a name="ln-10850"></a><span class="c">!     permit others to do so.</span>
<a name="ln-10851"></a><span class="c">!</span>
<a name="ln-10852"></a><span class="c">!     TRADEMARKS: EnergyPlus is a trademark of the US Department of Energy.</span>
<a name="ln-10853"></a><span class="c">!</span>
<a name="ln-10854"></a>
<a name="ln-10855"></a>
<a name="ln-10856"></a><span class="k">End Module </span><span class="n">Furnaces</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>


<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">

      <a class="list-group-item" href="../sourcefile/airflownetworkbalancemanager.f90.html">AirflowNetworkBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/airflownetworksolver.f90.html">AirflowNetworkSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiator.f90.html">BaseboardRadiator.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorelectric.f90.html">BaseboardRadiatorElectric.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorsteam.f90.html">BaseboardRadiatorSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/baseboardradiatorwater.f90.html">BaseboardRadiatorWater.f90</a>

      <a class="list-group-item" href="../sourcefile/branchinputmanager.f90.html">BranchInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/branchnodeconnections.f90.html">BranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/conductiontransferfunctioncalc.f90.html">ConductionTransferFunctionCalc.f90</a>

      <a class="list-group-item" href="../sourcefile/cooltower.f90.html">CoolTower.f90</a>

      <a class="list-group-item" href="../sourcefile/costestimatemanager.f90.html">CostEstimateManager.f90</a>

      <a class="list-group-item" href="../sourcefile/curvemanager.f90.html">CurveManager.f90</a>

      <a class="list-group-item" href="../sourcefile/cvfonlyroutines.f90.html">CVFOnlyRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairflownetwork.f90.html">DataAirflowNetwork.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairloop.f90.html">DataAirLoop.f90</a>

      <a class="list-group-item" href="../sourcefile/dataairsystems.f90.html">DataAirSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchairloopplant.f90.html">DataBranchAirLoopPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/databranchnodeconnections.f90.html">DataBranchNodeConnections.f90</a>

      <a class="list-group-item" href="../sourcefile/databsdfwindow.f90.html">DataBSDFWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/datacomplexfenestration.f90.html">DataComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/datacontaminantbalance.f90.html">DataContaminantBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconvergparams.f90.html">DataConvergParams.f90</a>

      <a class="list-group-item" href="../sourcefile/dataconversions.f90.html">DataConversions.f90</a>

      <a class="list-group-item" href="../sourcefile/datacostestimate.f90.html">DataCostEstimate.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylighting.f90.html">DataDaylighting.f90</a>

      <a class="list-group-item" href="../sourcefile/datadaylightingdevices.f90.html">DataDaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/datadefineequip.f90.html">Datadefineequip.f90</a>

      <a class="list-group-item" href="../sourcefile/datadelight.f90.html">DataDElight.f90</a>

      <a class="list-group-item" href="../sourcefile/dataenvironment.f90.html">DataEnvironment.f90</a>

      <a class="list-group-item" href="../sourcefile/dataequivalentlayerwindow.f90.html">DataEquivalentLayerWindow.f90</a>

      <a class="list-group-item" href="../sourcefile/dataerrortracking.f90.html">DataErrorTracking.f90</a>

      <a class="list-group-item" href="../sourcefile/datagenerators.f90.html">DataGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobalconstants.f90.html">DataGlobalConstants.f90</a>

      <a class="list-group-item" href="../sourcefile/dataglobals.f90.html">DataGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalance.f90.html">DataHeatBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalfansys.f90.html">DataHeatBalFanSys.f90</a>

      <a class="list-group-item" href="../sourcefile/dataheatbalsurface.f90.html">DataHeatBalSurface.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvaccontrollers.f90.html">DataHVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/datahvacglobals.f90.html">DataHVACGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datainterfaces.f90.html">DataInterfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/dataipshortcuts.f90.html">DataIPShortCuts.f90</a>

      <a class="list-group-item" href="../sourcefile/dataloopnode.f90.html">DataLoopNode.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalance.f90.html">DataMoistureBalance.f90</a>

      <a class="list-group-item" href="../sourcefile/datamoisturebalanceempd.f90.html">DataMoistureBalanceEMPD.f90</a>

      <a class="list-group-item" href="../sourcefile/dataoutputs.f90.html">DataOutputs.f90</a>

      <a class="list-group-item" href="../sourcefile/dataphotovoltaics.f90.html">DataPhotovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplant.f90.html">DataPlant.f90</a>

      <a class="list-group-item" href="../sourcefile/dataplantpipingsystems.f90.html">DataPlantPipingSystems.f90</a>

      <a class="list-group-item" href="../sourcefile/dataprecisionglobals.f90.html">DataPrecisionGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datareportingflags.f90.html">DataReportingFlags.f90</a>

      <a class="list-group-item" href="../sourcefile/dataroomair.f90.html">DataRoomAir.f90</a>

      <a class="list-group-item" href="../sourcefile/datarootfinder.f90.html">DataRootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/dataruntimelanguage.f90.html">DataRuntimeLanguage.f90</a>

      <a class="list-group-item" href="../sourcefile/datashadowingcombinations.f90.html">DataShadowingCombinations.f90</a>

      <a class="list-group-item" href="../sourcefile/datasizing.f90.html">DataSizing.f90</a>

      <a class="list-group-item" href="../sourcefile/datastringglobals.f90.html">DataStringGlobals.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacecolors.f90.html">DataSurfaceColors.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfacelists.f90.html">DataSurfaceLists.f90</a>

      <a class="list-group-item" href="../sourcefile/datasurfaces.f90.html">DataSurfaces.f90</a>

      <a class="list-group-item" href="../sourcefile/datasystemvariables.f90.html">DataSystemVariables.f90</a>

      <a class="list-group-item" href="../sourcefile/datatimings.f90.html">DataTimings.f90</a>

      <a class="list-group-item" href="../sourcefile/dataucsdshareddata.f90.html">DataUCSDSharedData.f90</a>

      <a class="list-group-item" href="../sourcefile/datavectortypes.f90.html">DataVectorTypes.f90</a>

      <a class="list-group-item" href="../sourcefile/dataviewfactorinformation.f90.html">DataViewFactorInformation.f90</a>

      <a class="list-group-item" href="../sourcefile/datawater.f90.html">DataWater.f90</a>

      <a class="list-group-item" href="../sourcefile/datazonecontrols.f90.html">DataZoneControls.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneenergydemands.f90.html">DataZoneEnergyDemands.f90</a>

      <a class="list-group-item" href="../sourcefile/datazoneequipment.f90.html">DataZoneEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingdevices.f90.html">DaylightingDevices.f90</a>

      <a class="list-group-item" href="../sourcefile/daylightingmanager.f90.html">DaylightingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf.f90.html">DElightManagerF.f90</a>

      <a class="list-group-item" href="../sourcefile/delightmanagerf_no.f90.html">DElightManagerF_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/demandmanager.f90.html">DemandManager.f90</a>

      <a class="list-group-item" href="../sourcefile/desiccantdehumidifiers.f90.html">DesiccantDehumidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/directair.f90.html">DirectAir.f90</a>

      <a class="list-group-item" href="../sourcefile/displayroutines.f90.html">DisplayRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/dxcoil.f90.html">DXCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/earthtube.f90.html">EarthTube.f90</a>

      <a class="list-group-item" href="../sourcefile/economiclifecyclecost.f90.html">EconomicLifeCycleCost.f90</a>

      <a class="list-group-item" href="../sourcefile/economictariff.f90.html">EconomicTariff.f90</a>

      <a class="list-group-item" href="../sourcefile/ecoroof.f90.html">EcoRoof.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowergenerators.f90.html">ElectricPowerGenerators.f90</a>

      <a class="list-group-item" href="../sourcefile/electricpowermanager.f90.html">ElectricPowerManager.f90</a>

      <a class="list-group-item" href="../sourcefile/emsmanager.f90.html">EMSManager.f90</a>

      <a class="list-group-item" href="../sourcefile/energyplus.f90.html">EnergyPlus.f90</a>

      <a class="list-group-item" href="../sourcefile/exteriorenergyusemanager.f90.html">ExteriorEnergyUseManager.f90</a>

      <a class="list-group-item" href="../sourcefile/externalinterface_no.f90.html">ExternalInterface_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/fancoilunits.f90.html">FanCoilUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/faultsmanager.f90.html">FaultsManager.f90</a>

      <a class="list-group-item" href="../sourcefile/fluidproperties.f90.html">FluidProperties.f90</a>

      <a class="list-group-item" href="../sourcefile/general.f90.html">General.f90</a>

      <a class="list-group-item" href="../sourcefile/generalroutines.f90.html">GeneralRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/globalnames.f90.html">GlobalNames.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceairmanager.f90.html">HeatBalanceAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceconvectioncoeffs.f90.html">HeatBalanceConvectionCoeffs.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancehamtmanager.f90.html">HeatBalanceHAMTManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceinternalheatgains.f90.html">HeatBalanceInternalHeatGains.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalanceintradexchange.f90.html">HeatBalanceIntRadExchange.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemanager.f90.html">HeatBalanceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancemovableinsulation.f90.html">HeatBalanceMovableInsulation.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalancesurfacemanager.f90.html">HeatBalanceSurfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatbalfinitedifferencemanager.f90.html">HeatBalFiniteDifferenceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/heatrecovery.f90.html">HeatRecovery.f90</a>

      <a class="list-group-item" href="../sourcefile/humidifiers.f90.html">Humidifiers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccontrollers.f90.html">HVACControllers.f90</a>

      <a class="list-group-item" href="../sourcefile/hvaccooledbeam.f90.html">HVACCooledBeam.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdualductsystem.f90.html">HVACDualDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacduct.f90.html">HVACDuct.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacdxsystem.f90.html">HVACDXSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacevapcomponent.f90.html">HVACEvapComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfancomponent.f90.html">HVACFanComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacfurnace.f90.html">HVACFurnace.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacheatingcoils.f90.html">HVACHeatingCoils.f90</a>

      <a class="list-group-item" href="../sourcefile/hvachxassistedcoolingcoil.f90.html">HVACHXAssistedCoolingCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacinterfacemanager.f90.html">HVACInterfaceManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmanager.f90.html">HVACManager.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmixercomponent.f90.html">HVACMixerComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacmultispeedheatpump.f90.html">HVACMultiSpeedHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductinduc.f90.html">HVACSingleDuctInduc.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsingleductsystem.f90.html">HVACSingleDuctSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsplittercomponent.f90.html">HVACSplitterComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacstandaloneerv.f90.html">HVACStandAloneERV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacsteamcoilcomponent.f90.html">HVACSteamCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvactranspiredcollector.f90.html">HVACTranspiredCollector.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarybypassvav.f90.html">HVACUnitaryBypassVAV.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacunitarysystem.f90.html">HVACUnitarySystem.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacvariablerefrigerantflow.f90.html">HVACVariableRefrigerantFlow.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatercoilcomponent.f90.html">HVACWaterCoilComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoair.f90.html">HVACWatertoAir.f90</a>

      <a class="list-group-item" href="../sourcefile/hvacwatertoairmultispeedhp.f90.html">HVACWatertoAirMultiSpeedHP.f90</a>

      <a class="list-group-item" href="../sourcefile/inputprocessor.f90.html">InputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/matrixdatamanager.f90.html">MatrixDataManager.f90</a>

      <a class="list-group-item" href="../sourcefile/mixedair.f90.html">MixedAir.f90</a>

      <a class="list-group-item" href="../sourcefile/moisturebalanceempdmanager.f90.html">MoistureBalanceEMPDManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nodeinputmanager.f90.html">NodeInputManager.f90</a>

      <a class="list-group-item" href="../sourcefile/nonzoneequipmentmanager.f90.html">NonZoneEquipmentManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outairnodemanager.f90.html">OutAirNodeManager.f90</a>

      <a class="list-group-item" href="../sourcefile/outdoorairunit.f90.html">OutdoorAirUnit.f90</a>

      <a class="list-group-item" href="../sourcefile/outputprocessor.f90.html">OutputProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreportpredefined.f90.html">OutputReportPredefined.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreports.f90.html">OutputReports.f90</a>

      <a class="list-group-item" href="../sourcefile/outputreporttabular.f90.html">OutputReportTabular.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedterminalheatpump.f90.html">PackagedTerminalHeatPump.f90</a>

      <a class="list-group-item" href="../sourcefile/packagedthermalstoragecoil.f90.html">PackagedThermalStorageCoil.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaics.f90.html">Photovoltaics.f90</a>

      <a class="list-group-item" href="../sourcefile/photovoltaicthermalcollectors.f90.html">PhotovoltaicThermalCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantabsorptionchillers.f90.html">PlantAbsorptionChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilers.f90.html">PlantBoilers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantboilerssteam.f90.html">PlantBoilersSteam.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcentralgshp.f90.html">PlantCentralGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantchillers.f90.html">PlantChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondloopoperation.f90.html">PlantCondLoopOperation.f90</a>

      <a class="list-group-item" href="../sourcefile/plantcondlooptowers.f90.html">PlantCondLoopTowers.f90</a>

      <a class="list-group-item" href="../sourcefile/planteirchillers.f90.html">PlantEIRChillers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantevapfluidcoolers.f90.html">PlantEvapFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantexhaustabsorptionchiller.f90.html">PlantExhaustAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantfluidcoolers.f90.html">PlantFluidCoolers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgasabsorptionchiller.f90.html">PlantGasAbsorptionChiller.f90</a>

      <a class="list-group-item" href="../sourcefile/plantgroundheatexchangers.f90.html">PlantGroundHeatExchangers.f90</a>

      <a class="list-group-item" href="../sourcefile/plantheatexchanger.f90.html">PlantHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/planticethermalstorage.f90.html">PlantIceThermalStorage.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloadprofile.f90.html">PlantLoadProfile.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopequipment.f90.html">PlantLoopEquipment.f90</a>

      <a class="list-group-item" href="../sourcefile/plantloopsolver.f90.html">PlantLoopSolver.f90</a>

      <a class="list-group-item" href="../sourcefile/plantmanager.f90.html">PlantManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantoutsideenergysources.f90.html">PlantOutsideEnergySources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipeheattransfer.f90.html">PlantPipeHeatTransfer.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipes.f90.html">PlantPipes.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpipingsystemmanager.f90.html">PlantPipingSystemManager.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpondgroundheatexchanger.f90.html">PlantPondGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpressuresystem.f90.html">PlantPressureSystem.f90</a>

      <a class="list-group-item" href="../sourcefile/plantpumps.f90.html">PlantPumps.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsolarcollectors.f90.html">PlantSolarCollectors.f90</a>

      <a class="list-group-item" href="../sourcefile/plantsurfacegroundheatexchanger.f90.html">PlantSurfaceGroundHeatExchanger.f90</a>

      <a class="list-group-item" href="../sourcefile/plantutilities.f90.html">PlantUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/plantvalves.f90.html">PlantValves.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatersources.f90.html">PlantWaterSources.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwaterthermaltank.f90.html">PlantWaterThermalTank.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwatertowatergshp.f90.html">PlantWatertoWaterGSHP.f90</a>

      <a class="list-group-item" href="../sourcefile/plantwateruse.f90.html">PlantWaterUse.f90</a>

      <a class="list-group-item" href="../sourcefile/pollutionanalysismodule.f90.html">PollutionAnalysisModule.f90</a>

      <a class="list-group-item" href="../sourcefile/poweredinductionunits.f90.html">PoweredInductionUnits.f90</a>

      <a class="list-group-item" href="../sourcefile/psychroutines.f90.html">PsychRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/purchasedairmanager.f90.html">Purchasedairmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemhightemp.f90.html">RadiantSystemHighTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/radiantsystemlowtemp.f90.html">RadiantSystemLowTemp.f90</a>

      <a class="list-group-item" href="../sourcefile/refrigeratedcase.f90.html">RefrigeratedCase.f90</a>

      <a class="list-group-item" href="../sourcefile/reportsizingmanager.f90.html">ReportSizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/returnairpath.f90.html">ReturnAirPath.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmanager.f90.html">RoomAirManager.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelcrossvent.f90.html">RoomAirModelCrossVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodeldisplacementvent.f90.html">RoomAirModelDisplacementVent.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelmundt.f90.html">RoomAirModelMundt.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelufad.f90.html">RoomAirModelUFAD.f90</a>

      <a class="list-group-item" href="../sourcefile/roomairmodelusertemppattern.f90.html">RoomAirModelUserTempPattern.f90</a>

      <a class="list-group-item" href="../sourcefile/rootfinder.f90.html">RootFinder.f90</a>

      <a class="list-group-item" href="../sourcefile/runtimelanguageprocessor.f90.html">RuntimeLanguageProcessor.f90</a>

      <a class="list-group-item" href="../sourcefile/schedulemanager.f90.html">ScheduleManager.f90</a>

      <a class="list-group-item" href="../sourcefile/setpointmanager.f90.html">SetPointManager.f90</a>

      <a class="list-group-item" href="../sourcefile/simairservingzones.f90.html">SimAirServingZones.f90</a>

      <a class="list-group-item" href="../sourcefile/simulationmanager.f90.html">SimulationManager.f90</a>

      <a class="list-group-item" href="../sourcefile/sizingmanager.f90.html">SizingManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarreflectionmanager.f90.html">SolarReflectionManager.f90</a>

      <a class="list-group-item" href="../sourcefile/solarshading.f90.html">SolarShading.f90</a>

      <a class="list-group-item" href="../sourcefile/sortandstringutilities.f90.html">SortAndStringUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlite3.c.html">sqlite3.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitecroutines.c.html">SQLiteCRoutines.c</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines.f90.html">SQLiteFortranRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/sqlitefortranroutines_no.f90.html">SQLiteFortranRoutines_NO.f90</a>

      <a class="list-group-item" href="../sourcefile/standardratings.f90.html">StandardRatings.f90</a>

      <a class="list-group-item" href="../sourcefile/surfacegeometry.f90.html">SurfaceGeometry.f90</a>

      <a class="list-group-item" href="../sourcefile/systemavailabilitymanager.f90.html">SystemAvailabilityManager.f90</a>

      <a class="list-group-item" href="../sourcefile/systemreports.f90.html">SystemReports.f90</a>

      <a class="list-group-item" href="../sourcefile/tarcogcomplexfenestration.f90.html">TarcogComplexFenestration.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalchimney.f90.html">ThermalChimney.f90</a>

      <a class="list-group-item" href="../sourcefile/thermalcomfort.f90.html">ThermalComfort.f90</a>

      <a class="list-group-item" href="../sourcefile/unitheater.f90.html">UnitHeater.f90</a>

      <a class="list-group-item" href="../sourcefile/unitventilator.f90.html">UnitVentilator.f90</a>

      <a class="list-group-item" href="../sourcefile/userdefinedcomponents.f90.html">UserDefinedComponents.f90</a>

      <a class="list-group-item" href="../sourcefile/utilityroutines.f90.html">UtilityRoutines.f90</a>

      <a class="list-group-item" href="../sourcefile/vectorutilities.f90.html">VectorUtilities.f90</a>

      <a class="list-group-item" href="../sourcefile/ventilatedslab.f90.html">VentilatedSlab.f90</a>

      <a class="list-group-item" href="../sourcefile/watermanager.f90.html">WaterManager.f90</a>

      <a class="list-group-item" href="../sourcefile/weathermanager.f90.html">WeatherManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowac.f90.html">WindowAC.f90</a>

      <a class="list-group-item" href="../sourcefile/windowcomplexmanager.f90.html">WindowComplexManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windowequivalentlayer.f90.html">WindowEquivalentLayer.f90</a>

      <a class="list-group-item" href="../sourcefile/windowmanager.f90.html">WindowManager.f90</a>

      <a class="list-group-item" href="../sourcefile/windturbine.f90.html">WindTurbine.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneairloopequipmentmanager.f90.html">Zoneairloopequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zonecontaminantpredictorcorrector.f90.html">ZoneContaminantPredictorCorrector.f90</a>

      <a class="list-group-item" href="../sourcefile/zonedehumidifier.f90.html">ZoneDehumidifier.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneequipmentmanager.f90.html">Zoneequipmentmanager.f90</a>

      <a class="list-group-item" href="../sourcefile/zoneplenumcomponent.f90.html">ZonePlenumComponent.f90</a>

      <a class="list-group-item" href="../sourcefile/zonetemppredictorcorrector.f90.html">ZoneTempPredictorCorrector.f90</a>

    </div>
  </div>
</div>


  </section>

    <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by
            <a href="https://github.com/cmacmackin/ford">FORD</a>

          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> EnergyPlusFortran</p></div>
      </div>
      <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': {
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>
